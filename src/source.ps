%!PS-Adobe-2.0
%%Creator: dvips 5.528 Copyright 1986, 1994 Radical Eye Software
%%Title: source.dvi
%%CreationDate: Fri Nov 15 15:32:34 1996
%%Pages: 437
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSCommandLine: dvips -o source.ps -D 300 source
%DVIPSParameters: dpi=300, comments removed
%DVIPSSource:  TeX output 1996.11.15:1408
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR matrix currentmatrix dup dup 4 get round 4 exch put dup dup 5 get
round 5 exch put setmatrix}N /@landscape{/isls true N}B /@manualfeed{
statusdict /manualfeed true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0
0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn
begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N string /base X
array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N end dup{/foo
setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{/sf 1 N /fntrx
FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]N df-tail}B /E{
pop nn dup definefont setfont}B /ch-width{ch-data dup length 5 sub get}
B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{128 ch-data dup
length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub get 127 sub}B
/ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data dup type
/stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N /rc 0 N /gp
0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base get 2
index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff
ch-yoff ch-height sub ch-xoff ch-width add ch-yoff setcachedevice
ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff .1 add]{
ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}if nn
/base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup length 1
sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{cc 1 add D
}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin 0 0
moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul add
.99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore showpage
userdict /eop-hook known{eop-hook}if}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 -.1 TR 1 1 scale rulex ruley
false RMat{BDot}imagemask grestore}}{{gsave TR -.1 -.1 TR rulex ruley
scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave
transform round exch round exch itransform moveto rulex 0 rlineto 0
ruley neg rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta
0 N /tail{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}
B /c{-4 M}B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{
3 M}B /k{4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p
-1 w}B /q{p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{
3 2 roll p a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300
(/a/apollo-fo/af8/nr/toolkit/www/src/source.dvi) @start
/Fa 2 64 df<800000E00000F80000FF0000FFC000FFF800FFFF00FFFFE0FFFFFEFFFFFE
FFFFE0FFFF00FFF800FFC000FF0000F80000E0000080000017126F882A>45
D<FFFFC07FFF807FFF803FFF003FFF001FFE001FFE001FFE000FFC000FFC0007F80007F8
0007F80003F00003F00003F00001E00001E00001E00000C00000C00000C00000C0001217
89982A>63 D E /Fb 6 117 df<000E001E003C007800F001E003C0078007000F001E00
1E003C003C0038007800780078007000F000F000F000F000F000F000F000F000F000F000
700078007800780038003C003C001E001E000F000700078003C001E000F00078003E001E
000E0F3076A91F>40 D<6000F00078003C001E000F00078003C001C001E000F000F00078
00780038003C003C003C001C001E001E001E001E001E001E001E001E001E001E001C003C
003C003C00380078007800F000F001E001C003C007800F001E003C007800F00060000F30
7BA91F>I<00700000700000F00000F00001F00003F00007F0007FF000FEF000F8F00000
F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000
F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F0007F
FFE0FFFFF07FFFE014257AA41F>49 D<0003FC000007FC000003FC0000003C0000003C00
00003C0000003C0000003C0000003C0000003C0000003C00007E3C0001FFBC0007FFFC00
0F81FC001F00FC003E007C003C007C0078003C0078003C00F0003C00F0003C00F0003C00
F0003C00F0003C00F0003C00F0003C00F0003C0078003C0078007C003C007C003C00FC00
1E01FC000F83FC0007FFBFC003FF3FE0007C3FC01B257EA41F>100
D<00FC0003FF0007FF801F87E01E01E03C00F07C00F8780078780078F0003CF0003CF000
3CF0003CF0003CF0003CF0003CF8007C7800787800787C00F83C00F01E01E01F87E007FF
8003FF0000FC00161A7C991F>111 D<0070000000F0000000F0000000F0000000F00000
00F0000000F000007FFFFE00FFFFFE00FFFFFE0000F0000000F0000000F0000000F00000
00F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F00000
00F0078000F0078000F0078000F0078000F0078000F00F00007C1F00003FFE00001FFC00
0007F00019217FA01F>116 D E /Fc 4 53 df<0C003C00CC000C000C000C000C000C00
0C000C000C000C000C000C000C00FF8009107E8F0F>49 D<1F00618040C08060C0600060
006000C00180030006000C00102020207FC0FFC00B107F8F0F>I<1F00218060C060C000
C0008001800F00008000400060C060C060804060801F000B107F8F0F>I<030003000700
0F000B001300330023004300C300FFE003000300030003001FE00B107F8F0F>I
E /Fd 1 106 df<0808000000007098B0303060646870060F7D8E0B>105
D E /Fe 1 89 df<FFFFFFFFFFFFC0FFFFFFFFFFFFE07F00000001FFE07F000000001FE0
3F8000000003F01FC000000000F00FC000000000380FE0000000001807F0000000000C03
F8000000000403F8000000000401FC000000000200FE0000000000007F0000000000007F
0000000000003F8000000000001FC000000000000FC000000000000FE0000000000007F0
000000000003F8000000000003F8000000000001FC000000000000FE0000000000007E00
00000000007F0000000000003F8000000000001FC000000000001FC000000000000FC000
000000000780000000000003800000000000070000000000000E0000000000001C000000
000000380000000000007000000000000070000000000000E0000000000001C000000000
0003800000000000070000000000000E0000000000000E0000000000001C000000000200
3800000000040070000000000400E0000000000C01E0000000001801C000000000380380
00000000F8070000000001F00E000000000FF01C00000001FFF03FFFFFFFFFFFE03FFFFF
FFFFFFE07FFFFFFFFFFFE0FFFFFFFFFFFFC0373A7E7F3C>88 D E
/Ff 5 53 df<01020408103020606040C0C0C0C0C0C0C0C0C0C040606020301008040201
081E7E950D>40 D<0C001C00EC000C000C000C000C000C000C000C000C000C000C000C00
0C000C000C000C00FFC00A137D9211>49 D<1F0060C06060F070F0306030007000700060
00C001C00180020004000810101020207FE0FFE00C137E9211>I<0FC030707038703870
380038003000E00FC0007000380018001C601CF01CF018E03860701FC00E137F9211>I<
006000E000E00160026006600C600860106020606060C060FFFC00600060006000600060
03FC0E137F9211>I E /Fg 3 111 df<06070600000000384C4C8C981818303262626438
08147F930C>105 D<7C0C181818183030303060606060C0D0D0D0D06006147E930A>108
D<30F8590C4E0C9C0C980C180C180C30183019303130316032601C100D7F8C15>110
D E /Fh 1 49 df<040E0E1C1C1C38383070706060C0C0070F7F8F0A>48
D E /Fi 27 121 df<400000F00000F80000CE0000C78000C1E000C07800C01C00C00700
C003C0C003C0C00700C01C00C07800C1E000C78000CE0000F80000F0000040000012147F
9315>46 D<000180000780000F8000398000F18003C1800F01801C0180700180E00180E0
01807001801C01800F018003C18000F180003980000F8000078000018011147E9315>I<
60F0F06004047C830C>58 D<60F0F0701010101020204080040C7C830C>I<0000038000
000F0000003C000000F0000003C000000F0000003C000000F0000003C000000F0000003C
000000F0000000F00000003C0000000F00000003C0000000F00000003C0000000F000000
03C0000000F00000003C0000000F000000038019187D9520>I<01FFFFF0003C00F00038
00300038002000380020003800200070002000700020007010200070100000E0200000E0
200000E0600000FFE00001C0400001C0400001C0400001C0400003808000038000000380
000003800000070000000700000007000000070000000F000000FFF000001C1C7E9B1B>
70 D<01FFE0003C0000380000380000380000380000700000700000700000700000E000
00E00000E00000E00001C00001C00001C00001C000038002038002038002038004070004
07000C0700180700380E00F0FFFFF0171C7E9B1C>76 D<01FC00FF80001C001C00002E00
1800002E001000002E001000002700100000470020000043002000004380200000438020
000081C040000081C040000081C040000080E040000100E0800001007080000100708000
010070800002003900000200390000020039000002001D000004001E000004000E000004
000E00000C000E00001C00040000FF80040000211C7E9B21>78 D<000FC100303300400F
00800601800603000603000606000406000407000007000007800003F00001FF0000FFC0
003FE00003E00000F00000700000300000302000302000306000606000606000C0600080
F00300CC060083F800181E7E9C19>83 D<1FFFFFF01C0380703007003020070020600700
2040070020400E0020800E0020800E0020000E0000001C0000001C0000001C0000001C00
00003800000038000000380000003800000070000000700000007000000070000000E000
0000E0000000E0000000E0000001E000007FFF00001C1C7F9B18>I<01E3000717000C0F
00180F00380E00300E00700E00700E00E01C00E01C00E01C00E01C00E03880E03880E038
806078803199001E0E0011127E9116>97 D<3F00070007000E000E000E000E001C001C00
1C001C0039E03A303C1838187018701C701C701CE038E038E038E030E070E060E0C061C0
23001E000E1D7E9C12>I<01F0030C0E0C1C1E383C301870007000E000E000E000E000E0
00E0046008601030601F800F127E9112>I<0007E00000E00000E00001C00001C00001C0
0001C000038000038000038000038001E7000717000C0F00180F00380E00300E00700E00
700E00E01C00E01C00E01C00E01C00E03880E03880E038806078803199001E0E00131D7E
9C16>I<01F007080C0818043808300870307FC0E000E000E000E000E000E00460086010
30600F800E127E9113>I<0001E0000630000E78000CF0001C60001C00001C00001C0000
3C0000380000380003FFC000380000380000700000700000700000700000700000E00000
E00000E00000E00000E00001C00001C00001C00001C00001C00001800003800003800063
0000F30000F60000E4000078000015257E9C14>I<0FC00001C00001C000038000038000
0380000380000700000700000700000700000E3E000EC3000F03800E03801E03801C0380
1C03801C0380380700380700380700380E00700E20700E20701C20701C40E00C80600700
131D7E9C18>104 D<01C003C003C001800000000000000000000000001C002700470047
00870087000E000E001C001C001C003800388038807080710032001C000A1C7E9B0E>I<
1F800380038007000700070007000E000E000E000E001C001C001C001C00380038003800
38007000700070007000E400E400E400E40064003800091D7E9C0C>108
D<381F81F04E20C6184640E81C4680F01C8F00F01C8E00E01C0E00E01C0E00E01C1C01C0
381C01C0381C01C0381C01C0703803807138038071380380E1380380E270070064300300
3820127E9124>I<381F004E61804681C04701C08F01C08E01C00E01C00E01C01C03801C
03801C03801C0700380710380710380E10380E2070064030038014127E9119>I<00F800
030C000E06001C0300180300300300700380700380E00700E00700E00700E00E00E00E00
E01C0060180060300030E0000F800011127E9114>I<01C206260C1E181E381C301C701C
701CE038E038E038E038E070E070E07060F023E01CE000E000E001C001C001C001C003C0
1FF80F1A7E9113>113 D<383C4E424687470F8E1E8E0C0E000E001C001C001C001C0038
003800380038007000300010127E9113>I<01F0060C04040C0E180C1C001F000FE00FF0
03F80038201C7018F018F010803060601F800F127E9113>I<1C00C0802701C1C04701C1
C04701C0C087038040870380400E0380400E0380401C0700801C0700801C0700801C0701
0018060100180602001C0E02001C0F04000E13080003E1F0001A127E911E>119
D<07878008C84010F0C020F1E020E3C040E18000E00000E00001C00001C00001C00001C0
00638080F38080F38100E5810084C60078780013127E9118>I E
/Fj 62 123 df<0001FF0000001FFFC000007F81E00000FC01E00001F807F00003F807F0
0007F007F00007F007F00007F007F00007F007F00007F001C00007F000000007F0000000
07F000000007F03FF800FFFFFFF800FFFFFFF800FFFFFFF80007F003F80007F003F80007
F003F80007F003F80007F003F80007F003F80007F003F80007F003F80007F003F80007F0
03F80007F003F80007F003F80007F003F80007F003F80007F003F80007F003F80007F003
F80007F003F80007F003F80007F003F80007F003F8007FFF3FFF807FFF3FFF807FFF3FFF
80212A7FA925>12 D<00030006001C0038007800F000E001E003C003C007800F800F801F
001F001F003E003E003E007E007E007E007C00FC00FC00FC00FC00FC00FC00FC00FC00FC
00FC00FC00FC00FC00FC007C007E007E007E003E003E003E001F001F001F000F800F8007
8003C003C001E000E000F000780038001C00060003103C7BAC1A>40
D<C000600038001C001E000F000700078003C003C001E001F001F000F800F800F8007C00
7C007C007E007E007E003E003F003F003F003F003F003F003F003F003F003F003F003F00
3F003F003E007E007E007E007C007C007C00F800F800F801F001F001E003C003C0078007
000F001E001C0038006000C000103C7CAC1A>I<3C007F00FF80FF80FFC0FFC0FFC07FC0
3EC000C000C00180018001800300030006000E001C00380030000A157B8813>44
D<FFFFFFFFFFFFFFFFFFFFFFFF10067F9016>I<1C007F007F00FF80FF80FF807F007F00
1C0009097B8813>I<003F800001FFF00007E0FC000FC07E001F803F001F001F003F001F
803E000F807E000FC07E000FC07E000FC07E000FC0FE000FE0FE000FE0FE000FE0FE000F
E0FE000FE0FE000FE0FE000FE0FE000FE0FE000FE0FE000FE0FE000FE0FE000FE0FE000F
E0FE000FE0FE000FE07E000FC07E000FC07E000FC07E000FC03F001F803F001F801F001F
001F803F000FC07E0007E0FC0001FFF000003F80001B277DA622>48
D<000E00001E00007E0007FE00FFFE00FFFE00F8FE0000FE0000FE0000FE0000FE0000FE
0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE
0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE
007FFFFE7FFFFE7FFFFE17277BA622>I<00FF800007FFF0000FFFFC001E03FE003800FF
807C003F80FE003FC0FF001FC0FF001FE0FF000FE0FF000FE07E000FE03C001FE000001F
E000001FC000001FC000003F8000003F0000007E000000FC000000F8000001F0000003E0
0000078000000F0000001E0000003C00E0007000E000E000E001C001C0038001C0060001
C00FFFFFC01FFFFFC03FFFFFC07FFFFFC0FFFFFF80FFFFFF80FFFFFF801B277DA622>I<
007F800003FFF00007FFFC000F80FE001F007F003F807F003F803F803F803F803F803F80
1F803F801F003F8000007F0000007F0000007E000000FC000001F8000007F00000FFC000
00FFC0000001F80000007E0000003F0000003F8000001FC000001FC000001FE000001FE0
3C001FE07E001FE0FF001FE0FF001FE0FF001FC0FF003FC0FE003F807C007F003F00FE00
1FFFFC0007FFF00000FF80001B277DA622>I<00000E0000001E0000003E0000007E0000
00FE000000FE000001FE000003FE0000077E00000E7E00000E7E00001C7E0000387E0000
707E0000E07E0000E07E0001C07E0003807E0007007E000E007E000E007E001C007E0038
007E0070007E00E0007E00FFFFFFF8FFFFFFF8FFFFFFF80000FE000000FE000000FE0000
00FE000000FE000000FE000000FE000000FE00007FFFF8007FFFF8007FFFF81D277EA622
>I<180003001F801F001FFFFE001FFFFC001FFFF8001FFFF0001FFFC0001FFF00001C00
00001C0000001C0000001C0000001C0000001C0000001C0000001C7FC0001DFFF8001F80
FC001E003F0008003F0000001F8000001FC000001FC000001FE000001FE018001FE07C00
1FE0FE001FE0FE001FE0FE001FE0FE001FC0FC001FC078003F8078003F803C007F001F01
FE000FFFFC0003FFF00000FF80001B277DA622>I<0007F800003FFE0000FFFF0001FC07
8003F00FC007C01FC00F801FC01F801FC01F001FC03F000F803F0000007E0000007E0000
007E000000FE020000FE1FF000FE3FFC00FE603E00FE801F00FF801F80FF000FC0FF000F
C0FE000FE0FE000FE0FE000FE0FE000FE07E000FE07E000FE07E000FE07E000FE03E000F
E03F000FC01F000FC01F001F800F801F0007E07E0003FFFC0001FFF800003FC0001B277D
A622>I<380000003E0000003FFFFFF03FFFFFF03FFFFFF07FFFFFE07FFFFFC07FFFFF80
7FFFFF0070000E0070000E0070001C00E0003800E0007000E000E0000001E0000001C000
000380000007800000070000000F0000001F0000001E0000003E0000003E0000007E0000
007C0000007C000000FC000000FC000000FC000000FC000001FC000001FC000001FC0000
01FC000001FC000001FC000001FC000000F80000007000001C297CA822>I<003FC00001
FFF00003FFFC0007C07E000F003F001E001F001E000F803E000F803E000F803F000F803F
800F803FC00F803FF01F001FFC1E001FFE3C000FFFF8000FFFE00007FFF80001FFFC0001
FFFE0007FFFF000F0FFF801E03FFC03E01FFC07C007FE07C001FE0F8000FE0F80007E0F8
0003E0F80003E0F80003E0F80003C07C0003C07E0007803F000F001FC03F000FFFFC0003
FFF800007FC0001B277DA622>I<007F800001FFF00007FFF8000FC0FC001F803E003F00
1F007E001F807E001F807E000F80FE000FC0FE000FC0FE000FC0FE000FE0FE000FE0FE00
0FE0FE000FE0FE000FE07E001FE07E001FE03F003FE01F002FE00F80CFE007FF8FE001FF
0FE000080FE000000FC000000FC000000FC000001F803E001F807F001F807F003F007F00
3E007F007E007E00FC003E03F8001FFFE0000FFF800001FE00001B277DA622>I<000007
80000000000780000000000FC0000000000FC0000000000FC0000000001FE0000000001F
E0000000003FF0000000003FF0000000003FF00000000077F80000000077F800000000F7
FC00000000E3FC00000000E3FC00000001C1FE00000001C1FE00000003C1FF0000000380
FF0000000380FF00000007007F80000007007F8000000F007FC000000E003FC000000E00
3FC000001C001FE000001C001FE000003FFFFFF000003FFFFFF000003FFFFFF000007000
07F80000700007F80000F00007FC0000E00003FC0000E00003FC0001C00001FE0001C000
01FE0003C00001FF00FFFE003FFFFCFFFE003FFFFCFFFE003FFFFC2E297EA833>65
D<FFFFFFF800FFFFFFFF00FFFFFFFFC003F8001FE003F8000FF003F80007F803F80003F8
03F80003FC03F80003FC03F80001FC03F80001FC03F80001FC03F80003FC03F80003F803
F80003F803F80007F003F8000FF003F8001FC003F800FF8003FFFFFE0003FFFFFFC003F8
000FF003F80003F803F80001FC03F80001FE03F80000FE03F80000FE03F80000FF03F800
00FF03F80000FF03F80000FF03F80000FF03F80000FF03F80000FE03F80001FE03F80003
FC03F80007FC03F8001FF8FFFFFFFFE0FFFFFFFFC0FFFFFFFE0028297DA830>I<00007F
E0030007FFFC07001FFFFF0F007FF00F9F00FF0001FF01FC0000FF03F800007F07F00000
3F0FE000001F1FC000001F1FC000000F3F8000000F3F800000077F800000077F80000007
7F00000000FF00000000FF00000000FF00000000FF00000000FF00000000FF00000000FF
00000000FF00000000FF000000007F000000007F800000007F800000073F800000073F80
0000071FC00000071FC000000E0FE000000E07F000001C03F800003C01FC00007800FF00
01F0007FF007C0001FFFFF800007FFFE0000007FF00028297CA831>I<FFFFFFFC0000FF
FFFFFF8000FFFFFFFFE00003FC001FF80003FC0003FC0003FC0000FE0003FC00007F0003
FC00003F8003FC00001FC003FC00001FC003FC00000FE003FC00000FE003FC000007F003
FC000007F003FC000007F003FC000007F003FC000007F803FC000007F803FC000007F803
FC000007F803FC000007F803FC000007F803FC000007F803FC000007F803FC000007F803
FC000007F803FC000007F003FC000007F003FC000007F003FC00000FE003FC00000FE003
FC00000FC003FC00001FC003FC00003F8003FC00007F0003FC0000FF0003FC0003FC0003
FC001FF800FFFFFFFFF000FFFFFFFF8000FFFFFFFC00002D297EA834>I<FFFFFFFFE0FF
FFFFFFE0FFFFFFFFE003FC001FE003FC0007F003FC0001F003FC0001F003FC0000F003FC
00007003FC00007003FC00007003FC01C07803FC01C03803FC01C03803FC01C03803FC03
C00003FC03C00003FC0FC00003FFFFC00003FFFFC00003FFFFC00003FC0FC00003FC03C0
0003FC03C00003FC01C00E03FC01C00E03FC01C00E03FC01C01C03FC00001C03FC00001C
03FC00001C03FC00003C03FC00003803FC00007803FC0000F803FC0001F803FC0003F803
FC001FF8FFFFFFFFF0FFFFFFFFF0FFFFFFFFF027297EA82C>I<FFFFFFFFC0FFFFFFFFC0
FFFFFFFFC003FC003FC003FC000FE003FC0003E003FC0001E003FC0001E003FC0000E003
FC0000E003FC0000E003FC0000F003FC01C07003FC01C07003FC01C07003FC01C00003FC
03C00003FC03C00003FC0FC00003FFFFC00003FFFFC00003FFFFC00003FC0FC00003FC03
C00003FC03C00003FC01C00003FC01C00003FC01C00003FC01C00003FC00000003FC0000
0003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC000000
FFFFFC0000FFFFFC0000FFFFFC000024297EA82A>I<00007FE003000007FFFC0700001F
FFFF0F00007FF00F9F0000FF0001FF0001FC0000FF0003F800007F0007F000003F000FE0
00001F001FC000001F001FC000000F003F8000000F003F80000007007F80000007007F80
000007007F0000000000FF0000000000FF0000000000FF0000000000FF0000000000FF00
00000000FF0000000000FF0000000000FF0000000000FF0000FFFFF87F0000FFFFF87F80
00FFFFF87F800000FF003F800000FF003F800000FF001FC00000FF001FC00000FF000FE0
0000FF0007F00000FF0003F80000FF0001FC0000FF0000FF0001FF00007FF007FF00001F
FFFF9F000007FFFE0F0000007FF003002D297CA835>I<FFFFF00FFFFFFFFFF00FFFFFFF
FFF00FFFFF03FC00003FC003FC00003FC003FC00003FC003FC00003FC003FC00003FC003
FC00003FC003FC00003FC003FC00003FC003FC00003FC003FC00003FC003FC00003FC003
FC00003FC003FC00003FC003FC00003FC003FC00003FC003FFFFFFFFC003FFFFFFFFC003
FFFFFFFFC003FC00003FC003FC00003FC003FC00003FC003FC00003FC003FC00003FC003
FC00003FC003FC00003FC003FC00003FC003FC00003FC003FC00003FC003FC00003FC003
FC00003FC003FC00003FC003FC00003FC003FC00003FC003FC00003FC003FC00003FC0FF
FFF00FFFFFFFFFF00FFFFFFFFFF00FFFFF30297EA835>I<FFFFFCFFFFFCFFFFFC01FE00
01FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE00
01FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE00
01FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE00FFFFFCFFFFFC
FFFFFC16297FA819>I<FFFFFC0000FFFFFC0000FFFFFC000003FC00000003FC00000003
FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC
00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00
000003FC00000003FC00000003FC00000003FC00000003FC0001C003FC0001C003FC0001
C003FC0001C003FC0003C003FC00038003FC00038003FC00078003FC00078003FC000F80
03FC000F8003FC001F8003FC007F8003FC01FF00FFFFFFFF00FFFFFFFF00FFFFFFFF0022
297EA828>76 D<FFFE0000003FFF80FFFE0000003FFF80FFFF0000007FFF8003FF000000
7FE00003FF0000007FE00003BF800000EFE00003BF800000EFE000039FC00001CFE00003
9FC00001CFE000038FE000038FE000038FE000038FE000038FE000038FE0000387F00007
0FE0000387F000070FE0000383F8000E0FE0000383F8000E0FE0000381FC001C0FE00003
81FC001C0FE0000381FC001C0FE0000380FE00380FE0000380FE00380FE00003807F0070
0FE00003807F00700FE00003803F80E00FE00003803F80E00FE00003803F80E00FE00003
801FC1C00FE00003801FC1C00FE00003800FE3800FE00003800FE3800FE000038007F700
0FE000038007F7000FE000038007F7000FE000038003FE000FE000038003FE000FE00003
8001FC000FE000038001FC000FE000038000F8000FE000FFFE00F803FFFF80FFFE00F803
FFFF80FFFE007003FFFF8039297DA840>I<FFFC00007FFFFFFE00007FFFFFFF00007FFF
03FF800001C003FFC00001C003BFE00001C0039FE00001C0039FF00001C0038FF80001C0
0387FC0001C00383FE0001C00381FF0001C00380FF8001C003807F8001C003807FC001C0
03803FE001C003801FF001C003800FF801C0038007FC01C0038003FC01C0038003FE01C0
038001FF01C0038000FF81C00380007FC1C00380003FE1C00380001FF1C00380000FF1C0
0380000FF9C003800007FDC003800003FFC003800001FFC003800000FFC0038000007FC0
038000007FC0038000003FC0038000001FC0038000000FC00380000007C0FFFE000003C0
FFFE000001C0FFFE000001C030297EA835>I<0000FFC00000000FFFFC0000003F807F00
0000FE001FC00001F80007E00003F00003F00007E00001F8000FE00001FC001FC00000FE
001FC00000FE003F8000007F003F8000007F007F8000007F807F0000003F807F0000003F
807F0000003F80FF0000003FC0FF0000003FC0FF0000003FC0FF0000003FC0FF0000003F
C0FF0000003FC0FF0000003FC0FF0000003FC0FF0000003FC0FF0000003FC07F0000003F
807F8000007F807F8000007F803F8000007F003F8000007F001FC00000FE001FC00000FE
000FE00001FC0007F00003F80003F80007F00001FC000FE00000FE001FC000003FC0FF00
00000FFFFC00000000FFC000002A297CA833>I<FFFFFFF800FFFFFFFF00FFFFFFFFC003
FC003FE003FC0007F003FC0003F803FC0003FC03FC0001FC03FC0001FE03FC0001FE03FC
0001FE03FC0001FE03FC0001FE03FC0001FE03FC0001FE03FC0001FC03FC0003FC03FC00
03F803FC0007F003FC003FE003FFFFFF8003FFFFFE0003FC00000003FC00000003FC0000
0003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC000000
03FC00000003FC00000003FC00000003FC00000003FC00000003FC000000FFFFF00000FF
FFF00000FFFFF0000027297EA82E>I<FFFFFFE00000FFFFFFFE0000FFFFFFFF800003FC
003FE00003FC000FF00003FC0007F80003FC0003FC0003FC0001FC0003FC0001FE0003FC
0001FE0003FC0001FE0003FC0001FE0003FC0001FE0003FC0001FE0003FC0001FC0003FC
0003F80003FC0007F80003FC000FE00003FC003FC00003FFFFFE000003FFFFFE000003FC
00FF800003FC003FC00003FC001FE00003FC000FF00003FC0007F80003FC0007F80003FC
0007F80003FC0007F80003FC0007F80003FC0007F80003FC0007F80003FC0007F80003FC
0007F80003FC0007F80E03FC0007F80E03FC0003F80E03FC0001FC1CFFFFF000FE1CFFFF
F0007FF8FFFFF0000FE02F297EA832>82 D<00FF00C003FFE1C00FFFF9C01F80FFC03F00
3FC03E000FC07C0007C07C0007C0FC0003C0FC0003C0FC0001C0FE0001C0FE0001C0FF00
0000FFC000007FFC00007FFFE0003FFFF8001FFFFE001FFFFF0007FFFF8003FFFFC000FF
FFC0000FFFE000007FE000001FF000000FF0000007F0E00003F0E00003F0E00003F0E000
03F0F00003E0F00003E0F80007E0FC0007C0FF000F80FFE01F80E3FFFF00E1FFFC00C01F
F0001C297CA825>I<7FFFFFFFFF807FFFFFFFFF807FFFFFFFFF807F807F807F807C007F
800F8078007F80078078007F80078070007F800380F0007F8003C0F0007F8003C0E0007F
8001C0E0007F8001C0E0007F8001C0E0007F8001C0E0007F8001C000007F80000000007F
80000000007F80000000007F80000000007F80000000007F80000000007F80000000007F
80000000007F80000000007F80000000007F80000000007F80000000007F80000000007F
80000000007F80000000007F80000000007F80000000007F80000000007F80000000007F
80000000007F80000000007F80000000FFFFFFC00000FFFFFFC00000FFFFFFC0002A287E
A72F>I<FFFFF000FFFEFFFFF000FFFEFFFFF000FFFE03FC0000038003FC0000038003FC
0000038003FC0000038003FC0000038003FC0000038003FC0000038003FC0000038003FC
0000038003FC0000038003FC0000038003FC0000038003FC0000038003FC0000038003FC
0000038003FC0000038003FC0000038003FC0000038003FC0000038003FC0000038003FC
0000038003FC0000038003FC0000038003FC0000038003FC0000038003FC0000038003FC
0000038003FC0000038001FC0000070001FE0000070000FE00000E00007F00000E00003F
00003C00001FC0007800000FF003F0000007FFFFE0000000FFFF800000001FFC00002F29
7EA834>I<FFFFF0007FFFFFFFF0007FFFFFFFF0007FFF03FE000001C001FE0000038001
FE0000038000FF0000070000FF0000070000FF80000F00007F80000E00007FC0000E0000
3FC0001C00003FE0001C00001FE0003800001FE0003800001FF0007800000FF000700000
0FF800F0000007F800E0000007FC00E0000003FC01C0000003FC01C0000003FE03C00000
01FE0380000001FF0780000000FF0700000000FF87000000007F8E000000007F8E000000
007FDE000000003FDC000000003FFC000000001FF8000000001FF8000000000FF0000000
000FF0000000000FF00000000007E00000000007E00000000003C00000000003C0000030
297FA833>I<FFFFE0FFFFE01FFFC0FFFFE0FFFFE01FFFC0FFFFE0FFFFE01FFFC003FC00
03FC0000700003FC0003FC0000700003FE0003FE0000F00001FE0001FE0000E00001FE00
01FE0000E00001FF0001FF0001E00000FF0001FF0001C00000FF0001FF0001C000007F80
03FF80038000007F8003FF80038000007FC007FFC0078000003FC0073FC0070000003FC0
073FC0070000003FE00F3FE00F0000001FE00E1FE00E0000001FE00E1FE00E0000000FF0
1C0FF01C0000000FF01C0FF01C0000000FF01C0FF81C00000007F83807F83800000007F8
3807F83800000007FC7807FC7800000003FC7003FC7000000003FC7003FC7000000003FE
F003FEF000000001FEE001FEE000000001FEE001FEE000000000FFC000FFC000000000FF
C000FFC000000000FFC000FFC0000000007F80007F80000000007F80007F80000000007F
80007F80000000003F00003F00000000003F00003F00000000003F00003F00000000001E
00001E00000000001E00001E00000042297FA845>I<03FF80000FFFF0001F01FC003F80
FE003F807F003F803F003F803F801F003F8000003F8000003F8000003F8000003F80003F
FF8001FC3F800FE03F801F803F803F003F807E003F80FC003F80FC003F80FC003F80FC00
3F80FC005F807E00DF803F839FFC1FFE0FFC03F803FC1E1B7E9A21>97
D<FFE00000FFE00000FFE000000FE000000FE000000FE000000FE000000FE000000FE000
000FE000000FE000000FE000000FE000000FE000000FE000000FE1FE000FE7FF800FFE07
E00FF803F00FF001F80FE000FC0FE000FC0FE0007E0FE0007E0FE0007F0FE0007F0FE000
7F0FE0007F0FE0007F0FE0007F0FE0007F0FE0007F0FE0007E0FE0007E0FE0007E0FE000
FC0FE000FC0FF001F80FF803F00F9C0FE00F0FFF800E01FC00202A7EA925>I<003FF000
01FFFC0003F03E000FC07F001F807F003F007F003F007F007F003E007E0000007E000000
FE000000FE000000FE000000FE000000FE000000FE000000FE0000007E0000007E000000
7F0000003F0003803F8003801F8007000FE00E0003F83C0001FFF800003FC000191B7E9A
1E>I<00007FF000007FF000007FF0000007F0000007F0000007F0000007F0000007F000
0007F0000007F0000007F0000007F0000007F0000007F0000007F0003F87F001FFF7F007
F03FF00FC00FF01F8007F03F0007F03F0007F07E0007F07E0007F07E0007F0FE0007F0FE
0007F0FE0007F0FE0007F0FE0007F0FE0007F0FE0007F0FE0007F07E0007F07E0007F03F
0007F03F0007F01F800FF00FC01FF007E07FFF01FFE7FF007F87FF202A7EA925>I<003F
C00001FFF00003E07C000F803E001F801F001F001F003F000F807E000F807E000FC07E00
0FC0FE0007C0FE0007C0FFFFFFC0FFFFFFC0FE000000FE000000FE0000007E0000007E00
00007F0000003F0001C01F0001C00F80038007C0070003F01E0000FFFC00003FE0001A1B
7E9A1F>I<0007F8003FFC007E3E01FC7F03F87F03F07F07F07F07F03E07F00007F00007
F00007F00007F00007F00007F000FFFFC0FFFFC0FFFFC007F00007F00007F00007F00007
F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007
F00007F00007F00007F00007F0007FFF807FFF807FFF80182A7EA915>I<007F80F001FF
E3F807C0FE1C0F807C7C1F003E7C1F003E103F003F003F003F003F003F003F003F003F00
3F003F003F001F003E001F003E000F807C0007C0F80005FFE0000C7F8000180000001C00
00001C0000001E0000001FFFF8001FFFFF000FFFFFC007FFFFE003FFFFF00FFFFFF03E00
07F07C0001F8F80000F8F80000F8F80000F8F80000F87C0001F07C0001F03F0007E00FC0
1F8007FFFF00007FF0001E287E9A22>I<FFE00000FFE00000FFE000000FE000000FE000
000FE000000FE000000FE000000FE000000FE000000FE000000FE000000FE000000FE000
000FE000000FE07E000FE1FF800FE30FC00FE40FE00FE807E00FF807F00FF007F00FF007
F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007
F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F0FFFE3FFFFFFE3F
FFFFFE3FFF202A7DA925>I<07000F801FC03FE03FE03FE01FC00F800700000000000000
0000000000000000FFE0FFE0FFE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0
0FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0FFFEFFFEFFFE0F2B7EAA12>I<000700
000F80001FC0003FE0003FE0003FE0001FC0000F80000700000000000000000000000000
00000000000000000001FFE001FFE001FFE0000FE0000FE0000FE0000FE0000FE0000FE0
000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0
000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE07C0FE0FE0FE0
FE0FC0FE1F80FE1F007C3E003FFC000FF000133784AA15>I<FFE00000FFE00000FFE000
000FE000000FE000000FE000000FE000000FE000000FE000000FE000000FE000000FE000
000FE000000FE000000FE000000FE03FF80FE03FF80FE03FF80FE007000FE00E000FE03C
000FE078000FE0F0000FE1E0000FE3C0000FE780000FEFC0000FFFE0000FFFE0000FF7F0
000FE3F8000FC1FC000FC1FC000FC0FE000FC07F000FC07F000FC03F800FC01FC00FC01F
C0FFFC7FFCFFFC7FFCFFFC7FFC1E2A7EA923>I<FFE0FFE0FFE00FE00FE00FE00FE00FE0
0FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0
0FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0FFFEFFFEFFFE0F2A7EA9
12>I<FFC07F001FC000FFC1FFC07FF000FFC307E0C1F8000FC407F101FC000FC803F200
FC000FD803FE00FE000FD003FC00FE000FD003FC00FE000FE003F800FE000FE003F800FE
000FE003F800FE000FE003F800FE000FE003F800FE000FE003F800FE000FE003F800FE00
0FE003F800FE000FE003F800FE000FE003F800FE000FE003F800FE000FE003F800FE000F
E003F800FE000FE003F800FE000FE003F800FE000FE003F800FE00FFFE3FFF8FFFE0FFFE
3FFF8FFFE0FFFE3FFF8FFFE0331B7D9A38>I<FFC07E00FFC1FF80FFC30FC00FC40FE00F
C807E00FD807F00FD007F00FD007F00FE007F00FE007F00FE007F00FE007F00FE007F00F
E007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00F
E007F00FE007F0FFFE3FFFFFFE3FFFFFFE3FFF201B7D9A25>I<003FE00001FFFC0003F0
7E000FC01F801F800FC03F0007E03F0007E07E0003F07E0003F07E0003F0FE0003F8FE00
03F8FE0003F8FE0003F8FE0003F8FE0003F8FE0003F8FE0003F87E0003F07E0003F03F00
07E03F0007E01F800FC00FC01F8007F07F0001FFFC00003FE0001D1B7E9A22>I<FFE1FE
00FFE7FF80FFFE0FE00FF803F00FF001F80FE001FC0FE000FC0FE000FE0FE000FE0FE000
7F0FE0007F0FE0007F0FE0007F0FE0007F0FE0007F0FE0007F0FE0007F0FE0007E0FE000
FE0FE000FE0FE000FC0FE001FC0FF001F80FF803F00FFC0FE00FEFFF800FE1FC000FE000
000FE000000FE000000FE000000FE000000FE000000FE000000FE000000FE00000FFFE00
00FFFE0000FFFE000020277E9A25>I<003F807001FFE0F003F071F00FC019F01F800FF0
3F800FF03F0007F07F0007F07F0007F07E0007F0FE0007F0FE0007F0FE0007F0FE0007F0
FE0007F0FE0007F0FE0007F0FE0007F07F0007F07F0007F03F0007F03F8007F01F800FF0
0FC01FF007F077F001FFE7F0007F87F0000007F0000007F0000007F0000007F0000007F0
000007F0000007F0000007F0000007F000007FFF00007FFF00007FFF20277E9A23>I<FF
C3E0FFC7F8FFCC7C0FD8FE0FD0FE0FD0FE0FF0FE0FE07C0FE0000FE0000FE0000FE0000F
E0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE000FF
FF00FFFF00FFFF00171B7E9A1B>I<03FE300FFFF03E03F07800F07000F0F00070F00070
F80070FE0000FFE0007FFF007FFFC03FFFE01FFFF007FFF800FFF80007FC0000FCE0007C
E0003CF0003CF00038F80038FC0070FF01E0E7FFC0C1FF00161B7E9A1B>I<0070000070
0000700000700000F00000F00000F00001F00003F00003F00007F0001FFFE0FFFFE0FFFF
E007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F0
0007F00007F07007F07007F07007F07007F07007F07007F07003F0E001F8C000FFC0003F
0014267FA51A>I<FFE07FF0FFE07FF0FFE07FF00FE007F00FE007F00FE007F00FE007F0
0FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F00FE007F0
0FE007F00FE007F00FE007F00FE007F00FE007F00FE00FF00FE00FF007E017F003F067FF
01FFC7FF007F87FF201B7D9A25>I<FFFE07FFFFFE07FFFFFE07FF07F000E007F000E007
F801E003F801C003F801C001FC038001FC038001FE078000FE070000FF0F00007F0E0000
7F0E00003F9C00003F9C00003FFC00001FF800001FF800000FF000000FF000000FF00000
07E0000007E0000003C0000003C000201B7F9A23>I<FFFC7FFC1FFCFFFC7FFC1FFCFFFC
7FFC1FFC0FE00FE001C007F007E0038007F007E0038007F807F0078003F807F0070003F8
07F8070001FC0FF80E0001FC0FF80E0001FE1FFC1E0000FE1CFC1C0000FE1CFE1C0000FF
387E3C00007F387E3800007F787F3800003FF03F7000003FF03F7000003FE01FF000001F
E01FE000001FE01FE000000FC00FC000000FC00FC000000FC00FC0000007800780000007
800780002E1B7F9A31>I<FFFC1FFEFFFC1FFEFFFC1FFE07F0078003F8070001FC0F0001
FE1E0000FE3C00007F7800003FF800003FF000001FE000000FE0000007F0000007F80000
0FF800001FFC00003DFE000038FF0000787F0000F03F8001E03FC003C01FE003800FE0FF
F03FFFFFF03FFFFFF03FFF201B7F9A23>I<FFFE07FFFFFE07FFFFFE07FF07F000E007F0
00E007F801E003F801C003F801C001FC038001FC038001FE078000FE070000FF0F00007F
0E00007F0E00003F9C00003F9C00003FFC00001FF800001FF800000FF000000FF0000007
F0000007E0000007E0000003C0000003C000000380000003800000078000380700007C07
0000FE0E0000FE0E0000FE1C0000FE3800007C7000003FE000000F80000020277F9A23>
I<3FFFFF3FFFFF3F00FE3C01FE3803FC7803F87807F0700FF0700FE0701FC0003FC0003F
80007F0000FF0000FE0001FC0703FC0703F80707F0070FF00F0FE00F1FC00E3FC01E7F80
3E7F00FEFFFFFEFFFFFE181B7E9A1E>I E /Fk 24 121 df<01E006180E1C1C0E1C0E1C
0E1C0E1C0C1C1C1C38FCE01C301C181C0C1C0E1C061C071C071C071C071C071C071C061C
CE1CCCFC78101A7F9913>25 D<000C0600000C0600000C060000180C0000180C0000180C
0000180C000030180000301800003018000030180000603000FFFFFFE0FFFFFFE000C060
0000C0600000C060000180C0000180C0000180C000FFFFFFE0FFFFFFE003018000030180
0006030000060300000603000006030000060300000C0600000C0600000C0600000C0600
001B217E9920>35 D<078018603030303060186018E01CE01CE01CE01CE01CE01CE01CE0
1CE01CE01CE01CE01C6018601870383030186007800E187E9713>48
D<03000700FF000700070007000700070007000700070007000700070007000700070007
0007000700070007000700FFF00C187D9713>I<0F80106020304038803CC01CE01C401C
003C003800380070006000C001800100020004040804100430083FF87FF8FFF80E187E97
13>I<0F8010E02070607870382038007800700070006000C00F8000E000700038003C00
3CE03CE03CC03C4038407030E00F800E187E9713>I<00300030007000F000F001700370
027004700C7008701070307020704070C070FFFF00700070007000700070007007FF1018
7F9713>I<30183FF03FE03FC02000200020002000200027C03860203000380018001C00
1C401CE01CE01C80184038403030E00F800E187E9713>I<01E006100C18183830383000
70006000E000E7C0E860F030F018E018E01CE01CE01C601C601C701830183030186007C0
0E187E9713>I<40007FFE7FFC7FFC400880108010802000400040008001800180010003
0003000300030007000700070007000700070002000F197E9813>I<0780186030302018
60186018601870103C303E600F8007C019F030F86038401CC00CC00CC00CC00C60082010
18600FC00E187E9713>I<07801860303070306018E018E018E01CE01CE01C601C603C30
3C185C0F9C001C00180018003870307060604021801F000E187E9713>I<003F0201C0C6
03002E0E001E1C000E1C0006380006780002700002700002F00000F00000F00000F00000
F00000F000007000027000027800023800041C00041C00080E000803003001C0C0003F00
171A7E991C>67 D<FFFFE00E00E00E00600E00200E00300E00100E00100E00100E04000E
04000E04000E0C000FFC000E0C000E04000E04000E04000E00000E00000E00000E00000E
00000E00000E00000E0000FFF000141A7E9919>70 D<3F8070C070E020700070007007F0
1C7030707070E070E071E071E0F171FB1E3C10107E8F13>97 D<FC00001C00001C00001C
00001C00001C00001C00001C00001C00001C00001CF8001F0E001E07001C03801C01801C
01C01C01C01C01C01C01C01C01C01C01C01C03801C03001E07001B0C0010F000121A7F99
15>I<07C01C3030187018600CE00CFFFCE000E000E000E0006000300438080C1807E00E
107F8F11>101 D<0FCE187330307038703870387038303018602FC02000600070003FF0
3FFC1FFE600FC003C003C003C0036006381C07E010187F8F13>103
D<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001CF8001D0C
001E0E001E0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E
001C0E00FF9FC0121A7F9915>I<18003C003C001800000000000000000000000000FC00
1C001C001C001C001C001C001C001C001C001C001C001C001C001C00FF80091A80990A>
I<FCF8001D0C001E0E001E0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E
001C0E001C0E001C0E00FF9FC012107F8F15>110 D<1F2060E04020C020C020F0007F00
3FC01FE000F080708030C030C020F0408F800C107F8F0F>115 D<FC7E001C0E001C0E00
1C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C1E000C2E00
07CFC012107F8F15>117 D<FF3F803C1C001C18000E100007200007600003C00001C000
01E00003E000027000043800083800181C00381E00FC3FC012107F8F14>120
D E /Fl 54 123 df<4040E0E0E0E0E0E0E0E0E0E0E0E0E0E040400B097D9312>34
D<FFF8FFF8FFF80D037E8B12>45 D<07C00FE01C703838701C701CE00EE00EE00EE00EE0
0EE00EE00EE01E701C701C38381C700FE007C00F147F9312>48 D<060006000E001E00FE
00EE000E000E000E000E000E000E000E000E000E000E000E000E00FFE0FFE00B147D9312
>I<0F803FC070E0E070E038E038403800380030007000E000C00180030006000C001838
30387FF87FF80D147E9312>I<0FE03FF07838701C201C001C0038007807E007F0003800
1C000E000E400EE00EE01C78383FF00FC00F147F9312>I<038007C007C006C006C00EE0
0EE00EE00EE00C601C701C701C701FF01FF0383838383838FC7EFC7E0F147F9312>65
D<FFE0FFF03838381C381C381C381C383838783FF03FF8381C380E380E380E380E381E38
3CFFF8FFF00F147F9312>I<03E60FFE1C3E381E700E700E600EE000E000E000E000E000
E000600E700E700E381C1C380FF003E00F147F9312>I<FFC0FFF038783838381C381C38
1E380E380E380E380E380E380E380E381C381C38383878FFF0FFC00F147F9312>I<FFFE
FFFE380E380E380E3800380038E038E03FE03FE038E038E03800380E380E380E380EFFFE
FFFE0F147F9312>I<FFFEFFFE380E380E380E3800380038E038E03FE03FE038E038E038
003800380038003800FF00FF000F147F9312>I<07980FF81878387870387038E038E000
E000E000E0FCE0FCE038E03870387038387818780FF807B80E147F9312>I<FC7EFC7E38
383838383838383838383838383FF83FF83838383838383838383838383838FC7EFC7E0F
147F9312>I<FFE0FFE00E000E000E000E000E000E000E000E000E000E000E000E000E00
0E000E000E00FFE0FFE00B147D9312>I<FF00FF00380038003800380038003800380038
0038003800380038003804380E380E380EFFFEFFFE0F147F9312>76
D<FC7EFC7E7C7C745C76DC76DC76DC76DC76DC76DC77DC739C739C701C701C701C701C70
1CF83EF83E0F147F9312>I<FEFEFEFE3E383A383B383B383B383B383B383B3839B839B8
39B839B839B839B838B838F8FEF8FEF80F147F9312>I<3FE07FF07070E038E038E038E0
38E038E038E038E038E038E038E038E038E038E03870707FF03FE00D147E9312>I<FFE0
FFF8383C381C380E380E380E380E381C383C3FF83FE0380038003800380038003800FE00
FE000F147F9312>I<FF80FFE038F03878383838383838387838F03FE03FC038E0387038
703870387038773877FE3EFE1C10147F9312>82 D<1F303FF070F0E070E070E070E00070
007F003FC00FE000F0003800386038E038E030F070FFE0CF800D147E9312>I<7FFEFFFE
E38EE38EE38E03800380038003800380038003800380038003800380038003801FF01FF0
0F147F9312>I<FE3F80FE3F80380E00380E00380E00380E00380E00380E00380E00380E
00380E00380E00380E00380E00380E00380E001C1C000E380007F00003E0001114809312
>I<F83EF83E701C701C701C701C701C701C77DC77DC37D836D836D836D836D836D836D8
3EF83C781C700F147F9312>87 D<7C7C7C7C1C701CE00EE00FE00FC007C0078003800780
07C00FC00EE01EE01C701C703838FC7EFC7E0F147F9312>I<7FF8FFF8E070E070E0E000
E001C003800380070007000E000E001C00381C381C701C701CFFFCFFFC0E147E9312>90
D<FFF8FFF8FFF80D037E7F12>95 D<3F807FC070E0207000700FF03FF07870E070E070E0
7070F03FFE1F3E0F0E7E8D12>97 D<F800F80038003800380038003BE03FF03C38381C38
0C380E380E380E380E380C381C3C383FF01BC00F147F9312>I<07F01FF8383870106000
E000E000E000E0006000703838381FF007E00D0E7E8D12>I<00F800F800380038003800
3807B81FF8387870386038E038E038E038E0386038707838781FFE0FBE0F147F9312>I<
07801FE0387070706038E038FFF8FFF8E0006000703838381FF007C00D0E7E8D12>I<00
7E00FF01C70382038003807FFEFFFE03800380038003800380038003800380038003803F
F83FF81014809312>I<0F9E1FFF38E7707070707070707038E03FC03F8070003FE03FF8
3FFC701EE00EE00EE00E600C783C1FF00FE010167F8D12>I<F800F80038003800380038
0039E03FF03E383C3838383838383838383838383838383838FE3EFE3E0F147F9312>I<
06000F000F000600000000000000FF00FF00070007000700070007000700070007000700
0700FFF0FFF00C157D9412>I<00C001E001E000C00000000000001FE01FE000E000E000
E000E000E000E000E000E000E000E000E000E000E000E000E040C0E1C0FF807E000B1C7E
9412>I<F800F80038003800380038003BFC3BFC38F039E03BC03F803F803FC03DE038E0
38703838FC7EFC7E0F147F9312>I<FF00FF000700070007000700070007000700070007
000700070007000700070007000700FFF8FFF80D147E9312>I<F71C00FFBE0079E70079
E70071C70071C70071C70071C70071C70071C70071C70071C700F9E780F8E380110E808D
12>I<F9E0FFF03E383C3838383838383838383838383838383838FE3EFE3E0F0E7F8D12>
I<0F803FE038E07070E038E038E038E038E038F078707038E03FE00F800D0E7E8D12>I<
FBE0FFF03C38381C380C380E380E380E380E380C381C3C383FF03BC03800380038003800
3800FE00FE000F157F8D12>I<079C1FFC387C703C601CE01CE01CE01CE01C601C703C38
7C1FFC079C001C001C001C001C001C007F007F10157F8D12>I<FCF8FDFC1F1C1E081E00
1C001C001C001C001C001C001C00FFC0FFC00E0E7E8D12>I<1FF03FF06070C070E0007F
003FE00FF000786018E018F030FFE0DFC00D0E7E8D12>I<06000E000E000E007FF8FFF8
0E000E000E000E000E000E000E000E380E380E3807F003C00D127F9112>I<F8F8F8F838
383838383838383838383838383838383838781FFE0FBE0F0E7F8D12>I<FC7EFC7E3838
3C781C701C701C700EE00EE00EE006C007C007C003800F0E7F8D12>I<FEFEFEFE701C70
1C301838383BB83FF83FF83AB838B81CF01CF01CF00F0E7F8D12>I<7C7C7C7C1CF00EE0
0FC007C00380078007C00EE01EF01C70FC7EFC7E0F0E7F8D12>I<FC7EFC7E3C381C381C
701C700E700E600E6006E006E003C003C003C0038003800380778077007E003C000F157F
8D12>I<3FFC7FFC7038707000E001C0038007000E001C1C381C701CFFFCFFFC0E0E7F8D
12>I E /Fm 2 48 df<4000F000FC00CE00C380C1E0C078C01EC01EC078C0E0C380CF00
FC00F00040000F107F8F12>46 D<000C003C00FC01CC070C1E0C780CE00CE00C780C1C0C
070C03CC00FC003C000C0E107E8F12>I E /Fn 54 123 df<0001FC3C00060E67000C0E
C7001C0DC6001C01C0003801C0003803800038038000380380003803800070038007FFFF
F800700700007007000070070000E0070000E00E0000E00E0000E00E0000E00E0001C00E
0001C01C0001C01C0001C01C0001C01C0003801C00038038000380380003803800030038
00070030000700700006006000C6606000E470C000C8618000703E00002025819C19>11
D<0001FC000703000C03001C07001C0300180000380000380000380000380000700007FF
FC00701C00701C00701C00E03800E03800E03800E03800E07001C07001C07001C07001C0
E201C0E201C0E20380E4038064038038038000030000070000060000C60000E40000CC00
007000001825819C17>I<0001FDC000070FC0000C0FC0001C0F80001C03800038038000
3803800038070000380700003807000070070007FFFE0000700E0000700E0000700E0000
E01C0000E01C0000E01C0000E01C0000E0380001C0380001C0380001C0380001C0710001
C0710003807100038072000380320003801C0003800000030000000700000006000000C6
000000E4000000CC000000700000001A25819C18>I<0001FE0FF0000307380C00060770
0C000C06601C001C00E00C001C00C000001C01C000003801C000003801C000003801C000
003803800003FFFFFFF000700380700070038070007003807000700780E000700700E000
700700E000E00700E000E00701C000E00701C000E00E01C000E00E01C001C00E038801C0
0E038801C00E038801C01C039001C01C019003801C00E003801C00000380380000030038
00000300300000C630300000E638600000CC30C00000781F0000002625819C25>I<183C
3C3C0404080810204080060C779C0D>39 D<00030006000800180030006000C000C00180
03000300060006000C000C001C0018001800380030003000700070006000600060006000
E000E000E000E000E0006000600060006000600020003000100008000800102A7B9E11>
I<001000100008000C000400060006000600060006000700070007000700070006000600
060006000E000E000C000C001C001800180038003000300060006000C000C00180030003
0006000C00180010006000C000102A809E11>I<0030000060000060000060001841803C
47000ECE0007B80001E00003C0000EF00039B800711E00C10C0003000003000003000006
00001112799E15>I<183878380808101020404080050C7D830D>44
D<FFC0FFC0FFC00A037D890F>I<3078F06005047C830D>I<060F0F060000000000000000
00003078F06008127C910D>58 D<03000780078003000000000000000000000000000000
000000000000180038007800380008000800100010002000400040008000091A7D910D>
I<01E006180808100C100C200C400C401C8018E038E070C1E003C007800F001C00380030
80308031001E000000000000000000000030007800F00060000E1E789D15>63
D<0000180000001800000038000000380000007800000078000000B8000001B800000138
000002380000023C0000041C0000041C0000081C0000181C0000101C0000201C0000201C
00007FFC0000401C0000801C0001801C0001001C0002001C0002001C0004000E000C000E
001C001E00FF00FFC01A1D7E9C1F>65 D<01FFFE00003C0780003803C0003801C0003801
C0003801C0007001C0007003C0007003C00070078000E0070000E00E0000E03C0000FFF8
0001C01C0001C00E0001C00F0001C00F0003800F0003800F0003800F0003800F0007001E
0007001C0007003C00070078000E01E000FFFF80001A1C7D9B1D>I<0003F020001E0C60
003002E000E003C001C001C0038001C0070000C00E0000801E0000801C0000803C000080
3C000000780000007800000078000000F0000000F0000000F0000000F0000000F0000400
F0000400F0000400F0000800700008007000100038002000180040000C01800007060000
01F800001B1E7A9C1E>I<01FFFFE0003C00E00038006000380040003800400038004000
70004000700040007020400070200000E0400000E0400000E0C00000FFC00001C0800001
C0800001C0800001C0800003810100038001000380020003800200070004000700040007
000C00070018000E007800FFFFF0001B1C7D9B1C>69 D<0003F020001E0C60003002E000
E003C001C001C0038001C0070000C00E0000801E0000801C0000803C0000803C00000078
0000007800000078000000F0000000F0000000F001FFC0F0001E00F0001C00F0001C00F0
001C00F0001C00700038007000380038003800180078000C0090000707100001F800001B
1E7A9C20>71 D<01FFC0003C000038000038000038000038000070000070000070000070
0000E00000E00000E00000E00001C00001C00001C00001C0000380000380000380000380
000700000700000700000700000F0000FFE000121C7E9B10>73 D<01FFE0003C00003800
00380000380000380000700000700000700000700000E00000E00000E00000E00001C000
01C00001C00001C0000380080380080380080380100700100700300700600700E00E03C0
FFFFC0151C7D9B1A>76 D<01FE0007F8003E000780002E000F00002E001700002E001700
002E002700004E002E00004E004E00004E004E00004E008E00008E011C00008E011C0000
8E021C00008E021C00010704380001070438000107083800010710380002071070000207
20700002072070000207407000040740E000040780E000040700E0000C0700E0001C0601
E000FF861FFC00251C7D9B25>I<01FC03FE001C0070003C0060002E0040002E0040002E
0040004700800047008000470080004380800083810000838100008181000081C1000101
C2000101C2000100E2000100E2000200E400020074000200740002007400040038000400
3800040038000C0018001C001000FF8010001F1C7D9B1F>I<01FFFC00003C0700003803
80003801C0003801C0003801C0007003C0007003C0007003C00070038000E0078000E007
0000E00E0000E0380001FFE00001C0000001C0000001C000000380000003800000038000
0003800000070000000700000007000000070000000F000000FFE000001A1C7D9B1C>80
D<000F8400304C00403C0080180100180300180300180600100600100600000700000700
0003E00003FC0001FF00007F800007C00001C00001C00000C00000C02000C02000C06001
80600180600300600200F00400CC180083E000161E7D9C17>83 D<1FFFFFC01C0701C030
0E00C0200E0080600E0080400E0080401C0080801C0080801C0080001C00000038000000
38000000380000003800000070000000700000007000000070000000E0000000E0000000
E0000000E0000001C0000001C0000001C0000001C0000003C000007FFE00001A1C799B1E
>I<FF83FF0FF03C007001C038007001803800F001003800F00200380170020038017004
00380270040038027008001C047008001C047010001C087010001C087020001C10702000
1C107040001C207040001C207080001C407180001C407100001C807200001D807200001D
007400001E007400001E007800001C007800001C00700000180070000018006000001000
600000241D779B29>87 D<020006001B0031006080C0800906759C15>94
D<03CC063C0C3C181C3838303870387038E070E070E070E070E0E2C0E2C0E261E462643C
380F127B9115>97 D<3F00070007000E000E000E000E001C001C001C001C0039C03E6038
3038307038703870387038E070E070E070E060E0E0C0C0C1C0618063003C000D1D7B9C13
>I<01F007080C08181C3838300070007000E000E000E000E000E000E008E010602030C0
1F000E127B9113>I<001F80000380000380000700000700000700000700000E00000E00
000E00000E0003DC00063C000C3C00181C00383800303800703800703800E07000E07000
E07000E07000E0E200C0E200C0E20061E4006264003C3800111D7B9C15>I<01E007100C
1018083810701070607F80E000E000E000E000E000E0086010602030C01F000D127B9113
>I<0003C0000670000C70001C60001C00001C0000380000380000380000380000380003
FF8000700000700000700000700000700000E00000E00000E00000E00000E00001C00001
C00001C00001C00001C000038000038000038000030000030000070000C60000E60000CC
00007800001425819C0D>I<00F3018F030F06070E0E0C0E1C0E1C0E381C381C381C381C
383830383038187818F00F700070007000E000E0C0C0E1C0C3007E00101A7D9113>I<0F
C00001C00001C0000380000380000380000380000700000700000700000700000E78000E
8C000F0E000E0E001C0E001C0E001C0E001C0E00381C00381C00381C0038380070388070
3880707080707100E03200601C00111D7D9C15>I<018003800100000000000000000000
00000000001C002600470047008E008E000E001C001C001C003800380071007100710072
0072003C00091C7C9B0D>I<0006000E0006000000000000000000000000000000F00118
021802180438043800380038007000700070007000E000E000E000E001C001C001C001C0
03800380C300E700CE0078000F24819B0D>I<0FC00001C00001C0000380000380000380
000380000700000700000700000700000E0F000E11000E23800E43801C83001C80001D00
001E00003F800039C00038E00038E00070E20070E20070E20070E400E06400603800111D
7D9C13>I<1F800380038007000700070007000E000E000E000E001C001C001C001C0038
003800380038007000700070007000E400E400E400E40068003800091D7C9C0B>I<3C1E
0780266318C04683A0E04703C0E08E0380E08E0380E00E0380E00E0380E01C0701C01C07
01C01C0701C01C070380380E0388380E0388380E0708380E0710701C0320300C01C01D12
7C9122>I<3C3C002646004687004707008E07008E07000E07000E07001C0E001C0E001C
0E001C1C00381C40381C40383840383880701900300E0012127C9117>I<01E007180C0C
180C380C300E700E700EE01CE01CE01CE018E038E030E06060C031801E000F127B9115>
I<07870004D98008E0C008E0C011C0E011C0E001C0E001C0E00381C00381C00381C00381
800703800703000707000706000E8C000E70000E00000E00001C00001C00001C00001C00
003C0000FF8000131A7F9115>I<03C4062C0C3C181C3838303870387038E070E070E070
E070E0E0C0E0C0E061E063C03DC001C001C0038003800380038007803FF00E1A7B9113>
I<3C3C26C2468747078E068E000E000E001C001C001C001C003800380038003800700030
0010127C9112>I<01F006080C080C1C18181C001F001FC00FF007F0007800386030E030
C030806060C01F000E127D9111>I<00C001C001C001C00380038003800380FFE0070007
0007000E000E000E000E001C001C001C001C00384038403840388019000E000B1A7D990E
>I<1E0300270700470700470700870E00870E000E0E000E0E001C1C001C1C001C1C001C
1C003838803838801838801839001C5900078E0011127C9116>I<1E06270E470E470687
0287020E020E021C041C041C041C0818083808181018200C4007800F127C9113>I<1E01
832703874703874703838707018707010E07010E07011C0E021C0E021C0E021C0E04180C
04181C04181C081C1C100C263007C3C018127C911C>I<070E0019910010E38020E38041
C30041C00001C00001C000038000038000038000038000070200670200E70400CB04008B
080070F00011127D9113>I<1E03270747074707870E870E0E0E0E0E1C1C1C1C1C1C1C1C
38383838183818381C7007F00070007000E0E0C0E1C0818047003C00101A7C9114>I<03
8207C20FEC08381008001000200040008001000200040008081008383067F043E081C00F
127D9111>I E /Fo 17 107 df<FFFFFF80FFFFFF8019027D8A20>0
D<400020C000606000C03001801803000C0600060C0003180001B00000E00000E00001B0
00031800060C000C06001803003001806000C0C0006040002013147A9320>2
D<03C00FF01FF83FFC7FFE7FFEFFFFFFFFFFFFFFFF7FFE7FFE3FFC1FF80FF003C010107E
9115>15 D<FFFFFFE07FFFFFE00000000000000000000000000000000000000000000000
0000000000FFFFFFE0FFFFFFE00000000000000000000000000000000000000000000000
00000000007FFFFFE0FFFFFFE01B147E9320>17 D<000001800000078000001E00000078
000001E00000078000001E00000078000001E00000078000001E00000078000000E00000
00780000001E0000000780000001E0000000780000001E0000000780000001E000000078
0000001E0000000780000001800000000000000000000000000000000000000000000000
00000000007FFFFF00FFFFFF8019227D9920>20 D<000000040000000002000000000200
000000010000000000800000000040FFFFFFFFF8FFFFFFFFF80000000040000000008000
00000100000000020000000002000000000400250E7E902A>33 D<01000300030007800B
401320631883040300030003000300030003000300030003000300030003000300030003
00030003000300030003000300030003000300030003000300030003000E257D9C15>I<
030003000300030003000300030003000300030003000300030003000300030003000300
030003000300030003000300030003000300030003008304631813200B40078003000300
01000E257D9C15>I<00060000000006000000000C000000000C00000000180000000030
000000007FFFFFF000FFFFFFF8038000000007000000003C00000000F0000000003C0000
00000E00000000030000000001C000000000FFFFFFF8007FFFFFF0003000000000180000
00000C000000000C0000000006000000000600000025187E952A>40
D<0000030000000003000000000180000000018000000000C00000000060007FFFFFF000
FFFFFFF8000000000E00000000070000000001E0000000007800000001E0000000038000
000006000000001C00FFFFFFF8007FFFFFF0000000006000000000C00000000180000000
0180000000030000000003000025187E952A>I<C0C0C0C0C0C0E0E0C0C0C0C0C0C0030E
7E9000>55 D<0008001803D80C301838303C303C706E606660666066E0C7E0C7E0C7E0C7
E187E187E187E187E187E307E307E307E307E60766066606760E3C0C3C0C1C180C301BC0
1800180010237E9F15>59 D<400002C00006C00006C00006C00006C00006C00006C00006
C00006C00006C00006C00006C00006C00006C00006C00006C00006C00006C0000660000C
60000C3000181C00700F01E003FF8000FE00171A7E981C>91 D<00FE0003FF800F01E01C
007030001860000C60000CC00006C00006C00006C00006C00006C00006C00006C00006C0
0006C00006C00006C00006C00006C00006C00006C00006C00006C00006400002171A7E98
1C>I<008001800300030003000600060006000C000C000C001800180018003000300030
00600060006000C000C0006000600060003000300030001800180018000C000C000C0006
000600060003000300030001800080092A7C9E10>104 D<C000C0006000600060003000
300030001800180018000C000C000C000600060006000300030003000180018003000300
03000600060006000C000C000C00180018001800300030003000600060006000C000C000
092A7E9E10>I<C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C002297B9E0C>I E /Fp 54 124 df<00FCF807839C0E079C
1C07081C07001C07001C07001C07001C0700FFFFE01C07001C07001C07001C07001C0700
1C07001C07001C07001C07001C07001C07001C0700FF1FE01617809615>11
D<00FC000782000E07001C07001C02001C00001C00001C00001C0000FFFF001C07001C07
001C07001C07001C07001C07001C07001C07001C07001C07001C07001C0700FF1FE01317
809614>I<60F0F0F0F0F06060606060606060600000000060F0F06004177D960A>33
D<60F0F070101020204040040A7D960A>39 D<0102040C1818303070606060E0E0E0E0E0
E0E0E0E0E060606070303018180C04020108227D980E>I<8040203018180C0C0E060606
070707070707070707070606060E0C0C18183020408008227E980E>I<60F0F070101020
204040040A7D830A>44 D<60F0F06004047D830A>46 D<07C018303018701C600C600CE0
0EE00EE00EE00EE00EE00EE00EE00EE00E600C600C701C30181C7007C00F157F9412>48
D<03000700FF000700070007000700070007000700070007000700070007000700070007
00070007007FF00C157E9412>I<0F8030E040708030C038E03840380038007000700060
00C00180030006000C08080810183FF07FF0FFF00D157E9412>I<0FE030306018701C70
1C001C00180038006007E000300018000C000E000EE00EE00EC00C401830300FE00F157F
9412>I<00300030007000F001F001700270047008701870107020704070C070FFFE0070
007000700070007003FE0F157F9412>I<20303FE03FC0240020002000200020002F8030
E020700030003800384038E038E0388030406020C01F000D157E9412>I<01F00608080C
181C301C70006000E000E3E0EC30F018F00CE00EE00EE00E600E600E300C3018183007C0
0F157F9412>I<40007FFE7FFC7FF8C00880108020004000800080010001000300020006
0006000E000E000E000E000E0004000F167E9512>I<07E018302018600C600C700C7818
3E101F600FC00FF018F8607C601EC00EC006C006C004600C38300FE00F157F9412>I<07
C0183030186018E00CE00CE00EE00EE00E601E301E186E0F8E000E000C001C7018701860
3020C01F800F157F9412>I<60F0F06000000000000060F0F060040E7D8D0A>I<1F8060E0
8070E070E070407000E001C0018003000200020002000200020000000000000000000600
0F000F0006000C177E9611>63 D<001000003800003800003800005C00005C00005C0000
8E00008E00008E0001070001070003078002038002038007FFC00401C00401C00800E008
00E01800E03800F0FE03FE17177F961A>65 D<FFFF001C01C01C00E01C00301C00381C00
181C001C1C000C1C000E1C000E1C000E1C000E1C000E1C000E1C000E1C000C1C001C1C00
1C1C00381C00301C00601C01C0FFFF0017177F961B>68 D<FFFFE01C00E01C00601C0020
1C00101C00101C00101C04001C04001C04001C0C001FFC001C0C001C04001C04081C0408
1C00081C00181C00101C00101C00301C00F0FFFFF015177F9618>I<FFE00E000E000E00
0E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E00
FFE00B177F960D>73 D<FC00FE1E00381F001017001013801011C01011C01010E0101070
10103810103810101C10100E10100F101007101003901001D01001D01000F01000701000
30380030FE001017177F961A>78 D<00FC000303000E01C01C00E0380070300030700038
600018E0001CE0001CE0001CE0001CE0001CE0001CE0001C700038700038300030380070
1C00E00E01C003030000FC0016177E961B>I<7FFFF86038184038084038088038048038
048038040038000038000038000038000038000038000038000038000038000038000038
0000380000380000380000380007FFC016177F9619>84 D<FF80FE1C00381C00101C0010
1C00101C00101C00101C00101C00101C00101C00101C00101C00101C00101C00101C0010
1C00101C00100E0020060020030040018180007E0017177F961A>I<FF07FC3F803C01E0
0E001C00E004001C00E004001C017004000E017008000E017008000E0238080007023810
00070238100007041C100003841C200003841C200003880E200001C80E400001C80E4000
01D80F400000F007800000F007800000F007800000600300000060030000006003000021
177F9624>87 D<1FC0386038301038003803F81E3830387038E039E039E07970FF1F1E10
0E7F8D12>97 D<FC00001C00001C00001C00001C00001C00001C00001C00001C00001CF8
001F06001C03001C03801C01801C01C01C01C01C01C01C01C01C01801C03801C03001B0E
0010F8001217809614>I<07F01838303870106000E000E000E000E00060007008300818
3007C00D0E7F8D10>I<007E00000E00000E00000E00000E00000E00000E00000E00000E
0007CE001C3E00300E00700E00600E00E00E00E00E00E00E00E00E00600E00700E00301E
00182E0007CFC012177F9614>I<0FC0186030307038E018FFF8E000E000E00060007008
3010183007C00D0E7F8D10>I<03E006700E701C201C001C001C001C001C00FF801C001C
001C001C001C001C001C001C001C001C001C001C00FF800C1780960B>I<0F9E18E33060
707070707070306018C02F80200060003FE03FF83FFC600EC006C006C006600C38380FE0
10157F8D12>I<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C7C
001D8E001E07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C07
00FF9FE01317809614>I<183C3C1800000000007C1C1C1C1C1C1C1C1C1C1C1C1CFF0817
80960A>I<0300078007800300000000000000000000001F800380038003800380038003
800380038003800380038003800380038003804380E300E7007C00091D82960B>I<FC00
001C00001C00001C00001C00001C00001C00001C00001C00001C3F801C1C001C18001C20
001C40001CC0001FE0001CF0001C70001C78001C3C001C1E001C1E00FF3FC01217809613
>I<FC001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C001C001C00FF80091780960A>I<FC7C1F001D8E63801E0781C01C0701C01C
0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C0FF
9FE7F81D0E808D1E>I<FC7C001D8E001E07001C07001C07001C07001C07001C07001C07
001C07001C07001C07001C0700FF9FE0130E808D14>I<07C018303018600C600CE00EE0
0EE00EE00EE00E701C3018183007C00F0E7F8D12>I<FCF8001F0E001C03001C03801C01
801C01C01C01C01C01C01C01C01C01801C03801C07001F0E001CF8001C00001C00001C00
001C00001C0000FF80001214808D14>I<FCF01D381E381C101C001C001C001C001C001C
001C001C001C00FF800D0E808D0E>114 D<1F4060C0C040C040E000FF007F801FC001E0
80608060C060E0C09F000B0E7F8D0E>I<080008000800180018003800FF803800380038
00380038003800380038403840384038401C800F000A147F930E>I<FC3F001C07001C07
001C07001C07001C07001C07001C07001C07001C07001C07001C0F000E170003E7E0130E
808D14>I<FE1F3C0E3C0C1C081C080E100E100720072003C003C003C001800180100E7F
8D13>I<FCFE7C3838383838101C3C201C3C201C4C200E4E400E4E400E86400787800787
80070380030300030300160E7F8D19>I<FE3F3C181C100E20074007C0038001C002E004
F008701838383CFC7F100E7F8D13>I<FE1F3C0E3C0C1C081C080E100E100720072003C0
03C003C00180018001000100E200E200A400780010147F8D13>I<FFFF801101808812>
123 D E /Fq 19 117 df<0001FF0000000FFFE000003FFFF80000FF83FE0001FE00FF00
03F8003F8007F8003FC00FF0001FE00FE0000FE01FE0000FF01FE0000FF03FE0000FF83F
E0000FF83FC00007F87FC00007FC7FC00007FC7FC00007FC7FC00007FC7FC00007FCFFC0
0007FEFFC00007FEFFC00007FEFFC00007FEFFC00007FEFFC00007FEFFC00007FEFFC000
07FEFFC00007FEFFC00007FEFFC00007FEFFC00007FEFFC00007FEFFC00007FEFFC00007
FEFFC00007FEFFC00007FEFFC00007FEFFC00007FE7FC00007FC7FC00007FC7FC00007FC
7FC00007FC7FC00007FC3FE0000FF83FE0000FF83FE0000FF81FE0000FF01FE0000FF00F
F0001FE00FF0001FE007F8003FC003FC007F8001FE00FF0000FF83FE00007FFFFC00001F
FFF0000001FF000027397CB730>48 D<00003C000000007C00000001FC00000007FC0000
003FFC0000FFFFFC0000FFFFFC0000FFFFFC0000FFCFFC0000000FFC0000000FFC000000
0FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000F
FC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC
0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC00
00000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000
000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC0000000FFC000000
0FFC0000000FFC0000000FFC0000000FFC0000000FFC00007FFFFFFF807FFFFFFF807FFF
FFFF807FFFFFFF80213879B730>I<0007FC0000007FFFC00001FFFFF00003FFFFFC0007
E01FFE000F8007FF001E0003FF803C0001FFC07E0000FFE07F80007FE07FC0007FF0FFC0
007FF0FFE0003FF8FFE0003FF8FFE0003FF8FFE0003FF87FC0003FF83F80003FF81F0000
3FF80000003FF80000003FF00000007FF00000007FE00000007FE0000000FFC0000000FF
80000001FF80000001FF00000003FE00000007FC00000007F80000000FE00000001FC000
00003F800000007F00000000FC00000001F800000001F000000003E00078000780007800
0F000078001E000078003C0000F000780000F000F00000F001E00001F003FFFFFFF007FF
FFFFF00FFFFFFFF01FFFFFFFF03FFFFFFFF07FFFFFFFE0FFFFFFFFE0FFFFFFFFE0FFFFFF
FFE0FFFFFFFFE025387BB730>I<0003FF0000001FFFF000007FFFFC0000FE03FE0001F0
01FF0003C000FF800780007FC00FE0007FE00FF0007FE01FF8007FF01FFC007FF01FFC00
7FF01FFC007FF01FFC007FF00FF8007FF007F0007FE003E0007FE0008000FFE0000000FF
C0000000FF80000001FF00000001FE00000003FC00000007F80000001FF000000FFFC000
000FFF8000000FFFF000000003FE00000000FF000000007FC00000007FE00000003FF000
00003FF80000001FF80000001FFC0000001FFC0000001FFE0000001FFE1F80001FFE3FC0
001FFE7FE0001FFEFFF0001FFEFFF0001FFEFFF0001FFCFFF0001FFCFFF0001FFCFFE000
3FF87FC0003FF87F80007FF03E00007FE01FC000FFC00FF803FF8007FFFFFF0001FFFFFC
00007FFFF0000007FF000027397CB730>I<0000000F80000000000F80000000001F8000
0000003F80000000007F8000000000FF8000000000FF8000000001FF8000000003FF8000
000007FF8000000007FF800000000FFF800000001EFF800000003EFF800000007CFF8000
000078FF80000000F0FF80000001E0FF80000003E0FF80000003C0FF8000000780FF8000
000F00FF8000001F00FF8000003E00FF8000003C00FF8000007800FF800000F000FF8000
01F000FF800001E000FF800003C000FF8000078000FF80000F8000FF80001F0000FF8000
1E0000FF80003C0000FF8000780000FF8000F80000FF8000FFFFFFFFFF80FFFFFFFFFF80
FFFFFFFFFF80FFFFFFFFFF80000001FF8000000001FF8000000001FF8000000001FF8000
000001FF8000000001FF8000000001FF8000000001FF8000000001FF8000000001FF8000
0003FFFFFF800003FFFFFF800003FFFFFF800003FFFFFF8029377DB630>I<0400000180
0F80000F800FF800FF800FFFFFFF000FFFFFFE000FFFFFFC000FFFFFF8000FFFFFF0000F
FFFFE0000FFFFF80000FFFFF00000FFFF800000F1F8000000F000000000F000000000F00
0000000F000000000F000000000F000000000F000000000F000000000F03FF00000F0FFF
E0000F3FFFF8000FFC03FC000FF001FE000FC000FF000F80007F800F00007FC00600007F
E00000003FE00000003FF00000003FF00000003FF00000003FF80000003FF80000003FF8
1F00003FF83F80003FF87FC0003FF8FFC0003FF8FFE0003FF8FFE0003FF8FFE0003FF0FF
C0003FF0FF80003FF07F00007FE07C00007FE03C00007FC03E0000FF801F0001FF000FC0
03FE0007F00FFC0003FFFFF80001FFFFE000007FFF8000000FF8000025397BB730>I<00
000FF8000000FFFE000003FFFF80000FF80FC0001FE003E0007F8001F000FF0003F001FE
0007F003FC000FF803FC001FF807F8001FF80FF8001FF80FF0001FF81FF0000FF01FF000
07E03FF00003C03FF00000003FE00000007FE00000007FE00000007FE00000007FE07FF0
00FFE1FFFC00FFE3FFFE00FFE7007F80FFEE003FC0FFEC001FE0FFF8001FF0FFF8001FF0
FFF0000FF8FFF0000FF8FFF0000FFCFFF0000FFCFFE0000FFEFFE0000FFEFFE0000FFEFF
E0000FFE7FE0000FFE7FE0000FFE7FE0000FFE7FE0000FFE7FE0000FFE3FE0000FFE3FE0
000FFE3FE0000FFC1FF0000FFC1FF0000FF80FF0000FF80FF0001FF007F8001FF003FC00
3FE001FE007FC000FF81FF80007FFFFE00003FFFFC00000FFFF0000001FF800027397CB7
30>I<3C00000000003E00000000003FE0000000003FFFFFFFFF803FFFFFFFFF803FFFFF
FFFF803FFFFFFFFF803FFFFFFFFF007FFFFFFFFE007FFFFFFFFC007FFFFFFFF8007FFFFF
FFF0007FFFFFFFF0007C000003E00078000007C0007800000F80007800000F0000F00000
1E0000F000003E0000F000007C0000F00000F80000000000F00000000001E00000000003
E00000000007C0000000000780000000000F80000000001F80000000001F00000000003F
00000000003F00000000007F00000000007E0000000000FE0000000000FE0000000000FE
0000000001FE0000000001FE0000000003FC0000000003FC0000000003FC0000000003FC
0000000007FC0000000007FC0000000007FC0000000007FC0000000007FC000000000FFC
000000000FFC000000000FFC000000000FFC000000000FFC000000000FFC000000000FFC
000000000FFC000000000FFC0000000007F80000000007F80000000001E0000000293B7B
B930>I<0001FF8000000FFFF000003FFFFC00007E01FE0001F0003F0003E0001F8003C0
000FC007C00007E00F800007E00F800003F00F800003F01F800003F01F800003F01FC000
03F01FC00003F01FE00003F01FF80007E01FFE0007E00FFF8007C00FFFC00FC00FFFF01F
8007FFFC3F0007FFFFFE0003FFFFF80001FFFFE00000FFFFF800007FFFFE00001FFFFF00
003FFFFF8000FFFFFFC003F8FFFFE007F03FFFF00FE00FFFF81FC007FFF83F8001FFFC3F
80007FFC7F00001FFE7F00000FFEFE000003FEFE000001FEFE000001FEFE000000FEFE00
0000FEFE000000FEFE000000FCFE000000FC7F000000FC7F000001F83F800001F83F8000
03F01FE00007E00FF0001FC007FE00FF8003FFFFFF0000FFFFFC00003FFFF0000003FF80
0027397CB730>I<0003FF0000001FFFE000007FFFF80000FF01FC0003FC00FF0007F800
7F800FF0003F801FF0001FC01FF0001FE03FE0001FE07FE0001FF07FE0000FF07FE0000F
F8FFE0000FF8FFE0000FF8FFE0000FFCFFE0000FFCFFE0000FFCFFE0000FFCFFE0000FFE
FFE0000FFEFFE0000FFEFFE0000FFE7FE0000FFE7FE0001FFE7FE0001FFE3FE0001FFE3F
E0001FFE1FF0003FFE0FF0003FFE0FF0006FFE07F800EFFE03FC01CFFE00FFFF8FFE007F
FF0FFE001FFC0FFC0000000FFC0000000FFC0000000FFC0000000FF80000001FF8078000
1FF80FC0001FF01FE0001FF03FF0001FE03FF0003FE03FF0003FC03FF0007FC03FE0007F
801FC000FF001F8001FE000F8007FC000FE01FF80007FFFFE00001FFFFC00000FFFE0000
001FF0000027397CB730>I<0000001FFE000060000003FFFFE000E000001FFFFFF801E0
00007FFFFFFE03E00001FFFC00FF07E00007FFC0001FCFE0000FFF000007FFE0001FFC00
0001FFE0003FF0000000FFE0007FE00000007FE000FFC00000003FE001FF800000001FE0
03FF000000000FE007FF000000000FE00FFE0000000007E00FFE0000000007E01FFC0000
000003E01FFC0000000003E03FF80000000003E03FF80000000001E03FF80000000001E0
7FF80000000001E07FF80000000001E07FF00000000000007FF0000000000000FFF00000
00000000FFF0000000000000FFF0000000000000FFF0000000000000FFF0000000000000
FFF0000000000000FFF0000000000000FFF0000000000000FFF0000000000000FFF00000
00000000FFF00000000000007FF00000000000007FF00000000000007FF8000000000000
7FF80000000001E03FF80000000001E03FF80000000001E03FF80000000001E01FFC0000
000001E01FFC0000000003C00FFE0000000003C00FFE0000000003C007FF000000000780
03FF00000000078001FF800000000F0000FFC00000001F00007FE00000003E00003FF000
00007C00001FFC000000F800000FFF000003F0000007FFC0000FE0000001FFFC007F8000
00007FFFFFFF000000001FFFFFFC0000000003FFFFE000000000001FFE0000003B3D7BBB
46>67 D<FFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE003FF800003FF800003FF800003FF800
003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800
003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800
003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800
003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800
003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800003FF800
003FF800003FF800FFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE1F3B7EBA24>73
D<FFFFFFFFFF0000FFFFFFFFFFF000FFFFFFFFFFFC00FFFFFFFFFFFF00007FF0000FFFC0
007FF00001FFE0007FF000007FF0007FF000003FF8007FF000001FFC007FF000001FFC00
7FF000001FFE007FF000000FFE007FF000000FFE007FF000000FFF007FF000000FFF007F
F000000FFF007FF000000FFF007FF000000FFF007FF000000FFF007FF000000FFF007FF0
00000FFE007FF000000FFE007FF000001FFE007FF000001FFC007FF000001FF8007FF000
003FF8007FF000007FF0007FF00001FFE0007FF0000FFF80007FFFFFFFFF00007FFFFFFF
FC00007FFFFFFFC000007FF000000000007FF000000000007FF000000000007FF0000000
00007FF000000000007FF000000000007FF000000000007FF000000000007FF000000000
007FF000000000007FF000000000007FF000000000007FF000000000007FF00000000000
7FF000000000007FF000000000007FF000000000007FF000000000007FF000000000007F
F000000000007FF000000000007FF000000000007FF000000000FFFFFFF8000000FFFFFF
F8000000FFFFFFF8000000FFFFFFF8000000383B7CBA42>80 D<003FFE00000001FFFFE0
000007FFFFF800000FE007FC00000FF001FE00001FF800FF00001FF8007F80001FF8007F
C0001FF8003FC0000FF0003FE00007E0003FE00003C0003FE0000000003FE0000000003F
E0000000003FE0000000003FE0000000FFFFE000001FFFFFE000007FF83FE00003FF803F
E00007FC003FE0000FF0003FE0001FE0003FE0003FE0003FE0007FC0003FE0007FC0003F
E000FF80003FE000FF80003FE000FF80003FE000FF80003FE000FF80007FE0007FC0007F
E0007FC000DFE0003FE0039FF0001FF80F0FFFE007FFFE0FFFE001FFF807FFE0003FE000
FFE02B267DA52F>97 D<0001FF8000000FFFF000003FFFFC0000FF81FE0003FE007F8007
F8003F800FF8001FC00FF0000FE01FE0000FE03FE0000FF03FE00007F07FC00007F07FC0
0007F87FC00007F8FFC00007F8FFC00007F8FFFFFFFFF8FFFFFFFFF8FFFFFFFFF8FFC000
0000FFC0000000FFC0000000FFC00000007FC00000007FC00000007FC00000003FE00000
003FE00000781FE00000781FF00000780FF00000F007F80001F003FC0003E001FE000FC0
00FFC07F80003FFFFE00000FFFF8000000FFC00025267DA52C>101
D<00FE00000000FFFE00000000FFFE00000000FFFE00000000FFFE0000000007FE000000
0003FE0000000003FE0000000003FE0000000003FE0000000003FE0000000003FE000000
0003FE0000000003FE0000000003FE0000000003FE0000000003FE0000000003FE000000
0003FE0000000003FE0000000003FE0000000003FE0000000003FE00FF800003FE03FFF0
0003FE0FFFF80003FE1E03FC0003FE3801FE0003FE6001FF0003FEC000FF0003FFC000FF
8003FF8000FF8003FF0000FF8003FF0000FF8003FF0000FF8003FE0000FF8003FE0000FF
8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF
8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF
8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF8003FE0000FF
8003FE0000FF8003FE0000FF80FFFFF83FFFFEFFFFF83FFFFEFFFFF83FFFFEFFFFF83FFF
FE2F3C7CBB36>104 D<00FE01FF0000FFFE1FFFF000FFFE7FFFFC00FFFEFC07FE00FFFF
F001FF0007FFC0007F8003FF00003FC003FE00003FE003FE00001FF003FE00001FF803FE
00000FF803FE00000FFC03FE00000FFC03FE000007FC03FE000007FE03FE000007FE03FE
000007FE03FE000007FE03FE000007FE03FE000007FE03FE000007FE03FE000007FE03FE
000007FE03FE000007FC03FE00000FFC03FE00000FFC03FE00000FFC03FE00000FF803FE
00001FF003FE00001FF003FF00003FE003FF80007FC003FFC000FF8003FFE001FF0003FE
FC07FE0003FE7FFFF80003FE1FFFE00003FE03FE000003FE0000000003FE0000000003FE
0000000003FE0000000003FE0000000003FE0000000003FE0000000003FE0000000003FE
0000000003FE0000000003FE0000000003FE0000000003FE00000000FFFFF8000000FFFF
F8000000FFFFF8000000FFFFF80000002F377DA536>112 D<01FC03F000FFFC0FFC00FF
FC1FFF00FFFC3C3F80FFFC707F8007FCE0FFC003FCC0FFC003FD80FFC003FD80FFC003FF
807F8003FF003F0003FF001E0003FF00000003FE00000003FE00000003FE00000003FE00
000003FE00000003FE00000003FE00000003FE00000003FE00000003FE00000003FE0000
0003FE00000003FE00000003FE00000003FE00000003FE00000003FE00000003FE000000
03FE00000003FE00000003FE000000FFFFFC0000FFFFFC0000FFFFFC0000FFFFFC000022
267DA528>114 D<000F0000000F0000000F0000000F0000000F0000001F0000001F0000
001F0000001F0000003F0000003F0000007F0000007F000000FF000001FF000003FF0000
07FF00001FFFFFF0FFFFFFF0FFFFFFF0FFFFFFF001FF000001FF000001FF000001FF0000
01FF000001FF000001FF000001FF000001FF000001FF000001FF000001FF000001FF0000
01FF000001FF000001FF000001FF000001FF000001FF000001FF003C01FF003C01FF003C
01FF003C01FF003C01FF003C01FF003C01FF003C00FF007800FF8078007F80F0003FC1E0
001FFFC0000FFF800001FE001E377EB626>116 D E /Fr 93 127
df<60F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0600000000060F0F0600419779816>33
D<E038F078F078F078F078F078F078F078E038E03860300D0B7C9816>I<038700038700
0387000387000387000387007FFFC0FFFFE0FFFFE0070E00070E00070E000E1C000E1C00
0E1C000E1C00FFFFE0FFFFE07FFFC01C38001C38001C38001C38001C38001C380013197F
9816>I<00C00001C00001C00001C00007F0001FFC003FFE007DCF0071C780E1C380E1C7
80E1C780F1C30079C0003FC0001FF00007FC0001FE0001CF0001C70061C380F1C380F1C3
80E1C38071C70079DF003FFE001FF80007E00001C00001C00000C00011207E9C16>I<38
01807C03807C0380EE0700EE0700EE0E00EE0E00EE0E00EE1C007C1C007C380038380000
700000700000700000E00000E00001C00001C00001C0000380000383800707C00707C00E
0EE00E0EE00E0EE01C0EE01C0EE03807C03807C018038013207F9C16>I<03800007E000
0FE0001E70001C70001C70001C70001C77E01CE7E01DE7E00FC7000F8E000F0E001E0E00
3F1C007F1C00739C00E3F800E1F800E0F1C0E0F1C071F9C07FFFC03F9F801E070013197F
9816>I<30787C3C1C1C1C1C3878F0E040060D789816>I<00E001E0038007000E001C001C
0038003800700070007000E000E000E000E000E000E000E000E000E00070007000700038
0038001C001C000E000700038001E000E00B217A9C16>I<C000E000700038001C000E00
0E000700070003800380038001C001C001C001C001C001C001C001C001C0038003800380
070007000E000E001C0038007000E000C0000A217B9C16>I<01C00001C00001C00001C0
0071C700F9CF807FFF001FFC0007F00007F0001FFC007FFF00F9CF8071C70001C00001C0
0001C00001C00011127E9516>I<01C00001C00001C00001C00001C00001C00001C00001
C000FFFF80FFFF80FFFF8001C00001C00001C00001C00001C00001C00001C00001C00011
137E9516>I<387C7E7E3E0E1E1C78F060070B798416>I<FFFF80FFFF80FFFF8011037E8D
16>I<70F8F8F8700505788416>I<000180000380000380000700000700000E00000E0000
1C00001C0000380000380000700000700000E00000E00001C00001C00003800003800007
00000700000E00000E00001C00001C0000380000380000700000700000E00000E00000C0
000011207E9C16>I<03E0000FF8001FFC001E3C00380E00780F00700700700700E00380
E00380E00380E00380E00380E00380E00380E00380F00780700700700700780F003C1E00
1E3C001FFC000FF80003E00011197E9816>I<01800380038007800F807F80FF80738003
8003800380038003800380038003800380038003800380038003807FF87FFC7FF80E197C
9816>I<07E0001FF8003FFC00783E00E00700F00780F003806003800003800003800007
00000700000E00001C0000380000700000E00001C0000380000F00001E03803803807FFF
80FFFF807FFF8011197E9816>I<07E0001FF8003FFC00781E0078070030070000070000
0700000E00003E0007FC0007F00007FC00001E00000700000300000380000380600380F0
0380E00700781E003FFC001FF80007E00011197E9816>I<007C0000FC0000DC0001DC00
039C00039C00071C000F1C000E1C001E1C003C1C00381C00781C00F01C00FFFFE0FFFFE0
FFFFE0001C00001C00001C00001C00001C0001FFC001FFC001FFC013197F9816>I<3FFE
003FFE003FFE003800003800003800003800003800003800003800003BF0003FFC003FFE
003C0F00300700000380000380600380F00380F00380E00700781E003FFC001FF80007E0
0011197E9816>I<00F80003FC0007FE000F07001C0F00380F00780600700000700000E3
F800EFFC00FFFE00F80F00F00700F00380E00380E003807003807003807007803807003C
1E001FFC000FF80003E00011197E9816>I<E00000FFFF80FFFF80FFFF80E00F00E01E00
001C0000380000780000700000E00000E00001C00001C00001C000038000038000038000
038000070000070000070000070000070000070000070000111A7E9916>I<07F0001FFC
003FFE007C1F00F00780E00380E00380E003807007007C1F001FFC0007F0001FFC003C1E
00700700F00780E00380E00380E00380F007807007007C1F003FFE001FFC0007F0001119
7E9816>I<03E0000FF8001FFC003C1E00700E00700700E00700E00780E00380E00380E0
0780700780780F803FFF801FFB800FE380000700000700300700780E00781C007078003F
F0001FE0000F800011197E9816>I<70F8F8F870000000000000000070F8F8F870051278
9116>I<387C7C7C38000000000000000038787C7C3C1C1C3870E0400618799116>I<0001
80000780001F80003E0000F80001F00007C0000F80003E0000FC0000F00000FC00003E00
000F800007C00001F00000F800003E00001F8000078000018011157E9616>I<7FFF00FF
FF80FFFF80000000000000000000000000000000FFFF80FFFF807FFF00110B7E9116>I<
C00000F00000FC00003E00000F800007C00001F00000F800003E00001F80000780001F80
003E0000F80001F00007C0000F80003E0000FC0000F00000C0000011157E9616>I<0FE0
3FF87FFCF01EF00EF00E601E003C007800F001C003800380038003800380030000000000
0000000003000780078003000F197D9816>I<00F80003FC0007FE000F07001C3F80387F
8078FF8071C3C071C3C0E381C0E381C0E381C0E381C0E381C0E381C0E381C071C38071C3
8078FF00387E001C3C000F03C007FFC003FF0000FC0012197E9816>I<00E00001F00001
F00001B00001B00003B80003B80003B800031800071C00071C00071C00071C00071C000E
0E000E0E000FFE000FFE001FFF001C07001C07001C07007F1FC0FF1FE07F1FC013197F98
16>I<7FF800FFFE007FFF001C0F001C07801C03801C03801C03801C07801C07001FFF00
1FFE001FFE001C1F001C03801C03C01C01C01C01C01C01C01C01C01C03C01C07807FFF80
FFFF007FFC0012197F9816>I<01F18007FB800FFF801F0F803C07803803807003807003
80F00000E00000E00000E00000E00000E00000E00000E00000F000007003807003803803
803C07001F0F000FFE0007FC0001F00011197E9816>I<7FF800FFFE007FFF001C0F001C
07801C03C01C01C01C01C01C01E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C
00E01C01C01C01C01C03C01C07801C0F807FFF00FFFE007FF8001319809816>I<7FFFC0
FFFFC07FFFC01C01C01C01C01C01C01C01C01C00001C00001C1C001C1C001FFC001FFC00
1FFC001C1C001C1C001C00001C00E01C00E01C00E01C00E01C00E07FFFE0FFFFE07FFFE0
13197F9816>I<FFFFE0FFFFE0FFFFE01C00E01C00E01C00E01C00E01C00001C00001C1C
001C1C001FFC001FFC001FFC001C1C001C1C001C00001C00001C00001C00001C00001C00
00FF8000FFC000FF800013197F9816>I<03E30007FF000FFF001E1F003C0F0038070070
0700700700F00000E00000E00000E00000E00000E03F80E07FC0E03F80F0070070070070
0700380F003C0F001E1F000FFF0007F70003E70012197E9816>I<7F1FC0FFBFE07F1FC0
1C07001C07001C07001C07001C07001C07001C07001FFF001FFF001FFF001C07001C0700
1C07001C07001C07001C07001C07001C07001C07007F1FC0FFBFE07F1FC013197F9816>
I<FFFEFFFEFFFE0380038003800380038003800380038003800380038003800380038003
800380038003800380FFFEFFFEFFFE0F197D9816>I<07FE07FF07FE0038003800380038
0038003800380038003800380038003800380038003800386038F038F0707FF07FE01F80
10197D9816>I<7F0FE0FF8FF07F0FE01C07801C0F001C0E001C1C001C3C001C78001CF0
001CE0001DF0001FF0001FF8001F38001E1C001C1C001C0E001C0E001C07001C07001C03
807F07E0FF8FF07F07E01419809816>I<FFC000FFC000FFC0001C00001C00001C00001C
00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00401C
00E01C00E01C00E01C00E0FFFFE0FFFFE0FFFFE013197F9816>I<FC07E0FE0FE0FE0FE0
3A0B803B1B803B1B803B1B803B1B803B1B803BBB8039B38039B38039B38039B38039F380
38E38038E380380380380380380380380380380380FE0FE0FE0FE0FE0FE013197F9816>
I<7E1FC0FF3FE07F1FC01D07001D87001D87001D87001DC7001DC7001CC7001CC7001CE7
001CE7001CE7001C67001C67001C77001C77001C37001C37001C37001C17007F1F00FF9F
007F0F0013197F9816>I<1FFC003FFE007FFF00780F00F00780E00380E00380E00380E0
0380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380F00780F0
0780780F007FFF003FFE001FFC0011197E9816>I<7FF800FFFE007FFF001C0F801C0380
1C03C01C01C01C01C01C01C01C03C01C03801C0F801FFF001FFE001FF8001C00001C0000
1C00001C00001C00001C00001C00007F0000FF80007F000012197F9816>I<7FE000FFF8
007FFC001C1E001C0F001C07001C07001C07001C07001C0F001C1E001FFC001FF8001FFC
001C1C001C0E001C0E001C0E001C0E001C0E201C0E701C0E707F07E0FF87E07F03C01419
7F9816>82 D<07E3001FFF003FFF00781F00F00700E00700E00700E00000F00000780000
3F80001FF00007FC0000FE00000F00000700000380000380600380E00380E00700F80F00
FFFE00FFFC00C7F00011197E9816>I<7FFFE0FFFFE0FFFFE0E0E0E0E0E0E0E0E0E0E0E0
E000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E0
0000E00000E00000E00007FC000FFE0007FC0013197F9816>I<7F07F0FF8FF87F07F01C
01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C
01C01C01C01C01C01C01C00E03800E038007070007FF0003FE0000F8001519809816>I<
FE0FE0FF1FE0FE0FE03803801C07001C07001C07001C07000E0E000E0E000E0E000E0E00
060C00071C00071C00071C00071C0003180003B80003B80003B80001B00001F00001F000
00E00013197F9816>I<FC07E0FE0FE0FC07E07001C07001C07001C03001803803803803
8038038038E38039F38039F38039B38019B30019B30019B30019B30019B30019B3001913
001B1B000F1E000F1E000E0E0013197F9816>I<7F1F807F3F807F1F800E1E000E1C0007
3C0007380003B80003F00001F00001E00000E00001E00001F00003F00003B80007B80007
1C00071C000E0E000E0E001C07007F1FC0FF1FE07F1FC013197F9816>I<FE0FE0FF1FE0
FE0FE01C07001C07000E0E000E0E00071C00071C00071C0003B80003B80001F00001F000
00E00000E00000E00000E00000E00000E00000E00000E00003F80007FC0003F80013197F
9816>I<7FFF80FFFF80FFFF80E00700E00F00E01E00E01C00003C0000780000700000F0
0001E00001C00003C0000780000700000F00001E03801C03803C0380780380700380FFFF
80FFFF80FFFF8011197E9816>I<FFF0FFF0FFF0E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000
FFF0FFF0FFF00C20789C16>I<C00000E00000E000007000007000003800003800001C00
001C00000E00000E000007000007000003800003800001C00001C00000E00000E0000070
00007000003800003800001C00001C00000E00000E000007000007000003800003800001
8011207E9C16>I<FFF0FFF0FFF000700070007000700070007000700070007000700070
007000700070007000700070007000700070007000700070007000700070FFF0FFF0FFF0
0C207F9C16>I<03000F803FE0FDF8F07840100D067C9816>I<FFFF80FFFF80FFFF801103
7E7E16>I<081C3C7870E0E0E0E0F0F87830060D789B16>I<1FE0003FF0007FF800783C00
300E00000E00000E0003FE001FFE003E0E00700E00E00E00E00E00E00E00783E007FFFE0
3FE7E00F83E013127E9116>I<7E0000FE00007E00000E00000E00000E00000E00000E3E
000EFF000FFF800F83C00F00E00E00E00E00700E00700E00700E00700E00700E00700E00
E00F01E00F83C00FFF800EFF00063C001419809816>I<03F80FFC1FFE3C1E780C7000E0
00E000E000E000E000F000700778073E0E1FFC0FF803F010127D9116>I<003F00007F00
003F0000070000070000070000070003C7000FF7001FFF003C1F00780F00700700E00700
E00700E00700E00700E00700E00700700F00700F003C1F001FFFE00FE7F007C7E014197F
9816>I<03E00FF81FFC3C1E780E7007E007FFFFFFFFFFFFE000E000700778073C0F1FFE
0FFC03F010127D9116>I<001F00007F8000FF8001E78001C30001C00001C0007FFF00FF
FF00FFFF0001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C0003FFE007FFF003FFE0011197F9816>I<03E3C007F7E00FFFE01C1CC0380E00
380E00380E00380E00380E001C1C000FF8001FF0001BE0003800001800001FFC001FFF00
3FFF807803C0E000E0E000E0E000E0E000E07001C07C07C03FFF800FFE0003F800131C7F
9116>I<7E0000FE00007E00000E00000E00000E00000E00000E3C000EFE000FFF000F87
800F03800E03800E03800E03800E03800E03800E03800E03800E03800E03800E03807FC7
F0FFE7F87FC7F01519809816>I<018003C003C0018000000000000000007FC07FC07FC0
01C001C001C001C001C001C001C001C001C001C001C001C07FFFFFFF7FFF101A7D9916>
I<003000780078003000000000000000001FF81FF81FF800380038003800380038003800
380038003800380038003800380038003800380038003800386070F0F0FFE07FC03F800D
237E9916>I<7E0000FE00007E00000E00000E00000E00000E00000E7FE00E7FE00E7FE0
0E0F000E1E000E3C000E78000EF0000FF0000FF8000FBC000F1E000E0E000E07000E0780
7F87F0FFCFF07F87F01419809816>I<FFC000FFC000FFC00001C00001C00001C00001C0
0001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C0
0001C00001C00001C000FFFF80FFFF80FFFF8011197E9816>I<F9C380FFEFC0FFFFE03C
78E03C78E03870E03870E03870E03870E03870E03870E03870E03870E03870E03870E0FE
7CF8FE7CF8FE3C781512809116>I<7E3C00FEFE007FFF000F87800F03800E03800E0380
0E03800E03800E03800E03800E03800E03800E03800E03807FC7F0FFE7F87FC7F0151280
9116>I<03E0000FF8001FFC003C1E00780F00700700E00380E00380E00380E00380E003
80F00780700700780F003C1E001FFC000FF80003E00011127E9116>I<7E3E00FEFF007F
FF800F83C00F00E00E00E00E00700E00700E00700E00700E00700E00700E00E00F01E00F
83C00FFF800EFF000E3C000E00000E00000E00000E00000E00000E00007FC000FFE0007F
C000141B809116>I<07C7000FE7001FF7003C1F00700F00700F00E00700E00700E00700
E00700E00700E00700700F00700F003C3F003FF7001FE70007C700000700000700000700
000700000700000700003FE0007FF0003FE0141B7E9116>I<FF0FC0FF3FE0FF7FE007F0
4007C000078000078000070000070000070000070000070000070000070000070000FFFC
00FFFC00FFFC0013127F9116>I<0FEC3FFC7FFCF03CE01CE01C70007F801FF007F8003C
600EE00EF00EF81EFFFCFFF8C7E00F127D9116>I<030000070000070000070000070000
7FFF00FFFF00FFFF00070000070000070000070000070000070000070000070100070380
07038007038007870003FE0001FC0000F80011177F9616>I<7E1F80FE3F807E1F800E03
800E03800E03800E03800E03800E03800E03800E03800E03800E03800E03800E0F800FFF
F007FBF803E3F01512809116>I<7F1FC0FF1FE07F1FC01C07001E0F000E0E000E0E000E
0E00071C00071C00071C00071C0003B80003B80003B80001F00001F00000E00013127F91
16>I<FF1FE0FFBFE0FF1FE038038038038038038038038038E38019F30019F30019B300
1DB7001DB7001DB7001DB7000F1E000F1E000F1E0013127F9116>I<7F1FC07F3FC07F1F
C00F1C00073C0003B80003F00001F00000E00001E00001F00003B800073C00071C000E0E
007F1FC0FF3FE07F1FC013127F9116>I<7F1FC0FF9FE07F1FC01C07000E07000E0E000E
0E00070E00071C00071C00039C00039C0003980001B80001B80000F00000F00000F00000
E00000E00000E00001C00079C0007BC0007F80003F00003C0000131B7F9116>I<3FFFC0
7FFFC07FFFC0700780700F00701E00003C0000780001F00003E0000780000F00001E01C0
3C01C07801C0FFFFC0FFFFC0FFFFC012127F9116>I<001F80007F8000FF8001E00001C0
0001C00001C00001C00001C00001C00001C00001C00001C00003C0007F8000FF0000FF00
007F800003C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001E0
0000FF80007F80001F8011207E9C16>I<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0
E0E0E0E0E0E0E0E0E0E0E0E0E00320779C16>I<7C0000FF0000FF800003C00001C00001
C00001C00001C00001C00001C00001C00001C00001C00001E00000FF00007F80007F8000
FF0001E00001C00001C00001C00001C00001C00001C00001C00001C00001C00003C000FF
8000FF00007C000011207E9C16>I<1C303F78FFF8F7E061C00D057C9816>I
E /Fs 52 124 df<003FE3F801F03F1C03C03E3E07C07C3E0F807C3E0F807C1C0F807C00
0F807C000F807C000F807C000F807C00FFFFFFC0FFFFFFC00F807C000F807C000F807C00
0F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C00
0F807C000F807C007FE1FFC07FE1FFC01F1D809C1C>11 D<003FC00001F0300003C03800
07C07C000F807C000F807C000F8038000F8000000F8000000F8000000F800000FFFFFC00
FFFFFC000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C00
0F807C000F807C000F807C000F807C000F807C000F807C007FE1FF807FE1FF80191D809C
1B>I<FFE0FFE0FFE0FFE00B047F8A10>45 D<03F8000F1E001C07003C07803803807803
C07803C07803C0F803E0F803E0F803E0F803E0F803E0F803E0F803E0F803E0F803E0F803
E0F803E0F803E07803C07803C03803803C07801C07000F1E0003F800131B7E9A18>48
D<00600001E0000FE000FFE000F3E00003E00003E00003E00003E00003E00003E00003E0
0003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E0
0003E0007FFF807FFF80111B7D9A18>I<07F8001FFE00383F80780FC0FC07C0FC07E0FC
03E0FC03E07803E00007E00007C00007C0000F80001F00001E0000380000700000E00001
80600300600600600800E01FFFC03FFFC07FFFC0FFFFC0FFFFC0131B7E9A18>I<03F800
1FFE003C1F003C0F807C07C07E07C07C07C03807C0000F80000F80001E00003C0003F800
001E00000F800007C00007C00007E03007E07807E0FC07E0FC07E0FC07C0780F80781F00
1FFE0007F800131B7E9A18>I<000180000380000780000F80001F80003F80006F8000CF
80008F80018F80030F80060F800C0F80180F80300F80600F80C00F80FFFFF8FFFFF8000F
80000F80000F80000F80000F80000F8001FFF801FFF8151B7F9A18>I<1801801FFF001F
FE001FFC001FF8001FC00018000018000018000018000019F8001E0E00180F8010078000
07C00007E00007E00007E07807E0F807E0F807E0F807C0F007C0600F80381F001FFE0007
F000131B7E9A18>I<007E0003FF000781800F03C01E07C03C07C03C0380780000780000
F80000F8F800FB0E00FA0780FC0380FC03C0F803E0F803E0F803E0F803E07803E07803E0
7803C03C03C03C07801E0F0007FE0003F800131B7E9A18>I<6000007FFFE07FFFE07FFF
C07FFF807FFF80E00300C00600C00C00C0180000300000300000600000E00000E00001E0
0001C00003C00003C00003C00003C00007C00007C00007C00007C00007C00007C0000380
00131C7D9B18>I<03F8000FFE001E0F803807803803C07803C07803C07E03C07F83807F
C7003FFE001FFC000FFE0007FF801DFF80387FC0781FE0F007E0F003E0F001E0F001E0F0
01E07801C07803803E07801FFE0003F800131B7E9A18>I<03F8000FFE001E0F003C0780
7807807803C0F803C0F803C0F803E0F803E0F803E0F803E07807E03807E03C0BE00E1BE0
03E3E00003E00003C00003C03807C07C07807C0700780F00383C001FF8000FE000131B7E
9A18>I<00038000000380000007C0000007C0000007C000000FE000000FE000001FF000
001BF000001BF0000031F8000031F8000061FC000060FC0000E0FE0000C07E0000C07E00
01803F0001FFFF0003FFFF8003001F8003001F8006000FC006000FC00E000FE00C0007E0
FFC07FFEFFC07FFE1F1C7E9B24>65 D<FFFFF800FFFFFF000FC01F800FC00FC00FC007C0
0FC007E00FC007E00FC007E00FC007E00FC007E00FC007C00FC00F800FC03F000FFFFE00
0FC00F800FC007C00FC007E00FC003E00FC003F00FC003F00FC003F00FC003F00FC003F0
0FC007E00FC007E00FC01FC0FFFFFF00FFFFFC001C1C7E9B22>I<001FE02000FFF8E003
F80FE007C003E00F8001E01F0000E03E0000E03E0000607E0000607C000060FC000000FC
000000FC000000FC000000FC000000FC000000FC000000FC0000007C0000607E0000603E
0000603E0000C01F0000C00F80018007C0030003F80E0000FFFC00001FE0001B1C7D9B22
>I<FFFFFF00FFFFFF000FC01F000FC007000FC003000FC003800FC003800FC181800FC1
81800FC181800FC180000FC380000FFF80000FFF80000FC380000FC180000FC180000FC1
80600FC180600FC000E00FC000C00FC000C00FC001C00FC001C00FC003C00FC00F80FFFF
FF80FFFFFF801B1C7E9B1F>69 D<FFFFFF00FFFFFF000FC01F000FC007000FC003000FC0
03800FC003800FC001800FC181800FC181800FC180000FC180000FC380000FFF80000FFF
80000FC380000FC180000FC180000FC180000FC180000FC000000FC000000FC000000FC0
00000FC000000FC00000FFFF0000FFFF0000191C7E9B1E>I<000FF008007FFE3801FC07
F807E001F80F8000781F0000783F0000383E0000387E0000187C000018FC000000FC0000
00FC000000FC000000FC000000FC000000FC007FFFFC007FFF7C0001F87E0001F83E0001
F83F0001F81F0001F80F8001F807E001F801FC07F8007FFE78000FF818201C7D9B26>I<
FFFF00FFFF000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC000
0FC0000FC0000FC0000FC0000FC0000FC0030FC0030FC0030FC0070FC0070FC0060FC00E
0FC01E0FC07EFFFFFEFFFFFE181C7E9B1D>76 D<FFC00003FFFFE00007FF0FE00007F00D
F0000DF00DF0000DF00DF0000DF00CF80019F00CF80019F00C7C0031F00C7C0031F00C3E
0061F00C3E0061F00C1F00C1F00C1F00C1F00C1F00C1F00C0F8181F00C0F8181F00C07C3
01F00C07C301F00C03E601F00C03E601F00C01FC01F00C01FC01F00C01FC01F00C00F801
F00C00F801F0FFC0701FFFFFC0701FFF281C7E9B2D>I<003FE00001F07C0003C01E000F
800F801F0007C01E0003C03E0003E07E0003F07C0001F07C0001F0FC0001F8FC0001F8FC
0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F87C0001F07E0003F07E0003F03E
0003E03F0007E01F0007C00F800F8003C01E0001F07C00003FE0001D1C7D9B24>79
D<FFFFF800FFFFFE000FC03F800FC00F800FC007C00FC007E00FC007E00FC007E00FC007
E00FC007E00FC007C00FC007C00FC00F800FC03F000FFFFC000FC000000FC000000FC000
000FC000000FC000000FC000000FC000000FC000000FC000000FC000000FC00000FFFC00
00FFFC00001B1C7E9B21>I<FFFFF00000FFFFFE00000FC03F00000FC00F80000FC007C0
000FC007E0000FC007E0000FC007E0000FC007E0000FC007E0000FC007C0000FC00F8000
0FC03E00000FFFF000000FC07C00000FC03E00000FC03F00000FC01F80000FC01F80000F
C01F80000FC01F80000FC01F80000FC01F80000FC01F81800FC01F81800FC00FC180FFFC
07C300FFFC01FE00211C7E9B24>82 D<07F8201FFEE03C07E07801E07000E0F000E0F000
60F00060F80000FE0000FFE0007FFE003FFF003FFF800FFFC007FFE0007FE00003F00001
F00000F0C000F0C000F0C000E0E000E0F001C0FC03C0EFFF0083FC00141C7D9B1B>I<7F
FFFFE07FFFFFE0781F81E0701F80E0601F8060E01F8070C01F8030C01F8030C01F8030C0
1F8030001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F800000
1F8000001F8000001F8000001F8000001F8000001F8000001F8000001F800007FFFE0007
FFFE001C1C7E9B21>I<FFFC01FF80FFFC01FF800FC000180007E000300007E000300007
F000700003F000600003F800E00001F800C00001FC00C00000FC01800000FC018000007E
030000007E030000007F070000003F060000003F8E0000001F8C0000001FCC0000000FD8
0000000FD800000007F000000007F000000007F000000003E000000003E000000001C000
000001C00000211C7F9B24>86 D<0FF8001C1E003E0F803E07803E07C01C07C00007C000
7FC007E7C01F07C03C07C07C07C0F807C0F807C0F807C0780BC03E13F80FE1F815127F91
17>97 D<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F00001F00
001F3F801FE1E01F80701F00781F003C1F003C1F003E1F003E1F003E1F003E1F003E1F00
3E1F003C1F003C1F00781F80701EC1E01C3F00171D7F9C1B>I<03FC000E0E001C1F003C
1F00781F00780E00F80000F80000F80000F80000F80000F800007800007801803C01801C
03000E0E0003F80011127E9115>I<000FF0000FF00001F00001F00001F00001F00001F0
0001F00001F00001F00001F001F9F00F07F01C03F03C01F07801F07801F0F801F0F801F0
F801F0F801F0F801F0F801F07801F07801F03C01F01C03F00F0FFE03F9FE171D7E9C1B>
I<01FC000F07001C03803C01C07801C07801E0F801E0F801E0FFFFE0F80000F80000F800
007800007C00603C00601E00C00F038001FC0013127F9116>I<007F0001E38003C7C007
87C00F87C00F83800F80000F80000F80000F80000F8000FFF800FFF8000F80000F80000F
80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F80007F
F8007FF800121D809C0F>I<03F8F00E0F381E0F381C07303C07803C07803C07803C0780
1C07001E0F000E0E001BF8001000001800001800001FFF001FFFC00FFFE01FFFF07801F8
F00078F00078F000787000707800F01E03C007FF00151B7F9118>I<FF0000FF00001F00
001F00001F00001F00001F00001F00001F00001F00001F00001F0FC01F31E01F40F01F80
F81F80F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00
F8FFE7FFFFE7FF181D7F9C1B>I<1E003F003F003F003F001E0000000000000000000000
0000FF00FF001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FFE0
FFE00B1E7F9D0E>I<FF0000FF00001F00001F00001F00001F00001F00001F00001F0000
1F00001F00001F0FF81F0FF81F03801F07001F0C001F18001F70001FF8001FFC001FBC00
1F3E001F1F001F0F001F0F801F07C01F03E0FFC7FCFFC7FC161D7F9C19>107
D<FF00FF001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F00FFE0FFE00B1D7F9C0E>I<FF0FC07E00FF
31E18F001F40F207801F80FC07C01F80FC07C01F00F807C01F00F807C01F00F807C01F00
F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F8
07C0FFE7FF3FF8FFE7FF3FF825127F9128>I<FF0FC0FF31E01F40F01F80F81F80F81F00
F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F8FFE7FFFFE7
FF18127F911B>I<01FC000F07801C01C03C01E07800F07800F0F800F8F800F8F800F8F8
00F8F800F8F800F87800F07800F03C01E01E03C00F078001FC0015127F9118>I<FF3F80
FFE1E01F80F01F00781F007C1F003C1F003E1F003E1F003E1F003E1F003E1F003E1F003C
1F007C1F00781F80F01FC1E01F3F001F00001F00001F00001F00001F00001F0000FFE000
FFE000171A7F911B>I<03F0600F0CE01E07E03C03E07C03E07803E0F803E0F803E0F803
E0F803E0F803E0F803E07803E07C03E03C03E01C07E00E0FE003F3E00003E00003E00003
E00003E00003E00003E0001FFC001FFC161A7E9119>I<FE3E00FE47001E8F801E8F801E
8F801F07001F00001F00001F00001F00001F00001F00001F00001F00001F00001F0000FF
F000FFF00011127F9114>I<1FD830786018E018E018F000FF807FE07FF01FF807FC007C
C01CC01CE01CE018F830CFC00E127E9113>I<0300030003000300070007000F000F003F
FCFFFC1F001F001F001F001F001F001F001F001F001F0C1F0C1F0C1F0C0F08079803F00E
1A7F9913>I<FF07F8FF07F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F8
1F00F81F00F81F00F81F00F81F01F80F01F80786FF01F8FF18127F911B>I<FFC1FCFFC1
FC1F00601F80E00F80C00FC0C007C18007C18003E30003E30001F60001F60001FE0000FC
0000FC0000780000780000300016127F9119>I<FF8FF8FEFF8FF8FE1F03E0301F03E030
1F83E0700F83F0600F86F06007C6F0C007CEF8C007EC79C003EC7D8003F83D8001F83F00
01F83F0001F01F0000F01E0000E00E0000E00E001F127F9122>I<FFC7FCFFC7FC1F8180
0F838007C70003EE0001FC0001F80000F800007C0000FE0001DF00039F00070F800607C0
0C03E0FF07FCFF07FC16127F9119>I<FFC1FCFFC1FC1F00601F80E00F80C00FC0C007C1
8007C18003E30003E30001F70001F60000FE0000FC0000FC000078000078000030000030
00007000706000F86000F8C000F980007300003E0000161A7F9119>I<FFFFFE1701808B
18>123 D E /Ft 52 123 df<000FF000007FFC0001F80E0003E01F0007C03F000F803F
000F803F000F801E000F800C000F8000000F8000000F8000000F800000FFFFFF00FFFFFF
000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F
000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F
007FF0FFE07FF0FFE01B237FA21F>12 D<FFFCFFFCFFFCFFFC0E047F8C13>45
D<387CFEFEFE7C3807077C8610>I<00FE0007FFC00F83E01F01F03E00F83E00F87C007C
7C007C7C007CFC007CFC007EFC007EFC007EFC007EFC007EFC007EFC007EFC007EFC007E
FC007EFC007EFC007EFC007E7C007C7C007C7C007C3E00F83E00F81F01F00F83E007FFC0
00FE0017207E9F1C>48 D<00180000780001F800FFF800FFF80001F80001F80001F80001
F80001F80001F80001F80001F80001F80001F80001F80001F80001F80001F80001F80001
F80001F80001F80001F80001F80001F80001F80001F80001F80001F8007FFFE07FFFE013
207C9F1C>I<03FC000FFF003C1FC07007E07C07F0FE03F0FE03F8FE03F8FE01F87C01F8
3803F80003F80003F00003F00007E00007C0000F80001F00003E0000380000700000E018
01C0180380180700180E00380FFFF01FFFF03FFFF07FFFF0FFFFF0FFFFF015207D9F1C>
I<00FE0007FFC00F07E01E03F03F03F03F81F83F81F83F81F81F03F81F03F00003F00003
E00007C0001F8001FE0001FF000007C00001F00001F80000FC0000FC3C00FE7E00FEFF00
FEFF00FEFF00FEFF00FC7E01FC7801F81E07F00FFFC001FE0017207E9F1C>I<0000E000
01E00003E00003E00007E0000FE0001FE0001FE00037E00077E000E7E001C7E00187E003
07E00707E00E07E00C07E01807E03807E07007E0E007E0FFFFFFFFFFFF0007E00007E000
07E00007E00007E00007E00007E000FFFF00FFFF18207E9F1C>I<3000203E01E03FFFC0
3FFF803FFF003FFE003FF80033C00030000030000030000030000031FC0037FF003E0FC0
3807E03003E00003F00003F00003F80003F83803F87C03F8FE03F8FE03F8FC03F0FC03F0
7007E03007C03C1F800FFF0003F80015207D9F1C>I<001F8000FFE003E07007C0F00F01
F81F01F83E01F83E01F87E00F07C00007C0000FC0800FC7FC0FCFFE0FD80F0FF00F8FE00
7CFE007CFC007EFC007EFC007EFC007E7C007E7C007E7C007E3C007C3E007C1E00F80F00
F00783E003FFC000FF0017207E9F1C>I<6000007800007FFFFE7FFFFE7FFFFC7FFFF87F
FFF87FFFF0E00060E000C0C00180C00300C00300000600000C00001C0000180000380000
780000780000F00000F00000F00001F00001F00001F00003F00003F00003F00003F00003
F00003F00003F00001E00017227DA11C>I<00FE0003FFC00703E00E00F01C00F01C0078
3C00783E00783F00783F80783FE0F01FF9E01FFFC00FFF8007FFC003FFE007FFF01E7FF8
3C1FFC7807FC7801FEF000FEF0003EF0001EF0001EF0001EF8001C7800383C00381F00F0
0FFFC001FF0017207E9F1C>I<01FE0007FF800F83E01E01F03E00F07C00F87C0078FC00
7CFC007CFC007CFC007EFC007EFC007EFC007E7C00FE7C00FE3E01FE1E037E0FFE7E07FC
7E00207E00007C00007C1E007C3F00F83F00F83F00F03F01E01E03C01C0F800FFE0003F8
0017207E9F1C>I<000070000000007000000000F800000000F800000000F800000001FC
00000001FC00000003FE00000003FE00000003FE000000067F000000067F0000000C7F80
00000C3F8000000C3F800000181FC00000181FC00000301FE00000300FE00000700FF000
006007F000006007F00000C007F80000FFFFF80001FFFFFC00018001FC00018001FC0003
0001FE00030000FE00070000FF000600007F000600007F00FFE007FFF8FFE007FFF82522
7EA12A>65 D<FFFFFF8000FFFFFFF00007F001F80007F000FC0007F0007E0007F0007E00
07F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007E0007F000FE0007
F000FC0007F003F80007FFFFF00007FFFFF00007F001FC0007F0007E0007F0003F0007F0
003F8007F0001F8007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F000
1FC007F0003F8007F0003F8007F0007F0007F001FE00FFFFFFF800FFFFFFC00022227EA1
28>I<0003FE0080001FFF818000FF01E38001F8003F8003E0001F8007C0000F800F8000
07801F800007803F000003803F000003807F000001807E000001807E00000180FE000000
00FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000
7E000000007E000001807F000001803F000001803F000003801F800003000F8000030007
C000060003F0000C0001F800380000FF00F000001FFFC0000003FE000021227DA128>I<
FFFFFF8000FFFFFFF00007F003FC0007F0007E0007F0003F0007F0001F8007F0000FC007
F00007E007F00007E007F00007F007F00003F007F00003F007F00003F007F00003F807F0
0003F807F00003F807F00003F807F00003F807F00003F807F00003F807F00003F807F000
03F807F00003F007F00003F007F00003F007F00007E007F00007E007F0000FC007F0001F
8007F0003F0007F0007E0007F003FC00FFFFFFF000FFFFFF800025227EA12B>I<FFFFFF
FCFFFFFFFC07F000FC07F0003C07F0001C07F0000C07F0000E07F0000E07F0000607F00C
0607F00C0607F00C0607F00C0007F01C0007F03C0007FFFC0007FFFC0007F03C0007F01C
0007F00C0007F00C0007F00C0307F00C0307F0000307F0000607F0000607F0000607F000
0E07F0000E07F0001E07F0003E07F001FCFFFFFFFCFFFFFFFC20227EA125>I<FFFFFFF8
FFFFFFF807F001F807F0007807F0003807F0001807F0001C07F0001C07F0000C07F0000C
07F0180C07F0180C07F0180007F0180007F0380007F0780007FFF80007FFF80007F07800
07F0380007F0180007F0180007F0180007F0180007F0000007F0000007F0000007F00000
07F0000007F0000007F0000007F00000FFFFC000FFFFC0001E227EA123>I<0003FE0040
001FFFC0C0007F00F1C001F8003FC003F0000FC007C00007C00FC00003C01F800003C03F
000001C03F000001C07F000000C07E000000C07E000000C0FE00000000FE00000000FE00
000000FE00000000FE00000000FE00000000FE00000000FE000FFFFC7E000FFFFC7F0000
1FC07F00001FC03F00001FC03F00001FC01F80001FC00FC0001FC007E0001FC003F0001F
C001FC003FC0007F80E7C0001FFFC3C00003FF00C026227DA12C>I<FFFF80FFFF8007F0
0007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F0
0007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F0
0007F00007F00007F00007F00007F000FFFF80FFFF8011227EA115>73
D<FFFFC000FFFFC00007F0000007F0000007F0000007F0000007F0000007F0000007F000
0007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F000
0007F0000007F0000007F0000007F0001807F0001807F0001807F0001807F0003807F000
3807F0007007F0007007F000F007F001F007F007F0FFFFFFF0FFFFFFF01D227EA122>76
D<FFF000000FFFFFF800001FFF07F800001FE006FC000037E006FC000037E006FC000037
E0067E000067E0067E000067E0063F0000C7E0063F0000C7E0061F800187E0061F800187
E0060FC00307E0060FC00307E0060FC00307E00607E00607E00607E00607E00603F00C07
E00603F00C07E00601F81807E00601F81807E00601F81807E00600FC3007E00600FC3007
E006007E6007E006007E6007E006003FC007E006003FC007E006001F8007E006001F8007
E006001F8007E006000F0007E0FFF00F00FFFFFFF00600FFFF30227EA135>I<0007FC00
00003FFF800000FC07E00003F001F80007E000FC000FC0007E001F80003F001F80003F00
3F00001F803F00001F807F00001FC07E00000FC07E00000FC0FE00000FE0FE00000FE0FE
00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE07E00
000FC07F00001FC07F00001FC03F00001F803F80003F801F80003F000FC0007E0007E000
FC0003F001F80000FC07E000003FFF80000007FC000023227DA12A>79
D<FFFFFF00FFFFFFE007F007F007F001FC07F000FC07F0007E07F0007E07F0007F07F000
7F07F0007F07F0007F07F0007F07F0007E07F0007E07F000FC07F001FC07F007F007FFFF
E007FFFF0007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F000
0007F0000007F0000007F0000007F0000007F00000FFFF8000FFFF800020227EA126>I<
FFFFFE0000FFFFFFC00007F007F00007F001F80007F000FC0007F0007E0007F0007F0007
F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007E0007F000FC0007F0
01F80007F007F00007FFFFC00007FFFF800007F00FE00007F007F00007F003F80007F001
FC0007F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F001FC
0007F001FC0607F000FE0607F000FF0CFFFF803FF8FFFF800FF027227EA12A>82
D<7FFFFFFF807FFFFFFF807E03F80F807803F807807003F803806003F80180E003F801C0
E003F801C0C003F800C0C003F800C0C003F800C0C003F800C00003F800000003F8000000
03F800000003F800000003F800000003F800000003F800000003F800000003F800000003
F800000003F800000003F800000003F800000003F800000003F800000003F800000003F8
00000003F800000003F800000003F8000001FFFFF00001FFFFF00022227EA127>84
D<0FFC003FFF807E07C07E03E07E01E07E01F03C01F00001F00001F0003FF003FDF01FC1
F03F01F07E01F0FC01F0FC01F0FC01F0FC01F07E02F07E0CF81FF87F07E03F18167E951B
>97 D<FF000000FF0000001F0000001F0000001F0000001F0000001F0000001F0000001F
0000001F0000001F0000001F0000001F0000001F0FE0001F3FF8001FE07C001F803E001F
001F001F000F801F000F801F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F
000FC01F000FC01F000F801F001F801F801F001FC03E001EE07C001C3FF800180FC0001A
237EA21F>I<00FF8007FFE00F83F01F03F03E03F07E03F07C01E07C0000FC0000FC0000
FC0000FC0000FC0000FC00007C00007E00007E00003E00181F00300FC06007FFC000FF00
15167E9519>I<0001FE000001FE0000003E0000003E0000003E0000003E0000003E0000
003E0000003E0000003E0000003E0000003E0000003E0001FC3E0007FFBE000F81FE001F
007E003E003E007E003E007C003E00FC003E00FC003E00FC003E00FC003E00FC003E00FC
003E00FC003E00FC003E007C003E007C003E003E007E001F00FE000F83BE0007FF3FC001
FC3FC01A237EA21F>I<00FE0007FF800F87C01E01E03E01F07C00F07C00F8FC00F8FC00
F8FFFFF8FFFFF8FC0000FC0000FC00007C00007C00007E00003E00181F00300FC07003FF
C000FF0015167E951A>I<001FC0007FE000F1F001E3F003E3F007C3F007C1E007C00007
C00007C00007C00007C00007C000FFFE00FFFE0007C00007C00007C00007C00007C00007
C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007
C0003FFC003FFC00142380A211>I<01FE0F0007FFBF800F87C7801F03E7801E01E0003E
01F0003E01F0003E01F0003E01F0003E01F0001E01E0001F03E0000F87C0000FFF800009
FE000018000000180000001C0000001FFFE0000FFFF80007FFFE001FFFFF003C003F0078
000F80F0000780F0000780F0000780F000078078000F003C001E001F007C000FFFF80001
FFC00019217F951C>I<FF000000FF0000001F0000001F0000001F0000001F0000001F00
00001F0000001F0000001F0000001F0000001F0000001F0000001F07E0001F1FF8001F30
7C001F403C001F803E001F803E001F003E001F003E001F003E001F003E001F003E001F00
3E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E00FFE1
FFC0FFE1FFC01A237EA21F>I<1C003E007F007F007F003E001C00000000000000000000
0000000000FF00FF001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F00FFE0FFE00B247EA310>I<FF000000FF0000001F0000001F000000
1F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F000000
1F00FF801F00FF801F0038001F0060001F01C0001F0380001F0700001F0E00001F1C0000
1F7E00001FFF00001FCF00001F0F80001F07C0001F03E0001F01E0001F01F0001F00F800
1F007C001F003C00FFE0FFC0FFE0FFC01A237EA21E>107 D<FF00FF001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F00FFE0FFE00B237EA210>I<FF07F007F000
FF1FFC1FFC001F303E303E001F403E403E001F801F801F001F801F801F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F00FFE0FFE0FFE0FFE0FFE0FFE02B167E9530>I<FF07E000FF1FF8001F307C
001F403C001F803E001F803E001F003E001F003E001F003E001F003E001F003E001F003E
001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E00FFE1FF
C0FFE1FFC01A167E951F>I<00FE0007FFC00F83E01E00F03E00F87C007C7C007C7C007C
FC007EFC007EFC007EFC007EFC007EFC007EFC007E7C007C7C007C3E00F81F01F00F83E0
07FFC000FE0017167E951C>I<FF0FE000FF3FF8001FE07C001F803E001F001F001F001F
801F001F801F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000F
C01F001F801F001F801F803F001FC03E001FE0FC001F3FF8001F0FC0001F0000001F0000
001F0000001F0000001F0000001F0000001F0000001F000000FFE00000FFE000001A207E
951F>I<00FE030007FF87000FC1C7001F006F003F003F007E003F007E001F007C001F00
FC001F00FC001F00FC001F00FC001F00FC001F00FC001F00FC001F007E001F007E001F00
3E003F001F007F000FC1DF0007FF9F0001FC1F0000001F0000001F0000001F0000001F00
00001F0000001F0000001F0000001F000000FFE00000FFE01B207E951E>I<FE1F00FE3F
C01E67E01EC7E01E87E01E87E01F83C01F00001F00001F00001F00001F00001F00001F00
001F00001F00001F00001F00001F00001F0000FFF000FFF00013167E9517>I<0FF3003F
FF00781F00600700E00300E00300F00300FC00007FE0007FF8003FFE000FFF0001FF0000
0F80C00780C00380E00380E00380F00700FC0E00EFFC00C7F00011167E9516>I<018000
0180000180000180000380000380000780000780000F80003F8000FFFF00FFFF000F8000
0F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F81800F8180
0F81800F81800F81800F830007C30003FE0000F80011207F9F16>I<FF01FE00FF01FE00
1F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E00
1F003E001F003E001F003E001F003E001F003E001F003E001F007E001F00FE000F81BE00
07FF3FC001FC3FC01A167E951F>I<FFE01FE0FFE01FE01F8007000F8006000FC00E0007
C00C0007E00C0003E0180003E0180001F0300001F0300000F8600000F86000007CC00000
7CC000007FC000003F8000003F8000001F0000001F0000000E0000000E00001B167F951E
>I<FFE3FF07F8FFE3FF07F81F007800C01F807C01C00F807C01800F807C018007C07E03
0007C0DE030007C0DE070003E1DF060003E18F060001F18F8C0001F3078C0001F3078C00
00FF07D80000FE03D80000FE03F800007C01F000007C01F000003C01E000003800E00000
3800E00025167F9528>I<FFE07FC0FFE07FC00F801C0007C0380003E0700003F0600001
F8C00000F98000007F8000003F0000001F0000001F8000003FC0000037C0000063E00000
C1F00001C0F8000380FC0007007E000E003E00FF80FFE0FF80FFE01B167F951E>I<FFE0
1FE0FFE01FE01F8007000F8006000FC00E0007C00C0007E00C0003E0180003E0180001F0
300001F0300000F8600000F86000007CC000007CC000007FC000003F8000003F8000001F
0000001F0000000E0000000E0000000C0000000C00000018000078180000FC380000FC30
0000FC60000069C000007F8000001F0000001B207F951E>I<7FFFF07FFFF07C03E07007
C0600FC0E01F80C01F00C03E00C07E0000FC0000F80001F00003F03007E03007C0300F80
701F80703F00603E00E07C03E0FFFFE0FFFFE014167E9519>I E
/Fu 40 122 df<0000000FFF800000000001FFFFE0000000000FFFFFF8000000003FFC01
FC00000000FFE0003E00000003FF80003F00000007FE0000FF8000000FFC0001FFC00000
1FFC0003FFC000001FF80003FFC000003FF80003FFC000003FF00003FFC000007FF00003
FFC000007FF00003FFC000007FF00003FFC000007FF00001FF8000007FF00000FF000000
7FF000007E0000007FF00000000000007FF00000000000007FF00000000000007FF00000
000000007FF00000000000007FF00000000000007FF00000000000007FF0007FFFE000FF
FFFFFFFFFFE000FFFFFFFFFFFFE000FFFFFFFFFFFFE000FFFFFFFFFFFFE000007FF00001
FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE00000
7FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000
FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE00000
7FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000
FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE00000
7FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000
FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE00000
7FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000FFE000007FF00000
FFE000007FF00000FFE0003FFFFFE07FFFFFC03FFFFFE07FFFFFC03FFFFFE07FFFFFC03F
FFFFE07FFFFFC03A487EC741>12 D<FFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFF
FFFFFEFFFFFFFEFFFFFFFEFFFFFFFE1F097F9B27>45 D<00007FF800000003FFFF800000
1FFFFFF000003F807FF80000FC000FFE0001F00007FF0003E00007FF8007C00003FFC007
F80003FFC00FFC0003FFE00FFE0001FFE01FFF0001FFF01FFF0001FFF01FFF0001FFF01F
FF8001FFF01FFF0001FFF01FFF0001FFF00FFF0003FFE007FE0003FFE003FC0003FFE001
F80003FFC000000007FFC000000007FF8000000007FF000000000FFE000000000FFC0000
00001FF8000000003FF000000000FFC000000007FF00000003FFFC00000003FFF8000000
03FFFF80000000007FF0000000001FFC0000000007FE0000000003FF8000000003FFC000
000001FFE000000001FFF000000001FFF000000001FFF800000000FFF800000000FFFC00
000000FFFC00000000FFFE03800000FFFE0FE00000FFFE3FF80000FFFE7FFC0000FFFE7F
FC0000FFFEFFFE0000FFFEFFFE0000FFFEFFFE0000FFFCFFFE0000FFFCFFFE0000FFFCFF
FE0000FFF87FFC0001FFF87FF80001FFF03FF00001FFF03FE00003FFE01F800003FFC00F
E00007FF8007F8001FFF0003FF807FFE0000FFFFFFF800003FFFFFE000000FFFFF000000
00FFF000002F457BC33A>51 D<0000000007C000000000000000000FE000000000000000
000FE000000000000000001FF000000000000000001FF000000000000000001FF0000000
00000000003FF800000000000000003FF800000000000000007FFC00000000000000007F
FC00000000000000007FFC0000000000000000FFFE0000000000000000FFFE0000000000
000001FFFF0000000000000001FFFF0000000000000001FFFF0000000000000003FFFF80
00000000000003FFFF8000000000000007FFFFC000000000000007DFFFC0000000000000
07CFFFC00000000000000FCFFFE00000000000000F87FFE00000000000001F87FFF00000
000000001F07FFF00000000000001F03FFF00000000000003F03FFF80000000000003E01
FFF80000000000007E01FFFC0000000000007C01FFFC0000000000007C00FFFC00000000
0000FC00FFFE000000000000F8007FFE000000000001F8007FFF000000000001F0007FFF
000000000001F0003FFF000000000003F0003FFF800000000003E0001FFF800000000007
E0001FFFC00000000007C0001FFFC00000000007C0000FFFC0000000000FC0000FFFE000
0000000F800007FFE0000000001F800007FFF0000000001F000007FFF0000000001F0000
03FFF0000000003F000003FFF8000000003E000001FFF8000000007FFFFFFFFFFC000000
007FFFFFFFFFFC000000007FFFFFFFFFFC00000000FFFFFFFFFFFE00000000F80000007F
FE00000001F80000007FFF00000001F00000003FFF00000001F00000003FFF00000003F0
0000003FFF80000003E00000001FFF80000007E00000001FFFC0000007C00000000FFFC0
000007C00000000FFFC000000F800000000FFFE000000F8000000007FFE000001F800000
0007FFF000001F0000000003FFF000001F0000000003FFF000003E0000000003FFF80000
FFC000000001FFF800FFFFFF800007FFFFFFFEFFFFFF800007FFFFFFFEFFFFFF800007FF
FFFFFEFFFFFF800007FFFFFFFE4F487CC758>65 D<FFFFFFFFFFFFC00000FFFFFFFFFFFF
FC0000FFFFFFFFFFFFFF8000FFFFFFFFFFFFFFE000001FFF000003FFF800001FFF000000
FFFC00001FFF0000003FFE00001FFF0000001FFF00001FFF0000001FFF80001FFF000000
0FFFC0001FFF00000007FFC0001FFF00000007FFE0001FFF00000007FFE0001FFF000000
03FFE0001FFF00000003FFF0001FFF00000003FFF0001FFF00000003FFF0001FFF000000
03FFF0001FFF00000003FFF0001FFF00000003FFF0001FFF00000003FFF0001FFF000000
03FFF0001FFF00000007FFE0001FFF00000007FFE0001FFF00000007FFC0001FFF000000
0FFFC0001FFF0000000FFF80001FFF0000001FFF00001FFF0000003FFE00001FFF000000
7FFC00001FFF000000FFF800001FFF000003FFE000001FFF00007FFF8000001FFFFFFFFF
FC0000001FFFFFFFFFFF8000001FFFFFFFFFFFF000001FFF0000007FFC00001FFF000000
1FFF00001FFF00000007FF80001FFF00000003FFC0001FFF00000003FFE0001FFF000000
01FFF0001FFF00000000FFF8001FFF00000000FFFC001FFF00000000FFFC001FFF000000
007FFE001FFF000000007FFE001FFF000000007FFE001FFF000000007FFF001FFF000000
007FFF001FFF000000007FFF001FFF000000007FFF001FFF000000007FFF001FFF000000
007FFF001FFF000000007FFF001FFF000000007FFF001FFF000000007FFE001FFF000000
007FFE001FFF00000000FFFE001FFF00000000FFFC001FFF00000001FFFC001FFF000000
01FFF8001FFF00000003FFF0001FFF00000007FFE0001FFF0000000FFFC0001FFF000000
3FFF80001FFF000001FFFF00FFFFFFFFFFFFFFFC00FFFFFFFFFFFFFFF000FFFFFFFFFFFF
FF8000FFFFFFFFFFFFF8000048477CC653>I<000000007FFE0000060000000FFFFFC000
1E0000007FFFFFF8003E000003FFFFFFFE007E00000FFFF800FF80FE00003FFF80001FC1
FE0000FFFC000007F3FE0001FFF0000001FFFE0007FFC00000007FFE000FFF000000003F
FE001FFE000000001FFE003FFC000000000FFE007FF80000000007FE00FFF00000000007
FE01FFF00000000003FE01FFE00000000001FE03FFE00000000001FE07FFC00000000000
FE07FFC00000000000FE0FFF800000000000FE0FFF8000000000007E1FFF800000000000
7E1FFF0000000000007E3FFF0000000000003E3FFF0000000000003E3FFF000000000000
3E7FFF0000000000003E7FFE000000000000007FFE000000000000007FFE000000000000
00FFFE00000000000000FFFE00000000000000FFFE00000000000000FFFE000000000000
00FFFE00000000000000FFFE00000000000000FFFE00000000000000FFFE000000000000
00FFFE00000000000000FFFE00000000000000FFFE00000000000000FFFE000000000000
00FFFE000000000000007FFE000000000000007FFE000000000000007FFE000000000000
007FFF000000000000003FFF0000000000001E3FFF0000000000001E3FFF000000000000
1E1FFF0000000000001E1FFF8000000000001E0FFF8000000000003E0FFF800000000000
3C07FFC000000000003C07FFC000000000003C03FFE000000000007801FFE00000000000
7801FFF00000000000F000FFF00000000001F0007FF80000000001E0003FFC0000000003
C0001FFE000000000780000FFF800000000F000007FFC00000003E000001FFF00000007C
000000FFFC000001F80000003FFF80000FF00000000FFFF8007FC000000003FFFFFFFF00
000000007FFFFFFC00000000000FFFFFE00000000000007FFE00000047497AC754>I<FF
FFFFFFFFFFFFFC00FFFFFFFFFFFFFFFC00FFFFFFFFFFFFFFFC00FFFFFFFFFFFFFFFC0000
1FFF800001FFFE00001FFF8000001FFE00001FFF80000007FE00001FFF80000003FE0000
1FFF80000001FE00001FFF80000000FE00001FFF800000007E00001FFF800000003E0000
1FFF800000003F00001FFF800000001F00001FFF800000001F00001FFF800000001F0000
1FFF800000000F00001FFF800000000F00001FFF800000000F00001FFF800000000F0000
1FFF800078000780001FFF800078000780001FFF800078000780001FFF80007800078000
1FFF800078000000001FFF800078000000001FFF8000F8000000001FFF8000F800000000
1FFF8000F8000000001FFF8001F8000000001FFF8003F8000000001FFF801FF800000000
1FFFFFFFF8000000001FFFFFFFF8000000001FFFFFFFF8000000001FFFFFFFF800000000
1FFF801FF8000000001FFF8003F8000000001FFF8001F8000000001FFF8000F800000000
1FFF8000F8000000001FFF8000F8000000001FFF800078000000001FFF80007800000000
1FFF8000780000F0001FFF8000780000F0001FFF8000780000F0001FFF8000780001E000
1FFF8000000001E0001FFF8000000001E0001FFF8000000001E0001FFF8000000001E000
1FFF8000000003E0001FFF8000000003E0001FFF8000000003C0001FFF8000000007C000
1FFF8000000007C0001FFF8000000007C0001FFF800000000FC0001FFF800000001FC000
1FFF800000001FC0001FFF800000003F80001FFF800000007F80001FFF80000000FF8000
1FFF80000003FF80001FFF8000000FFF80001FFF800000FFFF80FFFFFFFFFFFFFFFF80FF
FFFFFFFFFFFFFF00FFFFFFFFFFFFFFFF00FFFFFFFFFFFFFFFF0044477CC64C>69
D<FFFFFFFFFFFFFFF0FFFFFFFFFFFFFFF0FFFFFFFFFFFFFFF0FFFFFFFFFFFFFFF0001FFF
800007FFF8001FFF8000007FF8001FFF8000001FF8001FFF80000007F8001FFF80000003
F8001FFF80000001F8001FFF80000001F8001FFF80000000F8001FFF80000000FC001FFF
800000007C001FFF800000007C001FFF800000007C001FFF800000003C001FFF80000000
3C001FFF800000003C001FFF800000003C001FFF800000001E001FFF800078001E001FFF
800078001E001FFF800078001E001FFF8000780000001FFF8000780000001FFF80007800
00001FFF8000F80000001FFF8000F80000001FFF8000F80000001FFF8001F80000001FFF
8003F80000001FFF801FF80000001FFFFFFFF80000001FFFFFFFF80000001FFFFFFFF800
00001FFFFFFFF80000001FFF801FF80000001FFF8003F80000001FFF8001F80000001FFF
8000F80000001FFF8000F80000001FFF8000F80000001FFF8000780000001FFF80007800
00001FFF8000780000001FFF8000780000001FFF8000780000001FFF8000780000001FFF
8000000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF80000000
00001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF
8000000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF80000000
00001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000FFFFFF
FFFE000000FFFFFFFFFE000000FFFFFFFFFE000000FFFFFFFFFE0000003F477CC649>I<
000000007FFC00000C000000000FFFFFC0003C00000000FFFFFFF0007C00000003FFFFFF
FC00FC0000001FFFF001FF01FC0000003FFF00003FC3FC000000FFF8000007E7FC000003
FFE0000003FFFC000007FFC0000000FFFC00000FFF000000007FFC00001FFE000000003F
FC00003FFC000000001FFC00007FF8000000000FFC0000FFF0000000000FFC0001FFF000
00000007FC0003FFE00000000003FC0003FFE00000000003FC0007FFC00000000001FC00
07FFC00000000001FC000FFF800000000001FC001FFF800000000000FC001FFF80000000
0000FC001FFF000000000000FC003FFF0000000000007C003FFF0000000000007C003FFF
0000000000007C007FFF0000000000007C007FFE00000000000000007FFE000000000000
00007FFE0000000000000000FFFE0000000000000000FFFE0000000000000000FFFE0000
000000000000FFFE0000000000000000FFFE0000000000000000FFFE0000000000000000
FFFE0000000000000000FFFE0000000000000000FFFE0000000000000000FFFE00000000
00000000FFFE0000000000000000FFFE0000000000000000FFFE00000000000000007FFE
0000003FFFFFFFFC7FFE0000003FFFFFFFFC7FFE0000003FFFFFFFFC7FFF0000003FFFFF
FFFC3FFF0000000000FFFC003FFF0000000000FFFC003FFF0000000000FFFC001FFF0000
000000FFFC001FFF8000000000FFFC001FFF8000000000FFFC000FFF8000000000FFFC00
07FFC000000000FFFC0007FFC000000000FFFC0003FFE000000000FFFC0003FFE0000000
00FFFC0001FFF000000000FFFC0000FFF000000000FFFC00007FF800000000FFFC00003F
FC00000000FFFC00001FFE00000000FFFC00000FFF00000001FFFC000007FFC0000001FF
FC000003FFF0000003FFFC000000FFFC00000FCFFC0000003FFF80001F87FC0000001FFF
F800FF03FC00000003FFFFFFFE00FC00000000FFFFFFF8003C000000000FFFFFE0000C00
000000007FFE000000004E497AC75B>I<FFFFFFFFF0FFFFFFFFF0FFFFFFFFF0FFFFFFFF
F0001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000
001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF800000
1FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001F
FF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF
8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF80
00001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000
001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF800000
1FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000001F
FF8000001FFF8000001FFF8000001FFF8000001FFF8000001FFF8000FFFFFFFFF0FFFFFF
FFF0FFFFFFFFF0FFFFFFFFF024477DC62B>73 D<FFFFFFFFFE000000FFFFFFFFFE000000
FFFFFFFFFE000000FFFFFFFFFE000000001FFF8000000000001FFF8000000000001FFF80
00000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000
001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF80
00000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000
001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF80
00000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000
001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF80
00000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000
001FFF8000000000001FFF8000000000001FFF8000000000001FFF8000000000001FFF80
00000000001FFF8000000000001FFF80000000F0001FFF80000000F0001FFF80000000F0
001FFF80000000F0001FFF80000001E0001FFF80000001E0001FFF80000001E0001FFF80
000001E0001FFF80000003E0001FFF80000003E0001FFF80000003E0001FFF80000007E0
001FFF80000007E0001FFF80000007C0001FFF8000000FC0001FFF8000001FC0001FFF80
00001FC0001FFF8000003FC0001FFF8000007FC0001FFF800001FFC0001FFF800003FFC0
001FFF80000FFFC0001FFF8000FFFF80FFFFFFFFFFFFFF80FFFFFFFFFFFFFF80FFFFFFFF
FFFFFF80FFFFFFFFFFFFFF803C477CC646>76 D<FFFFFF8000000000001FFFFFF8FFFFFF
C000000000003FFFFFF8FFFFFFC000000000003FFFFFF8FFFFFFE000000000007FFFFFF8
001FFFE000000000007FFFC000001FFFE000000000007FFFC000001EFFF00000000000F7
FFC000001EFFF00000000000F7FFC000001E7FF80000000001E7FFC000001E7FF8000000
0001E7FFC000001E3FFC0000000003C7FFC000001E3FFC0000000003C7FFC000001E3FFC
0000000003C7FFC000001E1FFE000000000787FFC000001E1FFE000000000787FFC00000
1E0FFF000000000F07FFC000001E0FFF000000000F07FFC000001E07FF800000001E07FF
C000001E07FF800000001E07FFC000001E03FFC00000003C07FFC000001E03FFC0000000
3C07FFC000001E03FFC00000003C07FFC000001E01FFE00000007807FFC000001E01FFE0
0000007807FFC000001E00FFF0000000F007FFC000001E00FFF0000000F007FFC000001E
007FF8000001E007FFC000001E007FF8000001E007FFC000001E007FF8000001E007FFC0
00001E003FFC000003C007FFC000001E003FFC000003C007FFC000001E001FFE00000780
07FFC000001E001FFE0000078007FFC000001E000FFF00000F0007FFC000001E000FFF00
000F0007FFC000001E0007FF80001E0007FFC000001E0007FF80001E0007FFC000001E00
07FF80001E0007FFC000001E0003FFC0003C0007FFC000001E0003FFC0003C0007FFC000
001E0001FFE000780007FFC000001E0001FFE000780007FFC000001E0000FFF000F00007
FFC000001E0000FFF000F00007FFC000001E0000FFF000F00007FFC000001E00007FF801
E00007FFC000001E00007FF801E00007FFC000001E00003FFC03C00007FFC000001E0000
3FFC03C00007FFC000001E00001FFE07800007FFC000001E00001FFE07800007FFC00000
1E00001FFE07800007FFC000001E00000FFF0F000007FFC000001E00000FFF0F000007FF
C000001E000007FF9E000007FFC000001E000007FF9E000007FFC000001E000003FFFC00
0007FFC000001E000003FFFC000007FFC000001E000001FFF8000007FFC000001E000001
FFF8000007FFC000001E000001FFF8000007FFC000001E000000FFF0000007FFC000001E
000000FFF0000007FFC000001E0000007FE0000007FFC000001E0000007FE0000007FFC0
00001E0000003FC0000007FFC000007F8000003FC0000007FFC000FFFFFFC0003FC0003F
FFFFFFF8FFFFFFC0001F80003FFFFFFFF8FFFFFFC0001F80003FFFFFFFF8FFFFFFC0000F
00003FFFFFFFF865477CC66E>I<00000003FFF0000000000000007FFFFF800000000000
03FFFFFFF000000000000FFF003FFC00000000003FF80007FF0000000000FFE00001FFC0
00000003FF8000007FF000000007FF0000003FF80000000FFE0000001FFC0000001FFC00
00000FFE0000003FF800000007FF0000007FF000000003FF800000FFF000000003FFC000
01FFE000000001FFE00003FFE000000001FFF00003FFC000000000FFF00007FFC0000000
00FFF80007FF80000000007FF8000FFF80000000007FFC000FFF80000000007FFC001FFF
00000000003FFE001FFF00000000003FFE003FFF00000000003FFF003FFF00000000003F
FF003FFF00000000003FFF007FFF00000000003FFF807FFE00000000001FFF807FFE0000
0000001FFF807FFE00000000001FFF807FFE00000000001FFF80FFFE00000000001FFFC0
FFFE00000000001FFFC0FFFE00000000001FFFC0FFFE00000000001FFFC0FFFE00000000
001FFFC0FFFE00000000001FFFC0FFFE00000000001FFFC0FFFE00000000001FFFC0FFFE
00000000001FFFC0FFFE00000000001FFFC0FFFE00000000001FFFC0FFFE00000000001F
FFC0FFFE00000000001FFFC0FFFE00000000001FFFC07FFE00000000001FFF807FFF0000
0000003FFF807FFF00000000003FFF807FFF00000000003FFF803FFF00000000003FFF00
3FFF00000000003FFF003FFF00000000003FFF001FFF80000000007FFE001FFF80000000
007FFE001FFF80000000007FFE000FFFC000000000FFFC000FFFC000000000FFFC0007FF
C000000000FFF80003FFE000000001FFF00003FFE000000001FFF00001FFF000000003FF
E00000FFF800000007FFC000007FF800000007FF8000007FFC0000000FFF8000003FFE00
00001FFF0000000FFF0000003FFC00000007FFC00000FFF800000003FFE00001FFF00000
0000FFF80007FFC0000000007FFF807FFF80000000000FFFFFFFFC000000000003FFFFFF
F00000000000007FFFFF8000000000000003FFF0000000004A497AC757>79
D<FFFFFFFFFFFF000000FFFFFFFFFFFFF80000FFFFFFFFFFFFFE0000FFFFFFFFFFFFFFC0
00001FFF80001FFFE000001FFF800001FFF800001FFF800000FFFC00001FFF8000003FFE
00001FFF8000001FFF00001FFF8000001FFF80001FFF8000000FFF80001FFF8000000FFF
C0001FFF80000007FFC0001FFF80000007FFE0001FFF80000007FFE0001FFF80000007FF
F0001FFF80000007FFF0001FFF80000007FFF0001FFF80000007FFF0001FFF80000007FF
F0001FFF80000007FFF0001FFF80000007FFF0001FFF80000007FFF0001FFF80000007FF
E0001FFF80000007FFE0001FFF80000007FFE0001FFF80000007FFC0001FFF8000000FFF
C0001FFF8000000FFF80001FFF8000001FFF80001FFF8000001FFF00001FFF8000003FFE
00001FFF800000FFFC00001FFF800003FFF000001FFF80001FFFE000001FFFFFFFFFFF80
00001FFFFFFFFFFC0000001FFFFFFFFFE00000001FFF800000000000001FFF8000000000
00001FFF800000000000001FFF800000000000001FFF800000000000001FFF8000000000
00001FFF800000000000001FFF800000000000001FFF800000000000001FFF8000000000
00001FFF800000000000001FFF800000000000001FFF800000000000001FFF8000000000
00001FFF800000000000001FFF800000000000001FFF800000000000001FFF8000000000
00001FFF800000000000001FFF800000000000001FFF800000000000001FFF8000000000
00001FFF800000000000001FFF800000000000001FFF800000000000001FFF8000000000
00001FFF800000000000001FFF800000000000001FFF800000000000FFFFFFFFF0000000
00FFFFFFFFF000000000FFFFFFFFF000000000FFFFFFFFF00000000044477CC64F>I<FF
FFFFFFFFF80000000000FFFFFFFFFFFFE000000000FFFFFFFFFFFFFC00000000FFFFFFFF
FFFFFF00000000001FFF80003FFFC0000000001FFF800003FFF0000000001FFF800000FF
F8000000001FFF8000007FFE000000001FFF8000003FFF000000001FFF8000001FFF0000
00001FFF8000000FFF800000001FFF8000000FFFC00000001FFF8000000FFFC00000001F
FF80000007FFE00000001FFF80000007FFE00000001FFF80000007FFF00000001FFF8000
0007FFF00000001FFF80000007FFF00000001FFF80000007FFF00000001FFF80000007FF
F00000001FFF80000007FFF00000001FFF80000007FFF00000001FFF80000007FFF00000
001FFF80000007FFE00000001FFF80000007FFE00000001FFF8000000FFFC00000001FFF
8000000FFFC00000001FFF8000000FFF800000001FFF8000001FFF000000001FFF800000
3FFE000000001FFF8000007FFC000000001FFF800000FFF0000000001FFF800007FFE000
0000001FFF80003FFF80000000001FFFFFFFFFFC00000000001FFFFFFFFFE00000000000
1FFFFFFFFFF000000000001FFF8000FFFC00000000001FFF80001FFF00000000001FFF80
000FFF80000000001FFF800003FFE0000000001FFF800003FFF0000000001FFF800001FF
F0000000001FFF800000FFF8000000001FFF800000FFFC000000001FFF8000007FFC0000
00001FFF8000007FFC000000001FFF8000007FFE000000001FFF8000007FFE000000001F
FF8000007FFE000000001FFF8000007FFE000000001FFF8000007FFE000000001FFF8000
007FFE000000001FFF8000007FFE000000001FFF8000007FFF000000001FFF8000007FFF
000000001FFF8000007FFF000000001FFF8000007FFF000000001FFF8000007FFF000000
001FFF8000007FFF000180001FFF8000007FFF0003C0001FFF8000007FFF8003C0001FFF
8000003FFF8003C0001FFF8000003FFF8003C0001FFF8000001FFF800780001FFF800000
1FFFC00780001FFF8000000FFFC00F00FFFFFFFFF00007FFE01F00FFFFFFFFF00001FFF8
3E00FFFFFFFFF000007FFFFC00FFFFFFFFF000001FFFF8000000000000000000FFC00052
487CC657>82 D<00007FF00003000007FFFF000700001FFFFFE00F00007FFFFFF01F0000
FFC00FFC3F0001FE0000FE7F0003F800003FFF0007F000000FFF000FE0000007FF001FC0
000003FF001FC0000001FF003FC0000000FF003F800000007F007F800000007F007F8000
00003F007F800000003F00FF800000001F00FF800000001F00FFC00000001F00FFC00000
001F00FFC00000000F00FFE00000000F00FFF00000000F00FFF80000000F00FFFE000000
00007FFF80000000007FFFF8000000007FFFFF800000003FFFFFFC0000003FFFFFFFC000
001FFFFFFFF800000FFFFFFFFF000007FFFFFFFF800007FFFFFFFFE00003FFFFFFFFF000
01FFFFFFFFF800007FFFFFFFFC00003FFFFFFFFE00000FFFFFFFFF000003FFFFFFFF0000
007FFFFFFF80000003FFFFFFC00000003FFFFFC000000001FFFFE0000000001FFFE00000
000007FFE00000000003FFF00000000000FFF00000000000FFF070000000007FF0F00000
00003FF0F0000000003FF0F0000000003FF0F0000000001FF0F0000000001FF0F8000000
001FF0F8000000001FE0F8000000001FE0FC000000001FE0FC000000001FC0FE00000000
3FC0FF000000003FC0FF000000003F80FFC00000007F00FFE00000007F00FFF8000000FE
00FFFE000003FC00FE7FC00007F800FC3FFC003FF000F80FFFFFFFC000F003FFFFFF0000
E0007FFFFC0000C00003FFE0000034497AC741>I<3FFFFFFFFFFFFFFFFC3FFFFFFFFFFF
FFFFFC3FFFFFFFFFFFFFFFFC3FFFFFFFFFFFFFFFFC3FFE0007FFE0007FFC3FF00007FFE0
000FFC7FC00007FFE00003FE7F800007FFE00001FE7F000007FFE00000FE7E000007FFE0
00007E7E000007FFE000007E7C000007FFE000003E7C000007FFE000003E7C000007FFE0
00003E78000007FFE000001E78000007FFE000001E78000007FFE000001E78000007FFE0
00001EF8000007FFE000001FF0000007FFE000000FF0000007FFE000000FF0000007FFE0
00000FF0000007FFE000000FF0000007FFE000000F00000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
00000000000007FFE000000000000007FFE000000000000007FFE000000000000007FFE0
0000000003FFFFFFFFFFC0000003FFFFFFFFFFC0000003FFFFFFFFFFC0000003FFFFFFFF
FFC00048467CC551>I<000FFFF000000000FFFFFF00000003FFFFFFC0000007F8007FF0
00000FFC001FFC00000FFC0007FE00001FFE0003FF00001FFE0003FF80001FFE0001FF80
001FFE0001FFC0001FFE0000FFC0000FFC0000FFE00007F80000FFE00003F00000FFE000
00000000FFE00000000000FFE00000000000FFE00000000000FFE00000000000FFE00000
00007FFFE00000003FFFFFE0000003FFFFFFE000001FFFF0FFE000007FFE00FFE00001FF
E000FFE00003FF8000FFE0000FFE0000FFE0001FFC0000FFE0001FF80000FFE0003FF800
00FFE0007FF00000FFE0007FF00000FFE000FFE00000FFE000FFE00000FFE000FFE00000
FFE000FFE00000FFE000FFE00001FFE000FFE00001FFE0007FF00003FFE0007FF000077F
E0003FF8000F7FE0001FFC003E7FF8000FFF80F83FFFE003FFFFF01FFFE000FFFFC00FFF
E0000FFE0003FFE0332E7CAD38>97 D<007FC000000000FFFFC000000000FFFFC0000000
00FFFFC000000000FFFFC00000000003FFC00000000001FFC00000000001FFC000000000
01FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001
FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FF
C00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC0
0000000001FFC00000000001FFC00000000001FFC01FFC000001FFC0FFFF800001FFC3FF
FFF00001FFCFE01FFC0001FFDF0003FE0001FFFC0001FF0001FFF80000FF8001FFF00000
7FC001FFE000003FE001FFC000003FF001FFC000001FF801FFC000001FF801FFC000001F
FC01FFC000001FFC01FFC000000FFE01FFC000000FFE01FFC000000FFE01FFC000000FFE
01FFC000000FFF01FFC000000FFF01FFC000000FFF01FFC000000FFF01FFC000000FFF01
FFC000000FFF01FFC000000FFF01FFC000000FFF01FFC000000FFF01FFC000000FFF01FF
C000000FFE01FFC000000FFE01FFC000000FFE01FFC000000FFC01FFC000001FFC01FFC0
00001FFC01FFC000001FF801FFC000003FF001FFC000003FF001FFE000007FE001FFF000
007FC001FFF80000FF8001FF3C0001FF0001FE1F0007FE0001FC0FC03FF80001F803FFFF
E00001F000FFFF800001E0001FF8000038487CC741>I<00001FFFC0000001FFFFFC0000
07FFFFFF00001FF8007F80007FE000FFC000FF8000FFC001FF0001FFE003FE0001FFE007
FE0001FFE00FFC0001FFE00FFC0001FFE01FF80000FFC03FF800007F803FF800003F007F
F8000000007FF0000000007FF0000000007FF000000000FFF000000000FFF000000000FF
F000000000FFF000000000FFF000000000FFF000000000FFF000000000FFF000000000FF
F000000000FFF0000000007FF0000000007FF0000000007FF8000000007FF8000000003F
F8000000003FF8000000001FFC000000F00FFC000000F00FFE000001E007FE000001E003
FF000003C001FF8000078000FFC0000F00007FF0003E00001FFC01FC000007FFFFF00000
01FFFFC00000001FFC00002C2E7CAD34>I<0000000000FF8000000001FFFF8000000001
FFFF8000000001FFFF8000000001FFFF800000000007FF800000000003FF800000000003
FF800000000003FF800000000003FF800000000003FF800000000003FF800000000003FF
800000000003FF800000000003FF800000000003FF800000000003FF800000000003FF80
0000000003FF800000000003FF800000000003FF800000000003FF800000000003FF8000
00000003FF800000000003FF800000000003FF8000001FFC03FF800001FFFF83FF800007
FFFFE3FF80001FFC03F3FF80007FE0007FFF8000FF80003FFF8001FF00000FFF8003FE00
0007FF8007FE000003FF800FFC000003FF800FFC000003FF801FF8000003FF803FF80000
03FF803FF8000003FF803FF0000003FF807FF0000003FF807FF0000003FF807FF0000003
FF80FFF0000003FF80FFF0000003FF80FFF0000003FF80FFF0000003FF80FFF0000003FF
80FFF0000003FF80FFF0000003FF80FFF0000003FF80FFF0000003FF80FFF0000003FF80
7FF0000003FF807FF0000003FF807FF0000003FF807FF0000003FF803FF8000003FF803F
F8000003FF801FF8000003FF801FF8000003FF800FFC000003FF8007FC000007FF8003FE
00000FFF8001FF00001FFF8000FF80007FFF80007FC000FBFFC0003FF807E3FFFF000FFF
FFC3FFFF0001FFFF03FFFF00003FF003FFFF38487CC741>I<00001FFC00000001FFFFC0
000007FFFFF000001FF80FFC00007FC001FE0000FF8000FF0001FF00007F8003FE00003F
C007FC00001FE00FFC00001FE01FF800001FF01FF800000FF03FF800000FF83FF800000F
F83FF000000FF87FF0000007F87FF0000007FC7FF0000007FCFFF0000007FCFFF0000007
FCFFFFFFFFFFFCFFFFFFFFFFFCFFFFFFFFFFFCFFF000000000FFF000000000FFF0000000
00FFF000000000FFF0000000007FF0000000007FF0000000007FF0000000003FF8000000
003FF8000000001FF80000003C1FF80000003C0FFC0000003C0FFC0000007807FE000000
F803FF000001F001FF800003E000FFC00007C0003FE0001F80001FFC01FF000007FFFFFC
000000FFFFE00000000FFF00002E2E7DAD35>I<000000FFC00000001FFFF00000007FFF
FC000001FFC0FE000003FF01FF000007FC03FF00000FF807FF80001FF807FF80003FF007
FF80007FF007FF80007FE007FF8000FFE003FF0000FFE001FE0000FFE000FC0000FFE000
300000FFE000000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000
000000FFE000000000FFE000000000FFE000000000FFE000000000FFE0000000FFFFFFFE
0000FFFFFFFE0000FFFFFFFE0000FFFFFFFE000000FFE000000000FFE000000000FFE000
000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000
000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000
000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000
000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000
000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000000000FFE000
000000FFE000000000FFE000000000FFE000000000FFE000000000FFE00000007FFFFFF0
00007FFFFFF000007FFFFFF000007FFFFFF0000029487DC724>I<00000000001F000000
7FF000FFC00007FFFF03FFE0001FFFFFC7E7E0007FE03FFF0FF000FF800FFC0FF001FF00
07FC0FF003FE0003FE0FF007FE0003FF07E007FC0001FF03C00FFC0001FF80000FFC0001
FF80001FFC0001FFC0001FFC0001FFC0001FFC0001FFC0001FFC0001FFC0001FFC0001FF
C0001FFC0001FFC0001FFC0001FFC0001FFC0001FFC0000FFC0001FF80000FFC0001FF80
0007FC0001FF000007FE0003FF000003FE0003FE000001FF0007FC000000FF800FF80000
00FFE03FF0000001DFFFFFC0000003C7FFFF00000003C07FF00000000780000000000007
8000000000000780000000000007C0000000000007C0000000000007E0000000000007E0
000000000007F8000000000007FFFFFFF0000003FFFFFFFF000003FFFFFFFFE00001FFFF
FFFFF00001FFFFFFFFFC0000FFFFFFFFFE00007FFFFFFFFF0001FFFFFFFFFF8007FFFFFF
FFFF800FF000001FFFC01FC0000001FFC03F800000007FC07F800000003FE0FF00000000
3FE0FF000000001FE0FF000000001FE0FF000000001FE0FF000000001FE0FF000000001F
E07F800000003FC07F800000003FC03FC00000007F801FE0000000FF000FF8000003FE00
03FE00000FF80001FFE000FFF000007FFFFFFFC000000FFFFFFE000000007FFFC0000034
447DAE3A>I<007FC000000000FFFFC000000000FFFFC000000000FFFFC000000000FFFF
C00000000003FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC0
0000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC000
00000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000
000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC0000000
0001FFC00000000001FFC007FE000001FFC03FFFC00001FFC07FFFF00001FFC1F81FF800
01FFC3C00FFC0001FFC70007FE0001FFCE0007FE0001FFDC0007FF0001FFF80003FF0001
FFF80003FF8001FFF00003FF8001FFF00003FF8001FFE00003FF8001FFE00003FF8001FF
E00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC0
0003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC000
03FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003
FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF
8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF80
01FFC00003FF8001FFC00003FF80FFFFFF81FFFFFFFFFFFF81FFFFFFFFFFFF81FFFFFFFF
FFFF81FFFFFF38487BC741>I<007C0001FF0003FF8007FFC007FFC00FFFE00FFFE00FFF
E00FFFE00FFFE007FFC007FFC003FF8001FF00007C000000000000000000000000000000
00000000000000000000000000000000000000000000007FC0FFFFC0FFFFC0FFFFC0FFFF
C003FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FF
C001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FF
C001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FFC001FF
C001FFC0FFFFFFFFFFFFFFFFFFFFFFFF18497CC820>I<007FC000000000FFFFC0000000
00FFFFC000000000FFFFC000000000FFFFC00000000003FFC00000000001FFC000000000
01FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001
FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FF
C00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC0
0000000001FFC00000000001FFC00000000001FFC00000000001FFC0003FFFF001FFC000
3FFFF001FFC0003FFFF001FFC0003FFFF001FFC00007FE0001FFC00003F00001FFC00007
E00001FFC0001F800001FFC0003F000001FFC0007E000001FFC000FC000001FFC001F800
0001FFC007E0000001FFC00FC0000001FFC01F80000001FFC03F00000001FFC07E000000
01FFC1FE00000001FFC3FF00000001FFC7FF00000001FFCFFF80000001FFFFFFC0000001
FFFFFFE0000001FFFDFFE0000001FFF8FFF0000001FFF07FF8000001FFC07FFC000001FF
803FFC000001FF801FFE000001FF800FFF000001FF800FFF800001FF8007FF800001FF80
03FFC00001FF8001FFE00001FF8001FFF00001FF8000FFF00001FF80007FF80001FF8000
3FFC0001FF80003FFE0001FF80001FFE0001FF80000FFF0001FF80000FFFC0FFFFFF00FF
FFFEFFFFFF00FFFFFEFFFFFF00FFFFFEFFFFFF00FFFFFE37487DC73D>107
D<007FC000FFFFC000FFFFC000FFFFC000FFFFC00003FFC00001FFC00001FFC00001FFC0
0001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC0
0001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC0
0001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC0
0001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC0
0001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC0
0001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC0
0001FFC00001FFC00001FFC00001FFC00001FFC000FFFFFF80FFFFFF80FFFFFF80FFFFFF
8019487CC720>I<00FF8003FF000003FF000000FFFF801FFFE0001FFFE00000FFFF807F
FFF8007FFFF80000FFFF81F80FFC01F80FFC0000FFFF83C007FE03C007FE000003FF8780
03FF078003FF000001FF8E0003FF0E0003FF000001FF9C0003FF9C0003FF800001FFB800
01FFB80001FF800001FFB80001FFF80001FFC00001FFF00001FFF00001FFC00001FFF000
01FFF00001FFC00001FFE00001FFE00001FFC00001FFE00001FFE00001FFC00001FFE000
01FFE00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC000
01FFC00001FFC000FFFFFF80FFFFFF80FFFFFF80FFFFFF80FFFFFF80FFFFFF80FFFFFF80
FFFFFF80FFFFFF80FFFFFF80FFFFFF80FFFFFF80592E7BAD62>I<00FF8007FE0000FFFF
803FFFC000FFFF807FFFF000FFFF81F81FF800FFFF83C00FFC0003FF870007FE0001FF8E
0007FE0001FF9C0007FF0001FFB80003FF0001FFB80003FF8001FFF00003FF8001FFF000
03FF8001FFE00003FF8001FFE00003FF8001FFE00003FF8001FFC00003FF8001FFC00003
FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF
8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF80
01FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001
FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FF
C00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF80FFFFFF
81FFFFFFFFFFFF81FFFFFFFFFFFF81FFFFFFFFFFFF81FFFFFF382E7BAD41>I<00000FFE
0000000001FFFFF000000007FFFFFC0000001FF803FF0000007FE000FFC00000FF80003F
E00001FF00001FF00003FE00000FF80007FC000007FC000FFC000007FE000FF8000003FE
001FF8000003FF003FF8000003FF803FF0000001FF803FF0000001FF807FF0000001FFC0
7FF0000001FFC07FF0000001FFC0FFF0000001FFE0FFF0000001FFE0FFF0000001FFE0FF
F0000001FFE0FFF0000001FFE0FFF0000001FFE0FFF0000001FFE0FFF0000001FFE0FFF0
000001FFE0FFF0000001FFE07FF0000001FFC07FF0000001FFC07FF0000001FFC07FF000
0001FFC03FF8000003FF803FF8000003FF801FF8000003FF001FFC000007FF000FFC0000
07FE0007FE00000FFC0003FE00000FF80001FF00001FF00000FF80003FE000007FE000FF
C000001FFC07FF00000007FFFFFC00000001FFFFF0000000001FFF000000332E7DAD3A>
I<007FC01FFC0000FFFFC0FFFF8000FFFFC3FFFFF000FFFFCFE03FFC00FFFFDF0007FE00
03FFFC0003FF0001FFF80001FF8001FFF00000FFC001FFE000007FE001FFC000007FF001
FFC000003FF801FFC000003FF801FFC000001FFC01FFC000001FFC01FFC000001FFE01FF
C000001FFE01FFC000000FFE01FFC000000FFE01FFC000000FFF01FFC000000FFF01FFC0
00000FFF01FFC000000FFF01FFC000000FFF01FFC000000FFF01FFC000000FFF01FFC000
000FFF01FFC000000FFF01FFC000000FFF01FFC000000FFE01FFC000001FFE01FFC00000
1FFE01FFC000001FFC01FFC000001FFC01FFC000003FFC01FFC000003FF801FFC000003F
F001FFC000007FF001FFE00000FFE001FFF00000FFC001FFF80001FF8001FFFC0003FF00
01FFDF000FFE0001FFCFC03FF80001FFC3FFFFE00001FFC0FFFF800001FFC01FF8000001
FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FF
C00000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC0
0000000001FFC00000000001FFC00000000001FFC00000000001FFC00000000001FFC000
000000FFFFFF80000000FFFFFF80000000FFFFFF80000000FFFFFF8000000038427CAD41
>I<00001FF80007800001FFFF000F800007FFFF801F80001FFC07E01F80007FF000F03F
8000FFC000787F8001FF80003C7F8003FF00001EFF8007FE00000FFF800FFE00000FFF80
0FFC000007FF801FFC000007FF803FFC000003FF803FF8000003FF803FF8000003FF807F
F8000003FF807FF8000003FF807FF0000003FF80FFF0000003FF80FFF0000003FF80FFF0
000003FF80FFF0000003FF80FFF0000003FF80FFF0000003FF80FFF0000003FF80FFF000
0003FF80FFF0000003FF80FFF0000003FF807FF0000003FF807FF0000003FF807FF80000
03FF807FF8000003FF803FF8000003FF803FF8000003FF801FFC000003FF801FFC000007
FF800FFE000007FF8007FE00000FFF8003FF00001FFF8001FF80003FFF8000FFC0007BFF
80007FE001F3FF80003FF80FE3FF80000FFFFF83FF800003FFFE03FF8000003FF003FF80
0000000003FF800000000003FF800000000003FF800000000003FF800000000003FF8000
00000003FF800000000003FF800000000003FF800000000003FF800000000003FF800000
000003FF800000000003FF800000000003FF800000000003FF800000000003FF80000000
0003FF8000000001FFFFFF00000001FFFFFF00000001FFFFFF00000001FFFFFF38427CAD
3D>I<007F803F80FFFF80FFE0FFFF81FFF8FFFF83C3FCFFFF8707FE03FF8E07FE01FF9C
0FFF01FFB80FFF01FFB80FFF01FFF00FFF01FFF00FFF01FFF007FE01FFE003FC01FFE001
F801FFE0000001FFE0000001FFC0000001FFC0000001FFC0000001FFC0000001FFC00000
01FFC0000001FFC0000001FFC0000001FFC0000001FFC0000001FFC0000001FFC0000001
FFC0000001FFC0000001FFC0000001FFC0000001FFC0000001FFC0000001FFC0000001FF
C0000001FFC0000001FFC0000001FFC0000001FFC0000001FFC0000001FFC00000FFFFFF
E000FFFFFFE000FFFFFFE000FFFFFFE000282E7DAD2F>I<000FFE01C000FFFFC7C003FF
FFFFC007F801FFC00FC0007FC01F00001FC03F00000FC07E000007C07E000007C07E0000
03C0FE000003C0FE000003C0FF000003C0FF800003C0FFE0000000FFF80000007FFFC000
007FFFFF00003FFFFFE0003FFFFFF8001FFFFFFC000FFFFFFF0007FFFFFF8001FFFFFFC0
007FFFFFE0001FFFFFE00000FFFFF0000003FFF00000007FF87000001FF8F000000FF8F0
000007F8F8000007F8F8000003F8F8000003F8FC000003F0FC000003F0FE000003F0FF00
0007E0FF800007E0FFC0000FC0FFF0001F80FEFC00FF00F87FFFFC00F01FFFF000E003FF
8000252E7CAD2E>I<0001E000000001E000000001E000000001E000000001E000000001
E000000003E000000003E000000003E000000007E000000007E000000007E00000000FE0
0000000FE00000001FE00000003FE00000003FE00000007FE0000001FFE0000003FFE000
000FFFFFFFC0FFFFFFFFC0FFFFFFFFC0FFFFFFFFC000FFE0000000FFE0000000FFE00000
00FFE0000000FFE0000000FFE0000000FFE0000000FFE0000000FFE0000000FFE0000000
FFE0000000FFE0000000FFE0000000FFE0000000FFE0000000FFE0000000FFE0000000FF
E0000000FFE0000000FFE0000000FFE0000000FFE0000000FFE0000000FFE0000000FFE0
00F000FFE000F000FFE000F000FFE000F000FFE000F000FFE000F000FFE000F000FFE000
F000FFE000F0007FE000E0007FF001E0003FF001E0003FF003C0001FF80380000FFE0F00
0007FFFE000001FFFC0000001FF00024427EC12D>I<007FC00000FF80FFFFC001FFFF80
FFFFC001FFFF80FFFFC001FFFF80FFFFC001FFFF8003FFC00007FF8001FFC00003FF8001
FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FF
C00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC0
0003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC000
03FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003
FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF8001FFC00003FF
8001FFC00003FF8001FFC00007FF8001FFC00007FF8001FFC00007FF8000FFC0000FFF80
00FFC0001FFF8000FFC0001FFF80007FE0003BFF80003FE000F3FFC0001FF803E3FFFF00
0FFFFF83FFFF0003FFFF03FFFF00003FF803FFFF382E7BAD41>I<FFFFFF0001FFFFFFFF
FF0001FFFFFFFFFF0001FFFFFFFFFF0001FFFF01FFC000001FC001FFE000000F8000FFE0
00000F0000FFF000001F00007FF000001E00007FF800003E00003FF800003C00003FFC00
003C00001FFC00007800001FFE00007800001FFE0000F800000FFE0000F000000FFF0001
F0000007FF0001E0000007FF8003E0000003FF8003C0000003FFC007C0000001FFC00780
000001FFE00780000000FFE00F00000000FFF00F00000000FFF01F000000007FF01E0000
00007FF83E000000003FF83C000000003FFC7C000000001FFC78000000001FFEF8000000
000FFEF0000000000FFFF00000000007FFE00000000007FFE00000000007FFE000000000
03FFC00000000003FFC00000000001FF800000000001FF800000000000FF000000000000
FF0000000000007E0000000000007E0000000000003C000000382E7EAD3D>I<FFFFFE00
1FFFFCFFFFFE001FFFFCFFFFFE001FFFFCFFFFFE001FFFFC00FFE00003FE0000FFF00001
F800007FF80001F000003FFC0003E000001FFC0007C000000FFE000F8000000FFF001F00
000007FF803F00000003FFC07E00000001FFC07C00000000FFE0F800000000FFF1F00000
00007FFBE0000000003FFFC0000000001FFFC0000000000FFF80000000000FFF00000000
0007FF800000000003FFC00000000001FFE00000000001FFE00000000003FFF000000000
07FFF80000000007FFFC000000000F9FFE000000001F0FFE000000003E07FF000000007C
07FF80000000F803FFC0000001F801FFE0000003F000FFE0000003E0007FF0000007C000
7FF800000F80003FFC00001F00001FFE00003E00000FFE00007E000007FF0001FF000007
FF80FFFFE0007FFFFFFFFFE0007FFFFFFFFFE0007FFFFFFFFFE0007FFFFF382E7EAD3D>
120 D<FFFFFF0001FFFFFFFFFF0001FFFFFFFFFF0001FFFFFFFFFF0001FFFF01FFC00000
1FC001FFE000000F8000FFE000000F0000FFF000001F00007FF000001E00007FF800003E
00003FF800003C00003FFC00003C00001FFC00007800001FFE00007800001FFE0000F800
000FFE0000F000000FFF0001F0000007FF0001E0000007FF8003E0000003FF8003C00000
03FFC007C0000001FFC00780000001FFE00780000000FFE00F00000000FFF00F00000000
FFF01F000000007FF01E000000007FF83E000000003FF83C000000003FFC7C000000001F
FC78000000001FFEF8000000000FFEF0000000000FFFF00000000007FFE00000000007FF
E00000000007FFE00000000003FFC00000000003FFC00000000001FF800000000001FF80
0000000000FF000000000000FF0000000000007E0000000000007E0000000000003C0000
000000003C0000000000007C00000000000078000000000000F8000000000000F0000000
000001F00000001F0001E00000003F8003E00000007FC003C0000000FFE007C0000000FF
E00780000000FFE00F80000000FFE01F00000000FFE01E000000007FC07C000000007F80
F8000000003F03F0000000001FFFE00000000007FF800000000001FC000000000038427E
AD3D>I E /Fv 84 125 df<007E1F0001C1B1800303E3C00703C3C00E03C1800E01C000
0E01C0000E01C0000E01C0000E01C0000E01C000FFFFFC000E01C0000E01C0000E01C000
0E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C000
0E01C0000E01C0000E01C0000E01C0007F87FC001A1D809C18>11
D<007E0001C1800301800703C00E03C00E01800E00000E00000E00000E00000E0000FFFF
C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01
C00E01C00E01C00E01C00E01C07F87F8151D809C17>I<007FC001C1C00303C00703C00E
01C00E01C00E01C00E01C00E01C00E01C00E01C0FFFFC00E01C00E01C00E01C00E01C00E
01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C07F
CFF8151D809C17>I<003F07E00001C09C18000380F018000701F03C000E01E03C000E00
E018000E00E000000E00E000000E00E000000E00E000000E00E00000FFFFFFFC000E00E0
1C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C
000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C00
0E00E01C007FC7FCFF80211D809C23>I<60F0F0F0F0F0F0F06060606060606060606060
6060000000000060F0F060041E7C9D0C>33 D<6060F0F0F8F86868080808080808101010
102020404080800D0C7F9C15>I<00030180000301800003018000060300000603000006
03000006030000060300000C0600000C0600000C0600000C060000180C007FFFFFF8FFFF
FFFC0030180000301800003018000030180000603000006030000060300000603000FFFF
FFFC7FFFFFF800C060000180C0000180C0000180C0000180C00003018000030180000301
8000030180000603000006030000060300001E257E9C23>I<60F0F86808080810102040
80050C7C9C0C>39 D<00800100020006000C000C00180018003000300030006000600060
006000E000E000E000E000E000E000E000E000E000E000E000E000600060006000600030
0030003000180018000C000C000600020001000080092A7C9E10>I<8000400020003000
180018000C000C0006000600060003000300030003000380038003800380038003800380
0380038003800380038003000300030003000600060006000C000C001800180030002000
40008000092A7E9E10>I<00060000000600000006000000060000000600000006000000
060000000600000006000000060000000600000006000000060000FFFFFFE0FFFFFFE000
060000000600000006000000060000000600000006000000060000000600000006000000
0600000006000000060000000600001B1C7E9720>43 D<60F0F070101010102020408004
0C7C830C>I<FFE0FFE00B0280890E>I<60F0F06004047C830C>I<000100030006000600
06000C000C000C0018001800180030003000300060006000C000C000C001800180018003
0003000300060006000C000C000C00180018001800300030003000600060006000C000C0
0010297E9E15>I<03C00C301818300C300C700E60066006E007E007E007E007E007E007
E007E007E007E007E007E007E00760066006700E300C300C18180C3007E0101D7E9B15>
I<010007003F00C700070007000700070007000700070007000700070007000700070007
00070007000700070007000700070007000700FFF80D1C7C9B15>I<07C01830201C400C
400EF00FF80FF807F8077007000F000E000E001C001C00380070006000C0018003000601
0C01180110023FFE7FFEFFFE101C7E9B15>I<07E01830201C201C781E780E781E381E00
1C001C00180030006007C00030001C001C000E000F000F700FF80FF80FF80FF00E401C20
1C183007C0101D7E9B15>I<000C00000C00001C00003C00003C00005C0000DC00009C00
011C00031C00021C00041C000C1C00081C00101C00301C00201C00401C00C01C00FFFFC0
001C00001C00001C00001C00001C00001C00001C0001FFC0121C7F9B15>I<300C3FF83F
F03FC020002000200020002000200023E02C303018301C200E000E000F000F000F600FF0
0FF00FF00F800E401E401C2038187007C0101D7E9B15>I<00F0030C04040C0E181E301E
300C700070006000E3E0E430E818F00CF00EE006E007E007E007E007E007600760077006
300E300C18180C3003E0101D7E9B15>I<4000007FFF807FFF007FFF0040020080040080
040080080000100000100000200000600000400000C00000C00001C00001800001800003
8000038000038000038000078000078000078000078000078000078000030000111D7E9B
15>I<03E00C301008200C200660066006700670067C0C3E183FB01FE007F007F818FC30
7E601E600FC007C003C003C003C00360026004300C1C1007E0101D7E9B15>I<03C00C30
1818300C700C600EE006E006E007E007E007E007E0076007700F300F18170C2707C70006
0006000E300C780C78187018203010C00F80101D7E9B15>I<60F0F06000000000000000
00000060F0F06004127C910C>I<60F0F0600000000000000000000060F0F07010101010
20204080041A7C910C>I<7FFFFFC0FFFFFFE00000000000000000000000000000000000
000000000000000000000000000000FFFFFFE07FFFFFC01B0C7E8F20>61
D<0FE03038401CE00EF00EF00EF00E000C001C0030006000C00080018001000100010001
00010001000000000000000000000003000780078003000F1D7E9C14>63
D<000600000006000000060000000F0000000F0000000F000000178000001780000037C0
000023C0000023C0000043E0000041E0000041E0000080F0000080F0000080F000010078
000100780001FFF80002003C0002003C0002003C0004001E0004001E000C001F000C000F
001E001F00FF00FFF01C1D7F9C1F>65 D<FFFFC0000F0078000F003C000F001E000F000E
000F000F000F000F000F000F000F000F000F000E000F001E000F003C000F00F8000FFFF0
000F003C000F001E000F000F000F0007000F0007800F0007800F0007800F0007800F0007
800F000F000F000F000F001E000F007800FFFFE000191C7F9B1D>I<001F808000E06180
01801980070007800E0003801C0003801C00018038000180780000807800008070000080
F0000000F0000000F0000000F0000000F0000000F0000000F0000000F000000070000080
7800008078000080380000801C0001001C0001000E000200070004000180080000E03000
001FC000191E7E9C1E>I<FFFFC0000F00F0000F003C000F000E000F0007000F0007000F
0003800F0003C00F0001C00F0001C00F0001E00F0001E00F0001E00F0001E00F0001E00F
0001E00F0001E00F0001E00F0001C00F0001C00F0003C00F0003800F0007800F0007000F
000E000F001C000F007000FFFFC0001B1C7E9B20>I<FFFFFC0F003C0F000C0F00040F00
040F00060F00020F00020F01020F01000F01000F01000F03000FFF000F03000F01000F01
000F01000F01010F00010F00020F00020F00020F00060F00060F000C0F003CFFFFFC181C
7E9B1C>I<FFFFF80F00780F00180F00080F00080F000C0F00040F00040F01040F01000F
01000F01000F03000FFF000F03000F01000F01000F01000F01000F00000F00000F00000F
00000F00000F00000F00000F0000FFF800161C7E9B1B>I<001F808000E0618001801980
070007800E0003801C0003801C00018038000180780000807800008070000080F0000000
F0000000F0000000F0000000F0000000F0000000F000FFF0F0000F807000078078000780
78000780380007801C0007801C0007800E00078007000B800180118000E06080001F8000
1C1E7E9C21>I<FFF0FFF00F000F000F000F000F000F000F000F000F000F000F000F000F
000F000F000F000F000F000F000F000F000F000F000F000FFFFF000F000F000F000F000F
000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F
000F000F000F00FFF0FFF01C1C7F9B1F>I<FFF00F000F000F000F000F000F000F000F00
0F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F00
FFF00C1C7F9B0F>I<07FF80007C00003C00003C00003C00003C00003C00003C00003C00
003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00
703C00F83C00F83C00F8380070780040700030E0000F8000111D7F9B15>I<FFF01FE00F
0007800F0006000F0004000F0008000F0010000F0020000F0040000F0080000F0100000F
0200000F0600000F0F00000F1780000F2780000F43C0000F81E0000F01E0000F00F0000F
0078000F0078000F003C000F003E000F001E000F000F000F000F800F000FC0FFF03FF01C
1C7F9B20>I<FFF8000F80000F00000F00000F00000F00000F00000F00000F00000F0000
0F00000F00000F00000F00000F00000F00000F00000F00000F00080F00080F00080F0018
0F00180F00100F00300F00700F01F0FFFFF0151C7E9B1A>I<FF8000FF800F8000F8000F
8000F8000BC00178000BC00178000BC001780009E002780009E002780008F004780008F0
04780008F0047800087808780008780878000878087800083C107800083C107800083C10
7800081E207800081E207800081E207800080F407800080F407800080780780008078078
00080780780008030078001C03007800FF8307FF80211C7E9B26>I<FF001FF00F800380
0FC001000BC0010009E0010008F0010008F0010008780100083C0100083E0100081E0100
080F0100080F8100080781000803C1000801E1000801F1000800F1000800790008007D00
08003D0008001F0008001F0008000F0008000700080003001C000300FF8001001C1C7F9B
1F>I<003F800000E0E0000380380007001C000E000E001C0007003C0007803800038078
0003C0780003C0700001C0F00001E0F00001E0F00001E0F00001E0F00001E0F00001E0F0
0001E0F00001E0700001C0780003C0780003C0380003803C0007801C0007000E000E0007
001C000380380000E0E000003F80001B1E7E9C20>I<FFFF800F00E00F00780F003C0F00
1C0F001E0F001E0F001E0F001E0F001E0F001C0F003C0F00780F00E00FFF800F00000F00
000F00000F00000F00000F00000F00000F00000F00000F00000F00000F0000FFF000171C
7E9B1C>I<FFFF00000F01E0000F0078000F003C000F001C000F001E000F001E000F001E
000F001E000F001C000F003C000F0078000F01E0000FFF00000F01E0000F0070000F0078
000F003C000F003C000F003C000F003C000F003C000F003C000F003C100F003C100F001C
100F001C10FFF00E20000003C01C1D7E9B1F>82 D<07E0801C1980300580300380600180
E00180E00080E00080E00080F00000F800007C00007FC0003FF8001FFE0007FF0000FF80
000F800007C00003C00001C08001C08001C08001C0C00180C00180E00300D00200CC0C00
83F800121E7E9C17>I<7FFFFFC0700F01C0600F00C0400F0040400F0040C00F0020800F
0020800F0020800F0020000F0000000F0000000F0000000F0000000F0000000F0000000F
0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F
0000000F0000001F800003FFFC001B1C7F9B1E>I<FFF01FF00F0003800F0001000F0001
000F0001000F0001000F0001000F0001000F0001000F0001000F0001000F0001000F0001
000F0001000F0001000F0001000F0001000F0001000F0001000F0001000F0001000F0001
0007000200078002000380040001C0040000E0180000706000000F80001C1D7F9B1F>I<
FFE00FF01F0003C01F0001800F0001000F000100078002000780020007C0020003C00400
03C0040003E00C0001E0080001E0080000F0100000F0100000F810000078200000782000
003C4000003C4000003C4000001E8000001E8000001F8000000F0000000F000000060000
00060000000600001C1D7F9B1F>I<FFE1FFC0FF1F003E003C1E003C00180F001E00100F
001E00100F001E001007801F002007801F002007801F002003C027804003C027804003C0
27804001E043C08001E043C08001E043C08000F081E10000F081E10000F081E10000F900
F300007900F200007900F200007E007E00003E007C00003E007C00003C003C00001C0038
00001C00380000180018000008001000281D7F9B2B>I<FFF07FC00FC01E0007800C0007
C0080003C0100001E0200001F0200000F0400000788000007C8000003D0000003E000000
1F0000000F0000000F8000000F80000013C0000023E0000021E0000040F0000080F80000
80780001007C0002003E0002001E0006001F001F001F80FF807FF01C1C7F9B1F>I<FFF0
03FC0F8001E0078000C007C0008003C0010003E0030001E0020000F0040000F804000078
0800007C1800003C1000003E2000001F2000000F4000000FC00000078000000780000007
80000007800000078000000780000007800000078000000780000007800000078000007F
F8001E1C809B1F>I<FEFEC0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0FEFE07297C9E0C>91 D<0808101020204040404080808080
8080B0B0F8F8787830300D0C7A9C15>I<FEFE0606060606060606060606060606060606
0606060606060606060606060606060606060606FEFE0729809E0C>I<08102040408080
80B0F87830050C7D9C0C>96 D<1FC000307000783800781C00301C00001C00001C0001FC
000F1C00381C00701C00601C00E01C40E01C40E01C40603C40304E801F870012127E9115
>I<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C
7C001D87001E01801C00C01C00E01C00601C00701C00701C00701C00701C00701C00701C
00601C00E01C00C01E018019070010FC00141D7F9C17>I<03F80C0C181E301E700C6000
E000E000E000E000E000E00060007002300218040C1803E00F127F9112>I<001F800003
8000038000038000038000038000038000038000038000038000038003F3800E0B801807
80300380700380600380E00380E00380E00380E00380E00380E003806003807003803003
801807800E1B8003E3F0141D7F9C17>I<07E00C301818300C700E6006E006FFFEE000E0
00E000E00060007002300218040C1803E00F127F9112>I<00F8018C071E061E0E0C0E00
0E000E000E000E000E00FFE00E000E000E000E000E000E000E000E000E000E000E000E00
0E000E000E000E007FE00F1D809C0D>I<00038007C4C01C78C0383880301800701C0070
1C00701C00701C003018003838001C700027C0002000002000003000003FF8001FFF001F
FF802003806001C0C000C0C000C0C000C06001803003001C0E0007F800121C7F9215>I<
FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C7C00
1C87001D03001E03801C03801C03801C03801C03801C03801C03801C03801C03801C0380
1C03801C03801C03801C0380FF9FF0141D7F9C17>I<18003C003C001800000000000000
0000000000000000FC001C001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C00FF80091D7F9C0C>I<00C001E001E000C000000000000000000000000000
0007E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E060E0F0C0F1C061803E000B25839C0D>I<FC00001C00001C00001C0000
1C00001C00001C00001C00001C00001C00001C00001C0FE01C07801C06001C0C001C1000
1C20001C40001CE0001DE0001E70001C78001C38001C3C001C1C001C0E001C0F001C0F80
FF9FE0131D7F9C16>I<FC001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00FF80091D7F9C
0C>I<FC7E07E0001C838838001D019018001E01E01C001C01C01C001C01C01C001C01C0
1C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C
001C01C01C001C01C01C001C01C01C00FF8FF8FF8021127F9124>I<FC7C001C87001D03
001E03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03
801C03801C0380FF9FF014127F9117>I<03F0000E1C00180600300300700380600180E0
01C0E001C0E001C0E001C0E001C0E001C06001807003803003001806000E1C0003F00012
127F9115>I<FC7C001D87001E01801C01C01C00E01C00E01C00701C00701C00701C0070
1C00701C00701C00E01C00E01C01C01E01801D07001CFC001C00001C00001C00001C0000
1C00001C00001C0000FF8000141A7F9117>I<03E0800E19801805803807807003807003
80E00380E00380E00380E00380E00380E003807003807003803807801807800E1B8003E3
80000380000380000380000380000380000380000380001FF0141A7F9116>I<FCE01D38
1E781E781C301C001C001C001C001C001C001C001C001C001C001C001C00FFC00D127F91
10>I<1F9020704030C010C010E010F8007F803FE00FF000F880388018C018C018E010D0
608FC00D127F9110>I<04000400040004000C000C001C003C00FFE01C001C001C001C00
1C001C001C001C001C001C101C101C101C101C100C100E2003C00C1A7F9910>I<FC1F80
1C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380
1C03801C07800C07800E1B8003E3F014127F9117>I<FF07E03C03801C01001C01000E02
000E02000F060007040007040003880003880003C80001D00001D00000E00000E00000E0
0000400013127F9116>I<FF3FC7E03C0703C01C0701801C0701001C0B01000E0B82000E
0B82000E1182000711C4000711C4000720C40003A0E80003A0E80003C0680001C0700001
C0700001803000008020001B127F911E>I<FF0FE01E07001C06000E0400070800039000
03B00001E00000E00000F00001F000013800021C00041C000C0E001807003C0780FE1FF0
14127F9116>I<FF07E03C03801C01001C01000E02000E02000F06000704000704000388
0003880003C80001D00001D00000E00000E00000E000004000004000008000008000F080
00F10000F30000660000380000131A7F9116>I<7FFC70386038407040F040E041C003C0
038007000F040E041C043C0C380870087038FFF80E127F9112>I<FFFFFFFFFF80290180
8B2A>124 D E /Fw 22 123 df<70F8FCFC7404040404080810102040060F7C840E>44
D<70F8F8F87005057C840E>46 D<008003800F80F3800380038003800380038003800380
038003800380038003800380038003800380038003800380038003800380038003800380
0380038007C0FFFE0F217CA018>49 D<1000801E07001FFF001FFE001FF80017E0001000
0010000010000010000010000010000011F800120C001C07001803801003800001C00001
C00001E00001E00001E00001E07001E0F001E0F001E0E001C08001C04003C04003802007
001006000C1C0003F00013227EA018>53 D<007E0001C1000300800601C00C03C01C03C0
180180380000380000780000700000700000F0F800F30C00F40600F40300F80380F801C0
F001C0F001E0F001E0F001E0F001E0F001E07001E07001E07001E03801C03801C0180380
1C03000C0600070C0001F00013227EA018>I<01F000060C000C06001807003803807003
80700380F001C0F001C0F001C0F001E0F001E0F001E0F001E0F001E07001E07003E03803
E01805E00C05E00619E003E1E00001C00001C00001C00003800003803003807807007806
00700C002018001030000FC00013227EA018>57 D<FFFFFFC00F8007C0078001C0078000
C00780004007800040078000600780002007800020078000200780202007802000078020
0007802000078060000780E00007FFE0000780E000078060000780200007802000078020
000780200007800000078000000780000007800000078000000780000007800000078000
00078000000FC00000FFFE00001B227EA120>70 D<FFC00003FF0FC00003F007C00003E0
05E00005E005E00005E004F00009E004F00009E004F00009E004780011E004780011E004
780011E0043C0021E0043C0021E0043C0021E0041E0041E0041E0041E0040F0081E0040F
0081E0040F0081E004078101E004078101E004078101E00403C201E00403C201E00401E4
01E00401E401E00401E401E00400F801E00400F801E00400F801E004007001E00E007001
E01F007003F0FFE0203FFF28227EA12D>77 D<FF8007FF07C000F807C0007005E0002004
F0002004F0002004780020047C0020043C0020041E0020041F0020040F00200407802004
0780200403C0200401E0200401E0200400F0200400F8200400782004003C2004003E2004
001E2004000F2004000F20040007A0040003E0040003E0040001E0040001E0040000E00E
0000601F000060FFE0002020227EA125>I<FFFFE000000F803C000007800E0000078007
8000078007C000078003C000078003E000078003E000078003E000078003E000078003E0
00078003C000078007C000078007800007800E000007803C000007FFE000000780700000
078038000007801C000007801E000007800E000007800F000007800F000007800F000007
800F000007800F800007800F800007800F800007800F808007800FC080078007C0800FC0
03C100FFFC01E2000000007C0021237EA124>82 D<1FE000303800780C00780E00300700
00070000070000070000FF0007C7001E07003C0700780700700700F00708F00708F00708
F00F087817083C23900FC1E015157E9418>97 D<0E0000FE00001E00000E00000E00000E
00000E00000E00000E00000E00000E00000E00000E00000E00000E1F000E61C00E80600F
00300E00380E003C0E001C0E001E0E001E0E001E0E001E0E001E0E001E0E001E0E001C0E
003C0E00380F00700C80600C41C0083F0017237FA21B>I<0000E0000FE00001E00000E0
0000E00000E00000E00000E00000E00000E00000E00000E00000E00000E001F8E00704E0
0C02E01C01E03800E07800E07000E0F000E0F000E0F000E0F000E0F000E0F000E0F000E0
7000E07800E03800E01801E00C02E0070CF001F0FE17237EA21B>100
D<01FC000707000C03801C01C03801C07801E07000E0F000E0FFFFE0F00000F00000F000
00F00000F000007000007800203800201C00400E008007030000FC0013157F9416>I<0E
1FC07F00FE60E183801E807201C00F003C00E00F003C00E00E003800E00E003800E00E00
3800E00E003800E00E003800E00E003800E00E003800E00E003800E00E003800E00E0038
00E00E003800E00E003800E00E003800E00E003800E00E003800E0FFE3FF8FFE27157F94
2A>109 D<0E1F80FE60C01E80E00F00700F00700E00700E00700E00700E00700E00700E
00700E00700E00700E00700E00700E00700E00700E00700E00700E0070FFE7FF18157F94
1B>I<01FC000707000C01801800C03800E0700070700070F00078F00078F00078F00078
F00078F00078F000787000707800F03800E01C01C00E038007070001FC0015157F9418>
I<0E3CFE461E8F0F0F0F060F000E000E000E000E000E000E000E000E000E000E000E000E
000E000F00FFF010157F9413>114 D<0F8830786018C018C008C008E008F0007F003FE0
0FF001F8003C801C800C800CC00CC008E018D0308FC00E157E9413>I<FF80FE1E00781E
00300E00200E00200700400700400780C003808003808001C10001C10000E20000E20000
E20000740000740000380000380000380000100017157F941A>118
D<FF80FE1E00781E00300E00200E00200700400700400780C003808003808001C10001C1
0000E20000E20000E2000074000074000038000038000038000010000010000020000020
00002000004000F04000F08000F180004300003C0000171F7F941A>121
D<3FFFC0380380300780200700600E00401C00403C0040380000700000E00001E00001C0
000380400700400F00400E00C01C0080380080780180700780FFFF8012157F9416>I
E /Fx 23 122 df<FFFF80FFFF80FFFF8011037F9016>45 D<00003FE0010001FFF80300
07F01E03001F800307003E000087007800004F00F000002F01E000001F03C000000F0780
00000F0F800000070F000000071F000000031E000000033E000000033C000000017C0000
00017C000000017C000000017800000000F800000000F800000000F800000000F8000000
00F800000000F800000000F800000000F800000000F800000000F800000000F800000000
78000000007C000000007C000000017C000000013C000000013E000000011E000000011F
000000020F000000020F80000006078000000403C000000801E000000800F00000100078
000020003E0000C0001F8003800007F00F000001FFFC0000003FE00028337CB130>67
D<003FFFC0003FFFC00000FE0000007C0000007C0000007C0000007C0000007C0000007C
0000007C0000007C0000007C0000007C0000007C0000007C0000007C0000007C0000007C
0000007C0000007C0000007C0000007C0000007C0000007C0000007C0000007C0000007C
0000007C0000007C0000007C0000007C0000007C0000007C0000007C0000007C0000007C
0000007C0000007C0078007C00FC007C00FC007C00FC007C00F8007800B000F8004000F0
004001E0002001C00018038000060F000001F800001A327CB022>74
D<FFF00000007FF8FFF00000007FF807F00000007F0002F8000000BE0002F8000000BE00
02F8000000BE00027C0000013E00027C0000013E00023E0000023E00023E0000023E0002
3E0000023E00021F0000043E00021F0000043E00021F0000043E00020F8000083E00020F
8000083E00020F8000083E000207C000103E000207C000103E000207C000103E000203E0
00203E000203E000203E000201F000403E000201F000403E000201F000403E000200F800
803E000200F800803E000200F800803E0002007C01003E0002007C01003E0002007C0100
3E0002003E02003E0002003E02003E0002003E02003E0002001F04003E0002001F04003E
0002000F88003E0002000F88003E0002000F88003E00020007D0003E00020007D0003E00
020007D0003E00020003E0003E00020003E0003E00020003E0003E00070001C0003E000F
8001C0007F00FFF801C00FFFF8FFF800800FFFF835317CB03D>77
D<FFE00007FFC0FFF00007FFC003F000007C0002F80000380002FC00001000027C000010
00023E00001000023E00001000021F00001000021F80001000020F800010000207C00010
000207E00010000203E00010000203F00010000201F00010000200F80010000200FC0010
0002007C00100002007E00100002003E00100002001F00100002001F80100002000F8010
0002000FC01000020007C01000020003E01000020003F01000020001F01000020000F810
00020000F810000200007C10000200007E10000200003E10000200001F10000200001F10
000200000F90000200000FD00002000007D00002000003F00002000003F00002000001F0
0002000001F00002000000F0000200000070000700000070000F8000003000FFF8000030
00FFF8000010002A317CB032>I<007F802001FFE02007C078600F001C601E0006E03C00
03E0380001E0780000E0700000E070000060F0000060F0000060F0000020F0000020F000
0020F8000020F80000007C0000007E0000003F0000003FC000001FF800000FFF800007FF
F80003FFFC0000FFFF00000FFF800000FFC000001FE0000007E0000003F0000001F00000
00F0000000F8000000F88000007880000078800000788000007880000078C0000078C000
0070E00000F0E00000E0F00000E0F80001C0EC000380C7000700C1F01E00807FFC00800F
F0001D337CB125>83 D<7FFFFFFFFFE07FFFFFFFFFE07E000F8007E078000F8001E07000
0F8000E060000F80006040000F80002040000F800020C0000F800030C0000F8000308000
0F80001080000F80001080000F80001080000F80001080000F80001080000F8000100000
0F80000000000F80000000000F80000000000F80000000000F80000000000F8000000000
0F80000000000F80000000000F80000000000F80000000000F80000000000F8000000000
0F80000000000F80000000000F80000000000F80000000000F80000000000F8000000000
0F80000000000F80000000000F80000000000F80000000000F80000000000F8000000000
0F80000000000F80000000000F80000000000F80000000000F80000000000F8000000000
1FC00000000FFFFF8000000FFFFF80002C317EB030>I<00FE00000303C0000C00E00010
007000100038003C003C003E001C003E001E003E001E0008001E0000001E0000001E0000
001E00000FFE0000FC1E0003E01E000F801E001F001E003E001E003C001E007C001E00F8
001E04F8001E04F8001E04F8003E04F8003E0478003E047C005E043E008F080F0307F003
FC03E01E1F7D9E21>97 D<003F8000E0600380180700040F00041E001E1C003E3C003E7C
003E7C0008780000F80000F80000F80000F80000F80000F80000F80000F80000F8000078
00007C00007C00003C00011E00011E00020F000207000403801800E060003F80181F7D9E
1D>99 D<000001E000003FE000003FE0000003E0000001E0000001E0000001E0000001E0
000001E0000001E0000001E0000001E0000001E0000001E0000001E0000001E0000001E0
000001E0000001E0001F81E000F061E001C019E0078005E00F0003E00E0003E01E0001E0
3C0001E03C0001E07C0001E0780001E0F80001E0F80001E0F80001E0F80001E0F80001E0
F80001E0F80001E0F80001E0F80001E0780001E0780001E03C0001E03C0001E01C0001E0
1E0003E00E0005E0070009E0038011F000E061FF003F81FF20327DB125>I<003F800000
E0E0000380380007003C000E001E001E001E001C000F003C000F007C000F0078000F8078
000780F8000780F8000780FFFFFF80F8000000F8000000F8000000F8000000F8000000F8
000000780000007C0000003C0000003C0000801E0000800E0001000F0002000780020001
C00C0000F03000001FC000191F7E9E1D>I<0780000000FF80000000FF800000000F8000
000007800000000780000000078000000007800000000780000000078000000007800000
000780000000078000000007800000000780000000078000000007800000000780000000
07800000000780FE00000783078000078C03C000079001E00007A001E00007A000F00007
C000F00007C000F000078000F000078000F000078000F000078000F000078000F0000780
00F000078000F000078000F000078000F000078000F000078000F000078000F000078000
F000078000F000078000F000078000F000078000F000078000F000078000F000078000F0
000FC001F800FFFC1FFF80FFFC1FFF8021327EB125>104 D<07000F801F801F800F8007
00000000000000000000000000000000000000000000000780FF80FF800F800780078007
800780078007800780078007800780078007800780078007800780078007800780078007
800780078007800FC0FFF8FFF80D307EAF12>I<07800000FF800000FF8000000F800000
078000000780000007800000078000000780000007800000078000000780000007800000
07800000078000000780000007800000078000000780000007801FFC07801FFC078007E0
078007800780060007800400078008000780100007806000078080000781000007838000
07878000078FC0000793C00007A1E00007C1F0000780F0000780780007807C0007803C00
07803E0007801F0007800F0007800F80078007C0078003C0078003E00FC007F8FFFC0FFF
FFFC0FFF20327EB123>107 D<0780FF80FF800F80078007800780078007800780078007
800780078007800780078007800780078007800780078007800780078007800780078007
80078007800780078007800780078007800780078007800780078007800780078007800F
C0FFFCFFFC0E327EB112>I<0780FE0000FF83078000FF8C03C0000F9001E00007A001E0
0007A000F00007C000F00007C000F000078000F000078000F000078000F000078000F000
078000F000078000F000078000F000078000F000078000F000078000F000078000F00007
8000F000078000F000078000F000078000F000078000F000078000F000078000F0000780
00F000078000F0000FC001F800FFFC1FFF80FFFC1FFF80211F7E9E25>110
D<001FC00000F0780001C01C00070007000F0007801E0003C01C0001C03C0001E03C0001
E0780000F0780000F0780000F0F80000F8F80000F8F80000F8F80000F8F80000F8F80000
F8F80000F8F80000F8780000F07C0001F03C0001E03C0001E01E0003C01E0003C00F0007
8007800F0001C01C0000F07800001FC0001D1F7E9E21>I<0783E0FF8C18FF907C0F907C
07A07C07C03807C00007C00007C000078000078000078000078000078000078000078000
078000078000078000078000078000078000078000078000078000078000078000078000
0FC000FFFE00FFFE00161F7E9E19>114 D<01FC100E03301800F0300070600030E00030
E00010E00010E00010F00010F800007E00003FF0001FFF000FFFC003FFE0003FF00001F8
0000F880003C80003C80001CC0001CC0001CE0001CE00018F00038F00030CC0060C301C0
80FE00161F7E9E1A>I<00400000400000400000400000400000C00000C00000C00001C0
0001C00003C00007C0000FC0001FFFE0FFFFE003C00003C00003C00003C00003C00003C0
0003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C01003C0
1003C01003C01003C01003C01003C01003C01001C02001E02000E0400078C0001F00142C
7FAB19>I<078000F000FF801FF000FF801FF0000F8001F000078000F000078000F00007
8000F000078000F000078000F000078000F000078000F000078000F000078000F0000780
00F000078000F000078000F000078000F000078000F000078000F000078000F000078000
F000078000F000078000F000078001F000078001F000078001F000038002F00003C004F0
0001C008F800007030FF80001FC0FF80211F7E9E25>I<FFF07FF80FFCFFF07FF80FFC0F
C007C003F00F8003C001C0078003C00080078003C0008003C003E0010003C003E0010003
C007E0010001E004F0020001E004F0020001E00870020000F00878040000F00878040000
F0103804000078103C08000078103C08000078201C0800003C201E1000003C201E100000
3C400E1000001E400F2000001E400F2000001E80072000000F8007C000000F8007C00000
0F0003C0000007000380000007000380000006000180000002000100002E1F7F9E30>
119 D<FFF801FF80FFF801FF800FC0007C00078000380007C000300003C000200003C000
200001E000400001E000400001F000400000F000800000F0008000007801000000780100
00007C010000003C020000003C020000001E040000001E040000001F040000000F080000
000F080000000790000000079000000007D000000003E000000003E000000001C0000000
01C000000001C00000000080000000008000000001000000000100000000010000000002
000000000200000000040000007004000000F80C000000F808000000F810000000703000
000030400000001F80000000212D7F9E23>121 D E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 368 1070 a Fx(New)21 b(Jersey)h(Mac)n(hine-Co)r(de)e(T)-6
b(o)r(olkit)681 1161 y(Source)22 b(Co)r(de)423 1344 y
Fw(Norman)16 b(Ramsey)e(and)j(Mary)f(F.)g(F)l(ernandez)658
1464 y(No)o(v)o(em)o(b)q(er)d(15,)k(1996)p eop
%%Page: 2 2
2 1 bop 129 141 a Fv(2)1066 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)p eop
%%Page: 3 3
3 2 bop 145 590 a Fu(Con)m(ten)m(ts)145 806 y Ft(I)56
b(Icon)19 b(co)r(de)1091 b(7)145 897 y Fs(1)39 b(Main)15
b(program)1044 b(9)145 988 y(2)39 b(En)o(vironmen)n(ts)13
b(and)i(en)o(vironmen)n(t)e(errors)523 b(25)208 1038
y Fv(2.1)41 b(Injection)14 b(and)g(pro)r(jection)29 b(.)20
b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)45 b(29)145 1129 y Fs(3)39 b(Grammar)14
b(for)h(the)g(sp)q(eci\014cation)e(language)491 b(31)208
1179 y Fv(3.1)41 b(Fields)14 b(and)g(\014eld)g(information)24
b(.)c(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)45 b(35)208 1229 y(3.2)c(Bit)14 b(n)o(um)o(b)q(ering)40
b(.)20 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45 b(36)208
1279 y(3.3)c(Placeholders)14 b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)45 b(37)208 1329 y(3.4)c(P)o(attern)15 b(de\014nitions)30
b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45 b(38)303 1378
y(3.4.1)h(P)o(attern)15 b(syn)o(tax)30 b(.)20 b(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45
b(42)208 1428 y(3.5)c(Constructors)f(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)45 b(44)303 1478 y(3.5.1)h(Deleting)13 b(constructors)45
b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)45 b(48)208 1528 y(3.6)c(Equations)26 b(.)20
b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45
b(48)208 1578 y(3.7)c(Co)q(de)14 b(con)o(taining)f(matc)o(hing)f
(statemen)o(ts)39 b(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)45 b(50)208 1628 y(3.8)c(Sp)q(eci\014cations)15
b(for)e(fetc)o(hing)h(w)o(ords)43 b(.)20 b(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45 b(51)208 1677
y(3.9)c(Assem)o(bly)13 b(syn)o(tax)32 b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
g(.)g(.)45 b(52)303 1727 y(3.9.1)h(Globbing)12 b(expressions)17
b(.)j(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)45 b(53)208 1777 y(3.10)20 b(Lexical)13
b(elemen)o(ts)39 b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45
b(54)145 1868 y Fs(4)39 b(P)o(atterns)1141 b(55)208 1918
y Fv(4.1)41 b(Seman)o(tics,)13 b(constructors,)i(and)f(m)o(utators)25
b(.)c(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45
b(55)303 1968 y(4.1.1)h(Explanation)13 b(of)g(pattern)i(lab)q(els)26
b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45
b(57)303 2018 y(4.1.2)h(P)o(attern)15 b(constructor)g(functions)23
b(.)d(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45
b(60)303 2068 y(4.1.3)h(P)o(attern)15 b(m)o(utator)d(functions)18
b(.)i(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)45 b(63)208 2117 y(4.2)c(Preparing)14 b(patterns)h(for)f(emission)21
b(.)g(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)45 b(69)208 2167 y(4.3)c(Eliminating)11 b(con)o(tradictions)16
b(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)f(.)g(.)g(.)45 b(71)208 2217 y(4.4)c(F)m(unctions)14
b(on)g(patterns)37 b(.)20 b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45 b(72)208
2267 y(4.5)c(In)o(terpreting)15 b(abstract)g(syn)o(tax)e(in)o(to)h
(normal)d(form)-15 b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
45 b(74)303 2317 y(4.5.1)h(T)m(ree)14 b(w)o(alking)f(with)g(free)i(v)n
(ariables)d(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)45 b(74)303 2366 y(4.5.2)h(Finding)13 b(free)h(v)n(ariables)g(in)f
(abstract)i(syn)o(tax)j(.)i(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)45
b(78)208 2416 y(4.6)c(Manipulations)13 b(of)g(conditions)25
b(.)20 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)45 b(80)851 2604 y(3)p eop
%%Page: 4 4
4 3 bop 129 141 a Fv(4)1066 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fs(5)39 b(Expressions)13 b(and)j(Equations)760
b(81)192 307 y Fv(5.1)41 b(Searc)o(hing)14 b(for)g(subterms)g(and)g
(free)g(v)n(ariables)40 b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)44 b(84)192 357 y(5.2)d(T)m(esting)14 b(for)f(equalit)o(y)h(.)
21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)44 b(84)192 407 y(5.3)d(Substitution)16
b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)44
b(88)192 457 y(5.4)d(Simpli\014cation)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)44 b(92)192 507 y(5.5)d(Imaging)27 b(.)20
b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(101)192
557 y(5.6)41 b(Seman)o(tic)13 b(functions)25 b(.)c(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)i(113)192 606 y(5.7)41 b(Creation)19 b(.)h(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(115)192 656 y(5.8)41
b(Visiting)13 b(ev)o(ery)i(term)e(of)g(an)h(expression)37
b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i
(117)192 706 y(5.9)41 b(Generalized)15 b(substitution)22
b(.)f(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)i(120)192 756 y(5.10)d(Mapping)13
b(expressions)j(to)d(p)q(ost\014x)i(strings)27 b(.)20
b(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(128)129
847 y Fs(6)39 b(Solving)1143 b(135)192 897 y Fv(6.1)41
b(Basic)15 b(linear)e(solving)j(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i
(135)192 947 y(6.2)41 b(Balances)18 b(.)i(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)i(141)192 997 y(6.3)41 b(Utilit)o(y)13
b(go)q(o)e(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i
(144)129 1088 y Fs(7)39 b(Balancing)14 b(out)h(nonlin)o(ear)e
(expressions)544 b(147)192 1138 y Fv(7.1)41 b(Sup)q(erstructure)e(.)20
b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(148)192 1187
y(7.2)41 b(Balancing)13 b(out)h(DIV)g(and)g(MOD)21 b(.)f(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(149)192
1237 y(7.3)41 b(Balancing)13 b(out)h(narro)o(ws)g(and)g(widens)34
b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
i(151)192 1287 y(7.4)41 b(Balancing)13 b(out)h(slices)43
b(.)20 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(153)192 1337 y(7.5)41
b(Utilities)31 b(.)20 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)i(155)192 1387 y(7.6)41 b(Debugging)13 b(supp)q(ort)23
b(.)e(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(156)129 1478 y Fs(8)39
b(Constructors)1025 b(159)192 1528 y Fv(8.1)41 b(Creating)14
b(and)g(c)o(hec)o(king)g(constructors)21 b(.)f(.)h(.)f(.)g(.)g(.)h(.)f
(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(159)287 1578
y(8.1.1)46 b(Basic)14 b(t)o(yp)q(es)31 b(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)i(159)287 1628 y(8.1.2)46 b(In)o(terpreting)15 b(and)f(c)o(hec)o
(king)g(constructor)h(sp)q(eci\014cations)43 b(.)20 b(.)h(.)i(160)192
1677 y(8.2)41 b(Utilit)o(y)13 b(functions)39 b(.)20 b(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)i(166)287 1727 y(8.2.1)46 b(Input)14
b(generation)30 b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(166)287 1777
y(8.2.2)46 b(Chec)o(king)14 b(constructor)h(t)o(yp)q(es)33
b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
i(166)287 1827 y(8.2.3)46 b(Miscellan)o(y)13 b(.)20 b(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)i(167)192 1877 y(8.3)41 b(Applying)13
b(constructors)34 b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(168)287
1926 y(8.3.1)46 b(Righ)o(t-hand-side)13 b(patterns)44
b(.)20 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)i(168)287 1976 y(8.3.2)46 b(Applying)13 b(the)h(patterns)30
b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)i(173)287 2026 y(8.3.3)46 b(Eliminating)11
b(instances)40 b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)i(178)192 2076 y(8.4)41 b(Mac)o(hine-indep)q
(enden)o(t)15 b(supp)q(ort)g(for)f(enco)q(ding)g(pro)q(cedures)29
b(.)20 b(.)h(.)f(.)g(.)h(.)i(183)287 2126 y(8.4.1)46
b(Emission)40 b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f
(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(189)287
2175 y(8.4.2)46 b(Conditions)39 b(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i
(198)192 2225 y(8.5)41 b(Supp)q(ort)15 b(for)e(enco)q(ding)h(pro)q
(cedures)i(\(in)e(C\))39 b(.)20 b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)i(202)287 2275 y(8.5.1)46 b(C)14 b(t)o(yp)q(e)g
(declarations)g(for)g(instances)29 b(.)20 b(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)i(202)192 2325 y(8.6)41 b(C)14
b(supp)q(ort)h(for)e(closures)33 b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(204)
287 2375 y(8.6.1)46 b(Extracting)10 b(relo)q(catable)h(addresses)h
(from)d(instances)i(and)f(closures)r(210)287 2425 y(8.6.2)46
b(Creating)14 b(instances)32 b(.)20 b(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(212)287
2474 y(8.6.3)46 b(Emitting)40 b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
i(214)p eop
%%Page: 5 5
5 4 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1065
b(5)208 258 y(8.7)41 b(Optimizing)12 b(closures)g(.)21
b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(214)145 349 y Fs(9)39
b(Managing)14 b(generation)f(of)j(binary)e(enco)q(ders)454
b(229)145 440 y(10)15 b(Managing)f(generation)f(of)j(assem)o(bly)e
(enco)q(ders)402 b(235)208 490 y Fv(10.1)20 b(Name)13
b(mapping)27 b(.)20 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(237)303
540 y(10.1.1)h(Mapping)13 b(constructor)j(names)j(.)h(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(238)303
590 y(10.1.2)h(Mapping)13 b(op)q(erands)29 b(.)21 b(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(241)
208 640 y(10.2)c(Assem)o(bly)13 b(syn)o(tax)h(of)f(constructors)42
b(.)20 b(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)
g(.)k(242)208 689 y(10.3)c(Emitting)12 b(prin)o(t)i(pro)q(cedures)i
(for)d(constructors)18 b(.)i(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)
g(.)k(245)208 739 y(10.4)c(Generating)14 b(prin)o(t)g(pro)q(cedures)i
(for)d(op)q(erands)37 b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)k(246)208 789 y(10.5)c(Little)14 b(utilit)o(y)e(pro)q(cedures)35
b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)
f(.)g(.)h(.)f(.)g(.)g(.)k(251)145 880 y Fs(11)15 b(Emitting)e(assem)o
(bly-langu)o(age)g(grammars)488 b(253)145 972 y(12)15
b(Supp)q(ort)e(for)i(pattern-matc)o(hi)o(ng)d(statemen)o(ts)433
b(259)208 1021 y Fv(12.1)20 b(P)o(attern)15 b(syn)o(tax)f(in)f(deco)q
(ding)38 b(.)20 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)k(259)145 1113 y Fs(13)15
b(Generating)d(decision)i(trees)766 b(267)208 1163 y
Fv(13.1)20 b(T)m(ransformation)11 b(to)j(absolute)g(normal)e(form)22
b(.)e(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(269)208
1212 y(13.2)c(Structure)c(of)d(matc)o(hing)f(statemen)o(ts)i(and)g
(tree)h(no)q(des)30 b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(271)208
1262 y(13.3)c(T)m(ree-minimi)o(zation)11 b(heuristics)16
b(.)k(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)k(280)208 1312 y(13.4)c(Utilit)o(y)13
b(functions)39 b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(282)208
1362 y(13.5)c(T)m(ree)15 b(c)o(hec)o(king)25 b(.)c(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)
g(.)h(.)f(.)g(.)g(.)k(284)145 1453 y Fs(14)15 b(Con)o(v)o(erting)e
(trees)h(to)i(dags)783 b(287)145 1544 y(15)15 b(Co)q(de)h(generation)d
(for)i(matc)o(hing)671 b(293)208 1594 y Fv(15.1)20 b(Handling)13
b(fetc)o(h)h(and)g(address)h(templates)39 b(.)21 b(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(302)145 1686 y Fs(16)15
b(Sp)q(eci\014cation)d(Chec)o(k)o(er)850 b(305)208 1735
y Fv(16.1)20 b(Ho)o(w)14 b(to)f(build)g(a)h(c)o(hec)o(k)o(er)k(.)i(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)
h(.)f(.)g(.)g(.)k(307)208 1785 y(16.2)c(Building)13 b(a)g(c)o(hec)o(k)o
(er)37 b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(308)208
1835 y(16.3)c(Generating)14 b(Inputs)g(for)g(Chec)o(k)o(er)43
b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
g(.)g(.)k(313)145 1926 y Fs(17)15 b(Con)o(v)o(erting)e(Expressions)g
(to)j(C)698 b(325)208 1976 y Fv(17.1)20 b(Supp)q(ort)14
b(for)g(deco)q(ding)g(co)q(de)h(in)e(C)23 b(.)e(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(338)145
2068 y Fs(18)15 b(Con)o(v)o(erting)e(Expressions)g(to)j(Mo)q(dula-3)531
b(339)208 2117 y Fv(18.1)20 b(Supp)q(ort)14 b(for)g(deco)q(ding)g(co)q
(de)h(in)e(Mo)q(dula-3)41 b(.)20 b(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)k(348)145 2209 y Fs(19)15 b(Miscellaneous)d(co)q
(de-generation)h(pro)q(cedures)419 b(349)145 2300 y(20)15
b(Field-depende)o(n)o(t)d(information)698 b(353)208 2350
y Fv(20.1)20 b(Field)14 b(categories)22 b(.)e(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
f(.)g(.)g(.)k(353)208 2400 y(20.2)c(Emitting)12 b(\014eld)i(names)22
b(.)e(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g
(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)k(356)p eop
%%Page: 6 6
6 5 bop 129 141 a Fv(6)1066 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fs(21)i(Lexical)f(analysis)972
b(359)192 307 y Fv(21.1)20 b(Supp)q(ort)15 b(for)e(c)o(haracter)i
(constan)o(ts)21 b(.)g(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g
(.)g(.)h(.)f(.)g(.)h(.)i(365)129 399 y Fs(22)15 b(Output)1143
b(367)192 449 y Fv(22.1)20 b(W)m(riting)13 b(trees)i(in)e(ascii)h
(format)h(.)20 b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)
g(.)g(.)h(.)f(.)g(.)h(.)i(373)192 498 y(22.2)d(W)m(riting)13
b(trees)i(and)f(dags)g(in)f Fr(dot\(1\))g Fv(format)g(.)20
b(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(374)129
642 y Ft(I)r(I)56 b(Library)17 b(co)r(de)936 b(379)129
733 y Fs(23)15 b(The)g(library)1058 b(381)192 783 y Fv(23.1)20
b(Relo)q(catable)14 b(Blo)q(c)o(ks)25 b(.)c(.)f(.)g(.)h(.)f(.)g(.)g(.)h
(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)
i(381)287 833 y(23.1.1)i(Optimizing)12 b(sequen)o(tial)i(emission)27
b(.)20 b(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(384)
287 882 y(23.1.2)i(Emitting)12 b(data)h(in)o(to)h(relo)q(catable)g(blo)
q(c)o(ks)c(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(386)287
932 y(23.1.3)i(Lo)q(cation-coun)o(ter)14 b(manipulations)e(.)20
b(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(396)287
982 y(23.1.4)i(P)o(oin)o(ting)13 b(registers)i(in)o(to)e(relo)q
(catable)h(blo)q(c)o(ks)h(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i
(397)287 1032 y(23.1.5)i(Other)15 b(op)q(erations)f(on)g(relo)q
(catable)g(blo)q(c)o(ks)k(.)i(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i
(398)287 1082 y(23.1.6)i(Accessing)15 b(con)o(ten)o(ts)g(of)f(relo)q
(catable)g(blo)q(c)o(ks)30 b(.)20 b(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i
(400)192 1131 y(23.2)d(Lab)q(els)26 b(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(403)192 1181 y(23.3)d(Relo)q(cation)13
b(and)h(closures)38 b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(405)192
1231 y(23.4)d(Supp)q(ort)15 b(for)e(prin)o(ting)g(relo)q(catable)h
(addresses)29 b(.)20 b(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i
(408)192 1281 y(23.5)d(Boilerplate)42 b(.)21 b(.)f(.)g(.)g(.)h(.)f(.)g
(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)h(.)i(409)129 1372 y Fs(24)15 b(Relo)q(catable)f
(Addresses)827 b(411)129 1515 y Ft(I)r(I)r(I)55 b(Bac)n(k)19
b(matter)920 b(413)192 1565 y Fv(24.1)20 b(List)14 b(of)f(c)o(h)o(unks)
19 b(.)h(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)
g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)i(415)192
1615 y(24.2)d(Index)42 b(.)21 b(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h
(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)h(.)f(.)g(.)h(.)f(.)g(.)g(.)
h(.)f(.)g(.)h(.)i(422)p eop
%%Page: 7 7
7 6 bop 733 1005 a Fq(P)m(art)32 b(I)618 1212 y Fu(Icon)38
b(co)s(de)851 2604 y Fv(7)p eop
%%Page: 8 8
8 7 bop eop
%%Page: 9 9
9 8 bop 145 569 a Fq(Chapter)32 b(1)145 777 y Fu(Main)40
b(program)20 998 y Fp(9a)89 b Fo(h)p Fn(version)15 b(string)g
Fp(9a)p Fo(i)o(\021)1007 b Fp(\(20\))187 1048 y Fr("0.5")18
1135 y Fp(9b)89 b Fo(h)p Fn(*)15 b Fp(9b)p Fo(i\021)1238
b Fp(9c)5 b Fm(.)187 1185 y Fr(link)21 b(pushtrace)22
1272 y Fp(9c)89 b Fo(h)p Fn(*)15 b Fp(9b)p Fo(i)p Fv(+)p
Fo(\021)1104 b Fm(/)5 b Fp(9b)23 b(11c)5 b Fm(.)187 1321
y Fr(procedure)20 b(usage\(\))274 1371 y(every)h(write\(&errout,)e(![)
361 1421 y("Usage:)h(tools)h([options])f([specfile)g(...]",)361
1471 y("Options:",)361 1521 y Fo(h)p Fn(usage)c(lines)e
Fp(9e)p Fo(i)361 1570 y Fr("`-')21 b(may)g(be)h(used)f(in)g(place)g(of)
g(a)h(file)f(name)g(to)g(mean)g(stdin)g(or)g(stdout"]\))274
1620 y(stop\(\))187 1670 y(end)145 1721 y Fp(De\014nes:)187
1760 y Fl(usage)p Fp(,)10 b(used)g(in)h(c)o(h)o(unk)f(20.)145
1800 y(Uses)i Fl(file)e Fp(359a)h(and)f Fl(used)h Fp(136a.)18
1887 y(9d)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o(\021)820 b Fp(\(20\))22 b(9f)6 b Fm(.)187
1936 y Fr("-alt")173 b(:)21 b(alt)h(:=)f(&output)22 2023
y Fp(9e)89 b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o(\021)980
b Fp(\(9c\))23 b(9g)5 b Fm(.)187 2073 y Fr(")87 b(-ascii-dag)19
b(file)65 b(write)21 b(an)g(ascii)g(representation)e(of)i
(matching-statement)d(code",)145 2124 y Fp(Uses)12 b
Fl(file)e Fp(359a.)27 2211 y(9f)89 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)p Fo(\021)679
b Fp(\(20\))23 b Fm(/)5 b Fp(9d)23 b(10a)5 b Fm(.)187
2261 y Fr("-ascii-dag")19 b(:)j(ascii_dag)63 b(:=)22
b(openfile\(get\(ar)o(gs\),")o(w"\))145 2312 y Fp(Uses)12
b Fl(openfile)d Fp(24.)20 2399 y(9g)89 b Fo(h)p Fn(usage)16
b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)848 b Fp(\(9c\))23
b Fm(/)5 b Fp(9e)23 b(10b)5 b Fm(.)187 2448 y Fr(")87
b(-ascii-tree)19 b(file)43 b(write)21 b(an)g(ascii)g(representation)e
(of)i(matchin-statement)d(trees",)145 2499 y Fp(Uses)12
b Fl(file)e Fp(359a)h(and)f Fl(tree)h Fp(274.)851 2604
y Fv(9)p eop
%%Page: 10 10
10 9 bop 129 141 a Fv(10)83 b Fr(main.nw)808 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)-13 258 y Fp(10a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)689
b Fp(\(20\))23 b Fm(/)5 b Fp(9f)23 b(10c)5 b Fm(.)171
307 y Fr("-ascii-tree")19 b(:)j(ascii_tree)d(:=)j(openfile\(get\(arg)o
(s\),"w)o("\))129 359 y Fp(Uses)12 b Fl(openfile)d Fp(24)i(and)g
Fl(tree)f Fp(274.)-15 451 y(10b)88 b Fo(h)p Fn(usage)16
b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)847 b Fp(\(9c\))22
b Fm(/)5 b Fp(9g)23 b(10d)5 b Fm(.)171 500 y Fr(")87
b(-asm-encoder)19 b(file)i(generate)f(assembly-emitting)f(encoding)h
(procedures)f(on)j(file.[ch]",)129 552 y Fp(Uses)12 b
Fl(file)e Fp(359a.)-12 644 y(10c)89 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)665
b Fp(\(20\))22 b Fm(/)6 b Fp(10a)22 b(10e)5 b Fm(.)171
694 y Fr("-asm-encoder")19 b(:)i(asmencoderfilename)40
b(:=)22 b(get\(args\))-15 785 y Fp(10d)88 b Fo(h)p Fn(usage)16
b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)836 b Fp(\(9c\))22
b Fm(/)6 b Fp(10b)22 b(10f)5 b Fm(.)171 835 y Fr(")87
b(-asm-grammar)19 b(file)i(generate)f(assembly-language)f(grammar)h(on)
h(file",)129 887 y Fp(Uses)12 b Fl(file)e Fp(359a.)-12
978 y(10e)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)q Fo(\021)665 b Fp(\(20\))22 b Fm(/)6
b Fp(10c)22 b(10g)5 b Fm(.)171 1028 y Fr("-asm-grammar")19
b(:)i(asmgrammarfilename)40 b(:=)22 b(get\(args\))129
1080 y Fp(Uses)12 b Fl(asmgrammarf)o(ile)o(na)o(me)c
Fp(18a.)-7 1171 y(10f)89 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)827 b Fp(\(9c\))22 b Fm(/)6
b Fp(10d)22 b(10h)5 b Fm(.)171 1221 y Fr(")87 b(-byteorder)20
b(O)130 b(use)21 b(order)g(O)h(\(one)f(of)g([blm]\))g(to)g(emit)g
(words",)-13 1312 y Fp(10g)88 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)673
b Fp(\(20\))22 b Fm(/)5 b Fp(10e)23 b(10i)5 b Fm(.)171
1362 y Fr("-byteorder")41 b(:)22 b(emittername)d(:=)j("emit")e(||)h
(get\(args\))129 1414 y Fp(Uses)12 b Fl(emittername)c
Fp(18a.)-15 1505 y(10h)88 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)845 b Fp(\(9c\))22 b Fm(/)5
b Fp(10f)23 b(10j)5 b Fm(.)171 1555 y Fr(")87 b(-c)348
b(generate)20 b(C)i(code)f([default]",)-6 1646 y Fp(10i)89
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)q Fo(\021)662 b Fp(\(20\))22 b Fm(/)6 b Fp(10g)22
b(10k)5 b Fm(.)171 1696 y Fr("-c")21 b(:)h({)f(Generate_C\(\);)e
(interface_extensio)o(n)g(:=)i(".h";)g(implementation_ext)o(ensio)o(n)e
(:=)i(".c")g(})129 1748 y Fp(Uses)12 b Fl(Generate_C)c
Fp(338a,)i Fl(implementati)o(on)o(_ex)o(ten)o(sio)o(n)f
Fp(18a,)h(and)h Fl(interface_)o(ex)o(ten)o(sio)o(n)e
Fp(18a.)-7 1839 y(10j)89 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)837 b Fp(\(9c\))22 b Fm(/)6
b Fp(10h)22 b(10l)5 b Fm(.)171 1889 y Fr(")87 b(-checker)20
b(file)86 b(generate)21 b(a)g(checker)f(on)i(file",)129
1941 y Fp(Uses)12 b Fl(file)e Fp(359a.)-14 2032 y(10k)88
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)q Fo(\021)659 b Fp(\(20\))22 b Fm(/)6 b Fp(10i)22
b(10m)5 b Fm(.)171 2082 y Fr("-checker")85 b(:)43 b({)22
b(checkerfilename)d(:=)i(get\(args\))f(})-6 2173 y Fp(10l)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)838 b Fp(\(9c\))22 b Fm(/)6 b Fp(10j)22 b(11a)5
b Fm(.)171 2223 y Fr(")87 b(-count)260 b(count)21 b(invocations)e(of)j
(encoding)e(procedures",)-25 2315 y Fp(10m)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o
Fv(+)q Fo(\021)660 b Fp(\(20\))22 b Fm(/)6 b Fp(10k)22
b(11b)5 b Fm(.)171 2364 y Fr("-count")129 b(:)22 b(gen_counters)d(:=)i
(1)129 2416 y Fp(Uses)12 b Fl(gen_counter)o(s)d Fp(18a.)p
eop
%%Page: 11 11
11 10 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)808
b Fr(main.nw)82 b Fv(11)-403 258 y Fk(\031Change)14 b(#17)2
318 y Fp(11a)89 b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p
Fo(i)o Fv(+)p Fo(\021)837 b Fp(\(9c\))22 b Fm(/)5 b Fp(10l)23
b(11d)5 b Fm(.)187 368 y Fr(")87 b(-debug-bal)19 b(file)65
b(extra)21 b(debugging)f(info)h(for)g(balancer",)145
418 y Fp(Uses)12 b Fl(debug)e Fp(376a)g(and)h Fl(file)f
Fp(359a.)0 503 y(11b)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)654 b Fp(\(20\))22 b Fm(/)6
b Fp(10m)22 b(11e)5 b Fm(.)187 553 y Fr("-debug-bal")19
b(:)j(baldebug)e(:=)h(openfile\(get\(args\))o(,"w"\))145
604 y Fp(Uses)12 b Fl(baldebug)d Fp(11c,)h Fl(debug)g
Fp(376a,)h(and)f Fl(openfile)f Fp(24.)4 689 y(11c)89
b Fo(h)p Fn(*)15 b Fp(9b)p Fo(i)p Fv(+)p Fo(\021)1104
b Fm(/)5 b Fp(9c)23 b(15d)5 b Fm(.)187 739 y Fr(global)20
b(baldebug)145 789 y Fp(De\014nes:)187 829 y Fl(baldebug)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(11b)h(and)f(157.)0
914 y(11d)89 b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o
Fv(+)p Fo(\021)838 b Fp(\(9c\))22 b Fm(/)5 b Fp(11a)23
b(11f)5 b Fm(.)187 964 y Fr(")87 b(-debug-checker)19
b(file)42 b(write)21 b(debugging)f(info)h(about)g(checker",)145
1014 y Fp(Uses)12 b Fl(debug)e Fp(376a)g(and)h Fl(file)f
Fp(359a.)4 1100 y(11e)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)662 b Fp(\(20\))22 b Fm(/)6
b Fp(11b)22 b(11g)5 b Fm(.)187 1150 y Fr("-debug-checker")18
b(:)k(cdebug)e(:=)i(openfile\(get\(arg)o(s\),"w)o("\))145
1200 y Fp(Uses)12 b Fl(cdebug)e Fp(18a,)g Fl(debug)g
Fp(376a,)g(and)h Fl(openfile)e Fp(24.)9 1285 y(11f)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)827 b Fp(\(9c\))22 b Fm(/)6 b Fp(11d)22 b(11h)5
b Fm(.)187 1335 y Fr(")87 b(-debug-heur)19 b(file)43
b(write)21 b(debugging)f(info)h(about)f(heuristic)g(scores",)145
1386 y Fp(Uses)12 b Fl(debug)e Fp(376a)g(and)h Fl(file)f
Fp(359a.)2 1471 y(11g)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)674 b Fp(\(20\))22 b Fm(/)5
b Fp(11e)23 b(11i)5 b Fm(.)187 1521 y Fr("-debug-heur")19
b(:)i(hdebug)g(:=)g(openfile\(get\(args\),)o("w"\))145
1571 y Fp(Uses)12 b Fl(debug)e Fp(376a,)g Fl(hdebug)g
Fp(18a,)g(and)h Fl(openfile)e Fp(24.)0 1657 y(11h)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)844 b Fp(\(9c\))23 b Fm(/)5 b Fp(11f)23 b(11j)5
b Fm(.)187 1706 y Fr(")87 b(-debug-match)19 b(file)i(write)g(debugging)
f(info)h(about)f(matching)h(statements",)145 1757 y Fp(Uses)12
b Fl(debug)e Fp(376a)g(and)h Fl(file)f Fp(359a.)10 1842
y(11i)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)663 b Fp(\(20\))22 b Fm(/)6
b Fp(11g)22 b(11k)5 b Fm(.)187 1892 y Fr("-debug-match")19
b(:)i(mdebug)g(:=)g(openfile\(get\(args\))o(,"w"\))145
1942 y Fp(Uses)12 b Fl(debug)e Fp(376a,)g Fl(mdebug)g
Fp(18a,)g(and)h Fl(openfile)e Fp(24.)9 2028 y(11j)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)837 b Fp(\(9c\))22 b Fm(/)5 b Fp(11h)23 b(11l)5
b Fm(.)187 2078 y Fr(")87 b(-debug-solver)106 b(turn)21
b(on)g(solver)g(debugging",)145 2128 y Fp(Uses)12 b Fl(debug)e
Fp(376a.)1 2213 y(11k)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)672 b Fp(\(20\))22 b Fm(/)5
b Fp(11i)23 b(12a)5 b Fm(.)187 2263 y Fr("-debug-solver")18
b(:)k(debug_on\(\))145 2314 y Fp(Uses)12 b Fl(debug)e
Fp(376a)g(and)h Fl(debug_on)e Fp(376a.)10 2399 y(11l)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)836 b Fp(\(9c\))22 b Fm(/)5 b Fp(11j)23 b(12b)5
b Fm(.)187 2449 y Fr(")87 b(-debug-split)19 b(file)i(write)g(debugging)
f(info)h(when)g(splitting)f(tree)h(nodes",)145 2499 y
Fp(Uses)12 b Fl(debug)e Fp(376a,)g Fl(file)g Fp(359a,)h
Fl(split)f Fp(277a,)g(and)g Fl(tree)h Fp(274.)p eop
%%Page: 12 12
12 11 bop 129 141 a Fv(12)83 b Fr(main.nw)808 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-13 258 y Fp(12a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)664
b Fp(\(20\))22 b Fm(/)6 b Fp(11k)22 b(12c)5 b Fm(.)171
307 y Fr("-debug-split")19 b(:)i(sdebug)g(:=)g(openfile\(get\(args\),)o
("w"\))129 358 y Fp(Uses)12 b Fl(debug)e Fp(376a,)g Fl(openfile)f
Fp(24,)i Fl(sdebug)f Fp(18a,)g(and)h Fl(split)f Fp(277a.)-15
445 y(12b)88 b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o
Fv(+)p Fo(\021)837 b Fp(\(9c\))22 b Fm(/)6 b Fp(11l)22
b(12d)5 b Fm(.)171 494 y Fr(")87 b(-decoder)20 b(file)108
b(from)21 b(matcher,)f(generate)g(decoder)h(on)g(file",)129
545 y Fp(Uses)12 b Fl(file)e Fp(359a.)-12 631 y(12c)89
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)q Fo(\021)665 b Fp(\(20\))22 b Fm(/)6 b Fp(12a)22
b(12e)5 b Fm(.)171 681 y Fr("-decoder")20 b(:)h(decoderout)f(:=)h
(openfile\(get\(args\),)o("w"\))129 732 y Fp(Uses)12
b Fl(openfile)d Fp(24.)-15 818 y(12d)88 b Fo(h)p Fn(usage)16
b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)836 b Fp(\(9c\))22
b Fm(/)6 b Fp(12b)22 b(12f)5 b Fm(.)171 868 y Fr(")87
b(-dis)21 b(file)195 b(generate)20 b(disassembly)g(code)h(on)g(file",)
129 919 y Fp(Uses)12 b Fl(file)e Fp(359a.)-12 1005 y(12e)89
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)q Fo(\021)665 b Fp(\(20\))22 b Fm(/)6 b Fp(12c)22
b(12g)5 b Fm(.)171 1055 y Fr("-dis")173 b(:)22 b(disassemblyfilen)o
(ame)40 b(:=)22 b(get\(args\))129 1106 y Fp(Uses)12 b
Fl(disassembly)o(fil)o(en)o(ame)c Fp(18a.)-7 1192 y(12f)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)827 b Fp(\(9c\))22 b Fm(/)6 b Fp(12d)22 b(12h)5
b Fm(.)171 1242 y Fr(")87 b(-dot)21 b(file)195 b(write)21
b(dot\(1\))g(commands)f(showing)g(matching)g(statements",)129
1292 y Fp(Uses)12 b Fl(file)e Fp(359a.)-13 1379 y(12g)88
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)q Fo(\021)673 b Fp(\(20\))22 b Fm(/)5 b Fp(12e)23
b(12i)5 b Fm(.)171 1429 y Fr("-dot")21 b(:)g(dotfile)64
b(:=)21 b(openfile\(get\(args\),)o("w"\))129 1479 y Fp(Uses)12
b Fl(openfile)d Fp(24.)-15 1566 y(12h)88 b Fo(h)p Fn(usage)16
b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)845 b Fp(\(9c\))22
b Fm(/)5 b Fp(12f)23 b(12j)5 b Fm(.)171 1616 y Fr(")87
b(-emit-bits)20 b(n)130 b(unit)21 b(of)h(emission)e(is)h(n)h(bits)f
(\(default)f(8\)",)-6 1702 y Fp(12i)89 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)662
b Fp(\(20\))22 b Fm(/)6 b Fp(12g)22 b(12k)5 b Fm(.)171
1752 y Fr("-emit-bits")63 b(:)21 b(emit_unit_bits)e(:=)j
(integer\(get\(args)o(\)\))d(|)i(stop\("-emitbits)e(not)i(integer"\))
129 1802 y Fp(Uses)12 b Fl(emit_unit_b)o(its)c Fp(18a.)-7
1889 y(12j)89 b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p
Fo(i)o Fv(+)p Fo(\021)837 b Fp(\(9c\))22 b Fm(/)6 b Fp(12h)22
b(12l)5 b Fm(.)171 1939 y Fr(")87 b(-encoder)20 b(file)108
b(generate)20 b(encoding)g(procedures)g(on)i(file.[ch]",)129
1989 y Fp(Uses)12 b Fl(file)e Fp(359a.)-14 2076 y(12k)88
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)q Fo(\021)659 b Fp(\(20\))22 b Fm(/)6 b Fp(12i)22
b(12m)5 b Fm(.)171 2126 y Fr("-encoder")20 b(:)h(encoderfilename)41
b(:=)21 b(get\(args\))-6 2212 y Fp(12l)89 b Fo(h)p Fn(usage)16
b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)838 b Fp(\(9c\))22
b Fm(/)6 b Fp(12j)22 b(13a)5 b Fm(.)171 2262 y Fr(")87
b(-expand-spec)19 b(file)i(writes)g(an)g(expanded)f(version)h(of)g(the)
g(input)g(specification",)129 2312 y Fp(Uses)12 b Fl(file)e
Fp(359a,)h Fl(input)f Fp(46a,)g(and)h Fl(version)e Fp(18a.)-25
2399 y(12m)88 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)q Fo(\021)660 b Fp(\(20\))22 b Fm(/)6
b Fp(12k)22 b(13b)5 b Fm(.)171 2449 y Fr("-expand-spec")19
b(:)i(spec)43 b(:=)22 b(openfile\(get\(ar)o(gs\),")o(w"\))129
2499 y Fp(Uses)12 b Fl(openfile)d Fp(24.)p eop
%%Page: 13 13
13 12 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)808
b Fr(main.nw)82 b Fv(13)2 258 y Fp(13a)89 b Fo(h)p Fn(usage)16
b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)841 b Fp(\(9c\))22
b Fm(/)5 b Fp(12l)23 b(13c)5 b Fm(.)187 307 y Fr(")87
b(-fieldnames)19 b(file)43 b(write)21 b(arrays)f(of)i(field)e(names)h
(on)h(file.[ch]",)145 359 y Fp(Uses)12 b Fl(field)e Fp(55)h(and)g
Fl(file)f Fp(359a.)0 451 y(13b)89 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)p Fo(\021)650
b Fp(\(20\))22 b Fm(/)6 b Fp(12m)22 b(13d)5 b Fm(.)187
500 y Fr("-fieldnames")19 b(:)i(fieldnamesbase)e(:=)j(get\(args\))145
552 y Fp(Uses)12 b Fl(fieldnames)o(bas)o(e)d Fp(18a.)4
644 y(13c)89 b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o
Fv(+)p Fo(\021)833 b Fp(\(9c\))22 b Fm(/)5 b Fp(13a)23
b(13e)5 b Fm(.)187 694 y Fr(")87 b(-foldemit)194 b(fold)21
b(constants)f(in)h(calls)g(to)g(emit)g(functions",)0
785 y Fp(13d)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)669 b Fp(\(20\))22 b Fm(/)5
b Fp(13b)23 b(13f)5 b Fm(.)187 835 y Fr("-foldemit")63
b(:)21 b(simplify_emits)e(:=)j(1)145 887 y Fp(Uses)12
b Fl(simplify_e)o(mit)o(s)d Fp(18a.)4 978 y(13e)89 b
Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)833
b Fp(\(9c\))22 b Fm(/)5 b Fp(13c)23 b(13g)5 b Fm(.)187
1028 y Fr(")87 b(-icon)282 b(generate)20 b(Icon)h(code)g(\(for)g
(wizards)f(only\)",)9 1119 y Fp(13f)89 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)p Fo(\021)660
b Fp(\(20\))22 b Fm(/)6 b Fp(13d)22 b(13h)5 b Fm(.)187
1169 y Fr("-icon")194 b(:)22 b({)g(Generate_Icon\(\);)579
1219 y(interface_extensio)o(n)d(:=)i(".bogus.icn";)e
(implementation_exte)o(nsion)f(:=)k(".icn")e(})145 1271
y Fp(Uses)f Fl(bogus)f Fp(116b,)f Fl(Generate_I)o(con)o
Fp(,)f Fl(implementat)o(io)o(n_e)o(xte)o(nsi)o(on)g Fp(18a,)187
1310 y(and)10 b Fl(interface_e)o(xte)o(nsi)o(on)e Fp(18a.)2
1401 y(13g)89 b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p
Fo(i)o Fv(+)p Fo(\021)841 b Fp(\(9c\))22 b Fm(/)5 b Fp(13e)23
b(13i)5 b Fm(.)187 1451 y Fr(")87 b(-impossible)150 b(force)21
b(errors)f(to)i(stop)f(with)g(stack)f(trace",)0 1542
y Fp(13h)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)677 b Fp(\(20\))23 b Fm(/)5
b Fp(13f)23 b(13j)5 b Fm(.)187 1592 y Fr("-impossible")19
b(:)i(error)g(:=)h(stop)f(:=)g(impossible)10 1684 y Fp(13i)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)830 b Fp(\(9c\))22 b Fm(/)6 b Fp(13g)22 b(13k)5
b Fm(.)187 1733 y Fr(")87 b(-indirect)20 b(name[:type])f(generated)h
(encoding)g(procs)h(called)g(indirect)f(through)g(name",)9
1825 y Fp(13j)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)670 b Fp(\(20\))22 b Fm(/)5
b Fp(13h)23 b(13l)5 b Fm(.)187 1875 y Fr("-indirect")63
b(:)21 b(get\(args\))f(?)579 1924 y({)i(indirectname)d(:=)i
(tab\(upto\(':'\))e(|)j(0\))623 1974 y(indirecttype)d(:=)i(if)h(=":")f
(then)g(tab\(0\))f(else)h(indirectname)579 2024 y(})145
2076 y Fp(Uses)12 b Fl(indirectna)o(me)c Fp(18a)j(and)g
Fl(indirectty)o(pe)d Fp(18a.)1 2167 y(13k)89 b Fo(h)p
Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)837
b Fp(\(9c\))22 b Fm(/)5 b Fp(13i)23 b(14b)5 b Fm(.)187
2217 y Fr(")87 b(-late-const)150 b(include)20 b(constants)g(in)i
(closure)e(functions)g(\(default\)",)10 2308 y Fp(13l)89
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)p Fo(\021)673 b Fp(\(20\))22 b Fm(/)5 b Fp(13j)23
b(14c)5 b Fm(.)187 2358 y Fr("-late-const")19 b(:)i(lateconst)f(:=)i(1)
145 2410 y Fp(Uses)12 b Fl(lateconst)d Fp(18a.)p eop
%%Page: 14 14
14 13 bop 129 141 a Fv(14)83 b Fr(main.nw)808 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-13 258 y Fp(14a)88 b Fo(h)p Fn(initialize)14
b(glob)n(als)h Fp(14a)p Fo(i)o(\021)852 b Fp(\(20\))22
b(15c)5 b Fm(.)171 307 y Fr(lateconst)20 b(:=)h(1)129
359 y Fp(Uses)12 b Fl(lateconst)d Fp(18a.)-15 449 y(14b)88
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)828 b Fp(\(9c\))22 b Fm(/)6 b Fp(13k)22 b(14d)5
b Fm(.)171 499 y Fr(")87 b(-late-none)172 b(include)21
b(*no*)g(constants)e(in)j(closure)e(functions",)-12 589
y Fp(14c)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)q Fo(\021)673 b Fp(\(20\))22 b Fm(/)5
b Fp(13l)23 b(14e)5 b Fm(.)171 638 y Fr("-late-none")19
b(:)j(lateconst)e(:=)h(latezero)f(:=)i(&null)129 690
y Fp(Uses)12 b Fl(lateconst)d Fp(18a)h(and)h Fl(latezero)e
Fp(18a.)-15 780 y(14d)88 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)836 b Fp(\(9c\))22 b Fm(/)6
b Fp(14b)22 b(14f)5 b Fm(.)171 830 y Fr(")87 b(-late-zero)172
b(include)21 b(zero)g(in)g(closure)f(functions",)-12
920 y Fp(14e)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)q Fo(\021)665 b Fp(\(20\))22 b Fm(/)6
b Fp(14c)22 b(14g)5 b Fm(.)171 969 y Fr("-late-zero")19
b(:)j(latezero)e(:=)h(1)129 1021 y Fp(Uses)12 b Fl(latezero)d
Fp(18a.)-7 1111 y(14f)89 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)827 b Fp(\(9c\))22 b Fm(/)6
b Fp(14d)22 b(14h)5 b Fm(.)171 1161 y Fr(")87 b(-lc-cons-names)d(use)21
b(all)h(lower)e(case)h(for)g(constructor)f(names",)129
1212 y Fp(Uses)12 b Fl(constructor)c Fp(159)j(and)f Fl(lc)h
Fp(396b.)-13 1302 y(14g)88 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n
(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)673 b Fp(\(20\))22
b Fm(/)5 b Fp(14e)23 b(14i)5 b Fm(.)171 1352 y Fr("-lc-cons-names")18
b(:)k(lowercons)e(:=)h(1)129 1403 y Fp(Uses)12 b Fl(lc)f
Fp(396b)f(and)h Fl(lowercons)e Fp(18a.)-15 1493 y(14h)88
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)845 b Fp(\(9c\))22 b Fm(/)5 b Fp(14f)23 b(14j)5
b Fm(.)171 1543 y Fr(")87 b(-lc-pat-names)106 b(map)21
b(pattern)g(names)f(to)i(lower)f(case)g(in)g(code",)129
1595 y Fp(Uses)12 b Fl(lc)f Fp(396b)f(and)h Fl(pattern)e
Fp(55.)-6 1684 y(14i)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)q Fo(\021)662 b Fp(\(20\))22 b Fm(/)6
b Fp(14g)22 b(14k)5 b Fm(.)171 1734 y Fr("-lc-pat-names")19
b(:)i(lc_pat_names)f(:=)h(1)129 1786 y Fp(Uses)12 b Fl(lc)f
Fp(396b)f(and)h Fl(lc_pat_name)o(s)e Fp(18a.)-7 1876
y(14j)89 b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o
Fv(+)p Fo(\021)837 b Fp(\(9c\))22 b Fm(/)6 b Fp(14h)22
b(14l)5 b Fm(.)171 1926 y Fr(")87 b(-ledger)238 b(tell)21
b(dot\(1\))g(to)g(use)g(ledger)g(paper)g(with)g(-dot",)-14
2015 y Fp(14k)88 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)q Fo(\021)659 b Fp(\(20\))22 b Fm(/)6
b Fp(14i)22 b(14m)5 b Fm(.)171 2065 y Fr("-ledger")107
b(:)22 b({ledger)e(:=)h(1;)h(pagesize)e(:=)h("11,17"})129
2117 y Fp(Uses)12 b Fl(pagesize)d Fp(374.)-6 2207 y(14l)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)838 b Fp(\(9c\))22 b Fm(/)6 b Fp(14j)22 b(15a)5
b Fm(.)171 2256 y Fr(")87 b(-matcher)20 b(file)108 b(transform)20
b(pattern-matching)f(statements)g(in)j(file",)129 2308
y Fp(Uses)12 b Fl(file)e Fp(359a)h(and)f Fl(pattern)g
Fp(55.)-25 2398 y(14m)88 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)q Fo(\021)660 b Fp(\(20\))22 b Fm(/)6
b Fp(14k)22 b(15b)5 b Fm(.)171 2448 y Fr("-matcher")85
b(:)22 b(matcher)e(:=)h(openfile\(get\(args\),)o("r"\))129
2499 y Fp(Uses)12 b Fl(openfile)d Fp(24.)p eop
%%Page: 15 15
15 14 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)808
b Fr(main.nw)82 b Fv(15)2 258 y Fp(15a)89 b Fo(h)p Fn(usage)16
b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)841 b Fp(\(9c\))22
b Fm(/)5 b Fp(14l)23 b(15e)5 b Fm(.)187 307 y Fr(")87
b(-max-decimal)19 b(n)87 b(values)21 b(larger)f(than)h(n)h(will)f(be)g
(printed)f(in)i(hex",)145 359 y Fp(Uses)12 b Fl(max)f
Fp(410.)0 451 y(15b)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)659 b Fp(\(20\))22 b Fm(/)6
b Fp(14m)22 b(15f)5 b Fm(.)187 500 y Fr("-max-decimal")19
b(:)i(max_decimal)f(:=)h(0)h(<=)f(get\(args\))f(|)601
550 y(error\("-max-decim)o(al)f(value)h(must)h(be)h(nonnegative)d
(integer"\))145 602 y Fp(Uses)12 b Fl(max)f Fp(410,)f
Fl(max_decimal)e Fp(15d,)i(and)h Fl(value)f Fp(136a.)4
694 y(15c)89 b Fo(h)p Fn(initialize)14 b(glob)n(als)h
Fp(14a)p Fo(i)o Fv(+)p Fo(\021)716 b Fp(\(20\))22 b Fm(/)6
b Fp(14a)22 b(18b)5 b Fm(.)187 743 y Fr(max_decimal)19
b(:=)j(2^31)f(-)g(1)145 795 y Fp(Uses)12 b Fl(max_decima)o(l)d
Fp(15d.)0 887 y(15d)89 b Fo(h)p Fn(*)15 b Fp(9b)p Fo(i)p
Fv(+)p Fo(\021)1096 b Fm(/)5 b Fp(11c)23 b(15i)5 b Fm(.)187
936 y Fr(global)20 b(max_decimal)145 988 y Fp(De\014nes:)187
1028 y Fl(max_decima)o(l)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(15)h
(and)g(326a.)4 1119 y(15e)89 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)831 b Fp(\(9c\))22 b Fm(/)6
b Fp(15a)22 b(15g)5 b Fm(.)187 1169 y Fr(")87 b(-m3)326
b(generate)20 b(Modula-3)g(code",)9 1260 y Fp(15f)89
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)p Fo(\021)660 b Fp(\(20\))22 b Fm(/)6 b Fp(15b)22
b(15h)5 b Fm(.)187 1310 y Fr("-m3")195 b(:)21 b({)h(Generate_M3\(\);)
579 1360 y(interface_extensio)o(n)d(:=)i(".i3";)g(implementation_ex)o
(tensi)o(on)e(:=)i(".m3")g(})145 1412 y Fp(Uses)12 b
Fl(Generate_M)o(3)d Fp(348,)h Fl(implementat)o(ion)o(_ex)o(ten)o(si)o
(on)e Fp(18a,)j(and)g Fl(interface)o(_ex)o(ten)o(sio)o(n)e
Fp(18a.)2 1503 y(15g)89 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)832 b Fp(\(9c\))22 b Fm(/)5
b Fp(15e)23 b(15k)5 b Fm(.)187 1553 y Fr(")87 b(-no-asm-ws)172
b(remove)21 b(whitespace)e(from)i(assembly)f(syntax",)0
1644 y Fp(15h)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)671 b Fp(\(20\))22 b Fm(/)5
b Fp(15f)23 b(16a)5 b Fm(.)187 1694 y Fr("-no-asm-ws")19
b(:)j(no_asm_ws)e(:=)h(1)145 1746 y Fp(Uses)12 b Fl(no_asm_ws)d
Fp(15i)h(15j.)10 1837 y(15i)89 b Fo(h)p Fn(*)15 b Fp(9b)p
Fo(i)p Fv(+)p Fo(\021)1091 b Fm(/)5 b Fp(15d)23 b(15j)5
b Fm(.)187 1887 y Fr(global)20 b(no_asm_ws)145 1939 y
Fp(De\014nes:)187 1978 y Fl(no_asm_ws)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unks)f(15h)g(and)h(20.)9 2070 y(15j)89 b Fo(h)p Fn(*)15
b Fp(9b)p Fo(i)p Fv(+)p Fo(\021)1101 b Fm(/)5 b Fp(15i)23
b(16f)5 b Fm(.)187 2119 y Fr(global)20 b(no_asm_ws)145
2171 y Fp(De\014nes:)187 2211 y Fl(no_asm_ws)p Fp(,)8
b(used)j(in)g(c)o(h)o(unks)f(15h)g(and)h(20.)1 2302 y(15k)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)829 b Fp(\(9c\))22 b Fm(/)6 b Fp(15g)22 b(16b)5
b Fm(.)187 2352 y Fr(")87 b(-nowarn)238 b(no)21 b(warnings",)145
2404 y Fp(Uses)12 b Fl(nowarn)e Fp(18a.)p eop
%%Page: 16 16
16 15 bop 129 141 a Fv(16)83 b Fr(main.nw)808 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-13 258 y Fp(16a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)663
b Fp(\(20\))22 b Fm(/)6 b Fp(15h)22 b(16c)5 b Fm(.)171
307 y Fr("-nowarn")20 b(:)h(nowarn)g(:=)g(1)129 359 y
Fp(Uses)12 b Fl(nowarn)e Fp(18a.)-15 451 y(16b)88 b Fo(h)p
Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p Fo(\021)828
b Fp(\(9c\))22 b Fm(/)6 b Fp(15k)22 b(16d)5 b Fm(.)171
500 y Fr(")87 b(-old-closures)106 b(use)21 b(the)h(old)f(closure)f
(technique",)-12 592 y Fp(16c)89 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)665
b Fp(\(20\))22 b Fm(/)6 b Fp(16a)22 b(16e)5 b Fm(.)171
642 y Fr("-old-closures")19 b(:)i(emit_closure_functi)o(ons)d(:=)k
(emit_original_clo)o(sure_)o(func)o(tions)129 694 y Fp(Uses)12
b Fl(emit_closur)o(e_f)o(un)o(cti)o(ons)c Fp(18a)j(and)f
Fl(emit_origin)o(al_)o(clo)o(sur)o(e_)o(fun)o(cti)o(ons)e
Fp(204b.)-15 785 y(16d)88 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)829 b Fp(\(9c\))22 b Fm(/)6
b Fp(16b)22 b(16g)5 b Fm(.)171 835 y Fr(")87 b(-postfix)216
b(use)21 b(postfix)g(assembly-languag)o(e)e(syntax",)129
887 y Fp(Uses)12 b Fl(postfix)d Fp(16f.)-12 978 y(16e)89
b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)o Fv(+)q Fo(\021)663 b Fp(\(20\))22 b Fm(/)6 b Fp(16c)22
b(16h)5 b Fm(.)171 1028 y Fr("-postfix")20 b(:)h(postfix)g(:=)g(1)129
1080 y Fp(Uses)12 b Fl(postfix)d Fp(16f.)-7 1171 y(16f)89
b Fo(h)p Fn(*)16 b Fp(9b)p Fo(i)o Fv(+)p Fo(\021)1100
b Fm(/)5 b Fp(15j)23 b(17f)5 b Fm(.)171 1221 y Fr(global)21
b(postfix)129 1273 y Fp(De\014nes:)171 1312 y Fl(postfix)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(16,)g(128a,)h(238a,)f(246,)g(and)h
(406b.)-13 1403 y(16g)88 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)837 b Fp(\(9c\))22 b Fm(/)6
b Fp(16d)22 b(16i)5 b Fm(.)171 1453 y Fr(")87 b(-token-closures)40
b(use)22 b(one)f(closure)f(per)h(token",)129 1505 y Fp(Uses)12
b Fl(token)e Fp(359a.)-15 1596 y(16h)88 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)q Fo(\021)665
b Fp(\(20\))22 b Fm(/)6 b Fp(16e)22 b(17a)5 b Fm(.)171
1646 y Fr("-token-closures")18 b(:)k(emit_closure_func)o(tion)o(s)d(:=)
i(emit_tokenized_closu)o(re_f)o(uncti)o(ons)129 1698
y Fp(Uses)12 b Fl(emit_closur)o(e_f)o(un)o(cti)o(ons)c
Fp(18a,)j Fl(emit_toke)o(niz)o(ed_)o(cl)o(osu)o(re_)o(fun)o(cti)o(on)o
(s)p Fp(,)e(and)h Fl(token)g Fp(359a.)-6 1789 y(16i)89
b Fo(h)p Fn(usage)16 b(lines)f Fp(9e)p Fo(i)o Fv(+)p
Fo(\021)829 b Fp(\(9c\))22 b Fm(/)6 b Fp(16g)22 b(17b)5
b Fm(.)171 1839 y Fr(")87 b(-test)f(pay)21 b(no)h(attention)e(to)h(the)
g(man)g(behind)g(the)g(curtain",)p eop
%%Page: 17 17
17 16 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)808
b Fr(main.nw)82 b Fv(17)2 258 y Fp(17a)89 b Fo(h)p Fn(c)n(ases)16
b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o Fv(+)p Fo(\021)664
b Fp(\(20\))22 b Fm(/)6 b Fp(16h)22 b(17c)5 b Fm(.)187
307 y Fr("-test")20 b(:)i({)187 357 y(write\("Uncomment)o(ed)d(",)i
(Cuncomment\("/*)e(foo)i(at)h(0)f(*/"\)\))187 407 y(######)86
b(pp)21 b(:=)g(PPnew\(&output\))187 457 y(######)86 b(t)21
b(:=)h(constype\("Outer")o(,)d(set\(\),)i(1,)g(1\))187
507 y(######)86 b(t2)21 b(:=)g(constype\("Inner",)e(set\(\),)h(1,)i
(1\))187 557 y(######)86 b(c)21 b(:=)h(constructor\("mkO)o(ut",)c
("mkOut",)i(["in"],)h(t,)g([epsilon\(\)],)f([table\(\)],)f(1\))187
606 y(######)86 b(c2)21 b(:=)g(constructor\("mkIn",)d("mkIn",)j
(["fish"],)f(t2,)h([epsilon\(\)],)e([table\(\)],)h(1\))187
656 y(######)86 b(t.members)20 b(:=)h([c])187 706 y(######)86
b(t2.members)19 b(:=)j([c2])187 756 y(######)86 b(b)21
b(:=)h(Ebinding_instanc)o(e\("xx)o(x",)d(t,)i(table\(\)\))187
806 y(######)42 b(y2)22 b(:=)f(Einstance_tagged\()o(Einst)o(ance_)o
(inpu)o(t\(b,)d(c,)k("in"\),)e(c2,)i(99\))187 855 y(######)86
b(PPxwrite\(pp,)19 b(ppexpimage\(y2\),)g(")i(=>$t$c)g(",)g("???",)g
("$b"\))187 905 y(######)86 b(pushtrace\("TEST")o(\))187
955 y(######)g(x2)21 b(:=)g(eliminate_instances_)o(f\(y2\))187
1005 y(######)42 b(#)i(x1)21 b(:=)g(eliminate_instances)o(_f\(y1)d(:=)j
(Einstance_input\(Eins)o(tance)o(_inp)o(ut\(b,)d(c,)k("in"\),)e(c2,)h
("fish"\)\))187 1055 y(######)86 b(poptrace\(\))187 1104
y(######)42 b(#)i(PPxwrite\(pp,)19 b(ppexpimage\(y1\),)g(")i(=>$t$c)g
(",)g(ppexpimage\(x1\),)e("$b"\))187 1154 y(######)86
b(PPxwrite\(pp,)19 b(ppexpimage\(y2\),)g(")i(=>$t$c)g(",)g
(ppexpimage\(x2\),)e("$b"\))187 1204 y(})145 1256 y Fp(Uses)c
Fl(constructor)d Fp(159,)i Fl(constype)e Fp(159,)i Fl(Cuncomment)e
Fp(332a,)h Fl(Ebinding_in)o(sta)o(nce)f Fp(81,)187 1295
y Fl(Einstance_)o(inp)o(ut)d Fp(81,)j Fl(Einstance_)o(ta)o(gge)o(d)e
Fp(81,)h Fl(eliminate_i)o(nst)o(anc)o(es_)o(f)e Fp(180,)j
Fl(epsilon)e Fp(62b,)187 1335 y(and)g Fl(ppexpimage)f
Fp(101d.)0 1426 y(17b)89 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)837 b Fp(\(9c\))22 b Fm(/)5
b Fp(16i)23 b(17d)5 b Fm(.)187 1476 y Fr(")87 b(-tryall)238
b(try)21 b(all)g(heuristics)f(on)h(every)g(field,)g(node)g(\(for)g
(debugging\)",)145 1528 y Fp(Uses)12 b Fl(field)e Fp(55,)h
Fl(node)f Fp(272,)h(and)f Fl(tryall)g Fp(18a.)4 1619
y(17c)89 b Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h
Fp(9d)p Fo(i)o Fv(+)p Fo(\021)666 b Fp(\(20\))22 b Fm(/)5
b Fp(17a)23 b(17e)5 b Fm(.)187 1669 y Fr("-tryall")107
b(:)21 b(tryall)g(:=)g(1)145 1721 y Fp(Uses)12 b Fl(tryall)e
Fp(18a.)0 1812 y(17d)89 b Fo(h)p Fn(usage)16 b(lines)f
Fp(9e)p Fo(i)o Fv(+)p Fo(\021)929 b Fp(\(9c\))22 b Fm(/)6
b Fp(17b)187 1862 y Fr(")87 b(-verbose)216 b(extra)21
b(warnings)f(&)i(informatory)d(messages",)145 1914 y
Fp(Uses)12 b Fl(verbose)d Fp(18a.)4 2005 y(17e)89 b Fo(h)p
Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p Fo(i)o
Fv(+)p Fo(\021)766 b Fp(\(20\))22 b Fm(/)5 b Fp(17c)187
2055 y Fr("-verbose")85 b(:)21 b(verbose)g(:=)g(info_msg)145
2107 y Fp(Uses)12 b Fl(info_msg)d Fp(17f)i(and)f Fl(verbose)g
Fp(18a.)9 2198 y(17f)89 b Fo(h)p Fn(*)15 b Fp(9b)p Fo(i)p
Fv(+)p Fo(\021)1093 b Fm(/)5 b Fp(16f)23 b(18a)5 b Fm(.)187
2248 y Fr(procedure)20 b(info_msg\(L[]\))230 2298 y(write)h(!)h
(\([&errout,)d(image\(filename\),)g(",)i(line)g(",)h(lineno,)e(":)h
(Info)g(--)h("])f(|||)g(L\))187 2348 y(end)145 2400 y
Fp(De\014nes:)187 2439 y Fl(info_msg)p Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(17e.)145 2478 y(Uses)i Fl(line)e Fp(359a.)p eop
%%Page: 18 18
18 17 bop 129 141 a Fv(18)83 b Fr(main.nw)808 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-13 258 y Fp(18a)88 b Fo(h)p Fn(*)16
b Fp(9b)p Fo(i)o Fv(+)p Fo(\021)1091 b Fm(/)6 b Fp(17f)22
b(19b)5 b Fm(.)171 307 y Fr(global)21 b(cdebug,)f(mdebug,)g(sdebug,)h
(hdebug,)f(tryall,)g(indirectname,)f(indirecttype)171
357 y(global)i(lc_pat_names,)e(nowarn,)h(emptyset,)g(emittername,)f
(pretty)171 407 y(global)i(lowercons,)e(pc_unit_bits,)g
(emit_unit_bits,)g(simplify_emits,)g(gen_counters)171
457 y(global)i(fieldnamesbase,)d(verbose,)i(version)171
507 y(global)h(interface_exten)o(sion,)d(implementation_ext)o(ensio)o
(n)171 557 y(global)j(emit_closure_fu)o(nctio)o(ns,)e(latezero,)g
(lateconst)171 606 y(global)i(asmgrammarfilen)o(ame,)d
(disassemblyfilename)129 658 y Fp(De\014nes:)171 698
y Fl(asmgrammar)o(fil)o(ena)o(me)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f
(10e,)g(18b,)h(and)f(20.)171 737 y Fl(cdebug)p Fp(,)f(used)i(in)g(c)o
(h)o(unks)f(11e,)g(308,)h(310,)f(314,)h(315a,)f(and)h(317.)171
777 y Fl(disassembl)o(yfi)o(len)o(ame)o Fp(,)e(used)h(in)h(c)o(h)o
(unks)f(12e,)h(18b,)f(and)h(20.)171 816 y Fl(emit_closu)o(re_)o(fun)o
(cti)o(on)o(s)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f(16,)h(19a,)g(and)f
(214a.)171 855 y Fl(emitternam)o(e)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f
(10g,)h(19a,)f(328c,)g(and)h(342b.)171 895 y Fl(emit_unit_)o(bit)o(s)p
Fp(,)e(used)h(in)h(c)o(h)o(unks)f(12i,)h(19a,)f(and)h(195.)171
934 y Fl(emptyset)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f(19a,)h(137b,)f
(and)g(369d.)171 974 y Fl(fieldnames)o(bas)o(e)p Fp(,)f(used)h(in)h(c)o
(h)o(unks)f(13b)h(and)f(20.)171 1013 y Fl(gen_counte)o(rs)p
Fp(,)e(used)j(in)g(c)o(h)o(unks)f(10m,)g(18b,)g(214a,)h(230{32,)e(and)i
(236a.)171 1053 y Fl(hdebug)p Fp(,)e(used)i(in)g(c)o(h)o(unks)f(11g,)g
(18b,)h(276,)f(and)h(280a.)171 1092 y Fl(implementa)o(tio)o(n_e)o(xte)o
(ns)o(ion)o Fp(,)e(used)i(in)g(c)o(h)o(unks)f(10i,)g(13f,)h(15f,)f
(19a,)h(229,)f(235a,)h(308,)f(and)h(356c.)171 1131 y
Fl(indirectna)o(me)p Fp(,)e(used)j(in)g(c)o(h)o(unks)f(13j,)h(213b,)f
(214a,)g(230{32,)f(234a,)i(236a,)f(245,)g(254,)h(308,)f(309,)212
1171 y(and)g(338b.)171 1210 y Fl(indirectty)o(pe)p Fp(,)d(used)j(in)g
(c)o(h)o(unks)f(13j,)g(230,)h(and)g(231.)171 1250 y Fl(interface_)o
(ext)o(ens)o(ion)o Fp(,)e(used)h(in)h(c)o(h)o(unks)f(10i,)h(13f,)g
(15f,)f(19a,)h(229,)f(235a,)g(308,)h(and)f(356c.)171
1289 y Fl(lateconst)p Fp(,)e(used)j(in)g(c)o(h)o(unks)f(13,)h(14,)g
(and)f(218.)171 1329 y Fl(latezero)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f
(14)h(and)g(222a.)171 1368 y Fl(lc_pat_nam)o(es)p Fp(,)d(used)j(in)g(c)
o(h)o(unks)f(14i,)g(18b,)h(and)g(274.)171 1408 y Fl(lowercons)p
Fp(,)d(used)j(in)g(c)o(h)o(unks)f(14g,)g(18b,)h(164b,)f(and)h(238a.)171
1447 y Fl(mdebug)p Fp(,)e(used)i(in)g(c)o(h)o(unks)f(11i,)h(168,)f
(173a,)g(260,)h(263,)f(270a,)g(and)h(301a.)171 1486 y
Fl(nowarn)p Fp(,)e(used)i(in)g(c)o(h)o(unks)f(15k)h(and)f(16a.)171
1526 y Fl(pc_unit_bi)o(ts)p Fp(,)e(used)j(in)g(c)o(h)o(unks)f(19a,)g
(34c,)h(64b,)f(and)h(302c.)171 1565 y Fl(pretty)p Fp(,)f(used)g(in)i(c)
o(h)o(unks)e(19a,)g(21a,)h(22b,)g(206b,)f(209a,)g(212d,)g(214a,)h(216,)
f(227b,)h(229,)f(230a,)h(232a,)212 1605 y(235a,)g(236a,)f(248,)g(250,)h
(309,)f(338a,)g(348,)h(and)f(356c.)171 1644 y Fl(sdebug)p
Fp(,)f(used)i(in)g(c)o(h)o(unks)f(12a,)g(18b,)h(274,)f(275a,)h(and)f
(277{79.)171 1684 y Fl(simplify_e)o(mit)o(s)p Fp(,)f(used)h(in)h(c)o(h)
o(unks)f(13d)h(and)f(196c.)171 1723 y Fl(tryall)p Fp(,)f(used)i(in)g(c)
o(h)o(unks)f(17,)h(18b,)f(and)h(276c.)171 1762 y Fl(verbose)p
Fp(,)f(used)i(in)g(c)o(h)o(unks)f(17,)h(19a,)g(20,)g(33c,)f(43c,)h
(59a,)g(160,)f(227a,)h(230a,)f(232a,)g(235a,)h(236a,)212
1802 y(253a,)f(308,)f(316a,)g(and)h(317.)171 1841 y Fl(version)p
Fp(,)e(used)i(in)g(c)o(h)o(unks)f(12l,)g(20,)h(and)g(384a.)-15
1933 y(18b)88 b Fo(h)p Fn(initialize)14 b(glob)n(als)h
Fp(14a)p Fo(i)o Fv(+)p Fo(\021)720 b Fp(\(20\))22 b Fm(/)6
b Fp(15c)22 b(19a)5 b Fm(.)171 1982 y Fr(dotfile)20 b(:=)i(ascii_dag)e
(:=)h(spec)g(:=)g(ascii_tree)f(:=)h(decoderout)f(:=)215
2032 y(fulltree)g(:=)h(sdebug)g(:=)g(hdebug)g(:=)g(encoderfilename)e
(:=)i(asmencoderfilenam)o(e)e(:=)215 2082 y(ledger)h(:=)h(tryall)g(:=)g
(asmgrammarfilename)d(:=)k(disassemblyfilena)o(me)215
2132 y(lc_pat_names)d(:=)i(alt)g(:=)h(matcher)e(:=)i(gen_counters)d(:=)
i(lowercons)f(:=)215 2182 y(&null)129 2234 y Fp(Uses)13
b Fl(asmgrammar)o(fil)o(ena)o(me)c Fp(18a,)i Fl(disassembly)o(fil)o
(ena)o(me)e Fp(18a,)i Fl(gen_counter)o(s)f Fp(18a,)h
Fl(hdebug)f Fp(18a,)171 2273 y Fl(lc_pat_nam)o(es)e Fp(18a,)j
Fl(lowercons)d Fp(18a,)j Fl(sdebug)f Fp(18a,)g(and)h
Fl(tryall)e Fp(18a.)p eop
%%Page: 19 19
19 18 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)808
b Fr(main.nw)82 b Fv(19)2 258 y Fp(19a)89 b Fo(h)p Fn(initialize)14
b(glob)n(als)h Fp(14a)p Fo(i)o Fv(+)p Fo(\021)718 b Fp(\(20\))22
b Fm(/)6 b Fp(18b)22 b(19c)5 b Fm(.)187 307 y Fr(emittername)19
b(:=)j("emitm")187 357 y(emptyset)e(:=)h(set\(\))187
407 y(verbose)f(:=)i(nop)187 457 y(filename)e(:=)h("-")187
507 y(pagesize)f(:=)h("8.5,11")187 557 y(fetchtab)f(:=)h(table\(\))187
606 y(pc_unit_bits)e(:=)i(8)187 656 y(emit_unit_bits)e(:=)i(8)187
706 y(fresh_variables)d(:=)k(set\(\))187 756 y(pretty)e(:=)i(prettyC)
187 806 y(interface_extens)o(ion)d(:=)i(".h")187 855
y(implementation_e)o(xtens)o(ion)e(:=)i(".c")187 905
y(debug)g(:=)g(debugs)f(:=)i(nop)187 955 y(emit_closure_fun)o(ction)o
(s)d(:=)i(emit_optimized_clos)o(ure_f)o(uncti)o(ons)145
1007 y Fp(Uses)c Fl(debug)e Fp(376a,)g Fl(debugs)g Fp(376a,)g
Fl(emit_closu)o(re)o(_fu)o(nct)o(ion)o(s)f Fp(18a,)h
Fl(emitm)g Fp(392a,)187 1046 y Fl(emit_optim)o(ize)o(d_)o(clo)o(sur)o
(e_f)o(unc)o(ti)o(ons)10 b Fp(214c,)j Fl(emitterna)o(me)e
Fp(18a,)h Fl(emit_unit_b)o(its)e Fp(18a,)187 1086 y Fl(emptyset)g
Fp(18a,)h Fl(fetchtab)f Fp(295a,)h Fl(fresh_var)o(iab)o(les)e
Fp(155b,)i Fl(implementa)o(tio)o(n_e)o(xt)o(ens)o(ion)e
Fp(18a,)187 1125 y Fl(interface_)o(ext)o(en)o(sio)o(n)i
Fp(18a,)h Fl(nop)g Fp(376a,)g Fl(pagesize)f Fp(374,)h
Fl(pc_unit_bit)o(s)e Fp(18a,)j Fl(pretty)e Fp(18a,)187
1165 y Fl(prettyC)e Fp(325,)i(and)f Fl(verbose)f Fp(18a.)208
1235 y Fv(It's)h(a)h(hac)o(k,)g(but)f(I)h(use)h(the)f(global)e(v)n
(ariable)h Fr(emitterstyle)e Fv(to)i(determine)h(whether)145
1285 y(co)q(de)19 b(for)e Fr(Semit)g Fv(and)g Fr(Stoken)f
Fv(should)i(use)g(a)g Fn(dir)n(e)n(ct)e Fv(call)h(to)h(the)g(emitter)f
(named)g(b)o(y)145 1335 y Fr(emittername)p Fv(,)11 b(or)j(whether)h(it)
f(should)g(use)g(a)g(st)o(yle)g(appropriate)g(to)g(a)f
Fn(closur)n(e)p Fv(.)0 1397 y Fp(19b)89 b Fo(h)p Fn(*)15
b Fp(9b)p Fo(i)p Fv(+)p Fo(\021)1084 b Fm(/)6 b Fp(18a)22
b(19d)5 b Fm(.)187 1447 y Fr(global)20 b(emitterstyle)g(#)h(closure)g
(or)g(direct,)f(controls)g(emission)145 1499 y Fp(De\014nes:)187
1538 y Fl(emittersty)o(le)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(19c,)g
(209a,)g(227b,)g(328b,)g(and)h(329a.)4 1621 y(19c)89
b Fo(h)p Fn(initialize)14 b(glob)n(als)h Fp(14a)p Fo(i)o
Fv(+)p Fo(\021)720 b Fp(\(20\))22 b Fm(/)5 b Fp(19a)23
b(19e)5 b Fm(.)187 1671 y Fr(emitterstyle)19 b(:=)i("direct")145
1723 y Fp(Uses)12 b Fl(emittersty)o(le)c Fp(19b.)208
1794 y Fv(Used)16 b(to)f(mak)o(e)g(sure)h(the)g(program)e(coun)o(ter)j
(is)e(unique,)h(so)f(that)h Fr(pc)21 b(-)h(pc)15 b Fv(is)h(zero)145
1843 y(alw)o(a)o(ys.)0 1906 y Fp(19d)89 b Fo(h)p Fn(*)15
b Fp(9b)p Fo(i)p Fv(+)p Fo(\021)1102 b Fm(/)5 b Fp(19b)23
b(20)5 b Fm(.)187 1955 y Fr(global)20 b(the_global_pc)145
2007 y Fp(De\014nes:)187 2047 y Fl(the_global)o(_pc)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(19e,)h(78a,)f(89c,)h(193a,)f(209a,)
g(227a,)g(264,)h(and)f(270a.)4 2130 y(19e)89 b Fo(h)p
Fn(initialize)14 b(glob)n(als)h Fp(14a)p Fo(i)o Fv(+)p
Fo(\021)820 b Fp(\(20\))22 b Fm(/)5 b Fp(19c)187 2180
y Fr(the_global_pc)19 b(:=)i(Epc\(\))145 2231 y Fp(Uses)12
b Fl(Epc)f Fp(81)g(and)f Fl(the_global_)o(pc)e Fp(19d.)p
eop
%%Page: 20 20
20 19 bop 129 141 a Fv(20)83 b Fr(main.nw)808 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(I)h(ha)o(v)o(e)f(to)h(split)g(up)g
Fr(main)p Fv(,)e(otherwise)j(I)f(get)g(to)q(o)g(man)o(y)e
(de\014nitions)i(whic)o(h)g(leads)g(to)129 307 y(a)g(line)f(more)g
(than)h(3000)f(c)o(haracters)j(wide,)d(and)h(T)950 316
y(E)973 307 y(X)g(dies.)4 370 y Fp(20)89 b Fo(h)p Fn(*)16
b Fp(9b)p Fo(i)o Fv(+)p Fo(\021)1082 b Fm(/)6 b Fp(19d)22
b(21b)5 b Fm(.)171 420 y Fr(global)21 b(command_line,)e(header_lines)
171 469 y(record)i(Gcomment\(s\))171 569 y(procedure)f(main\(args\))258
619 y Fo(h)p Fn(initialize)14 b(glob)n(als)h Fp(14a)p
Fo(i)258 669 y Fr(version)20 b(:=)i Fo(h)p Fn(version)15
b(string)f Fp(9a)p Fo(i)258 768 y Fr(command_line)19
b(:=)j("tools")258 818 y(every)f(command_line)e(||:=)i(")h(")f(||)h
(!args)258 868 y(header_lines)d(:=)j([)302 918 y(Gcomment\("Genera)o
(ted)d(by)i(the)g(New)g(Jersey)g(Machine-Code)e(Toolkit,)h(version)h(")
g(||version\),)302 967 y(Gcomment\("comman)o(d)e(line:)i(")g(||)h
(command_line\)])258 1067 y(Generate_C\(\))172 b(#)22
b(default)258 1117 y(while)f(args[1][1:2])e(==)j("-")f(&)g(*args[1])f
(>)i(1)g(do)345 1167 y(case)f(a)h(:=)f(get\(args\))f(of)i({)432
1217 y Fo(h)p Fn(c)n(ases)16 b(for)e(ar)n(guments)h Fp(9d)p
Fo(i)432 1266 y Fr(default)86 b(:)22 b(usage\(\))324
1316 y(})258 1416 y(verbose\("NJ)e(Machine-Code)f(Toolkit,)h(version)g
(",)i(version\))258 1515 y(init_parser\(\))258 1565 y(init_tests\(\))
172 b(#)22 b(see)f(code.nw)258 1665 y(if)h(/quiet)e(then)h
(write\(&errout,)e("Parsing..."\))258 1715 y(if)j(*args)e(>)i(0)f(then)
345 1764 y(every)g(consume\(openfile\(f)o(ilena)o(me)e(:=)i
(!args,"r"\)\))258 1814 y(else)345 1864 y(consume\(&input\))258
1964 y(if)h(/quiet)e(then)h(write\(&errout,)e("Done)i(parsing."\))258
2063 y(if)h(\\no_asm_ws)d(then)i(every)g(strip_asm_whitesp)o(ace\(k)o
(ept_c)o(onstr)o(uctor)o(s\(\)\))258 2113 y(emit_encoding\(\\enc)o
(oderf)o(ilena)o(me\))258 2163 y(emit_assembly\(\\asm)o(encod)o(erfil)o
(ename)o(\))258 2213 y(emit_asm_grammar\(\\)o(asmgr)o(ammar)o(filen)o
(ame\))258 2263 y(emit_disassembler\()o(\\disa)o(ssemb)o(lyfil)o(enam)o
(e\))258 2312 y(emit_fieldnames\(\\f)o(ieldn)o(amesb)o(ase\))258
2362 y(emit_checker\(\\chec)o(kerfi)o(lenam)o(e\))258
2412 y(if)h(\\ledger)e(then)h({)g Fo(h)p Fn(write)14
b(PostScript)h(for)f(le)n(dger)g(p)n(ap)n(er)h Fp(22a)p
Fo(i)21 b Fr(})p eop
%%Page: 21 21
21 20 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)808
b Fr(main.nw)82 b Fv(21)274 258 y Fr(outspec\(\\spec\))274
307 y(if)21 b(\\matcher)f(then)h({)p Fo(h)p Fn(hand)r(le)16
b(matching)f(statements)g Fp(21a)p Fo(i)o Fr(})187 357
y(end)145 409 y Fp(De\014nes:)187 449 y Fl(Gcomment)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(86c,)h(93a,)f(110a,)g(119a,)g
(125b,)g(334c,)h(and)f(346a.)187 488 y Fl(header_lin)o(es)p
Fp(,)e(used)j(in)g(c)o(h)o(unks)f(230a,)g(232a,)g(and)h(236a.)187
527 y Fl(main)p Fp(,)f(used)g(in)i(c)o(h)o(unks)d(305a,)i(307,)f(and)h
(322.)145 567 y(Uses)18 b Fl(asmgrammar)o(fi)o(len)o(ame)c
Fp(18a,)i Fl(consume)f Fp(21c,)h Fl(disassemblyf)o(il)o(ena)o(me)e
Fp(18a,)187 606 y Fl(emit_asm_g)o(ram)o(ma)o(r)c Fp(253a,)h
Fl(emit_assemb)o(ly)e Fp(235a,)j Fl(emit_chec)o(ker)d
Fp(308,)j Fl(emit_disas)o(sem)o(ble)o(r)p Fp(,)187 646
y Fl(emit_encod)o(ing)e Fp(229,)i Fl(emit_fieldn)o(am)o(es)e
Fp(356c,)i Fl(fieldnamesb)o(ase)e Fp(18a,)i Fl(Generate_C)e
Fp(338a,)187 685 y Fl(init_parse)o(r)g Fp(32b,)i Fl(init_tests)e
Fp(349b,)i Fl(input)g Fp(46a,)g Fl(kept_const)o(ruc)o(tor)o(s)e
Fp(33d,)i Fl(line)g Fp(359a,)187 725 y Fl(no_asm_ws)e
Fp(15i)i(15j,)g Fl(openfile)f Fp(24,)h Fl(outspec)f Fp(367,)h
Fl(strip_asm_w)o(hi)o(tes)o(pac)o(e)e Fp(258,)i Fl(usage)g
Fp(9c,)187 764 y Fl(verbose)d Fp(18a,)i(and)f Fl(version)f
Fp(18a.)2 847 y(21a)89 b Fo(h)p Fn(hand)r(le)16 b(matching)f
(statements)g Fp(21a)p Fo(i)o(\021)733 b Fp(\(20\))187
897 y Fr(codelex\(matcher\))187 947 y(P_CodeFile\(\))187
997 y Fo(h)p Fn(if)14 b(tokens)i(ar)n(e)e(left)g(over,)h(c)n(omplain)g
Fp(21d)p Fo(i)187 1046 y Fr(x)21 b(:=)h(super_simplify\(g)o(enhea)o
(der\(c)o(odehe)o(ader\))o(\))187 1096 y(PPxwrite\(PPnew\(\\)o(decod)o
(erout)o(\),)d(pretty\(x\)\))187 1146 y(every)i(resolve_case_pa)o
(ttern)o(s\(!ma)o(tchin)o(g_stm)o(ts\))187 1196 y(every)g(t)g(:=)h
(tree\(cs)e(:=)h(!matching_stmts\))e(do)i({)h Fo(h)p
Fn(manipulate)15 b(de)n(cision)g(tr)n(e)n(e)f Fr(t)h
Fp(22b)p Fo(i)21 b Fr(})145 1248 y Fp(Uses)13 b Fl(codeheader)d
Fp(50c,)i Fl(codelex)f Fp(365a,)g Fl(genheader)f Fp(294d,)i
Fl(matching_)o(stm)o(ts)e Fp(50c,)i Fl(pretty)f Fp(18a,)187
1287 y Fl(resolve_ca)o(se_)o(pa)o(tte)o(rns)d Fp(259,)j
Fl(super_sim)o(pli)o(fy)d Fp(92c,)j(and)f Fl(tree)h Fp(274.)0
1378 y(21b)89 b Fo(h)p Fn(*)15 b Fp(9b)p Fo(i)p Fv(+)p
Fo(\021)1106 b Fm(/)5 b Fp(20)23 b(21c)5 b Fm(.)187 1428
y Fr(global)20 b(showpnf)145 1480 y Fp(De\014nes:)187
1520 y Fl(showpnf)p Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(75.)4
1611 y(21c)89 b Fo(h)p Fn(*)15 b Fp(9b)p Fo(i)p Fv(+)p
Fo(\021)1086 b Fm(/)6 b Fp(21b)22 b(22c)5 b Fm(.)187
1661 y Fr(procedure)20 b(consume\(input\))274 1711 y(lex\(input\))274
1760 y(P_Spec\(\))274 1810 y Fo(h)p Fn(if)14 b(tokens)i(ar)n(e)e(left)g
(over,)h(c)n(omplain)g Fp(21d)p Fo(i)274 1860 y Fr(return)187
1910 y(end)145 1962 y Fp(De\014nes:)187 2001 y Fl(consume)p
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(20.)145 2041 y(Uses)i
Fl(input)e Fp(46a.)0 2132 y(21d)89 b Fo(h)p Fn(if)15
b(tokens)g(ar)n(e)g(left)f(over,)g(c)n(omplain)h Fp(21d)p
Fo(i)o(\021)660 b Fp(\(21\))187 2182 y Fr(while)21 b(\(token)f(~==)h
(EOF\))g(do)h({)274 2231 y(error\("Leftover)d(token)h(",)i(token,)e(")i
(=)g(",)f(image\(tval\)\))274 2281 y(lex\(\))187 2331
y(})145 2383 y Fp(Uses)12 b Fl(EOF)f Fp(359b,)f Fl(token)g
Fp(359a,)g(and)g Fl(tval)h Fp(359a.)p eop
%%Page: 22 22
22 21 bop 129 141 a Fv(22)83 b Fr(main.nw)808 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-13 258 y Fp(22a)88 b Fo(h)p Fn(write)14
b(PostScript)h(for)f(le)n(dger)g(p)n(ap)n(er)h Fp(22a)p
Fo(i)o(\021)648 b Fp(\(20\))171 307 y Fr(write\(\\dotfile,"\045)o(!)63
b(PostScript"\))171 357 y(write\(\\dotfile,"/)o(setpa)o(pertr)o(aybyn)o
(ame)19 b({"\))171 407 y(write\(\\dotfile,")40 b({)22
b(/trayname)e(exch)h(def)g(statusdict)f(trayname)g(known)h({"\))171
457 y(write\(\\dotfile,")84 b(statusdict)20 b(trayname)g(get)h(exec)g
(})g(if})h(stopped"\))171 507 y(write\(\\dotfile,")84
b({)21 b(handleerror)f(})i(if}bind)e(def"\))171 557 y
(write\(\\dotfile,"/)o(ledge)o(rtray)e(setpapertraybyname)o("\))-15
648 y Fp(22b)88 b Fo(h)p Fn(manipulate)16 b(de)n(cision)f(tr)n(e)n(e)f
Fr(t)h Fp(22b)p Fo(i)o(\021)742 b Fp(\(21a\))171 698
y Fr(checktree\(t,)19 b(cs\))171 747 y(outtree\(\\ascii_tr)o(ee,)g(t\))
171 797 y(if)i(\\dotfile)f(|)i(\\ascii_dag)e(|)h(\\decoderout)f(|)h
(\\alt)g(then)g({)258 847 y(d)h(:=)f(tree2dag\(t\))258
897 y(outtree\(\\ascii_dag)o(,)e(d\))258 947 y(dotouttree\(\\dotfil)o
(e,)g(d\))258 997 y(PPxwrite\(PPnew\(\\de)o(coder)o(out\),)f
(pretty\(super_simpl)o(ify\(g)o(encas)o(e\(cs,)g(d\)\)\)\))258
1046 y(printalternates\(\\a)o(lt,)h(d\))258 1096 y(write\(\\alt,"\\n",)
g(repl\("=",)h(50\)\))171 1146 y(})129 1198 y Fp(Uses)15
b Fl(checktree)d Fp(284a,)h Fl(dotouttree)e Fp(374,)j
Fl(gencase)e Fp(295b,)h Fl(outtree)g Fp(373b,)g Fl(pretty)f
Fp(18a,)171 1237 y Fl(printalter)o(nat)o(es)c Fp(23a,)j
Fl(super_simp)o(lif)o(y)e Fp(92c,)h(and)h Fl(tree2dag)e
Fp(290b.)-12 1329 y(22c)89 b Fo(h)p Fn(*)16 b Fp(9b)p
Fo(i)o Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(21c)22 b(23a)5
b Fm(.)171 1378 y Fr(record)21 b(alternator\(cons)o(train)o(ts,)e
(thennode,)g(elsenode\))171 1478 y(procedure)h(alternates\(n\))258
1528 y(local)h(alt)258 1578 y(if)h(*n.children)d(=)j(2)f(then)g({)345
1628 y(every)g(i)h(:=)f(1)h(to)f(2)h(do)432 1677 y(if)g(alt)f(:=)g
(alternates\(n.childr)o(en[i])o(.node)o(\))e(&)498 1727
y(n.children[3-i].n)o(ode)g(===)i(alt.elsenode)e(then)585
1777 y(suspend)h(alternator\(alt.cons)o(train)o(ts|||)672
1827 y([constraint\(n.fiel)o(d,)f(n.children[i].lo,)f
(n.children[i].hi\)])o(,)672 1877 y(alt.thennode,)h(alt.elsenode\))345
1926 y(every)i(i)h(:=)f(1)h(to)f(2)h(do)432 1976 y(suspend)f
(alternator\()672 2026 y([constraint\(n.fiel)o(d,)e(n.children[i].lo,)f
(n.children[i].hi\)])o(,)672 2076 y(n.children[i].node)o(,)h
(n.children[3-i].no)o(de\))258 2126 y(})171 2175 y(end)129
2227 y Fp(De\014nes:)171 2267 y Fl(alternates)o Fp(,)9
b(used)i(in)g(c)o(h)o(unks)f(23a)g(and)h(374.)129 2306
y(Uses)h Fl(constraint)c Fp(55,)j Fl(constraints)d Fp(136a,)i
Fl(field)g Fp(55,)h(and)g Fl(node)f Fp(272.)p eop
%%Page: 23 23
23 22 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)808
b Fr(main.nw)82 b Fv(23)2 258 y Fp(23a)89 b Fo(h)p Fn(*)15
b Fp(9b)p Fo(i)p Fv(+)p Fo(\021)1086 b Fm(/)6 b Fp(22c)22
b(23b)5 b Fm(.)187 307 y Fr(procedure)20 b(printalternates\()o(file,)e
(n\))274 357 y(local)j(alt)274 407 y(if)g(alt)h(:=)f(alternates\(n\))e
(then)i({)361 457 y(write\(file\))361 507 y(writes\(file,)e("if)j
(\("\))361 557 y(l)g(:=)f(copy\(alt.constrain)o(ts\))361
606 y(while)g(genconstraint\(fil)o(e,)e(get\(l\)\))h(do)h
(writes\(file,)f(")h(&&)h("\))361 656 y(write\(file,)e("1\))h({"\))361
706 y(writes\(file,)e(")87 b(/*"\))361 756 y(writes\(file,)19
b(\\alt.thennode.cs.arm)o(s[1])o(.orig)o(inal.)o(patte)o(rn.na)o(me)g
(|)710 806 y("[")i(||)g(alt.thennode.cs.arm)o(s[1].)o(origi)o(nal.l)o
(ine)e(||)i("]"\))361 855 y(write\(file,)f(")h(*/"\))361
905 y(write\(file,)f("})h(else)g({"\))361 955 y(writes\(file,)e(")87
b(/*"\))361 1005 y(writes\(file,)19 b(\\alt.elsenode.cs.arm)o(s[1])o
(.orig)o(inal.)o(patte)o(rn.na)o(me)g(|)710 1055 y("[")i(||)g
(alt.elsenode.cs.arm)o(s[1].)o(origi)o(nal.l)o(ine)e(||)i("]"\))361
1104 y(write\(file,)f(")h(*/"\))361 1154 y(write\(file,)f("})h(else)g
(assert\(0\);"\))274 1204 y(})h(else)361 1254 y(every)f
(printalternates\(f)o(ile,)d(\(!n.children\).node\))187
1304 y(end)145 1356 y Fp(De\014nes:)187 1395 y Fl(printalter)o(nat)o
(es)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(22b.)145 1434
y(Uses)k Fl(alternates)d Fp(22c,)h Fl(constraints)f Fp(136a,)h
Fl(file)g Fp(359a,)h Fl(genconstra)o(int)d Fp(23b,)j
Fl(line)f Fp(359a,)187 1474 y Fl(node)e Fp(272,)h(and)f
Fl(pattern)f Fp(55.)0 1565 y(23b)89 b Fo(h)p Fn(*)15
b Fp(9b)p Fo(i)p Fv(+)p Fo(\021)1104 b Fm(/)5 b Fp(23a)23
b(24)5 b Fm(.)187 1615 y Fr(procedure)20 b(genconstraint\(fi)o(le,)f
(c\))274 1665 y(r)j(:=)f(sort\(c.lo)f(++)h(c.hi\))274
1715 y(writes\(file,)e("\(",)i(get\(r\),)g("<=",)f(c.field.name,)f
("<",)i(get\(r\)\))274 1764 y(while)g(writes\(file,)e(")j(||)f(",)g
(get\(r\),)g("<=",)f(c.field.name,)g("<",)h(get\(r\)\))274
1814 y(writes\(file,)e("\)"\))274 1864 y(return)187 1914
y(end)145 1966 y Fp(De\014nes:)187 2005 y Fl(genconstra)o(int)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(23a.)145 2045 y(Uses)i
Fl(field)e Fp(55)h(and)g Fl(file)f Fp(359a.)p eop
%%Page: 24 24
24 23 bop 129 141 a Fv(24)83 b Fr(main.nw)808 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y Fr(openfile)f Fv(mak)o(es)h(it)h(p)q
(ossible)h(to)f(op)q(en)g(standard)h(input)f(or)g(output)h(using)f(the)
h(\014le)129 307 y(name)e(\\)p Fr(-)p Fv(.")4 370 y Fp(24)89
b Fo(h)p Fn(*)16 b Fp(9b)p Fo(i)o Fv(+)p Fo(\021)1184
b Fm(/)6 b Fp(23b)171 420 y Fr(procedure)20 b(openfile\(name,)f(mode\))
258 469 y(/mode)i(:=)g("r")258 519 y(if)h(name)e(==)i("-")f(then)324
569 y(case)f(mode)h(of)h({)389 619 y("r")f(:)h(return)e(&input)389
669 y("w")h(:)h(return)e(&output)389 718 y(default)g(:)i(stop\("bogus)d
(file)i(mode:)g(",)g(mode\))324 768 y(})258 818 y(else)302
868 y(return)f(open\(name,)g(mode\))h(|)g(stop\("Can't)f(open)h(file)g
(",)g(name,)g(")h(for)f(",)g(mode\))171 918 y(end)129
970 y Fp(De\014nes:)171 1009 y Fl(openfile)p Fp(,)9 b(used)h(in)h(c)o
(h)o(unks)f(9{12,)g(14m,)h(20,)f(235a,)h(253a,)f(308,)g(and)h(309.)129
1048 y(Uses)h Fl(bogus)e Fp(116b,)g Fl(file)h Fp(359a,)f(and)g
Fl(input)g Fp(46a.)p eop
%%Page: 25 25
25 24 bop 145 569 a Fq(Chapter)32 b(2)145 777 y Fu(En)m(vironmen)m(ts)
37 b(and)145 901 y(en)m(vironmen)m(t)g(errors)145 1117
y Fv(An)18 b(en)o(vironmen)o(t)f(is)g(a)h(stac)o(k)g(of)f(sym)o(b)q(ol)
f(tables.)30 b(The)18 b(default)g(en)o(vironmen)o(t)e(is)i(the)145
1167 y(top-lev)o(el)f(en)o(vironmen)o(t,)h Fr(globals)p
Fv(.)27 b Fr(newscope)16 b Fv(creates)k(a)d(cop)o(y)h(of)f(an)g(en)o
(vironmen)o(t)145 1217 y(that)e(can)f(b)q(e)h(added)g(to)f(without)g
(ha)o(ving)g(a)g(side)h(e\013ect)h(on)e(the)h(original.)i
Fr(add_to_rho)145 1266 y Fv(do)q(es)e(the)f(adding.)208
1316 y Fr(lookup)21 b Fv(searc)o(hes)j(for)e(the)h(\014rst)g(binding)e
(of)h(string)g Fr(val)g Fv(in)g(the)h(en)o(vironmen)o(t.)145
1366 y Fr(lookuptype)16 b Fv(searc)o(hes)k(for)d Fr(val)g
Fv(in)g(the)i(en)o(vironmen)o(t)d(and)i(if)f(it)g(exists,)i(c)o(hec)o
(ks)g(that)145 1416 y(its)14 b(t)o(yp)q(e)h(is)e Fr(ty)p
Fv(.)2 1478 y Fp(25a)89 b Fo(h)p Fn(*)15 b Fp(25a)p Fo(i\021)1202
b Fp(26a)5 b Fm(.)187 1528 y Fr(procedure)20 b(is_defined\(ident)o(,)f
(rho\))230 1578 y(return)i(\()p Fo(h)p Fn(value)15 b(of)g
Fr(ident)f Fn(in)h Fr(rho)f Fp(25b)p Fo(i)o Fr(\))65
b(#)22 b(parens)e(handle)h(newline)f(from)h(-L)187 1628
y(end)187 1677 y(procedure)f(lookup\(ident,)f(rho\))230
1727 y(return)43 b(\()p Fo(h)p Fn(value)15 b(of)g Fr(ident)e
Fn(in)i Fr(rho)g Fp(25b)p Fo(i)o Fr(\))21 b(|)h(error\("`",)e(ident,)g
("')h(is)h(undefined"\))187 1777 y(end)187 1827 y(procedure)e
(lookuptype\(ident)o(,)f(ty,)i(rho\))230 1877 y(type\(v)g(:=)g
Fo(h)p Fn(value)16 b(of)e Fr(ident)g Fn(in)h Fr(rho)f
Fp(25b)p Fo(i)o Fr(\))22 b(==)f(ty)h(|)f(typeerror\(v,)f(ty,)h(ident,)f
(rho\))230 1926 y(return)h(v)187 1976 y(end)145 2028
y Fp(De\014nes:)187 2068 y Fl(is_defined)o Fp(,)9 b(used)h(in)i(c)o(h)o
(unks)d(76b,)i(175,)f(and)h(176.)187 2107 y Fl(lookup)p
Fp(,)e(used)i(in)g(c)o(h)o(unks)f(75,)h(76b,)f(163b,)g(175,)h(176,)f
(and)h(369a.)187 2146 y Fl(lookuptype)o Fp(,)e(used)h(in)i(c)o(h)o
(unks)d(37,)i(42a,)g(45d,)f(52d,)h(75,)f(and)h(311a.)145
2186 y(Uses)h Fl(typeerror)d Fp(28b.)0 2269 y(25b)89
b Fo(h)p Fn(value)16 b(of)e Fr(ident)g Fn(in)h Fr(rho)f
Fp(25b)p Fo(i)o(\021)822 b Fp(\(25a\))187 2319 y Fr({)21
b(/rho)g(:=)h(globals;)e(\\\(!rho\)[ident])f(})145 2371
y Fp(Uses)12 b Fl(globals)d Fp(32a.)841 2604 y Fv(25)p
eop
%%Page: 26 26
26 25 bop 129 141 a Fv(26)83 b Fr(environment.nw)654
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-13 258 y Fp(26a)88
b Fo(h)p Fn(*)16 b Fp(25a)p Fo(i)o Fv(+)p Fo(\021)1068
b Fm(/)6 b Fp(25a)22 b(26b)5 b Fm(.)171 307 y Fr(procedure)20
b(add_to_rho\(name,)e(val,)j(rho\))171 357 y(#write\("rho)e(",)j(*rho,)
f(")g(",)h(name,)e(")i(",)f(expimage\(val\)\))258 407
y(add_to_frame\(name,)d(val,)j(rho[1]\))g(|)g(impossible\("bogus)d
(environment"\))258 457 y(return)j(rho)171 507 y(end)171
606 y(procedure)f(add_to_frame\(name)o(,)f(val,)i(frame\))258
656 y(\(/frame[name])e(:=)j(val\))f(|)g(deferror\(name\))258
706 y(return)g(frame)171 756 y(end)129 808 y Fp(De\014nes:)171
847 y Fl(add_to_fra)o(me)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(162b.)171
887 y Fl(add_to_rho)o Fp(,)f(used)i(in)g(c)o(h)o(unks)f(56,)g(169,)h
(and)f(262a.)129 926 y(Uses)i Fl(bogus)e Fp(116b,)g Fl(deferror)f
Fp(28a,)i(and)f Fl(expimage)f Fp(101a.)-15 1017 y(26b)88
b Fo(h)p Fn(*)16 b Fp(25a)p Fo(i)o Fv(+)p Fo(\021)1072
b Fm(/)6 b Fp(26a)22 b(26c)5 b Fm(.)171 1067 y Fr(procedure)20
b(newscope\(rho\))258 1117 y(return)h(push\(copy\(rho\),)d(table\(\)\))
171 1167 y(end)129 1219 y Fp(De\014nes:)171 1258 y Fl(newscope)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(169)h(and)g(260.)192
1329 y Fv(Here)i(w)o(e)f(extend)h(an)f(en)o(vironmen)o(t)f(with)h(a)g
(new)g(frame.)k(I)c(tak)o(e)g(care)h(not)f(to)g(mo)q(dify)129
1378 y(the)j(en)o(vironmen)o(t.)-12 1441 y Fp(26c)89
b Fo(h)p Fn(*)16 b Fp(25a)p Fo(i)o Fv(+)p Fo(\021)1068
b Fm(/)6 b Fp(26b)22 b(27a)5 b Fm(.)171 1491 y Fr(procedure)20
b(extendscope\(rho,)e(frame\))215 1540 y(\(type\(frame\))h(==)i
("table")g(&)g(type\(rho\))f(==)h("list"\))g(|)g(impossible\("rho)e
(extension"\))215 1590 y(return)h(push\(copy\(rho\),)f(frame\))171
1640 y(end)129 1692 y Fp(De\014nes:)171 1731 y Fl(extendscop)o(e)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(162b.)p eop
%%Page: 27 27
27 26 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)656
b Fr(environment.nw)80 b Fv(27)2 258 y Fp(27a)89 b Fo(h)p
Fn(*)15 b Fp(25a)p Fo(i)p Fv(+)p Fo(\021)1074 b Fm(/)5
b Fp(26c)23 b(27c)5 b Fm(.)187 307 y Fr(procedure)20
b(envimage\(env,)f(envname\))274 357 y(local)i(hidden)274
407 y(/envname)f(:=)h("env")274 457 y(s)h(:=)f("")274
507 y Fo(h)p Fn(if)14 b Fr(env)h Fn(is)f(a)h(list,)f(c)n(onvert)h(to)g
(a)g(table)f(and)i(cr)n(e)n(ate)e(string)h Fr(hidden)e
Fp(27b)p Fo(i)274 557 y Fr(if)21 b(*env)g(=)h(0)f(then)g(s)h(||:=)f
("\\nEnvironment)e(")i(||)h(envname)e(||)i(")f(is)h(empty")274
606 y(every)f(p)g(:=)h(!sort\(env\))d(do)j(s)f(||:=)g
(pairimage\(envname,)d(p[1],)j(p[2]\))274 656 y(if)g(\\hidden)g(then)g
({)339 706 y(s)h(||:=)f(")43 b(--------)20 b(hidden)h(--------\\n")339
756 y(return)g(s)g(||)h(hidden)274 806 y(})g(else)339
855 y(return)f(s)187 905 y(end)145 957 y Fp(De\014nes:)187
997 y Fl(envimage)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(89a,)h(157,)f
(260,)h(265a,)f(270a,)g(and)g(377c.)145 1036 y(Uses)i
Fl(pairimage)d Fp(27c.)0 1127 y(27b)89 b Fo(h)p Fn(if)15
b Fr(env)f Fn(is)h(a)g(list,)e(c)n(onvert)i(to)g(a)g(table)g(and)g(cr)n
(e)n(ate)g(string)f Fr(hidden)g Fp(27b)p Fo(i)o(\021)154
b Fp(\(27a\))187 1177 y Fr(if)21 b(type\(env\))f(==)h("list")g(then)g
({)230 1227 y(t)h(:=)f(table\(\))230 1277 y(every)g(e)h(:=)f(!env)g(&)h
(ident)e(:=)i(key\(e\))e(do)274 1327 y(\(/t[ident])g(:=)h(e[ident]\))f
(|)274 1376 y({)i(/hidden)e(:=)h("")h(;)f(hidden)g(||:=)g
(pairimage\(envnam)o(e,)e(ident,)h(e[ident]\))g(})230
1426 y(env)i(:=)f(t)187 1476 y(})145 1528 y Fp(Uses)12
b Fl(pairimage)d Fp(27c.)4 1619 y(27c)89 b Fo(h)p Fn(*)15
b Fp(25a)p Fo(i)p Fv(+)p Fo(\021)1070 b Fm(/)6 b Fp(27a)22
b(28a)5 b Fm(.)187 1669 y Fr(procedure)20 b(pairimage\(envnam)o(e,)f
(ident,)h(v\))230 1719 y(return)h("\\n)43 b(")21 b(||)h(envname)e(||)i
("[")f(||)g(expimage\(ident\))e(||"]")i(||)g(")h(=)f(")h(||)274
1769 y(case)f(type\(v\))f(of)i({)187 1818 y(#)130 b("pattern")20
b(:)i("<pattern>)e(")h(||)h(patternimage\(v\))187 1868
y(#)130 b("field")64 b(:)22 b("<field>)e(")65 b(||)22
b(fieldimage\(v\))318 1918 y("string")41 b(:)22 b(image\(v\))318
1968 y(default)63 b(:)22 b(expimage\(v\))274 2018 y(})187
2068 y(end)145 2119 y Fp(De\014nes:)187 2159 y Fl(pairimage)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(27.)145 2198 y(Uses)i
Fl(expimage)d Fp(101a,)h Fl(field)g Fp(55,)h Fl(fieldimage)d
Fp(368b)i(368b,)g Fl(pattern)g Fp(55,)h(and)f Fl(patternimag)o(e)f
Fp(369d.)p eop
%%Page: 28 28
28 27 bop 129 141 a Fv(28)83 b Fr(environment.nw)654
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-13 258 y Fp(28a)88
b Fo(h)p Fn(*)16 b Fp(25a)p Fo(i)o Fv(+)p Fo(\021)1070
b Fm(/)6 b Fp(27c)22 b(28b)5 b Fm(.)171 307 y Fr(procedure)20
b(deferror\(t,)f(v\))258 357 y(error\(t,)h(")i(",)f(v,")g(is)h(already)
e(defined."\))171 407 y(end)129 459 y Fp(De\014nes:)171
498 y Fl(deferror)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(26a,)h(35,)g
(and)f(47d.)129 538 y(Uses)i Fl(defined)d Fp(136a.)-15
629 y(28b)88 b Fo(h)p Fn(*)16 b Fp(25a)p Fo(i)o Fv(+)p
Fo(\021)1088 b Fm(/)5 b Fp(28a)23 b(29)5 b Fm(.)171 679
y Fr(procedure)20 b(typeerror\(x,)f(typename,)h(ident,)h(rho\))258
729 y(error\("Expected)e(",)i(\(\\ident)g(||)g(")h(to)f(be)g(a)h(")f(|)
h(""\),)f(typename,)389 779 y(";)g(found)g(",)g(type\(x\),)g(")g(",)h
(expimage\(x\)\))171 828 y(end)129 880 y Fp(De\014nes:)171
920 y Fl(typeerror)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(25a,)g(46b,)h
(75,)g(76b,)f(and)h(311a.)129 959 y(Uses)h Fl(expimage)d
Fp(101a.)-12 1051 y(28c)89 b Fo(h)p Fn(name)16 b(of)f
Fr(rho)f Fp(28c)p Fo(i)o(\021)171 1100 y Fr(if)21 b(rho)h(===)f
(globals)f(then)h("globals")f(else)h("rho")129 1152 y
Fp(Uses)12 b Fl(globals)d Fp(32a.)p eop
%%Page: 29 29
29 28 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)656
b Fr(environment.nw)80 b Fv(29)145 258 y Fj(2.1)66 b(Injection)23
b(and)g(pro)t(jection)145 349 y Fv(Sometimes)14 b(an)h(iden)o(ti\014er)
g(could)h(ha)o(v)o(e)f(more)f(than)i(one)f(meaning,)f(dep)q(ending)i
(on)f(the)145 398 y(precise)20 b(con)o(text)f(in)f(whic)o(h)g(it)g(is)h
(used.)32 b(F)m(or)18 b(example,)g(the)h(name)e(of)h(a)g(constructor)
145 448 y(op)q(erand)g(denotes)g(an)e(instance)i(when)f(it)g(is)f(used)
i(in)f(an)f(application,)g(but)h(a)g(pattern)145 498
y(when)c(it)e(is)h(used)h(as)f(a)f(pattern)i(iden)o(ti\014er.)18
b(W)m(e)11 b(use)i(\\injection")e(to)h(de\014ne)h(the)f(meaning)145
548 y(of)19 b(suc)o(h)h(an)f(iden)o(ti\014er;)j(the)e(meaning)e(will)g
(b)q(e)i(\\pro)r(jected")g(when)g(the)g(iden)o(ti\014er)g(is)145
598 y(actually)f(lo)q(ok)o(ed)f(up.)35 b(Meanings)19
b(can)g(b)q(e)h(pro)r(jected)h(in)o(to)e(three)h(spaces:)31
b(patterns,)145 647 y(in)o(tegers,)13 b(and)f(constructor)h(op)q
(erands.)19 b(Pro)r(jection)12 b(nev)o(er)h(pro)q(duces)g(a)f(n)o(ull)f
(v)n(alue;)g(n)o(ull)145 697 y(v)n(alues)j(are)g(used)h(to)f(indicate)g
(inabilit)o(y)d(to)j(pro)r(ject,)g(and)g Fr(project)f
Fv(fails.)20 760 y Fp(29)89 b Fo(h)p Fn(*)15 b Fp(25a)p
Fo(i)p Fv(+)p Fo(\021)1168 b Fm(/)6 b Fp(28b)187 809
y Fr(record)20 b(inject\(pattern,)f(integer,)h(consop\))187
909 y(procedure)g(project\(x,)f(ty\))230 959 y(return)i(if)g(type\(x\))
g(==)g(ty)g(then)g(x)383 1009 y(else)g(if)g(type\(x\))g(==)g("inject")f
(then)h(case)g(ty)g(of)h({)427 1058 y("pattern")d(:)j(\\x.pattern)427
1108 y("integer")d(:)j(\\x.integer)427 1158 y("consop")41
b(:)22 b(\\x.consop)383 1208 y(})g(else)e(if)i(ty)f(==)h("integer")e
(then)h(case)f(type\(x\))h(of)g({)427 1258 y("pattern")e(|)j("input")e
(:)i(fail)427 1307 y(exptypes\(\))d(:)j(x)427 1357 y(default)85
b(:)470 1407 y(impossible\("Bug)19 b(in)i(toolkit---can't)e(use)i
(relocatable)f(name",)710 1457 y(")h(in)h(matching)e(statement)g(\(was)
h(`rethink)f(projection'\)"\))383 1507 y(})187 1557 y(end)145
1608 y Fp(De\014nes:)187 1648 y Fl(inject)p Fp(,)9 b(used)i(in)g(c)o(h)
o(unks)f(119b,)g(125c,)g(162b,)g(169,)h(170b,)f(260,)g(and)h(262a.)187
1687 y Fl(project)p Fp(,)e(used)h(in)i(c)o(h)o(unks)d(75,)i(76b,)g
(175,)f(and)h(176.)145 1727 y(Uses)h Fl(exptypes)d Fp(83b,)h
Fl(fail)h Fp(410,)f Fl(input)g Fp(46a,)h Fl(pattern)e
Fp(55,)i(and)f Fl(relocatable)e Fp(47a.)145 1789 y Fv(I)16
b(don't)e(really)h(kno)o(w)g(if)g(the)g(last)h(clause)f(here)i(is)e
(righ)o(t,)g(but)h(it)f(w)o(as)g(b)q(etter)i(than)e(sim-)145
1839 y(ply)g(allo)o(wing)f(an)o(ything)h(to)g(b)q(e)h(pro)r(jected)i
(in)o(to)d(an)g(in)o(teger,)h(whic)o(h)g(I)g(think)f(w)o(ould)g(b)q(e)
145 1889 y(un)o(w)o(arran)o(ted)g(optimism)o(.)p eop
%%Page: 30 30
30 29 bop 129 141 a Fv(30)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)p eop
%%Page: 31 31
31 30 bop 145 569 a Fq(Chapter)32 b(3)145 777 y Fu(Grammar)39
b(for)g(the)145 901 y(sp)s(eci\014cation)f(language)20
1122 y Fp(31)89 b Fo(h)p Fn(*)15 b Fp(31)p Fo(i\021)1218
b Fp(36b)5 b Fm(.)187 1172 y Fo(h)p Fn(terminal)14 b(symb)n(ols)h
Fp(54b)p Fo(i)187 1222 y Fr(\045\045)187 1272 y(#)21
b(EBNF)g(grammar)g(for)g(toolkit)f(specification)f(language)187
1322 y Fo(h)p Fn(gr)n(ammar)14 b Fp(34a)p Fo(i)187 1372
y Fr(\045\045)187 1421 y Fo(h)p Fn(toplevel)h Fp(32a)p
Fo(i)841 2604 y Fv(31)p eop
%%Page: 32 32
32 31 bop 129 141 a Fv(32)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(Step)h(one)g(is)g(to)g(initialize)e(the)j
(globals)-13 320 y Fp(32a)88 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o(\021)1001 b Fp(\(31\))22 b(32b)5 b
Fm(.)171 370 y Fr(global)21 b(symtab)238 b(#)22 b(table)e(of)i
(top-level)e(symbols)171 420 y(global)h(globals)216 b(#)22
b(top-level)e(environment)171 469 y(global)h(equivclasses)106
b(#)22 b(list)f(of)g(equivalence)e(classes)i(of)g(fields)171
519 y(global)g(constructors)106 b(#)22 b(table)e(mapping)h(constructor)
e(name)i(to)h(Stype)171 569 y(global)f(conslist)194 b(#)22
b(list)f(of)g(all)g(constructors)e(ever)i(defined)171
619 y(global)g(instructionctyp)o(e)e(#)j(the)f(type)g(of)g(instruction)
f(constructors)171 669 y(global)h(bit_zero_is_lsb)40
b(#)22 b(non-null)e(if)h(bits)g(are)g(numbered)f(with)h(0)h(==)f(least)
g(significant)171 718 y(global)g(vanishing_laten)o(t_pat)o(label)40
b(#)22 b(should)e(vanish)171 768 y(global)h(fieldname_liter)o(als,)d
(operands_and_ids,)h(warned_literals)f(#)k(find)f(conflicts)129
820 y Fp(De\014nes:)171 860 y Fl(bit_zero_i)o(s_l)o(sb)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(32b,)g(35c,)h(36a,)f(and)h(115b.)
171 899 y Fl(conslist)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f(32b,)h(33d,)f
(and)h(160.)171 938 y Fl(constructo)o(rs)p Fp(,)d(used)j(in)g(c)o(h)o
(unks)f(32b,)g(33d,)h(44a,)f(48b,)h(160,)f(165,)h(167,)f(183c,)g(190,)h
(202,)f(and)h(230b.)171 978 y Fl(equivclass)o(es)p Fp(,)d(used)j(in)g
(c)o(h)o(unks)f(32b)g(and)h(35a.)171 1017 y Fl(fieldname_)o(lit)o(era)o
(ls)p Fp(,)d(used)j(in)g(c)o(h)o(unks)f(32)h(and)f(33.)171
1057 y Fl(globals)p Fp(,)f(used)i(in)g(c)o(h)o(unks)f(25b,)g(28c,)h
(32b,)f(37a,)h(43a,)f(46b,)g(160,)h(and)g(260.)171 1096
y Fl(instructio)o(nct)o(ype)o Fp(,)e(used)i(in)h(c)o(h)o(unks)e(32b,)h
(44a,)g(166,)g(212e,)f(230{32,)g(234b,)g(236,)h(238,)g(245,)g(246,)212
1136 y(253b,)g(254,)f(309,)h(and)f(367.)171 1175 y Fl(operands_a)o(nd_)
o(ids)o Fp(,)f(used)h(in)i(c)o(h)o(unks)d(32)i(and)g(33.)171
1214 y Fl(symtab)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f(32b,)g(35,)g(39b,)
g(45{47,)g(50b,)g(115,)g(170b,)g(172b,)f(188b,)h(242,)g(247,)g(262a,)
212 1254 y(357a,)g(368c,)f(and)g(369c.)171 1293 y Fl(vanishing_)o(lat)o
(ent)o(_pa)o(tl)o(abe)o(l)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f(32b,)h
(94a,)f(100a,)g(117c,)g(121a,)h(178d,)f(and)g(180.)171
1333 y Fl(warned_lit)o(era)o(ls)p Fp(,)e(used)j(in)g(c)o(h)o(unks)f
(32b)g(and)h(33c.)129 1372 y(Uses)h Fl(constructor)c
Fp(159)j(and)f Fl(defined)g Fp(136a.)-15 1455 y(32b)88
b Fo(h)p Fn(toplevel)15 b Fp(32a)p Fo(i)o Fv(+)q Fo(\021)868
b Fp(\(31\))22 b Fm(/)6 b Fp(32a)22 b(33d)5 b Fm(.)171
1505 y Fr(procedure)20 b(init_parser\(\))258 1555 y(every)h(symtab)f(|)
i(constructors)d(:=)j(table\(\))258 1605 y(globals)e(:=)i([symtab])258
1654 y(every)f(unchecked_fields)d(|)k(guaranteed_fields)c(:=)k(set\(\))
258 1704 y(every)f(fieldname_literal)o(s)e(|)j(operands_and_id)o(s)d(|)
j(warned_literals)c(:=)k(set\(\))258 1754 y(every)f(conslist)f(|)i
(equivclasses)d(:=)i([])258 1804 y(instructionctype)e(:=)i
(constype\("\(anonym)o(ous)e(constructor)g(type\)",)i(set\(\)\))258
1854 y(bit_zero_is_lsb)e(:=)i(1)258 1904 y(vanishing_latent_p)o(atlab)o
(el)e(:=)i(latent_patlabel\(\))258 1953 y Fo(h)p Fn(initialization)14
b Fp(38d)p Fo(i)171 2003 y Fr(end)129 2055 y Fp(De\014nes:)171
2095 y Fl(init_parse)o(r)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(20.)129
2134 y(Uses)g Fl(bit_zero_i)o(s_l)o(sb)c Fp(32a,)j Fl(conslist)d
Fp(32a,)j Fl(construct)o(or)d Fp(159,)j Fl(construct)o(ors)d
Fp(32a,)i Fl(constype)f Fp(159,)171 2173 y Fl(equivclass)o(es)i
Fp(32a)i(367,)g Fl(fieldname_l)o(it)o(era)o(ls)e Fp(32a,)i
Fl(globals)f Fp(32a,)h Fl(guarantee)o(d_f)o(iel)o(ds)e
Fp(354f,)171 2213 y Fl(instructio)o(nct)o(ype)g Fp(32a,)j
Fl(latent_pat)o(lab)o(el)e Fp(55,)i Fl(operands_a)o(nd_)o(id)o(s)e
Fp(32a,)i Fl(symtab)f Fp(32a)h(367,)171 2252 y Fl(unchecked_)o(fie)o
(lds)c Fp(354f,)i Fl(vanishing_l)o(ate)o(nt_)o(pa)o(tla)o(bel)e
Fp(32a,)j(and)f Fl(warned_lite)o(ral)o(s)f Fp(32a.)p
eop
%%Page: 33 33
33 32 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(33)145 258 y(Because)16 b(of)e(the)g(strange)h
(w)o(a)o(y)f(w)o(e)g(allo)o(w)e(users)k(to)e(sp)q(ecify)g(\014eld-name)
f(literals)h(in)f(\014eld)145 307 y(bindings,)i(w)o(e)h(w)o(an)o(t)f
(to)g(mak)o(e)f(sure)j(there's)g(nev)o(er)f(a)f(clash)h(b)q(et)o(w)o
(een)h(the)f(names)e(used)145 357 y(in)g(\014eldinfo)f(statemen)o(ts)h
(and)g(the)g(names)f(used)i(in)e(op)q(erands)i(and)f(equations.)2
420 y Fp(33a)89 b Fo(h)p Fn(note)16 b(new)f(\014eld)g(name)g
Fr(ii1)f Fp(33a)p Fo(i)o(\021)778 b Fp(\(37c\))187 469
y Fr(if)21 b(member\(operands_an)o(d_ids)o(,)e(ii1\))i(then)g({)230
519 y Fo(h)p Fn(warn)15 b(ab)n(out)g(clash)g(in)g Fr(ii1)f
Fp(33c)p Fo(i)187 569 y Fr(})21 b(else)230 619 y(insert\(fieldname_li)o
(teral)o(s,)e(ii1\))145 671 y Fp(Uses)12 b Fl(fieldname_)o(lit)o(era)o
(ls)c Fp(32a)j(and)g Fl(operands_)o(and)o(_id)o(s)e Fp(32a.)0
754 y(33b)89 b Fo(h)p Fn(note)16 b(new)f(op)n(er)n(and)g(or)g(id)f
Fr(ii1)h Fp(33b)p Fo(i)o(\021)656 b Fp(\(45c)11 b(49c\))187
804 y Fr(if)21 b(member\(fieldname_l)o(itera)o(ls,)e(ii1\))i(then)g({)
230 853 y Fo(h)p Fn(warn)15 b(ab)n(out)g(clash)g(in)g
Fr(ii1)f Fp(33c)p Fo(i)187 903 y Fr(})21 b(else)230 953
y(insert\(operands_and)o(_ids,)d(ii1\))145 1005 y Fp(Uses)12
b Fl(fieldname_)o(lit)o(era)o(ls)c Fp(32a)j(and)g Fl(operands_)o(and)o
(_id)o(s)e Fp(32a.)4 1096 y(33c)89 b Fo(h)p Fn(warn)15
b(ab)n(out)g(clash)g(in)g Fr(ii1)f Fp(33c)p Fo(i)o(\021)805
b Fp(\(33\))187 1146 y Fr(every)21 b(\(if)g(not)g(member\(warned_lit)o
(erals)o(,)e(ii1\))i(then)g(warning)f(else)h(verbose\)\()230
1196 y(ii1)h(||)f(")h(is)f(used)g(as)g(a)h(field-name)e(literal)g(and)h
(an)g(operand)g(or)g(id...")g(|)230 1246 y(")44 b(the)21
b(literal)f(takes)h(priority)f(in)i(field)e(bindings")187
1295 y(\))187 1345 y(insert\(warned_li)o(teral)o(s,)f(ii1\))145
1397 y Fp(Uses)12 b Fl(field)e Fp(55,)h Fl(literal)e
Fp(45e,)i Fl(used)f Fp(136a,)g Fl(verbose)f Fp(18a,)i(and)f
Fl(warned_lite)o(ral)o(s)f Fp(32a.)208 1468 y Fr(conslist)f
Fv(con)o(tains)i(a)g(list)g(of)f(all)g(constructors)k(ev)o(er)e
(de\014ned,)g(ev)o(en)g(those)g(that)f(w)o(ere)145 1518
y(later)19 b(remo)o(v)o(ed)f(from)f(the)j Fr(constructors)c
Fv(table.)33 b(Clien)o(ts)19 b(that)g(use)h Fr(conslist)d
Fv(are)145 1567 y(therefore)i(obligated)e(to)g(c)o(hec)o(k)i(that)e
Fr(constructors[x.name)o(])i(===)i(x)c Fv(b)q(efore)i(using)145
1617 y(a)e(constructor)h Fr(x)f Fv(found)f(in)h Fr(conslist)p
Fv(.)25 b(Similar)14 b(c)o(hec)o(king)j(is)g(required)h(b)q(efore)g
(using)145 1667 y(the)j(mem)o(b)q(ers)d(of)i(a)f(constructor)j(t)o(yp)q
(e.)36 b(The)21 b(easy)f(w)o(a)o(y)f(to)h(do)g(this)g(is)f(to)h(use)h
(the)145 1717 y Fr(kept_constructors)14 b Fv(generator,)20
b(whic)o(h)d(pro)o(vides)h(the)g(retained)h(constructors)h(of)d(a)145
1767 y(giv)o(en)d(t)o(yp)q(e,)g(or)f(the)i(retained)f(un)o(t)o(yp)q(ed)
h(constructors)h(if)d(no)h(t)o(yp)q(e)g(is)g(giv)o(en.)0
1829 y Fp(33d)89 b Fo(h)p Fn(toplevel)15 b Fp(32a)p Fo(i)o
Fv(+)p Fo(\021)867 b Fp(\(31\))22 b Fm(/)6 b Fp(32b)22
b(35b)5 b Fm(.)187 1879 y Fr(procedure)20 b(kept_constructor)o(s\(con)o
(stype)o(\))230 1928 y(local)h(thelist)230 1978 y(thelist)g(:=)g
(\(\\constype\).member)o(s)e(|)j(conslist)230 2028 y(suspend)f(1\(c)g
(:=)g(!thelist,)f(constructors[c.nam)o(e])f(===)i(c\))187
2078 y(end)145 2130 y Fp(De\014nes:)187 2169 y Fl(kept_const)o(ruc)o
(to)o(rs)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(20,)h(109a,)g(132b,)f
(172a,)g(184a,)g(189b,)g(202b,)h(211a,)f(230{34,)228
2209 y(236,)h(250a,)f(253a,)g(308,)h(309,)f(311a,)g(313,)h(331e,)f
(344a,)g(and)h(367.)145 2248 y(Uses)h Fl(conslist)d Fp(32a,)h
Fl(constructor)o(s)f Fp(32a,)h(and)h Fl(constype)e Fp(159.)p
eop
%%Page: 34 34
34 33 bop 129 141 a Fv(34)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(Tw)o(o)g(parsers)j(are)e(generated)h
(from)d(this)i(grammar:)h(that)f(for)g(a)g(sp)q(eci\014cation,)g(and)
129 307 y(that)21 b(for)e(a)h(co)q(de)h(\014le)f(con)o(taining)f
(pattern-matc)o(hing)g(statemen)o(ts.)37 b(No)20 b(clien)o(t)g(ev)o(er)
129 357 y(uses)15 b Fr(Parsers)d Fv(directly;)i(they)g(use)g
Fr(P_Spec)e Fv(or)i Fr(P_CodeFile)p Fv(,)d(but)i(the)i(union)e(mak)o
(es)f(it)129 407 y(p)q(ossible)k(for)f(b)q(oth)h(parsers)h(to)e(handle)
g(end-of-\014le)g(prop)q(erly)m(.)23 b(The)16 b(silly)e(tok)o(ens)i(a)o
(v)o(oid)129 457 y(parsing)c(con\015icts.)18 b(\(Inciden)o(tally)m(,)11
b(the)h(lexer)g(for)g(a)f Fr(CodeFile)f Fv(starts)j(out)f(in)f(a)h
(di\013eren)o(t)129 507 y(state,)j(but)f(that)g(shouldn't)f(matter)g
(to)h(the)h(parser)g(generator.\))-13 569 y Fp(34a)88
b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o(\021)973
b Fp(\(31\))22 b(34b)5 b Fm(.)171 619 y Fr(Parsers)64
b(:)21 b("bogus)g(spec)g(marker")f(Spec)h(|)h("bogus)e(code)h(marker")g
(CodeFile;)129 671 y Fp(Uses)12 b Fl(bogus)e Fp(116b)g(and)h
Fl(Spec)f Fp(34b.)192 733 y Fv(The)k(parts)g(of)g(a)f(sp)q
(eci\014cation)i(ma)o(y)d(app)q(ear)i(in)g(an)o(y)f(order.)-15
795 y Fp(34b)88 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)845 b Fp(\(31\))22 b Fm(/)6 b Fp(34a)22
b(34c)5 b Fm(.)171 845 y Fr(Spec)130 b(:)21 b({)h(Fieldspec)e(|)i
(Patterns)e(|)h(Constructors)f(|)h(Placeholder)432 895
y(|)h(FetchSpec)e(|)i(PCSpec)64 b(|)21 b(RelocSpec)86
b(|)21 b(AsmSpec)432 945 y(|)h(BitSpec)432 994 y(})g(;)129
1046 y Fp(De\014nes:)171 1086 y Fl(Spec)p Fp(,)10 b(used)h(in)g(c)o(h)o
(unk)f(34a.)129 1125 y(Uses)i Fl(Fieldspec)d Fp(35a)h(and)h
Fl(Placeholde)o(r)e Fp(37a.)-12 1208 y(34c)89 b Fo(h)p
Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)841
b Fp(\(31\))22 b Fm(/)6 b Fp(34b)22 b(35a)5 b Fm(.)171
1258 y Fr(PCSpec)21 b(:)g("pc_unit_bits")e(INT)i(/*)h(if)f(ii2)g(>)h(0)
f(then)g(pc_unit_bits)f(:=)h(ii2)847 1308 y(else)g(error\("pc_unit_)o
(bits)d(must)j(be)h(positive"\))d(*/;)129 1360 y Fp(Uses)12
b Fl(INT)f Fp(54b)f(359b)h(and)f Fl(pc_unit_bit)o(s)f
Fp(18a.)p eop
%%Page: 35 35
35 34 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(35)145 258 y Fj(3.1)66 b(Fields)24
b(and)f(\014eld)g(information)145 349 y Fv(Fields)13
b(declared)h(in)e(the)h(same)f Fr(fields)f Fv(declaration)h(are)h(mem)o
(b)q(ers)f(of)g(the)h(same)f(equiv-)145 398 y(alence)i(class.)k(Fields)
13 b(in)f(the)i(same)e(equiv)n(alence)h(class)h(share)f(the)h(same)e
Fn(shap)n(e)p Fv(,)h(i.e.,)f(the)145 448 y(width)h(of)f(the)i(unit)e
(in)h(whic)o(h)f(they)i(are)f(de\014ned.)19 b(Constrain)o(ts)13
b(on)g(\014elds)g(with)f(di\013eren)o(t)145 498 y(classes)18
b(ma)o(y)c(not)i(b)q(e)g(com)o(bined)f(with)h Fr(&)p
Fv(,)g(ev)o(en)g(if)f(the)i(classes)g(ha)o(v)o(e)f(the)h(same)e(shap)q
(e.)145 548 y(Equiv)n(alence)10 b(classes)h(are)g(useful)e(for)h
(distinguishing)f(CISC)g(instruction)i(fragmen)o(ts)d(that)145
598 y(m)o(ust)13 b(b)q(e)i(com)o(bined)d(to)i(form)e(a)i(complete)f
(instruction.)208 647 y(In)o(ternally)m(,)h(the)i(to)q(olkit)e(uses)i
(little-endian)f(bit)g(n)o(um)o(b)q(ering|that)e(is,)i(bit)g(0)g(is)g
(al-)145 697 y(w)o(a)o(ys)f(the)g(least)g(signi\014can)o(t)g(bit.)2
763 y Fp(35a)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)845 b Fp(\(31\))22 b Fm(/)5 b Fp(34c)23
b(36a)5 b Fm(.)187 813 y Fr(Fieldspec)20 b(:)h("fields")f("of")h(Ident)
g("\(")g(INT)h("\)")448 863 y({)g(Ident)f(INT)g([":")g(INT)g(/*ii2*/])
42 b(/*)21 b(newfield\(ii1,)e(ii2,)i(\(\\ii3)g(|)h(ii2\)+1\))e(*/)h(})
448 912 y(/*)h(if)f(ii5)g(\045)h(8)f(~=)h(0)f(then)579
962 y(error\("element)e(size)i(",)g(ii5,)g(")h(is)f(not)g(a)h(multiple)
e(of)i(8)f(bits."\))514 1012 y Fo(h)p Fn(if)14 b(ne)n(e)n(de)n(d,)h
(\015ip)h(bit)e(numb)n(ering)h(of)g(\014elds)g Fr(ii7)f
Fn(using)i(size)e Fr(ii5)g Fp(35c)p Fo(i)514 1062 y Fr(\(/symtab[ii3])
19 b(:=)i(equivclass\(ii3,)e(ii7,)i(ii5\)\))g(|)732 1112
y(deferror\(type\(sy)o(mtab)o([ii3])o(\))e(||)i(")h(",)f
(image\(ii3\)\))514 1161 y(put\(equivclasses)o(,)e(symtab[ii3]\))514
1211 y(every)h(\(!ii7\).class)g(:=)h(symtab[ii3])f(*/)405
1261 y(;)145 1310 y Fp(De\014nes:)187 1350 y Fl(Fieldspec)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(34b,)g(37c,)h(and)f(38b.)145
1389 y(Uses)k Fl(deferror)d Fp(28a,)i Fl(equivclas)o(s)e
Fp(55,)i Fl(equivclas)o(ses)d Fp(32a)j(367,)f Fl(Ident)g
Fp(54c,)h Fl(INT)g Fp(54b)g(359b,)187 1429 y Fl(newfield)c
Fp(35b,)h(and)h Fl(symtab)e Fp(32a)i(367.)145 1494 y
Fv(W)m(e)h(no)o(w)h(p)q(ermit)e(one-in)o(teger)i(sp)q(eci\014cations)h
(of)e(one-bit)g(\014elds,)h(b)o(y)f(analogy)f(with)h(one-)145
1544 y(in)o(teger)j(sp)q(eci\014cations)g(of)e(one-bit)h(slices.)778
b Fk(\031Change)14 b(#40)0 1604 y Fp(35b)89 b Fo(h)p
Fn(toplevel)15 b Fp(32a)p Fo(i)o Fv(+)p Fo(\021)871 b
Fp(\(31\))22 b Fm(/)6 b Fp(33d)22 b(38c)5 b Fm(.)187
1654 y Fr(procedure)20 b(newfield\(name,)f(lo,)i(hi\))230
1704 y(return)g(\(/symtab[name])e(:=)i(field\(name,)f(lo,)h(hi\)\))g(|)
g(deferror\("Field",)e(image\(name\)\))187 1754 y(end)145
1803 y Fp(De\014nes:)187 1842 y Fl(newfield)p Fp(,)9
b(used)h(in)h(c)o(h)o(unk)f(35a.)145 1882 y(Uses)i Fl(deferror)d
Fp(28a,)h Fl(field)g Fp(55,)h(and)g Fl(symtab)e Fp(32a)i(367.)1606
1899 y Fk(\031Change)j(#26)208 1942 y Fv(T)m(o)i(n)o(um)o(b)q(er)g
(bits,)h(w)o(e)h(need)g(b)q(oth)f(to)g(c)o(hange)g(n)o(um)o(b)q(ering)f
(and)h(exc)o(hange.)28 b(I)17 b(had)145 1991 y(tried)e(to)e(do)h(b)q
(oth)g(in)f(t)o(w)o(o)h(assignmen)o(ts,)e(but)j(that's)e(a)h(b)q(otc)o
(h.)445 b Fk(\031Change)14 b(#39)4 2051 y Fp(35c)89 b
Fo(h)p Fn(if)15 b(ne)n(e)n(de)n(d,)g(\015ip)g(bit)g(numb)n(ering)g(of)g
(\014elds)g Fr(ii7)f Fn(using)h(size)g Fr(ii5)f Fp(35c)p
Fo(i)o(\021)210 b Fp(\(35a\))187 2101 y Fr(if)21 b(/bit_zero_is_lsb)e
(then)i({)230 2151 y(if)h(!ii7)f(then)g(bit_numbering_us)o(ed)e(:=)i(1)
230 2201 y(every)g(f)h(:=)f(!ii7)g(do)g({)274 2251 y(f.hi)g(:=)g(ii5)g
(-)h(f.hi)274 2300 y(f.lo)f(:=)g(ii5)g(-)h(f.lo)274 2350
y(f.lo)f(:=:)g(f.hi)230 2400 y(})187 2450 y(})145 2499
y Fp(Uses)12 b Fl(bit_number)o(ing)o(_us)o(ed)c Fp(36b)j(and)g
Fl(bit_zero_)o(is_)o(lsb)d Fp(32a.)p eop
%%Page: 36 36
36 35 bop 129 141 a Fv(36)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y Fj(3.2)67 b(Bit)23 b(n)n(um)n(b)r(ering)
-13 349 y Fp(36a)88 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)843 b Fp(\(31\))22 b Fm(/)6 b Fp(35a)22
b(37a)5 b Fm(.)171 398 y Fr(BitSpec)129 b(:)22 b("bit")f(Zero)g("is")g
(Significance)e(Significant)541 448 y(/*)j(xxx)f(:=)g(if)h(ii4)f(==)g
("least")g(then)g(1)g(else)g(&null)607 498 y(if)g(xxx)g(~===)g
(bit_zero_is_lsb)e(then)650 548 y Fo(h)p Fn(p)n(ossible)c(warnings)g
(ar)n(ound)g(changes)h(in)f(bit)g(numb)n(erings)g Fp(36c)p
Fo(i)607 598 y Fr(bit_zero_is_lsb)k(:=)i(xxx)607 647
y(bit_numbering_set)d(:=)j(1)563 697 y(*/)454 747 y(;)171
797 y(Zero)195 b(:)22 b(INT)f(/*)g(ii1)h(=)f(0)h(|)f(error\("expected)e
(`0'"\))i(*/;)171 847 y(Significance)e(:)j(Ident)520
897 y(/*)f(ii1)g(==)h(\("most"|"least")o(\))d(|)j(error\("expected)c
(`most')j(or)g(`least'"\))f(*/;)171 946 y(Significant)41
b(:)22 b(Ident)f(/*)g(ii1)g(==)h("significant")d(|)i(error\("expected)e
(`significant'"\))g(*/;)129 998 y Fp(Uses)12 b Fl(bit_numberi)o(ng_)o
(se)o(t)d Fp(36b,)h Fl(bit_zero_is)o(_ls)o(b)f Fp(32a,)h
Fl(Ident)g Fp(54c,)h(and)f Fl(INT)h Fp(54b)g(359b.)-15
1090 y(36b)88 b Fo(h)p Fn(*)16 b Fp(31)p Fo(i)o Fv(+)p
Fo(\021)1104 b Fm(/)5 b Fp(31)23 b(44b)5 b Fm(.)171 1139
y Fr(global)21 b(bit_numbering_s)o(et,)e(bit_numbering_u)o(sed)129
1191 y Fp(De\014nes:)171 1231 y Fl(bit_number)o(ing)o(_se)o(t)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(36.)171 1270 y Fl(bit_number)o(ing)o
(_us)o(ed)p Fp(,)e(used)j(in)g(c)o(h)o(unks)f(35c,)g(36c,)h(and)f
(115a.)-12 1361 y(36c)89 b Fo(h)p Fn(p)n(ossible)15 b(warnings)g(ar)n
(ound)g(changes)h(in)f(bit)g(numb)n(erings)g Fp(36c)p
Fo(i)o(\021)283 b Fp(\(36a\))171 1411 y Fr(if)21 b(\\bit_numbering_set)
d(then)215 1461 y(warning\("Multip)o(le)h(inconsistent)g(bit)i
(numberings)f(---)h(hope)g(you)g(really)g(mean)g(it!"\))171
1511 y(if)g(\\bit_numbering_used)d(then)215 1561 y(warning\("You)h
(change)h(the)i(bit)f(numbering,)e(but)j(you've)e(already)h(used)g(the)
g(old)g(numbering")f(||)389 1611 y("...)h(seems)g(like)g(a)g(crazy)g
(idea,)g(but)g(I'll)g(do)g(it"\))129 1662 y Fp(Uses)12
b Fl(bit_numberi)o(ng_)o(se)o(t)d Fp(36b,)h Fl(bit_numberi)o(ng_)o(use)
o(d)f Fp(36b,)h(and)h Fl(used)f Fp(136a.)p eop
%%Page: 37 37
37 36 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(37)145 258 y Fj(3.3)66 b(Placeholders)145
349 y Fv(Placeholders)20 b(are)e(emitted)g(for)g(instructions)h(that)f
(refer)i(to)e(unresolv)o(ed)h(relo)q(catable)145 398
y(addresses.)g(They)10 b(are)h(asso)q(ciated)f(with)g(the)g(equiv)n
(alence)g(class)h(of)e(the)h(\014elds)h(used)f(in)g(the)145
448 y(instruction.)18 b(A)11 b(placeholder)h(is)f(de\014ned)h(b)o(y)f
(a)g(pattern)h(with)f(the)h(same)f(length)g(\(but)g(not)145
498 y(necessarily)h(the)g(same)e(shap)q(e\))i(as)f(the)g(equiv)n
(alence)g(class)g(for)g(whic)o(h)g(it)f(is)h(a)g(placeholder.)145
548 y(By)20 b(construction,)g(a)f(placeholder)g(can't)g(refer)h(to)f
(constructors)i(that)e(migh)o(t)e(use)j(it,)145 598 y(b)q(ecause)g(no)e
(suc)o(h)h(constructor)h(can)e(ha)o(v)o(e)g(b)q(een)h(de\014ned)h(y)o
(et.)31 b(In)18 b(other)h(w)o(ords,)g(the)145 647 y(de\014nitions)g(of)
f(placeholders)i(m)o(ust)d(precede)k(the)e(de\014nition)g(of)f(an)g
(instruction)h(that)145 697 y(outputs)c(a)e(pattern)i(with)f(\014elds)g
(in)f(the)i(asso)q(ciated)f(equiv)n(alence)h(classes.)2
757 y Fp(37a)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)845 b Fp(\(31\))22 b Fm(/)5 b Fp(36a)23
b(37c)5 b Fm(.)187 807 y Fr(Placeholder)19 b(:)j("placeholder")d("for")
i(Ident)g("is")f(Pattern)492 857 y(/*)h(class)g(:=)g(lookuptype\(ii3,)e
("equivclass"\))557 907 y(\(/class.holder)g(:=)j(pnf\(ii5,)e
(globals\)\))g(|)557 956 y(error\("Placeholder)e(for)k(",)f(ii3,)g(")g
(is)h(already)e(defined"\))557 1006 y Fo(h)p Fn(make)c(sur)n(e)e(plac)n
(eholder)h(of)g Fr(class)f Fn(is)g(the)h(right)f(length)h
Fp(37b)p Fo(i)514 1056 y Fr(*/;)145 1105 y Fp(De\014nes:)187
1145 y Fl(Placeholde)o(r)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(34b.)145
1184 y(Uses)i Fl(defined)d Fp(136a,)h Fl(equivclass)f
Fp(55,)h Fl(globals)g Fp(32a,)g Fl(Ident)g Fp(54c,)h
Fl(lookuptyp)o(e)e Fp(25a,)h(and)h Fl(pnf)g Fp(74.)0
1260 y(37b)89 b Fo(h)p Fn(make)16 b(sur)n(e)e(plac)n(eholder)h(of)g
Fr(class)f Fn(is)g(the)h(right)f(length)h Fp(37b)p Fo(i)o(\021)314
b Fp(\(37a\))187 1310 y Fr(if)21 b(pattern_length\(cla)o(ss.ho)o
(lder\))d(~=)k(class.size)d(then)230 1360 y(error\("Length)g(of)j
(placeholder)d(`",)j(patimage\(class.)o(holde)o(r\),)274
1409 y("')f(\\nfor)g(",)g(class.name,)f(")i(does)f(not)g(match)f(class)
h(size)g(",)h(class.size\))145 1459 y Fp(Uses)12 b Fl(patimage)d
Fp(372a)h(and)h Fl(pattern_le)o(ngt)o(h)e Fp(72c.)208
1524 y Fr(fieldinfo)i Fv(asso)q(ciates)j Fn(name,)h(value)e
Fv(pairs)g(with)g(one)g(or)h(more)e(\014elds.)18 b(The)c(v)n(alues)145
1574 y(of)19 b Fr(checked)p Fv(\()p Fr(unchecked)p Fv(\))e(\014elds)j
(are)g(\(are)g(not\))f(c)o(hec)o(k)o(ed)i(at)f(run)f(time.)34
b(A)20 b Fr(sparse)145 1624 y Fv(binding)15 b(of)g(\014eld)h(names)f
(is)g(used)i(to)e(sp)q(ecify)h(that)g(only)f(a)g(small)f(set)i(of)f(v)n
(alues)h(of)f(the)145 1674 y(\014eld)h(are)h(meaningful.)22
b(The)16 b(bindings)g(asso)q(ciate)g(a)g(string)g(name)f(with)h(a)f
(\014eld)h(v)n(alue.)145 1724 y(The)i Fr(names)e Fv(construct)j(binds)f
(string)f(names)g(to)g(eac)o(h)h(p)q(ossible)f(v)n(alue)g(of)g(a)g
(\014eld.)28 b(In)145 1774 y(b)q(oth)14 b(cases)i(w)o(e)e(return)h(a)e
(table)h(mapping)e(names)h(to)h(v)n(alues.)4 1833 y Fp(37c)89
b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)843
b Fp(\(31\))22 b Fm(/)6 b Fp(37a)22 b(38a)5 b Fm(.)187
1883 y Fr(Fieldspec)194 b(:)22 b("fieldinfo")d({)j(Fieldinfo)e(})h(;)
187 1933 y(Fieldinfo)194 b(:)22 b(IdentBinding)d("is")i("[")g({)h
(Fielditem)e(})h("]")623 1983 y(/*)43 b(every)21 b(fieldinfo\(looku)o
(ptype)o(\(!ii1)o(,)e("field"\),)h(!ii4\))h(*/;)187 2033
y(IdentBinding)128 b(:)22 b(Ident)e(/*)i([ii1])f(*/)g(|)h("[")f({)g
(Ident)g(})h("]";)187 2082 y(Fielditem)194 b(:)22 b(Ident)42
b(|)22 b(SparseFieldNames)c(|)k(FieldNameList)d(;)187
2132 y(SparseFieldNames)40 b(:)22 b("sparse")e("[")h(FieldNameBindings)
d("]")j(/*)h(sparse_name_tabl)o(e\(ii3)o(\))d(*/)i(;)187
2182 y(FieldNameBinding)o(s)e(:)j(FieldNameBinding)c({",")j
(FieldNameBinding})40 b(/*)22 b(push\(ii2,)d(ii1\))i(*/;)187
2232 y(FieldNameBinding)40 b(:)22 b(FieldName)e("=")h(Integer)f(/*)h
(enumbinding\(ii1,)e(ii3\))i(*/)g(;)187 2282 y(FieldNameList)106
b(:)22 b("names")e("[")h({FieldName})f("]")h(/*)g(full_name_table\(ii3)
o(\))e(*/)i(;)187 2331 y(FieldName)194 b(:)22 b(\(String)e(|)i(Ident\))
e(/*)i({)p Fo(h)p Fn(note)15 b(new)g(\014eld)g(name)g
Fr(ii1)f Fp(33a)p Fo(i)o Fr(};)22 b(ii1)f(*/;)145 2381
y Fp(De\014nes:)187 2420 y Fl(IdentBindi)o(ng)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(52c.)145 2460 y(Uses)j Fl(enumbindi)o(ng)c
Fp(355b,)h Fl(field)h Fp(55,)g Fl(fieldinfo)e Fp(354a,)i
Fl(Fieldspec)e Fp(35a,)i Fl(full_name_)o(tab)o(le)e Fp(355c,)187
2499 y Fl(Ident)h Fp(54c,)g Fl(lookuptype)e Fp(25a,)j
Fl(sparse_nam)o(e_t)o(abl)o(e)e Fp(355a,)h(and)g Fl(String)g
Fp(54c.)p eop
%%Page: 38 38
38 37 bop 129 141 a Fv(38)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y(W)m(e)i(reserv)o(e)i(the)f(follo)o(wing)c
(similar)h(syn)o(tax)i(for)g(places)g(where)h(w)o(e)g(aren't)f
(referring)h(to)129 307 y(\014eld)e(names:)-13 370 y
Fp(38a)88 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o
Fv(+)p Fo(\021)843 b Fp(\(31\))22 b Fm(/)6 b Fp(37c)22
b(38b)5 b Fm(.)171 420 y Fr(SparseNames)19 b(:)j("sparse")e("[")h
(Bindings)g("]")g(/*)g(sparse_name_table\()o(ii3\))d(*/)k(;)171
469 y(Bindings)85 b(:)22 b(Binding)e({",")h(Binding})42
b(/*)22 b(push\(ii2,)e(ii1\))h(*/;)171 519 y(Binding)107
b(:)22 b(\(String|Ident\))d("=")i(Integer)f(/*)i(enumbinding\(ii1,)c
(ii3\))j(*/)h(;)171 569 y(DenseNames)41 b(:)22 b("names")e("[")i
({String|Ident})c("]")k(/*)f(full_name_table\(ii)o(3\))e(*/)i(;)171
619 y(NameTable)63 b(:)22 b(SparseNames)e(|)h(DenseNames;)129
671 y Fp(Uses)14 b Fl(enumbinding)c Fp(355b,)i Fl(full_name_t)o(ab)o
(le)f Fp(355c,)h Fl(Ident)g Fp(54c,)g Fl(sparse_name)o(_ta)o(ble)e
Fp(355a,)171 710 y(and)h Fl(String)e Fp(54c.)192 772
y Fv(I)14 b(lump)e(the)i(w)o(ord)g(size)g(of)g(the)g(target)h(mac)o
(hine)d(in)o(to)h(the)i(\014eld)f(sp)q(ecs,)h(not)f(b)q(ecause)129
822 y(it)g(mak)o(es)f(all)f(that)i(m)o(uc)o(h)f(sense,)i(but)f(b)q
(ecause)i(I)e(didn't)f(kno)o(w)g(where)i(else)g(to)f(put)g(it.)-15
884 y Fp(38b)88 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)843 b Fp(\(31\))22 b Fm(/)6 b Fp(38a)22
b(39a)5 b Fm(.)171 934 y Fr(Fieldspec)20 b(:)h("wordsize")f(INT)h(/*)h
(wordsize)e(:=)h(ii2)g(*/;)129 986 y Fp(Uses)12 b Fl(Fieldspec)d
Fp(35a,)h Fl(INT)h Fp(54b)g(359b,)f(and)g Fl(wordsize)f
Fp(38c.)-12 1069 y(38c)89 b Fo(h)p Fn(toplevel)15 b Fp(32a)p
Fo(i)o Fv(+)q Fo(\021)870 b Fp(\(31\))22 b Fm(/)6 b Fp(35b)22
b(38e)5 b Fm(.)171 1119 y Fr(global)21 b(wordsize)194
b(#)22 b(word)f(size)g(of)g(the)g(machine)f(the)i(application)d(runs)i
(on)129 1171 y Fp(De\014nes:)171 1210 y Fl(wordsize)p
Fp(,)10 b(used)i(in)h(c)o(h)o(unks)e(38,)i(97{99,)e(115c,)h(133c,)f
(188b,)h(198a,)g(201b,)f(315a,)h(333a,)g(335a,)212 1250
y(and)f(346b.)-15 1341 y(38d)88 b Fo(h)p Fn(initialization)15
b Fp(38d)p Fo(i)o(\021)884 b Fp(\(32b\))22 b(47b)5 b
Fm(.)171 1391 y Fr(wordsize)20 b(:=)h(32)129 1443 y Fp(Uses)12
b Fl(wordsize)d Fp(38c.)129 1601 y Fj(3.4)67 b(P)n(attern)23
b(de\014nitions)129 1692 y Fv(P)o(atterns)14 b(parse)f(in)o(to)e
(abstract)i(syn)o(tax;)f(patbinding)f(mak)o(es)g(them)h(concrete)i(and)
d(binds)129 1742 y(them)j(to)f(iden)o(ti\014ers.)-12
1804 y Fp(38e)89 b Fo(h)p Fn(toplevel)15 b Fp(32a)p Fo(i)o
Fv(+)q Fo(\021)872 b Fp(\(31\))22 b Fm(/)6 b Fp(38c)22
b(40a)5 b Fm(.)171 1854 y Fr(global)21 b(patlhs)238 b(#)22
b(hold)f(lhs)g(for)g(later)g(action)129 1906 y Fp(De\014nes:)171
1945 y Fl(patlhs)p Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(39a.)p
eop
%%Page: 39 39
39 38 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(39)2 258 y Fp(39a)89 b Fo(h)p
Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)839
b Fp(\(31\))22 b Fm(/)6 b Fp(38b)22 b(39b)5 b Fm(.)187
307 y Fr(Patterns)42 b(:)21 b("patterns")f({)i(PatBinding)d(};)187
357 y(PatBinding:)g(\(Ident)i(/*)g(patlhs)g(:=)g(ii1)g(*/\))h("is")e
(BindingRHS)405 407 y(|)h("[")g({Ident})g("]")g("is")g(Pattern)f(/*)i
(patbinding\(ii2,)c(ii5\))j(*/)405 457 y(;)187 507 y(BindingRHS:)e
(Pattern)i(/*)g(patbinding\(patlhs,)d(ii1\))j(*/)405
557 y(|)g("any")g("of")g("[")g({Ident})g("]")g(",")g("which")f("is")h
(Pattern)492 606 y(/*)g(patbinding\(copy\(ii4)o(\),)e(ii9\))557
656 y(l)j(:=)f([])557 706 y(every)g(put\(l,)g(Pident\("_")e(~==)i
(!ii4\)\))557 756 y(patbinding\(patlhs,)d(Por\(l\)\))j(*/)405
806 y(;)145 857 y Fp(Uses)12 b Fl(Ident)e Fp(54c,)h Fl(patbindin)o(g)e
Fp(43a,)h Fl(patlhs)g Fp(38e,)g Fl(Pident)g Fp(41a,)g(and)h
Fl(Por)g Fp(41a.)208 928 y Fv(P)o(arsing)19 b(lab)q(els)g(relies)g(on)g
(a)g(grotesque)i(hac)o(k)e(to)g(k)o(eep)h(things)f(LL\(1\);)j(w)o(e)d
(allo)o(w)145 978 y(an)14 b(arbitrary)f(sequen)o(t)i(to)f(precede)h
(colon,)e(then)i(patc)o(h)e(things)h(up)g(seman)o(tically)d(after-)145
1028 y(w)o(ards.)0 1090 y Fp(39b)89 b Fo(h)p Fn(gr)n(ammar)15
b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)845 b Fp(\(31\))22 b
Fm(/)5 b Fp(39a)23 b(41c)5 b Fm(.)187 1140 y Fr(Pattern)64
b(:)21 b(Disjunct)129 b({)22 b("|")f(Disjunct)f(})131
b(/*)21 b(Por\(push\(ii2,)e(ii1\)\))65 b(*/)21 b(;)187
1190 y(Disjunct)42 b(:)21 b(Sequent)151 b({)22 b(";")f(Sequent)753
1239 y(|)h(":")f(Sequent)g(/*)g(colon_mark\(ii2\))e(*/)753
1289 y(})131 b(/*)21 b(Pseq\(colons_to_labe)o(ls\(pu)o(sh\(ii)o(2,)e
(ii1\)\)\))42 b(*/)21 b(;)187 1339 y(Sequent)64 b(:)21
b(Conjunct)129 b({)22 b("&")f(Conjunct)f(})131 b(/*)21
b(Pand\(push\(ii2,)e(ii1\)\))43 b(*/)21 b(;)187 1439
y(Conjunct)42 b(:)21 b(["..."])g(DotsR)86 b(/*)21 b(if)h(\\ii1)f(then)f
(Pseq\([dots_pattern\(\))o(,ii2])o(\))f(else)i(ii2)g(*/;)187
1488 y(DotsR)108 b(:)21 b(Atomic)g(["..."])64 b(/*)21
b(if)h(\\ii2)f(then)f(Pseq\([ii1,dots_patte)o(rn\(\)])o(\))f(else)i
(ii1)g(*/)g(;)187 1588 y(Atomic)86 b(:)21 b(\(Ident)g(/*)g(atomicid)f
(:=)i(ii1)f(*/\))448 1638 y(\()785 b(/*)21 b(Pident\(atomicid\))e(*/)
448 1688 y(|)j(Relop)f(\(Generator)e(|)j(Expr\))239 b(/*)21
b(Pcon\(atomicid,)e(ii1,)i(ii2\))g(*/)448 1738 y(|)h({"^")f(Opname})f
("\(")h(ConstructorArgs)e("\)")579 1787 y(/*)i(Papp\(push\(ii1,)e
(\\symtab[atomicid])g(|)i(atomicid\),)f(ii3\))h(*/)448
1837 y(\))h(/*)f(ii2)g(*/)405 1887 y(|)g(String)g({"^")g(Opname})f
("\(")h(ConstructorArgs)e("\)")579 1937 y(/*)i(Papp\(push\(ii2,)e
(ii1\),)i(ii4\))g(*/)405 1987 y(|)g("\(")g(Pattern)g("\)")405
2036 y(|)g("[")g({Ident)g(/*)g(Pident\(ii1\))f(*/})h("]")65
b(/*)21 b(Plist\(ii2\))f(*/)405 2086 y(;)187 2136 y(ConstructorArgs)e
(:)k(AppExpr)e({",")h(AppExpr})g(/*)g(push\(ii2,)f(ii1\))h(*/)535
2186 y(|)h(/*)f([])h(*/)535 2236 y(;)145 2288 y Fp(Uses)13
b Fl(atomicid)c Fp(40b,)i Fl(colon_mark)e Fp(40a,)i Fl(colons_to_)o(la)
o(bel)o(s)e Fp(40a,)i Fl(dots_patter)o(n)e Fp(62c,)i
Fl(Ident)g Fp(54c,)187 2327 y Fl(Pand)g Fp(41a,)h Fl(Papp)g
Fp(41a,)f Fl(Pcon)h Fp(41a,)f Fl(Pident)g Fp(41a,)h Fl(Plist)f
Fp(41a,)h Fl(Por)g Fp(41a,)f Fl(Pseq)h Fp(41a,)g Fl(String)e
Fp(54c,)187 2366 y(and)g Fl(symtab)g Fp(32a)h(367.)p
eop
%%Page: 40 40
40 39 bop 129 141 a Fv(40)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(W)m(e)i(used)i(to)e(\\explo)q(de")h(comp)
q(ound)e(constructor)k(names)c(at)i(this)g(syn)o(tactic)g(step,)129
307 y(but)f(this)f(turned)h(out)g(to)f(b)q(e)h(not)f(what)g(w)o(e)g(w)o
(an)o(ted)h(on)f(the)h(RHS)f(of)f(constructor)j(de\014-)129
357 y(nitions.)i(F)m(or)13 b(example,)f(in)129 440 y
Fr(pattern)21 b(load)g(is)g(ld)h(|)f(lb)129 490 y(constructor)f
(load^"2")g(a,b,c,d)g(is)i(load\(a,b\);)e(load\(c,d\))129
573 y Fv(w)o(e)g(cannot)g(ev)n(aluate)f Fr(Papp\(name,)g(args\))g
Fv(for)g(the)h Fr(load)p Fv(s)e(on)i(the)f(righ)o(t-hand)g(side)129
623 y(un)o(til)d(w)o(e)g(ha)o(v)o(e)f(an)h(en)o(vironmen)o(t)f(telling)
g(use)i(whether)g Fr(load)e Fv(stands)i(for)e Fr(ld)h
Fv(or)g Fr(lb)f Fv(in)129 673 y(this)e(particular)g(con)o(text.)18
b(\(The)13 b(original)e(seman)o(tics)h(made)g(it)g(stand)h(for)f
Fr(ld|lb)p Fv(,)g(whic)o(h)129 723 y(w)o(e)j(decided)f(w)o(as)g(rarely)
g(what)g(an)o(y)o(one)g(w)o(an)o(ted.\))192 772 y(Here's)h(the)f(colon)
g(\014x:)-13 835 y Fp(40a)88 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o Fv(+)q Fo(\021)870 b Fp(\(31\))22 b
Fm(/)6 b Fp(38e)22 b(40b)5 b Fm(.)171 884 y Fr(record)21
b(colon_mark\(x\))171 984 y(procedure)f(colons_to_labels\()o(l\))215
1034 y(every)g(i)i(:=)f(1)h(to)f(*l)h(&)f(type\(l[i]\))f(==)h
("colon_mark")f(do)h({)258 1084 y(l[i])g(:=)g(l[i].x)43
b(#)21 b(strip)g(out)g(tag)258 1134 y(\(l[i-1])f(:=)i
(undo_identifier_s)o(yntax)o(\(l[i)o(-1]\)\))c(|)302
1183 y(error\("Colon)h(must)i(be)g(preceded)g(by)g(an)g(identifier"\))
215 1233 y(})215 1283 y(return)f(l)171 1333 y(end)171
1432 y(procedure)g(undo_identifier_s)o(yntax)o(\(seq\))215
1482 y(if)h(type\(seq\))f(==)h("Pand")g(&)g(*seq.patterns)e(=)j(1)g(&)f
(con)g(:=)h(seq.patterns[1])c(&)280 1532 y(type\(con\))i(==)h("Pident")
215 1582 y(then)258 1632 y(return)g(Plabel\(con.name\))171
1681 y(end)129 1733 y Fp(De\014nes:)171 1773 y Fl(colon_mark)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(39b.)171 1812 y Fl(colons_to_)o(lab)
o(els)o Fp(,)f(used)h(in)i(c)o(h)o(unk)d(39b.)129 1852
y(Uses)j Fl(Pand)e Fp(41a,)h Fl(Pident)f Fp(41a,)g(and)h
Fl(Plabel)e Fp(41a.)192 1914 y Fr(atomicid)j Fv(is)i(an)f(auxiliary)f
(v)n(ariable.)-15 1976 y Fp(40b)88 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o Fv(+)q Fo(\021)870 b Fp(\(31\))22 b
Fm(/)6 b Fp(40a)22 b(41a)5 b Fm(.)171 2026 y Fr(global)21
b(atomicid)129 2078 y Fp(De\014nes:)171 2117 y Fl(atomicid)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(39b.)p eop
%%Page: 41 41
41 40 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(41)208 258 y(The)11 b(follo)o(wing)d(records)k
(represen)o(t)h(the)e(no)q(des)h(in)e(a)g(pattern's)h(abstract)h(syn)o
(tax)f(tree.)2 320 y Fp(41a)89 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o Fv(+)p Fo(\021)867 b Fp(\(31\))22 b
Fm(/)6 b Fp(40b)22 b(41b)5 b Fm(.)187 370 y Fr(record)20
b(Por)i(\(patterns\))412 b(#)21 b(disjunction)187 420
y(record)f(Pseq\(patterns\))412 b(#)21 b(sequence)187
469 y(record)f(Pand\(patterns\))412 b(#)21 b(conjunction)187
519 y(record)f(Pcon\(name,)g(relop,)h(value\))195 b(#)21
b(constraint)f(on)h(field)187 569 y(record)f(Pident\(name\))456
b(#)21 b(identifier)f(standing)g(for)h(a)h(pattern)187
619 y(record)e(Plabel\(name\))456 b(#)21 b(pattern)f(label)187
669 y(record)g(Papp\(cons,)g(args\))370 b(#)21 b(constructor)f(applied)
g(to)h(arguments)1059 718 y(#)65 b(\(args)20 b(are)i(AppExprs\))187
768 y(record)e(Plist\(patterns\))390 b(#)21 b(list)g(of)g(patterns)g
(in)g(square)g(brackets)145 820 y Fp(De\014nes:)187 860
y Fl(Pand)p Fp(,)10 b(used)g(in)i(c)o(h)o(unks)d(39b,)i(40a,)f(75,)h
(78,)g(79,)g(164a,)f(and)h(377a.)187 899 y Fl(Papp)p
Fp(,)f(used)g(in)i(c)o(h)o(unks)d(39b,)i(41b,)f(75,)h(78,)g(79,)g(176,)
f(and)h(377a.)187 938 y Fl(Pcon)p Fp(,)f(used)g(in)i(c)o(h)o(unks)d
(39b,)i(75,)g(78,)g(79,)f(and)h(377a.)187 978 y Fl(Pident)p
Fp(,)e(used)i(in)g(c)o(h)o(unks)f(39,)h(40a,)f(75,)h(78,)g(79,)g(164a,)
f(and)g(377a.)187 1017 y Fl(Plabel)p Fp(,)f(used)i(in)g(c)o(h)o(unks)f
(40a,)g(75,)h(78,)g(and)g(79.)187 1057 y Fl(Plist)p Fp(,)f(used)g(in)h
(c)o(h)o(unks)f(39b)h(and)f(75.)187 1096 y Fl(Por)p Fp(,)g(used)h(in)g
(c)o(h)o(unks)f(39,)h(41b,)f(75,)h(78,)g(79,)g(and)f(377a.)187
1136 y Fl(Pseq)p Fp(,)g(used)g(in)i(c)o(h)o(unks)d(39b,)i(75,)g(78,)g
(79,)f(and)h(377a.)145 1175 y(Uses)h Fl(constraint)c
Fp(55,)j Fl(constructo)o(r)e Fp(159,)h Fl(field)g Fp(55,)h
Fl(label)f Fp(383a,)g Fl(pattern)g Fp(55,)g(and)h Fl(value)f
Fp(136a.)208 1237 y Fv(The)i(name)f(of)h(an)g(applied)g(constructor)i
(dep)q(ends)g(on)e(the)h(en)o(vironmen)o(t)e(in)h(whic)o(h)g(it)145
1287 y(is)g(ev)n(aluated.)18 b(W)m(e)12 b(use)h Fr(explode_names)c
Fv(to)j(generate)i(all)d(p)q(ossible)h(constructor)i(names)145
1337 y(denoted)h(b)o(y)f(a)f(constructor)j(application,)c(then)i
(generate)i(the)e(applications.)0 1399 y Fp(41b)89 b
Fo(h)p Fn(toplevel)15 b Fp(32a)p Fo(i)o Fv(+)p Fo(\021)869
b Fp(\(31\))22 b Fm(/)6 b Fp(41a)22 b(42b)5 b Fm(.)187
1449 y Fr(procedure)20 b(explode_apps\(opc)o(ode,)e(args,)j(rho\))230
1499 y(l)h(:=)f([])230 1549 y(every)g(c)h(:=)f(explode_names\(opco)o
(de,)e(rho\))i(do)g({)274 1598 y(put\(l,)g(Papp\(cons_named)o(\(c\),)d
(args\)\))230 1648 y(})230 1698 y(return)j(if)g(*l)h(=)f(1)h(then)f
(l[1])g(else)g(Por\(l\))187 1748 y(end)145 1800 y Fp(De\014nes:)187
1839 y Fl(explode_ap)o(ps)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(75)h
(and)f(79b.)145 1879 y(Uses)i Fl(cons_named)c Fp(167a,)i
Fl(explode_nam)o(es)e Fp(163b,)j Fl(Papp)f Fp(41a,)g(and)h
Fl(Por)g Fp(41a.)4 1962 y(41c)89 b Fo(h)p Fn(gr)n(ammar)15
b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)841 b Fp(\(31\))22 b
Fm(/)6 b Fp(39b)22 b(42a)5 b Fm(.)187 2011 y Fr(Relop)108
b(:)21 b("=")g(|)h("!=")f(|)h("<=")f(|)g(">=")g(|)h("<")f(|)g(">")h(;)
187 2061 y(Generator)e(:)h("{")g(Integer)g("to")g(Integer)f([)i
("columns")e(INT)h(/*)g(ii2)g(*/)h(])f("}")884 2111 y(/*)h(Gfor\(ii2,)d
(ii4+1,)i(\\ii5)g(|)h(1\))f(*/)405 2161 y(|)g("[")g({)h(Integer)e(})i
("]")108 b(/*)22 b(Glist\(ii2\))d(*/)405 2211 y(;)145
2263 y Fp(Uses)12 b Fl(Gfor)e Fp(42b,)h Fl(Glist)f Fp(42b,)g(and)h
Fl(INT)g Fp(54b)f(359b.)p eop
%%Page: 42 42
42 41 bop 129 141 a Fv(42)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(There)e(are)f(a)f(couple)i(of)e(sp)q
(ecial)h(patterns.)18 b(These)11 b(alone)e(pro)q(duce)i(patterns)g
(directly)m(,)129 307 y(not)16 b(an)f(AST.)f(\()p Fr(pnf)p
Fv(,)h(for)g(example,)f(isn't)g(prepared)j(to)e(cop)q(e)h(with)f(a)g
(pattern)h(with)f(an)129 357 y(empt)o(y)e(sequence\).)-13
420 y Fp(42a)88 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)845 b Fp(\(31\))22 b Fm(/)6 b Fp(41c)22
b(44a)5 b Fm(.)171 469 y Fr(Atomic)21 b(:)g("epsilon")64
b(/*)21 b(epsilon\(\))f(*/)324 519 y(|)h("some")g(Ident)f(/*)i
(wildcard\(lookupt)o(ype\(i)o(i2,)d("equivclass"\)\))g(*/)324
569 y(;)129 621 y Fp(Uses)12 b Fl(epsilon)d Fp(62b,)i
Fl(equivclass)d Fp(55,)j Fl(Ident)f Fp(54c,)g Fl(lookuptype)f
Fp(25a,)h(and)h Fl(wildcard)e Fp(62a.)129 750 y Ft(3.4.1)56
b(P)n(attern)19 b(syn)n(tax)129 826 y Fv(A)11 b(generator)g(is)e
(represen)o(ted)k(b)o(y)d(a)g Fr(Glist)p Fv(.)16 b(The)10
b(list)g(of)f(v)n(alues)h(is)g(either)h(giv)o(en)f(explicitly)129
876 y(or)17 b(generated)g(on)f(the)h(sp)q(ot)g(b)o(y)e
Fr(Gfor)p Fv(.)25 b(Note)16 b(that)g Fr(hi)g Fv(is)g(one)h
Fn(mor)n(e)e Fv(than)i(the)f(largest)129 926 y(v)n(alue)e(generated.)
-15 988 y Fp(42b)88 b Fo(h)p Fn(toplevel)15 b Fp(32a)p
Fo(i)o Fv(+)q Fo(\021)868 b Fp(\(31\))22 b Fm(/)6 b Fp(41b)22
b(43a)5 b Fm(.)171 1038 y Fr(record)21 b(Glist\(values\))171
1088 y(procedure)f(Gfor\(lo,)g(hi,)h(cols\))258 1137
y(local)g(l,)g(r)258 1187 y(l)h(:=)f([])258 1237 y(r)h(:=)f(\(hi)g(-)h
(lo\))f(/)h(cols)258 1287 y(every)f(put\(l,)f(lo)i(+)f(\(0)h(to)f(r)h
(-)f(1\))h(+)f(r)h(*)f(\(0)h(to)f(cols)g(-)h(1\)\))258
1337 y(return)f(Glist\(l\))171 1387 y(end)129 1438 y
Fp(De\014nes:)171 1478 y Fl(Gfor)p Fp(,)10 b(used)h(in)g(c)o(h)o(unk)f
(41c.)171 1517 y Fl(Glist)p Fp(,)g(used)g(in)h(c)o(h)o(unks)f(41c,)h
(76a,)f(and)h(377a.)p eop
%%Page: 43 43
43 42 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(43)208 258 y(Binding)12 b(a)g(pattern)i
(requires)g(putting)f(it)f(in)h(normal)e(form.)k(If)e(there)h(is)f(a)g
(generator)145 307 y(in)h(the)g(pattern,)g(the)h(normal)d(form)g(is)i
(a)f(list.)18 b(In)c(that)g(case,)g Fr(id)f Fv(m)o(ust)g(also)h(b)q(e)g
(a)g(list.)2 370 y Fp(43a)89 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o Fv(+)p Fo(\021)871 b Fp(\(31\))22 b
Fm(/)6 b Fp(42b)22 b(45e)5 b Fm(.)187 420 y Fr(procedure)20
b(patbinding\(id,)f(ast\))274 469 y(local)i(p)274 519
y Fo(h)p Fn(verb)n(osely)15 b(announc)n(e)h(binding)g
Fp(43c)p Fo(i)274 569 y Fr(p)22 b(:=)f(pnf\(ast,)f(globals\))274
619 y Fo(h)p Fn(insist)15 b Fr(p)f Fn(have)i(no)f(c)n(onditionals)g
(nor)g(\014eld)g(bindings)h Fp(43b)p Fo(i)274 669 y Fr(case)21
b(type\(id\))f(||)h(",")h(||)f(type\(p\))f(of)i({)361
718 y("string,pattern")d(:)i(patbind\(id,)f(p,)h(globals\))361
768 y("list,list")129 b(:)21 b(if)h(*id)f(=)g(*p)h(then)819
818 y(while)f(patbind\(get\(id\))o(,)e(get\(p\),)h(globals\))775
868 y(else)819 918 y(error\("identifie)o(r)f(list/generator)g(length)i
(mismatch:)e(",)950 967 y(*id,)i(")g(vs)g(",)h(*p\))361
1017 y("string,list")85 b(:)21 b(error\("generator)e(must)i(be)g(bound)
g(to)g(an)h(identifier)d(list"\))361 1067 y("list,pattern")63
b(:)21 b(error\("identifier)d(list)j(must)g(be)h(bound)f(to)g(a)h
(generator"\))361 1117 y(default)217 b(:)21 b(impossible\("patter)o(n)e
(binding"\))274 1167 y(})274 1217 y(return)187 1266 y(end)145
1318 y Fp(De\014nes:)187 1358 y Fl(patbinding)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)d(39a.)145 1397 y(Uses)j Fl(globals)d
Fp(32a,)i Fl(patbind)e Fp(56,)i Fl(pattern)e Fp(55,)i(and)g
Fl(pnf)f Fp(74.)0 1480 y(43b)89 b Fo(h)p Fn(insist)15
b Fr(p)f Fn(have)i(no)f(c)n(onditionals)h(nor)e(\014eld)i(bindings)f
Fp(43b)p Fo(i)o(\021)370 b Fp(\(43a\))187 1530 y Fr(case)21
b(type\(p\))f(of)h({)230 1580 y("pattern")f(:)i(insist_global_pat)o
(tern\()o(p\))230 1630 y("list")86 b(:)22 b(every)f(insist_global_pa)o
(ttern)o(\(!p\))187 1679 y(})145 1731 y Fp(Uses)12 b
Fl(insist_glo)o(bal)o(_pa)o(tte)o(rn)c Fp(73b)j(and)g
Fl(pattern)e Fp(55.)4 1823 y(43c)89 b Fo(h)p Fn(verb)n(osely)15
b(announc)n(e)i(binding)e Fp(43c)p Fo(i)o(\021)729 b
Fp(\(43a\))187 1872 y Fr(case)21 b(type\(id\))f(of)h({)230
1922 y("string")g(:)g(verbose\("Pattern)e(",)i(id\))230
1972 y("list")65 b(:)21 b(verbose\(*id,)e(")j(patterns"\))187
2022 y(})145 2074 y Fp(Uses)12 b Fl(verbose)d Fp(18a.)p
eop
%%Page: 44 44
44 43 bop 129 141 a Fv(44)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y Fj(3.5)67 b(Constructors)129
349 y Fv(A)17 b(constructor)h(consists)g(of)e(an)g Fr(Opcode)p
Fv(,)g(one)g(or)h(more)e Fr(Operand)p Fv(s,)h(an)g(optional)f(con-)129
398 y(structor)23 b(t)o(yp)q(e)e Fr(ConstType)p Fv(,)f(and)h(one)g(or)g
(more)f Fr(Branches)p Fv(.)37 b(The)21 b(default)g(t)o(yp)q(e)g(of)129
448 y(a)e(constructor)h(is)e Fr(instruction)p Fv(.)29
b(One-branc)o(h)19 b(syn)o(tax)g(is)f(radically)f(di\013eren)o(t)i
(from)129 498 y(m)o(ultibranc)o(h)d(syn)o(tax)i(and)g(I)f(ha)o(v)o
(en't)h(the)g(time)e(to)i(explain)f(the)h(details)g(no)o(w.)29
b(Eac)o(h)129 548 y(branc)o(h)17 b(consists)f(of)g(a)f(set)i(of)e
Fr(Equations)f Fv(follo)o(w)o(ed)g(b)o(y)h(a)h(required)h(output)e
Fr(Pattern)p Fv(.)129 598 y(Branc)o(hes)i(are)f(ev)n(aluated)f(in)g
(order:)21 b(the)16 b(constructor's)h(v)n(alue)d(is)h(the)h(output)g
(pattern)129 647 y(of)e(the)g(\014rst)h(branc)o(h)f(whose)h(constrain)o
(ts)f(are)h(satis\014ed.)-13 710 y Fp(44a)88 b Fo(h)p
Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)843
b Fp(\(31\))22 b Fm(/)6 b Fp(42a)22 b(45a)5 b Fm(.)171
760 y Fr(Constructors)19 b(:)j("constructors")d(\(/*see_newline\(\))o
(*/\))g({)i(Constructor)f(/*)h(see_newline\(\))e(*/})i(;)171
809 y(Constructor)41 b(:)22 b(Opcode)e(Operands)h([)g(":")g(ConstType)f
(])i(NLBranches)541 859 y(/*)g(note_constructor\()o(ii1,)c(ii2,)j
(\\ii3)g(|)h(instructionctype)o(,)d(ii4\))i(*/)498 909
y(;)171 959 y(Operands)f(:)i(SeeWhite)e({Operand})g(StopWhite)g(/*)h
(process_operands\(i)o(i2\))e(*/;)129 1011 y Fp(Uses)14
b Fl(construct)o(ors)9 b Fp(32a,)j Fl(ConstType)e Fp(45d,)i
Fl(instructio)o(nct)o(ype)d Fp(32a,)j Fl(note_constr)o(uct)o(or)e
Fp(160,)171 1050 y Fl(process_op)o(era)o(nds)e Fp(44b,)i(and)h
Fl(see_newlin)o(e)e Fp(362a.)192 1112 y Fv(T)m(o)i(pro)q(cess)j(op)q
(erands,)f(w)o(e)f(com)o(bine)f(adjacen)o(t)h(literals)g(and)g(remo)o
(v)o(e)f(trailing)f(white)129 1162 y(space.)-15 1224
y Fp(44b)88 b Fo(h)p Fn(*)16 b Fp(31)p Fo(i)o Fv(+)p
Fo(\021)1084 b Fm(/)6 b Fp(36b)22 b(46b)5 b Fm(.)171
1274 y Fr(procedure)20 b(process_operands\()o(ops\))215
1324 y(if)h(type\(ops[-1]\))e(==)i("literal")f(&)i(ops[-1].s)e(?)h
(\(white\(\),)f(pos\(0\)\))h(then)258 1374 y(pull\(ops\))f(#)i(discard)
e(trailing)g(white)h(space)215 1424 y(l)g(:=)h([])215
1474 y(every)e(x)i(:=)f(!ops)g(do)258 1523 y(if)h(type\(x\))e(==)h
("literal")f(&)i(type\(l[-1]\))d(==)j("literal")e(then)302
1573 y(l[-1].s)g(||:=)h(x.s)258 1623 y(else)302 1673
y(put\(l,)f(x\))215 1723 y(return)g(l)171 1772 y(end)129
1824 y Fp(De\014nes:)171 1864 y Fl(process_op)o(era)o(nds)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(44a.)129 1903 y(Uses)j
Fl(literal)d Fp(45e)i(and)g Fl(white)f Fp(364a.)p eop
%%Page: 45 45
45 44 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(45)2 258 y Fp(45a)89 b Fo(h)p
Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)841
b Fp(\(31\))22 b Fm(/)6 b Fp(44a)22 b(45b)5 b Fm(.)187
307 y Fr(NLBranches)63 b(:)22 b(Branches)470 357 y(|)g(NEWLINE)e
(\(Branches)g(|)i(/*)f([)h([)f([],)g(&null)g(])h(])f(*/\))470
407 y(;)187 457 y(Branches)107 b(:)22 b(SingleBranch)d(/*)i([ii1])g(*/)
470 507 y(|)h(WhenBranch)d({WhenBranch)h(|)i(OtherwiseBranch)o(})535
557 y(/*)g(push\(ii2,)e(ii1\);)h(put\(ii2,)f(\\ii3\);)g(ii2)h(*/)470
606 y(;)187 656 y(SingleBranch)e(:)j("{")f(Equations)f("}")h([)h("is")f
(Pattern)f(])h(/*)h([)f(ii2,)g(\\ii4)g(|)h(&null])e(*/)470
706 y(|)i("is")f(Pattern)85 b(/*)22 b([)f([])h(,)f(ii2)g(])h(*/)470
756 y(;)187 806 y(WhenBranch)128 b(:)22 b("when")f("{")g(Equations)f
("}")h("is")g(Pattern)f(/*)i([ii3,)e(ii6])h(*/;)187 855
y(OtherwiseBranch)d(:)k("otherwise")e("is")h(Pattern)f(/*)h([[],)g
(ii3])g(*/;)145 905 y Fp(Uses)12 b Fl(NEWLINE)d Fp(54b)i(359b.)0
985 y(45b)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o
Fv(+)p Fo(\021)845 b Fp(\(31\))22 b Fm(/)5 b Fp(45a)23
b(45c)5 b Fm(.)187 1035 y Fr(Opcode)86 b(:)21 b(Opname)g({)g("^")h
(Opname)e(})44 b(/*)21 b(push\(ii2,)f(ii1\))h(*/)g(;)187
1084 y(Opname)86 b(:)21 b(Ident)g(/*)g(\\symtab[ii1])f(|)h(ii1)h(*/)f
(|)g(String)g(;)145 1134 y Fp(Uses)12 b Fl(Ident)e Fp(54c,)h
Fl(String)e Fp(54c,)i(and)f Fl(symtab)g Fp(32a)h(367.)4
1214 y(45c)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o
Fv(+)p Fo(\021)839 b Fp(\(31\))22 b Fm(/)6 b Fp(45b)22
b(45d)5 b Fm(.)187 1264 y Fr(Operand)129 b(:)22 b(Ident)e(["!"])h(/*)h
({)p Fo(h)p Fn(note)15 b(new)g(op)n(er)n(and)g(or)g(id)f
Fr(ii1)h Fp(33b)p Fo(i)o Fr(};)841 1313 y(name_to_input\(i)o(i1,)k
(ii2\))i(*/)470 1363 y(|)h(\(Literal)e(|)h(GlobOperator)f(|)h(White\))g
(/*)g(literal\(ii1\))f(*/)470 1413 y(;)187 1463 y(Literal)129
b(:)22 b(String)e(|)i(Integer)e(/*)i(string\(ii1\))d(*/)i(|)h(Relop)f
(|)g("=>")470 1513 y(|)h("[")f(|)g("]")h(|)f("\(")g(|)h("\)")f(|)h("+")
f(|)g("-")h(|)f("/")470 1562 y(|)h("&")f(|)g("@")h(|)f("#")g(|)h
("\045")f(|)h(";")f(|)g("|")470 1612 y(;)187 1662 y(GlobOperator)e(:)j
("*")f(|)g("$")h(|)f(",")470 1712 y(;)145 1761 y Fp(Uses)12
b Fl(Ident)e Fp(54c,)h Fl(literal)e Fp(45e,)h Fl(name_to_inp)o(ut)e
Fp(46b,)j(and)f Fl(String)g Fp(54c.)208 1826 y Fv(A)i
Fr(ConstType)e Fv(is)i(de\014ned)i(implicitly)9 b(b)o(y)j(the)h
(\014rst)g(declaration)e(of)h(a)g(constructor)i(of)145
1876 y(that)g(t)o(yp)q(e.)0 1935 y Fp(45d)89 b Fo(h)p
Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)847
b Fp(\(31\))22 b Fm(/)5 b Fp(45c)23 b(47c)5 b Fm(.)187
1985 y Fr(ConstType)20 b(:)h(Ident)g(/*)g(\(/symtab[ii1])f(:=)h
(constype\(ii1,)e(set\(\)\)\))h(|)644 2035 y(lookuptype\(ii1,)f
("constype"\))41 b(*/;)145 2084 y Fp(De\014nes:)187 2124
y Fl(ConstType)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(44a.)145
2163 y(Uses)i Fl(constype)d Fp(159,)h Fl(Ident)g Fp(54c,)h
Fl(lookuptype)d Fp(25a,)j(and)f Fl(symtab)g Fp(32a)g(367.)208
2223 y Fv(The)k Fr(literal)e Fv(t)o(yp)q(e)j(serv)o(es)g(to)f(hold)f
(strings)h(that)g(are)h(to)e(b)q(e)i(emitted)e(literally)m(.)4
2282 y Fp(45e)89 b Fo(h)p Fn(toplevel)15 b Fp(32a)p Fo(i)o
Fv(+)p Fo(\021)871 b Fp(\(31\))22 b Fm(/)6 b Fp(43a)22
b(46a)5 b Fm(.)187 2332 y Fr(record)20 b(literal\(s\))151
b(#)21 b(holds)g(string)g(or)g(list)g(to)g(be)h(emitted)e(literally)145
2381 y Fp(De\014nes:)187 2420 y Fl(literal)p Fp(,)8 b(used)j(in)f(c)o
(h)o(unks)g(33c,)g(44b,)g(45c,)g(49,)h(78,)f(79,)g(104c,)g(118b,)g
(123a,)g(128d,)f(175,)h(188b,)g(205b,)228 2460 y(209a,)h(212d,)f(216,)g
(233a,)h(244,)f(246,)h(248,)g(250a,)f(254,)g(258,)h(294d,)f(297c,)h
(299a,)f(310,)g(311a,)h(326a,)228 2499 y(340a,)f(and)h(348.)p
eop
%%Page: 46 46
46 45 bop 129 141 a Fv(46)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(Ev)o(ery)h(op)q(erand)h(that)f(is)f(not)h
(of)f(t)o(yp)q(e)i Fr(literal)d Fv(is)i(of)f(t)o(yp)q(e)i
Fr(input)p Fv(:)-13 319 y Fp(46a)88 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o Fv(+)q Fo(\021)872 b Fp(\(31\))22 b
Fm(/)6 b Fp(45e)22 b(48a)5 b Fm(.)171 369 y Fr(record)21
b(input\(name,)e(meaning\))456 b(#)22 b(input)e(name)h(and)h(meaning)
129 420 y Fp(De\014nes:)171 459 y Fl(input)p Fp(,)10
b(used)h(in)g(c)o(h)o(unks)f(12l,)h(20,)g(21c,)g(24,)g(29,)g(46b,)g
(55,)g(81,)g(162a,)g(166a,)f(169,)h(171a,)f(172b,)g(174a,)212
499 y(176,)h(189a,)f(203,)h(204a,)f(208c,)g(211{13,)f(224a,)h(233a,)h
(244,)f(246,)h(254,)f(262a,)g(311,)h(and)f(376b.)129
560 y Fv(There)15 b(are)g(\014v)o(e)f(legitimate)e(t)o(yp)q(es)i(for)g
Fr(meaning)p Fv(:)233 623 y Fr(constype)102 b Fv(Constructor)15
b(of)f(the)g(giv)o(en)g(t)o(yp)q(e.)233 673 y Fr(field)168
b Fv(The)15 b(giv)o(en)e(\014eld.)233 723 y Fr(null)190
b Fv(In)o(teger.)233 773 y Fr(string)146 b Fv(Relo)q(catable)14
b(address)h(\(the)g(v)n(alue)e(of)g(the)i(string)f(is)511
823 y(alw)o(a)o(ys)f Fr("reloc")p Fv(\).)233 877 y Fr(integer)124
b Fv(Extended)16 b(\014eld;)d(the)i(meaning)d(is)h(its)h(width)g(in)f
(bits.)511 926 y(Finding)g(the)i(\014eld)f(requires)h(lo)q(oking)d(up)i
(the)h(input's)511 976 y(name)e(in)g(the)i(global)d(sym)o(b)q(ol)g
(table.)192 1053 y(An)18 b Fr(Operand)f Fv(ma)o(y)f(b)q(e)j(the)g(name)
e(of)h(a)g(sym)o(b)q(ol)f(or)h(the)h(name)e(of)h(a)g(constructor)129
1103 y(t)o(yp)q(e)f(trailed)f(b)o(y)h(zero)g(or)f(more)g(digits)f
(\(e.g.,)h Fr(Address)p Fv(,)f Fr(Address1)p Fv(,)g(etc\).)27
b(Note)16 b(that)129 1153 y(v)n(ariables)f(used)g(as)g(relo)q(catable)h
(addresses)h(liv)o(e)d(in)g(the)i(sym)o(b)q(ol)d(table.)21
b(Finally)m(,)13 b(if)h(not)129 1203 y(recognized,)i(it)f(is)g(treated)
h(as)f(a)g(v)n(ariable.)20 b(Only)15 b(a)g(\014eld)g(ma)o(y)e(b)q(e)j
(sign-extended)g(with)129 1253 y(a)e(bang.)-15 1314 y
Fp(46b)88 b Fo(h)p Fn(*)16 b Fp(31)p Fo(i)o Fv(+)p Fo(\021)1086
b Fm(/)6 b Fp(44b)22 b(47a)5 b Fm(.)171 1364 y Fr(procedure)20
b(name_to_input\(nam)o(e,)f(bang\))215 1414 y(i)i(:=)h(input\(name,)258
1463 y(if)g(name)e(?)i(type\(ct)e(:=)i(symtab[tab\(rever)o(setra)o
(iling)o(\('012)o(34567)o(89_'\))o(\)]\))c(==)k("constype")e(then)302
1513 y(mark_ct_as_used\()o(ct\))258 1563 y(else)h(case)g(type\(x)g(:=)g
(symtab[name]\))e(of)i({)302 1613 y("field")151 b(:)21
b(if)h(/bang)f(then)g(x)g(else)g(fwidth\(x\))302 1663
y("null")173 b(:)21 b({)h Fo(h)p Fn(warn)15 b(if)f(no)h
Fr(bang)f Fp(46c)p Fo(i)o Fr(;)22 b(x)g(})302 1712 y("relocatable")d(:)
i("reloc")302 1762 y("constype")85 b(:)21 b(impossible\("missed)d
(first-round)i(search)h(for)g(constype"\))302 1812 y(default)151
b(:)21 b(typeerror\(x,)f("free)g(variable,)g(field,)h(or)g(constructor)
f(input",)g(name,)868 1862 y(globals\))215 1912 y(}\))215
1961 y(/bang)g(|)i(type\(i.meaning\))d(==)i(\("integer"|"null")o(|"str)
o(ing"\))d(|)258 2011 y(typeerror\(i.meanin)o(g,)h("field)h(or)i
(integer)e(\(to)h(be)h(sign-extended\)",)c(name,)j(globals\))215
2061 y(return)f(i)171 2111 y(end)129 2162 y Fp(De\014nes:)171
2201 y Fl(name_to_in)o(put)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(45c.)
129 2241 y(Uses)k Fl(constructo)o(r)c Fp(159,)i Fl(constype)f
Fp(159,)h Fl(field)g Fp(55,)g Fl(fwidth)f Fp(115d,)h
Fl(globals)f Fp(32a,)h Fl(input)f Fp(46a,)171 2280 y
Fl(mark_ct_as)o(_us)o(ed)g Fp(47e,)i Fl(relocatable)e
Fp(47a,)i Fl(reversetrai)o(lin)o(g)f Fp(48a,)h Fl(symtab)f
Fp(32a)i(367,)171 2320 y(and)d Fl(typeerror)d Fp(28b.)-12
2400 y(46c)89 b Fo(h)p Fn(warn)15 b(if)f(no)i Fr(bang)e
Fp(46c)p Fo(i)o(\021)928 b Fp(\(46b\))171 2449 y Fr(\\bang)21
b(|)171 2499 y(warning\("Use)e(",)j(name,)e("!)i(for)f(signed)g(inputs)
f(---)h(future)g(versions)f(will)h(require)f(it"\))p
eop
%%Page: 47 47
47 46 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(47)208 258 y(Here's)15 b(all)d(the)j(relo)q
(cation)e(go)q(o.)2 320 y Fp(47a)89 b Fo(h)p Fn(*)15
b Fp(31)p Fo(i)p Fv(+)p Fo(\021)1084 b Fm(/)6 b Fp(46b)22
b(47d)5 b Fm(.)187 370 y Fr(record)20 b(relocatable\(\))85
b(#)21 b(type)g(of)h(a)f(name)g(that)g(means)g(relocatable)f(address)
187 420 y(global)g(the_relocatable)41 b(#)21 b(we)h(only)f(need)g
(one...)145 471 y Fp(De\014nes:)187 511 y Fl(relocatabl)o(e)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(29,)h(46,)g(47,)g(81,)f(242b,)g
(and)h(384a.)187 550 y Fl(the_reloca)o(tab)o(le)o Fp(,)e(used)i(in)g(c)
o(h)o(unk)f(47.)145 590 y(Uses)i Fl(address)d Fp(383a.)0
673 y(47b)89 b Fo(h)p Fn(initialization)14 b Fp(38d)p
Fo(i)o Fv(+)q Fo(\021)750 b Fp(\(32b\))22 b Fm(/)6 b
Fp(38d)22 b(53b)5 b Fm(.)187 723 y Fr(the_relocatable)18
b(:=)k(relocatable\(\))145 774 y Fp(Uses)12 b Fl(relocatabl)o(e)d
Fp(47a)i(and)f Fl(the_relocat)o(ab)o(le)f Fp(47a.)4 866
y(47c)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o
Fv(+)p Fo(\021)839 b Fp(\(31\))22 b Fm(/)6 b Fp(45d)22
b(48b)5 b Fm(.)187 916 y Fr(RelocSpec)20 b(:)h("relocatable")e(Ident)i
({Ident})g(/*)g(every)g(make_relocatable)o(\(ii2)d(|)k(!ii3\))f(*/;)145
967 y Fp(Uses)12 b Fl(Ident)e Fp(54c,)h Fl(make_relo)o(cat)o(ab)o(le)e
Fp(47d,)h(and)h Fl(relocatab)o(le)d Fp(47a.)0 1059 y(47d)89
b Fo(h)p Fn(*)15 b Fp(31)p Fo(i)p Fv(+)p Fo(\021)1090
b Fm(/)5 b Fp(47a)23 b(47e)5 b Fm(.)187 1109 y Fr(procedure)20
b(make_relocatable)o(\(name)o(\))230 1158 y(return)h(\(/symtab[name])e
(:=)i(the_relocatable\))e(|)i(deferror\("Relocatab)o(le)e(name",)h
(image\(name\)\))187 1208 y(end)145 1260 y Fp(De\014nes:)187
1300 y Fl(make_reloc)o(ata)o(bl)o(e)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)
f(47c.)145 1339 y(Uses)i Fl(deferror)d Fp(28a,)h Fl(symtab)g
Fp(32a)h(367,)f(and)h Fl(the_reloca)o(tab)o(le)d Fp(47a.)208
1410 y Fv(A)14 b(constructor)h(t)o(yp)q(e)f(is)g(mark)o(ed)f(when)h(it)
g(is)g(\014rst)g(used)h(as)f(an)g(input.)4 1472 y Fp(47e)89
b Fo(h)p Fn(*)15 b Fp(31)p Fo(i)p Fv(+)p Fo(\021)1084
b Fm(/)6 b Fp(47d)22 b(50b)5 b Fm(.)187 1522 y Fr(procedure)20
b(mark_ct_as_used\()o(type\))230 1571 y(if)i(/type.used)d(:=)j(lineno)e
(then)274 1621 y({)p Fo(h)p Fn(sort)14 b(memb)n(ers)h(of)f(typ)n(e)h
Fp(47f)s Fo(i)o Fr(})230 1671 y(return)21 b(type)187
1721 y(end)145 1773 y Fp(De\014nes:)187 1812 y Fl(mark_ct_as)o(_us)o
(ed)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(46b.)145 1852
y(Uses)i Fl(used)e Fp(136a.)9 1935 y(47f)89 b Fo(h)p
Fn(sort)15 b(memb)n(ers)f(of)h(typ)n(e)g Fp(47f)s Fo(i)o(\021)848
b Fp(\(47e\))187 1985 y Fr(t)21 b(:=)h(table\(\))187
2034 y(every)f(m)g(:=)h(!type.members)d(do)230 2084 y(t[m.name])h(:=)i
(m)187 2134 y(t)f(:=)h(sort\(t\))187 2184 y(type.members)d(:=)i([])187
2234 y(every)g(put\(type.member)o(s,)e(\(!t\)[2]\))p
eop
%%Page: 48 48
48 47 bop 129 141 a Fv(48)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y Fr(reversetrailing\()o(c\))h
Fv(generates,)20 b(from)c(righ)o(t)h(to)g(left,)h(the)g(p)q(ositions)f
(at)h(whic)o(h)129 307 y(the)d(rest)g(of)e(the)i(sub)r(ject)g(is)f
(comp)q(osed)f(en)o(tirely)h(of)g(c)o(haracters)h(from)d
Fr(c)p Fv(.)-13 370 y Fp(48a)88 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o Fv(+)q Fo(\021)868 b Fp(\(31\))22 b
Fm(/)6 b Fp(46a)22 b(49b)5 b Fm(.)171 420 y Fr(procedure)20
b(reversetrailing\(c)o(\))215 469 y(local)g(i)215 519
y(suspend)g(*&subject)g(+)h(1)215 569 y(i)g(:=)h(*&subject)215
619 y(while)e(any\(c,)h(&subject,)f(0)h(<)h(i\))f(do)h({)f(suspend)g
(i;)g(i)h(-:=)f(1)g(})171 669 y(end)129 720 y Fp(De\014nes:)171
760 y Fl(reversetra)o(ili)o(ng)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f
(46b.)129 889 y Ft(3.5.1)56 b(Deleting)17 b(constructors)129
965 y Fv(F)m(or)i(tests,)h(or)f(for)f(other)i(purp)q(oses,)g(w)o(e)f
(ma)o(y)e(w)o(an)o(t)h(to)h(delete)g(constructors)i(from)c(a)129
1015 y(sp)q(eci\014cation.)24 b(There)16 b(are)g(t)o(w)o(o)f(w)o(a)o
(ys:)21 b(sa)o(y)15 b(what)g(w)o(e)h(w)o(an)o(t)f(to)g(k)o(eep,)h(or)g
(sa)o(y)f(what)g(w)o(e)129 1065 y(w)o(an)o(t)f(to)g(thro)o(w)g(a)o(w)o
(a)o(y)m(.)-15 1127 y Fp(48b)88 b Fo(h)p Fn(gr)n(ammar)15
b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)847 b Fp(\(31\))22 b
Fm(/)6 b Fp(47c)22 b(48c)5 b Fm(.)171 1177 y Fr(Constructors)19
b(:)j("discard")e({Opcode})g(/*)h(every)g(discard_cons_named)o(\(expl)o
(ode_)o(names)o(\(!ii2)o(\)\))e(*/)454 1227 y(|)j("keep")86
b({Opcode})563 1277 y(/*)22 b(s)f(:=)h(set\(\))629 1326
y(every)e(insert\(s,)g(is_constructor\(expl)o(ode_n)o(ames\()o(!ii2)o
(\),)f(warning\)\))629 1376 y(every)h(k)i(:=)f(key\(constructors\))e
(do)672 1426 y(if)j(not)f(member\(s,)f(constructors[k]\))e(then)716
1476 y(delete\(construct)o(ors,)g(k\))585 1526 y(*/)454
1575 y(;)129 1627 y Fp(Uses)g Fl(construct)o(ors)13 b
Fp(32a,)j Fl(discard_con)o(s_n)o(am)o(ed)e Fp(167b,)h
Fl(explode_nam)o(es)f Fp(163b,)171 1667 y(and)d Fl(is_constr)o(uct)o
(or)d Fp(167a.)129 1816 y Fj(3.6)67 b(Equations)129 1907
y Fv(Extensions)12 b(and)e(ranges)h(are)g(guaran)o(teed)h(unique)e
(within)g(a)g(set)i(of)e(equations,)h(and)f(they)129
1957 y(are)18 b(reset)h(b)q(efore)f(eac)o(h)g(set)g(of)f(equations.)28
b(The)18 b(grammar)c(is)j(bit)g(a)o(wkw)o(ard)g(b)q(ecause)129
2007 y(w)o(e're)e(trying)e(to)h(k)o(eep)h(it)e(LL\(1\).)-12
2069 y Fp(48c)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)841 b Fp(\(31\))22 b Fm(/)6 b Fp(48b)22
b(49a)5 b Fm(.)171 2119 y Fr(Equations)20 b(:)h([Equation)f({)i(",")f
(Equation)f(})i(/*)f(push\(ii2,)f(ii1\))h(*/])g(/*)h(\\ii1)f(|)g([])h
(*/)f(;)171 2169 y(Equation)42 b(:)21 b(Expr)g(Relop)g(Expr)g(/*)h
(eqn\(ii1,)e(ii2,)h(ii3\))g(*/)g(;)129 2221 y Fp(Uses)12
b Fl(eqn)f Fp(83c.)p eop
%%Page: 49 49
49 48 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(49)208 258 y(Applications)13
b(are)h(forbidden)g(in)f(expressions)j(except)f(in)e(sp)q(ecial)i(con)o
(texts.)2 320 y Fp(49a)89 b Fo(h)p Fn(gr)n(ammar)15 b
Fp(34a)p Fo(i)o Fv(+)p Fo(\021)847 b Fp(\(31\))22 b Fm(/)5
b Fp(48c)23 b(49c)5 b Fm(.)187 370 y Fr(Expr)130 b(:)21
b(AppExpr)g(/*)g(if)g(has_app_or_literal\()o(ii1\))d(then)732
420 y(error\("Applicati)o(on)h(or)i(literal)f(string)h(not)g(legal"\))
688 469 y(else)g(ii1)g(*/)405 519 y(;)145 571 y Fp(Uses)12
b Fl(has_app_or)o(_li)o(ter)o(al)c Fp(49b)j(and)g Fl(literal)e
Fp(45e.)0 654 y(49b)89 b Fo(h)p Fn(toplevel)15 b Fp(32a)p
Fo(i)o Fv(+)p Fo(\021)871 b Fp(\(31\))22 b Fm(/)6 b Fp(48a)22
b(50a)5 b Fm(.)187 704 y Fr(procedure)20 b(has_app_or_liter)o(al_f\()o
(e\))230 754 y(return)h(type\(e\))f(==)i(\("Eapp"|"literal)o("\))187
804 y(end)187 903 y(procedure)e(has_app_or_liter)o(al\(e\))230
953 y(suspend)h(expwalk\(e,)e(has_app_or_literal_f)o(\))187
1003 y(end)145 1055 y Fp(De\014nes:)187 1094 y Fl(has_app_or)o(_li)o
(te)o(ral)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(49a.)145
1134 y(Uses)i Fl(Eapp)e Fp(81,)h Fl(expwalk)e Fp(117a,)i(and)f
Fl(literal)f Fp(45e.)4 1225 y(49c)89 b Fo(h)p Fn(gr)n(ammar)15
b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)843 b Fp(\(31\))22 b
Fm(/)6 b Fp(49a)22 b(51a)5 b Fm(.)187 1275 y Fr(AppExpr)64
b(:)21 b(Term)g({)h(AOp)f(Term)g(})448 1324 y(/*)h(every)e(t)i(:=)f
(!ii2)g(do)h(ii1)f(:=)g(binop\(ii1,)f(t[1],)h(t[2]\);)f(ii1)i(*/)f(;)
187 1374 y(Term)130 b(:)21 b(Factor)g({)g(Mop)h(Factor)e(})448
1424 y(/*)i(every)e(f)i(:=)f(!ii2)g(do)h(ii1)f(:=)g(binop\(ii1,)f
(f[1],)h(f[2]\);)f(ii1)i(*/)f(;)187 1474 y(AOp)152 b(:)21
b("+")g(|)h("-")f(;)187 1524 y(Mop)152 b(:)21 b("*")g(|)h("/")f(;)187
1574 y(Factor)86 b(:)21 b(Integer)405 1623 y(|)g(String)g(/*)g
(literal\(ii1\))f(*/)65 b(#)21 b(legal)g(only)g(in)g(constructor)f
(apps)405 1673 y(|)h("_")g(/*)h(fresh_variable\("_)o("\))d(*/)405
1723 y(|)i(IDENT)g(\()h([)f(Bitrange)f(])i([)g("!")f(])217
b(/*)22 b(SyntaxRange\(ii1,)c(ii2\))j(*/)579 1773 y(|)h("\(")f(Args)g
("\)")579 1823 y(\))470 1872 y(/*)g Fo(h)p Fn(note)16
b(new)f(op)n(er)n(and)g(or)g(id)g Fr(ii1)f Fp(33b)p Fo(i)535
1922 y Fr(if)22 b(type\(ii2\))e(==)h("SyntaxRange")e(then)i
(mkfactor\(ii1,)e(ii2.bits,)h(ii2.bang\))535 1972 y(else)h(Eapp\(ii1,)f
(ii2\))h(*/)405 2022 y(|)g("\(")g(AppExpr)g("\)")405
2072 y(|)g("-")g(Factor)g(/*)g(binop\(0,)g(ii1,)g(ii2\))f(*/)405
2121 y(;)187 2171 y(Bitrange)42 b(:)21 b("@")g("[")h(INT)f([":")g(INT)g
(/*ii2*/])f("]")h(/*)h([ii3,)e(\(\\ii4|ii3\)+1])g(*/)h(;)187
2221 y(Args)130 b(:)21 b(AppExpr)g({",")g(AppExpr})f(/*)h(push\(ii2,)f
(ii1\))h(*/)405 2271 y(|)g(/*)h([])f(*/)405 2321 y(;)145
2373 y Fp(Uses)13 b Fl(binop)e Fp(113a,)g Fl(construct)o(or)e
Fp(159,)j Fl(Eapp)f Fp(81,)g Fl(fresh_variab)o(le)e Fp(155b,)i
Fl(IDENT)g Fp(54b)g(359b)g(360b,)187 2412 y Fl(INT)f
Fp(54b)h(359b,)f Fl(literal)f Fp(45e,)i Fl(mkfactor)e
Fp(50b,)h Fl(String)g Fp(54c,)h(and)f Fl(SyntaxRange)e
Fp(50a.)p eop
%%Page: 50 50
50 49 bop 129 141 a Fv(50)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y(Can't)g(use)g(a)g(square-brac)o(k)o(et)h
(syn)o(tax)f(for)f(bit)h(ranges)g(b)q(ecause)i(it)d(creates)j(parsing)d
(con-)129 307 y(\015ict)k(with)f(list)g(of)g(names)f(on)i(left-hand)f
(side)g(of)g(pattern)h(binding,)f(list)g(of)f(patterns)j(in)129
357 y(square)e(brac)o(k)o(ets,)g(and)e(optional)g(name)f(in)i(arm)e(of)
i(case)g(statemen)o(t.)-13 420 y Fp(50a)88 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o Fv(+)q Fo(\021)870 b Fp(\(31\))22 b
Fm(/)6 b Fp(49b)22 b(50c)5 b Fm(.)171 469 y Fr(record)21
b(SyntaxRange\(bit)o(s,)e(bang\))129 521 y Fp(De\014nes:)171
561 y Fl(SyntaxRang)o(e)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(49c.)-15
644 y(50b)88 b Fo(h)p Fn(*)16 b Fp(31)p Fo(i)o Fv(+)p
Fo(\021)1090 b Fm(/)6 b Fp(47e)22 b(52a)5 b Fm(.)171
694 y Fr(procedure)20 b(mkfactor\(ident,)f(range,)h(ext\))215
743 y(e)h(:=)h(ident)215 793 y(if)f(\\range)f(then)h({)258
843 y(e)h(:=)f(mkslice\(e,)f(range[1],)g(range[2]\))258
893 y(w)i(:=)f(e.n)215 943 y(})215 992 y(if)g(\\ext)g(then)g({)258
1042 y(/w)h(:=)f(if)g(type\(f)g(:=)g(symtab[ident]\))e(==)i("field")g
(then)g(fwidth\(f\))389 1092 y(else)g(error\("Can't)e(sign-extend)h(",)
h(ident,)g(")g(\(not)g(a)h(field\)"\))258 1142 y(e)g(:=)f(Ewiden\(e,)f
(w\))215 1192 y(})215 1241 y(return)g(e)171 1291 y(end)129
1343 y Fp(De\014nes:)171 1383 y Fl(mkfactor)p Fp(,)9
b(used)h(in)h(c)o(h)o(unk)f(49c.)129 1422 y(Uses)i Fl(Ewiden)e
Fp(81,)h Fl(field)f Fp(55,)g Fl(fwidth)g Fp(115d,)g Fl(mkslice)f
Fp(115a,)i(and)f Fl(symtab)g Fp(32a)g(367.)129 1580 y
Fj(3.7)67 b(Co)r(de)21 b(con)n(taining)j(matc)n(hing)f(statemen)n(ts)
129 1671 y Fv(Using)15 b(the)g(global)e(v)n(alue)h Fr(succptr)g
Fv(is)g(OK)h(for)g(no)o(w,)f(but)h(it)f(will)f(break)i(horribly)f(if)g
(w)o(e)129 1721 y(ev)o(er)h(p)q(ermit)e(nested)j(matc)o(hing)c
(statemen)o(ts.)-12 1783 y Fp(50c)89 b Fo(h)p Fn(toplevel)15
b Fp(32a)p Fo(i)o Fv(+)q Fo(\021)970 b Fp(\(31\))22 b
Fm(/)6 b Fp(50a)171 1833 y Fr(global)21 b(matching_stmts,)d(codeheader)
129 1885 y Fp(De\014nes:)171 1924 y Fl(codeheader)o Fp(,)9
b(used)i(in)g(c)o(h)o(unks)f(21a)g(and)h(51a.)171 1964
y Fl(matching_s)o(tmt)o(s)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f(21a)h
(and)f(51a.)p eop
%%Page: 51 51
51 50 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(51)2 258 y Fp(51a)89 b Fo(h)p
Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)843
b Fp(\(31\))22 b Fm(/)6 b Fp(49c)22 b(51b)5 b Fm(.)187
307 y Fr(CodeFile)129 b(:)21 b(\(/*codeheader)f(:=)h(arm\(filename,)e
(lineno\)*/\))535 357 y(\({CODELINE})h(/*)h(codeheader.code)e(:=)i(ii1)
h(*/\))535 407 y({)g(Casestmt)e({CODELINE})g(/*)h(ii1.trailer.code)e
(:=)i(ii2)g(;)h(ii1)f(*/)g(})535 457 y(/*)h(codeheader.origin)o(al)d
(:=)i(codeheader;)f(matching_stmts)f(:=)i(ii3)g(*/;)187
507 y(Casestmt)129 b(:)21 b(CASELINE)g({)g(Casearm)g(})g([ElseArm])f
("endmatch")514 557 y(/*)h(x)h(:=)f(matching_stmt\(ii2,)d(ii1,)j
(succptr\))f(;)i(put\(x.arms,)d(\\ii3\))579 606 y(x.trailer)h(:=)h
(arm\(filename,)e(lineno\);)i(x)g(*/)492 656 y(;)187
706 y(Casearm)151 b(:)21 b(\("|")g(/*arm\(filename,)e(lineno\))h(*/\))
535 756 y(Pattern)h(OptEquations)e(OptName)h("=>")h({CODELINE})535
806 y(/*)h(ii1.pattern)d(:=)j(ii2;)f(ii1.eqns)f(:=)h(ii3;)g(ii1.name)f
(:=)i(ii4;)f(ii1.code)f(:=)h(ii6)601 855 y(ii1.original)e(:=)j(ii1)f
(*/;)64 b(#)22 b(value)f(is)g(ii1)187 905 y(ElseArm)151
b(:)21 b(\("else")239 b(/*)21 b(arm\(filename,)e(lineno,)i
(epsilon\(\)\))e(*/\))i({CODELINE})535 955 y(/*)h(ii1.code)e(:=)h(ii2;)
g(ii1.original)f(:=)h(ii1)g(*/)h(;)187 1005 y(OptName)151
b(:)21 b([)h("[")f(Ident)g("]")g(];)187 1055 y(OptEquations)41
b(:)21 b([)h("{")f(Equations)f("}")h(];)145 1107 y Fp(Uses)14
b Fl(arm)e Fp(271b,)g Fl(CASELINE)e Fp(54b)j(359b,)e
Fl(codeheader)f Fp(50c,)i Fl(CODELINE)f Fp(54b)h(359b,)g
Fl(epsilon)f Fp(62b,)187 1146 y Fl(Ident)h Fp(54c,)h
Fl(matching_s)o(tmt)e Fp(271b,)h Fl(matching_s)o(tmt)o(s)f
Fp(50c,)i Fl(pattern)f Fp(55,)h Fl(succptr)e Fp(360b,)187
1185 y(and)f Fl(value)g Fp(136a.)145 1343 y Fj(3.8)66
b(Sp)r(eci\014cations)24 b(for)e(fetc)n(hing)h(w)n(ords)145
1434 y Fv(I)17 b(in)o(tro)q(duce)h(the)f(non)o(terminal)e
Fr(Address)g Fv(in)i(order)g(to)g(a)o(v)o(oid)f(making)e
Fr(address)h Fv(a)i(re-)145 1484 y(serv)o(ed)e(w)o(ord.)0
1546 y Fp(51b)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)845 b Fp(\(31\))22 b Fm(/)5 b Fp(51a)23
b(52c)5 b Fm(.)187 1596 y Fr(FetchSpec)20 b(:)h("fetch")g(\()g(INT)65
b("using")20 b(String)h(/*)g(newfetch\(ii1,)e(ii3,)i('a'\))g(*/)623
1646 y(|)g("any")g("using")f(String)h(/*)g(newfetch\(ii1,)e(ii3,)i
('aw'\))g(*/)623 1696 y(\))405 1746 y(|)g("address")f(\(Add)h("using")g
(String)216 b(/*)22 b(newfetch\(ii1,)d(ii3,)i('ao'\))f(*/)666
1796 y(|)i("type")e("is")h(String)195 b(/*)22 b(newfetch\(ii1,)d(ii3,)i
(''\))g(*/)666 1845 y(|)h("to")f(IntIdent)f("using")g(String)108
b(/*)21 b(newfetch\(ii2,)e(ii4,)i('a'\))g(*/)666 1895
y(\))405 1945 y(;)187 2045 y(Add)130 b(:)22 b(Ident)e(/*)i(\(ii1)f(==)g
("add"\))g(|)g(error\("expected)e(`add',)h(`type',)h(or)g(`to'"\))g
(*/;)187 2094 y(IntIdent)f(:)i(Ident)e(/*)i(\(ii1)f(==)g("integer"\))f
(|)h(error\("expected",)e(image\("integer")o(\)\))g(*/;)145
2146 y Fp(Uses)12 b Fl(address)d Fp(383a,)h Fl(Ident)g
Fp(54c,)h Fl(INT)g Fp(54b)f(359b,)g Fl(newfetch)f Fp(52a,)i(and)f
Fl(String)g Fp(54c.)p eop
%%Page: 52 52
52 51 bop 129 141 a Fv(52)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-13 258 y Fp(52a)88 b Fo(h)p Fn(*)16
b Fp(31)p Fo(i)o Fv(+)p Fo(\021)1086 b Fm(/)6 b Fp(50b)22
b(53a)5 b Fm(.)171 307 y Fr(procedure)20 b(newfetch\(k,)f(template,)h
(expected\))215 357 y Fo(h)p Fn(issue)15 b(warnings)f(for)h(chars)f(in)
h Fr(expected)e Fn(not)j(in)f Fr(template)e Fp(52b)p
Fo(i)215 407 y Fr(return)20 b(fetchtab[k])g(:=)h(template)171
457 y(end)129 509 y Fp(De\014nes:)171 548 y Fl(newfetch)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(51b.)129 588 y(Uses)i
Fl(fetchtab)d Fp(295a.)192 658 y Fv(This)k(w)o(arning)h(ma)o(y)e(help)h
(p)q(eople)i(who)e(are)i(h)o(ung)e(up)h(on)g(left-to-righ)o(t.)-1773
b Fk(\031Change)13 b(#44)-15 720 y Fp(52b)88 b Fo(h)p
Fn(issue)15 b(warnings)g(for)f(chars)h(in)g Fr(expected)e
Fn(not)j(in)f Fr(template)e Fp(52b)p Fo(i)o(\021)222
b Fp(\(52a\))171 770 y Fr(c)22 b(:=)f('')171 820 y(template)f(?)i
(while)e(tab\(upto\('\045'\)\))f(&)j(="\045")f(do)g(c)h(:=)f(c)h(++)f
(move\(1\))171 870 y(every)g(x)g(:=)h(!\(expected)d(--)j(c\))f(do)215
920 y(warning\("expect)o(ed)e(\045",)i(x,)g(")h(in)f(template"\))129
1069 y Fj(3.9)67 b(Assem)n(bly)22 b(syn)n(tax)-12 1160
y Fp(52c)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o
Fv(+)p Fo(\021)839 b Fp(\(31\))22 b Fm(/)6 b Fp(51b)22
b(52d)5 b Fm(.)171 1210 y Fr(AsmSpec)20 b(:)i("assembly")236
1260 y(\()g("operand")e({IdentBinding)f("is")i(OperandSyntaxSpec)890
1310 y(/*)h(every)e(asmoperand\(!ii1,)f(ii3[1],)h(ii3[2]\))g(*/})236
1360 y(|)i("component")41 b({Globbing)20 b("is")h(GlobTarget)42
b(/*)21 b(asmopcode)f(\(ii1,)h(ii3\))g(*/})236 1409 y(|)h("opcode")42
b({Globbing)20 b("is")h(GlobTarget)41 b(/*)22 b(asmopcode)e(\(ii1,)g
(ii3,)h(1\))h(*/})236 1459 y(|)g("syntax")42 b(\(/*see_newline\(\)*)o
(/\))19 b({)i(AsmSyntax)f(/*)i(see_newline\(\))d(*/})236
1509 y(\);)129 1561 y Fp(Uses)12 b Fl(asmopcode)d Fp(239a,)h
Fl(asmoperand)e Fp(241b,)i Fl(IdentBindin)o(g)f Fp(37c,)h(and)h
Fl(see_newlin)o(e)e Fp(362a.)-15 1652 y(52d)88 b Fo(h)p
Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)847
b Fp(\(31\))22 b Fm(/)6 b Fp(52c)22 b(52e)5 b Fm(.)171
1702 y Fr(OperandSyntaxSpec)18 b(:)k(String)e(["using")h
(OperandNameSpec)d(])k(/*)f([ii1,)g(ii2])g(*/)563 1752
y(|)h(OperandNameSpec)d(/*)i(["\045s",)f(ii1])h(*/)563
1802 y(;)171 1852 y(OperandNameSpec)62 b(:)22 b(NameTable)563
1901 y(|)g("field")e(Ident)h(/*)g(lookuptype\(ii2,)e("field"\))h(*/)563
1951 y(;)129 2003 y Fp(Uses)12 b Fl(field)e Fp(55,)h
Fl(Ident)f Fp(54c,)g Fl(lookuptype)f Fp(25a,)h(and)h
Fl(String)e Fp(54c.)-12 2094 y(52e)89 b Fo(h)p Fn(gr)n(ammar)15
b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)843 b Fp(\(31\))22 b
Fm(/)6 b Fp(52d)22 b(53c)5 b Fm(.)171 2144 y Fr(AsmSyntax:)20
b(Opcode)g(Operands)g(NEWLINE)498 2194 y(/*)h(every)g
(set_asmsyntax\(is_)o(const)o(ructo)o(r\(exp)o(lode_)o(names)o(\(ii1)o
(\),)e(warning\),)h(ii2\))h(*/;)129 2246 y Fp(Uses)10
b Fl(explode_na)o(mes)c Fp(163b,)i Fl(is_constru)o(cto)o(r)e
Fp(167a,)i Fl(NEWLINE)f Fp(54b)i(359b,)f(and)g Fl(set_asmsynt)o(ax)e
Fp(243a.)p eop
%%Page: 53 53
53 52 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)743
b Fr(grammar.nw)81 b Fv(53)145 258 y Ft(3.9.1)56 b(Globbing)18
b(expressions)145 334 y Fv(A)c(globbing)e(expression)j(is)f(a)f
(string,)g(a)h(list)f(\(concatenation\),)h(a)f(wildcard,)g(or)g(a)h
(list)f(of)145 384 y(alternativ)o(es)h(in)g(braces.)2
446 y Fp(53a)89 b Fo(h)p Fn(*)15 b Fp(31)p Fo(i)p Fv(+)p
Fo(\021)1088 b Fm(/)6 b Fp(52a)22 b(54a)5 b Fm(.)187
496 y Fr(record)20 b(glob_any\(alternativ)o(es,)f(number\))64
b(#)21 b(braced)g(list)g(of)g(alternate)f(globbing)g(patterns)187
546 y(record)g(glob_wildcard\(\))187 596 y(global)g(the_glob_wildcard)
346 b(#)21 b(only)g(need)g(one)g(value)187 646 y(record)f
(glob_dollar\(number\))302 b(#)21 b($n)g(on)h(right-hand)e(side)145
697 y Fp(De\014nes:)187 737 y Fl(glob_any)p Fp(,)9 b(used)h(in)h(c)o(h)
o(unks)f(53c,)h(239c,)f(and)g(240b.)187 776 y Fl(glob_dolla)o(r)p
Fp(,)e(used)j(in)g(c)o(h)o(unks)f(53d,)g(240c,)h(and)f(241a.)187
816 y Fl(glob_wildc)o(ard)o Fp(,)f(used)h(in)h(c)o(h)o(unks)f(53b,)h
(239c,)f(and)h(240b.)187 855 y Fl(the_glob_w)o(ild)o(ca)o(rd)p
Fp(,)d(used)j(in)g(c)o(h)o(unk)f(53.)145 895 y(Uses)i
Fl(value)e Fp(136a.)0 978 y(53b)89 b Fo(h)p Fn(initialization)14
b Fp(38d)p Fo(i)o Fv(+)q Fo(\021)852 b Fp(\(32b\))22
b Fm(/)6 b Fp(47b)187 1028 y Fr(the_glob_wildcar)o(d)19
b(:=)i(glob_wildcard\(\))145 1079 y Fp(Uses)12 b Fl(glob_wildc)o(ard)c
Fp(53a)j(and)f Fl(the_glob_wi)o(ldc)o(ard)e Fp(53a.)4
1171 y(53c)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o
Fv(+)p Fo(\021)843 b Fp(\(31\))22 b Fm(/)6 b Fp(52e)22
b(53d)5 b Fm(.)187 1221 y Fr(Globbing)194 b(:)22 b(SeeWhite)e
(GlobPattern)g(StopWhite)f(White)i(/*)h(ii2)f(*/;)187
1270 y(GlobPattern)128 b(:)22 b({GlobAlternatives)c(|)k(Literal)e(|)i
(Ident})753 1320 y(/*)g(number_braces\(ca)o(t_adj)o(acent)o(_stri)o
(ngs\(i)o(i1\)\))c(*/;)187 1370 y(GlobAlternatives)g(:)k("{")f
(GlobPattern)f({",")h(GlobPattern)e(})j("}")f(/*)g
(glob_any\(push\(ii3,)d(ii2\)\)*/)557 1420 y(|)k("*")784
b(/*)21 b(the_glob_wildcard)d(*/)557 1470 y(;)145 1521
y Fp(Uses)d Fl(cat_adjacen)o(t_s)o(tr)o(ing)o(s)d Fp(54a,)i
Fl(glob_any)e Fp(53a,)h Fl(Ident)h Fp(54c,)f Fl(number_brac)o(es)f
Fp(240b,)187 1561 y(and)e Fl(the_glob_wi)o(ldc)o(ard)e
Fp(53a.)0 1652 y(53d)89 b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p
Fo(i)o Fv(+)p Fo(\021)847 b Fp(\(31\))22 b Fm(/)5 b Fp(53c)23
b(54c)5 b Fm(.)187 1702 y Fr(GlobTarget)150 b(:)22 b(SeeWhite)e
(GlobTargets)g(StopWhite)f(White)i(/*)h(ii2)f(*/;)187
1752 y(GlobTargets)128 b(:)22 b({GlobTargetSpecia)o(l)d(|)j
(GlobTargetLiter)o(al})1233 1802 y(/*)f(cat_adjacent_string)o(s\(ii)o
(1\))e(*/;)187 1851 y(GlobTargetSpecia)o(l:)g("$")i(\(Integer)f(/*)i
(glob_dollar\(ii1)o(\))d(*/)i(|)h("$"\))557 1901 y(;)187
1951 y(GlobTargetLitera)o(l:)d(Literal)h(|)i(Ident)f(|)g("*")g(|)h("{")
f(|)h("}")f(|)g(",")h(;)145 2003 y Fp(Uses)12 b Fl(cat_adjace)o(nt_)o
(str)o(ing)o(s)d Fp(54a,)h Fl(glob_dollar)e Fp(53a,)i(and)h
Fl(Ident)f Fp(54c.)p eop
%%Page: 54 54
54 53 bop 129 141 a Fv(54)83 b Fr(grammar.nw)742 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-13 258 y Fp(54a)88 b Fo(h)p Fn(*)16
b Fp(31)p Fo(i)o Fv(+)p Fo(\021)1188 b Fm(/)6 b Fp(53a)171
307 y Fr(procedure)20 b(cat_adjacent_stri)o(ngs\(l)o(\))215
357 y(m)h(:=)h([])215 407 y(every)e(x)i(:=)f(!l)h(do)258
457 y(if)g(type\(x\))e(==)h("string")f(&)i(type\(m[-1]\))d(==)j
("string")e(then)302 507 y(m[-1])g(||:=)h(x)258 557 y(else)302
606 y(put\(m,)f(x\))215 656 y(return)g(m)171 706 y(end)129
758 y Fp(De\014nes:)171 797 y Fl(cat_adjace)o(nt_)o(str)o(ing)o(s)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(53.)129 955 y Fj(3.10)66
b(Lexical)24 b(elemen)n(ts)-15 1046 y Fp(54b)88 b Fo(h)p
Fn(terminal)15 b(symb)n(ols)f Fp(54b)p Fo(i)o(\021)932
b Fp(\(31\))171 1096 y Fr(\045term)21 b(IDENT)171 1146
y(\045term)g(INT)171 1196 y(\045term)g(CASELINE)171 1245
y(\045term)g(CODELINE)171 1295 y(\045term)g(NEWLINE)171
1345 y(\045term)g(WHITESPACE)129 1397 y Fp(De\014nes:)171
1436 y Fl(CASELINE)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(51a,)h(360a,)f
(and)g(361a.)171 1476 y Fl(CODELINE)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f
(51a,)h(360,)f(and)h(361.)171 1515 y Fl(IDENT)p Fp(,)f(used)g(in)h(c)o
(h)o(unks)f(49c,)h(54c,)f(360a,)g(362a,)h(and)f(363a.)171
1555 y Fl(INT)p Fp(,)g(used)h(in)g(c)o(h)o(unks)f(34{36,)g(38b,)g(41c,)
h(49c,)f(51b,)h(54c,)f(360a,)g(and)h(363a.)171 1594 y
Fl(NEWLINE)p Fp(,)e(used)i(in)g(c)o(h)o(unks)f(45a,)g(52e,)h(360a,)f
(and)g(362a.)171 1634 y Fl(WHITESPACE)o Fp(,)f(used)i(in)g(c)o(h)o
(unks)f(54c,)g(360a,)g(and)h(362b.)-12 1725 y(54c)89
b Fo(h)p Fn(gr)n(ammar)15 b Fp(34a)p Fo(i)o Fv(+)p Fo(\021)941
b Fp(\(31\))22 b Fm(/)6 b Fp(53d)171 1775 y Fr(Ident)108
b(:)21 b(IDENT)g(|)h("_")f(;)171 1825 y(String)86 b(:)21
b('"')h(;)171 1874 y(Integer)64 b(:)21 b(INT)h(|)f("'")g(/*)h
(ord\(ii1\))e(*/)h(;)171 1924 y(White)108 b(:)21 b(WHITESPACE;)171
1974 y(SeeWhite)42 b(:)21 b(/*)h(see_whitespace\(\))c(*/;)171
2024 y(StopWhite)i(:)h(/*)h(ignore_whitespace)o(\(\))d(*/;)129
2076 y Fp(De\014nes:)171 2115 y Fl(Ident)p Fp(,)10 b(used)g(in)h(c)o(h)
o(unks)f(35{39,)g(42a,)h(45,)f(47c,)h(and)g(51{53.)171
2155 y Fl(String)p Fp(,)e(used)i(in)g(c)o(h)o(unks)f(37{39,)g(45,)h
(49c,)f(51b,)h(and)f(52d.)129 2194 y(Uses)j Fl(IDENT)d
Fp(54b)h(359b)g(360b,)g Fl(ignore_whi)o(tes)o(pa)o(ce)e
Fp(362b,)i Fl(INT)g Fp(54b)g(359b,)g Fl(see_white)o(spa)o(ce)e
Fp(362b,)171 2233 y(and)i Fl(WHITESPAC)o(E)e Fp(54b)h(359b.)p
eop
%%Page: 55 55
55 54 bop 145 569 a Fq(Chapter)32 b(4)145 777 y Fu(P)m(atterns)145
1017 y Fj(4.1)66 b(Seman)n(tics,)23 b(constructors,)f(and)h(m)n
(utators)145 1108 y Fv(P)o(atterns)17 b(are)g(built)e(up)g(from)g
Fn(c)n(onstr)n(aints)g Fv(b)o(y)h(applying)e Fr(;)p Fv(,)i
Fr(&)f Fv(and)h Fr(|)f Fv(\(sequence,)j(con-)145 1158
y(junction)f(and)f(disjunction\),)h(and)f(are)h(represen)o(ted)j(in)c
(disjunctiv)o(e)g(normal)f(form.)24 b(A)145 1208 y(constrain)o(t)16
b(restricts)h(a)e(\014eld's)g(v)n(alue)f(to)h(b)q(e)h(within)e(a)h
(certain)h(in)o(terv)n(al:)k Fi(l)q(o)13 b Fo(\024)h
Fi(f)19 b(<)14 b(hi)p Fv(.)145 1258 y(P)o(atterns)f(consisting)e
(solely)g(of)g(constrain)o(ts)h(are)g(created)g(with)f
Fr(conspat)p Fv(,)f(whic)o(h)h(relates)145 1307 y(a)h(\014eld)g(to)g(a)
g(v)n(alue.)17 b(The)12 b(only)g(relational)f(op)q(erators)i(no)o(w)e
(supp)q(orted)j(are)e(equalit)o(y)g(and)145 1357 y(inequalit)o(y)m(,)g
(but)i(others)h(could)f(easily)f(b)q(e)h(added)h(b)o(y)e(adding)g
(cases)j(to)d Fr(conspat)p Fv(.)208 1407 y(A)e(\014eld)h
Fr(f)f Fv(is)g(that)h(part)f(of)g(a)h(w)o(ord)f(from)f(bits)h
Fr(f.lo)g Fv(through)g(bits)h Fr(f.hi-1)e Fv(inclusiv)o(e.)145
1457 y(Notice)16 b(that)g(this)g(is)f Fn(not)h Fv(the)g(syn)o(tax)g
(used)g(in)g(the)g(input,)f(whic)o(h)h(is)f(lik)o(e)g(what's)g(used)145
1507 y(in)f(arc)o(hitecture)h(man)o(uals.)208 1557 y(If)9
b(a)h(pattern)h(con)o(tains)g(\014eld)f(bindings)g(with)g(free)h(v)n
(ariables,)e(it)h(ma)o(y)f(ha)o(v)o(e)h(conditions)145
1606 y(attac)o(hed)20 b(to)e(its)h(disjuncts.)34 b(A)19
b(condition)f(is)h(an)f(expression)i(o)o(v)o(er)f(those)h(same)e(free)
145 1656 y(v)n(ariables.)20 1718 y Fp(55)89 b Fo(h)p
Fn(*)15 b Fp(55)p Fo(i\021)1238 b Fp(56)5 b Fm(.)187
1768 y Fr(record)20 b(field\(name,)g(lo,)h(hi,)g(class\))152
b(#)21 b(field)g(is)g(bits)g(lo..hi-1)f(\(note)h(NOT)g(like)g(input\))
187 1818 y(record)f(equivclass\(name,)f(fields,)h(size,)h(holder\))64
b(#)21 b(equivalence)f(class)h(of)g(fields)187 1918 y(record)f
(pattern\(disjuncts,)e(name\))304 b(#)22 b(list)f(of)g(disjuncts,)f
(name)h(of)g(pattern)187 1967 y(record)f(disjunct\(sequents,)e(name,)j
(conditions\))41 b(#)22 b(list)f(of)g(sequents,)f(name)h(of)h
(disjunct,)1167 2017 y(#)218 b(set)21 b(of)h(expressions)187
2067 y(record)e(sequent\(constraints)o(,)f(class\))238
b(#)22 b(list)f(of)g(contraints,)f(class)187 2117 y(record)g
(patlabel\(name,)f(original_name,)g(offset\))h(#)i(marks)f(a)g
(location)g(in)g(a)h(sequence)187 2167 y(record)e(latent_patlabel\(ins)
o(tance)o(\))280 b(#)22 b(could)f(become)f(a)i(patlabel)e(or)h(vanish)
187 2217 y(record)f(constraint\(field,)f(lo,)i(hi\))282
b(#)22 b(constrain)e(lo)h(<=)h(field.value)d(<)j(hi)187
2266 y(record)e(fieldbinding\(field,)e(code\))282 b(#)22
b(code)f(to)g(compute)g(field)187 2366 y(#)g(invariant:)f(constraints)g
(of)h(the)g(same)g(sequent)f(have)h(distinct)g(fields)145
2418 y Fp(De\014nes:)187 2457 y Fl(constraint)o Fp(,)10
b(used)i(in)g(c)o(h)o(unks)f(22c,)h(41a,)f(61,)h(62a,)g(68{71,)f(75,)h
(77a,)f(85a,)h(93,)g(94,)g(104a,)f(117c,)228 2497 y(122b,)f(138,)h
(143c,)f(195,)h(264,)f(270b,)g(273b,)g(279a,)g(282,)h(285b,)f(320a,)g
(371a,)g(and)h(372a.)841 2604 y Fv(55)p eop
%%Page: 56 56
56 55 bop 129 141 a Fv(56)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)171 258 y Fl(disjunct)p Fp(,)d(used)h(in)h(c)o(h)o
(unks)f(56,)h(57,)g(60{62,)f(64a,)g(65b,)h(85a,)f(93,)h(94,)g(102c,)f
(117b,)h(118b,)f(121a,)212 297 y(164b,)g(193,)f(205,)h(206,)f(209a,)g
(215,)h(216,)f(260,)h(265a,)f(279a,)g(317,)g(370b,)g(and)h(372a.)171
337 y Fl(equivclass)o Fp(,)e(used)i(in)g(c)o(h)o(unks)f(35a,)g(37a,)g
(and)h(42a.)171 376 y Fl(field)p Fp(,)e(used)h(in)h(c)o(h)o(unks)e
(13a,)h(17b,)g(22c,)f(23b,)h(27c,)g(33c,)g(35b,)g(37c,)g(41a,)g(46b,)g
(50b,)f(52d,)h(61,)h(68{70,)212 415 y(75,)h(78b,)f(85a,)h(93a,)f(97b,)g
(104a,)g(115{17,)g(122b,)g(162{64,)f(169,)h(170b,)g(172b,)g(174,)g
(175,)h(188b,)212 455 y(189a,)f(195,)g(199a,)f(201b,)h(203,)g(204a,)f
(208a,)h(212d,)f(242,)h(247,)g(249,)g(254,)g(256,)g(262a,)f(264,)h
(265c,)212 494 y(268,)g(270b,)f(272,)h(276,)f(277b,)h(279a,)f(282,)g
(285,)h(289{92,)f(296{99,)f(301b,)h(311a,)g(315b,)h(317,)f(320a,)212
534 y(333,)h(334b,)f(345a,)g(346a,)g(349c,)g(351c,)h(353{57,)e(and)i
(371{74.)171 573 y Fl(fieldbindi)o(ng)p Fp(,)e(used)h(in)i(c)o(h)o
(unks)e(65c,)h(70a,)g(73b,)f(77a,)h(85a,)g(93a,)g(104a,)f(117c,)h
(122b,)f(170b,)g(172b,)212 613 y(195,)h(199a,)f(262a,)g(264,)h(270b,)f
(301b,)g(371a,)g(and)h(372a.)171 652 y Fl(latent_pat)o(lab)o(el)p
Fp(,)e(used)i(in)h(c)o(h)o(unks)e(32b,)h(59c,)h(60b,)f(67b,)g(85a,)g
(100a,)g(102c,)g(104a,)g(117c,)f(122b,)212 691 y(178d,)h(180,)f(181b,)g
(269,)h(and)f(370d.)171 731 y Fl(patlabel)p Fp(,)f(used)i(in)g(c)o(h)o
(unks)f(57,)h(59,)g(60a,)g(67b,)f(69b,)h(73b,)f(81,)h(85a,)g(93a,)g
(100a,)f(102c,)g(104a,)h(112a,)212 770 y(117b,)g(122b,)f(178d,)g(180,)g
(260,)h(269,)f(and)h(370d.)171 810 y Fl(pattern)p Fp(,)e(used)i(in)h(c)
o(h)o(unks)e(14,)h(23a,)f(27c,)h(29,)g(41a,)g(43,)g(51a,)g(56,)g(57,)g
(60{65,)f(71c,)h(72c,)g(75,)g(78{81,)212 849 y(85a,)h(93,)f(102,)g
(112a,)g(117b,)g(119b,)g(121a,)g(125c,)g(162{64,)f(173a,)h(176,)g(180,)
g(184a,)g(189b,)g(193c,)212 889 y(195,)h(239c,)f(240b,)g(260{63,)f
(269,)h(271{73,)g(275,)g(277{79,)f(281c,)h(282b,)g(285a,)g(301,)h(313,)
f(368c,)212 928 y(369a,)g(372a,)f(374,)g(377a,)g(and)h(378a.)171
967 y Fl(sequent)p Fp(,)f(used)i(in)g(c)o(h)o(unks)f(59c,)h(61,)g(62c,)
g(65c,)f(67a,)h(68d,)f(70{73,)g(85a,)h(93a,)g(94a,)f(104a,)h(112a,)212
1007 y(117b,)f(122a,)f(194b,)g(269,)g(and)h(372a.)129
1046 y(Uses)h Fl(constraints)c Fp(136a,)i Fl(input)g
Fp(46a,)h Fl(location)p Fp(,)d(and)j Fl(value)f Fp(136a.)129
1109 y Fv(N.B.)k Fr(patlabel)e Fv(o\013sets)j(are)g(in)e(PC)h(units,)g
(not)f(in)h(bits.)192 1158 y(During)g(the)i(sp)q(eci\014cation)g(pro)q
(cess,)g(names)e(ma)o(y)g(b)q(e)h(b)q(ound)g(to)g(a)g(particular)g
(pat-)129 1208 y(tern.)20 b(In)14 b(that)g(w)o(a)o(y)m(,)f(a)h(pattern)
h(and)f(its)g(disjuncts)h(are)f(asso)q(ciated)h(with)f(a)g(name.)j(The)
129 1258 y(name)c(information)d(is)k(sa)o(v)o(ed)f(so)h(it)f(can)h(b)q
(e)g(referred)h(to)e(b)o(y)g(co)q(de)i(that)e(app)q(ears)i(in)e(case)
129 1308 y(statemen)o(ts.)32 b(The)19 b(pro)q(cedure)h
Fr(patbind)d Fv(also)g(sa)o(v)o(es)i(the)g(pattern)g(and)f(name)f(in)h
(the)129 1358 y(curren)o(t)e(en)o(vironmen)o(t.)4 1420
y Fp(56)89 b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1123
b Fm(/)6 b Fp(55)23 b(57)5 b Fm(.)171 1470 y Fr(procedure)20
b(patbind\(name,)f(p,)i(env\))258 1520 y(if)h(name)e(==)i("_")f(then)g
(return)258 1569 y(if)h(*p.disjuncts)d(=)i(1)h(&)g(\\p.disjuncts[1])o
(.name)c(then)345 1619 y(p)k(:=)f(pattern\([disjunct\(p)o(.disj)o(unct)
o(s[1].)o(seque)o(nts\)])o(\))150 b(#)21 b(copy)g(w/o)g(names)258
1669 y(add_to_rho\(name,)e(p,)i(env\))258 1719 y(/p.name)f(:=)i(name)
258 1769 y(every)f(d)g(:=)h(!p.disjuncts)d(&)j(/d.name)e(&)i(d.name)e
(:=)i(name)236 1818 y(return)171 1868 y(end)129 1920
y Fp(De\014nes:)171 1960 y Fl(patbind)p Fp(,)9 b(used)i(in)g(c)o(h)o
(unk)f(43a.)129 1999 y(Uses)i Fl(add_to_rho)c Fp(26a,)j
Fl(disjunct)e Fp(55,)i(and)f Fl(pattern)f Fp(55.)p eop
%%Page: 57 57
57 56 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(57)145 258 y Ft(4.1.1)56 b(Explanation)17
b(of)i(pattern)f(lab)r(els)145 334 y Fv(A)11 b(lab)q(el)f
Fr(L:)h Fv(in)f(an)o(y)g(sequence)j(mak)o(es)d Fr(L)g
Fv(a)o(v)n(ailable)f(for)h(use)i(in)e(\014eld)h(bindings)f(throughout)
145 384 y(that)k(sequence.)21 b(Ho)o(w)o(ev)o(er,)14
b(w)o(e)g(wish)g(to)g(limit)d(the)k(scop)q(e)g(of)f Fr(L)g
Fv(to)f(the)i(literal)e(sequence)145 434 y(in)19 b(whic)o(h)g(it)g(app)
q(ears;)k(when)d(w)o(e)f(reuse)i(a)e(pattern)i(b)o(y)e(using)g(a)g
(name)f(b)q(ound)i(with)145 484 y Fr(patterns)12 b Fv(or)h(b)o(y)g
(applying)e(a)i(constructor,)h(lab)q(els)f(in)g(the)h(pattern)f(so)h
(denoted)g(should)145 534 y(not)f(b)q(e)h(visible.)j(In)c(other)h(w)o
(ords,)f(the)h(scop)q(e)h(of)d(a)h(lab)q(el)g Fr(L)f
Fv(is)i(the)f(enclosing)g(pattern)h(or)145 583 y(constructor)i
(de\014nition.)208 633 y(Conjoining)11 b(t)o(w)o(o)i(sequences)i
(preserv)o(es)h(lab)q(els.)i(This)13 b(is)g(a)g(pain)f(to)i(implem)o
(en)o(t)d(\(see)145 683 y Fr(merge_sequences)p Fv(,)g(esp)q(ecially)j
(the)g(c)o(h)o(unk)g Fo(h)p Fn(suck)i(initial)e(lab)n(els)g(into)h
Fr(l)f Fp(67b)p Fo(i)p Fv(\).)208 733 y(In)k(a)g(single)g
Fr(when)f Fv(clause)i(of)f(a)g(constructor)i(de\014nition,)e(a)g(lab)q
(el)g Fr(L)g Fv(can)h(b)q(e)f(used)145 783 y(as)g(inputs)g(to)g(the)g
(set)g(of)g(equations)f(as)h(long)f(as)h(it)f(app)q(ears)i(in)e(all)f
(disjuncts)j(of)e(the)145 832 y(asso)q(ciated)h(pattern.)27
b(\(This)17 b(is,)f(of)g(course,)i(one)f(w)o(a)o(y)f(of)g(propagating)g
(the)h(lab)q(el)f(in)o(to)145 882 y(\014eld)e(bindings.\))208
932 y(W)m(e)g(enforce)i(the)f(scoping)g(of)f(lab)q(els)g(b)o(y)h
(substituting)g Fr(Epatlabel)d Fv(expressions)17 b(for)145
982 y(v)n(ariables)11 b(that)g(refer)h(to)f(lab)q(els.)17
b(\(W)m(e)11 b(do)f(this)i(after)f(running)g(the)h(solv)o(er,)f(when)g
(binding)145 1032 y(patterns)18 b(in)o(to)d(what)h(w)o(e)h(migh)o(t)d
(call)h(\\top-lev)o(el)g(normal)g(form.")22 b(Of)17 b(course)g(this)f
(has)145 1081 y(nothing)h(to)h(do)g(with)f(patterns)i(themselv)o(es;)h
(it's)d(a)h(prop)q(ert)o(y)h(of)e(the)h(expressions)i(in)145
1131 y(\014eld)15 b(bindings,)g(but)g(w)o(e)g(do)g(n)o(ull)f(out)h(the)
h Fr(name)e Fv(\014eld)h(of)g(a)f Fr(patlabel)g Fv(so)h(it)g(can)g
(mark)145 1181 y(the)d(lo)q(cation)f(without)g(in)o(terfering)h(with)f
(other)h(lab)q(els)f(that)h(are)g(di\013eren)o(tly)f(scop)q(ed)i(but)
145 1231 y(iden)o(tically)i(named.\))24 b(A)o(t)16 b(the)h(emission)e
(lev)o(el)h(\(un)o(t)o(yp)q(ed)g(constructor\),)i(w)o(e'll)d(rewrite)
145 1281 y Fr(patlabel)e Fv(expressions)i(in)o(to)e(the)i(form)d
Fr(Epc\(\))21 b(+)g(offset)p Fv(.)c(A)o(t)d(the)h(recognition)e(lev)o
(el,)145 1331 y(w)o(e'll)e(insert)h(a)f(binding)f(of)h(the)h(name)e(of)
h(the)h(lab)q(el)f(to)g(an)h(expression)g(of)f(the)h(same)f(form.)208
1380 y(The)i(in)o(v)n(arian)o(t)e(on)h Fr(patlabel)p
Fv(s)g(is)g(that)h(the)g Fr(name)f Fv(\014eld)h(is)g(non-n)o(ull)e
(during)i(parsing)145 1430 y(and)i(con)o(v)o(ersion)f(to)g(normal)f
(form,)f(but)j(the)g Fr(name)e Fv(\014eld)i(m)o(ust)e(b)q(e)i(n)o(ull)f
(in)g(an)o(y)g(pattern)145 1480 y(that)k(results)h(from)d(a)i
Fr(lookup)e Fv(or)i(a)g Fr(crhs)f Fv(call.)29 b(W)m(e)17
b(migh)o(t)f(actually)h(b)q(e)h(able)g(to)g(do)145 1530
y(something)13 b(with)g(this)h(in)g(ML)g(b)o(y)f(parameterising)g(the)i
(t)o(yp)q(e)f(b)o(y)g Fr(unit)f Fv(or)g Fr(string)p Fv(.)208
1580 y(Another)i(in)o(v)n(arian)o(t)f(w)o(e)h(w)o(an)o(t)g(to)g(main)o
(tain)d(is)j(that)g(no)g Fr(patlabel)e Fv(should)i(app)q(ear)145
1629 y(in)j(more)g(than)h(one)f(sequence.)35 b(Conjunction)18
b(can't)g(do)h(it,)f(b)q(ecause)j(it)d(destro)o(ys)i(all)145
1679 y(lab)q(els.)25 b(Disjunction)16 b(can't)g(do)g(it,)h(b)q(ecause)h
(collecting)e(a)g(larger)g(group)g(of)g(sequences)145
1729 y(together)g(can't)g(violate)e(the)i(in)o(v)n(arian)o(t.)k(But)c
(concaten)o(tation)f(can)h(do)f(it,)f(b)q(ecause)j(w)o(e)145
1779 y(replicate)d(sequences)i(to)d(get)h(an)f(outer)g(pro)q(duct.)19
b(So)13 b(w)o(e)h(ha)o(v)o(e)f(to)g(b)q(e)h(careful)f(in)g
Fr(seqpx)p Fv(.)145 1829 y(W)m(e)h(exploit)f(the)h(in)o(v)n(arian)o(t)f
(b)o(y)g(setting)i Fr(name)e Fv(\014elds)h(n)o(ull)f(when)h(binding)f
(lab)q(el)g(names.)208 1878 y(A)g Fr(latent_patlabel)d
Fv(is)k(used)g(to)g(implem)o(en)o(t)d(lab)q(el)i(binding)g(of)g(free)h
(constructor-)145 1928 y(t)o(yp)q(ed)i(argumen)o(ts)e(in)g(matc)o(hing)
g(statemen)o(ts.)21 b(The)15 b(lab)q(el)g(has)g(to)f(b)q(e)i(asso)q
(ciated)g(with)145 1978 y(the)g(constructor-input)g(pattern,)g(but)f
(making)d(it)j(a)f(lab)q(el)h(at)f(constructor-input)j(time)145
2028 y(will)e(just)i(put)g(it)f(in)g(the)h(wrong)f(scop)q(e.)28
b(Instead,)17 b(w)o(e)g(k)o(eep)g(the)g(laten)o(t)g(pattern)g(lab)q(el)
145 2078 y(around)10 b(un)o(til)e(w)o(e)i(kno)o(w)f(whether)i(it)e
(will)f(refer)j(to)e(a)g(real)h(instance)g Fr(Einstance\(name\))c
Fv(or)145 2128 y(a)15 b(binding)e(instance)j Fr(Ebinding_instanc)o
(e\(nam)o(e\))p Fv(.)h(In)e(the)g(former)f(case)h(it)g(v)n(anishes;)145
2177 y(in)f(the)g(latter,)g(it)f(turns)i(in)o(to)e(a)h(real)g(lab)q
(el.)j Fr(eliminate_instance)o(s)11 b Fv(do)q(es)k(the)f(w)o(ork.)20
2248 y Fp(57)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1123 b Fm(/)6 b Fp(56)23 b(58)5 b Fm(.)187 2298
y Fr(procedure)20 b(bind_and_remove_)o(patla)o(bel_n)o(ames\()o(p,)f
(keepname,)h(free_vars_ok\))230 2348 y(if)i(type\(!\(!p.disjun)o
(cts\).)o(seque)o(nts\))c(==)k("patlabel")d(then)i(&null)g(else)g
(return)g(p)43 b(#)22 b(prem)f(opt)230 2397 y(q)h(:=)f(pattern\([],)f
(p.name\))230 2447 y(every)h(put\(q.disjuncts,)e(barpm_d\(!p.disju)o
(ncts)o(,)g(keepname,)h(free_vars_ok\)\))230 2497 y(return)h(q)p
eop
%%Page: 58 58
58 57 bop 129 141 a Fv(58)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)171 258 y Fr(end)171 357 y(procedure)20
b(barpm_d\(d,)g(keepname,)g(free_vars_ok\))215 407 y(t)h(:=)h
(table\(\))215 457 y(every)e(s)i(:=)f(!d.sequents)f(&)h(type\(s\))g(==)
g("patlabel")f(&)h(\\s.name)g(do)g({)258 507 y(\(/t[s.name])f(:=)h
(Epatlabel\(s\)\))e(|)302 557 y(error\("Duplicate)f(labels)j(",)g
(s.name,)f(")i(in)f(disjunct)g(",)g(expimage\(d\)\))258
606 y(if)h(s.name)e(==)h(free_variables\(d\))e(then)i(&null)258
656 y(else)g(\\free_vars_ok)e(|)367 706 y(warning\("Label)g(",)i
(s.name,)g(")g(not)g(used)g(in)h(disjunct)e(",)h(expimage\(d\)\))258
756 y(if)h(/keepname)d(then)i(s.name)g(:=)g(&null)215
806 y(})215 855 y(return)f(subst_tab\(d,)f(t\))171 905
y(end)171 1005 y(procedure)h(bind_patlabel_nam)o(es\(p,)e
(free_vars_ok\))215 1055 y(return)i(bind_and_remove_pa)o(tlabe)o(l_nam)
o(es\(p)o(,)f(1,)i(free_vars_ok\))171 1104 y(end)129
1156 y Fp(De\014nes:)171 1196 y Fl(bind_and_r)o(emo)o(ve_)o(pat)o(la)o
(bel)o(_na)o(mes)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(170a.)171
1235 y Fl(bind_patla)o(bel)o(_na)o(mes)o Fp(,)g(used)h(in)h(c)o(h)o
(unk)f(260.)129 1275 y(Uses)k Fl(disjunct)d Fp(55,)j
Fl(Epatlabel)c Fp(81,)j Fl(expimage)e Fp(101a,)i Fl(free_varia)o(ble)o
(s)e Fp(84b,)h Fl(patlabel)g Fp(55,)171 1314 y Fl(pattern)d
Fp(55,)i Fl(subst_tab)e Fp(89a,)h(and)h Fl(used)f Fp(136a.)4
1405 y(58)89 b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p
Fo(\021)1104 b Fm(/)5 b Fp(57)23 b(59b)5 b Fm(.)171 1455
y Fr(procedure)20 b(all_disjuncts_ids)o(\(p,)f(idgen,)h(warningmsg,)g
(warning2\))215 1505 y(local)g(alld)215 1555 y(alld)h(:=)g(set\(\))215
1605 y(every)f(insert\(alld,)g(idgen\(p.disjunct)o(s[1])o(\)\))215
1654 y(every)g(d)i(:=)f(p.disjuncts[2)e(to)j(*p.disjuncts])d(do)i({)258
1704 y(s)h(:=)f(set\(\))258 1754 y(every)g(i)g(:=)h(idgen\(d\))e(do)302
1804 y(if)h(member\(alld,)e(i\))j(then)345 1854 y(insert\(s,)e(i\))302
1904 y(else)345 1953 y Fo(h)p Fn(warn)15 b(of)g(disc)n(ar)n(ding)f
Fr(i)h Fp(59a)p Fo(i)258 2003 y Fr(if)22 b(*s)f(<)g(*alld)g(then)302
2053 y(every)f(i)i(:=)f(!alld)g(&)h(not)f(member\(s,)f(i\))h(do)345
2103 y Fo(h)p Fn(warn)15 b(of)g(disc)n(ar)n(ding)f Fr(i)h
Fp(59a)p Fo(i)258 2153 y Fr(alld)21 b(:=)g(s)215 2202
y(})215 2252 y(return)f(alld)171 2302 y(end)129 2354
y Fp(De\014nes:)171 2393 y Fl(all_disjun)o(cts)o(_id)o(s)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(59b)h(and)f(260.)p
eop
%%Page: 59 59
59 58 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(59)2 258 y Fp(59a)89 b Fo(h)p
Fn(warn)15 b(of)g(disc)n(ar)n(ding)f Fr(i)h Fp(59a)p
Fo(i)o(\021)867 b Fp(\(58\))187 307 y Fr(if)21 b(\\warningmsg)f(then)
230 357 y(verbose\(warningmsg,)e(image\(i\),)i(warning2\))145
409 y Fp(Uses)12 b Fl(verbose)d Fp(18a.)0 500 y(59b)89
b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1108
b Fm(/)5 b Fp(58)23 b(59c)5 b Fm(.)187 550 y Fr(procedure)20
b(patlabels_define)o(d_in_)o(all_d)o(isjun)o(cts_)o(of\(p\))230
600 y(s)i(:=)f(all_disjuncts_ids\(p)o(,)e(patlabels_defined)o(_in\))230
650 y(suspend)i(!s)187 700 y(end)187 799 y(procedure)f
(patlabels_define)o(d_in\()o(d\))230 849 y(suspend)h(\(seq)g(:=)g
(!d.sequents,)e(type\(seq\))h(==)i("patlabel",)d(seq.name\))187
899 y(end)145 951 y Fp(Uses)12 b Fl(all_disjun)o(cts)o(_id)o(s)d
Fp(58)i(and)f Fl(patlabel)f Fp(55.)4 1042 y(59c)89 b
Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1084 b
Fm(/)6 b Fp(59b)22 b(59d)5 b Fm(.)187 1092 y Fr(procedure)20
b(set_patlabel_off)o(sets\()o(d\))230 1142 y(local)h(offset)230
1192 y(offset)g(:=)g(0)230 1241 y(every)g(i)h(:=)f(1)h(to)f
(*d.sequents)f(do)274 1291 y(case)h(type)g(\(s)g(:=)h(d.sequents[i]\))d
(of)i({)318 1341 y("patlabel")e(:)j(s.offset)e(:=)h
(bits_to_pcunits\(off)o(set\))318 1391 y("sequent")41
b(:)22 b(offset)e(+:=)i(s.class.size)318 1441 y("dots_sequent")c(|)k
("latent_patlabel")c(:)k(&null)318 1491 y(default)608
b(:)22 b(impossible\("seque)o(nt)d(type"\))274 1540 y(})230
1590 y(return)187 1640 y(end)145 1692 y Fp(De\014nes:)187
1731 y Fl(set_patlab)o(el_)o(of)o(fse)o(ts)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unks)f(190,)g(192,)h(260,)f(and)h(314a.)145 1771
y(Uses)k Fl(bits_to_pc)o(uni)o(ts)c Fp(64b,)j Fl(dots_sequ)o(ent)d
Fp(62c,)i Fl(latent_patl)o(abe)o(l)f Fp(55,)h Fl(patlabel)f
Fp(55,)187 1810 y(and)e Fl(sequent)g Fp(55.)208 1881
y Fv(W)m(e)i(sometimes)g(ha)o(v)o(e)h(to)g(mak)o(e)f(fresh)h(pattern)i
(lab)q(els)e(\(as)g(with)g(constructor)i(appli-)145 1931
y(cation\).)0 1993 y Fp(59d)89 b Fo(h)p Fn(*)15 b Fp(55)p
Fo(i)p Fv(+)p Fo(\021)1090 b Fm(/)5 b Fp(59c)23 b(60a)5
b Fm(.)187 2043 y Fr(procedure)20 b(freshen_patlabel)o(s\(p\))230
2092 y(t)i(:=)f(table\(\))230 2142 y(every)g(l)h(:=)f
(subterms_matching\()o(p,)e("patlabel"\))g(do)274 2192
y(/t[l])i(:=)g(copy\(l\))230 2242 y(return)g(if)g(*t)h(=)f(0)h(then)f
(p)g(else)g(subst_table_element)o(s\(p,)d(t\))187 2292
y(end)145 2344 y Fp(De\014nes:)187 2383 y Fl(freshen_pa)o(tla)o(be)o
(ls)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(64a)h(and)f(173a.)145
2422 y(Uses)i Fl(patlabel)d Fp(55,)i Fl(subst_tabl)o(e_)o(ele)o(men)o
(ts)d Fp(89b,)j(and)f Fl(subterms_ma)o(tch)o(ing)e Fp(84a.)p
eop
%%Page: 60 60
60 59 bop 129 141 a Fv(60)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)129 258 y Ft(4.1.2)56 b(P)n(attern)19
b(constructor)f(functions)129 334 y Fv(The)d(constructors)h(build)d
(the)h(basic)g(patterns.)-13 397 y Fp(60a)88 b Fo(h)p
Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1084 b Fm(/)6
b Fp(59d)22 b(60b)5 b Fm(.)171 446 y Fr(procedure)20
b(label2pattern\(nam)o(e\))258 496 y(return)h(pattern\([disjunc)o
(t\([pa)o(tlabe)o(l\(na)o(me,)e(name\)]\)]\))171 546
y(end)129 598 y Fp(De\014nes:)171 637 y Fl(label2patt)o(ern)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(75)i(and)g(262a.)129
677 y(Uses)h Fl(disjunct)d Fp(55,)i Fl(patlabel)e Fp(55,)i(and)f
Fl(pattern)g Fp(55.)-15 760 y(60b)88 b Fo(h)p Fn(*)16
b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1106 b Fm(/)5 b Fp(60a)23
b(61)5 b Fm(.)171 810 y Fr(procedure)20 b(latent_label2patt)o(ern\(n)o
(ame\))258 859 y(return)h(pattern\([disjunc)o(t\([la)o(tent_)o(patl)o
(abel\()o(name\))o(]\)]\))171 909 y(end)129 961 y Fp(De\014nes:)171
1001 y Fl(latent_lab)o(el2)o(pat)o(ter)o(n)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unk)f(172a.)129 1040 y(Uses)i Fl(disjunct)d Fp(55,)i
Fl(latent_pat)o(lab)o(el)d Fp(55,)j(and)g Fl(pattern)e
Fp(55.)p eop
%%Page: 61 61
61 60 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(61)20 258 y Fp(61)89 b Fo(h)p
Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1086 b Fm(/)6
b Fp(60b)22 b(62a)5 b Fm(.)187 307 y Fr(procedure)20
b(constraints2patt)o(ern\(L)o([]\))274 357 y(return)h(pattern\([disjun)
o(ct\([s)o(equen)o(t\(L,)d(L[1].field.class\)]\))o(]\))187
407 y(end)187 457 y(procedure)i(conspat\(f,)f(op,)j(val\))274
507 y(local)f(max,)g(p,)g(q)274 557 y(type\(val\))f(==)h("integer")f(|)
i(impossible\("non-)o(integ)o(er)d(constraint"\))274
606 y(max)i(:=)h(2)f(^)h(fwidth\(f\))274 656 y(return)f(case)f(op)i(of)
f({)361 706 y("=")43 b(:)22 b(constraints2patt)o(ern\(c)o(onstr)o(aint)
o(\(f,)d(val,)i(val+1\)\))361 756 y("<")43 b(:)22 b({)f(if)h(val)f(<=)g
(0)h(then)f(warning\("Impossi)o(ble)e(constraint)g(",)j(f.name,)e(")i
(<)f(",)h(val\))557 806 y(if)g(val)f(>)g(max)h(then)601
855 y(error\("Constraint)c(value)j(too)g(large)g(in)g(",)h(f.name,)e(")
i(<)f(",val\))557 905 y(constraints2pattern)o(\(cons)o(trai)o(nt\(f,)d
(0,)k(val\)\))514 955 y(})361 1005 y("<=")f(:)h({)f(if)h(val)f(>=)g
(max)g(then)601 1055 y(error\("Constraint)d(value)j(too)g(large)g(in)g
(",)h(f.name,)e(")i(<=)f(",)g(val\))557 1104 y(constraints2pattern)o
(\(cons)o(trai)o(nt\(f,)d(0,)k(val+1\)\))514 1154 y(})361
1204 y(">")43 b(:)22 b({)f(if)h(val)f(>=)g(max-1)g(then)601
1254 y(warning\("Impossib)o(le)e(constraint)g(",)j(f.name,)e(")i(>)f
(",)h(val\))557 1304 y(if)g(val)f(<)g(0)h(then)601 1354
y(error\("Constraint)c(value)j(too)g(small)g(in)g(",)h(f.name,)e(")i(>)
f(",val\))557 1403 y(constraints2pattern)o(\(cons)o(trai)o(nt\(f,)d
(val+1,)j(max\)\))514 1453 y(})361 1503 y(">=")43 b(:)21
b({)h(if)f(val)h(>=)f(max)g(then)601 1553 y(warning\("Impossib)o(le)e
(constraint)g(",)j(f.name,)e(")i(>=)f(",)h(val\))557
1603 y(if)g(val)f(<)g(0)h(then)601 1652 y(error\("Constraint)c(value)j
(too)g(small)g(in)g(",)h(f.name,)e(")i(>=)f(",val\))557
1702 y(constraints2pattern)o(\(cons)o(trai)o(nt\(f,)d(val,)j(max\)\))
514 1752 y(})361 1802 y("!=")g(:)h({)448 1852 y(if)g(val)f(>)g(0)153
b(then)21 b(p)g(:=)h(constraints2patt)o(ern\(c)o(onstr)o(aint\()o(f,)d
(0,)i(val\)\))448 1901 y(if)h(val)f(+)g(1)h(<)g(max)f(then)g(q)g(:=)h
(constraints2patt)o(ern\(c)o(onstr)o(aint\()o(f,)d(val+1,)h(max\)\))448
1951 y(orpx\(\\p,)g(\\q\))i(|)f(\\p)h(|)f(\\q)h(|)f(impossible\("lost)e
(inequality"\))361 2001 y(})274 2051 y(})187 2101 y(end)145
2153 y Fp(De\014nes:)187 2192 y Fl(conspat)p Fp(,)9 b(used)h(in)i(c)o
(h)o(unks)d(76a,)i(77a,)f(and)h(162b.)187 2231 y Fl(constraint)o(s2p)o
(at)o(ter)o(n)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f(62a,)h(77a,)f(170b,)g
(172b,)g(and)h(262a.)145 2271 y(Uses)i Fl(constraint)c
Fp(55,)i Fl(disjunct)f Fp(55,)i Fl(field)f Fp(55,)g Fl(fwidth)g
Fp(115d,)g Fl(max)g Fp(410,)g Fl(orpx)h Fp(63c,)f Fl(pattern)f
Fp(55,)187 2310 y Fl(sequent)f Fp(55,)i(and)g Fl(value)e
Fp(136a.)p eop
%%Page: 62 62
62 61 bop 129 141 a Fv(62)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-13 258 y Fp(62a)88 b Fo(h)p Fn(*)16
b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1104 b Fm(/)5 b Fp(61)23
b(62b)5 b Fm(.)171 307 y Fr(procedure)20 b(wildcard\(class\))84
b(#)22 b(return)e(a)i(pattern)e(that)h(matches)f(anything)g(in)i(class)
258 357 y(return)f(constraints2patt)o(ern\(c)o(onstr)o(aint)o(\(f)e(:=)
i(class.fields[1],)e(0,)i(2^fwidth\(f\)\)\))171 407 y(end)129
459 y Fp(De\014nes:)171 498 y Fl(wildcard)p Fp(,)9 b(used)h(in)h(c)o(h)
o(unk)f(42a.)129 538 y(Uses)i Fl(constraint)c Fp(55,)j
Fl(constraints)o(2pa)o(tt)o(ern)d Fp(61,)j Fl(fwidth)f
Fp(115d,)g(and)g Fl(pattern)g Fp(55.)-15 629 y(62b)88
b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1090
b Fm(/)6 b Fp(62a)22 b(62c)5 b Fm(.)171 679 y Fr(procedure)20
b(epsilon\(\))107 b(#)22 b(pattern)e(with)h(shape)g(of)g(length)g(0)258
729 y(static)g(e)258 779 y(initial)f(e)i(:=)f(pattern\([disjunct\([])o
(,)e("epsilon"\)],)g("epsilon"\))258 828 y(return)i(e)171
878 y(end)129 930 y Fp(De\014nes:)171 970 y Fl(epsilon)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(17a,)g(42a,)h(51a,)f(72a,)h(102c,)f
(328b,)g(and)g(372a.)129 1009 y(Uses)i Fl(disjunct)d
Fp(55)i(and)g Fl(pattern)e Fp(55.)192 1080 y Fv(A)16
b(sp)q(ecial)g(kind)g(of)f(sequen)o(t,)j(\\)p Fr(dots)p
Fv(,")c(is)i(used)h(to)f(implemen)o(t)d(the)k(ellipsis.)24
b(Only)129 1129 y(one)15 b(instance)g(is)f(ev)o(er)h(used.)20
b(An)14 b(in)o(v)n(arian)o(t)f(prop)q(ert)o(y)i(is)f(that)g
Fr(dots)f Fv(ma)o(y)g(app)q(ear)h(only)129 1179 y(at)k(the)f(ends)i(of)
d(a)h(sequence.)31 b(The)17 b(in)o(v)n(arian)o(t)f(is)h(main)o(tained)e
(b)o(y)i(the)h(concatenation)129 1229 y(m)o(utator,)13
b(whic)o(h)h(forces)h Fr(dots)f Fv(to)g(disapp)q(ear)h(\\in)e(the)i
(middle.")i(The)e(purp)q(ose)h(of)d(dots)129 1279 y(is)h(to)g(relax)g
(the)g(shap)q(e-matc)o(hing)f(rules)h(used)h(in)f(conjunction)f
(\(q.v.\).)-12 1341 y Fp(62c)89 b Fo(h)p Fn(*)16 b Fp(55)p
Fo(i)o Fv(+)p Fo(\021)1086 b Fm(/)6 b Fp(62b)22 b(63a)5
b Fm(.)171 1391 y Fr(record)21 b(dots_sequent\(\))236
b(#)22 b(a)g(very)e(special)h(sequent)171 1441 y(global)g(dots)171
1491 y(procedure)f(dots_pattern\(\))258 1540 y(static)h(d)258
1590 y(initial)f(d)i(:=)f(pattern\([disjunct\([d)o(ots)d(:=)k
(dots_sequent\(\)],)c("..."\)],)i("..."\))258 1640 y(return)h(d)171
1690 y(end)129 1742 y Fp(De\014nes:)171 1781 y Fl(dots)p
Fp(,)10 b(used)h(in)g(c)o(h)o(unks)f(65a,)g(67a,)h(68c,)f(and)h(370.)
171 1821 y Fl(dots_patte)o(rn)p Fp(,)d(used)j(in)g(c)o(h)o(unks)f(39b)g
(and)h(377b.)171 1860 y Fl(dots_seque)o(nt)p Fp(,)d(used)j(in)g(c)o(h)o
(unks)f(59c,)g(85a,)h(93a,)f(104a,)g(117b,)h(and)f(122b.)129
1899 y(Uses)i Fl(disjunct)d Fp(55,)i Fl(pattern)e Fp(55,)i(and)g
Fl(sequent)e Fp(55.)p eop
%%Page: 63 63
63 62 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(63)145 258 y Ft(4.1.3)56 b(P)n(attern)18
b(m)n(utator)g(functions)145 334 y Fv(The)d(m)o(utators)f
Fr(&)p Fv(,)g Fr(|)p Fv(,)g(and)h Fr(;)p Fv(,)f(com)o(bine)f(patterns.)
22 b(When)15 b(generators)h(are)f(used)h(in)e(the)145
384 y(sp)q(eci\014cation,)h(they)g(are)f(represen)o(ted)j(as)e(lists)f
(of)g(patterns.)20 b(It)14 b(is)h(therefore)g(necessary)145
434 y(to)f(b)q(e)h(able)f(to)g(com)o(bine)f(\(with)h
Fr(andp)p Fv(,)f Fr(orp)p Fv(,)g(and)h Fr(seqp)p Fv(\))g(not)g(just)g
(t)o(w)o(o)g(patterns,)h(but)g(a)145 484 y(pattern)g(and)f(a)f(list.)18
b Fr(mix)13 b Fv(do)q(es)i(the)f(job.)2 546 y Fp(63a)89
b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1088
b Fm(/)6 b Fp(62c)22 b(63b)5 b Fm(.)187 596 y Fr(procedure)20
b(andp\(p1,)g(p2\))274 646 y(return)h(mix\(andpx,)e(p1,)i(p2\))187
695 y(end)187 795 y(procedure)f(orp\(p1,)g(p2\))274 845
y(return)h(mix\(orpx,)e(p1,)j(p2\))187 895 y(end)187
994 y(procedure)e(seqp\(p1,)g(p2\))274 1044 y(return)h(mix\(seqpx,)e
(p1,)i(p2\))187 1094 y(end)145 1146 y Fp(De\014nes:)187
1185 y Fl(andp)p Fp(,)10 b(used)g(in)i(c)o(h)o(unk)e(75.)187
1225 y Fl(orp)p Fp(,)g(used)h(in)g(c)o(h)o(unks)f(75,)h(169,)f(and)h
(172a.)187 1264 y Fl(seqp)p Fp(,)f(used)g(in)i(c)o(h)o(unks)d(72a)i
(and)g(75.)145 1304 y(Uses)h Fl(andpx)e Fp(65b,)g Fl(mix)h
Fp(63b,)g Fl(orpx)f Fp(63c,)g(and)h Fl(seqpx)f Fp(64a.)0
1387 y(63b)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1090 b Fm(/)5 b Fp(63a)23 b(63c)5 b Fm(.)187
1436 y Fr(procedure)20 b(mix\(op,)g(p1,)h(p2\))g(#)h(can)f(destroy)g
(its)g(list)g(argument)f(because)753 1486 y(#)i(lists)f(are)g(never)g
(saved)f(or)i(bound)f(to)g(names)274 1536 y(return)g(case)f(type\(p1\))
h(||)g(",")g(||)h(type\(p2\))e(of)h({)361 1586 y("pattern,pattern")d(:)
k(op\(p1,)f(p2\))361 1636 y("list,pattern")84 b(:)22
b({)g(every)e(i)i(:=)f(1)h(to)f(*p1)g(do)h(p1[i])f(:=)g(op\(p1[i],)f
(p2\))h(;)h(p1)f(})361 1685 y("pattern,list")84 b(:)22
b({)g(every)e(i)i(:=)f(1)h(to)f(*p2)g(do)h(p2[i])f(:=)g(op\(p1,)g
(p2[i]\))f(;)i(p2)f(})361 1735 y("list,list")150 b(:)22
b({)g(l)f(:=)h([];)f(every)f(put\(l,)h(op\(!p1,)f(!p2\)\);)h(l)h(})361
1785 y(default)238 b(:)22 b(error\("Invalid)d(combination)g(of)j
(patterns."\))274 1835 y(})187 1885 y(end)145 1937 y
Fp(De\014nes:)187 1976 y Fl(mix)p Fp(,)10 b(used)h(in)g(c)o(h)o(unk)f
(63a.)145 2015 y(Uses)i Fl(pattern)d Fp(55.)4 2107 y(63c)89
b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1086
b Fm(/)6 b Fp(63b)22 b(64a)5 b Fm(.)187 2157 y Fr(procedure)20
b(orpx\(p1,)g(p2\))274 2206 y(return)h(pattern\(p1.disj)o(uncts)d(|||)j
(p2.disjuncts\))187 2256 y(end)145 2308 y Fp(De\014nes:)187
2348 y Fl(orpx)p Fp(,)10 b(used)g(in)i(c)o(h)o(unks)d(61)j(and)e(63a.)
145 2387 y(Uses)i Fl(pattern)d Fp(55.)p eop
%%Page: 64 64
64 63 bop 129 141 a Fv(64)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(The)e(resp)q(onsibilit)o(y)f(for)g(main)
o(taining)d(the)12 b(no-m)o(ultiple-app)q(earance)d(in)o(v)n(arian)o(t)
g(o)o(v)o(er)129 307 y Fr(patlabel)p Fv(s)14 b(is)g(here.)21
b(The)15 b(k)o(ey)f(features)i(is)e(that,)h(b)o(y)f(the)h(in)o(v)n
(arian)o(t,)e(w)o(e)h(can)h(coun)o(t)g(on)129 357 y(the)h(same)e(lab)q
(el)g(not)h(app)q(earing)f(in)h(b)q(oth)f Fr(d1)h Fv(and)f
Fr(d2)p Fv(.)21 b(Therefore,)16 b(when)f(w)o(e)g(com)o(bine)129
407 y(them,)d(w)o(e)g(can)g(get)h(a)o(w)o(a)o(y)e(with)g(simply)f
(freshening)j(the)g(pattern)g(lab)q(els.)k(And)12 b(if)f(there's)129
457 y(only)j(one)g(disjunct)g(on)g(eac)o(h)g(side,)g(w)o(e)g(don't)f
(ev)o(en)i(ha)o(v)o(e)e(to)h(do)g(that.)-13 519 y Fp(64a)88
b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1088
b Fm(/)6 b Fp(63c)22 b(64b)5 b Fm(.)171 569 y Fr(procedure)20
b(seqpx\(p1,)g(p2\))258 619 y(local)h(p,)g(count1,)g(count2)258
669 y(p)h(:=)f(pattern\([]\))258 718 y(count1)g(:=)g(*p1.disjuncts)258
768 y(count2)g(:=)g(*p2.disjuncts)258 818 y(every)g(d1)g(:=)h
(!p1.disjuncts)d(&)i(d2)h(:=)f(!p2.disjuncts)e(do)j({)302
868 y(d)f(:=)h(disjunct\(concat_)o(seque)o(nces\()o(d1.s)o(equen)o(ts,)
d(d2.sequents\),)g(&null,)607 918 y(conjoin_condition)o(s\(d1)o(.cond)o
(ition)o(s,)g(d2.conditions\)\))302 967 y(if)i(count1)g(>)g(1)h(|)f
(count2)g(>)h(1)f(then)g(#)h(d1)f(or)g(d2)h(will)f(be)g(reused)345
1017 y(d)h(:=)f(freshen_patlabels\(d)o(\))302 1067 y(put\(p.disjuncts,)
d(d\))258 1117 y(})258 1167 y(return)j(p)171 1217 y(end)129
1268 y Fp(De\014nes:)171 1308 y Fl(seqpx)p Fp(,)10 b(used)g(in)h(c)o(h)
o(unks)f(63a,)h(172a,)f(and)h(262a.)129 1347 y(Uses)g
Fl(concat_sequ)o(enc)o(es)d Fp(65a,)h Fl(conjoin_con)o(dit)o(ion)o(s)f
Fp(64c,)i Fl(disjunct)e Fp(55,)i Fl(freshen_pa)o(tla)o(bel)o(s)e
Fp(59d,)171 1387 y(and)j Fl(pattern)e Fp(55.)-15 1470
y(64b)88 b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1090
b Fm(/)6 b Fp(64a)22 b(64c)5 b Fm(.)171 1520 y Fr(procedure)20
b(bits_to_pcunits\(n)o(\))215 1569 y(if)h(n)h(\045)f(pc_unit_bits)e(~=)
j(0)f(then)258 1619 y(error\("pc)f(is)h(incremented)f(in)h(units)g(of)g
(",)h(pc_unit_bits,)d(",)i(but)h(some)e(pattern)h(is)g(",)h(n,)389
1669 y(")f(bits)g(wide"\))215 1719 y(else)280 1769 y(return)f(n)i(/)g
(pc_unit_bits)171 1818 y(end)129 1870 y Fp(De\014nes:)171
1910 y Fl(bits_to_pc)o(uni)o(ts)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f
(59c)g(and)h(269.)129 1949 y(Uses)h Fl(pattern)d Fp(55)i(and)g
Fl(pc_unit_bi)o(ts)e Fp(18a.)-12 2041 y(64c)89 b Fo(h)p
Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1086 b Fm(/)6
b Fp(64b)22 b(65a)5 b Fm(.)171 2090 y Fr(procedure)20
b(conjoin_condition)o(s\(c1,)e(c2\))215 2140 y(return)i(if)h(/c1)h
(then)f(c2)367 2190 y(else)g(if)g(/c2)h(then)f(c1)367
2240 y(else)g(c1)g(++)h(c2)171 2290 y(end)129 2342 y
Fp(De\014nes:)171 2381 y Fl(conjoin_co)o(ndi)o(tio)o(ns)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(64a)g(and)h(65b.)p
eop
%%Page: 65 65
65 64 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(65)208 258 y Fr(concat_sequence)o(s)11
b Fv(main)o(tains)h(the)i(in)o(v)n(arian)o(t)e(on)i Fr(dots)p
Fv(.)2 317 y Fp(65a)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p
Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(64c)22 b(65b)5 b Fm(.)187
367 y Fr(procedure)20 b(concat_sequences)o(\(s1,)e(s2\))230
417 y(local)j(seq)230 467 y(seq)h(:=)f(if)g(s1[-1])g(===)g(dots)g(&)h
(*s1)f(>)g(1)h(then)427 516 y(if)f(s2[1])g(===)g(dots)g(&)g(*s2)h(>)f
(1)h(then)470 566 y(s1[1:-1])e(|||)h(s2[2:0])427 616
y(else)470 666 y(s1[1:-1])f(|||)h(s2)383 716 y(else)427
765 y(if)g(s2[1])g(===)g(dots)g(&)g(*s2)h(>)f(1)h(then)470
815 y(s1)152 b(|||)21 b(s2[2:0])427 865 y(else)470 915
y(s1)152 b(|||)21 b(s2)230 965 y(return)g(seq)187 1015
y(end)145 1064 y Fp(De\014nes:)187 1103 y Fl(concat_seq)o(uen)o(ce)o(s)
p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(64a.)145 1143 y(Uses)i
Fl(dots)e Fp(62c.)208 1202 y Fv(It)20 b(is)g(desirable)h(to)g(preserv)o
(e)h(names)e(when)h(patterns)g(are)g(com)o(bined)e(with)h(\014eld)145
1252 y(bindings)e(in)g(pattern-matc)o(hing)f(statemen)o(ts.)32
b(Because)21 b(it's)d(late)g(at)g(nigh)o(t)g(and)g(I'm)145
1302 y(lazy)m(,)13 b(I'm)f(making)f(this)j(w)o(ork)g(only)f(when)h
(\014eld)g(bindings)f(are)i(anded)f(in)f(on)h(the)h(righ)o(t.)0
1361 y Fp(65b)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1088 b Fm(/)6 b Fp(65a)22 b(67a)5 b Fm(.)187
1411 y Fr(procedure)20 b(andpx\(p1,)g(p2\))274 1461 y(local)h(keepname)
274 1511 y Fo(h)p Fn(make)15 b Fr(keepname)f Fn(name)h(of)g
Fr(p1)f Fn(if)h Fr(p2)f Fn(is)h(\014eld)g(binding,)g(nul)r(l)g
(otherwise)f Fp(65c)p Fo(i)274 1560 y Fr(p)22 b(:=)f(pattern\([],)e
(keepname\))274 1610 y(every)i(d1)g(:=)g(!p1.disjuncts)f(&)h(d2)h(:=)f
(!p2.disjuncts)e(do)i({)361 1660 y(put\(p.disjuncts,)448
1710 y(d)h(:=)f(not_contradictory\()644 1760 y(disjunct\(merge_seque)o
(nces)o(\(d1.s)o(equen)o(ts,)e(d2.sequents\),)g(&null,)841
1809 y(conjoin_conditi)o(ons\(d)o(1.con)o(ditio)o(ns,)g
(d2.conditions\)\))o(\)\))361 1859 y(if)j(\\keepname)d(then)i(d.name)g
(:=)g(d1.name)274 1909 y(})274 1959 y(return)g(p)187
2009 y(end)145 2058 y Fp(De\014nes:)187 2097 y Fl(andpx)p
Fp(,)10 b(used)g(in)h(c)o(h)o(unk)f(63a.)145 2137 y(Uses)i
Fl(conjoin_con)o(dit)o(ion)o(s)d Fp(64c,)i Fl(disjunct)e
Fp(55,)i Fl(merge_sequ)o(en)o(ces)d Fp(67a,)j Fl(not_contrad)o(ic)o
(tor)o(y)e Fp(71a,)187 2176 y(and)h Fl(pattern)g Fp(55.)4
2251 y(65c)89 b Fo(h)p Fn(make)16 b Fr(keepname)d Fn(name)i(of)g
Fr(p1)g Fn(if)f Fr(p2)g Fn(is)h(\014eld)g(binding,)g(nul)r(l)g
(otherwise)f Fp(65c)p Fo(i)o(\021)89 b Fp(\(65b\))187
2301 y Fr(if)21 b(*p2.disjuncts)41 b(=)22 b(1)f(&)h(d)f(:=)h
(p2.disjuncts[1])c(&)252 2350 y(*d.sequents)85 b(=)22
b(1)f(&)h(s)f(:=)h(d.sequents[1])62 b(&)22 b(type\(s\))e(==)i
("sequent")e(&)252 2400 y(*s.constraints)f(=)j(1)f(&)h
(type\(s.constraint)o(s[1])o(\))d(==)i("fieldbinding")e(then)230
2450 y(keepname)i(:=)g(p1.name)145 2499 y Fp(Uses)12
b Fl(constraint)o(s)d Fp(136a,)h Fl(fieldbindi)o(ng)e
Fp(55,)j(and)g Fl(sequent)e Fp(55.)p eop
%%Page: 66 66
66 65 bop 129 141 a Fv(66)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y Fr(merge_sequences)c Fv(merges)j(from)f
(the)i(left)f(if)g(neither)h(sequence)h(has)f(a)f Fr(dots)g
Fv(there;)129 307 y(otherwise)18 b(it)f(merges)g(from)e(the)j(righ)o
(t.)27 b(Direction)17 b(is)g(determined)g(b)o(y)g Fr(inc)p
Fv(,)g(whic)o(h)g(is)129 357 y(added)d(to)g(a)f(list)g(index,)h(and)f
(b)o(y)g Fr(add)p Fv(,)g(whic)o(h)g(is)h(used)g(to)g(add)f(a)h(sequen)o
(t)h(to)e(the)h(result.)-13 420 y Fp(66a)88 b Fo(h)p
Fn(set)15 b Fr(grab)p Fn(,)f Fr(add)g Fn(and)i Fr(first)e
Fn(for)g(right-to-left)f Fp(66a)p Fo(i)o(\021)484 b Fp(\(67a\))171
469 y Fr(grab)21 b(:=)g(pull)171 519 y(add)g(:=)h(push)171
569 y(first)f(:=)g(-1)-15 652 y Fp(66b)88 b Fo(h)p Fn(set)15
b Fr(grab)p Fn(,)f Fr(add)g Fn(and)i Fr(first)e Fn(for)g(left-to-right)
f Fp(66b)p Fo(i)o(\021)482 b Fp(\(67a\))171 702 y Fr(grab)21
b(:=)g(get)171 752 y(add)g(:=)h(put)171 801 y(first)f(:=)g(1)p
eop
%%Page: 67 67
67 66 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(67)2 258 y Fp(67a)89 b Fo(h)p
Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1088 b Fm(/)6
b Fp(65b)22 b(68e)5 b Fm(.)187 307 y Fr(procedure)20
b(merge_sequences\()o(l1,)f(l2\))274 357 y(local)i(grab,)f(first,)h
(add)274 407 y(l1)g(:=)h(copy\(l1\))274 457 y(l2)f(:=)h(copy\(l2\))274
507 y(if)f(\(l1|l2\)[1])f(===)h(dots)g(then)318 557 y(if)g
(\(l1|l2\)[-1])e(===)j(dots)f(then)361 606 y Fo(h)p Fn(c)n(omplain)15
b(ab)n(out)h(dots)f Fp(68c)p Fo(i)318 656 y Fr(else)21
b({)p Fo(h)p Fn(set)14 b Fr(grab)p Fn(,)g Fr(add)g Fn(and)i
Fr(first)e Fn(for)g(right-to-left)f Fp(66a)p Fo(i)o Fr(})274
706 y(else)21 b({)p Fo(h)p Fn(set)15 b Fr(grab)p Fn(,)e
Fr(add)i Fn(and)g Fr(first)f Fn(for)g(left-to-right)f
Fp(66b)p Fo(i)o Fr(})274 806 y(l)22 b(:=)f([])274 855
y Fo(h)p Fn(suck)15 b(initial)f(lab)n(els)h(into)g Fr(l)f
Fp(67b)p Fo(i)274 905 y Fr(#)22 b(invariant:)d(initial)i(elements,)f
(if)h(present,)f(are)h(not)g(labels)274 955 y(while)g(l1[first])f(~===)
h(dots)g(&)g(l2[first])f(~===)h(dots)g(do)g({)318 1005
y(s1)g(:=)g(grab\(l1\))318 1055 y(s2)g(:=)g(grab\(l2\))318
1104 y(if)g(s1.class)f(~===)h(s2.class)f(then)361 1154
y Fo(h)p Fn(c)n(omplain)15 b(ab)n(out)h(class)e(mismatch)h
Fp(68d)p Fo(i)318 1204 y Fr(else)21 b(add\(l,)f(x)i(:=)f
(sequent\(merge_cons)o(trai)o(nts\(s)o(1.con)o(strai)o(nts,)d
(s2.constraints\),)753 1254 y(s1.class\)\))318 1304 y
Fo(h)p Fn(suck)d(initial)f(lab)n(els)g(into)h Fr(l)g
Fp(67b)p Fo(i)274 1354 y Fr(})274 1403 y(#)22 b(invariant:)d(initial)i
(elements,)f(if)h(present,)f(are)h(not)g(labels)274 1453
y(if)g(l1[first])f(===)h(dots)g(then)318 1503 y(while)f(add\(l,)h(dots)
g(~===)g(grab\(l2\)\))274 1553 y(else)g(if)g(l2[first])f(===)h(dots)g
(then)318 1603 y(while)f(add\(l,)h(dots)g(~===)g(grab\(l1\)\))274
1652 y(else)g(if)g(l1[first])f(then)318 1702 y Fo(h)p
Fn(c)n(omplain)15 b(of)g(right)f(se)n(quenc)n(e)h(to)n(o)g(short)g
Fp(68a)p Fo(i)274 1752 y Fr(else)21 b(if)g(l2[first])f(then)318
1802 y Fo(h)p Fn(c)n(omplain)15 b(of)g(left)f(se)n(quenc)n(e)h(to)n(o)g
(short)g Fp(68b)p Fo(i)274 1852 y Fr(#)22 b(else)f(they're)f(an)h
(exact)g(match;)g(do)g(nothing)274 1901 y(return)g(l)187
1951 y(end)145 2003 y Fp(De\014nes:)187 2043 y Fl(merge_sequ)o(enc)o
(es)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(65b.)145 2082
y(Uses)i Fl(constraint)o(s)d Fp(136a,)h Fl(dots)g Fp(62c,)h
Fl(merge_cons)o(tra)o(in)o(ts)e Fp(68e,)h(and)h Fl(sequent)e
Fp(55.)0 2173 y(67b)89 b Fo(h)p Fn(suck)16 b(initial)e(lab)n(els)g
(into)h Fr(l)g Fp(67b)p Fo(i)o(\021)785 b Fp(\(67a\))187
2223 y Fr(every)21 b(ll)g(:=)g(l1)h(|)f(l2)h(do)230 2273
y(while)f(type\(ll[first]\))e(==)i(\("patlabel")f(|)h
("latent_patlabel"\))d(do)274 2323 y(add\(l,)j(grab\(ll\)\))145
2375 y Fp(Uses)12 b Fl(latent_pat)o(lab)o(el)c Fp(55)j(and)g
Fl(patlabel)e Fp(55.)p eop
%%Page: 68 68
68 67 bop 129 141 a Fv(68)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-13 258 y Fp(68a)88 b Fo(h)p Fn(c)n(omplain)16
b(of)e(right)h(se)n(quenc)n(e)g(to)n(o)g(short)g Fp(68a)p
Fo(i)o(\021)567 b Fp(\(67a\))171 307 y Fr(error\("Shapes)19
b(differ)i(for)g(&;)g(right-hand)f(sequence)g(\(",)324
357 y(sequenceimage\(l)o(2\),)f("\))i(too)g(short)g(to)g(conjoin)g
(with)g(\(",)g(sequenceimage\(l1)o(\),)e("\)"\))129 406
y Fp(Uses)12 b Fl(conjoin)d Fp(186c)i(and)f Fl(sequenceima)o(ge)f
Fp(370c.)-15 483 y(68b)88 b Fo(h)p Fn(c)n(omplain)16
b(of)e(left)h(se)n(quenc)n(e)g(to)n(o)g(short)g Fp(68b)p
Fo(i)o(\021)593 b Fp(\(67a\))171 533 y Fr(error\("Shapes)19
b(differ)i(for)g(&;)g(left-hand)f(sequence)g(\(",)324
583 y(sequenceimage\(l)o(1\),)f("\))i(too)g(short)g(to)g(conjoin)g
(with)g(\(",)g(sequenceimage\(l2)o(\),)e("\)"\))129 631
y Fp(Uses)12 b Fl(conjoin)d Fp(186c)i(and)f Fl(sequenceima)o(ge)f
Fp(370c.)-12 709 y(68c)89 b Fo(h)p Fn(c)n(omplain)16
b(ab)n(out)f(dots)g Fp(68c)p Fo(i)o(\021)862 b Fp(\(67a\))171
759 y Fr(error\("Illegal)19 b(conjunction;)g(dots)i(on)h(both)e(left)h
(and)h(right)e(of)i(\(",)324 808 y(sequenceimage\(l)o(1\),)d("\))i(&)h
(\(",)f(sequenceimage\(l2)o(\),)e("\)"\))129 857 y Fp(Uses)12
b Fl(dots)e Fp(62c)h(and)g Fl(sequenceim)o(age)d Fp(370c.)-15
934 y(68d)88 b Fo(h)p Fn(c)n(omplain)16 b(ab)n(out)f(class)g(mismatch)f
Fp(68d)p Fo(i\021)658 b Fp(\(67a\))171 984 y Fr(error\("Shapes)19
b(differ)i(for)g(&;)g(left)g(sequent)f(from)h(class)g(`",)g
(s1.class.name,)302 1034 y("';)g(right)g(sequent)f(from)h(class)g(`",)g
(s2.class.name,)e("',)i(in\\n\\t\(",)302 1084 y(expimage\(s1\),)e("\))i
(&)h(\(",)f(expimage\(s2\),)e("\)"\))129 1132 y Fp(Uses)12
b Fl(expimage)d Fp(101a)h(and)h Fl(sequent)e Fp(55.)192
1196 y Fr(merge_constraint)o(s)g Fv(merges)j(t)o(w)o(o)f(sets)j(of)d
(constrain)o(ts,)i(preserving)g(the)f(in)o(v)n(arian)o(t)129
1246 y(that)i(a)g(\014eld)g(ma)o(y)e(app)q(ear)i(at)g(most)f(once)h(on)
g(an)o(y)f(list)h(of)f(constrain)o(ts.)-12 1304 y Fp(68e)89
b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1086
b Fm(/)6 b Fp(67a)22 b(69b)5 b Fm(.)171 1354 y Fr(procedure)20
b(merge_constraints)o(\(l1,)e(l2\))258 1404 y(local)j(c1,)g(c2,)g(S1,)g
(S2,)h(maxlo,)e(minhi)258 1454 y(S1)i(:=)f(set\(l1\))258
1504 y(S2)h(:=)f(set\(\))258 1553 y(every)g(c2)g(:=)h(!l2)f(do)302
1603 y(if)g(c1)g(:=)h(!S1)f(&)h(c1.field)e(===)h(c2.field)f(then)h({)h
(#)f(doubly-constrained)d(field)389 1653 y(if)j(type\(c1\))f(==)i
(type\(c2\))e(==)h("constraint")f(then)h({)476 1703 y(delete\(S1,)f
(c1\))476 1753 y Fo(h)p Fn(mer)n(ge)15 b Fr(c1)f Fn(and)i
Fr(c2)p Fn(,)e(inserting)g(r)n(esult)g(in)h Fr(S2)g Fp(68f)s
Fo(i)389 1803 y Fr(})21 b(else)454 1852 y Fo(h)p Fn(c)n(omplain)16
b(of)e(c)n(onstr)n(aint)h(c)n(on\015ict)g Fp(69a)p Fo(i)302
1902 y Fr(})21 b(else)389 1952 y(insert\(S2,)f(c2\))258
2002 y(return)h(sort\(S1)f(++)h(S2\))171 2052 y(end)129
2100 y Fp(De\014nes:)171 2139 y Fl(merge_cons)o(tra)o(int)o(s)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(67a.)129 2179 y(Uses)i
Fl(constraint)c Fp(55)j(and)g Fl(field)f Fp(55.)-7 2252
y(68f)89 b Fo(h)p Fn(mer)n(ge)15 b Fr(c1)f Fn(and)i Fr(c2)p
Fn(,)e(inserting)h(r)n(esult)f(in)h Fr(S2)f Fp(68f)s
Fo(i)o(\021)513 b Fp(\(68e\))171 2301 y Fr(maxlo)21 b(:=)g(c1.lo)g(<)g
(c2.lo)g(|)h(c1.lo)171 2351 y(minhi)f(:=)g(c1.hi)g(>)g(c2.hi)g(|)h
(c1.hi)171 2401 y(if)f(maxlo)g(>=)g(minhi)g(then)g(maxlo)g(:=)g(minhi)g
(:=)g(0)131 b(#)22 b(canonical)e(impossible)f(constraint)171
2451 y(insert\(S2,)h(constraint\(c1.fi)o(eld,)e(maxlo,)j(minhi\)\))129
2499 y Fp(Uses)12 b Fl(constraint)c Fp(55)j(and)g Fl(field)f
Fp(55.)p eop
%%Page: 69 69
69 68 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(69)2 258 y Fp(69a)89 b Fo(h)p
Fn(c)n(omplain)16 b(of)e(c)n(onstr)n(aint)h(c)n(on\015ict)g
Fp(69a)p Fo(i)o(\021)672 b Fp(\(68e\))187 307 y Fr(error\("Code)19
b(and)i(constraint)f(\(or)h(inconsistent)f(code\))g(for)i(field)e(`",)i
(c1.field.name,)318 357 y("\\n\\t",)e(constraintimage\(c)o(1\),)f
("\\n\\t",)h(constraintimage\(c)o(2\)\))145 409 y Fp(Uses)12
b Fl(constraint)c Fp(55,)j Fl(constraint)o(ima)o(ge)d
Fp(371a)j(371a,)f(and)h Fl(field)e Fp(55.)0 500 y(69b)89
b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1090
b Fm(/)5 b Fp(68e)23 b(70a)5 b Fm(.)187 550 y Fr(procedure)20
b(strip_patlabels\()o(s\))230 600 y(if)i(type\(!s\))e(==)h("patlabel")f
(then)h(&null)g(else)g(return)f(s)230 650 y(l)i(:=)f([])230
700 y(every)g(put\(l,)g(1\(x)g(:=)g(!s,)g(type\(x\))g(~==)g
("patlabel"\)\))230 750 y(return)g(l)187 799 y(end)145
851 y Fp(Uses)12 b Fl(patlabel)d Fp(55.)145 1009 y Fj(4.2)66
b(Preparing)24 b(patterns)f(for)f(emission)145 1100 y
Fv(Fields)14 b(within)g(a)g(sequen)o(t)h(can)f(b)q(e)h(constrained)g
(either)g(b)o(y)f(\014eld)g(bindings)f(or)h(b)o(y)g(range)145
1150 y(constrain)o(ts.)21 b(Giv)o(en)14 b(a)g(sequen)o(t)i
Fi(S)i Fv(and)c(a)g(\014eld)h Fi(F)6 b Fv(,)14 b Fi(S)j
Fv(ma)o(y)c(con)o(tain)h(at)g(most)g(one)g(\014eld)145
1200 y(binding)d(of)h Fi(F)17 b Fv(and)12 b(at)g(most)f(one)h
(constrain)o(t)h(on)f Fi(F)6 b Fv(.)16 b(\(The)d(old)e(in)o(v)n(arian)o
(t)g(didn't)g(p)q(ermit)145 1250 y(b)q(oth.\))19 b(Here)c(are)f(the)h
(seman)o(tics:)208 1333 y Fo(\017)20 b Fv(on)c(output)g(\(enco)q
(ding\),)g(a)g(\014eld)g(binding)f(is)h(a)f(string)h(that)g(is)g(an)g
(rv)n(alue)f(in)h(the)249 1382 y(target)f(language)f(\(e.g.)20
b(C\).)14 b(The)h(rv)n(alue)g(will)e(b)q(e)i(assigned)g(to)f(the)i
(\014eld)e(f)h(in)f(the)249 1432 y(output)g(pattern)208
1515 y Fo(\017)20 b Fv(on)14 b(input)h(\(deco)q(ding\),)g(a)f(\014eld)h
(binding)e(m)o(ust)h(b)q(e)h(an)g(iden)o(ti\014er.)20
b(that)15 b(iden)o(ti\014er)249 1565 y(will)g(b)q(e)j(declared)f(as)g
(a)f(readonly)h(v)n(ariable)e(in)h(an)h(inner)g(scop)q(e,)h(and)e(it)h
(will)e(b)q(e)249 1615 y(initialized)d(to)i(the)h(v)n(alue)e(of)g(the)i
(\014eld)208 1698 y Fo(\017)20 b Fv(on)e(output,)g(a)f(constrain)o(t)h
(ma)o(y)e(determine)i(the)g(v)n(alue)f(of)g(a)h(\014eld)g(uniquely)m(,)
f(in)249 1748 y(whic)o(h)h(case)h(that)e(v)n(alue)h(is)f(assigned)h(to)
g(the)g(\014eld.)30 b(if)17 b(the)i(constrain)o(t)f(do)q(esn't)249
1798 y(determine)c(the)g(v)n(alue)f(uniquely)m(,)f(there)i(m)o(ust)f(b)
q(e)h(a)f(\014eld)h(binding)e(that)i(do)q(es.)19 b(on)249
1847 y(input,)13 b(a)h(constrain)o(t)g(limits)e(the)i(n)o(um)o(b)q(er)f
(of)h(w)o(ord)f(sequences)k(that)d(can)g(matc)o(h.)145
1930 y(Priorit)o(y:)208 2013 y Fo(\017)20 b Fv(on)d(input,)f(there)i
(can)f(nev)o(er)h(b)q(e)f(a)g(con\015ict)g(b)q(et)o(w)o(een)h(a)e
(constrain)o(t)h(and)g(a)f(\014eld)249 2063 y(binding;)c(they)j(can)f
(b)q(e)h(handled)e(indep)q(enden)o(tly)m(.)208 2146 y
Fo(\017)20 b Fv(on)15 b(output,)g(the)h(con\015ict)g(should)f(b)q(e)h
(handled)f(as)g(follo)o(ws:)k(b)q(efore)d(handing)f(the)249
2196 y(pattern)c(to)f(an)f(emit)g(pro)q(cedure,)j(w)o(e)e(run)h(a)e
(transformation)f(o)o(v)o(er)i(it)g(that)g(remo)o(v)o(es)249
2246 y(the)j(constrain)o(t)g(and)g(turns)g(it)f(in)o(to)g(a)g
(target-co)q(de)i(constrain)o(t)f(whic)o(h)g(guaran)o(tees)249
2296 y(that)f(the)g(v)n(alue)g(in)f(the)i(binding)d(satis\014es)j(the)g
(constrain)o(t.)18 b(That)11 b(transformation)249 2346
y(is)j Fr(sanitize_for_out)o(put)p Fv(.)p eop
%%Page: 70 70
70 69 bop 129 141 a Fv(70)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y Fr(sanitize_for_out)o(put)g
Fv(accepts)19 b(a)d(sequen)o(t)i(and)e(returns)j(a)d(smaller)f(sequen)o
(t)j(in)129 307 y(whic)o(h)e(at)g(most)e(one)i(constrain)o(t)g(is)g
(presen)o(t)h(for)f(eac)o(h)g(\014eld.)23 b(Sup)q(er\015uous)18
b(range)d(con-)129 357 y(strain)o(ts)g(are)f(transformed)f(in)o(to)g
(conditions)h(and)g(b)q(ound)g(to)f(the)i(disjunct)f
Fr(d)p Fv(.)-13 420 y Fp(70a)88 b Fo(h)p Fn(*)16 b Fp(55)p
Fo(i)o Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(69b)22 b(70c)5
b Fm(.)171 469 y Fr(procedure)20 b(sanitize_for_outp)o(ut\(se)o(q,)f
(conditions\))258 519 y(local)i(fields,)f(outconstraints)258
569 y Fo(h)p Fn(if)15 b(no)g(\014eld)g(is)g(over)n(c)n(onstr)n(aine)n
(d,)f Fr(return)21 b(seq)14 b Fp(70b)p Fo(i)258 619 y
Fr(warning\("Sanitizin)o(g)19 b(",)i(expimage\(seq\)\))258
669 y(fields)g(:=)g(set\(\))258 718 y(outconstraints)e(:=)i([])174
b(#)22 b(will)f(be)g(constraints)f(of)h(new)g(sequent)258
768 y(every)g(insert\(fields,)e(\(!seq.constraint)o(s\).fi)o(eld\))258
818 y(every)i(f)g(:=)h(!fields)e(do)i({)324 868 y(\(\(fb)e(:=)i
(!seq.constraints\))o(.fiel)o(d)d(==)i(f,)h(type\(fb\))e(==)h
("fieldbinding"\))e(|)i(\(fb)h(:=)f(&null\))324 918 y(\(\(rc)f(:=)i
(!seq.constraints\))o(.fiel)o(d)d(==)i(f,)h(type\(rc\))e(==)h
("constraint"\))63 b(|)21 b(\(rc)h(:=)f(&null\))324 967
y(if)g(\\fb)g(&)h(\\rc)f(then)g({)367 1017 y(put\(outconstraints)o(,)e
(fb\))367 1067 y(insert_constraint_)o(condi)o(tions)o(\(con)o(ditio)o
(ns,)g(rc,)i(fb.code\))324 1117 y(})g(else)g({)367 1167
y(put\(outconstraints)o(,)e(\\fb)i(|)h(\\rc\))324 1217
y(})258 1266 y(})258 1316 y(return)f(sequent\(outconst)o(raint)o(s,)e
(seq.class\))171 1366 y(end)129 1418 y Fp(De\014nes:)171
1457 y Fl(sanitize_f)o(or_)o(out)o(put)o Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(194a.)129 1497 y(Uses)k Fl(constraint)d Fp(55,)i
Fl(constraint)o(s)e Fp(136a,)h Fl(expimage)g Fp(101a,)g
Fl(field)g Fp(55,)h Fl(fieldbindin)o(g)e Fp(55,)171 1536
y Fl(insert_con)o(str)o(ain)o(t_c)o(on)o(dit)o(ion)o(s)e
Fp(70c,)h(and)h Fl(sequent)e Fp(55.)-15 1619 y(70b)88
b Fo(h)p Fn(if)15 b(no)g(\014eld)g(is)g(over)n(c)n(onstr)n(aine)n(d,)f
Fr(return)21 b(seq)14 b Fp(70b)p Fo(i)o(\021)461 b Fp(\(70a\))171
1669 y Fr(if)21 b(type\(seq\))f(==)i("sequent")e(&)236
1719 y(c1)i(:=)f(!seq.constraints)e(&)i(c2)h(:=)f(!seq.constraints)d(&)
236 1769 y(c1)k(~===)f(c2)g(&)h(c1.field)e(===)h(c2.field)f(&)i
(type\(c1\))e(~==)h(type\(c2\))f(then)h(&null)171 1818
y(else)236 1868 y(return)g(seq)129 1920 y Fp(Uses)12
b Fl(constraints)c Fp(136a,)i Fl(field)g Fp(55,)h(and)g
Fl(sequent)e Fp(55.)-12 2011 y(70c)89 b Fo(h)p Fn(*)16
b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(70a)22
b(71a)5 b Fm(.)171 2061 y Fr(procedure)20 b(insert_constraint)o(_cond)o
(ition)o(s\(co)o(nditi)o(ons,)e(rc,)k(code\))215 2111
y(every)e(insert_condition\(co)o(nditi)o(ons,)e(eqn\()370
b(0)22 b(<)f(rc.lo,)g("<=",)f(code\))h(|)977 2161 y
(eqn\(2^fwidth\(rc.fie)o(ld\))e(>)i(rc.hi,)g(">",)42
b(code\)\))215 2211 y(return)171 2261 y(end)129 2312
y Fp(De\014nes:)171 2352 y Fl(insert_con)o(str)o(ain)o(t_c)o(on)o(dit)o
(ion)o(s)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(70a.)129
2391 y(Uses)i Fl(eqn)f Fp(83c,)f Fl(field)g Fp(55,)h
Fl(fwidth)f Fp(115d,)g(and)h Fl(insert_co)o(ndi)o(tio)o(n)e
Fp(126c.)p eop
%%Page: 71 71
71 70 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(71)145 258 y Fj(4.3)66 b(Eliminati)q(ng)25
b(con)n(tradictions)145 349 y Fv(On)16 b(the)f(In)o(tel)g(486,)g(some)f
(mo)q(di\014ers)g(ma)o(y)f(b)q(e)j(used)g(only)e(with)h(certain)h(op)q
(co)q(des,)g(e.g.,)145 398 y Fr(grp3.Eb)21 b(|)g(grp3.Ev)p
Fv(.)26 b(When)17 b(suc)o(h)h(a)f(disjunction)g(is)f(conjoined)h(with)g
(a)g(particular)145 448 y(op)q(co)q(de,)d(the)h(result)g(con)o(tains)e
(con)o(tradictions,)h(e.g.)312 540 y Fr(\(grp3.Eb)20
b(|)h(grp3.Ev\))g(&)g(grp3.Eb)10 b Fo(\021)i Fr(grp3.Eb)20
b(|)i Fn(imp)n(ossible)o Fi(:)145 631 y Fr(not_contradictory)11
b Fv(can)j(b)q(e)g(applied)g(to)g(a)f(disjunct;)h(it)g(succeeds)i(if)e
(and)f(only)h(if)f(the)145 681 y(disjunct)i(con)o(tains)f(no)f(imp)q
(ossible)g(constrain)o(ts.)19 b(W)m(e)13 b(migh)o(t)f(one)j(da)o(y)e
(decide)i(to)f(use)h(it)145 730 y(to)f(eliminate)e(disjuncts)i(with)g
(conditions)g(that)g(are)g(eviden)o(tly)g(alw)o(a)o(ys)e(false.)2
793 y Fp(71a)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1088 b Fm(/)6 b Fp(70c)22 b(71b)5 b Fm(.)187
843 y Fr(procedure)20 b(not_contradictor)o(y\(d\))209
892 y(if)h(s)h(:=)f(!d.sequents)85 b(&)21 b(type\(s\))g(==)g("sequent")
f(&)274 942 y(c)i(:=)f(!s.constraints)e(&)i(type\(c\))g(==)g
("constraint")e(&)j(c.lo)f(>=)g(c.hi)g(then)g(fail)209
992 y(else)g(return)f(d)187 1042 y(end)145 1094 y Fp(De\014nes:)187
1133 y Fl(not_contra)o(dic)o(to)o(ry)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(65b.)145 1173 y(Uses)i Fl(constraint)c Fp(55,)j
Fl(constraint)o(s)e Fp(136a,)h Fl(fail)g Fp(410,)h(and)f
Fl(sequent)g Fp(55.)208 1235 y Fr(eliminate_contr)o(adict)o(ions)h
Fv(returns)17 b(a)e(pattern)g(without)g(an)o(y)f(imp)q(ossible)g(dis-)
145 1285 y(juncts)0 1347 y Fp(71b)89 b Fo(h)p Fn(*)15
b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(71a)22
b(72a)5 b Fm(.)187 1397 y Fr(procedure)20 b(eliminate_contra)o(dicti)o
(ons\(p)o(\))230 1447 y(return)h(if)g(d)h(:=)f(!p.disjuncts)63
b(&)448 1496 y(s)22 b(:=)f(!d.sequents)85 b(&)22 b(type\(s\))e(==)h
("sequent")f(&)448 1546 y(c)i(:=)f(!s.constraints)e(&)j(type\(c\))e(==)
h("constraint")f(&)h(c.lo)g(>=)h(c.hi)f(then)274 1596
y({impossible\("cont)o(radic)o(tion)d(now)k(eliminated)d(at)j
(conjunction"\))296 1646 y Fo(h)p Fn(new)15 b(p)n(attern)f(with)h(c)n
(ontr)n(adictions)f(eliminate)n(d)h Fp(71c)p Fo(i)o Fr(})230
1696 y(else)21 b(p)187 1745 y(end)145 1797 y Fp(De\014nes:)187
1837 y Fl(eliminate_)o(con)o(tr)o(adi)o(cti)o(ons)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)d(169.)145 1876 y(Uses)j Fl(constraint)c
Fp(55,)j Fl(constraint)o(s)e Fp(136a,)h(and)h Fl(sequent)e
Fp(55.)4 1959 y(71c)89 b Fo(h)p Fn(new)15 b(p)n(attern)g(with)f(c)n
(ontr)n(adictions)h(eliminate)n(d)g Fp(71c)p Fo(i)o(\021)448
b Fp(\(71b\))187 2009 y Fr(l)21 b(:=)h([])187 2059 y(every)f(d)g(:=)h
(!p.disjuncts)d(do)230 2109 y(if)j(s)f(:=)h(!d.sequents)85
b(&)21 b(type\(s\))g(==)g("sequent")f(&)296 2158 y(c)h(:=)h
(!s.constraints)d(&)i(type\(c\))g(==)g("constraint")e(&)j(c.lo)f(>=)g
(c.hi)g(then)274 2208 y(&null)230 2258 y(else)274 2308
y(put\(l,)g(d\))187 2358 y(pattern\(l,)f(p.name\))145
2410 y Fp(Uses)12 b Fl(constraint)c Fp(55,)j Fl(constraint)o(s)e
Fp(136a,)h Fl(pattern)f Fp(55,)i(and)g Fl(sequent)e Fp(55.)p
eop
%%Page: 72 72
72 71 bop 129 141 a Fv(72)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)129 258 y Fj(4.4)67 b(F)-6 b(unctions)24
b(on)e(patterns)129 349 y Fr(place_holder)15 b Fv(tak)o(es)i(a)f
(disjunct)i(and)e(returns)j(a)d(disjunct)h(that)g(ma)o(y)e(b)q(e)i
(used)h(as)f(a)129 398 y(place)e(holder)e(for)h(it.)-13
461 y Fp(72a)88 b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p
Fo(\021)1088 b Fm(/)6 b Fp(71b)22 b(72c)5 b Fm(.)171
510 y Fr(procedure)20 b(place_holder\(d\))215 560 y(local)g(shape,)h
(class)215 610 y(shape)f(:=)i(shapeof\(d\))215 660 y
Fo(h)p Fn(c)n(omplain)15 b(if)f(some)h(class)g(in)g Fr(shape)f
Fn(has)h(no)g(plac)n(eholder)g Fp(72b)p Fo(i)215 710
y Fr(p)21 b(:=)h(epsilon\(\))215 760 y(every)e(class)h(:=)g(!shape)g
(do)g(p)h(:=)f(seqp\(p,)g(class.holder\))215 809 y(*p.disjuncts)e(=)i
(1)h(|)g(impossible\("Some)c(placeholder)i(has)h(multiple)f
(disjuncts"\))215 859 y(return)g(p.disjuncts[1])171 909
y(end)129 961 y Fp(De\014nes:)171 1000 y Fl(place_hold)o(er)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(205b)g(and)h(216.)129
1040 y(Uses)h Fl(epsilon)d Fp(62b,)i Fl(seqp)f Fp(63a,)h(and)f
Fl(shapeof)g Fp(73a.)-15 1123 y(72b)88 b Fo(h)p Fn(c)n(omplain)16
b(if)e(some)h(class)g(in)g Fr(shape)f Fn(has)h(no)g(plac)n(eholder)g
Fp(72b)p Fo(i)o(\021)287 b Fp(\(72a\))171 1173 y Fr(if)21
b(/\(class)g(:=)g(!shape\).holder)e(then)258 1222 y(error\("No)h
(placeholder)g(is)h(defined)f(for)h(class)g(",)h(class.name\))129
1274 y Fp(Uses)12 b Fl(defined)d Fp(136a.)129 1345 y
Fr(pattern_length)i Fv(computes)j(the)h(length)e(in)h(bits)g(of)f(a)h
(pattern)g(in)g(normal)e(form.)-12 1407 y Fp(72c)89 b
Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1086 b
Fm(/)6 b Fp(72a)22 b(72d)5 b Fm(.)171 1457 y Fr(procedure)20
b(pattern_length\(p\))215 1507 y(local)g(shapes,)h(class)215
1557 y(shapes)f(:=)h(maplist\(disjunct_len)o(gth,)d(p.disjuncts\))215
1606 y(*shapes)i(>)h(0)h(|)g(error\("length)d(of)i(impossible)f
(pattern"\))215 1656 y(if)h(!shapes)f(~=)i(shapes[1])e(then)h
(error\("Length)e(of)i(pattern)f(",)i(patimage\(p\),)d(")j(is)f(not)g
(fixed"\))215 1706 y(return)f(shapes[1])171 1756 y(end)129
1808 y Fp(De\014nes:)171 1847 y Fl(pattern_le)o(ngt)o(h)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(37b.)129 1887 y(Uses)i
Fl(disjunct_le)o(ngt)o(h)d Fp(72d,)h Fl(patimage)f Fp(372a,)h(and)h
Fl(pattern)e Fp(55.)-15 1970 y(72d)88 b Fo(h)p Fn(*)16
b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1090 b Fm(/)6 b Fp(72c)22
b(73a)5 b Fm(.)171 2019 y Fr(procedure)20 b(disjunct_length\(d)o(\))215
2069 y(n)h(:=)h(0)215 2119 y(every)e(s)i(:=)f(!d.sequents)f(&)h
(type\(s\))g(==)g("sequent")f(do)258 2169 y(n)i(+:=)f(s.class.size)215
2219 y(return)f(n)171 2268 y(end)129 2320 y Fp(De\014nes:)171
2360 y Fl(disjunct_l)o(eng)o(th)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f
(72c.)129 2399 y(Uses)i Fl(sequent)d Fp(55.)p eop
%%Page: 73 73
73 72 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(73)2 258 y Fp(73a)89 b Fo(h)p
Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1084 b Fm(/)6
b Fp(72d)22 b(73b)5 b Fm(.)187 307 y Fr(procedure)20
b(shapeof\(d\))230 357 y(l)i(:=)f([])230 407 y(every)g(s)h(:=)f
(!d.sequents)f(&)h(type\(s\))g(==)g("sequent")f(do)274
457 y(put\(l,)h(s.class\))230 507 y(return)g(l)187 557
y(end)145 608 y Fp(De\014nes:)187 648 y Fl(shapeof)p
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(72a.)145 687 y(Uses)i
Fl(sequent)d Fp(55.)208 758 y Fv(A)14 b(pattern)i(is)f(a)f(legitimate)f
(global)g(pattern)j(if)e(it)g(has)h(no)g(conditions)f(and)h(no)f
(\014eld)145 808 y(bindings)g(and)f(if)g(no)h(lab)q(els)g(are)g(named.)
0 870 y Fp(73b)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1106 b Fm(/)5 b Fp(73a)23 b(74)5 b Fm(.)187 920
y Fr(procedure)20 b(insist_global_pa)o(ttern)o(\(p\))230
970 y(if)i(d)f(:=)h(!p.disjuncts)d(&)j(*\\d.conditions)d(>)i(0)h(then)
274 1019 y(error\(patimage\(p\))o(,)d(")j(cannot)e(be)i(used)f(on)g
(the)g(right-hand)f(side;)h(there)f(are)h(conditions"\))230
1069 y(else)g(if)h(d)f(:=)h(!p.disjuncts)d(&)j(type\(s)e(:=)i
(!d.sequents\))d(==)i("sequent")f(&)339 1119 y(type\(!s.constraints)o
(\))f(==)i("fieldbinding")e(then)274 1169 y(error\(patimage\(p\))o(,)g
(")j(cannot)e(be)i(used)f(on)g(the)g(right-hand)f(side;)h(there)f(are)h
(inputs"\))230 1219 y(else)g(if)h(d)f(:=)h(!p.disjuncts)d(&)j(type\(s)e
(:=)i(!d.sequents\))d(==)i("patlabel")f(&)i(\\s.name)e(then)274
1268 y(error\(patimage\(p\))o(,)f(")j(cannot)e(be)i(used)f(on)g(the)g
(right-hand)f(side;)h(there's)f(a)h(loose)g(label"\))230
1318 y(else)274 1368 y(return)187 1418 y(end)145 1470
y Fp(De\014nes:)187 1509 y Fl(insist_glo)o(bal)o(_p)o(att)o(ern)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(43b.)145 1549 y(Uses)k
Fl(constraints)c Fp(136a,)j Fl(fieldbind)o(ing)d Fp(55,)k
Fl(label)e Fp(383a,)g Fl(patimage)f Fp(372a,)i Fl(patlabel)e
Fp(55,)187 1588 y Fl(sequent)e Fp(55,)i(and)g Fl(used)f
Fp(136a.)p eop
%%Page: 74 74
74 73 bop 129 141 a Fv(74)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)129 258 y Fj(4.5)67 b(In)n(terpreting)17
b(abstract)e(syn)n(tax)g(in)n(to)h(normal)g(form)129
357 y Ft(4.5.1)56 b(T)-5 b(ree)18 b(w)n(alking)g(with)h(free)f(v)m
(ariables)129 433 y Fv(This)11 b(co)q(de)g(is)f(used)i(on)e(the)h(deco)
q(ding)f(end,)i(where)f(free)g(v)n(ariables)f(in)g(patterns)i(are)e
(OK|)129 483 y(they)20 b(b)q(ecome)g(binding)e(instances.)36
b Fr(pnf_recurse)17 b Fv(pro)q(duces)j(a)g(pattern)g(in)f(normal)129
533 y(form.)34 b(If)19 b(the)h Fr(free_env)e Fv(argumen)o(t)g(is)i
(non-n)o(ull,)f(then)h(certain)g(free)g(v)n(ariables)f(are)129
583 y(p)q(ermitted,)d(and)g(the)h(bindings)e(of)g(the)i(free)g(v)n
(ariables)e(are)i(plan)o(ted)e(in)h Fr(free_env)p Fv(.)23
b(In)129 633 y(fact,)c(only)e(bindings)g(of)g(constructor-t)o(yp)q(ed)j
(constructor)g(argumen)o(ts)d(really)g(go)g(in)o(to)129
683 y(this)i(en)o(vironmen)o(t|bindings)d(of)i(free)h(v)n(ariables)f
(in)g(\014eld)g(bindings)g(are)g(handled)h(b)o(y)129
732 y(the)c(equation-solving)d(mec)o(hanism,)f(and)i(pattern)h(iden)o
(ti\014ers)h(are)f(nev)o(er)g(p)q(ermitted)g(to)129 782
y(b)q(e)f(free)h(v)n(ariables)d(\(ho)o(w)h(could)g(they)h(b)q(e)g
(binding)e(instances\).)19 b(What)12 b(ab)q(out)g(lab)q(els????)4
844 y Fp(74)89 b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p
Fo(\021)1104 b Fm(/)5 b Fp(73b)23 b(75)5 b Fm(.)171 894
y Fr(procedure)20 b(pnf\(p,)g(rho,)h(free_env\))215 944
y(return)f(eliminate_instance)o(s\(pnf)o(_recu)o(rse\()o(p,)f(rho,)i
(free_env\)\))171 994 y(end)129 1046 y Fp(De\014nes:)171
1085 y Fl(pnf)p Fp(,)10 b(used)h(in)g(c)o(h)o(unks)f(37a,)h(43a,)f
(170a,)g(and)h(260.)129 1125 y(Uses)h Fl(eliminate_i)o(nst)o(an)o(ces)c
Fp(178a)i(and)h Fl(pnf_recurs)o(e)e Fp(75.)p eop
%%Page: 75 75
75 74 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(75)208 258 y Fr(pnf_recurse)16
b Fv(con)o(v)o(erts)k(a)e(pattern)i(in)e(abstract)i(syn)o(tax)f(in)o
(to)f(its)h(normal)e(form.)145 307 y(The)d(meaning)d(of)h(an)g(applied)
h(constructor)h(dep)q(ends)h(on)d(the)i(en)o(vironmen)o(t)e(in)g(whic)o
(h)h(it)145 357 y(is)i(ev)n(aluated;)f(w)o(e)g(use)i
Fr(explode_apps)11 b Fv(to)k(pro)q(duce)g(the)g(application\(s\))f
(denoted)h(b)o(y)g(a)145 407 y(constructor)h(application.)20
469 y Fp(75)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1104 b Fm(/)5 b Fp(74)23 b(76b)5 b Fm(.)187 519
y Fr(procedure)20 b(pnf_recurse\(p,)f(rho,)i(free_env\))230
569 y(x)h(:=)f(case)g(type\(p\))g(of)g({)274 619 y("pattern")f(:)h(p)
274 669 y("Pident")42 b(:)21 b(project\(x)f(:=)i(lookup\(p.name,)d
(rho\),)h("pattern"\))g(|)601 718 y(typeerror\(x,)f("pattern)h(or)i
(field)e(operand",)g(p.name,)h(rho\))535 768 y(#)h(can)f(never)g(be)g
(a)h(free)f(identifier)274 818 y("Plabel")42 b(:)21 b
(label2pattern\(p.name)o(\))274 868 y("Pcon")86 b(:)21
b({)h(f)g(:=)f(lookuptype\(p.name,)d("field",)i(rho\))579
918 y(#)i(free)f(identifiers)e(in)j(constraint)d(are)i(always)g(OK)579
967 y Fo(h)p Fn(c)n(onstr)n(aint)15 b(or)f(\014eld)i(binding,)f(dep)n
(ending)h(on)f(the)g(typ)n(e)g(of)g Fr(p.value)e Fp(76a)p
Fo(i)535 1017 y Fr(})274 1067 y("Pand")86 b(:)21 b(pnfreduce\(andp,)41
b(p.patterns,)19 b(rho,)i(free_env\))274 1117 y("Por")108
b(:)21 b(pnfreduce\(orp,)63 b(p.patterns,)19 b(rho,)i(free_env\))274
1167 y("Pseq")86 b(:)21 b(pnfreduce\(seqp,)41 b(p.patterns,)19
b(rho,)i(free_env\))274 1217 y("Papp")86 b(:)21 b(if)h
(\(type\(p.cons\))d(==)i("list"\))g(then)579 1266 y
(pnf_recurse\(explod)o(e_app)o(s\(p.)o(cons,)d(p.args,)j(rho\),)f(rho,)
h(free_env\))535 1316 y(else)g(apply_constructor\(p.)o(cons)o(,)e
(p.args,)h(rho,)h(free_env\))274 1366 y("Plist")64 b(:)21
b(maplist3\(pnf_recurse)o(,)e(p.patterns,)g(rho,)i(free_env\))296
1416 y(default)42 b(:)21 b(impossible\("pnf_recu)o(rse"\))230
1466 y(})230 1515 y(if)h(\\showpnf)e(then)h(PPxwrite\(PPnew\(&o)o
(utput)o(\),)296 1565 y("pnf_recurse\(",)d(image\(if)j(type\(p\))f(==)h
("Pident")f(then)h(p.name)g(else)g(p\),)296 1615 y("\))g(returns:)f
($t${)h($o",)g(ppexpimage\(x\),)e("$b$}"\))230 1665 y(return)i(x)187
1715 y(end)145 1767 y Fp(De\014nes:)187 1806 y Fl(pnf_recurs)o(e)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(74)h(and)g(77c.)145
1845 y(Uses)j Fl(andp)e Fp(63a,)g Fl(apply_cons)o(tr)o(uct)o(or)e
Fp(173a,)i Fl(constraint)e Fp(55,)i Fl(explode_app)o(s)e
Fp(41b,)i Fl(field)g Fp(55,)187 1885 y Fl(label2patt)o(ern)7
b Fp(60a,)i Fl(lookup)g Fp(25a,)h Fl(lookuptyp)o(e)e
Fp(25a,)h Fl(orp)h Fp(63a,)f Fl(Pand)h Fp(41a,)f Fl(Papp)h
Fp(41a,)f Fl(pattern)f Fp(55,)187 1924 y Fl(Pcon)i Fp(41a,)h
Fl(Pident)f Fp(41a,)h Fl(Plabel)f Fp(41a,)h Fl(Plist)f
Fp(41a,)h Fl(pnfreduce)e Fp(77c,)i Fl(Por)g Fp(41a,)g
Fl(ppexpimage)d Fp(101d,)187 1964 y Fl(project)h Fp(29,)i
Fl(Pseq)f Fp(41a,)h Fl(seqp)f Fp(63a,)h Fl(showpnf)e
Fp(21b,)h(and)h Fl(typeerror)d Fp(28b.)p eop
%%Page: 76 76
76 75 bop 129 141 a Fv(76)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(Before)j(trying)f(to)g(di\013eren)o
(tiate)h(a)g(\014eld)f(binding)f(from)g(a)h(constrain)o(t,)h(w)o(e)f(p)
q(erform)129 307 y(the)g(appropriate)f(mapping)e(on)i(lists)g(of)g
(constrain)o(ts)h(\(whic)o(h)f(w)o(e)g(get)h(when)f(generators)129
357 y(are)i(used\).)22 b(W)m(e)14 b(can)h(tak)o(e)g(a)g(short)g(cut)h
(for)e(the)i(case)g(of)e(a)h(list,)f(b)q(ecause)i(w)o(e)g(kno)o(w)e
(the)129 407 y(suc)o(k)o(ers)i(are)e(alw)o(a)o(ys)f(in)o
(tegers|generators)i(can't)f(b)q(e)h(used)g(with)e(expressions.)-13
469 y Fp(76a)88 b Fo(h)p Fn(c)n(onstr)n(aint)15 b(or)g(\014eld)g
(binding,)g(dep)n(ending)h(on)f(the)g(typ)n(e)g(of)g
Fr(p.value)f Fp(76a)p Fo(i)o(\021)132 b Fp(\(75\))171
519 y Fr(case)21 b(type\(p.value\))e(of)i({)215 569 y("Glist")63
b(:)22 b({)g(l)f(:=)h([])520 619 y(every)e(put\(l,)h(conspat\(f,)f
(p.relop,)g(!p.value.values\)\))520 669 y(l)476 718 y(})215
768 y(default)63 b(:)22 b(constraint_or_bind)o(ing\(f)o(,)d(p.relop,)h
(p.value,)g(rho,)h(free_env\))171 818 y(})129 870 y Fp(Uses)12
b Fl(conspat)d Fp(61,)i Fl(constraint_)o(or_)o(bin)o(di)o(ng)e
Fp(77a,)h Fl(Glist)g Fp(42b,)g(and)h Fl(value)f Fp(136a.)192
932 y Fv(No)o(w)i(w)o(e)h(ha)o(v)o(e)f(to)h(deal)f(with)g(an)h
(expression)g(on)g(the)g(righ)o(t-hand)f(side)h(of)f(a)g(binding.)129
982 y(The)k(distinction)f(b)q(et)o(w)o(een)i(a)e(constrain)o(t)g(and)g
(a)g(binding)f(hinges)i(on)f(whether)i(the)e(ex-)129
1032 y(pression)i(is)f(constan)o(t.)25 b(Since)16 b(iden)o(ti\014ers)h
(in)e(bindings)g(could)h(b)q(e)h(free)f(v)n(ariables,)f(\014eld)129
1082 y(names,)e(or)h(`other',)f(w)o(e)h(b)q(egin)g(with)g(a)f
(substitution.)-15 1144 y Fp(76b)88 b Fo(h)p Fn(*)16
b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1106 b Fm(/)5 b Fp(75)23
b(77a)5 b Fm(.)171 1194 y Fr(procedure)20 b(binding_subst_f\(e)o(,)f
(rho,)i(free_env\))215 1244 y(return)f(if)h(type\(e\))g(==)g("string")f
(then)258 1293 y(\(if)h(is_defined\(e,)e(rho\))i(then)324
1343 y(project\(lookup\()o(e,)e(rho\),)i("integer"\))280
1393 y(else)324 1443 y(new_binding_ins)o(tance)o(\(e,)e(e,)i
("integer",)f(\\free_env\))258 1493 y(\))i(|)f(typeerror\(lookup\(e,)d
(rho\),)j("integer",)f(e,)h(rho\))171 1542 y(end)129
1594 y Fp(De\014nes:)171 1634 y Fl(binding_su)o(bst)o(_f)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(77a.)129 1673 y(Uses)17
b Fl(is_defined)c Fp(25a,)i Fl(lookup)f Fp(25a,)h Fl(new_binding)o(_in)
o(st)o(anc)o(e)e Fp(77b,)j Fl(project)d Fp(29,)171 1713
y(and)e Fl(typeerror)d Fp(28b.)p eop
%%Page: 77 77
77 76 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(77)208 258 y(No)o(w)13 b(w)o(e)h(can)g(mak)o
(e)f(the)h(distinction:)2 317 y Fp(77a)89 b Fo(h)p Fn(*)15
b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1084 b Fm(/)6 b Fp(76b)22
b(77b)5 b Fm(.)187 367 y Fr(procedure)20 b(constraint_or_bi)o(nding)o
(\(f,)f(relop,)h(val,)h(rho,)g(free_env\))230 416 y(val)h(:=)f
(super_simplify\(gs)o(ubst\()o(val,)d(binding_subst_f,)h
(fieldname_env_for)o(\(f\))f(|||)k(rho,)862 466 y(free_env\)\))230
516 y(val)g(:=)f(constant\(val\))e(#)j(might)e(fail)h(if)h(expression)d
(not)j(constant)230 566 y(if)g(type\(val\))e(==)h("integer")f(then)274
616 y(return)h(conspat\(f,)e(relop,)i(val\))230 665 y(else)g(if)h
(relop)e(==)i("=")f(then)274 715 y(return)g(constraints2pat)o(tern\()o
(field)o(bindi)o(ng\(f)o(,)e(val\)\))230 765 y(else)274
815 y(error\("`",)h(expimage\(val\),)f("')i(has)g(free)g(variables,)f
(",)405 865 y("so)h(the)g(only)g(permissible)f(constraint)f(is)j
(equality"\))187 915 y(end)145 963 y Fp(De\014nes:)187
1003 y Fl(constraint)o(_or)o(_b)o(ind)o(ing)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)e(76a.)145 1042 y(Uses)18 b
Fl(binding_s)o(ubs)o(t_f)13 b Fp(76b,)j Fl(conspat)f
Fp(61,)i Fl(constant)d Fp(114b,)i Fl(constrain)o(t)e
Fp(55,)187 1082 y Fl(constraint)o(s2p)o(at)o(ter)o(n)g
Fp(61,)j Fl(expimage)d Fp(101a,)h Fl(fail)h Fp(410,)g
Fl(fieldbindin)o(g)e Fp(55,)187 1121 y Fl(fieldname_)o(env)o(_f)o(or)8
b Fp(356b,)j Fl(gsubst)e Fp(120a,)h(and)h Fl(super_simp)o(lif)o(y)e
Fp(92c.)145 1180 y Fv(Note)17 b(that)f(the)h(error)g(message)e(lies;)i
(it)e(migh)o(t)f(b)q(e)j(p)q(ossible)f(to)g(write)h(a)e(constrain)o(t)i
(in)145 1230 y(with)c(a)f(pattern,)h(b)q(ecause)h(constrain)o(ts)g(are)
f(no)o(w)f(part)h(of)f(patterns.)18 b(Must)c(lo)q(ok)d(in)o(to)h(it.)0
1289 y Fp(77b)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1090 b Fm(/)5 b Fp(77a)23 b(77c)5 b Fm(.)187
1339 y Fr(record)20 b(binding_instance\(va)o(l,)f(type\))187
1389 y(procedure)h(new_binding_inst)o(ance\()o(name,)e(val,)j(type,)g
(env\))230 1439 y(if)h(\(/env[name])d(:=)j(binding_instance)o(\(val,)c
(type\)\))j(|)g(env[name].type)e(===)i(type)g(then)274
1488 y(return)g(val)230 1538 y(else)274 1588 y(error\(name,)e(")j(was)f
(bound)g(earlier)f(as)i(type)f(",)g(expimage\(env[name])o(.type)o(\),)
405 1638 y(")g(but)g(it's)g(used)g(here)g(as)h(type)f(",)g
(expimage\(type\)\))187 1688 y(end)145 1736 y Fp(De\014nes:)187
1776 y Fl(binding_in)o(sta)o(nc)o(e)p Fp(,)9 b(used)h(in)h(c)o(h)o
(unks)f(104b)g(and)h(177.)187 1815 y Fl(new_bindin)o(g_i)o(ns)o(tan)o
(ce)p Fp(,)d(used)j(in)g(c)o(h)o(unks)f(76b)g(and)h(175.)145
1855 y(Uses)h Fl(expimage)d Fp(101a)h(and)h Fl(used)f
Fp(136a.)208 1914 y Fr(pnfreduce\(op,)19 b(l,)i(rho\))d
Fv(applies)g Fr(pnf_recurse)f Fv(to)i(eac)o(h)g(mem)o(b)q(er)e(of)h
Fr(l)h Fv(then)145 1964 y(reduces)g(the)e(list)f(\(in)g(the)h(APL)g
(sense\))h(b)o(y)e(applying)f Fr(op)p Fv(.)25 b(A)17
b(sp)q(ecial)g(v)o(ersion)f(is)g(used)145 2014 y(when)f
Fr(op)21 b(===)g(seqp)p Fv(,)13 b(b)q(ecause)i(that)f(requires)h(up)q
(dating)f(the)g(program)f(coun)o(ter.)4 2073 y Fp(77c)89
b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p Fo(\021)1086
b Fm(/)6 b Fp(77b)22 b(78a)5 b Fm(.)187 2123 y Fr(procedure)20
b(pnfreduce\(op,)f(l,)i(rho,)g(free_env\))230 2172 y(r)h(:=)f(&null)230
2222 y(every)g(p)h(:=)f(pnf_recurse\(!l,)e(rho,)i(free_env\))f(do)296
2272 y(r)h(:=)h(op\(\\r,)e(p\))i(|)f(p)230 2322 y(return)g(r)187
2372 y(end)145 2420 y Fp(De\014nes:)187 2460 y Fl(pnfreduce)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(75.)145 2499 y(Uses)i
Fl(pnf_recurs)o(e)d Fp(75.)p eop
%%Page: 78 78
78 77 bop 129 141 a Fv(78)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-13 258 y Fp(78a)88 b Fo(h)p Fn(*)16
b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(77c)22
b(78b)5 b Fm(.)171 307 y Fr(procedure)20 b(equals_pc\(e\))215
357 y(return)g(e)i(===)f(the_global_pc)171 407 y(end)129
459 y Fp(De\014nes:)171 498 y Fl(equals_pc)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unk)f(329a.)129 538 y(Uses)i Fl(the_global_)o(pc)c
Fp(19d.)129 675 y Ft(4.5.2)56 b(Finding)18 b(free)g(v)m(ariables)f(in)i
(abstract)g(syn)n(tax)129 751 y Fv(As)c(far)e(as)h(I)g(kno)o(w,)f(this)
h(co)q(de)h(is)e(used)i(only)e(for)h(def-use)h(c)o(hec)o(king.)-15
814 y Fp(78b)88 b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p
Fo(\021)1088 b Fm(/)6 b Fp(78a)22 b(79a)5 b Fm(.)171
864 y Fr(procedure)20 b(pattern_free_vari)o(ables)o(\(p\))258
913 y(case)h(type\(p\))f(of)i({)345 963 y("pattern")e(:)i(fail)173
b(#)22 b(note)f(free)g(var)g(of)g(Pcon)g(is)h(field,)e(not)h(pattern)
345 1013 y("Pident")42 b(:)22 b(return)e(p.name)345 1063
y("Plabel")42 b(:)22 b(fail)f(#)g(name)g(is)h(a)f(binding)g(instance)
345 1113 y("Pcon")86 b(:)22 b(suspend)e(free_variables\(p.v)o(alue\))
345 1162 y("Pand")h(|)g("Por")g(|)h("Pseq")42 b(:)607
1212 y(suspend)20 b(pattern_free_varia)o(bles\()o(!p.pa)o(ttern)o(s\))
345 1262 y("Papp")86 b(:)22 b(suspend)e(free_variables\(!p.)o(args\))
345 1312 y("string")42 b(:)22 b(return)e(p)345 1362 y("integer")g(:)i
(fail)345 1411 y("literal")e(:)i(fail)345 1461 y(default)f(:)g
(impossible\("pattern)d(free)j(variables"\))258 1511
y(})171 1561 y(end)129 1613 y Fp(De\014nes:)171 1652
y Fl(pattern_fr)o(ee_)o(var)o(iab)o(le)o(s)p Fp(,)9 b(used)h(in)h(c)o
(h)o(unks)f(165d)h(and)f(260.)129 1692 y(Uses)i Fl(fail)e
Fp(410,)h Fl(field)f Fp(55,)h Fl(free_varia)o(bl)o(es)d
Fp(84b,)j Fl(literal)e Fp(45e,)i Fl(Pand)f Fp(41a,)g
Fl(Papp)h Fp(41a,)f Fl(pattern)f Fp(55,)171 1731 y Fl(Pcon)h
Fp(41a,)h Fl(Pident)e Fp(41a,)i Fl(Plabel)f Fp(41a,)g
Fl(Por)h Fp(41a,)f Fl(Pseq)h Fp(41a,)f(and)h Fl(value)f
Fp(136a.)p eop
%%Page: 79 79
79 78 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)721
b Fr(patterns.nw)81 b Fv(79)208 258 y(Here)15 b(w)o(e)f(need)h(lab)q
(el)e(names)g(for)h(en)o(try)g(in)o(to)f(the)i(en)o(vironmen)o(t.)2
320 y Fp(79a)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1084 b Fm(/)6 b Fp(78b)22 b(79b)5 b Fm(.)187
370 y Fr(procedure)20 b(pattern_label_na)o(mes\(p)o(\))274
420 y(case)h(type\(p\))f(of)i({)361 469 y("pattern")e(:)i(fail)361
519 y("Pident")42 b(:)22 b(fail)361 569 y("Plabel")42
b(:)22 b(return)e(p.name)361 619 y("Pcon")86 b(:)22 b(fail)361
669 y("Pand")f(|)g("Por")g(|)h("Pseq")e(:)i(suspend)e
(pattern_label_name)o(s\(!p.)o(patte)o(rns\))361 718
y("Papp")86 b(:)22 b(fail)361 768 y("string")42 b(:)22
b(fail)361 818 y("integer")e(:)i(fail)361 868 y("literal")e(:)i(fail)
361 918 y(default)e(:)i(impossible\("patter)o(n)d(label)i(names"\))274
967 y(})187 1017 y(end)145 1069 y Fp(De\014nes:)187 1109
y Fl(pattern_la)o(bel)o(_n)o(ame)o(s)p Fp(,)9 b(used)h(in)h(c)o(h)o
(unks)f(162a,)g(170a,)g(210b,)g(and)h(260.)145 1148 y(Uses)j
Fl(fail)f Fp(410,)f Fl(label)h Fp(383a,)f Fl(literal)f
Fp(45e,)i Fl(Pand)g Fp(41a,)f Fl(Papp)h Fp(41a,)g Fl(pattern)e
Fp(55,)i Fl(Pcon)g Fp(41a,)187 1187 y Fl(Pident)c Fp(41a,)i
Fl(Plabel)f Fp(41a,)g Fl(Por)h Fp(41a,)f(and)h Fl(Pseq)f
Fp(41a.)208 1250 y Fv(The)16 b(tric)o(ky)f(part)h(of)f(computing)f(the)
j(constructors)g(applied)f(in)f(a)g(pattern)i(is)e(that)145
1300 y(the)g(exact)f(set)h(is)e(not)h(kno)o(wn)f(un)o(til)g
Fr(pnf)h Fv(is)f(applied)g(to)h(the)g(pattern.)19 b(W)m(e)14
b(mak)o(e)e(a)h(con-)145 1349 y(serv)n(ativ)o(e)i(estimate)f(b)o(y)h
(generating)g(all)e(p)q(ossible)i(applications)f(using)g
Fr(explode_apps)p Fv(.)145 1399 y(W)m(e)f(also)f(ha)o(v)o(e)h(to)f
(handle)h(nested)h(stu\013)g(with)e Fr(Eapp)p Fv(.)17
b(I'm)11 b(sure)j(this)f(is)f(b)q(ogus)h(and)g(there)30
b Fk(\031Change)14 b(#45)145 1449 y Fv(are)h(plen)o(t)o(y)e(of)h
(examples)f(that)g(will)g(send)i(it)e(to)h(left)g(\014eld.)0
1511 y Fp(79b)89 b Fo(h)p Fn(*)15 b Fp(55)p Fo(i)p Fv(+)p
Fo(\021)1088 b Fm(/)6 b Fp(79a)22 b(80a)5 b Fm(.)187
1561 y Fr(procedure)20 b(constructors_app)o(lied_)o(in\(p\))274
1611 y(case)h(type\(p\))f(of)i({)361 1661 y("pattern")e(|)i("Pident")e
(|)h("Plabel")g(|)g("Pcon")g(|)g("string")f(|)i("integer")e(|)h
("literal")f(:)557 1711 y(fail)361 1760 y("Pand")h(|)g("Por")g(|)h
("Pseq")42 b(:)22 b(suspend)e(constructors_appl)o(ied_i)o(n\(!p.)o
(patt)o(erns\))361 1810 y("Papp")h(:)g(suspend)g(\(if)g(type\(p.cons\))
e(==)i("list")g(then)797 1860 y(constructors_appl)o(ied_i)o(n\(exp)o
(lode_)o(apps\()o(p.con)o(s,p.)o(args\))o(\))753 1910
y(else)g(p.cons\))g(|)753 1960 y(constructors_applie)o(d_in\()o(!p.ar)o
(gs\))361 2009 y("Eapp")g(:)g(suspend)g(cons_named\(p.f\))d(|)623
2059 y(\(a)j(:=)g(!p.args,)g(type\(a\))f(==)h("Eapp",)g
(constructors_app)o(lied)o(_in\(a)o(\)\))361 2109 y(default)f(:)i
(impossible\("patter)o(n)d(AST"\))274 2159 y(})187 2209
y(end)145 2261 y Fp(De\014nes:)187 2300 y Fl(constructo)o(rs_)o(ap)o
(pli)o(ed_)o(in)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(210b)g(and)h
(211a.)145 2339 y(Uses)j Fl(cons_named)c Fp(167a,)i Fl(Eapp)g
Fp(81,)h Fl(explode_app)o(s)e Fp(41b,)h Fl(fail)g Fp(410,)h
Fl(literal)e Fp(45e,)h Fl(Pand)g Fp(41a,)187 2379 y Fl(Papp)e
Fp(41a,)h Fl(pattern)e Fp(55,)i Fl(Pcon)f Fp(41a,)h Fl(Pident)e
Fp(41a,)i Fl(Plabel)e Fp(41a,)i Fl(Por)f Fp(41a,)h(and)g
Fl(Pseq)f Fp(41a.)p eop
%%Page: 80 80
80 79 bop 129 141 a Fv(80)83 b Fr(patterns.nw)720 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)129 258 y Fj(4.6)67 b(Manipulations)24
b(of)e(conditions)129 349 y Fv(I)13 b(use)h(a)e(destructiv)o(e)i
Fr(bind_condition)c Fv(to)j(add)f(conditions.)18 b(When)13
b(I)f(need)i(something)129 398 y(non-destructiv)o(e,)g(I)e(use)h
Fr(freshen_disjuncts)c Fv(to)j(get)h(a)f(pattern)h(with)f(fresh)h
(disjuncts)129 448 y(and)h(conditions.)-13 510 y Fp(80a)88
b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p Fo(\021)1084
b Fm(/)6 b Fp(79b)22 b(80b)5 b Fm(.)171 560 y Fr(procedure)20
b(bind_condition\(p,)e(condition\))215 610 y(every)i
(bind_condition_d\(!p)o(.disj)o(uncts)o(,)f(condition\))215
660 y(return)h(p)171 710 y(end)171 809 y(procedure)g
(bind_condition_d\()o(d,)f(condition\))215 859 y(/d.conditions)g(:=)i
(set\(\))215 909 y(insert_conditio)o(n\(d.c)o(ondit)o(ions,)d
(condition\))215 959 y(return)i(d)171 1009 y(end)129
1060 y Fp(De\014nes:)171 1100 y Fl(bind_condi)o(tio)o(n)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(170a)g(and)h(172a.)129
1139 y(Uses)h Fl(insert_cond)o(iti)o(on)c Fp(126c.)-15
1222 y(80b)88 b Fo(h)p Fn(*)16 b Fp(55)p Fo(i)o Fv(+)p
Fo(\021)1188 b Fm(/)6 b Fp(80a)171 1272 y Fr(procedure)20
b(freshen_disjuncts)o(\(p\))215 1322 y(return)g(pattern\(maplist\(fr)o
(eshen)o(_disj)o(unct)o(,)f(p.disjuncts\),)g(p.name\))171
1372 y(end)171 1422 y(link)i(maplist)171 1521 y(procedure)f
(freshen_disjunct\()o(d\))215 1571 y(d)h(:=)h(copy\(d\))215
1621 y(d.conditions)d(:=)i(copy\(d.conditions\))215 1671
y(return)f(d)171 1721 y(end)129 1772 y Fp(De\014nes:)171
1812 y Fl(freshen_di)o(sju)o(nct)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unks)f(170a,)g(172a,)g(183b,)g(and)h(190.)129 1851 y(Uses)h
Fl(pattern)d Fp(55.)p eop
%%Page: 81 81
81 80 bop 145 569 a Fq(Chapter)32 b(5)145 777 y Fu(Expressions)39
b(and)f(Equations)145 992 y Fn(Expr)n(essions)11 b Fv(describ)q(e)h
(all)e(the)h(v)n(alue)f(manipulations)e(p)q(erformed)i(b)o(y)g(the)h
(to)q(olkit.)16 b(They)145 1042 y(include)11 b(not)g(only)g
(manipulatio)o(ns)e(that)i(can)g(b)q(e)h(expressed)h(using)e(the)g
(input)g(expression)145 1092 y(language,)f(but)h(also)e(manipulations)f
(that)i(are)h(generated)h(in)o(ternally)m(,)d(including)h(slicing,)145
1142 y(narro)o(wing,)h(sign)g(extension,)h(division,)e(and)h(mo)q
(dulus.)k(A)c(sp)q(ecial)h(normal)d(form)g(is)i(used)145
1192 y(to)16 b(represen)o(t)j(sums)c(of)g(terms)h(with)g(constan)o(t)g
(co)q(e\016cien)o(ts.)26 b(The)17 b(in)o(teger)f(1)g(ma)o(y)e(also)145
1241 y(b)q(e)g(used)g(as)f(a)g(term;)f(it)h(is)g(m)o(ultiplied)e(b)o(y)
i(a)f(co)q(e\016cien)o(t)i(to)f(represen)o(t)j(a)d(constan)o(t)g(term,)
145 1291 y(if)h(an)o(y)m(.)21 b(This)14 b(normal)f(form)g(is)i
(represen)o(ted)j(as)d(an)g(Icon)g(table)g(in)f(whic)o(h)h(the)h(k)o
(eys)f(are)145 1341 y(the)f(terms)g(and)f(the)h(v)n(alues)f(are)h(the)g
(co)q(e\016cien)o(ts.)19 b(F)m(or)13 b(example,)f(the)i(expression)g
Fr(10*x)145 1391 y(+)22 b(4)14 b Fv(is)f(represen)o(ted)k(b)o(y)d(the)g
(Icon)g(table)g(mapping)e Fr("x")h Fv(to)h(10)f(and)h(1)f(to)h(4.)208
1441 y(These)20 b(expressions)g(are)g(used)g(b)q(oth)f(in)f(equation)h
(solving)f(and)g(to)h(compute)g(the)145 1491 y(v)n(alues)12
b(of)f(\014elds.)18 b(I)12 b(giv)o(e)f(de\014nitions)h(in)f(terms)h(of)
f(Mo)q(dula-3.)16 b Fr(x)c Fv(and)f Fr(y)h Fv(are)g(expressions;)145
1540 y Fr(n)i Fv(and)g Fr(lo)f Fv(are)h(in)o(teger)h(constan)o(ts.)20
1603 y Fp(81)89 b Fo(h)p Fn(*)15 b Fp(81)p Fo(i\021)1218
b Fp(83b)5 b Fm(.)187 1652 y Fr(record)20 b(Eorb\(x,)h(y\))501
b(#)21 b(Word.Or\(x,)f(y\))187 1702 y(record)g(Eand\(x,)h(y\))501
b(#)21 b(x)h(AND)f(y)327 b(--)21 b(short-circuit)e(Boolean)187
1752 y(record)h(Eslice\(x,)g(lo,)h(n\))371 b(#)21 b(Word.Extract\(x,)e
(lo,)i(width\))187 1802 y(record)f(Eshift\(x,)g(n\))458
b(#)21 b(Word.Shift\(x,)e(n\))187 1852 y(record)h(Enarrowu\(x,)g(n\))
414 b(#)21 b(narrow)g(to)g(n)h(bits,)e(unsigned,)g(with)h(check)187
1901 y(record)f(Enarrows\(x,)g(n\))414 b(#)21 b(narrow)g(to)g(n)h
(bits,)64 b(signed,)20 b(with)h(check)187 1951 y(record)f(Ewiden\(x,)g
(n\))458 b(#)21 b(sign-extend)f(low)h(n)g(bits)187 2001
y(record)f(Ediv\(x,)h(n\))501 b(#)21 b(x)h(DIV)f(y)187
2051 y(record)f(Emod\(x,)h(n\))501 b(#)21 b(x)h(MOD)f(y)187
2101 y(record)f(Efitsu\(x,)g(n\))458 b(#)21 b(unsigned)f(value)h(x)h
(fits)f(in)g(n)h(bits)187 2151 y(record)e(Efitss\(x,)g(n\))458
b(#)21 b(signed)g(value)f(x)i(fits)f(in)g(n)h(bits)187
2200 y(record)e(Epatlabel\(l\))456 b(#)21 b(reference)f(to)h(patlabel)g
(l)187 2250 y(record)f(Eforce\(x\))522 b(#)21 b(force)g(relocatable)e
(x)j(to)f(an)h(integer)187 2300 y(record)e(Eforceable\(x\))434
b(#)21 b(true)g(iff)g(relocatable)f(x)h(has)h(known)e(address)187
2350 y(record)g(Epc\(\))610 b(#)21 b(start)g(of)g(pattern)g(match)f(or)
i(token)e(emission)187 2400 y(record)g(Epc_known\(\))478
b(#)21 b(predicate)f(needed)h(in)g(encoding)187 2449
y(record)f(Sstmts\(x\))522 b(#)21 b(sequence)f(of)i(statements)187
2499 y(record)e(Enot\(x\))566 b(#)21 b(NOT)g(x)841 2604
y Fv(81)p eop
%%Page: 82 82
82 81 bop 129 141 a Fv(82)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)171 258 y Fr(record)21 b(Enosimp\(x\))499
b(#)21 b(x,)h(but)f(suppress)f(simplification)171 307
y(record)h(Semit\(x\))543 b(#)21 b(emit)g(list)g(of)h(Stoken)171
357 y(record)f(Stoken\(x,)e(n,)j(offset\))282 b(#)21
b(emit)g(x)h(with)f(width)g(n)g(\(offset)f(from)h(beginning\))1043
407 y(#)152 b(\(offset)20 b(>=)i(0)f(always\))171 457
y(record)g(Einstance\(cons,)d(argt\))261 b(#)21 b(cons)g(applied)g(to)g
(arguments)f(in)h(table)g(argt)171 507 y(record)g(Einstance_input)o
(\(x,)e(cons,)h(name\))65 b(#)21 b(input)g(name)g(from)g(instance)f(x)i
(of)f(constructor)f(cons)171 557 y(record)h(Einstance_tagge)o(d\(x,)d
(cons,)j(uid\))65 b(#)21 b(true)g(iff)g(instance)g(x)g(tagged)g(as)g
(constructor)f(cons)171 606 y(record)h(Ebinding_instan)o(ce\(na)o(me,)e
(type,)h(vart\))h(#)h(binding)e(instance)g(of)i(constructor-typ)o(ed)d
(input)1108 656 y(#)j(vart)f(is)g(table)g(used)g(to)g(find)g(fresh)g
(vars)171 706 y(record)g(Sif\(arms\))521 b(#)21 b(list)g(of)h(Sguarded)
171 756 y(record)f(Sguarded\(guard,)d(x\))327 b(#)21
b(if)h(guard)e(then)h(x)h(\(in)f(Sif\))171 806 y(record)g(Sepsilon\(\))
499 b(#)21 b(empty)g(statement)171 855 y(record)g(Efail\(msg\))499
b(#)21 b(result)g(of)g(selecting)f(from)h(the)g(wrong)g(constructor)171
905 y(record)g(Eapp\(f,)f(args\))435 b(#)21 b(function)f(application)
171 955 y(record)h(Eclosure_loc\(\))411 b(#)21 b(location)f(of)i(a)f
(relocation)f(closure)171 1005 y(record)h(Eclosure_addr\(n)o(\))368
b(#)21 b(relocatable)f(address)g(in)i(a)f(relocation)f(closure)171
1055 y(record)h(Eclosure_val\(n\))389 b(#)21 b(value)g(in)g(a)h
(relocation)e(closure)129 1107 y Fp(De\014nes:)171 1146
y Fl(Eand)p Fp(,)10 b(used)h(in)g(c)o(h)o(unks)f(86a,)g(97a,)h(106a,)f
(112a,)g(118a,)g(123b,)g(130a,)g(186b,)g(187a,)g(327c,)h(and)f(341c.)
171 1185 y Fl(Eapp)p Fp(,)g(used)h(in)g(c)o(h)o(unks)f(49,)h(79b,)f
(83b,)g(86e,)h(110c,)f(118a,)g(124b,)g(133d,)g(175,)h(and)g(176.)171
1225 y Fl(Ebinding_i)o(nst)o(anc)o(e)p Fp(,)e(used)i(in)g(c)o(h)o(unks)
g(17a,)f(83b,)h(86a,)g(108b,)g(118a,)f(124a,)h(131e,)f(177,)h(178,)g
(180,)212 1264 y(and)g(182a.)171 1304 y Fl(Eclosure_a)o(ddr)o
Fp(,)c(used)i(in)g(c)o(h)o(unks)g(83b,)f(87a,)h(111a,)f(118a,)h(124b,)f
(133e,)h(216,)f(220a,)h(227a,)f(and)h(329e.)171 1343
y Fl(Eclosure_l)o(oc)p Fp(,)e(used)h(in)i(c)o(h)o(unks)e(83b,)h(87a,)f
(111a,)h(118a,)f(124b,)h(133e,)f(209a,)g(227a,)h(329e,)f(and)h(330a.)
171 1383 y Fl(Eclosure_v)o(al)p Fp(,)f(used)j(in)g(c)o(h)o(unks)f(83b,)
g(87a,)h(111a,)f(118a,)g(124b,)g(133e,)g(216,)h(220a,)f(and)g(329e.)171
1422 y Fl(Ediv)p Fp(,)g(used)h(in)h(c)o(h)o(unks)e(83b,)h(86a,)g(98,)g
(106d,)g(112a,)f(118a,)h(123b,)f(130d,)h(139b,)f(149d,)g(150a,)h(328a,)
212 1461 y(and)g(342a.)171 1501 y Fl(Efail)p Fp(,)g(used)h(in)h(c)o(h)o
(unks)e(97c,)h(98a,)g(100a,)f(109c,)h(118b,)f(124c,)h(132d,)f(178b,)h
(180,)g(182a,)f(331b,)212 1540 y(and)g(343d.)171 1580
y Fl(Efitss)p Fp(,)g(used)g(in)i(c)o(h)o(unks)e(86a,)g(95c,)h(99b,)f
(107b,)h(118a,)f(123b,)g(130f,)h(188b,)f(198a,)g(200a,)g(212d,)212
1619 y(315b,)g(320a,)f(329g,)g(and)g(342c.)171 1659 y
Fl(Efitsu)p Fp(,)g(used)h(in)g(c)o(h)o(unks)f(86a,)h(99b,)g(107b,)f
(118a,)h(123b,)f(130f,)h(188b,)f(198{200,)f(212d,)i(315,)g(320a,)212
1698 y(329g,)g(and)f(342c.)171 1738 y Fl(Eforce)p Fp(,)g(used)i(in)g(c)
o(h)o(unks)f(83a,)h(86a,)f(99b,)g(107d,)h(118a,)f(123b,)g(130h,)g
(172a,)g(189a,)g(198b,)g(209a,)212 1777 y(223b,)g(227a,)f(314c,)g
(330a,)g(and)h(342d.)171 1816 y Fl(Eforceable)o Fp(,)e(used)i(in)g(c)o
(h)o(unks)f(86a,)g(99b,)g(107d,)h(118a,)f(123b,)g(130h,)g(198b,)g
(330a,)g(and)h(342d.)171 1856 y Fl(Einstance)p Fp(,)e(used)j(in)g(c)o
(h)o(unks)f(83,)h(86a,)g(93a,)g(100a,)f(108b,)g(118a,)g(124a,)h(131e,)f
(173b,)g(178,)h(180,)212 1895 y(and)f(182a.)171 1935
y Fl(Einstance_)o(inp)o(ut)p Fp(,)e(used)i(in)h(c)o(h)o(unks)e(17a,)h
(83b,)g(86a,)g(97b,)g(99b,)g(100a,)g(108b,)g(118a,)g(124a,)f(131e,)212
1974 y(172a,)h(178,)f(180,)h(182a,)f(201a,)g(206e,)g(207b,)g(219b,)g
(250b,)g(315c,)g(330f,)h(and)f(343b.)171 2014 y Fl(Einstance_)o(tag)o
(ged)o Fp(,)e(used)i(in)g(c)o(h)o(unks)f(17a,)h(86a,)g(100a,)f(108b,)g
(118a,)h(124a,)f(131e,)g(172a,)h(178b,)f(180,)212 2053
y(184,)i(185a,)f(330f,)g(and)h(343b.)171 2092 y Fl(Emod)p
Fp(,)f(used)h(in)h(c)o(h)o(unks)e(83b,)h(86a,)g(98,)g(106d,)g(112a,)f
(118a,)h(123b,)f(130d,)h(139b,)f(149d,)g(150a,)h(315a,)212
2132 y(328a,)g(and)f(342a.)171 2171 y Fl(Enarrows)p Fp(,)g(used)h(in)h
(c)o(h)o(unks)f(83b,)g(86a,)h(95c,)f(97{99,)g(106c,)g(112a,)g(118a,)g
(123b,)g(130c,)g(151,)h(152,)212 2211 y(175b,)f(189a,)f(200a,)g(327e,)g
(and)h(341e.)171 2250 y Fl(Enarrowu)p Fp(,)f(used)i(in)g(c)o(h)o(unks)f
(83b,)h(86a,)f(97,)h(99b,)g(106c,)f(112a,)g(118a,)h(123b,)f(130c,)g
(200a,)h(327e,)212 2290 y(and)f(341e.)171 2329 y Fl(Enosimp)p
Fp(,)e(used)i(in)g(c)o(h)o(unks)f(83a,)g(86a,)h(93a,)f(107g,)g(118a,)g
(123b,)g(131c,)h(196c,)f(330c,)g(and)h(342f.)171 2368
y Fl(Enot)p Fp(,)h(used)g(in)i(c)o(h)o(unks)d(86a,)i(99b,)f(107f,)g
(118a,)g(123b,)g(131b,)g(186b,)g(188b,)g(190,)h(192,)f(330b,)212
2408 y(and)f(342e.)171 2447 y Fl(Eorb)p Fp(,)e(used)h(in)h(c)o(h)o
(unks)e(83,)h(86a,)f(97a,)h(106a,)f(112a,)h(118a,)f(123b,)g(130a,)h
(195,)g(221a,)f(327c,)g(and)h(341c.)171 2487 y Fl(Epatlabel)p
Fp(,)e(used)j(in)g(c)o(h)o(unks)f(57,)h(86a,)f(107c,)g(118a,)h(123b,)f
(130g,)g(193a,)g(and)g(270a.)p eop
%%Page: 83 83
83 82 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(83)187 258 y Fl(Epc)p Fp(,)10 b(used)h(in)g(c)o(h)o
(unks)e(19e,)i(83a,)f(86a,)g(107e,)g(118a,)g(123b,)g(131a,)g(198b,)g
(205b,)g(206c,)g(216,)g(218,)h(228,)228 297 y(313,)g(and)f(329d.)187
337 y Fl(Epc_known)p Fp(,)f(used)i(in)h(c)o(h)o(unks)e(83a,)h(86a,)g
(107e,)g(118a,)g(123b,)f(131a,)h(198b,)g(205b,)g(206c,)f(216,)h(218,)
228 376 y(228,)g(and)f(329d.)187 415 y Fl(Eshift)p Fp(,)g(used)h(in)h
(c)o(h)o(unks)f(83b,)g(86a,)h(97{99,)e(106b,)h(112a,)g(116a,)g(118a,)g
(123b,)g(130b,)g(154,)g(196c,)228 455 y(327d,)f(and)h(341d.)187
494 y Fl(Eslice)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f(83b,)g(86a,)g(95c,)
h(97{99,)e(106b,)h(112a,)g(115a,)g(118a,)g(123b,)g(130b,)g(144b,)228
534 y(145c,)f(153d,)h(154,)f(195,)h(297c,)f(299a,)g(318a,)g(327,)g(and)
h(341.)187 573 y Fl(Ewiden)p Fp(,)f(used)h(in)g(c)o(h)o(unks)g(50b,)g
(83b,)g(86a,)g(98,)g(99b,)g(106c,)g(112a,)f(118a,)h(123b,)f(130c,)h
(144b,)g(145c,)228 613 y(151,)g(152,)f(327e,)g(333a,)h(and)f(341e.)187
652 y Fl(Semit)p Fp(,)g(used)g(in)h(c)o(h)o(unks)f(86a,)h(107a,)f
(118a,)g(123b,)g(130e,)g(194b,)g(328b,)g(and)h(342b.)187
691 y Fl(Sepsilon)p Fp(,)f(used)j(in)g(c)o(h)o(unks)f(83a,)g(95d,)h
(100b,)f(109b,)g(118b,)g(124c,)g(132c,)g(222b,)g(248,)h(332b,)228
731 y(and)e(344b.)187 770 y Fl(Sguarded)p Fp(,)e(used)h(in)i(c)o(h)o
(unks)d(83a,)i(86b,)g(96a,)f(108c,)g(112a,)h(118b,)f(124c,)g(131f,)g
(186b,)h(188,)f(190,)h(192,)228 810 y(209a,)f(215,)h(222b,)f(248,)h
(296b,)f(297a,)g(299c,)g(and)h(300.)187 849 y Fl(Sif)p
Fp(,)g(used)f(in)i(c)o(h)o(unks)e(83a,)h(86b,)f(93a,)h(95d,)g(108c,)f
(118b,)h(124c,)f(131f,)h(186b,)f(188,)h(190,)g(192,)f(209a,)228
889 y(215,)h(248,)f(296b,)g(297a,)h(300,)f(331a,)g(and)h(343c.)187
928 y Fl(Sstmts)p Fp(,)d(used)h(in)h(c)o(h)o(unks)e(86a,)h(100b,)g
(108a,)f(118a,)h(123b,)f(131d,)h(205b,)g(216,)g(330d,)f(331d,)h(and)g
(343a.)187 967 y Fl(Stoken)p Fp(,)g(used)i(in)g(c)o(h)o(unks)f(83a,)g
(86a,)h(107a,)f(118a,)g(123b,)g(130e,)g(195,)h(223a,)f(and)h(328b.)145
1007 y(Uses)j Fl(address)d Fp(383a,)h Fl(constructo)o(r)f
Fp(159,)h Fl(input)g Fp(46a,)g Fl(location)p Fp(,)f Fl(patlabel)g
Fp(55,)h Fl(pattern)f Fp(55,)187 1046 y Fl(relocatabl)o(e)e
Fp(47a,)h Fl(token)g Fp(359a,)g Fl(used)h Fp(136a,)f(and)g
Fl(value)g Fp(136a.)2 1129 y(83a)89 b Fo(h)p Fn(ar)n(gument)15
b(descriptions)g Fp(83a)p Fo(i)o(\021)187 1179 y Fr(expargs)20
b(x)i(y)f(arms)g(guard)g(left)g(right)g(args.)187 1229
y(special)f(simplify)g(Einstance)g(Stagcase)g(Enosimp)h(Sif.)187
1279 y(special)f(hoist)h(Epc)g(Epc_known)f(Eorb)h(Sguarded)f(Sepsilon)g
(Sfail)h(Stoken)g(Eforce.)145 1331 y Fp(Uses)14 b Fl(Eforce)d
Fp(81,)h Fl(Einstance)f Fp(81,)h Fl(Enosimp)f Fp(81,)h
Fl(Eorb)g Fp(81,)h Fl(Epc)f Fp(81,)h Fl(Epc_known)d Fp(81,)i
Fl(hoist)g Fp(218,)187 1370 y Fl(Sepsilon)g Fp(81,)i
Fl(Sfail)f Fp(188c,)h Fl(Sguarded)e Fp(81,)i Fl(Sif)g
Fp(81,)g Fl(simplify)e Fp(92a,)h Fl(Stagcase)g Fp(183a,)187
1410 y(and)d Fl(Stoken)g Fp(81.)208 1480 y Fv(The)k(follo)o(wing)d(t)o
(yp)q(es)k(o\016cially)d(represen)o(t)k(v)n(alues:)0
1542 y Fp(83b)89 b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p
Fo(\021)1108 b Fm(/)5 b Fp(81)23 b(83c)5 b Fm(.)187 1592
y Fr(procedure)20 b(exptypes\(\))230 1642 y(suspend)h("string")f(|)h
("integer")f(|)i("table")e(|)i("Eorb")e(|)i("Eslice")e(|)i("Eshift")e
(|)h("Enarrowu")f(|)405 1692 y("Enarrows")f(|)j("Ewiden")e(|)i("Ediv")e
(|)i("Emod")e(|)i("Einstance_input")c(|)k("Einstance")d(|)405
1742 y("Ebinding_instan)o(ce")g(|)i("Eapp")g(|)g("Eclosure_loc")e(|)j
("Eclosure_addr")c(|)405 1791 y("Eclosure_val")187 1841
y(end)145 1893 y Fp(De\014nes:)187 1933 y Fl(exptypes)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(29.)145 1972 y(Uses)i
Fl(Eapp)e Fp(81,)g Fl(Ebinding_i)o(nst)o(anc)o(e)e Fp(81,)j
Fl(Eclosure_)o(add)o(r)d Fp(81,)j Fl(Eclosure_l)o(oc)d
Fp(81,)i Fl(Eclosure_va)o(l)e Fp(81,)187 2011 y Fl(Ediv)i
Fp(81,)h Fl(Einstance)e Fp(81,)i Fl(Einstance)o(_in)o(put)d
Fp(81,)j Fl(Emod)f Fp(81,)h Fl(Enarrows)e Fp(81,)i Fl(Enarrowu)e
Fp(81,)i Fl(Eorb)g Fp(81,)187 2051 y Fl(Eshift)e Fp(81,)i
Fl(Eslice)f Fp(81,)h(and)f Fl(Ewiden)g Fp(81.)208 2113
y Fv(An)16 b Fn(e)n(quation)h Fv(asserts)h(that)e(t)o(w)o(o)g
(expressions)h(are)g(equal.)25 b(In)16 b(this)g(co)q(de,)h(I)f(extend)
145 2163 y(the)g(term)f(to)h(co)o(v)o(er)g(what)f(is)g(more)g(normally)
e(called)i(an)g(\\inequalit)o(y"|a)e(pair)i(of)g(ex-)145
2213 y(pressions)g(related)g(b)o(y)f(one)g(of)f(the)h(usual)g
(relational)f(op)q(erators.)4 2275 y Fp(83c)89 b Fo(h)p
Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p Fo(\021)1086 b Fm(/)6
b Fp(83b)22 b(84a)5 b Fm(.)187 2325 y Fr(record)20 b(eqn\(left,)g(op,)h
(right\))283 b(#)21 b(equality)f(or)i(inequality)145
2377 y Fp(De\014nes:)187 2416 y Fl(eqn)p Fp(,)11 b(used)h(in)g(c)o(h)o
(unks)e(48c,)i(70c,)f(85b,)g(91,)h(93{95,)f(104c,)g(117d,)g(123a,)g
(128b,)g(143c,)g(145a,)g(150a,)228 2456 y(152,)g(154,)f(222a,)g(264,)h
(315a,)f(316b,)g(318a,)g(319b,)g(326a,)g(340a,)h(and)f(378b.)p
eop
%%Page: 84 84
84 83 bop 129 141 a Fv(84)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)129 258 y Fj(5.1)67 b(Searc)n(hing)23
b(for)f(subterms)h(and)g(free)e(v)l(ariables)129 349
y Fr(subterms_matching\(e,)d(ty\))13 b Fv(susp)q(ends)j(all)d(subterms)
h(of)f Fr(e)h Fv(that)g(ha)o(v)o(e)f(t)o(yp)q(e)i Fr(ty)p
Fv(.)-13 411 y Fp(84a)88 b Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o
Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(83c)22 b(84b)5 b Fm(.)171
461 y Fr(procedure)20 b(subterms_matching)o(_f\(e,)e(types[]\))215
510 y(return)i(if)h(type\(e\))g(==)g(!types)g(then)g(e)171
560 y(end)171 660 y(procedure)f(subterms_matching)o(\(e,)f(types[]\))
215 710 y(suspend)h(do_expwalk\(e,)f(subterms_matching)o(_f,)g(types\))
171 760 y(end)129 811 y Fp(De\014nes:)171 851 y Fl(subterms_m)o(atc)o
(hin)o(g)p Fp(,)10 b(used)i(in)g(c)o(h)o(unks)g(59d,)f(198{200,)g
(204{6,)g(214c,)h(216,)f(228,)h(298b,)g(301a,)212 890
y(and)f(315c.)129 930 y(Uses)h Fl(do_expwalk)c Fp(117a.)192
992 y Fv(Finding)j(free)i(v)n(ariables)e(is)h(a)g(common)e(enough)i
(case)h(of)f Fr(subterms_matching)c Fv(that)129 1042
y(I)14 b(de\014ne)h(a)f(sp)q(ecial)g(pro)q(cedure)i(for)d(it:)-15
1104 y Fp(84b)88 b Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p
Fo(\021)1090 b Fm(/)6 b Fp(84a)22 b(84c)5 b Fm(.)171
1154 y Fr(procedure)20 b(free_variables_f\()o(e\))215
1204 y(return)g(if)h(type\(e\))g(==)g("string")f(then)h(e)171
1254 y(end)171 1353 y(procedure)f(free_variables\(e\))215
1403 y(suspend)g(expwalk\(e,)g(free_variables_f)o(\))171
1453 y(end)129 1505 y Fp(De\014nes:)171 1544 y Fl(free_varia)o(ble)o(s)
p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(57,)h(78b,)f(137a,)h(139,)f(140,)
g(156a,)h(206e,)f(215,)g(219c,)g(and)h(262c.)129 1584
y(Uses)h Fl(expwalk)d Fp(117a.)129 1733 y Fj(5.2)67 b(T)-6
b(esting)22 b(for)g(equalit)n(y)129 1824 y Fv(This)14
b(is)g(a)g(conserv)n(ativ)o(e)g(test.)-12 1886 y Fp(84c)89
b Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1088
b Fm(/)6 b Fp(84b)22 b(87c)5 b Fm(.)171 1936 y Fr(procedure)20
b(exps_eq\(e1,)f(e2\))215 1986 y(if)i(e1)g(===)g(e2)h(then)f(return)f
(e2)215 2036 y(e1)h(:=)g(untableexp\(e1\))215 2086 y(e2)g(:=)g
(untableexp\(e2\))215 2136 y(return)f(case)h(type\(e1\))f(==)i
(type\(e2\))e(of)h({)258 2185 y Fo(h)p Fn(c)n(ases)15
b(for)g Fr(exps_eq)e Fp(85a)p Fo(i)215 2235 y Fr(})171
2285 y(end)129 2337 y Fp(De\014nes:)171 2376 y Fl(exps_eq)p
Fp(,)c(used)i(in)h(c)o(h)o(unks)e(85{87,)g(95c,)h(96a,)g(126c,)g(144b,)
f(156a,)h(184a,)f(185a,)h(187a,)g(198c,)f(207a,)212 2416
y(260,)h(and)g(266.)129 2455 y(Uses)h Fl(untableexp)c
Fp(88a.)p eop
%%Page: 85 85
85 84 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(85)2 258 y Fp(85a)89 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(exps_eq)f Fp(85a)p Fo(i)o(\021)795 b Fp(\(84c\))22
b(85b)5 b Fm(.)187 307 y Fr("pattern")129 b(:)21 b(fail)187
357 y("disjunct")107 b(:)21 b(fail)187 407 y("adisjunct")85
b(:)21 b(fail)187 457 y("sequent")129 b(:)21 b(fail)187
507 y("patlabel")107 b(:)21 b(e1)h(===)f(e2)187 557 y("latent_patlabel)
o(")e(:)j(e1)f(===)g(e2)43 b(##)22 b(???)187 606 y("dots_sequent")d(:)i
(fail)187 656 y("constraint")63 b(:)21 b(fail)187 706
y("fieldbinding")e(:)i(fail)187 756 y("field")173 b(:)21
b(e1)h(===)f(e2)187 806 y("absolute_field")d(:)k(exps_eq\(e1.field,)c
(e2.field\))i(&)i(e1.offset)e(=)h(e2.offset)145 857 y
Fp(Uses)13 b Fl(absolute_)o(fie)o(ld)c Fp(268,)i Fl(adisjunct)e
Fp(268,)i Fl(constraint)e Fp(55,)i Fl(disjunct)f Fp(55,)h
Fl(dots_seque)o(nt)e Fp(62c,)187 897 y Fl(exps_eq)h Fp(84c,)h
Fl(fail)h Fp(410,)f Fl(field)g Fp(55,)h Fl(fieldbindi)o(ng)d
Fp(55,)j Fl(latent_pat)o(lab)o(el)d Fp(55,)j Fl(patlabel)e
Fp(55,)187 936 y Fl(pattern)f Fp(55,)i(and)g Fl(sequent)e
Fp(55.)0 1028 y(85b)89 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(exps_eq)f Fp(85a)p Fo(i)o Fv(+)q Fo(\021)666 b Fp(\(84c\))22
b Fm(/)5 b Fp(85a)23 b(85c)5 b Fm(.)187 1077 y Fr("list")195
b(:)21 b(if)h(*e1)f(~=)g(*e2)g(then)g(fail)557 1127 y(else)g({)601
1177 y(every)g(i)g(:=)h(1)f(to)h(*e1)f(do)g(if)g(not)h(exps_eq\(e1[i],)
d(e2[i]\))h(then)h(fail)601 1227 y(e1)557 1277 y(})187
1327 y("eqn")217 b(:)21 b Fo(h)p Fn(e)n(quations)16 b
Fr(e1)e Fn(and)i Fr(e2)e Fn(ar)n(e)h(the)g(same)g Fp(87b)p
Fo(i)145 1378 y Fp(Uses)d Fl(eqn)f Fp(83c,)f Fl(exps_eq)f
Fp(84c,)i(and)g Fl(fail)f Fp(410.)4 1470 y(85c)89 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(exps_eq)f Fp(85a)p Fo(i)o Fv(+)q
Fo(\021)660 b Fp(\(84c\))22 b Fm(/)6 b Fp(85b)22 b(85d)5
b Fm(.)187 1520 y Fr("table")173 b(:)21 b({)h(if)f(*e1)g(~=)h(*e2)f
(then)g(fail)601 1569 y(every)g(k1)g(:=)g(key\(e1\))g(do)644
1619 y(if)h(k2)f(:=)h(key\(e2\))e(&)i(e2[k2])e(=)i(e1[k1])e(&)i
(exps_eq\(k1,)d(k2\))i(then)g(&null)644 1669 y(else)g(fail)601
1719 y(e2)557 1769 y(})145 1821 y Fp(Uses)12 b Fl(exps_eq)d
Fp(84c)i(and)g Fl(fail)f Fp(410.)0 1912 y(85d)89 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(exps_eq)f Fp(85a)p Fo(i)o Fv(+)q
Fo(\021)666 b Fp(\(84c\))22 b Fm(/)5 b Fp(85c)23 b(86a)5
b Fm(.)187 1962 y Fr("set")217 b(:)21 b({)h(if)f(*e1)g(~=)h(*e2)f(then)
g(fail)601 2011 y(s)g(:=)h(set\(\))601 2061 y(every)f(x)g(:=)h(!e1)f
(do)644 2111 y(if)h(exps_eq\(x,)e(y)h(:=)h(!e2\))688
2161 y(then)f(insert\(s,)f(y\))644 2211 y(else)688 2261
y(fail)601 2310 y(*s)h(=)h(*e2)579 2360 y(})145 2412
y Fp(Uses)12 b Fl(exps_eq)d Fp(84c)i(and)g Fl(fail)f
Fp(410.)p eop
%%Page: 86 86
86 85 bop 129 141 a Fv(86)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)-13 258 y Fp(86a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(exps_eq)f Fp(85a)p Fo(i)o Fv(+)q Fo(\021)660
b Fp(\(84c\))22 b Fm(/)6 b Fp(85d)22 b(86b)5 b Fm(.)171
307 y Fr("Eorb")21 b(|)g("Eand")g(:)g(exps_eq\(e1.x,)e(e2.x\))i(&)h
(exps_eq\(e1.y,)d(e2.y\))171 357 y("Eslice")h(:)i(e1.lo)e(=)i(e2.lo)f
(&)g(e1.n)g(=)h(e2.n)f(&)g(exps_eq\(e1.x,)f(e2.x\))171
407 y("Eshift")g(|)i("Enarrowu")d(|)j("Enarrows")e(|)h("Ewiden")f(|)i
("Ediv")f(|)g("Emod")g(|)171 457 y("Efitsu")f(|)i("Efitss")e(:)h(e1.n)g
(=)h(e2.n)f(&)h(exps_eq\(e1.x,)d(e2.x\))171 507 y("Epatlabel")g(:)j
(e1.l)f(===)g(e2.l)171 557 y("Eforce")f(|)i("Eforceable")d(|)j("Enot")e
(|)i("Enosimp")e(|)h("Sstmts")f(|)i("Semit")e(:)i(exps_eq\(e1.x,)d
(e2.x\))171 606 y("Epc")i(|)g("Epc_known")f(:)h(true)171
656 y("Stoken")f(:)i(e1.offset)e(=)h(e1.offset)f(&)i(e1.n)f(=)g(e2.n)g
(&)h(exps_eq\(e1.x,)d(e2.x\))171 706 y("Einstance_input")40
b(:)22 b(e1.cons)e(===)h(e2.cons)f(&)i(e1.name)e(==)i(e2.name)e(&)i
(exps_eq\(e1.x,)d(e2.x\))171 756 y("Einstance_tagged)o(")g(:)j(e1.cons)
e(===)h(e2.cons)f(&)i(e1.uid)f(=)g(e2.uid)g(&)g(exps_eq\(e1.x,)e
(e2.x\))171 806 y("Einstance")172 b(:)22 b(impossible\("esca)o(ping)c
(Einstance"\))171 855 y("Ebinding_instanc)o(e":)h(impossible\("esca)o
(ping)f(Ebinding_instance"\))129 907 y Fp(Uses)d Fl(Eand)f
Fp(81,)f Fl(Ebinding_ins)o(ta)o(nce)e Fp(81,)j Fl(Ediv)f
Fp(81,)h Fl(Efitss)f Fp(81,)h Fl(Efitsu)f Fp(81,)g Fl(Eforce)g
Fp(81,)171 946 y Fl(Eforceable)d Fp(81,)j Fl(Einstance)d
Fp(81,)i Fl(Einstance_in)o(pu)o(t)f Fp(81,)h Fl(Einstance_t)o(agg)o(ed)
e Fp(81,)j Fl(Emod)f Fp(81,)171 986 y Fl(Enarrows)f Fp(81,)j
Fl(Enarrowu)d Fp(81,)j Fl(Enosimp)d Fp(81,)j Fl(Enot)f
Fp(81,)g Fl(Eorb)g Fp(81,)g Fl(Epatlabel)f Fp(81,)h Fl(Epc)g
Fp(81,)171 1025 y Fl(Epc_known)d Fp(81,)j Fl(Eshift)e
Fp(81,)i Fl(Eslice)e Fp(81,)i Fl(Ewiden)e Fp(81,)i Fl(exps_eq)e
Fp(84c,)h Fl(Semit)g Fp(81,)g Fl(Sstmts)g Fp(81,)171
1064 y(and)f Fl(Stoken)e Fp(81.)-15 1153 y(86b)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(exps_eq)f Fp(85a)p Fo(i)o Fv(+)q
Fo(\021)666 b Fp(\(84c\))22 b Fm(/)6 b Fp(86a)22 b(86c)5
b Fm(.)171 1203 y Fr("Sif")21 b(|)g("Sguarded")f(|)i("Stagcase")d(:)j
(fail)129 1254 y Fp(Uses)12 b Fl(fail)e Fp(410,)h Fl(Sguarded)e
Fp(81,)i Fl(Sif)f Fp(81,)h(and)g Fl(Stagcase)e Fp(183a.)-12
1343 y(86c)89 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(exps_eq)f
Fp(85a)p Fo(i)o Fv(+)q Fo(\021)660 b Fp(\(84c\))22 b
Fm(/)6 b Fp(86b)22 b(86d)5 b Fm(.)171 1393 y Fr("Glines")85
b(:)22 b(fail)171 1443 y("Gresynch")41 b(:)22 b(fail)171
1493 y("Gblock")85 b(:)22 b(fail)171 1542 y("Gdecl")107
b(:)22 b(fail)171 1592 y("Gcase")107 b(:)22 b(fail)171
1642 y("Gcasearm")41 b(:)22 b(fail)171 1692 y("Ginrange")41
b(:)22 b(fail)171 1742 y("Gsetname")41 b(:)22 b(fail)171
1791 y("Gnomatch")41 b(:)22 b(fail)171 1841 y("Gasgn")107
b(:)22 b(fail)171 1891 y("Tunsigned")d(:)j(fail)171 1941
y("Gcomment")41 b(:)22 b(fail)171 1991 y("Gcommented")d(:)j(e1.comment)
e(==)h(e2.comment)f(&)h(exps_eq\(e1.e,)e(e2.e\))129 2042
y Fp(Uses)c Fl(exps_eq)c Fp(84c,)i Fl(fail)g Fp(410,)g
Fl(Gasgn)g Fp(294a,)f Fl(Gblock)h Fp(293a,)f Fl(Gcase)h
Fp(294a,)f Fl(Gcasearm)g Fp(294a,)171 2081 y Fl(Gcomment)d
Fp(20,)i Fl(Gcommented)e Fp(299a,)h Fl(Gdecl)h Fp(293a,)f
Fl(Ginrange)f Fp(294a,)i Fl(Glines)f Fp(293a,)g Fl(Gnomatch)f
Fp(294a,)171 2121 y Fl(Gresynch)g Fp(293a,)h Fl(Gsetname)f
Fp(294a,)h(and)h Fl(Tunsigned)d Fp(294a.)-15 2210 y(86d)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(exps_eq)f Fp(85a)p
Fo(i)o Fv(+)q Fo(\021)668 b Fp(\(84c\))22 b Fm(/)6 b
Fp(86c)22 b(86e)5 b Fm(.)171 2260 y Fr("string")42 b(:)21
b(e1)h(==)f(e2)171 2309 y("integer")f(:)h(e1)h(=)f(e2)-12
2398 y Fp(86e)89 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(exps_eq)f
Fp(85a)p Fo(i)o Fv(+)q Fo(\021)662 b Fp(\(84c\))22 b
Fm(/)6 b Fp(86d)22 b(87a)5 b Fm(.)171 2448 y Fr("Eapp")21
b(:)g(fail)129 2499 y Fp(Uses)12 b Fl(Eapp)e Fp(81)i(and)e
Fl(fail)g Fp(410.)p eop
%%Page: 87 87
87 86 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(87)2 258 y Fp(87a)89 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(exps_eq)f Fp(85a)p Fo(i)o Fv(+)q Fo(\021)766
b Fp(\(84c\))22 b Fm(/)5 b Fp(86e)187 307 y Fr("Eclosure_loc")19
b(:)i(e1)187 357 y("Eclosure_addr")d(:)k(e1.n)f(=)h(e2.n)187
407 y("Eclosure_val")d(:)i(e1.n)g(=)h(e2.n)145 459 y
Fp(Uses)12 b Fl(Eclosure_a)o(ddr)c Fp(81,)j Fl(Eclosure_l)o(oc)d
Fp(81,)j(and)g Fl(Eclosure_v)o(al)d Fp(81.)208 530 y
Fv(F)m(or)16 b(matc)o(hing)f(equations,)i(w)o(e)g(ha)o(v)o(e)g(a)f
(plethora)h(of)g(p)q(ossibilities.)26 b(The)17 b(\014rst)h(line)145
579 y(is)i(an)f(optimization.)32 b(F)m(or)20 b(the)g(second)h(line,)f
(w)o(e)f(test)i(b)q(oth)f(for)f(the)h(same)f(relation)145
629 y(and)e(\\opp)q(osite")h(relations.)28 b(Note)18
b(that)f(equalit)o(y)g(is)g(its)g(o)o(wn)g(opp)q(osite,)h(so)g
Fi(a)f Fv(=)g Fi(b)h Fv(is)145 679 y(equiv)n(alen)o(t)e(to)f
Fi(a)419 664 y Fh(0)446 679 y Fv(=)g Fi(b)511 664 y Fh(0)539
679 y Fv(if)g(either)i Fi(a)11 b Fo(\000)f Fi(b)15 b
Fv(=)h Fi(a)877 664 y Fh(0)899 679 y Fo(\000)11 b Fi(b)960
664 y Fh(0)987 679 y Fv(or)16 b Fi(a)11 b Fo(\000)g Fi(b)k
Fv(=)g Fi(b)1214 664 y Fh(0)1236 679 y Fo(\000)c Fi(a)1301
664 y Fh(0)1313 679 y Fv(.)24 b(Similarly)13 b(for)145
729 y(simple)g(inequalit)o(y)m(.)0 791 y Fp(87b)89 b
Fo(h)p Fn(e)n(quations)16 b Fr(e1)e Fn(and)i Fr(e2)e
Fn(ar)n(e)h(the)g(same)g Fp(87b)p Fo(i)o(\021)605 b Fp(\(85b\))187
841 y Fr(\(e1.op)20 b(==)i(e2.op,)e(exps_eq\(e1.left,)f(e2.left\),)h
(exps_eq\(e1.right)o(,)f(e2.right\)\))h(|)187 891 y(\(d1)h(:=)g
(subtract\(e1.left,)e(e1.right\),)230 941 y(\(e1.op)i(==)g(e2.op,)252
990 y(exps_eq\(d1,)f(subtract\(e2.left)o(,)f(e2.right\)\)\))g(|)230
1040 y(\(e1.op)i(==)g(opposite_op\(e2.op\),)252 1090
y(exps_eq\(d1,)f(subtract\(e2.righ)o(t,)f(e2.left\)\)\)\))145
1142 y Fp(Uses)12 b Fl(exps_eq)d Fp(84c,)i Fl(opposite_o)o(p)e
Fp(87c,)h(and)h Fl(subtract)e Fp(144c.)4 1225 y(87c)89
b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p Fo(\021)1090
b Fm(/)5 b Fp(84c)23 b(88a)5 b Fm(.)187 1275 y Fr(procedure)20
b(opposite_op\(op\))230 1324 y(return)h(case)g(op)g(of)h({)274
1374 y("<")43 b(:)22 b(">")274 1424 y("<=")f(:)h(">=")274
1474 y(">")43 b(:)22 b("<")274 1524 y(">=")f(:)h("<=")274
1574 y("=")43 b(:)22 b("=")274 1623 y("!=")f(:)h("!=")230
1673 y(})187 1723 y(end)145 1775 y Fp(De\014nes:)187
1814 y Fl(opposite_o)o(p)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(87b.)p
eop
%%Page: 88 88
88 87 bop 129 141 a Fv(88)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)-13 258 y Fp(88a)88 b Fo(h)p Fn(*)16
b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(87c)22
b(88b)5 b Fm(.)171 307 y Fr(procedure)20 b(untableexp\(e\))215
357 y(local)g(result)215 407 y(if)h(type\(e\))f(==)i("table")e(then)h
({)258 457 y(every)g(k)g(:=)h(key\(e\))e(&)i(e[k])f(=)h(0)f(do)302
507 y(delete\(e,)f(k\))258 557 y(case)h(*e)g(of)h({)302
606 y(0:)f(return)g(0)302 656 y(1:)g({)h(k)f(:=)h(key\(e\))411
706 y(if)f(k)h(===)f(1)g(then)g(return)g(e[k])411 756
y(else)g(if)g(e[k])g(=)h(1)f(then)g(return)g(k)367 806
y(})280 855 y(})215 905 y(})215 955 y(return)f(e)171
1005 y(end)129 1057 y Fp(De\014nes:)171 1096 y Fl(untableexp)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(84c,)g(156a,)g(316b,)g(318a,)g(and)
h(321.)129 1254 y Fj(5.3)67 b(Substitution)129 1345 y
Fv(I)14 b(ha)o(v)o(e)g(t)o(w)o(o)f(forms:)k(single)d(v)n(alue)f(for)g
(v)n(ariable)g(and)h(v)n(alues)f(for)h(v)n(ariables)f(in)h(table.)-15
1407 y Fp(88b)88 b Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p
Fo(\021)1088 b Fm(/)6 b Fp(88a)22 b(89a)5 b Fm(.)171
1457 y Fr(procedure)20 b(subst_f\(e,)g(var,)h(value\))215
1507 y(if)g(type\(e\))f(===)h("string")g(then)g(return)f(if)h(var)h(==)
f(e)h(then)f(value)f(else)h(e)171 1557 y(end)171 1656
y(procedure)f(subst\(e,)g(var,)h(value\))215 1706 y(return)f(if)h(var)h
(===)f(value)g(then)g(e)174 b(#)21 b(optimization)367
1756 y(else)g(do_gsubst\(e,)e(subst_f,)i([var,)f(value]\))171
1806 y(end)129 1858 y Fp(De\014nes:)171 1897 y Fl(subst)p
Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(90b,)h(169,)f(171a,)g(215,)h
(225a,)f(and)h(260.)171 1937 y Fl(subst_f)p Fp(,)e(used)i(in)g(c)o(h)o
(unk)f(90a.)129 1976 y(Uses)i Fl(do_gsubst)d Fp(120a)h(and)h
Fl(value)f Fp(136a.)p eop
%%Page: 89 89
89 88 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(89)208 258 y(If)14 b Fr(all)f Fv(is)i(not)f(n)o
(ull,)f(all)g(the)i(free)g(v)n(ariables)f(in)g(the)h(expression)h(m)o
(ust)d(b)q(e)i(b)q(ound)g(b)o(y)145 307 y(the)g(table.)2
370 y Fp(89a)89 b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p
Fo(\021)1084 b Fm(/)6 b Fp(88b)22 b(89b)5 b Fm(.)187
420 y Fr(procedure)20 b(subst_tab_f\(e,)f(tbl,)i(all\))230
469 y(return)g(if)g(type\(e\))g(==)g("string")f(then)427
519 y(\\tbl[e])g(|)h(if)h(\\all)f(then)688 569 y(error\("variable)e(",)
i(image\(e\),")f(is)h(unbound)g(in)g(table)g(",)1298
619 y(envimage\(tbl,)e("substitions"\)\))644 669 y(else)688
718 y(e)187 768 y(end)187 868 y(procedure)h(subst_tab\(e,)f(tbl,)i
(all\))230 918 y(return)g(do_gsubst\(e,)e(subst_tab_f,)h([tbl,)g
(all]\))187 967 y(end)145 1019 y Fp(De\014nes:)187 1059
y Fl(subst_tab)p Fp(,)9 b(used)j(in)h(c)o(h)o(unks)e(57,)h(90b,)g
(143b,)f(154,)h(172a,)g(173a,)f(188b,)g(264,)h(298b,)g(300,)f(308,)228
1098 y(and)g(320b.)187 1138 y Fl(subst_tab_)o(f)p Fp(,)d(used)j(in)g(c)
o(h)o(unk)f(90a.)145 1177 y(Uses)i Fl(do_gsubst)d Fp(120a)h(and)g
Fl(envimage)f Fp(27a.)208 1239 y Fv(Sometimes)k(w)o(e)j(just)f(w)o(an)o
(t)h(to)f(substitute)i(for)e(all)f(elemen)o(ts)i(of)f(an)o(y)g(table,)g
(ev)o(en)h(if)145 1289 y(they)f(aren't)f(just)g(strings.)0
1351 y Fp(89b)89 b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p
Fo(\021)1090 b Fm(/)5 b Fp(89a)23 b(89c)5 b Fm(.)187
1401 y Fr(procedure)20 b(subst_table_elem)o(ents_)o(f\(e,)e(tbl\))230
1451 y(return)j(\\tbl[e])187 1501 y(end)187 1551 y(procedure)f
(subst_table_elem)o(ents\()o(e,)f(tbl\))230 1601 y(return)i
(do_gsubst\(e,)e(subst_table_element)o(s_f,)f([tbl]\))187
1650 y(end)145 1702 y Fp(De\014nes:)187 1742 y Fl(subst_tabl)o(e_e)o
(le)o(men)o(ts)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(59d,)g(209a,)g
(and)h(227a.)145 1781 y(Uses)h Fl(do_gsubst)d Fp(120a.)4
1864 y(89c)89 b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p
Fo(\021)1086 b Fm(/)6 b Fp(89b)22 b(90a)5 b Fm(.)187
1914 y Fr(procedure)20 b(subst_for_pc_f\(e)o(,)f(val\))230
1964 y(return)i(if)g(e)h(===)f(the_global_pc)e(then)i(val)187
2014 y(end)187 2113 y(procedure)f(subst_for_pc\(e,)e(val\))230
2163 y(return)j(do_gsubst\(e,)e(subst_for_pc_f,)g([val]\))187
2213 y(end)145 2265 y Fp(De\014nes:)187 2304 y Fl(subst_for_)o(pc)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(296,)g(297a,)g(and)h(301a.)145
2344 y(Uses)h Fl(do_gsubst)d Fp(120a)h(and)g Fl(the_global_p)o(c)f
Fp(19d.)p eop
%%Page: 90 90
90 89 bop 129 141 a Fv(90)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)192 258 y(Sometimes)e(the)k(v)n(alues)f(in)f(a)h(table)
f(are)i(expressions.)-13 320 y Fp(90a)88 b Fo(h)p Fn(*)16
b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(89c)22
b(90b)5 b Fm(.)171 370 y Fr(procedure)20 b(subst_values_in_t)o(able\()o
(t,)f(var,)i(value\))215 420 y(return)f(do_gsubst_values_i)o(n_tab)o
(le\(t,)e(subst_f,)i([var,)h(value]\))171 469 y(end)171
569 y(procedure)f(subst_tab_values_)o(in_ta)o(ble\(t)o(,)f(var,)i
(value\))215 619 y(return)f(do_gsubst_values_i)o(n_tab)o(le\(t,)e
(subst_tab_f,)h([var,)i(value]\))171 669 y(end)171 768
y(procedure)f(do_gsubst_values_)o(in_ta)o(ble\(t)o(,)f(f,)i(closure\))
215 818 y(n)g(:=)h(0)215 868 y(u)f(:=)h(table\(\))215
918 y(every)e(k)i(:=)f(key\(t\))g(&)g(x)h(:=)f(do_gsubst\(t[k],)e(f,)i
(closure\))g(do)g({)258 967 y(u[k])g(:=)g(x)258 1017
y(if)h(x)f(~===)g(t[k])g(then)g(n)h(+:=)f(1)215 1067
y(})215 1117 y(return)f(if)h(n)h(>)g(0)f(then)g(u)h(else)f(t)171
1167 y(end)129 1219 y Fp(De\014nes:)171 1258 y Fl(do_gsubst_)o(val)o
(ues)o(_in)o(_t)o(abl)o(e)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(122a.)
129 1297 y(Uses)i Fl(do_gsubst)d Fp(120a,)h Fl(subst_f)f
Fp(88b,)i Fl(subst_tab)o(_f)d Fp(89a,)j(and)f Fl(value)g
Fp(136a.)192 1360 y Fv(The)15 b(solv)o(er)g(needs)h(destructiv)o(e)g
(substitution)f(when)g Fr(e)g Fv(is)f(a)h(table)f(or)h(an)f(equation.)
-1980 b Fk(\031Change)13 b(#37)129 1410 y Fv(F)m(ortuitously)m(,)g(w)o
(e)h(can)g(use)g(the)h(same)e(co)q(de)i(for)e Fr(dsubst)g
Fv(and)h Fr(dsubst_tab)p Fv(.)-15 1472 y Fp(90b)88 b
Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1106 b
Fm(/)5 b Fp(90a)23 b(91)5 b Fm(.)171 1522 y Fr(procedure)20
b(dsubst\(e,)g(var,)h(value\))215 1571 y(return)f(destructive_subst\()o
(e,)f(var,)i(value,)f(subst\))171 1621 y(end)171 1671
y(procedure)g(dsubst_tab\(e,)f(tbl,)i(all\))215 1721
y(return)f(destructive_subst\()o(e,)f(tbl,)i(all,)g(subst_tab\))171
1771 y(end)129 1823 y Fp(De\014nes:)171 1862 y Fl(dsubst)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(140a.)171 1901 y Fl(dsubst_tab)o
Fp(,)f(used)i(in)g(c)o(h)o(unk)f(143b.)129 1941 y(Uses)i
Fl(destructive)o(_su)o(bs)o(t)d Fp(91,)i Fl(subst)f Fp(88b,)g
Fl(subst_tab)f Fp(89a,)h(and)h Fl(value)f Fp(136a.)p
eop
%%Page: 91 91
91 90 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(91)20 258 y Fp(91)89 b Fo(h)p Fn(*)15
b Fp(81)p Fo(i)p Fv(+)p Fo(\021)1086 b Fm(/)6 b Fp(90b)22
b(92a)5 b Fm(.)187 307 y Fr(procedure)20 b(destructive_subs)o(t\(e,)e
(a2,)k(a3,)f(substitute\))230 357 y(if)h(type\(e\))e(==)h("eqn")g(then)
g({)274 407 y(e.left)42 b(:=)22 b(destructive_subs)o(t\(ter)o(m2tab)o
(le\(e)o(.left)o(\),)41 b(a2,)21 b(a3,)g(substitute\))274
457 y(e.right)f(:=)i(destructive_subs)o(t\(ter)o(m2tab)o(le\(e)o(.righ)
o(t\),)d(a2,)i(a3,)g(substitute\))230 507 y(})h(else)f({)274
557 y(m)h(:=)f(copy\(e\))274 606 y(every)g(k)g(:=)h(key\(m\))e(&)i(mm)f
(:=)h(m[k])f(&)g(kk)h(:=)f(substitute\(k,)e(a2,)i(a3\))g(do)h({)318
656 y(e[k])f(-:=)g(mm)318 706 y(if)g(type\(kk\))f(~==)h("table")g(then)
361 756 y(e[kk])g(+:=)g(mm)318 806 y(else)361 855 y(every)g(v)g(:=)h
(key\(kk\))e(do)i(e[v])f(+:=)g(kk[v])f(*)i(mm)274 905
y(})274 955 y(every)f(k)g(:=)h(key\(e\))e(&)i(e[k])f(=)g(0)h(do)f
(delete\(e,)f(k\))230 1005 y(})230 1055 y(return)h(e)187
1104 y(end)145 1156 y Fp(De\014nes:)187 1196 y Fl(destructiv)o(e_s)o
(ub)o(st)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(90b.)145
1235 y(Uses)i Fl(eqn)f Fp(83c)f(and)h Fl(term2table)d
Fp(113b.)p eop
%%Page: 92 92
92 91 bop 129 141 a Fv(92)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)129 258 y Fj(5.4)67 b(Simpli\014cation)129
349 y Fv(I)17 b(disco)o(v)o(ered)g(late)f(in)g(the)h(da)o(y)f(that)h
(there)g(need)h(to)e(b)q(e)h(t)o(w)o(o)f(kinds)g(of)g
(simpli\014cation.)129 398 y(Basically)m(,)f(some)f(of)h(the)h
(simplifying)c(rules)k(reduce)h(the)f(strength)h(of)e(op)q(erations,)h
(and)129 448 y(after)d(strength)h(reduction)f(the)h(solv)o(er)e(can't)h
(alw)o(a)o(ys)e(in)o(v)o(ert)i(the)g(results.)19 b(On)13
b(the)g(other)129 498 y(hand,)h(there)i(are)f(situations)f(in)g(whic)o
(h)g(one)h(simply)d(can't)i(do)h(without)f(simpli\014cation,)129
548 y(as)j(when)h(it)e(eliminates)g(an)h(unsolv)n(able)f(disjunct)h
(\(see)h(bug)f(#2\).)27 b(A)17 b(ten)o(tativ)o(e)g(\014x)g(is)129
598 y(to)g(designate)g(some)f(simpli\014cation)f(rules)i(as)g
Fo(h)p Fn(sup)n(er)h(r)n(ewrite)d(rules)i Fp(97b)p Fo(i)p
Fv(,)f(and)h(to)g(use)129 647 y(them)d(only)g(on)g(expressions)h(that)g
(w)o(on't)e(b)q(e)i(further)h(transformed.)i(They)d(are)g(used)g(in)129
697 y Fr(super_simplify)c Fv(only)m(.)1056 b Fk(\031Change)14
b(#11)192 747 y Fr(simplify)e Fv(is)i(not)f(functional;)g(it)g(ma)o(y)f
(m)o(utate)h(its)h(argumen)o(t.)-13 809 y Fp(92a)88 b
Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1108 b
Fm(/)5 b Fp(91)23 b(92c)5 b Fm(.)171 859 y Fr(procedure)20
b(simplify\(e\))215 909 y(local)g(left,)h(right)215 959
y(return)f(case)h(type\(e\))f(of)i({)258 1009 y($define)e(simfun)h
(simplify)302 1058 y Fo(h)p Fn(b)n(asic)15 b(c)n(ases)g(for)f
(simpli\014c)n(ation)h Fp(93a)p Fo(i)302 1108 y(h)p Fn(c)n(ases)g
(gener)n(ate)n(d)g(fr)n(om)f(r)n(ewrite)f(rules)h Fp(92b)p
Fo(i)258 1158 y Fr($undef)21 b(simfun)258 1208 y(default)f(:)i(e)215
1258 y(})171 1307 y(end)129 1359 y Fp(De\014nes:)171
1399 y Fl(simplify)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(83a,)h(137a,)f
(169,)g(172a,)g(173a,)h(180,)f(184a,)g(260,)h(and)f(320b.)129
1461 y Fv(I)k(need)h(an)f(empt)o(y)f(c)o(h)o(unk)h(for)f(b)q(o)q
(otstrapping.)-15 1523 y Fp(92b)88 b Fo(h)p Fn(c)n(ases)16
b(gener)n(ate)n(d)f(fr)n(om)f(r)n(ewrite)f(rules)h Fp(92b)p
Fo(i)o(\021)603 b Fp(\(92a\))-12 1606 y(92c)89 b Fo(h)p
Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1088 b Fm(/)6
b Fp(92a)22 b(96a)5 b Fm(.)171 1656 y Fr(procedure)20
b(super_simplify\(e\))215 1706 y(local)g(left,)h(right)215
1756 y(return)f(case)h(type\(e\))f(of)i({)258 1806 y($define)e(simfun)h
(super_simplify)302 1855 y Fo(h)p Fn(b)n(asic)15 b(c)n(ases)g(for)f
(simpli\014c)n(ation)h Fp(93a)p Fo(i)302 1905 y(h)p Fn(c)n(ases)g
(gener)n(ate)n(d)g(fr)n(om)f(sup)n(er)h(r)n(ewrite)e(rules)h
Fp(92d)p Fo(i)258 1955 y Fr($undef)21 b(simfun)258 2005
y(default)f(:)i(e)215 2055 y(})171 2104 y(end)129 2156
y Fp(De\014nes:)171 2196 y Fl(super_simp)o(lif)o(y)p
Fp(,)9 b(used)j(in)g(c)o(h)o(unks)f(21a,)g(22b,)g(77a,)h(93a,)f(95c,)h
(174b,)f(175b,)g(187a,)g(188b,)g(196c,)212 2235 y(198b,)g(200b,)f
(209a,)g(215,)g(264,)h(270b,)f(327,)g(335b,)g(341e,)h(and)f(346c.)129
2306 y Fv(I)k(need)h(an)f(empt)o(y)f(c)o(h)o(unk)h(for)f(b)q(o)q
(otstrapping.)-15 2368 y Fp(92d)88 b Fo(h)p Fn(c)n(ases)16
b(gener)n(ate)n(d)f(fr)n(om)f(sup)n(er)h(r)n(ewrite)e(rules)h
Fp(92d)p Fo(i)o(\021)495 b Fp(\(92c\))p eop
%%Page: 93 93
93 92 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(93)2 258 y Fp(93a)89 b Fo(h)p Fn(b)n(asic)15
b(c)n(ases)g(for)g(simpli\014c)n(ation)f Fp(93a)p Fo(i)o(\021)723
b Fp(\(92\))187 307 y Fr("eqn")130 b(:)21 b({)p Fo(h)p
Fn(simplify)14 b(e)n(quation)h Fp(95c)p Fo(i)p Fr(})187
357 y("pattern")42 b(:)21 b({)p Fo(h)p Fn(simplify)14
b(p)n(attern)h Fp(93b)p Fo(i)o Fr(})187 407 y("disjunct")20
b(:)h({)p Fo(h)p Fn(simplify)14 b(disjunct)h Fp(94a)p
Fo(i)o Fr(})187 457 y("adisjunct":)k({)p Fo(h)p Fn(simplify)14
b(adisjunct)h Fp(94b)p Fo(i)o Fr(})187 507 y("sequent")42
b(:)21 b(if)g(\(l)h(:=)f(simfun\(e.constraint)o(s\)\))d(===)k
(e.constraints)d(then)i(e)470 557 y(else)g(sequent\(l,)f(e.class\))187
606 y("patlabel")107 b(:)21 b(e)187 656 y("dots_sequent")e(:)i(e)187
706 y("constraint")63 b(:)21 b(e)187 756 y("fieldbinding")e(:)i(if)h
(\(x)f(:=)g(simfun\(e.code\)\))e(===)i(e.code)g(then)g(e)557
806 y(else)g(fieldbinding\(e.fiel)o(d,)e(x\))187 855
y("absolute_field")f(:)230 905 y(if)k(simfun)e(===)h(super_simplify)e
(then)274 955 y(afieldexp\(e\))230 1005 y(else)274 1055
y(e)187 1104 y("set")64 b(:)22 b({)p Fo(h)p Fn(simplify)14
b(set)g(of)h(c)n(onditions)g Fp(94c)p Fo(i)p Fr(})187
1154 y("table")20 b(:)i({)p Fo(h)p Fn(simplify)14 b(table)g
Fp(95b)p Fo(i)o Fr(})187 1204 y("list")42 b(:)22 b({l)f(:=)g
(maplist\(simfun,)e(e\);)i(if)h(lists_match\(e,)d(l\))i(then)g(e)h
(else)f(l})187 1254 y("integer")f(|)h("string")f(:)i(e)187
1304 y("Einstance")d(:)j({)p Fo(h)p Fn(simplify)14 b(instanc)n(e's)h
(ar)n(gument)g(table)f Fp(94d)p Fo(i)o Fr(})187 1354
y("Stagcase")41 b(:)22 b({)p Fo(h)p Fn(simplify)14 b(tag)h(c)n(ase's)g
(arm)f(table)h Fp(95a)p Fo(i)o Fr(})187 1403 y("Sif")64
b(:)22 b({)p Fo(h)p Fn(simplify)14 b(if)g(statement)h
Fp(95d)p Fo(i)o Fr(})187 1453 y("Enosimp")20 b(:)h(e)153
b(#)21 b(suppresses)f(simplification)187 1503 y("Gcommented")f(:)j(if)f
(\(ee)g(:=)h(simfun\(e.e\)\))d(===)i(e.e)g(then)g(e)h(else)f
(Gcommented\(ee,)e(e.comment\))187 1553 y("Gcomment")h(:)h(e)145
1605 y Fp(Uses)c Fl(absolute_)o(fie)o(ld)c Fp(268,)i
Fl(adisjunct)f Fp(268,)h Fl(afieldexp)e Fp(299a,)i Fl(constrain)o(t)f
Fp(55,)187 1644 y Fl(constraint)o(s)e Fp(136a,)h Fl(disjunct)f
Fp(55,)h Fl(dots_sequent)e Fp(62c,)i Fl(Einstance)f Fp(81,)i
Fl(Enosimp)e Fp(81,)187 1684 y Fl(eqn)f Fp(83c,)g Fl(field)g
Fp(55,)g Fl(fieldbindin)o(g)f Fp(55,)h Fl(Gcomment)f
Fp(20,)h Fl(Gcommented)e Fp(299a,)i Fl(lists_mat)o(ch)e
Fp(127a,)187 1723 y Fl(patlabel)g Fp(55,)i Fl(pattern)e
Fp(55,)i Fl(sequent)e Fp(55,)i Fl(Sif)f Fp(81,)h Fl(Stagcase)e
Fp(183a,)h(and)h Fl(super_simp)o(lif)o(y)e Fp(92c.)208
1794 y Fv(Simpli\014cation)g(of)j(a)g(disjunct)h(could)f(fail,)f
(implying)f(that)i(the)h(disjunct's)g(condition)145 1843
y(is)h(alw)o(a)o(ys)f(false.)0 1906 y Fp(93b)89 b Fo(h)p
Fn(simplify)14 b(p)n(attern)h Fp(93b)p Fo(i)o(\021)934
b Fp(\(93a\))187 1955 y Fr(l)21 b(:=)h([];)f(every)g(put\(l,)f
(simfun\(!e.disjuncts)o(\)\))187 2005 y(if)h(lists_match\(l,)e
(e.disjuncts\))g(then)i(e)h(else)f(pattern\(l,)f(e.name\))145
2057 y Fp(Uses)12 b Fl(lists_matc)o(h)d Fp(127a)h(and)h
Fl(pattern)e Fp(55.)p eop
%%Page: 94 94
94 93 bop 129 141 a Fv(94)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)-13 258 y Fp(94a)88 b Fo(h)p Fn(simplify)15
b(disjunct)g Fp(94a)p Fo(i)o(\021)921 b Fp(\(93a\))171
307 y Fr(c)22 b(:=)f(simfun\(e.conditio)o(ns\))171 357
y(if)g(member\(\\c,)f(0\))h(then)g(fail)171 407 y(else)g({)215
457 y(l)g(:=)h([];)f(every)f(put\(l,)h(vanishing_latent_)o(patla)o(bel)
e(~===)i(simfun\(!e.seque)o(nts\)\))215 507 y(if)g(lists_match\(l,)e
(e.sequents\))g(then)i(l)h(:=)f(e.sequents)215 557 y(if)g(ss)g(:=)h(!l)
f(&)h(type\(ss\))e(==)h("sequent")f(&)280 606 y(cc)h(:=)h
(!ss.constraints)c(&)k(type\(cc\))e(==)h("constraint")f(&)h(cc.lo)g(>=)
h(cc.hi)215 656 y(then)258 706 y(fail)f(#)h(this)f(disjunct)f(can't)h
(match)f(--)i(eliminate)e(it)215 756 y(if)h(c)h(===)f(e.conditions)e(&)
j(l)f(===)g(e.sequents)f(then)h(e)h(else)f(disjunct\(l,)e(e.name,)h
(c\))171 806 y(})129 857 y Fp(Uses)15 b Fl(constrain)o(t)c
Fp(55,)j Fl(constraint)o(s)d Fp(136a,)i Fl(disjunct)e
Fp(55,)j Fl(fail)f Fp(410,)g Fl(lists_mat)o(ch)e Fp(127a,)171
897 y Fl(sequent)e Fp(55,)i(and)g Fl(vanishing)o(_la)o(ten)o(t_p)o(atl)
o(ab)o(el)d Fp(32a.)-15 988 y(94b)88 b Fo(h)p Fn(simplify)15
b(adisjunct)g Fp(94b)p Fo(i)o(\021)898 b Fp(\(93a\))171
1038 y Fr(c)22 b(:=)f(simfun\(e.conditio)o(ns\))171 1088
y(if)g(member\(\\c,)f(0\))h(then)g(fail)171 1138 y(else)g({)215
1187 y(l)g(:=)h(simfun\(e.aconst)o(raint)o(s\))215 1237
y(if)f(cc)g(:=)h(!l)f(&)h(type\(cc\))e(==)h("constraint")e(&)j(cc.lo)f
(>=)g(cc.hi)g(then)258 1287 y(fail)g(#)h(this)f(disjunct)f(can't)h
(match)f(--)i(eliminate)e(it)215 1337 y(if)h(c)h(===)f(e.conditions)e
(&)j(l)f(===)g(e.aconstraints)e(then)i(e)h(###)f(&)h(a)f(===)g
(e.answers)f(then)h(e)215 1387 y(else)g(adisjunct\(l,)e(e.name,)h(c,)i
(e.length,)d(e.patlabelbindings\))f(###)k(,)f(a\))171
1437 y(})129 1488 y Fp(Uses)12 b Fl(adisjunct)d Fp(268,)h
Fl(constraint)e Fp(55,)j Fl(disjunct)e Fp(55,)i(and)g
Fl(fail)f Fp(410.)-12 1580 y(94c)89 b Fo(h)p Fn(simplify)15
b(set)f(of)h(c)n(onditions)g Fp(94c)p Fo(i\021)768 b
Fp(\(93a\))171 1630 y Fr(s)22 b(:=)f(set\(\))171 1679
y(every)g(x)g(:=)h(simfun\(!e\))d(do)j({)215 1729 y(if)f(type\(x\))f
(==)i("eqn")e(then)h({)258 1779 y(if)130 b(x.op)21 b(==)h("=")43
b(&)21 b(x.left)g(===)g(x.right)f(then)h(x)h(:=)f(1)258
1829 y(else)g(if)g(x.op)g(==)h("!=")f(&)g(x.left)g(===)g(x.right)f
(then)h(x)h(:=)f(0)215 1879 y(})215 1928 y(insert\(s,)e(x\))171
1978 y(})171 2028 y(delete\(s,)h(1\))171 2078 y(return)h(if)g
(member\(s,)f(0\))h(then)g(set\([0]\))324 2128 y(else)f(if)i
(sets_match\(e,)d(s\))i(then)g(e)324 2178 y(else)f(if)i(*s)f(=)h(0)f
(then)g(&null)324 2227 y(else)f(s)129 2279 y Fp(Uses)12
b Fl(eqn)f Fp(83c)g(and)f Fl(sets_match)e Fp(127b.)-15
2371 y(94d)88 b Fo(h)p Fn(simplify)15 b(instanc)n(e's)g(ar)n(gument)g
(table)f Fp(94d)p Fo(i)o(\021)603 b Fp(\(93a\))171 2420
y Fr(every)21 b(k)g(:=)h(key\(e.argt\))d(do)j(e.argt[k])e(:=)h
(simfun\(e.argt[k]\))171 2470 y(e)p eop
%%Page: 95 95
95 94 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(95)2 258 y Fp(95a)89 b Fo(h)p Fn(simplify)14
b(tag)h(c)n(ase's)g(arm)g(table)f Fp(95a)p Fo(i)o(\021)705
b Fp(\(93a\))187 307 y Fr(every)21 b(k)g(:=)h(key\(e.arms\))d(do)i
(e.arms[k])f(:=)i(simfun\(e.arms[k])o(\))187 357 y(e)0
449 y Fp(95b)89 b Fo(h)p Fn(simplify)14 b(table)h Fp(95b)p
Fo(i)o(\021)978 b Fp(\(93a\))187 498 y Fr(m)21 b(:=)h(copy\(e\))187
548 y(every)f(k)g(:=)h(key\(e\))e(do)h({)230 598 y(m[k])g(-:=)h(e[k])
230 648 y(add_to_table\(m,)d(simfun\(k\),)h(e[k]\))187
698 y(})187 747 y(every)h(k)g(:=)h(key\(m\))e(&)i(m[k])f(=)g(0)h(do)f
(delete\(m,)f(k\))187 797 y(if)h(*m)h(>)f(1)h(then)230
847 y(return)f(if)g(tables_match\(m,)e(e\))i(then)g(e)h(else)f(m)187
897 y(else)230 947 y(return)g(if)g(!m)h(=)f(1)h(then)f(key\(m\))f(else)
h(if)h(key\(m\))e(===)h(1)h(then)f(!m)g(else)g(m)145
999 y Fp(Uses)12 b Fl(add_to_tab)o(le)c Fp(126d)j(and)f
Fl(tables_matc)o(h)f Fp(127c.)4 1090 y(95c)89 b Fo(h)p
Fn(simplify)14 b(e)n(quation)i Fp(95c)p Fo(i)o(\021)915
b Fp(\(93a\))187 1140 y Fr(l)21 b(:=)h(simfun\(e.left\))187
1190 y(r)f(:=)h(simfun\(e.right\))187 1239 y(if)f(exps_eq\(l,)f(r\))h
(then)230 1289 y(if)h(e.left)e(===)h(0)h(&)g(e.right)e(===)h(0)h(then)f
(e)230 1339 y(else)g(eqn\(0,)g(e.op,)g(0\))187 1389 y(else)g(if)g
(simfun)g(===)g(super_simplify)e(&)i(#)h(not)f(safe)g(for)g(decoding!)f
(see)h(bugs{nnn})361 1439 y(\()h(\(type\(l\))e(==)h("Enarrows",)f
(type\(r\))g(==)h("Eslice",)64 b(r.lo)21 b(=)h(0\))f(|)405
1488 y(\(type\(l\))f(==)h("Eslice",)64 b(type\(r\))20
b(==)h("Enarrows",)f(l.lo)h(=)h(0\))f(\))h(&)361 1538
y(l.n)f(=)h(r.n)f(&)h(exps_eq\(l.x,)d(r.x\))296 1588
y(then)339 1638 y(simfun\(Efitss\(l.x,)f(l.n\)\))187
1688 y(else)230 1738 y(if)k(e.left)e(===)h(l)h(&)g(e.right)e(===)h(r)h
(then)f(e)230 1787 y(else)g(eqn\(l,)g(e.op,)g(r\))145
1839 y Fp(Uses)12 b Fl(Efitss)e Fp(81,)g Fl(Enarrows)f
Fp(81,)i Fl(eqn)g Fp(83c,)f Fl(Eslice)g Fp(81,)h Fl(exps_eq)e
Fp(84c,)i(and)f Fl(super_simpl)o(ify)e Fp(92c.)0 1931
y(95d)89 b Fo(h)p Fn(simplify)14 b(if)h(statement)g Fp(95d)p
Fo(i)o(\021)846 b Fp(\(93a\))187 1980 y Fr(a)21 b(:=)h
(simp_arms\(e.arms)o(,)d(simfun\))187 2030 y(if)i(*a)h(=)f(0)h(then)f
(Sepsilon\(\))187 2080 y(else)g(if)g(*a)h(=)f(1)h(&)f
(guard_always_satisf)o(ied\(a)o([1].)o(guard)o(\))e(then)i(a[1].x)187
2130 y(else)g(if)g(a)h(===)f(\(e.arms\))f(then)h(e)187
2180 y(else)g(Sif\(a\))145 2231 y Fp(Uses)12 b Fl(guard_alwa)o(ys_)o
(sat)o(isf)o(ie)o(d)d Fp(96b,)h Fl(Sepsilon)f Fp(81,)i
Fl(Sif)g Fp(81,)g(and)f Fl(simp_arms)f Fp(96a.)p eop
%%Page: 96 96
96 95 bop 129 141 a Fv(96)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)-13 258 y Fp(96a)88 b Fo(h)p Fn(*)16
b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1088 b Fm(/)6 b Fp(92c)22
b(96b)5 b Fm(.)171 307 y Fr(procedure)20 b(simp_arms\(earms,)e
(simfun\))215 357 y(local)i(arms)215 407 y(l)h(:=)h([])215
457 y(arms)f(:=)g(copy\(earms\))215 507 y(while)f(a)i(:=)f(get\(arms\))
f(&)i(g)f(:=)h(simfun\(a.guard\))c(do)258 557 y(if)k(guard_always_sa)o
(tisfi)o(ed\(g\))c(then)j({)h(#)f(always)g(take)g(this)g(arm)302
606 y(c)g(:=)h(simfun\(a.x\))302 656 y(put\(l,)e(if)i(exps_eq\(g,)d
(a.guard\))i(&)g(exps_eq\(c,)f(a.x\))h(then)g(a)g(else)g(Sguarded\(g,)f
(c\)\))302 706 y(return)g(if)i(lists_match\(l,)d(earms\))h(then)h
(earms)g(else)g(l)258 756 y(})h(else)f(if)g(not)g(case)g(type\(g\))g
(of)g({)302 806 y("integer")f(:)h(g)h(=)f(0)302 855 y("set")108
b(:)21 b(member\(g,)f(0\))258 905 y(})i(then)f({)g(#)h(sometimes)e
(take)h(this)g(arm)302 955 y(c)g(:=)h(simfun\(a.x\))302
1005 y(put\(l,)e(if)i(exps_eq\(g,)d(a.guard\))i(&)g(exps_eq\(c,)f
(a.x\))h(then)g(a)g(else)g(Sguarded\(g,)f(c\)\))258 1055
y(})215 1104 y(return)g(if)h(lists_match\(l,)e(earms\))i(then)g(earms)g
(else)g(l)171 1154 y(end)129 1206 y Fp(De\014nes:)171
1246 y Fl(simp_arms)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(95d.)129
1285 y(Uses)16 b Fl(arm)e Fp(271b,)g Fl(exps_eq)f Fp(84c,)h
Fl(guard_always)o(_s)o(ati)o(sfi)o(ed)e Fp(96b,)i Fl(lists_match)e
Fp(127a,)171 1324 y(and)f Fl(Sguarded)d Fp(81.)-15 1416
y(96b)88 b Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1088
b Fm(/)6 b Fp(96a)22 b(99a)5 b Fm(.)171 1466 y Fr(procedure)20
b(guard_always_sati)o(sfied)o(\(g\))215 1515 y(return)g(case)h
(type\(g\))f(of)i({)302 1565 y("integer")e(:)h(g)h(=)f(1)302
1615 y("set")108 b(:)21 b(*g)h(=)f(0)302 1665 y("null")86
b(:)21 b(&null)215 1715 y(})171 1764 y(end)129 1816 y
Fp(De\014nes:)171 1856 y Fl(guard_alwa)o(ys_)o(sat)o(isf)o(ie)o(d)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(95d,)h(96a,)f(222b,)g(273,)h(278,)f
(283b,)g(331c,)g(and)h(343e.)p eop
%%Page: 97 97
97 96 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(97)2 258 y Fp(97a)89 b Fo(h)p Fn(r)n(ewrite)13
b(rules)i Fp(97a)p Fo(i)o(\021)999 b Fp(97c)5 b Fm(.)187
307 y Fr(Eorb\(0,)20 b(x\))i(->)f(x)187 357 y(Eorb\(x,)f(0\))i(->)f(x)
187 407 y(Eorb\(N,)f(M\))i(->)f(ior\(N,)f(M\))187 457
y(Eorb\(Eorb\(x,)f(N\),)i(M\))h(->)f(Eorb\(x,)f(ior\(N,)h(M\)\))187
507 y(Eorb\(N,)f(x\))i(->)f(Eorb\(x,)f(N\))187 557 y(Eand\(1,)g(x\))i
(->)f(x)187 606 y(Eand\(0,)f(_\))i(->)f(0)187 656 y(Eand\(x,)f(1\))i
(->)f(x)187 706 y(Eand\(_,)f(0\))i(->)f(0)187 756 y(Eand\(x,)f(y\))i
(->)230 806 y(if)g(type\(x\))e(==)h("set")g(&)h(*x)f(=)h(0)f(then)g(y)
230 855 y(else)g(if)h(type\(x\))e(==)h("set")g(&)h(*y)f(=)h(0)f(then)g
(x)230 905 y(else)g(e)187 955 y(Eslice\(N,)f(lo,)h(n\))g(->)h
(iand\(ishift\(N,)d(-lo\),)h(2^n-1\))145 1007 y Fp(Uses)12
b Fl(Eand)e Fp(81,)h Fl(Eorb)g Fp(81,)f(and)h Fl(Eslice)f
Fp(81.)0 1098 y(97b)89 b Fo(h)p Fn(sup)n(er)15 b(r)n(ewrite)e(rules)i
Fp(97b)p Fo(i)o(\021)883 b Fp(97d)5 b Fm(.)187 1148 y
Fr(Eslice\(Eshift\(x,)18 b(n\),)j(m,)h(k\))f(->)230 1198
y(if)h(m)f(-)h(n)g(>=)f(0)g(then)g(Eslice\(x,)f(m-n,)h(k\))230
1248 y(else)g(Eslice\(Eshift\(x,)e(n-m\),)i(0,)g(k\))187
1297 y(Eslice\(y)f(as)h(Enarrowu\(x,)f(n\),)h(0,)g(m\))h(->)f(if)h(n)f
(<=)g(m)h(then)f(y)h(else)f(e)187 1347 y(Eslice\(y)f(as)h(Enarrows\(x,)
f(n\),)h(0,)g(m\))h(->)f(if)h(n)f(<=)g(m)h(then)f(y)h(else)f(e)187
1397 y(Eslice\(Eslice\(x,)d(l1,)j(n1\),)g(l2,)h(n2\))f(->)230
1447 y(if)h(l2)f(>=)h(n1)f(then)g(0)g(else)g(Eslice\(x,)f(l1+l2,)h(if)g
(n2)h(<)f(n1-l2)g(then)g(n2)g(else)g(n1-l2\))187 1497
y(Eslice\(y)f(as)h(Einstance_input\(x,)d(c,)k(name\),)e(0,)i(n\))f(->)
230 1547 y(if)h(ipt)f(:=)g(inputs_of\(c\))f(&)h(ipt.name)f(==)i(name)f
(&)g(case)g(type\(ipt.meaning\))e(of)i({)274 1596 y("field")f(:)i
(fwidth\(ipt.meanin)o(g\))d(<=)i(n)230 1646 y(})h(then)f(y)h(else)e(e)
187 1696 y(Eslice\(x,)g(0,)h(n\))g(->)h(if)f(n)h(=)f(wordsize)g(then)g
(x)g(else)g(e)145 1748 y Fp(Uses)14 b Fl(Einstance)o(_in)o(put)c
Fp(81,)i Fl(Enarrows)f Fp(81,)h Fl(Enarrowu)f Fp(81,)h
Fl(Eshift)g Fp(81,)g Fl(Eslice)f Fp(81,)i Fl(field)e
Fp(55,)187 1787 y Fl(fwidth)e Fp(115d,)i Fl(inputs_of)d
Fp(166a,)i(and)h Fl(wordsize)e Fp(38c.)4 1879 y(97c)89
b Fo(h)p Fn(r)n(ewrite)13 b(rules)i Fp(97a)p Fo(i)o Fv(+)p
Fo(\021)865 b Fm(/)6 b Fp(97a)22 b(98a)5 b Fm(.)187 1928
y Fr(Eshift\(x,)20 b(0\))h(->)g(x)187 1978 y(Eshift\(N,)f(n\))h(->)g
(ishift\(N,)f(n\))187 2028 y(Enarrowu\(N,)f(n\))j(->)f(if)g(0)h(<=)f(N)
h(<)g(2^n)f(then)g(N)g(else)g(Efail\(expimage\(e\)\))145
2080 y Fp(Uses)12 b Fl(Efail)e Fp(81,)h Fl(Enarrowu)e
Fp(81,)i Fl(Eshift)e Fp(81,)i(and)g Fl(expimage)e Fp(101a.)0
2171 y(97d)89 b Fo(h)p Fn(sup)n(er)15 b(r)n(ewrite)e(rules)i
Fp(97b)p Fo(i)o Fv(+)p Fo(\021)749 b Fm(/)6 b Fp(97b)22
b(98b)5 b Fm(.)187 2221 y Fr(Enarrowu\(y)20 b(as)h(Eslice\(x,)f(lo,)h
(n\),)g(m\))h(->)f(if)g(n)h(<=)f(m)h(then)f(y)g(else)g(e)187
2271 y(Enarrowu\(x,)e(M\))j(->)f(if)g(M)h(>=)f(wordsize)g(then)g(x)g
(else)g(e)145 2323 y Fp(Uses)12 b Fl(Enarrowu)d Fp(81,)i
Fl(Eslice)e Fp(81,)i(and)g Fl(wordsize)e Fp(38c.)p eop
%%Page: 98 98
98 97 bop 129 141 a Fv(98)83 b Fr(exp.nw)830 b Fv(No)o(v)o(em)o(b)q(er)
13 b(15,)g(1996)-13 258 y Fp(98a)88 b Fo(h)p Fn(r)n(ewrite)14
b(rules)g Fp(97a)p Fo(i)o Fv(+)p Fo(\021)869 b Fm(/)6
b Fp(97c)22 b(98c)5 b Fm(.)171 307 y Fr(Ewiden\(N,)20
b(n\))h(->)215 357 y(if)g(\(iand\(N,2^\(n-1\)\))d(=)k(0\))f(then)g
(iand\(N,2^n-1\))215 407 y(else)g(ior\(iand\(2^word)o(size-)o(1,ico)o
(m\(2^n)o(-1\)\))o(,N\))171 457 y(Enarrows\(N,)e(n\))j(->)215
507 y(if)f(-\(2^\(n-1\)\))f(<=)h(N)h(<)f(2^\(n-1\))g(then)g
(iand\(N,2^n-1\))e(else)i(Efail\(expimage\()o(e\)\))129
559 y Fp(Uses)12 b Fl(Efail)e Fp(81,)h Fl(Enarrows)e
Fp(81,)i Fl(Ewiden)e Fp(81,)i Fl(expimage)e Fp(101a,)h(and)h
Fl(wordsize)e Fp(38c.)-15 650 y(98b)88 b Fo(h)p Fn(sup)n(er)15
b(r)n(ewrite)e(rules)i Fp(97b)p Fo(i)o Fv(+)p Fo(\021)749
b Fm(/)6 b Fp(97d)22 b(98d)5 b Fm(.)171 700 y Fr(Ewiden\(x,)20
b(n\))h(->)h(if)f(n)h(=)f(wordsize)f(then)h(x)h(else)f(e)171
750 y(Enarrows\(y)f(as)h(Eslice\(x,)f(lo,)h(n\),)g(m\))h(->)f(if)g(n)h
(<)g(m)f(then)g(y)h(else)f(e)129 801 y Fp(Uses)12 b Fl(Enarrows)d
Fp(81,)i Fl(Eslice)f Fp(81,)g Fl(Ewiden)g Fp(81,)h(and)f
Fl(wordsize)f Fp(38c.)-12 893 y(98c)89 b Fo(h)p Fn(r)n(ewrite)14
b(rules)g Fp(97a)p Fo(i)o Fv(+)p Fo(\021)872 b Fm(/)6
b Fp(98a)22 b(98f)5 b Fm(.)171 943 y Fr(Enarrows\(Ewiden\(x)o(,)19
b(n\),)i(m\))h(->)f(if)g(n)h(=)g(m)f(then)g(x)h(else)f(e)171
992 y(Enarrows\(y)f(as)h(Enarrows\(x,)f(n\),)h(m\))g(->)h(if)f(n)g(=)h
(m)g(then)f(y)g(else)g(e)129 1044 y Fp(Uses)12 b Fl(Enarrows)d
Fp(81)i(and)g Fl(Ewiden)e Fp(81.)192 1115 y Fv(Note)k(w)o(e)f(can't)h
(rewrite)g Fr(Ewiden\(Enarrows\(x,)18 b(N\),)j(N\))12
b Fv(as)h Fr(x)f Fv(b)q(ecause)i(there's)g(no)129 1165
y(w)o(a)o(y)g(to)f(pic)o(k)h(up)g Fr(Efitss\(x,)20 b(N\))p
Fv(.)13 b(Ugh.)-15 1227 y Fp(98d)88 b Fo(h)p Fn(sup)n(er)15
b(r)n(ewrite)e(rules)i Fp(97b)p Fo(i)o Fv(+)p Fo(\021)753
b Fm(/)6 b Fp(98b)22 b(98e)5 b Fm(.)171 1277 y Fr(Enarrows\(x,)19
b(M\))j(->)f(if)h(M)f(>=)h(wordsize)e(then)h(x)g(else)g(e)171
1327 y(Ediv\(N,)f(M\))i(->)f(if)g(N)h(>)g(0)f(then)g(N)h(/)f(M)h(else)f
(\(N)g(-)h(M)f(+)h(1\))f(/)h(M)43 b(#)22 b(force)f(toward)f(-)i
(infinity)129 1378 y Fp(Uses)12 b Fl(Ediv)e Fp(81,)h
Fl(Enarrows)e Fp(81,)i(and)g Fl(wordsize)e Fp(38c.)-12
1461 y(98e)89 b Fo(h)p Fn(sup)n(er)15 b(r)n(ewrite)e(rules)i
Fp(97b)p Fo(i)o Fv(+)p Fo(\021)751 b Fm(/)6 b Fp(98d)22
b(98g)5 b Fm(.)171 1511 y Fr(Ediv\(x,)20 b(N\))i(->)f
(simfun\(Eshift\(x,)e(-)i(exactlog2\(N\)\)\))e(|)j(e)129
1563 y Fp(Uses)12 b Fl(Ediv)e Fp(81,)h Fl(Eshift)f Fp(81,)h(and)f
Fl(exactlog2)f Fp(100c.)-7 1654 y(98f)89 b Fo(h)p Fn(r)n(ewrite)14
b(rules)g Fp(97a)p Fo(i)o Fv(+)p Fo(\021)865 b Fm(/)6
b Fp(98c)22 b(99b)5 b Fm(.)171 1704 y Fr(Emod\(N,)20
b(M\))i(->)f({x)g(:=)h(integer\(N)e(\045)h(M\);)h(while)e(x)i(<)f(0)h
(do)f(x)h(+:=)f(M;)h(x})129 1756 y Fp(Uses)12 b Fl(Emod)e
Fp(81.)-13 1848 y(98g)88 b Fo(h)p Fn(sup)n(er)15 b(r)n(ewrite)e(rules)i
Fp(97b)p Fo(i)o Fv(+)p Fo(\021)855 b Fm(/)6 b Fp(98e)171
1897 y Fr(Emod\(x,)20 b(N\))i(->)215 1947 y(if)f(x)h(:=)f
(strip_const_multi)o(ple_N)o(\(x,)e(N\))i(then)258 1997
y(simfun\(Eslice\(x,)e(0,)i(exactlog2\(N\)\)\))e(|)i(Emod\(x,)g(N\))215
2047 y(else)258 2097 y(simfun\(Eslice\(x,)e(0,)i(exactlog2\(N\)\)\))e
(|)i(e)129 2148 y Fp(Uses)12 b Fl(Emod)e Fp(81,)h Fl(Eslice)f
Fp(81,)h Fl(exactlog2)d Fp(100c,)j(and)f Fl(strip_const)o(_m)o(ult)o
(ipl)o(e_N)e Fp(99a.)p eop
%%Page: 99 99
99 98 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)830
b Fr(exp.nw)82 b Fv(99)208 258 y(This)10 b(pro)q(cedure)i(helps)f
(optimize)f(the)h(constan)o(t)g(term)f(out)g(of)g(mo)q(dulus)f
(expressions.)2 320 y Fp(99a)89 b Fo(h)p Fn(*)15 b Fp(81)p
Fo(i)p Fv(+)p Fo(\021)1070 b Fm(/)6 b Fp(96b)22 b(100c)5
b Fm(.)187 370 y Fr(procedure)20 b(strip_const_mult)o(iple_)o(N\(x,)e
(N\))230 420 y(local)j(y)230 469 y(if)h(type\(x\))e(==)h("table")g(&)g
(x[1])g(~=)h(0)f(&)h(x[1])f(\045)g(N)h(=)g(0)f(then)g({)274
519 y(y)h(:=)f(copy\(x\))274 569 y(y[1])g(:=)g(0)274
619 y(return)g(y)230 669 y(})187 718 y(end)145 770 y
Fp(De\014nes:)187 810 y Fl(strip_cons)o(t_m)o(ul)o(tip)o(le_)o(N)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(98g.)0 893 y(99b)89
b Fo(h)p Fn(r)n(ewrite)13 b(rules)i Fp(97a)p Fo(i)o Fv(+)p
Fo(\021)852 b Fm(/)6 b Fp(98f)22 b(100b)5 b Fm(.)187
943 y Fr(Efitsu\(N,)20 b(m\))h(->)g(if)h(0)f(<=)h(N)f(<)h(2^m)f(then)g
(1)h(else)f(0)187 992 y(Efitsu\(Enarrowu\()o(x,)e(n\),)i(m\))65
b(->)21 b(if)h(n)f(<=)h(m)f(then)g(1)h(else)f(e)187 1042
y(Efitsu\(Enarrows\()o(x,)e(n\),)i(m\))65 b(->)21 b(if)h(n)f(<=)h(m)f
(then)g(1)h(else)f(e)187 1092 y(Efitsu\(Eslice\(x,)d(lo,)j(n\),)h(m\))f
(->)g(if)h(n)f(<=)h(m)f(then)g(1)h(else)f(e)187 1142
y(Efitsu\(y)f(as)h(Einstance_input\(_,)d(_,)k(_\),)f(m\))g(->)230
1192 y(if)h(known_to_fit\(inp)o(ut_fi)o(tsu,)c(y,)k(&null,)e(m\))i
(then)f(1)g(else)g(e)187 1241 y(Efitsu\(Eshift\(x,)d(n\),)j(m\))109
b(->)21 b(simfun\(Efitsu\(x,)e(m-n\)\))187 1291 y(Efitsu\(x,)h(M\))h
(->)g(if)h(M)f(>=)h(wordsize)e(then)h(1)h(else)e(e)187
1341 y(Efitss\(N,)g(m\))h(->)g(if)h(-\(2^\(m-1\)\))e(<=)h(N)h(<)f
(2^\(m-1\))f(then)h(1)h(else)f(0)187 1391 y(Efitss\(Enarrowu\()o(x,)e
(n\),)i(m\))65 b(->)21 b(if)h(n)f(<)h(m)g(then)e(1)i(else)f(e)187
1441 y(Efitss\(Enarrows\()o(x,)e(n\),)i(m\))65 b(->)21
b(if)h(n)f(<)h(m)g(then)e(1)i(else)f(e)187 1491 y(Efitss\(Eslice\(x,)d
(lo,)j(n\),)h(m\))f(->)g(if)h(n)f(<)h(m)g(then)e(1)i(else)f(e)187
1540 y(Efitss\(Ewiden\(Es)o(lice\()o(x,)e(lo,)i(n\),)g(m\),)g(mm\))h
(->)230 1590 y(if)g(n)f(=)h(m)g(<=)f(mm)g(then)g(1)230
1640 y(else)g(if)h(lo)f(>)h(0)f(then)g(simfun\(Efitss\(Ewide)o(n\(Es)o
(lice\()o(x,)e(0,)i(n+lo\),)g(m+lo\),)f(mm+lo\)\))230
1690 y(else)h(e)187 1740 y(Efitss\(y)f(as)h(Einstance_input\(_,)d(_,)k
(_\),)f(m\))g(->)230 1789 y(if)h(known_to_fit\(inp)o(ut_fi)o(tss,)c(y,)
k(&null,)e(m\))i(then)f(1)g(else)g(e)187 1839 y(Efitss\(Eshift\(x,)d
(n\),)j(m\))109 b(->)21 b(simfun\(Efitss\(x,)e(m-n\)\))187
1889 y(Efitss\(x,)h(M\))h(->)g(if)h(M)f(>=)h(wordsize)e(then)h(1)h
(else)e(e)187 1939 y(Eforce\(x)g(as)h(Eforce\(_\)\))f(->)h(x)187
1989 y(Eforce\(N\))f(->)h(N)187 2038 y(Eforceable\(N\))e(->)i(1)187
2088 y(Enot\(N\))f(->)i(if)f(N)g(=)h(0)g(then)f(1)g(else)g(0)187
2138 y(Enot\(Enot\(x\)\))e(->)i(x)145 2190 y Fp(Uses)13
b Fl(Efitss)d Fp(81,)i Fl(Efitsu)e Fp(81,)i Fl(Eforce)e
Fp(81,)i Fl(Eforceable)d Fp(81,)j Fl(Einstance)o(_in)o(put)d
Fp(81,)j Fl(Enarrows)d Fp(81,)187 2229 y Fl(Enarrowu)j
Fp(81,)j Fl(Enot)f Fp(81,)h Fl(Eshift)e Fp(81,)h Fl(Eslice)g
Fp(81,)g Fl(Ewiden)g Fp(81,)g Fl(input_fitss)e Fp(201b,)187
2269 y Fl(input_fits)o(u)d Fp(201b,)h Fl(known_to_f)o(it)e
Fp(201a,)i(and)h Fl(wordsize)e Fp(38c.)p eop
%%Page: 100 100
100 99 bop 129 141 a Fv(100)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y(See)f Fr(eliminate_instances)c
Fv(for)i(an)h(explanation)f(of)h(wh)o(y)g(the)g(transformations)f(b)q
(elo)o(w)129 307 y(are)15 b(no)e(longer)h(implemen)o(ted)e(as)i
(rewrite)h(rules.)-31 370 y Fp(100a)88 b Fo(h)p Fn(former)14
b(r)n(ewrite)f(rules)i(now)g(implemente)n(d)g(by)g Fr(eliminate_instan)
o(ces)d Fp(100a)p Fo(i)n(\021)171 420 y Fr(Einstance_tagged\()o(Einst)o
(ance\()o(c,)19 b(a\),)i(c2,)g(uid\))g(->)g(if)h(c)f(===)h(c2)f(then)g
(1)h(else)e(0)171 469 y(Einstance_input\(E)o(insta)o(nce\(c)o(,)f(a\),)
i(c2,)g(name\))g(->)g(if)h(c)f(===)h(c2)f(then)g(a[name])1173
519 y(else)g(Efail\(expimage\(e\)\))171 569 y(Einstance_tagged\()o
(Ewild)o(card\()o(_\),)e(_,)i(_\))g(->)h(1)171 619 y
(Einstance_input\(E)o(wildc)o(ard\(i)o(name\))o(,)d(c,)i(fname\))g(->)
236 669 y(Ewildcard\(iname)e(||)i(".")h(||)f(c.name)g(||)g(".")g(||)g
(fname\))171 718 y(latent_patlabel\(E)o(insta)o(nce\(_)o(,)e(_\)\))i
(->)h(vanishing_laten)o(t_pat)o(label)171 768 y(latent_patlabel\(E)o
(wildc)o(ard\(n)o(am\)\))c(->)k(patlabel\(nam,)d(nam\))129
820 y Fp(Uses)13 b Fl(Efail)e Fp(81,)g Fl(Einstance)f
Fp(81,)h Fl(Einstance_i)o(npu)o(t)f Fp(81,)h Fl(Einstance_t)o(agg)o(ed)
e Fp(81,)j Fl(expimage)d Fp(101a,)171 860 y Fl(iname)h
Fp(164b,)g Fl(latent_pat)o(lab)o(el)e Fp(55,)j Fl(patlabel)e
Fp(55,)i(and)g Fl(vanishing)o(_la)o(ten)o(t_p)o(at)o(lab)o(el)d
Fp(32a.)-33 943 y(100b)88 b Fo(h)p Fn(r)n(ewrite)14 b(rules)g
Fp(97a)p Fo(i)o Fv(+)p Fo(\021)963 b Fm(/)6 b Fp(99b)171
992 y Fr(Sstmts\(l\))20 b(->)h(case)g(*l)h(of)f({)h(0)f(:)h
(Sepsilon\(\);)d(1:)j(l[1];)e(default)h(:)g(e)h(})129
1044 y Fp(Uses)12 b Fl(Sepsilon)d Fp(81)i(and)g Fl(Sstmts)e
Fp(81.)-29 1136 y(100c)88 b Fo(h)p Fn(*)16 b Fp(81)p
Fo(i)o Fv(+)p Fo(\021)1071 b Fm(/)5 b Fp(99a)22 b(101a)5
b Fm(.)171 1185 y Fr(procedure)20 b(exactlog2\(n\))215
1235 y(local)g(log)215 1285 y(log)h(:=)g(0)215 1335 y(while)f(2^log)h
(<)h(n)f(do)h(log)f(+:=)g(1)215 1385 y(if)g(n)h(=)f(2^log)g(then)g
(return)f(log)i(else)f(fail)171 1434 y(end)129 1486 y
Fp(De\014nes:)171 1526 y Fl(exactlog2)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(98.)129 1565 y(Uses)i Fl(fail)e Fp(410.)p eop
%%Page: 101 101
101 100 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(exp.nw)82 b Fv(101)145 258 y Fj(5.5)66 b(Imaging)145
349 y Fr(expimage)11 b Fv(prin)o(ts)i(a)g(readable)g(form)e(of)h(an)h
(expression.)18 b(It)13 b(is)g(used)h(only)e(for)g(diagnostic)145
398 y(purp)q(oses;)18 b(a)e(separate)h(pro)q(cedure)h(is)e(used)h(to)e
(pro)q(duce)j(C)d(\(or)i(Mo)q(dula-3\))e(co)q(de)h(that)145
448 y(implemen)o(ts)c(an)h(expression.)-15 510 y Fp(101a)88
b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p Fo(\021)1053
b Fm(/)5 b Fp(100c)22 b(101b)5 b Fm(.)187 560 y Fr(procedure)20
b(expimage\(e,)f(pp,)i(precedence,)f(associativity\))230
610 y(local)h(leadingsign,)e(prefix)230 660 y(static)i(nopp)230
710 y(initial)g({)p Fo(h)p Fn(initialize)13 b Fr(prec)h
Fn(and)i Fr(assoc)e Fp(112a)p Fo(i)427 760 y(h)p Fn(initialize)f(nopp)j
Fp(101c)p Fo(i)o Fr(})230 809 y(/pp)22 b(:=)f(nopp)230
859 y(/precedence)f(:=)h(0)230 909 y(/associativity)e(:=)j("L")230
959 y(return)f(case)g(type\(e\))f(of)i({)274 1009 y Fo(h)p
Fn(c)n(ases)15 b(for)f Fr(expimage)g Fp(102a)p Fo(i)274
1058 y Fr(default)86 b(:)21 b(\(proc\(type\(e\))e(||)j("image"\))e(|)h
(image\)\(e\))230 1108 y(})187 1158 y(end)145 1210 y
Fp(De\014nes:)187 1249 y Fl(expimage)p Fp(,)10 b(used)h(in)i(c)o(h)o
(unks)e(26{28,)g(57,)h(68d,)f(70a,)h(77,)g(97c,)f(98a,)h(100{111,)e
(115a,)h(124,)h(127b,)228 1289 y(136{38,)f(140a,)f(142{45,)h(150a,)g
(154,)g(156b,)g(157,)g(164a,)g(177,)g(178b,)g(181a,)g(182a,)g(184a,)g
(187a,)228 1328 y(197b,)g(198a,)g(270a,)f(274,)h(275,)h(278,)f(301b,)f
(308,)h(310,)g(314,)g(316a,)g(317,)g(319,)g(320,)g(351d,)g(370d,)228
1368 y(373b,)f(377,)h(and)g(378.)208 1430 y Fr(expimage)h
Fv(can)i(optionally)e(use)i(a)g(prett)o(yprin)o(ter,)h(but)f(b)o(y)g
(default)f(it)h(uses)h(none.)-17 1492 y Fp(101b)88 b
Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p Fo(\021)1051 b
Fm(/)5 b Fp(101a)22 b(101d)5 b Fm(.)187 1542 y Fr(record)20
b(ppspec\(be,)g(en,)h(in,)g(ou,)h(nl,)f(on,)g(cn\))g(#)h({)f(})h(t)f(b)
h(m)g(o)f(c)145 1594 y Fp(De\014nes:)187 1633 y Fl(ppspec)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(101.)-13 1716 y(101c)88
b Fo(h)p Fn(initialize)14 b(nopp)i Fp(101c)p Fo(i)o(\021)928
b Fp(\(101a\))187 1766 y Fr(nopp)21 b(:=)g(ppspec\("",)f("",)h("",)g
("",)g("",)h("",)f(""\))145 1818 y Fp(Uses)12 b Fl(ppspec)e
Fp(101b.)-17 1909 y(101d)88 b Fo(h)p Fn(*)15 b Fp(81)p
Fo(i)p Fv(+)p Fo(\021)1049 b Fm(/)5 b Fp(101b)22 b(103b)5
b Fm(.)187 1959 y Fr(procedure)20 b(ppexpimage\(e\))230
2009 y(static)h(pp)230 2059 y(initial)g(pp)g(:=)g(ppspec\("${",)f
("$}",)h("$t",)f("$b",)h("$n",)g("$o",)g("$c"\))230 2109
y(return)g(expimage\(e,)e(pp\))187 2158 y(end)145 2210
y Fp(De\014nes:)187 2250 y Fl(ppexpimage)o Fp(,)9 b(used)i(in)g(c)o(h)o
(unks)f(17a,)h(75,)g(160,)g(168,)g(173a,)f(184a,)h(215,)f(218,)h(225b,)
f(233a,)h(260,)g(261,)228 2289 y(and)g(265a.)145 2329
y(Uses)h Fl(expimage)d Fp(101a)h(and)h Fl(ppspec)e Fp(101b.)p
eop
%%Page: 102 102
102 101 bop 129 141 a Fv(102)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(102a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o(\021)718 b Fp(\(101a\))22
b(102b)t Fm(.)171 307 y Fr("arm")f(:)g(pp.in)g(||)g("|)h(@")f(||)h
(e.file)e(||)i(":")f(||)g(e.line)g(||)g(":)g(")h(||)f(pp.be)g(||)345
357 y(expimage\(e.pattern,)d(pp\))j(||)h(pp.en)e(||)i(")f(=>)h(")f(||)h
(pp.cn)f(||)g(expimage\(e.code,)d(pp\))k(||)345 407 y(pp.ou)129
459 y Fp(Uses)12 b Fl(arm)f Fp(271b,)f Fl(expimage)f
Fp(101a,)h Fl(file)g Fp(359a,)g Fl(line)h Fp(359a,)f(and)h
Fl(pattern)e Fp(55.)-33 550 y(102b)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)572
b Fp(\(101a\))22 b Fm(/)5 b Fp(102a)22 b(102c)5 b Fm(.)171
600 y Fr("pattern")42 b(:)21 b(if)h(*e.disjuncts)d(>)j(0)f(then)g({)498
650 y(s)g(:=)h(commaseparate\(map)o(list)o(3\(exp)o(image)o(,)d
(e.disjuncts,)g(pp,)i(prec["|"]\),)912 700 y(")h(")f(||)g(pp.cn)g(||)h
("|)f("\))498 750 y(bracket\(s,)f(pp,)h("|",)g(precedence\))e(###)i(||)
h(\("[[")f(||)g(\\e.name)f(||)i("]]")f(|)g(""\))454 799
y(})h(else)f("<NOMATCH>")129 851 y Fp(Uses)12 b Fl(bracket)d
Fp(111b,)i Fl(expimage)d Fp(101a,)j Fl(pattern)e Fp(55,)i(and)f
Fl(prec)h Fp(111b.)-29 943 y(102c)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)568
b Fp(\(101a\))22 b Fm(/)5 b Fp(102b)22 b(103a)5 b Fm(.)171
992 y Fr("disjunct")20 b(:)h({)h(s)f(:=)h("\(")f(||)g(\(if)h(\\e.name)e
(then)h(e.name)f(else)h("?noname?"\))f(||)h("\))h(")498
1042 y(s)f(||:=)g(if)h(*\\e.conditions)d(>)i(0)h(then)650
1092 y("{")g(||)f(pp.be)g(||)g(expimage\(e.conditi)o(ons,)d(pp\))k(||)f
(pp.en)g(||)g("})g(=>)h(")f(||)650 1142 y(pp.in)g(||)h(pp.cn)607
1192 y(else)f("")498 1241 y(s)g(||:=)g(if)h(*e.sequents)d(=)j(0)f(then)
g("epsilon")650 1291 y(else)g({)694 1341 y(prefix)g(:=)g("")694
1391 y(every)g(i)g(:=)h(1)f(to)h(*e.sequents)d(do)j({)738
1441 y(s)f(||:=)g(prefix)g(||)g(expimage\(e.sequent)o(s[i],)d(pp,)j
(prec[";"]\))738 1491 y(prefix)f(:=)781 1540 y(\(if)h
(type\(e.sequents[i]\))d(==)k(\("patlabel"|"la)o(tent_)o(patla)o
(bel"\))803 1590 y(then)f(":)g(")803 1640 y(else)g(";)g("\))h(||)f
(pp.on)694 1690 y(})650 1740 y(})498 1789 y(s)g(||:=)g(if)h
(*\\e.conditions)d(>)i(0)h(then)f(pp.ou)g(else)g("")498
1839 y(bracket\(s,)f(pp,)h(";",)g(precedence\))e(###)i(||)h(\("[")f(||)
g(\\e.name)f(||)i("]")f(|)h(""\))454 1889 y(})129 1941
y Fp(Uses)14 b Fl(bracket)e Fp(111b,)g Fl(disjunct)f
Fp(55,)i Fl(epsilon)f Fp(62b,)g Fl(expimage)f Fp(101a,)i
Fl(latent_pa)o(tla)o(bel)d Fp(55,)171 1980 y Fl(patlabel)f
Fp(55,)i(and)f Fl(prec)h Fp(111b.)p eop
%%Page: 103 103
103 102 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(exp.nw)82 b Fv(103)-15 258 y Fp(103a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p Fo(i)o
Fv(+)p Fo(\021)572 b Fp(\(101a\))22 b Fm(/)5 b Fp(102c)22
b(104a)5 b Fm(.)187 307 y Fr("adisjunct")19 b(:)j({)43
b(s)22 b(:=)f("\(")g(||)h(\(if)f(\\e.name)f(then)h(e.name)g(else)g
("?noname?"\))e(||)j("\))f(")557 357 y(s)h(||:=)f(if)g
(\\e.patlabelbinding)o(s)e(then)i({)579 407 y("[")g(||)h(pp.in)e(||)i
(pp.be)f(||)g(bindingimage\(e.pa)o(tlabe)o(lbind)o(ings)o(,)e(pp\))i
(||)732 457 y(pp.en)f(||)i(pp.ou)f(||)g("])g(")h(||)f(pp.cn)535
507 y(})h(else)f("")535 557 y(s)h(||:=)f(if)g(*\\e.conditions)e(>)j(0)f
(then)666 606 y("{")g(||)h(pp.be)f(||)g(expimage\(e.condit)o(ions,)d
(pp\))j(||)h(pp.en)e(||)i("})f(=>)h(")f(||)666 656 y(pp.in)g(||)g
(pp.cn)623 706 y(else)g("")514 756 y(s)g(||:=)g("LENGTH)g(=)g(")h(||)f
(expimage\(e.length\))d(||)k(",)f(")514 806 y(s)g(||:=)g(if)h
(*e.aconstraints)c(=)k(0)f(then)g("<MATCH>")666 855 y(else)g
(commaseparate\(mapl)o(ist3\()o(expim)o(age,)d(e.aconstraints,)h(pp,)i
(prec["&"]\),)1015 905 y(")h(&)f(")h(||)f(pp.on\))514
955 y(s)g(||:=)g(if)h(*\\e.conditions)d(>)i(0)h(then)f(pp.ou)f(else)h
("")187 1005 y(###)326 b(if)21 b(*\\e.answers)f(>)i(0)f(then)g({)187
1055 y(###)370 b(l)21 b(:=)h([])187 1104 y(###)370 b(every)20
b(k)i(:=)f(key\(e.answers\))e(do)187 1154 y(###)413 b(put\(l,)21
b(k)g(||)h(")f(=)h(")g(||)f(expimage\(e.answer)o(s[k],)d(pp,)j
(prec["="]\)\))187 1204 y(###)370 b(s)21 b(||:=)g(pp.in)g(||)g(pp.on)g
(||)g("{")h(||)f(pp.in)g(||)g(pp.be)g(||)187 1254 y(###)457
b(commaseparate\(l,)18 b(",)k(")f(||)h(pp.cn\))e(||)i(pp.en)e(||)i
(pp.ou)e(||)i("}")f(||)g(pp.ou)187 1304 y(###)326 b(})514
1354 y(bracket\(s,)19 b(pp,)j("&",)f(precedence\))470
1403 y(})145 1455 y Fp(Uses)12 b Fl(adisjunct)d Fp(268,)h
Fl(bindingima)o(ge)f Fp(103b,)h Fl(bracket)f Fp(111b,)h
Fl(expimage)f Fp(101a,)h(and)h Fl(prec)f Fp(111b.)-17
1547 y(103b)88 b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p
Fo(\021)1049 b Fm(/)5 b Fp(101d)22 b(111b)5 b Fm(.)187
1596 y Fr(procedure)20 b(bindingimage\(t,)e(pp\))230
1646 y(local)j(sep,)g(id)230 1696 y(sep)h(:=)f("")230
1746 y(s)h(:=)f("")230 1796 y(every)g(id)h(:=)f(key\(t\))f(do)i({)274
1845 y(s)g(||:=)f(sep)g(||)g(pp.be)g(||)g(id)h(||)f(")h(->)f(")h(||)f
(expimage\(t[id],)e(pp\))i(||)g(pp.en)274 1895 y(sep)g(:=)h(",)f(")g
(||)h(pp.on)230 1945 y(})230 1995 y(return)f(s)187 2045
y(end)145 2097 y Fp(De\014nes:)187 2136 y Fl(bindingima)o(ge)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(103a.)145 2175 y(Uses)i
Fl(expimage)d Fp(101a.)p eop
%%Page: 104 104
104 103 bop 129 141 a Fv(104)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(104a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)568
b Fp(\(101a\))22 b Fm(/)5 b Fp(103a)23 b(104b)t Fm(.)171
307 y Fr("sequent")42 b(:)21 b({)h(s)f(:=)h(if)f(*e.constraints)e(=)j
(0)f(then)g("some)g(")h(||)f(e.class.name)607 357 y(else)g
(commaseparate\(ma)o(plist)o(3\(exp)o(image)o(,)e(e.constraints,)g(pp,)
i(prec["&"]\),)1021 407 y(")g(&)h(")g(||)f(pp.on\))498
457 y(pp.be)g(||)g(bracket\(s,)f(pp,)h("&",)g(precedence\))e(||)j
(pp.en)454 507 y(})171 557 y("patlabel")172 b(:)22 b(\\e.name)e(|)i
(e.original_name)c(||)k("#")f(||)g(image\(e\)[17:-3])e(||)607
606 y(\("@")i(||)g(\\e.offset)f(|)i(""\))f(||)g(":")171
656 y("latent_patlabel")d(:)k("\(?")f(||)g(expimage\(e.instanc)o(e,)e
(pp,)i(prec[","]\))f(||)h(":\)")171 706 y("dots_sequent")84
b(:)22 b("...")171 756 y("constraint")128 b(:)22 b(bracket\(stringini)o
(nter)o(val\(e)o(xpima)o(ge\(e.)o(field)o(,)d(pp,)i(prec["="]\),)1152
806 y(e.lo,)f(e.hi\),)h(pp,)g("=",)g(precedence\))171
855 y("fieldbinding")84 b(:)22 b({)f(s)h(:=)f(expimage\(e.field\))e(||)
i(")h(=)f(")h(||)f(expimage\(e.code,)e(pp,prec["="]\))650
905 y(bracket\(s,)h(pp,)h("=",)g(precedence\))607 955
y(})171 1005 y("field")42 b(:)22 b(e.name)171 1055 y("absolute_field")c
(:)k("{")f(||)h(expimage\(e.fiel)o(d\))d(||)i(")h(at)f(")h(||)f
(e.offset)f(||)i("}")129 1107 y Fp(Uses)17 b Fl(absolute_)o(fie)o(ld)c
Fp(268,)h Fl(bracket)g Fp(111b,)g Fl(constraint)f Fp(55,)i
Fl(constraints)d Fp(136a,)171 1146 y Fl(dots_seque)o(nt)e
Fp(62c,)i Fl(expimage)e Fp(101a,)i Fl(field)g Fp(55,)g
Fl(fieldbindi)o(ng)e Fp(55,)i Fl(latent_patl)o(abe)o(l)e
Fp(55,)171 1185 y Fl(patlabel)f Fp(55,)i Fl(prec)f Fp(111b,)g
Fl(sequent)f Fp(55,)i(and)g Fl(stringinin)o(ter)o(va)o(l)e
Fp(372b.)-33 1277 y(104b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(101a\))22
b Fm(/)5 b Fp(104a)22 b(104c)5 b Fm(.)171 1327 y Fr("binding_instance)o
(")19 b(:)j(expimage\(e.val\))c(||)k(")f(:)h(")f(||)h
(expimage\(e.type\))171 1376 y("constype")e(:)h("constructor-type)e(")i
(||)h(e.name)129 1428 y Fp(Uses)12 b Fl(binding_ins)o(tan)o(ce)c
Fp(77b,)j Fl(construct)o(or)d Fp(159,)j Fl(constype)e
Fp(159,)h(and)h Fl(expimage)e Fp(101a.)-29 1520 y(104c)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p
Fo(i)o Fv(+)p Fo(\021)568 b Fp(\(101a\))22 b Fm(/)5 b
Fp(104b)22 b(106a)5 b Fm(.)171 1569 y Fr("list")108 b(:)21
b(commaseparate\(mapli)o(st3\(e)o(xpim)o(age,)d(e,)k(pp,)f
(prec[","]\),)f(",)h(")g(||)h(pp.on\))171 1619 y("set")130
b(:)21 b(commaseparate\(mapli)o(st3\(e)o(xpim)o(age,)d(sort\(e\),)j
(pp,)g(prec[","]\),)e(",)j(")f(||)h(pp.on\))171 1669
y("eqn")130 b(:)21 b(bracket\(expimage\(e.)o(left,)d(pp,)j(prec["="]\))
f(||)h(")h(")g(||)f(e.op)g(||)g(")h(")f(||)h(pp.on)f(||)629
1719 y(expimage\(e.right)o(,)e(pp,)i(prec["="]\),)f(pp,)h("=",)g
(precedence\))171 1769 y("table")86 b(:)21 b({)480 b(#)21
b(standard)f(normal)h(form)258 1818 y Fo(h)p Fn(make)15
b Fr(s)g Fn(r)n(epr)n(esent)f(table)h Fr(e)p Fn(,)f(but)h(elide)g
(additive)g(and)h(multiplic)n(ative)d(units)i Fp(105a)p
Fo(i)258 1868 y Fr(pp.in)21 b(||)g(pp.be)g(||)g(s)h(||)f(pp.en)g(||)h
(pp.ou)215 1918 y(})171 1968 y("string")64 b(:)21 b(e)171
2018 y("literal")42 b(:)21 b(image\(e.s\))171 2068 y("integer")42
b(:)21 b(string\(e\))171 2117 y("null")108 b(:)21 b(image\(e\))129
2169 y Fp(Uses)12 b Fl(bracket)d Fp(111b,)i Fl(eqn)f
Fp(83c,)h Fl(expimage)e Fp(101a,)h Fl(literal)f Fp(45e,)i(and)f
Fl(prec)g Fp(111b.)p eop
%%Page: 105 105
105 104 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(exp.nw)82 b Fv(105)145 258 y(The)18 b(old)e(v)o(ersion)i(prin)o
(ted)f(in)g(an)o(y)g(old)f(order,)i(but)g(the)f(new)h(v)o(ersion)f
(prin)o(ts)h(p)q(ositiv)o(e)145 307 y(terms)c(\014rst,)g(then)h
(negativ)o(e)e(terms,)h(with)f(the)i(constan)o(t)f(term)f(last)h(in)f
(its)h(group.)-1880 b Fk(\031Change)14 b(#23)-15 370
y Fp(105a)88 b Fo(h)p Fn(make)16 b Fr(s)e Fn(r)n(epr)n(esent)g(table)h
Fr(e)p Fn(,)g(but)g(elide)f(additive)h(and)h(multiplic)n(ative)d(units)
i Fp(105a)p Fo(i)o(\021)88 b Fp(\(104c\))187 420 y Fr({)230
469 y(s)22 b(:=)f("";)h(leadingsign)d(:=)i("")230 519
y Fo(h)p Fn(add)16 b(p)n(ositive)f(terms)f(to)h Fr(s)f
Fp(105b)p Fo(i)230 569 y Fr(leadingsign)20 b(:=)h(")h(-)f(")h(||)f
(pp.on)230 619 y Fo(h)p Fn(add)16 b(ne)n(gative)f(terms)f(to)h
Fr(s)g Fp(105c)p Fo(i)230 669 y Fr(s)22 b(:=)f(if)h(s)f(==)h("")f(then)
g("0")g(else)g(bracket\(s,)f(pp,)h("+",)g(precedence\))187
718 y(})145 770 y Fp(Uses)12 b Fl(bracket)d Fp(111b.)-17
853 y(105b)88 b Fo(h)p Fn(add)16 b(p)n(ositive)f(terms)f(to)h
Fr(s)f Fp(105b)p Fo(i)o(\021)766 b Fp(\(105a\))187 903
y Fr(every)21 b(e[k)g(:=)g(1)h(~===)f(key\(e\)])f(>)i(0)f(do)h({)274
953 y(s)g(||:=)f(leadingsign)274 1003 y(s)h(||:=)f(\(1)g(~=)g
(abs\(e[k]\)\))f(||)h("*")87 b(#)22 b(print)e(coefficient)g(if)h(not)g
(1)274 1053 y(s)h(||:=)f(expimage\(k,)e(pp,)i(prec["+"]\))274
1102 y(leadingsign)e(:=)j(")f(+)h(")g(||)f(pp.on)187
1152 y(})187 1202 y(if)g(e[1])g(>)h(0)f(then)g(s)h(||:=)f(leadingsign)e
(||)j(string\(e[1]\))145 1254 y Fp(Uses)12 b Fl(expimage)d
Fp(101a)h(and)h Fl(prec)f Fp(111b.)-13 1345 y(105c)88
b Fo(h)p Fn(add)16 b(ne)n(gative)f(terms)f(to)h Fr(s)g
Fp(105c)p Fo(i)o(\021)759 b Fp(\(105a\))187 1395 y Fr(every)21
b(e[k)g(:=)g(1)h(~===)f(key\(e\)])f(<)i(0)f(do)h({)274
1445 y(s)g(||:=)f(leadingsign)274 1495 y(s)h(||:=)f(\(1)g(~=)g
(abs\(e[k]\)\))f(||)h("*")87 b(#)22 b(print)e(coefficient)g(if)h(not)g
(1)274 1544 y(s)h(||:=)f(expimage\(k,)e(pp,)i(prec["+"]\))187
1594 y(})187 1644 y(if)g(e[1])g(<)h(0)f(then)g(s)h(||:=)f(leadingsign)e
(||)j(string\(-e[1]\))145 1696 y Fp(Uses)12 b Fl(expimage)d
Fp(101a)h(and)h Fl(prec)f Fp(111b.)-17 1787 y(105d)88
b Fo(h)p Fn(old)15 b(make)h Fr(s)e Fn(r)n(epr)n(esent)g(table)h
Fr(e)p Fn(,)f(but)h(elide)g(additive)g(and)h(multiplic)n(ative)d(units)
i Fp(105d)p Fo(i)o(\021)187 1837 y Fr({)230 1887 y(#)22
b(print)f(constant)f(term)h(if)g(nonzero)230 1937 y(if)h(e[1])f(~=)g(0)
h(then)f({)g(s)h(:=)f(string\(e[1]\))f(;)h(leadingsign)f(:=)h(")h(+)f
(")h(||)f(pp.on)g(})230 1987 y(else)g(s)h(:=)f(leadingsign)f(:=)h("")
230 2036 y(#)h(print)f(every)f(nonconstant)g(term)h(k)230
2086 y(every)g(k)h(:=)f(1)h(~===)f(key\(e\))f(do)i({)318
2136 y(s)f(||:=)g(if)g(e[k])g(<)h(0)g(then)f(")g(-)h(")f(else)g
(leadingsign)318 2186 y(leadingsign)e(:=)i(")h(+)g(")f(||)h(pp.on)318
2236 y(s)f(||:=)g(\(1)g(~=)h(abs\(e[k]\)\))e(||)h("*")87
b(#)21 b(print)g(coefficient)e(if)j(not)f(1)318 2285
y(s)g(||:=)g(expimage\(k,)f(pp,)h(prec["+"]\))230 2335
y(})230 2385 y(s)h(:=)f(if)h(s)f(==)h("")f(then)g("0")g(else)g
(bracket\(s,)f(pp,)h("+",)g(precedence\))187 2435 y(})145
2487 y Fp(Uses)12 b Fl(bracket)d Fp(111b,)h Fl(constant)f
Fp(114b,)h Fl(expimage)f Fp(101a,)h(and)h Fl(prec)f Fp(111b.)p
eop
%%Page: 106 106
106 105 bop 129 141 a Fv(106)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(106a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)570
b Fp(\(101a\))22 b Fm(/)5 b Fp(104c)23 b(106b)t Fm(.)171
307 y Fr("Eorb")108 b(:)21 b({)h(s)f(:=)h(expimage\(e.x,)d(pp,)i
(prec["Eorb"],)e("L"\))498 357 y(t)i(:=)h(expimage\(e.y,)d(pp,)i
(prec["Eorb"],)e("R"\))498 407 y(bracket\(s)h(||)h(")h(ORB)f(")h(||)f
(pp.on)g(||)g(t,)g(pp,)h("Eorb",)e(precedence\))454 457
y(})171 507 y("Eand")108 b(:)21 b({)h(s)f(:=)h(expimage\(e.x,)d(pp,)i
(prec["Eand"],)e("L"\))498 557 y(t)i(:=)h(expimage\(e.y,)d(pp,)i
(prec["Eand"],)e("R"\))498 606 y(bracket\(s)h(||)h(")h(AND)f(")h(||)f
(t,)g(pp,)g("Eand",)g(precedence\))454 656 y(})129 706
y Fp(Uses)12 b Fl(bracket)d Fp(111b,)i Fl(Eand)f Fp(81,)h
Fl(Eorb)f Fp(81,)h Fl(expimage)e Fp(101a,)h(and)h Fl(prec)f
Fp(111b.)-33 789 y(106b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(101a\))22
b Fm(/)5 b Fp(106a)22 b(106c)5 b Fm(.)171 839 y Fr("Eslice")64
b(:)21 b({)h(s)f(:=)h(expimage\(e.x,)d(pp,)i(prec["Eslice"]\))498
889 y(s)g(||:=)g("[")h(||)f(e.lo)g(||)g(":")g(||)h(\(e.lo)f(+)g(e.n)g
(-)h(1\))f(||)h("]")498 938 y(bracket\(s,)e(pp,)h("Eslice",)f
(precedence\))454 988 y(})171 1038 y("Eshift")64 b(:)21
b({)h(s)f(:=)h(expimage\(e.x,)d(pp,)i(prec["Eshift"]\))498
1088 y(s)g(||:=)g(if)h(e.n)f(<)h(0)f(then)g(\(")g(>>)h(")f(||)h(-e.n\))
f(else)g(\(")g(<<)g(")h(||)f(e.n\))498 1138 y(bracket\(s,)f(pp,)h
("Eshift",)f(precedence\))454 1187 y(})129 1237 y Fp(Uses)12
b Fl(bracket)d Fp(111b,)i Fl(Eshift)e Fp(81,)i Fl(Eslice)f
Fp(81,)g Fl(expimage)f Fp(101a,)h(and)h Fl(prec)f Fp(111b.)-29
1320 y(106c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f
Fp(102a)p Fo(i)o Fv(+)p Fo(\021)566 b Fp(\(101a\))22
b Fm(/)5 b Fp(106b)23 b(106d)t Fm(.)171 1370 y Fr("Enarrowu")d(:)h({)h
(s)f(:=)h(expimage\(e.x,)d(pp,)i(prec["Enarrowu"]\))498
1420 y(s)g(||:=)g("[")h(||)f(e.n)g(||)h("]")498 1470
y(bracket\(s,)e(pp,)h("Enarrowu",)e(precedence\))454
1520 y(})171 1569 y("Enarrows")h(:)h({)h(s)f(:=)h(expimage\(e.x,)d(pp,)
i(prec["Enarrows"]\))498 1619 y(s)g(||:=)g("[")h(||)f(e.n)g(||)h("!]")
498 1669 y(bracket\(s,)e(pp,)h("Enarrows",)e(precedence\))454
1719 y(})171 1769 y("Ewiden")64 b(:)21 b({)h(s)f(:=)h(expimage\(e.x,)d
(pp,)i(prec["Ewiden"]\))498 1818 y(s)g(||:=)g("!")h(||)f(e.n)498
1868 y(bracket\(s,)f(pp,)h("Ewiden",)f(precedence\))454
1918 y(})129 1968 y Fp(Uses)12 b Fl(bracket)d Fp(111b,)i
Fl(Enarrows)d Fp(81,)j Fl(Enarrowu)e Fp(81,)i Fl(Ewiden)f
Fp(81,)g Fl(expimage)f Fp(101a,)i(and)f Fl(prec)g Fp(111b.)-33
2051 y(106d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f
Fp(102a)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(101a\))22
b Fm(/)5 b Fp(106c)22 b(107a)5 b Fm(.)171 2101 y Fr("Ediv")108
b(:)21 b({)h(s)f(:=)h(expimage\(e.x,)d(pp,)i(prec["Ediv"]\))498
2151 y(s)g(||:=)g(")h(DIV)f(")h(||)f(e.n)498 2200 y(bracket\(s,)f(pp,)h
("Ediv",)f(precedence\))454 2250 y(})171 2300 y("Emod")108
b(:)21 b({)h(s)f(:=)h(expimage\(e.x,)d(pp,)i(prec["Emod"]\))498
2350 y(s)g(||:=)g(")h(MOD)f(")h(||)f(e.n)498 2400 y(bracket\(s,)f(pp,)h
("Emod",)f(precedence\))454 2449 y(})129 2499 y Fp(Uses)12
b Fl(bracket)d Fp(111b,)i Fl(Ediv)f Fp(81,)h Fl(Emod)f
Fp(81,)h Fl(expimage)e Fp(101a,)h(and)h Fl(prec)f Fp(111b.)p
eop
%%Page: 107 107
107 106 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(exp.nw)82 b Fv(107)-15 258 y Fp(107a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p Fo(i)o
Fv(+)p Fo(\021)566 b Fp(\(101a\))22 b Fm(/)5 b Fp(106d)22
b(107b)5 b Fm(.)187 307 y Fr("Semit")86 b(:)21 b(commaseparate\(mapl)o
(ist3\()o(expim)o(age,)d(e.x,)j(pp,)g(prec[","]\),)f(";")h(||)g
(pp.cn\))187 357 y("Stoken")64 b(:)21 b({)h(s)f(:=)h("EMIT@")e(||)h
(e.offset)g(||)g("\(")g(||)g(pp.in)g(||)623 407 y(expimage\(e.x,)e(pp,)
i(prec[","]\))f(||)h(",)g(")h(||)623 457 y(pp.on)e(||)i(e.n)f(||)g
("\)")h(||)f(pp.ou)514 507 y(bracket\(pp.cn)e(||)i(s,)h(pp,)f("app",)f
(precedence\))470 557 y(})145 608 y Fp(Uses)12 b Fl(bracket)d
Fp(111b,)h Fl(expimage)f Fp(101a,)h Fl(prec)h Fp(111b,)f
Fl(Semit)g Fp(81,)h(and)f Fl(Stoken)g Fp(81.)-17 700
y(107b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f
Fp(102a)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(101a\))22
b Fm(/)5 b Fp(107a)22 b(107c)5 b Fm(.)187 750 y Fr("Efitsu")64
b(:)21 b({)h(s)f(:=)h("FITSU\(")e(||)h(expimage\(e.x,)e(pp,)i
(prec[","]\))f(||)i(",)f(")h(||)f(pp.on)g(||)g(e.n||"\)")514
799 y(bracket\(s,)e(pp,)j("app",)e(precedence\))470 849
y(})187 899 y("Efitss")64 b(:)21 b({)h(s)f(:=)h("FITSS\(")e(||)h
(expimage\(e.x,)e(pp,)i(prec[","]\))f(||)i(",)f(")h(||)f(pp.on)g(||e.n)
f(||"\)")514 949 y(bracket\(s,)f(pp,)j("app",)e(precedence\))470
999 y(})145 1051 y Fp(Uses)12 b Fl(bracket)d Fp(111b,)h
Fl(Efitss)g Fp(81,)h Fl(Efitsu)e Fp(81,)i Fl(expimage)e
Fp(101a,)h(and)h Fl(prec)f Fp(111b.)-13 1142 y(107c)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p
Fo(i)o Fv(+)p Fo(\021)566 b Fp(\(101a\))22 b Fm(/)5 b
Fp(107b)22 b(107d)5 b Fm(.)187 1192 y Fr("Epatlabel")19
b(:)j("LOCATION_OF\(")d(||)i(expimage\(e.l,)e(pp,)i(prec[","]\))f(||)i
("\)")145 1244 y Fp(Uses)12 b Fl(Epatlabel)d Fp(81,)h
Fl(expimage)f Fp(101a,)h(and)h Fl(prec)f Fp(111b.)-17
1335 y(107d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f
Fp(102a)p Fo(i)o Fv(+)p Fo(\021)574 b Fp(\(101a\))22
b Fm(/)5 b Fp(107c)22 b(107e)5 b Fm(.)187 1385 y Fr("Eforce")64
b(:)21 b({)h(s)f(:=)h("FORCE\(")e(||)h(expimage\(e.x,)e(pp,)i
(prec[","]\))f(||)i("\)")514 1434 y(bracket\(s,)d(pp,)j("app",)e
(precedence\))470 1484 y(})187 1534 y("Eforceable":{)f(s)i(:=)h
("FORCEABLE\(")d(||)i(expimage\(e.x,)e(pp,)j(prec[","]\))d(||)j("\)")
514 1584 y(bracket\(s,)d(pp,)j("app",)e(precedence\))470
1634 y(})145 1686 y Fp(Uses)12 b Fl(bracket)d Fp(111b,)h
Fl(Eforce)g Fp(81,)h Fl(Eforceable)d Fp(81,)j Fl(expimage)e
Fp(101a,)h(and)g Fl(prec)h Fp(111b.)-13 1777 y(107e)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p
Fo(i)o Fv(+)p Fo(\021)575 b Fp(\(101a\))22 b Fm(/)5 b
Fp(107d)22 b(107f)5 b Fm(.)187 1827 y Fr("Epc")151 b(:)22
b("FORCE\(<program)d(counter>\)")187 1877 y("Epc_known")g(:")j
(FORCEABLE\(<progr)o(am)d(counter>\)")145 1928 y Fp(Uses)12
b Fl(Epc)f Fp(81)g(and)f Fl(Epc_known)f Fp(81.)-8 2020
y(107f)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f
Fp(102a)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(101a\))22
b Fm(/)5 b Fp(107e)22 b(107g)5 b Fm(.)187 2070 y Fr("Enot")129
b(:)22 b({)f(s)h(:=)f("NOT)g(")h(||)f(expimage\(e.x,)e(pp,)j
(prec["NOT"]\))535 2119 y(bracket\(s,)e(pp,)h("NOT",)g(precedence\))492
2169 y(})145 2221 y Fp(Uses)12 b Fl(bracket)d Fp(111b,)h
Fl(Enot)h Fp(81,)g Fl(expimage)d Fp(101a,)j(and)f Fl(prec)h
Fp(111b.)-15 2312 y(107g)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)577 b Fp(\(101a\))22
b Fm(/)5 b Fp(107f)22 b(108a)5 b Fm(.)187 2362 y Fr("Enosimp")63
b(:)22 b(expimage\(e.x,)d(pp,)i(precedence,)f(associativity\))145
2414 y Fp(Uses)12 b Fl(Enosimp)d Fp(81)i(and)g Fl(expimage)e
Fp(101a.)p eop
%%Page: 108 108
108 107 bop 129 141 a Fv(108)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(108a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)568
b Fp(\(101a\))22 b Fm(/)5 b Fp(107g)23 b(108b)t Fm(.)171
307 y Fr("Sstmts")85 b(:)22 b(pp.in)f(||)g(pp.be)g(||)g("{)h(")f(||)h
(pp.cn)e(||)476 357 y(commaseparate\(mapl)o(ist3\()o(expi)o(mage,)e
(e.x,)j(pp\),)g(";)h(")f(||)h(pp.cn\))e(||)476 407 y(pp.ou)h(||)g
(pp.cn)g(||)g(")h(}")f(||)h(pp.en)129 459 y Fp(Uses)12
b Fl(expimage)d Fp(101a)h(and)h Fl(Sstmts)f Fp(81.)-33
550 y(108b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f
Fp(102a)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(101a\))22
b Fm(/)5 b Fp(108a)22 b(108c)5 b Fm(.)171 600 y Fr("Einstance")19
b(:)j({)g(l)f(:=)h([];)520 650 y(every)e(i)i(:=)f(inputs_of\(e.cons\))e
(do)563 700 y(put\(l,)i(expimage\(e.argt[)o(i.nam)o(e],)e(pp\)\))520
750 y(s)i(:=)h(e.cons.name)d(||)j("\(")f(||)g(commaseparate\(l,)e(",)i
(")h(||)f(pp.on\))f(||)i("\)")520 799 y(bracket\(s,)d(pp,)j("app",)e
(precedence\))476 849 y(})171 899 y("Einstance_input")e(:)k({)498
949 y(s)f(:=)h(expimage\(e.x,)d(pp,)i(prec["."]\))f(||)h(".")g(||)h
(e.cons.name)d(||)j(".")f(||)g(e.name)498 999 y(bracket\(s,)f(pp,)h
(".",)g(precedence\))454 1048 y(})171 1098 y("Einstance_tagged)o(")e(:)
j({)498 1148 y(s)f(:=)h(expimage\(e.x,)d(pp,)i(prec["="]\))f(||)h(")h
(IS)f(")h(||)f(e.cons.name)498 1198 y(bracket\(s,)f(pp,)h("=",)g
(precedence\))454 1248 y(})171 1297 y("Ebinding_instanc)o(e")e(:)i
(e.name)g(||)g(")h(:)g(")f(||)g(e.type.name)129 1349
y Fp(Uses)16 b Fl(bracket)c Fp(111b,)i Fl(Ebinding_i)o(nst)o(an)o(ce)e
Fp(81,)i Fl(Einstance)e Fp(81,)j Fl(Einstance)o(_in)o(put)c
Fp(81,)171 1389 y Fl(Einstance_)o(tag)o(ged)d Fp(81,)j
Fl(expimage)e Fp(101a,)h Fl(inputs_of)e Fp(166a,)j(and)f
Fl(prec)g Fp(111b.)-29 1480 y(108c)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)568
b Fp(\(101a\))22 b Fm(/)5 b Fp(108b)22 b(109a)5 b Fm(.)171
1530 y Fr("Sif")130 b(:)21 b({)h(s)f(:=)h(pp.cn)f(||)g("if")498
1580 y(every)g(s)g(||:=)541 1630 y(pp.cn)g(||)h("::)f(")g(||)h(pp.in)e
(||)i(expimage\(!e.arms,)c(pp,)j(prec["low"]\))f(||)h(pp.ou)498
1679 y(bracket\(s)f(||)h(")h(")f(||)h(pp.cn)e(||)i("fi",)f(pp,)g
("app",)f(precedence\))454 1729 y(})171 1779 y("Sguarded")g(:)h({)h(s)f
(:=)h(expimage\(e.guard,)c(pp,)j(prec["Sguarded"]\))e(||)i(")h(->)f(")g
(||)607 1829 y(pp.in)g(||)g(pp.be)g(||)g(pp.cn)g(||)607
1879 y(expimage\(e.x,)106 b(pp,)21 b(prec["Sguarded"]\))e(||)607
1928 y(pp.en)i(||)g(pp.ou)498 1978 y(bracket\(s,)f(pp,)h("Sguarded",)e
(precedence\))454 2028 y(})129 2080 y Fp(Uses)12 b Fl(bracket)d
Fp(111b,)i Fl(expimage)d Fp(101a,)j Fl(prec)f Fp(111b,)g
Fl(Sguarded)f Fp(81,)i(and)f Fl(Sif)h Fp(81.)p eop
%%Page: 109 109
109 108 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(exp.nw)82 b Fv(109)-15 258 y Fp(109a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p Fo(i)o
Fv(+)p Fo(\021)570 b Fp(\(101a\))22 b Fm(/)5 b Fp(108c)22
b(109b)5 b Fm(.)187 307 y Fr("Stagcase")20 b(:)h({)h(s)f(:=)h("CASE)e
(")i(||)f(expimage\(e.x,)e(pp\))j(||)f(")h(OF)f(")492
357 y(every)g(c)g(:=)h(kept_constructor)o(s\(e.)o(type\))c(do)535
407 y(s)k(||:=)f(pp.nl)g(||)g("|)h(")f(||)h(c.name)e(||)h(")h(=>)f(")h
(||)f(pp.in)g(||)h(pp.in)e(||)i(pp.be)e(||)753 457 y(pp.cn)h(||)h
(expimage\(e.arms)o([c],)c(pp\))k(||)f(pp.en)g(||)g(pp.ou)g(||)g(pp.ou)
492 507 y(pp.be)g(||)g(pp.cn)g(||)g(s)h(||)f(pp.nl)g(||)g("END)g(\(*)h
(")f(||)h(expimage\(e.x,)d(pp\))i(||)579 557 y(")h(*\)")f(||)g(pp.en)g
(||)g(pp.on)448 606 y(})145 658 y Fp(Uses)12 b Fl(expimage)d
Fp(101a,)h Fl(kept_const)o(ruc)o(tor)o(s)f Fp(33d,)h(and)h
Fl(Stagcase)e Fp(183a.)-17 750 y(109b)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)572
b Fp(\(101a\))22 b Fm(/)5 b Fp(109a)22 b(109c)5 b Fm(.)187
799 y Fr("Sfail")86 b(:)21 b({)h(s)f(:=)h("FAIL\(")e(||)h(image\(if)g
(*pp.nl)f(>)i(0)f(then)g(escape_dollars\(e.f)o(mt\))e(else)i(e.fmt\))
514 849 y(every)f(a)i(:=)f(e.a1)g(|)h(e.a2)f(|)h(e.a3)e(do)557
899 y(s)i(||:=)f(",)g(")h(||)f(pp.on)g(||)g(expimage\(\\a,)f(pp,)h
(prec[","]\))514 949 y(s)g(:=)h(pp.in)e(||)i(pp.be)f(||)g(s)h(||)f
("\)")g(||)g(pp.en)g(||)h(pp.ou)514 999 y(bracket\(s,)d(pp,)j("app",)e
(precedence\))470 1048 y(})187 1098 y("Sepsilon")g(:)h("/*)g(skip)g
(*/")145 1150 y Fp(Uses)14 b Fl(bracket)e Fp(111b,)h
Fl(escape_do)o(lla)o(rs)e Fp(112b,)h Fl(expimage)g Fp(101a,)g
Fl(prec)h Fp(111b,)g Fl(Sepsilon)e Fp(81,)187 1190 y(and)f
Fl(Sfail)g Fp(188c.)-13 1281 y(109c)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)566
b Fp(\(101a\))22 b Fm(/)5 b Fp(109b)22 b(109d)5 b Fm(.)187
1331 y Fr("Efail")86 b(:)21 b("[BAD)g(EXP:)g(")g(||)h(e.msg)f(||)g("]")
145 1383 y Fp(Uses)12 b Fl(Efail)e Fp(81.)-17 1474 y(109d)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p
Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(101a\))22 b Fm(/)5 b
Fp(109c)22 b(110a)5 b Fm(.)187 1524 y Fr("Glines")85
b(:)22 b(commaseparate\(map)o(list2)o(\(expi)o(mage)o(,)d(e.x,)i(pp\),)
g("\\n"\))187 1574 y("Gresynch")41 b(:)22 b("#line)e(")i(||)f(e.line)43
b(||)21 b(")h(")f(||)h(image\(\\e.file)d(|)i("generated-code"\))187
1623 y("Gblock")85 b(:)22 b({)f(s)h(:=)f("{)h(")f(||)h(pp.be)f(||)g
(pp.in)g(||)g(pp.cn)535 1673 y(every)g(s)h(||:=)f(expimage\(!e.decl)o
(s,)e(pp\))i(||)g(";)h(")f(||)h(pp.nl)535 1723 y(every)f(s)h(||:=)f
(expimage\(!e.stmt)o(s,)e(pp\))i(||)g(";)h(")f(||)h(pp.cn)535
1773 y(s)g(||)f(pp.ou)g(||)h(pp.cn)e(||)i("}")f(||)g(pp.en)492
1823 y(})187 1872 y("Gdecl")107 b(:)22 b({)f(s)h(:=)f(pp.be)g(||)h
(expimage\(e.type)o(,)d(pp\))i(||)h(")f(")h(||)f(e.name)535
1922 y(s)h(||:=)f(")h(=)f(")h(||)f(pp.in)g(||)g(pp.cn)g(||)g
(expimage\(\\e.init,)e(pp\))i(||)g(pp.ou)535 1972 y(s)h(||)f(pp.en)492
2022 y(})145 2074 y Fp(Uses)13 b Fl(expimage)e Fp(101a,)g
Fl(file)h Fp(359a,)f Fl(Gblock)g Fp(293a,)h Fl(Gdecl)f
Fp(293a,)h Fl(Glines)f Fp(293a,)g Fl(Gresynch)f Fp(293a,)187
2113 y(and)g Fl(line)h Fp(359a.)p eop
%%Page: 110 110
110 109 bop 129 141 a Fv(110)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(110a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expimage)f Fp(102a)p Fo(i)o Fv(+)p Fo(\021)566
b Fp(\(101a\))22 b Fm(/)5 b Fp(109d)23 b(110b)t Fm(.)171
307 y Fr("Gcase")107 b(:)22 b({)g(s)f(:=)h("CASE)e(")i(||)f
(expimage\(e.x,)e(pp\))j(||)f(")h(OF)f(")520 357 y(every)f(s)i(||:=)f
(expimage\(!e.arms,)d(pp\))520 407 y(pp.be)i(||)i(pp.cn)f(||)g(s)h(||)f
(pp.nl)g(||)g("END)g(\(*)g(CASE)g(")h(||)f(expimage\(e.x,)e(pp\))j(||)
563 457 y(")g(*\)")f(||)g(pp.en)g(||)h(pp.on)498 507
y(})171 557 y("Gcasearm")41 b(:)22 b({)g(s)f(:=)h(pp.nl)e(||)i("|)f(")h
(||)f(pp.in)520 606 y(every)f(i)i(:=)f(1)h(to)f(*e.tags)g(by)g(2)h(do)f
({)563 656 y(if)h(i)f(>)h(1)f(then)g(s)h(||:=)f(",)g(")h(||)f(pp.on)563
706 y(s)h(||:=)f(if)g(e.tags[i])f(+)i(1)f(=)h(e.tags[i+1])d(then)i
(e.tags[i])716 756 y(else)g(e.tags[i])f(||)h("..")g(||)g
(\(e.tags[i+1]-1\))520 806 y(})520 855 y(s)g(||:=)g(")h(=>)f(")44
b(||)21 b(pp.in)g(||)g(pp.cn)g(||)g(expimage\(e.x,)e(pp\))520
905 y(pp.be)h(||)i(s)f(||)h(pp.ou)f(||)g(pp.ou)g(||)g(pp.en)476
955 y(})171 1005 y("Ginrange")41 b(:)22 b(bracket\(pp.in)d(||)j(e.lo)f
(||)g(")g(<=)h(")f(||)h(pp.on)f(||)716 1055 y(expimage\(e.x,)e(pp,)i
(prec["<="]\))f(||)h(")h(<)f(")h(||)f(e.hi,)650 1104
y(pp,)h("<",)f(precedence\))171 1154 y("Gcomment")41
b(:)22 b("\(*)f(COMMENT)g(:)g(")h(||)f(e.s)g(||)h(")f(*\)")171
1204 y("Gcommented")e(:)j(expimage\(e.e,)d(pp\))129 1256
y Fp(Uses)d Fl(bracket)d Fp(111b,)h Fl(expimage)f Fp(101a,)h
Fl(Gcase)g Fp(294a,)g Fl(Gcasearm)f Fp(294a,)h Fl(Gcomment)f
Fp(20,)171 1295 y Fl(Gcommented)8 b Fp(299a,)i Fl(Ginrange)f
Fp(294a,)h(and)h Fl(prec)f Fp(111b.)-33 1387 y(110b)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p
Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(101a\))22 b Fm(/)5 b
Fp(110a)22 b(110c)5 b Fm(.)171 1437 y Fr("Gasgn")107
b(:)22 b(bracket\(e.lhs)d(||)j(")f(:=)h(")f(||)g(expimage\(e.x,)f(pp,)h
(prec[":="]\),)650 1486 y(pp,)h(":=",)e(precedence\))171
1536 y("Gsetname")41 b(:)22 b(e.lhs)f(||)g(")h(:=)f(")h(||)f
(image\(e.name\))171 1586 y("Gnomatch")41 b(:)22 b("<NO)f(MATCH>")171
1636 y("Tunsigned")e(:)j({)g(s)f(:=)h("unsigned")520
1686 y(s)f(||:=)g(")h(/*)f(")h(||)f(\\e.width)f(||)i(")f(bits)g(*/")520
1735 y(s)476 1785 y(})129 1837 y Fp(Uses)13 b Fl(bracket)c
Fp(111b,)i Fl(expimage)e Fp(101a,)i Fl(Gasgn)f Fp(294a,)h
Fl(Gnomatch)e Fp(294a,)i Fl(Gsetname)e Fp(294a,)i Fl(prec)g
Fp(111b,)171 1877 y(and)g Fl(Tunsigned)d Fp(294a.)-29
1968 y(110c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expimage)f
Fp(102a)p Fo(i)o Fv(+)p Fo(\021)568 b Fp(\(101a\))22
b Fm(/)5 b Fp(110b)22 b(111a)5 b Fm(.)171 2018 y Fr("Eapp")21
b(:)g(image\(e.f\))f(||)h("\(")g(||)h(pp.in)f(||)g(expimage\(e.args,)d
(pp,)k(prec[","]\))d(||)j(pp.ou)e(||)i("\)")129 2070
y Fp(Uses)12 b Fl(Eapp)e Fp(81,)h Fl(expimage)e Fp(101a,)h(and)h
Fl(prec)f Fp(111b.)p eop
%%Page: 111 111
111 110 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(exp.nw)82 b Fv(111)-15 258 y Fp(111a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(expimage)f Fp(102a)p Fo(i)o
Fv(+)p Fo(\021)690 b Fp(\(101a\))21 b Fm(/)6 b Fp(110c)187
307 y Fr("Eclosure")20 b(:)h("CLOSURE\(")f(||)h(pp.in)g(||)g(pp.be)g
(||)g(pp.cn)g(||)514 357 y("type)f(=)i(")g(||)f(e.ty)g(||)g(",)h(")f
(||)h(pp.cn)e(||)514 407 y("fun)h(=)g(")h(||)43 b(e.fun)21
b(||)g(",)h(")f(||)g(pp.cn)g(||)514 457 y("header)f(=)i(")f(||)43
b(e.headertype)20 b(||)h(",)g(")h(||)f(pp.cn)g(||)514
507 y("values)f(=)i({")f(||)g(expimage\(e.values\))d(||)k("},)f(")h(||)
f(pp.cn)g(||)514 557 y("addresses)e(=)j({")f(||)h(expimage\(e.addre)o
(sses\))c(||)k("}")f(||)g(pp.en)g(||)g(pp.ou)g(||)g("\)")187
606 y("Elambda")f(:)h(pp.be)g(||)g("\(FN)g(")h(||)f
(commaseparate\(e.for)o(mals\))d(||)k(")f(=>)h(")f(||)h(pp.in)e(||)i
(pp.on)e(||)514 656 y(expimage\(e.body,)e(pp,)j(prec[","]\))f(||)h
("\)")h(||)f(pp.ou)g(||)g(pp.en)187 706 y("Eclosure_loc")40
b(:)22 b("CL->loc")187 756 y("Eclosure_addr")c(:)k("CL->a")e(||)i(e.n)
187 806 y("Eclosure_val")40 b(:)22 b("CL->v")e(||)i(e.n)145
857 y Fp(Uses)13 b Fl(Eclosure)d Fp(218,)i Fl(Eclosure_)o(add)o(r)e
Fp(81,)i Fl(Eclosure_l)o(oc)d Fp(81,)j Fl(Eclosure_va)o(l)e
Fp(81,)i Fl(Elambda)e Fp(217,)187 897 y Fl(expimage)f
Fp(101a,)h(and)g Fl(prec)h Fp(111b.)-17 988 y(111b)88
b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p Fo(\021)1049
b Fm(/)5 b Fp(103b)22 b(112b)5 b Fm(.)187 1038 y Fr(global)20
b(prec,)h(assoc)187 1088 y(procedure)f(bracket\(s,)f(pp,)j(op,)f(p,)g
(a\))230 1138 y(/a)h(:=)f("L")230 1187 y(return)g(pp.be)g(||)g(\(if)g
(prec[op])f(>)i(p)g(|)f(\(prec[op])f(=)i(p)f(&)h(assoc[p])e(==)h(a\))h
(then)f(s)601 1237 y(else)g("\(")g(||)g(s)h(||)f("\)"\))g(||)h(pp.en)
187 1287 y(end)145 1339 y Fp(De\014nes:)187 1378 y Fl(assoc)p
Fp(,)10 b(used)g(in)h(c)o(h)o(unk)f(112a.)187 1418 y
Fl(bracket)p Fp(,)f(used)h(in)i(c)o(h)o(unks)d(102{110.)187
1457 y Fl(prec)p Fp(,)h(used)g(in)i(c)o(h)o(unks)d(102{112.)p
eop
%%Page: 112 112
112 111 bop 129 141 a Fv(112)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(112a)88 b Fo(h)p Fn(initialize)14
b Fr(prec)g Fn(and)i Fr(assoc)e Fp(112a)p Fo(i)o(\021)722
b Fp(\(101a\))171 307 y Fr(ops)21 b(:=)h(["N",)e(["low"],)345
357 y("L",)h(["|",)g("pattern"],)345 407 y("L",)g([";"],)345
457 y("L",)g(["&",)g("sequent",)f("patlabel"],)345 507
y("R",)h([":="],)345 557 y("L",)g([","],)345 606 y("N",)g
(["Sguarded"],)345 656 y("N",)g(["="],)345 706 y("L",)g(["ORB",)g
("Eorb"],)345 756 y("L",)g(["AND",)g("Eand"],)345 806
y("L",)g(["<",)g("<="],)345 855 y("L",)g(["+"],)345 905
y("N",)g(["Emod",)f("Ediv",)h("*"],)345 955 y("N",)g(["Eshift"],)345
1005 y("N",)g(["NOT"],)345 1055 y("L",)g(["Eslice",)f("Enarrowu",)g
("Enarrows",)f("Ewiden",)h("."],)345 1104 y("N",)h(["app"],)238
b(#)22 b(function)e(application)345 1154 y("N",)h(["high"])324
1204 y(])171 1254 y(prec)g(:=)g(table\([]\))42 b(#)22
b(missed)e(lookups)h(break)f(arithmetic)g(comparisons)171
1304 y(assoc)h(:=)g(table\(\))171 1354 y(every)g(i)g(:=)h(1)f(to)h
(*ops)f(by)g(2)h(do)f({)215 1403 y(every)f(prec[!ops[i+1]])f(:=)i(i)215
1453 y(assoc[i])f(:=)h(ops[i])171 1503 y(})129 1555 y
Fp(Uses)12 b Fl(assoc)f Fp(111b,)f Fl(Eand)h Fp(81,)g
Fl(Ediv)f Fp(81,)h Fl(Emod)g Fp(81,)g Fl(Enarrows)e Fp(81,)i
Fl(Enarrowu)f Fp(81,)h Fl(Eorb)f Fp(81,)h Fl(Eshift)f
Fp(81,)171 1594 y Fl(Eslice)g Fp(81,)g Fl(Ewiden)g Fp(81,)h
Fl(patlabel)e Fp(55,)i Fl(pattern)e Fp(55,)i Fl(prec)f
Fp(111b,)g Fl(sequent)f Fp(55,)i(and)g Fl(Sguarded)e
Fp(81.)-33 1686 y(112b)88 b Fo(h)p Fn(*)16 b Fp(81)p
Fo(i)o Fv(+)p Fo(\021)1051 b Fm(/)5 b Fp(111b)22 b(113a)5
b Fm(.)171 1735 y Fr(procedure)20 b(escape_dollars\(s\))215
1785 y(r)h(:=)h("")215 1835 y(s)f(?)h({)258 1885 y(while)f(r)g(||:=)g
(tab\(upto\('$'\)\))e(do)j({)f(="$";)g(r)h(||:=)f("$$")g(})258
1935 y(return)g(r)g(||)h(tab\(0\))215 1985 y(})171 2034
y(end)129 2086 y Fp(De\014nes:)171 2126 y Fl(escape_dol)o(lar)o(s)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(109b,)g(332b,)g(333b,)g(and)h
(344b.)p eop
%%Page: 113 113
113 112 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(exp.nw)82 b Fv(113)145 258 y Fj(5.6)66 b(Seman)n(tic)24
b(functions)145 349 y Fr(binop)12 b Fv(implemen)o(ts)f(the)j(seman)o
(tics)e(of)h(binary)f(op)q(erators.)19 b(It)13 b(mo)q(di\014es)f(its)h
(inputs)h(and)145 398 y(returns)i Fr(e1)p Fv(,)d(so)h(it)f(should)h(b)q
(e)g(used)h(only)e(during)h(parsing.)-15 461 y Fp(113a)88
b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p Fo(\021)1049
b Fm(/)5 b Fp(112b)22 b(113b)5 b Fm(.)187 510 y Fr(procedure)20
b(binop\(e1,)g(op,)h(e2\))230 560 y(e1)h(:=)f(term2table\(e1\))230
610 y(e2)h(:=)f(term2table\(e2\))230 660 y(case)g(op)h(of)f({)274
710 y("+")g(:)h(every)e(v)i(:=)f(key\(e2\))g(do)g(e1[v])g(+:=)g(e2[v])
274 760 y("-")g(:)h(every)e(v)i(:=)f(key\(e2\))g(do)g(e1[v])g(-:=)g
(e2[v])274 809 y("*")g(:)h(if)f(n2)g(:=)h(constant\(e2\))d(then)i({)492
859 y(every)g(!e1)g(*:=)g(n2)405 909 y(})g(else)g(if)h(n1)f(:=)g
(constant\(e1\))f(then)h({)492 959 y(every)g(!e2)g(*:=)g(n1)492
1009 y(e1)g(:=)h(e2)405 1058 y(})f(else)g(error\("multiplicati)o(on)e
(must)i(be)g(by)g(constants)f(only"\))274 1108 y("/")h(:)h
(error\("division)c(is)k(not)f(permitted)f(in)h(this)g(language"\))230
1158 y(})230 1208 y(return)g(e1)187 1258 y(end)145 1310
y Fp(De\014nes:)187 1349 y Fl(binop)p Fp(,)10 b(used)g(in)h(c)o(h)o
(unks)f(49c,)h(193a,)f(264,)g(and)h(270a.)145 1388 y(Uses)h
Fl(constant)d Fp(114b)h(and)h Fl(term2table)d Fp(113b.)-17
1471 y(113b)88 b Fo(h)p Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p
Fo(\021)1053 b Fm(/)5 b Fp(113a)22 b(114a)5 b Fm(.)187
1521 y Fr(procedure)20 b(term2table\(x\))230 1571 y(return)h(case)g
(type\(x\))f(of)i({)274 1621 y("table")64 b(:)21 b(x)274
1671 y("integer")f(:)h(1\(e)h(:=)f(table\(0\),)f(e[1])h(:=)g(x\))274
1721 y(default)64 b(:)21 b(1\(e)h(:=)f(table\(0\),)f(e[x])h(:=)g(1\))
230 1770 y(})187 1820 y(end)145 1872 y Fp(De\014nes:)187
1911 y Fl(term2table)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(91,)i(113a,)
f(136a,)g(143b,)h(and)f(144c.)p eop
%%Page: 114 114
114 113 bop 129 141 a Fv(114)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y Fr(addconst)f Fv(is)i(nondestructiv)o(e.)
-31 320 y Fp(114a)88 b Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o
Fv(+)p Fo(\021)1049 b Fm(/)5 b Fp(113b)23 b(114b)t Fm(.)171
370 y Fr(procedure)d(addconst\(e,)f(n\))215 420 y(if)i(n)h(=)f(0)h
(then)f(return)f(e)215 469 y(if)h(type\(e\))f(==)i("table")e(then)258
519 y(t)i(:=)f(copy\(e\))215 569 y(else)g({)258 619 y(t)h(:=)f
(table\(0\))258 669 y(if)h(type\(t\))e(==)h("integer")f(then)h(t[1])g
(:=)g(e)h(else)f(t[e])g(:=)g(1)215 718 y(})215 768 y(t[1])g(+:=)g(n)215
818 y(return)f(t)171 868 y(end)129 920 y Fp(De\014nes:)171
959 y Fl(addconst)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(329g)h(and)f
(342c.)192 1021 y Fv(It)k(is)f(necessary)j(to)e(iden)o(tify)f(a)h
(constan)o(t)g(in)g(normal)d(form.)-33 1084 y Fp(114b)88
b Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1055
b Fm(/)5 b Fp(114a)22 b(114c)5 b Fm(.)171 1134 y Fr(procedure)20
b(constant\(e\))215 1183 y(if)h(type\(c)f(:=)i(untable\(e\)\))d(==)j
("integer")e(then)h(return)f(c)171 1233 y(end)129 1285
y Fp(De\014nes:)171 1324 y Fl(constant)p Fp(,)10 b(used)i(in)h(c)o(h)o
(unks)e(77a,)h(105d,)f(113a,)h(116a,)f(144b,)h(219d,)f(270b,)h(283a,)f
(327a,)h(341a,)212 1364 y(349{51,)e(and)g(363a.)129 1403
y(Uses)i Fl(untable)d Fp(114c.)-29 1486 y(114c)88 b Fo(h)p
Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1051 b Fm(/)5
b Fp(114b)22 b(115a)5 b Fm(.)171 1536 y Fr(procedure)20
b(untable\(e\))215 1586 y(return)g(if)h(type\(e\))g(~==)g("table")f
(then)h(e)h(else)f({)258 1636 y(n)h(:=)f(0)258 1686 y(every)g(k)g(:=)h
(key\(e\))e(&)i(e[k])f(~=)g(0)h(do)f(n)h(+:=)f(1)258
1735 y(case)g(n)h(of)f({)302 1785 y(0)152 b(:)22 b(0)302
1835 y(1)152 b(:)22 b(if)f(k)h(:=)f(key\(e\))g(&)g(e[k])g(=)h(1)f(then)
g(k)520 1885 y(else)g(if)g(e[1])g(~=)g(0)h(then)f(e[1])520
1935 y(else)g(e)302 1985 y(default)f(:)i(e)258 2034 y(})215
2084 y(})171 2134 y(end)129 2186 y Fp(De\014nes:)171
2225 y Fl(untable)p Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(114b,)g(144b,)g
(176,)g(and)h(222a.)p eop
%%Page: 115 115
115 114 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(exp.nw)82 b Fv(115)145 258 y Fj(5.7)66 b(Creation)145
349 y Fr(mkslice)11 b Fv(is)i(used)g(only)f(to)g(create)i(slices)f
(from)e(actual)h(sp)q(eci\014cations,)h(in)f(whic)o(h)h(the)g(bit)145
398 y(n)o(um)o(b)q(ering)g(could)h(c)o(hange.)-1001 b
Fk(\031Change)14 b(#26)-15 461 y Fp(115a)88 b Fo(h)p
Fn(*)15 b Fp(81)p Fo(i)p Fv(+)p Fo(\021)1057 b Fm(/)5
b Fp(114c)22 b(115c)5 b Fm(.)187 510 y Fr(procedure)20
b(mkslice\(x,)f(lo,)j(hi\))230 560 y(local)f(n)h(#)f(size)g(of)h(range)
230 610 y(if)g(lo)f(<)h(0)f(then)g(error\("Can't)f(take)h(negative)f
(bit)h(slice!!"\))230 660 y(if)h(hi)f(<=)h(lo)f(then)g
(error\(expimage\(x\))o(,)e("[",)i(lo,)g(":",)g(hi)g(-)h(1,)f("])h(has)
f(no)g(bits!"\))230 710 y(if)h(hi)f(>)h(bitsizeof\(x\))d(then)274
760 y(error\(if)h(type\(f)h(:=)g(symtab[x]\))f(==)h("field")f(then)h
("Field)g(")h(||)f(f.name)405 809 y(else)g("Host)f(machine",)470
859 y(")i(has)f(only)g(",)g(bitsizeof\(x\),)e(")j(bits"\))230
909 y(bit_numbering_used)c(:=)k(1)230 959 y Fo(h)p Fn(if)15
b(ne)n(e)n(de)n(d,)g(\015ip)g Fr(lo)g Fn(and)g Fr(hi)g
Fp(115b)p Fo(i)230 1009 y Fr(return)21 b(Eslice\(x,)f(lo,)h(hi)g(-)h
(lo\))187 1058 y(end)145 1110 y Fp(De\014nes:)187 1150
y Fl(mkslice)p Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(50b.)145
1189 y(Uses)k Fl(bit_number)o(ing)o(_us)o(ed)c Fp(36b,)j
Fl(bitsizeof)d Fp(115c,)i Fl(Eslice)g Fp(81,)h Fl(expimage)e
Fp(101a,)h Fl(field)g Fp(55,)187 1229 y(and)e Fl(symtab)g
Fp(32a)h(367.)-17 1312 y(115b)88 b Fo(h)p Fn(if)15 b(ne)n(e)n(de)n(d,)g
(\015ip)g Fr(lo)g Fn(and)g Fr(hi)g Fp(115b)p Fo(i)n(\021)742
b Fp(\(115a\))187 1361 y Fr(if)21 b(/bit_zero_is_lsb)e(then)i({)230
1411 y(lo)h(:=)f(bitsizeof\(x\))e(-)j(hi)230 1461 y(hi)g(:=)f
(bitsizeof\(x\))e(-)j(lo)187 1511 y(})145 1563 y Fp(Uses)12
b Fl(bitsizeof)d Fp(115c)h(and)h Fl(bit_zero_)o(is_)o(lsb)d
Fp(32a.)-13 1654 y(115c)88 b Fo(h)p Fn(*)15 b Fp(81)p
Fo(i)p Fv(+)p Fo(\021)1051 b Fm(/)5 b Fp(115a)22 b(115d)5
b Fm(.)187 1704 y Fr(procedure)20 b(bitsizeof\(f\))230
1754 y(return)h(case)g(type\(symtab[f]\))e(of)i({)318
1804 y("field")f(:)h(fwidth\(symtab[f]\))318 1853 y(default)f(:)h
(wordsize)274 1903 y(})187 1953 y(end)145 2005 y Fp(De\014nes:)187
2044 y Fl(bitsizeof)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(115)g(and)h
(153e.)145 2084 y(Uses)h Fl(field)e Fp(55,)h Fl(fwidth)e
Fp(115d,)i Fl(symtab)e Fp(32a)i(367,)f(and)h Fl(wordsize)e
Fp(38c.)-17 2175 y(115d)88 b Fo(h)p Fn(*)15 b Fp(81)p
Fo(i)p Fv(+)p Fo(\021)1055 b Fm(/)5 b Fp(115c)22 b(116a)5
b Fm(.)187 2225 y Fr(procedure)20 b(fwidth\(f\))230 2275
y(return)h(f.hi)g(-)g(f.lo)187 2324 y(end)145 2376 y
Fp(De\014nes:)187 2416 y Fl(fwidth)p Fp(,)10 b(used)i(in)h(c)o(h)o
(unks)e(46b,)h(50b,)f(61,)h(62a,)g(70c,)g(97b,)g(115c,)f(188b,)g(195,)h
(199a,)g(201b,)f(203,)228 2455 y(204a,)g(208a,)g(212d,)g(247,)g(249a,)g
(282a,)g(285b,)f(290b,)h(297c,)g(299a,)g(315b,)f(349{51,)h(355d,)f
(357b,)228 2495 y(and)h(371b.)p eop
%%Page: 116 116
116 115 bop 129 141 a Fv(116)83 b Fr(exp.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(116a)88 b Fo(h)p Fn(*)16
b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1049 b Fm(/)5 b Fp(115d)23
b(116b)t Fm(.)171 307 y Fr(procedure)d(mkshift\(x,)g(n\))215
357 y(return)g(if)h(n)h(=)g(0)f(then)g(x)h(else)367 407
y(ishift\(\\simp)d(&)j(constant\(x\),)d(n\))j(|)f(Eshift\(x,)f(n\))171
457 y(end)129 509 y Fp(Uses)12 b Fl(constant)d Fp(114b)h(and)h
Fl(Eshift)f Fp(81.)-33 600 y(116b)88 b Fo(h)p Fn(*)16
b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1055 b Fm(/)5 b Fp(116a)22
b(116c)5 b Fm(.)171 650 y Fr(record)21 b(bogus\(e\))f(#)h(ditch)g
(invalid)f(field)h(name)g(complaint)129 702 y Fp(De\014nes:)171
741 y Fl(bogus)p Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(13f,)h(24,)g
(26a,)f(34a,)h(and)f(361a.)129 781 y(Uses)i Fl(field)e
Fp(55.)192 851 y Fr(flatten)h Fv(is)i(used)g(to)g(\015atten)g(the)g
(argumen)o(t)f(lists)h(of)f(binary)g(asso)q(ciativ)o(e)h(op)q(erators)
129 901 y(lik)o(e)h Fr(Eorb)f Fv(and)g Fr(Eand)p Fv(.)-29
963 y Fp(116c)88 b Fo(h)p Fn(*)16 b Fp(81)p Fo(i)o Fv(+)p
Fo(\021)1049 b Fm(/)5 b Fp(116b)23 b(116d)t Fm(.)171
1013 y Fr(procedure)d(flatten\(e,)g(ty,)h(l\))215 1063
y(/l)g(:=)g([])215 1113 y(return)f(if)h(type\(e\))g(==)g(ty)h(then)258
1163 y(flatten\(e.x,)d(ty,)j(flatten\(e.y,)d(ty,)i(l\)\))215
1212 y(else)258 1262 y(push\(l,)f(e\))171 1312 y(end)129
1364 y Fp(De\014nes:)171 1403 y Fl(flatten)p Fp(,)9 b(used)i(in)g(c)o
(h)o(unks)f(130a)g(and)h(221a.)192 1466 y Fv(Un\015atten)j(tak)o(es)h
(the)f(list)g(and)f(the)i(op)q(erator)f(and)g(turns)h(it)e(bac)o(k)h
(in)o(to)f(a)h(tree.)-33 1528 y Fp(116d)88 b Fo(h)p Fn(*)16
b Fp(81)p Fo(i)o Fv(+)p Fo(\021)1172 b Fm(/)6 b Fp(116c)171
1578 y Fr(procedure)20 b(unflatten\(l,)f(rator,)i(zero\))215
1628 y(if)g(*l)g(=)h(0)f(then)g(return)g(zero)215 1677
y(else)g({)258 1727 y(x)h(:=)f(l[1])258 1777 y(every)g(x)g(:=)h
(rator\(x,)e(l[2)h(to)h(*l]\))215 1827 y(})215 1877 y(return)e(x)171
1926 y(end)129 1978 y Fp(De\014nes:)171 2018 y Fl(unflatten)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(221a.)p eop
%%Page: 117 117
117 116 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(expwalk.nw)81 b Fv(117)145 258 y Fj(5.8)66 b(Visiting)24
b(ev)n(ery)g(term)e(of)g(an)h(expression)145 349 y Fr(expwalk)14
b Fv(susp)q(ends)i Fn(every)f Fv(result)g(of)f(applying)g
Fr(f)g Fv(to)h(eac)o(h)g(no)q(de)g(in)f(a)h(b)q(ottom-up)e(tree)145
398 y(w)o(alk.)-15 461 y Fp(117a)88 b Fo(h)p Fn(*)15
b Fp(117a)p Fo(i)o(\021)1167 b Fp(120a)5 b Fm(.)187 510
y Fr(procedure)20 b(expwalk\(e,)f(f,)j(closure[]\))230
560 y(suspend)f(do_expwalk\(e,)e(f,)i(closure\))187 610
y(end)187 710 y(procedure)f(do_expwalk\(e,)f(f,)i(closure\))230
760 y(suspend)g(case)g(type\(e\))f(of)h({)427 809 y Fo(h)p
Fn(c)n(ases)15 b(for)f Fr(do_expwalk)f Fp(117b)p Fo(i)427
859 y Fr(default)20 b(:)h(impossible\("expressi)o(on)e(type)i(in)g
(expression)f(walking"\))405 909 y(})h(|)h(f)f(!)h(\([e])f(|||)g
(closure\))187 1009 y(end)145 1060 y Fp(De\014nes:)187
1100 y Fl(do_expwalk)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(84a)i(and)g
(117{19.)187 1139 y Fl(expwalk)p Fp(,)e(used)h(in)i(c)o(h)o(unks)d
(49b,)i(84b,)f(148b,)g(and)h(329a.)-17 1222 y(117b)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_expwalk)f Fp(117b)p
Fo(i)n(\021)677 b Fp(\(117a\))21 b(117c)5 b Fm(.)187
1272 y Fr("pattern")194 b(:)22 b(do_expwalk\(!e.di)o(sjunc)o(ts,)c(f,)k
(closure\))187 1322 y("disjunct")172 b(:)22 b(do_expwalk\(!\\e.c)o
(ondit)o(ions)c(|)k(!e.sequents,)d(f,)j(closure\))187
1372 y("adisjunct")150 b(:)22 b(do_expwalk\(!\\e.c)o(ondit)o(ions)c(|)k
(!e.aconstraints,)c(f,)k(closure\))187 1422 y("sequent")194
b(:)22 b(do_expwalk\(!e.co)o(nstra)o(ints)o(,)d(f,)i(closure\))187
1471 y("dots_sequent")84 b(:)22 b(&fail)187 1521 y("patlabel")172
b(:)22 b(&fail)145 1573 y Fp(Uses)13 b Fl(adisjunct)c
Fp(268,)i Fl(constrain)o(ts)e Fp(136a,)i Fl(disjunct)e
Fp(55,)j Fl(do_expwal)o(k)d Fp(117a,)i Fl(dots_seque)o(nt)e
Fp(62c,)187 1613 y Fl(fail)h Fp(410,)h Fl(patlabel)e
Fp(55,)h Fl(pattern)g Fp(55,)g(and)h Fl(sequent)e Fp(55.)145
1683 y Fr(e.instance)j Fv(can)i(b)q(e)g Fr(null)f Fv(when)h(a)f
(pattern)i(lab)q(el)e(is)h(\\v)n(anishing,")d(and)j(w)o(e)f(w)o
(ouldn't)145 1733 y(w)o(an)o(t)h(to)f(w)o(alk)g(a)h(n)o(ull.)-13
1795 y Fp(117c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_expwalk)f
Fp(117b)p Fo(i)n Fv(+)q Fo(\021)520 b Fp(\(117a\))22
b Fm(/)5 b Fp(117b)22 b(117d)5 b Fm(.)187 1845 y Fr("latent_patlabel)o
(")19 b(:)j(do_expwalk\(\(vani)o(shing)o(_lat)o(ent_p)o(atlab)o(el)d
(~===)i(e\).instance,)e(f,)i(closure\))187 1895 y("constraint")128
b(:)22 b(do_expwalk\(e.fie)o(ld,)d(f,)i(closure\))187
1945 y("fieldbinding")84 b(:)22 b(do_expwalk\(e.cod)o(e)d(|)j(e.field,)
e(f,)h(closure\))187 1994 y("absolute_field")40 b(:)22
b(do_expwalk\(e.fie)o(ld,)d(f,)i(closure\))187 2044 y("field")238
b(:)22 b(&fail)145 2096 y Fp(Uses)15 b Fl(absolute_fi)o(el)o(d)d
Fp(268,)i Fl(constrain)o(t)e Fp(55,)i Fl(do_expwalk)d
Fp(117a,)i Fl(fail)h Fp(410,)f Fl(field)h Fp(55,)187
2136 y Fl(fieldbindi)o(ng)8 b Fp(55,)j Fl(latent_patl)o(ab)o(el)e
Fp(55,)h(and)h Fl(vanishing_)o(lat)o(ent)o(_pa)o(tl)o(abe)o(l)e
Fp(32a.)-17 2219 y(117d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(do_expwalk)f Fp(117b)p Fo(i)n Fv(+)q Fo(\021)526 b
Fp(\(117a\))22 b Fm(/)5 b Fp(117c)22 b(118a)5 b Fm(.)187
2268 y Fr("list")20 b(|)i("set")86 b(:)22 b(do_expwalk\(!e,)d(f,)i
(closure\))187 2318 y("eqn")282 b(:)22 b(do_expwalk\(e.lef)o(t)d(|)j
(e.right,)e(f,)h(closure\))187 2368 y("table")238 b(:)22
b(do_expwalk\(key\(e)o(\),)d(f,)i(closure\))145 2420
y Fp(Uses)12 b Fl(do_expwalk)c Fp(117a)j(and)f Fl(eqn)h
Fp(83c.)p eop
%%Page: 118 118
118 117 bop 129 141 a Fv(118)83 b Fr(expwalk.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(118a)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_expwalk)f Fp(117b)p
Fo(i)n Fv(+)q Fo(\021)520 b Fp(\(117a\))22 b Fm(/)5 b
Fp(117d)23 b(118b)t Fm(.)171 307 y Fr("Eorb")e(|)g("Eand")64
b(:)22 b(do_expwalk\(e.x)d(|)i(e.y,)g(f,)h(closure\))171
357 y("Eslice")e(|)i("Eshift")e(|)h("Enarrowu")f(|)i("Enarrows")d(|)j
("Ewiden")e(|)171 407 y("Ediv")h(|)g("Emod")g(|)g("Semit")g(|)g
("Stoken")f(|)i("Efitsu")e(|)i("Efitss")e(|)215 457 y("Einstance_inpu)o
(t")f(|)i("Einstance_tagged")d(:)607 507 y(do_expwalk\(e.x,)h(f,)i
(closure\))171 557 y("Epatlabel")150 b(:)22 b(do_expwalk\(e.l,)d(f,)i
(closure\))171 606 y("Eforce")f(|)i("Eforceable")d(|)j("Enot")e(|)i
("Enosimp")e(|)h("Sstmts")f(:)607 656 y(do_expwalk\(e.x,)f(f,)i
(closure\))171 706 y("Epc")g(|)g("Epc_known")f(:)h(&fail)171
756 y("Einstance")150 b(:)22 b(do_expwalk\(!e.arg)o(t,)d(f,)i
(closure\))171 806 y("Ebinding_instanc)o(e")e(:)i(do_expwalk\(e.name,)d
(f,)k(closure\))171 855 y("Eapp")260 b(:)22 b(do_expwalk\(!e.arg)o(s,)d
(f,)i(closure\))171 905 y("Eclosure_loc")41 b(:)21 b(&fail)171
955 y("Eclosure_addr")e(:)i(&fail)171 1005 y("Eclosure_val")41
b(:)21 b(&fail)129 1057 y Fp(Uses)14 b Fl(do_expwalk)d
Fp(117a,)h Fl(Eand)h Fp(81,)g Fl(Eapp)f Fp(81,)i Fl(Ebinding_)o(ins)o
(tan)o(ce)c Fp(81,)k Fl(Eclosure_)o(add)o(r)d Fp(81,)171
1096 y Fl(Eclosure_l)o(oc)g Fp(81,)j Fl(Eclosure_v)o(al)d
Fp(81,)j Fl(Ediv)f Fp(81,)h Fl(Efitss)f Fp(81,)g Fl(Efitsu)g
Fp(81,)h Fl(Eforce)e Fp(81,)171 1136 y Fl(Eforceable)e
Fp(81,)j Fl(Einstance)d Fp(81,)i Fl(Einstance_in)o(pu)o(t)f
Fp(81,)h Fl(Einstance_t)o(agg)o(ed)e Fp(81,)j Fl(Emod)f
Fp(81,)171 1175 y Fl(Enarrows)f Fp(81,)j Fl(Enarrowu)d
Fp(81,)j Fl(Enosimp)d Fp(81,)j Fl(Enot)f Fp(81,)g Fl(Eorb)g
Fp(81,)g Fl(Epatlabel)f Fp(81,)h Fl(Epc)g Fp(81,)171
1214 y Fl(Epc_known)e Fp(81,)i Fl(Eshift)g Fp(81,)g Fl(Eslice)f
Fp(81,)i Fl(Ewiden)e Fp(81,)h Fl(fail)g Fp(410,)g Fl(Semit)g
Fp(81,)g Fl(Sstmts)f Fp(81,)171 1254 y(and)f Fl(Stoken)e
Fp(81.)-33 1345 y(118b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(do_expwalk)f Fp(117b)p Fo(i)n Fv(+)q Fo(\021)526 b
Fp(\(117a\))22 b Fm(/)5 b Fp(118a)22 b(118c)5 b Fm(.)171
1395 y Fr("Sif")282 b(:)22 b(do_expwalk\(!e.arm)o(s,)d(f,)i(closure\))
171 1445 y("Sguarded")172 b(:)22 b(do_expwalk\(e.guar)o(d)d(|)i(e.x,)g
(f,)h(closure\))171 1495 y("Sepsilon")172 b(:)22 b(&fail)171
1544 y("Stagcase")172 b(:)22 b(do_expwalk\(e.x)d(|)i(!e.arms,)f(f,)i
(closure\))171 1594 y("Sfail")238 b(:)22 b(&fail)171
1644 y("integer")e(|)h("string")g(|)g("literal")f(:)i(&fail)171
1694 y("Efail")238 b(:)22 b(&fail)171 1744 y("Sclosure")172
b(:)22 b(do_expwalk\(e.disj)o(unct)c(|)k(\\e.conditions)d(|)j
(\\e.creation,)d(f,)i(closure\))129 1796 y Fp(Uses)14
b Fl(disjunct)d Fp(55,)h Fl(do_expwalk)e Fp(117a,)i Fl(Efail)g
Fp(81,)h Fl(fail)f Fp(410,)g Fl(literal)f Fp(45e,)h Fl(Sclosure)f
Fp(193f,)171 1835 y Fl(Sepsilon)e Fp(81,)i Fl(Sfail)f
Fp(188c,)g Fl(Sguarded)f Fp(81,)i Fl(Sif)f Fp(81,)h(and)g
Fl(Stagcase)e Fp(183a.)-29 1926 y(118c)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(do_expwalk)f Fp(117b)p Fo(i)n Fv(+)q Fo(\021)522
b Fp(\(117a\))22 b Fm(/)5 b Fp(118b)22 b(119a)5 b Fm(.)171
1976 y Fr("balance")194 b(:)22 b(do_expwalk\(e.left)c(|)k(e.right,)e
(f,)h(closure\))171 2026 y("balitem")194 b(:)22 b(do_expwalk\(e.v)d(|)i
(e.value,)f(f,)i(closure\))129 2078 y Fp(Uses)12 b Fl(balance)d
Fp(141a,)i Fl(balitem)e Fp(141a,)h Fl(do_expwalk)e Fp(117a,)i(and)h
Fl(value)f Fp(136a.)p eop
%%Page: 119 119
119 118 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(expwalk.nw)81 b Fv(119)-15 258 y Fp(119a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(do_expwalk)f Fp(117b)p Fo(i)n
Fv(+)q Fo(\021)524 b Fp(\(117a\))22 b Fm(/)5 b Fp(118c)22
b(119b)5 b Fm(.)187 307 y Fr("Glines")216 b(:)22 b(&fail)187
357 y("Gresynch")172 b(:)22 b(&fail)187 407 y("Gblock")216
b(:)22 b(do_expwalk\(!e.de)o(cls)d(|)i(!e.stmts,)f(f,)h(closure\))187
457 y("Gdecl")238 b(:)22 b(do_expwalk\(e.ini)o(t,)d(f,)i(closure\))187
507 y("Gcase")238 b(:)22 b(do_expwalk\(e.x)d(|)i(!e.arms,)f(f,)i
(closure\))187 557 y("Gcasearm")172 b(:)22 b(do_expwalk\(e.x,)c(f,)k
(closure\))187 606 y("Ginrange")172 b(:)22 b(do_expwalk\(e.x,)c(f,)k
(closure\))187 656 y("Gsetname")172 b(:)22 b(&fail)187
706 y("Gnomatch")172 b(:)22 b(&fail)187 756 y("Gasgn")238
b(:)22 b(do_expwalk\(e.x,)c(f,)k(closure\))187 806 y("Tunsigned")150
b(:)22 b(&fail)187 855 y("Gcomment")172 b(:)22 b(&fail)187
905 y("Gcommented")128 b(:)22 b(do_expwalk\(e.e,)c(f,)k(closure\))145
957 y Fp(Uses)13 b Fl(do_expwalk)d Fp(117a,)h Fl(fail)h
Fp(410,)g Fl(Gasgn)f Fp(294a,)h Fl(Gblock)f Fp(293a,)g
Fl(Gcase)h Fp(294a,)f Fl(Gcasearm)f Fp(294a,)187 997
y Fl(Gcomment)f Fp(20,)i Fl(Gcommented)e Fp(299a,)h Fl(Gdecl)g
Fp(293a,)h Fl(Ginrange)e Fp(294a,)i Fl(Glines)f Fp(293a,)g
Fl(Gnomatch)f Fp(294a,)187 1036 y Fl(Gresynch)g Fp(293a,)h
Fl(Gsetname)f Fp(294a,)h(and)g Fl(Tunsigned)f Fp(294a.)-17
1127 y(119b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_expwalk)f
Fp(117b)p Fo(i)n Fv(+)q Fo(\021)526 b Fp(\(117a\))22
b Fm(/)5 b Fp(119a)22 b(119c)5 b Fm(.)187 1177 y Fr("inject")216
b(:)22 b(do_expwalk\(\\e.pa)o(ttern)c(|)k(\\e.integer,)d(f,)j
(closure\))145 1229 y Fp(Uses)12 b Fl(do_expwalk)c Fp(117a,)i
Fl(inject)g Fp(29,)h(and)f Fl(pattern)g Fp(55.)-13 1320
y(119c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_expwalk)f
Fp(117b)p Fo(i)n Fv(+)q Fo(\021)640 b Fp(\(117a\))21
b Fm(/)6 b Fp(119b)187 1370 y Fr("Eclosure")20 b(:)h
(do_expwalk\(!e.valu)o(es)e(|)i(!e.addresses,)e(f,)j(closure\))187
1420 y("Elambda")42 b(:)21 b(do_expwalk\(e.body,)d(f,)k(closure\))145
1472 y Fp(Uses)12 b Fl(do_expwalk)c Fp(117a,)i Fl(Eclosure)f
Fp(218,)i(and)f Fl(Elambda)g Fp(217.)p eop
%%Page: 120 120
120 119 bop 129 141 a Fv(120)83 b Fr(expwalk.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Fj(5.9)67
b(Generalized)23 b(substitution)-31 349 y Fp(120a)88
b Fo(h)p Fn(*)16 b Fp(117a)p Fo(i)n Fv(+)q Fo(\021)1015
b Fm(/)5 b Fp(117a)23 b(120b)t Fm(.)171 398 y Fr(procedure)d
(gsubst\(e,)g(f,)h(closure[]\))215 448 y(return)f(do_gsubst\(e,)f(f,)j
(closure\))171 498 y(end)171 598 y(procedure)e(do_gsubst\(e,)f(f,)j
(closure\))215 647 y(local)e(args)215 697 y(return)g(f)i(!)f(\([e])g
(|||)g(closure\))g(|)367 747 y(case)g(type\(e\))f(of)i({)411
797 y Fo(h)p Fn(c)n(ases)15 b(for)f Fr(do_gsubst)f Fp(121a)p
Fo(i)411 847 y Fr(default)20 b(:)i(impossible\("expr)o(essi)o(on)d
(type)i(in)g(generalized)f(substition"\))367 897 y(})171
946 y(end)171 1046 y(procedure)g(do_gsubst_childre)o(n\(e,)e(f,)k
(closure\))215 1096 y(local)e(args)215 1146 y(return)g(case)h
(type\(e\))f(of)i({)411 1195 y Fo(h)p Fn(c)n(ases)15
b(for)f Fr(do_gsubst)f Fp(121a)p Fo(i)411 1245 y Fr(default)20
b(:)i(impossible\("expr)o(essi)o(on)d(type)i(in)g(generalized)f
(substition"\))367 1295 y(})171 1345 y(end)129 1397 y
Fp(De\014nes:)171 1436 y Fl(do_gsubst)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unks)f(88{90)g(and)g(121{26.)171 1476 y Fl(gsubst)p
Fp(,)g(used)h(in)h(c)o(h)o(unks)e(77a,)h(148b,)f(149a,)h(174b,)g(175b,)
f(178a,)h(180,)g(181c,)g(190,)g(192,)g(260,)g(269,)212
1515 y(and)g(314a.)-33 1606 y(120b)88 b Fo(h)p Fn(*)16
b Fp(117a)p Fo(i)n Fv(+)q Fo(\021)1015 b Fm(/)5 b Fp(120a)23
b(121b)t Fm(.)171 1656 y Fr(procedure)d(maplistn\(f,)f(l,)j(closure\))
215 1706 y(local)e(result,)h(x)215 1756 y(result)f(:=)h([])215
1806 y(every)f(x)i(:=)f(!l)h(do)258 1855 y(put\(result,)e(f)h(!)h
(\([x])f(|||)g(closure\))f(|)i(fail\))215 1905 y(return)e(result)171
1955 y(end)129 2007 y Fp(De\014nes:)171 2046 y Fl(maplistn)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(121{23.)129 2086
y(Uses)i Fl(fail)e Fp(410.)p eop
%%Page: 121 121
121 120 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(expwalk.nw)81 b Fv(121)-15 258 y Fp(121a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(do_gsubst)f Fp(121a)p Fo(i)o(\021)698
b Fp(\(120a\))21 b(122a)5 b Fm(.)187 307 y Fr("pattern")42
b(:)21 b(if)g(l)h(:=)f(maplistn\(do_gsubst,)d(e.disjuncts,)i([f,)h
(closure]\))f(&)535 357 y(lists_match\(l,)f(e.disjuncts\))h(then)h(e)g
(else)g({)579 407 y(ll)g(:=)h([];)579 457 y(every)f(d)g(:=)h(!l)f(do)
623 507 y(if)g(not)g(member\(\\d.conditio)o(ns,)e(0\))i(then)g
(put\(ll,)f(d\))535 557 y(pattern\(ll,)g(e.name\))470
606 y(})187 656 y("disjunct")g(:)h({)h(fclosure)e(:=)h([f,)g(closure])
514 706 y(c)g(:=)h(do_gsubst_condit)o(ions\()o(e.co)o(nditi)o(ons,)c
(f,)k(closure\))514 756 y(s)f(:=)h([])43 b(#)21 b(this)g(code)g
(vanishes)f(dead)h(latent)g(pattern)f(labels)514 806
y(every)g(x)i(:=)f(do_gsubst\(!e.sequen)o(ts,)e(f,)i(closure\))f(do)557
855 y(put\(s,)h(vanishing_latent_)o(patl)o(abel)d(~===)j(x\))514
905 y(if)g(lists_match\(s,)e(e.sequents\))g(&)j(c)g(===)f(e.conditions)
e(then)557 955 y(e)514 1005 y(else)557 1055 y(disjunct\(s,)h(e.name,)g
(c\))470 1104 y(})145 1156 y Fp(Uses)14 b Fl(disjunct)d
Fp(55,)j Fl(do_gsubst)c Fp(120a,)j Fl(do_gsubst)o(_co)o(ndi)o(tio)o(ns)
e Fp(121b,)h Fl(lists_matc)o(h)f Fp(127a,)187 1196 y
Fl(maplistn)e Fp(120b,)h Fl(pattern)f Fp(55,)i(and)g
Fl(vanishing)o(_la)o(ten)o(t_)o(pat)o(lab)o(el)d Fp(32a.)-17
1287 y(121b)88 b Fo(h)p Fn(*)15 b Fp(117a)p Fo(i)o Fv(+)p
Fo(\021)1014 b Fm(/)5 b Fp(120b)22 b(126b)5 b Fm(.)187
1337 y Fr(procedure)20 b(do_gsubst_condit)o(ions\()o(e,)f(f,)i
(closure\))230 1387 y(if)h(\\\(c)f(:=)g(e\))h(then)f({)296
1437 y(c)g(:=)h(set\(\);)296 1486 y(every)f(insert_conditio)o(n\(c,)d
(do_gsubst\(!e,)h(f,)j(closure\)\))296 1536 y(if)f(sets_match\(c,)e
(e\))j(then)f(c)g(:=)h(e)230 1586 y(})230 1636 y(return)f(c)187
1686 y(end)187 1785 y(procedure)f(gsubst_condition)o(s\(e,)e(f,)k
(closure[]\))230 1835 y(return)f(do_gsubst_conditi)o(ons\(e)o(,)e(f,)i
(closure\))187 1885 y(end)145 1937 y Fp(De\014nes:)187
1976 y Fl(do_gsubst_)o(con)o(di)o(tio)o(ns)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unk)f(121a.)145 2016 y(Uses)i Fl(do_gsubst)d Fp(120a,)h
Fl(insert_co)o(ndi)o(tio)o(n)f Fp(126c,)h(and)g Fl(sets_match)f
Fp(127b.)p eop
%%Page: 122 122
122 121 bop 129 141 a Fv(122)83 b Fr(expwalk.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(122a)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_gsubst)f Fp(121a)p
Fo(i)o Fv(+)p Fo(\021)546 b Fp(\(120a\))22 b Fm(/)5 b
Fp(121a)23 b(122b)t Fm(.)171 307 y Fr("adisjunct")c(:)j({)498
357 y(if)f(\\\(c)g(:=)h(e.conditions\))d(then)i({)541
407 y(c)h(:=)f(set\(\);)541 457 y(every)g(insert_condition\(c)o(,)e
(do_gsubst\(!e.condi)o(tions)o(,)g(f,)i(closure\)\))541
507 y(if)h(sets_match\(c,)d(e.conditions\))g(then)i(c)h(:=)f
(e.conditions)498 557 y(})498 606 y(if)g(\\\(p)g(:=)h(e.patlabelbindin)
o(gs\))d(then)541 656 y(p)j(:=)f(do_gsubst_values_in)o(_tabl)o(e\(p,)d
(f,)k(closure\))498 706 y(s)f(:=)h(maplistn\(do_gsubs)o(t,)d
(e.aconstraints,)f([f,)k(closure]\))498 756 y(if)f(lists_match\(s,)e
(e.aconstraints\))g(&)i(c)h(===)f(e.conditions)e(&)563
806 y(p)j(===)f(e.patlabelbinding)o(s)498 855 y(then)541
905 y(e)498 955 y(else)541 1005 y(adisjunct\(s,)f(e.name,)g(c,)h
(e.length,)f(p\))454 1055 y(})171 1104 y("sequent")42
b(:)21 b(if)h(l)f(:=)h(maplistn\(do_gsub)o(st,)c(e.constraints,)h([f,)j
(closure]\))d(&)520 1154 y(lists_match\(l,)g(e.constraints\))f(then)j
(e)h(else)f(sequent\(l,)f(e.class\))129 1206 y Fp(Uses)13
b Fl(adisjunct)c Fp(268,)i Fl(constrain)o(ts)e Fp(136a,)i
Fl(do_gsubst)e Fp(120a,)h Fl(do_gsubst_v)o(alu)o(es_)o(in)o(_ta)o(ble)f
Fp(90a,)171 1246 y Fl(insert_con)o(dit)o(ion)k Fp(126c,)i
Fl(lists_matc)o(h)f Fp(127a,)h Fl(maplistn)e Fp(120b,)i
Fl(sequent)f Fp(55,)171 1285 y(and)d Fl(sets_matc)o(h)e
Fp(127b.)-33 1376 y(122b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(do_gsubst)f Fp(121a)p Fo(i)o Fv(+)p Fo(\021)548 b
Fp(\(120a\))22 b Fm(/)5 b Fp(122a)22 b(123a)5 b Fm(.)171
1426 y Fr("patlabel")172 b(:)22 b(e)171 1476 y("latent_patlabel")c(:)k
(if)f(\(x)h(:=)f(do_gsubst\(e.insta)o(nce,)d(f,)k(closure\)\))e(===)h
(e.instance)f(then)h(e)607 1526 y(else)g(latent_patlabel\()o(x\))171
1576 y("dots_sequent")e(:)i(e)171 1625 y("constraint")63
b(:)21 b(e)171 1675 y("fieldbinding")e(:)i(if)h(\(x)f(:=)h
(do_gsubst\(e.cod)o(e,)d(f,)i(closure\)\))f(===)h(e.code)g(then)g(e)541
1725 y(else)g(fieldbinding\(e.fiel)o(d,)e(x\))171 1775
y("absolute_field")f(:)k(e)129 1827 y Fp(Uses)13 b Fl(absolute_fi)o
(eld)c Fp(268,)j Fl(constraint)d Fp(55,)j Fl(do_gsubst)e
Fp(120a,)h Fl(dots_seque)o(nt)f Fp(62c,)h Fl(field)g
Fp(55,)171 1866 y Fl(fieldbindi)o(ng)d Fp(55,)j Fl(latent_patl)o(abe)o
(l)e Fp(55,)i(and)f Fl(patlabel)f Fp(55.)p eop
%%Page: 123 123
123 122 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(expwalk.nw)81 b Fv(123)-15 258 y Fp(123a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(do_gsubst)f Fp(121a)p Fo(i)o
Fv(+)p Fo(\021)544 b Fp(\(120a\))22 b Fm(/)5 b Fp(122b)22
b(123b)5 b Fm(.)187 307 y Fr("list")151 b(:)22 b(if)f(lists_match\(l)e
(:=)j(maplistn\(do_gsu)o(bst,)c(e,)k([f,)f(closure]\),)f(e\))h(then)g
(e)h(else)f(l)187 357 y("eqn")173 b(:)22 b(if)f(l)h(:=)f
(do_gsubst\(e.left,)d(f,)k(closure\))e(&)579 407 y(r)i(:=)f
(do_gsubst\(e.right,)d(f,)j(closure\))g(&)579 457 y(l)h(===)f(e.left)f
(&)i(r)g(===)f(e.right)f(then)h(e)h(else)f(eqn\(l,)f(e.op,)h(r\))187
507 y("table")129 b(:)22 b(if)f(\(t)g(:=)h(do_gsubst_sumprod)o(_tab)o
(le\(e,)c(f,)k(closure\)\))e(===)h(e)g(then)g(e)h(else)f(t)187
557 y("set")173 b(:)22 b({s)f(:=)g(set\(\))535 606 y(every)g
(insert\(s,)f(do_gsubst\(!e,)f(f,)j(closure\)\))535 656
y(if)g(x)f(:=)h(!s)f(&)h(not)f(member\(e,)f(x\))h(then)g(s)h(else)f(e)
514 706 y(})187 756 y("string")107 b(:)22 b(e)187 806
y("literal")85 b(:)22 b(e)187 855 y("integer")85 b(:)22
b(e)187 905 y("null")151 b(:)22 b(e)145 957 y Fp(Uses)15
b Fl(do_gsubst)c Fp(120a,)h Fl(do_gsubst_su)o(mp)o(rod)o(_ta)o(ble)f
Fp(126b,)h Fl(eqn)i Fp(83c,)f Fl(lists_mat)o(ch)e Fp(127a,)187
997 y Fl(literal)e Fp(45e,)i(and)f Fl(maplistn)f Fp(120b.)-17
1088 y(123b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_gsubst)f
Fp(121a)p Fo(i)o Fv(+)p Fo(\021)548 b Fp(\(120a\))22
b Fm(/)5 b Fp(123a)22 b(124a)5 b Fm(.)187 1138 y Fr("Eorb")151
b(:)22 b(if)f(x)h(:=)f(do_gsubst\(e.x,)e(f,)i(closure\))f(&)i(y)g(:=)f
(do_gsubst\(e.y,)e(f,)i(closure\))f(&)579 1187 y(x)i(===)f(e.x)g(&)h(y)
f(===)g(e.y)h(then)e(e)i(else)f(Eorb\(x,)f(y\))187 1237
y("Eand")151 b(:)22 b(if)f(x)h(:=)f(do_gsubst\(e.x,)e(f,)i(closure\))f
(&)i(y)g(:=)f(do_gsubst\(e.y,)e(f,)i(closure\))f(&)579
1287 y(x)i(===)f(e.x)g(&)h(y)f(===)g(e.y)h(then)e(e)i(else)f(Eand\(x,)f
(y\))187 1337 y("Eslice")107 b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d
(f,)i(closure\)\))f(===)h(e.x)g(then)g(e)514 1387 y(else)g(Eslice\(x,)f
(e.lo,)g(e.n\))187 1437 y("Eshift")107 b(:)22 b(if)f(\(x)g(:=)h
(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h(e.x)g(then)g(e)h(else)f
(Eshift\(x,)f(e.n\))187 1486 y("Enarrowu")63 b(:)22 b(if)f(\(x)g(:=)h
(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h(e.x)g(then)g(e)h(else)f
(Enarrowu\(x,)e(e.n\))187 1536 y("Enarrows")63 b(:)22
b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h(e.x)g
(then)g(e)h(else)f(Enarrows\(x,)e(e.n\))187 1586 y("Ewiden")107
b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h
(e.x)g(then)g(e)h(else)f(Ewiden\(x,)f(e.n\))187 1636
y("Ediv")151 b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i
(closure\)\))f(===)h(e.x)g(then)g(e)h(else)f(Ediv\(x,)f(e.n\))187
1686 y("Emod")151 b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i
(closure\)\))f(===)h(e.x)g(then)g(e)h(else)f(Emod\(x,)f(e.n\))187
1735 y("Efitsu")107 b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i
(closure\)\))f(===)h(e.x)g(then)g(e)h(else)f(Efitsu\(x,)f(e.n\))187
1785 y("Efitss")107 b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i
(closure\)\))f(===)h(e.x)g(then)g(e)h(else)f(Efitss\(x,)f(e.n\))187
1835 y("Epatlabel")41 b(:)22 b(if)f(\(l)g(:=)h(do_gsubst\(e.l,)d(f,)i
(closure\)\))f(===)h(e.l)g(then)g(e)h(else)f(Epatlabel\(l\))187
1885 y("Eforce")107 b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i
(closure\)\))f(===)h(e.x)g(then)g(e)h(else)f(Eforce\(x\))187
1935 y("Eforceable")e(:)j(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i
(closure\)\))f(===)h(e.x)g(then)g(e)h(else)f(Eforceable\(x\))187
1985 y("Epc")g(|)g("Epc_known")f(:)h(e)187 2034 y("Enot")151
b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h
(e.x)g(then)g(e)h(else)f(Enot\(x\))187 2084 y("Enosimp")85
b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h
(e.x)g(then)g(e)h(else)f(Enosimp\(x\))187 2134 y("Sstmts")107
b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h
(e.x)g(then)g(e)h(else)f(Sstmts\(x\))187 2184 y("Semit")129
b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h
(e.x)g(then)g(e)h(else)f(Semit\(x\))187 2234 y("Stoken")107
b(:)22 b(if)f(\(x)g(:=)h(do_gsubst\(e.x,)d(f,)i(closure\)\))f(===)h
(e.x)g(then)g(e)514 2283 y(else)g(Stoken\(x,)f(e.n,)h(e.offset\))145
2335 y Fp(Uses)13 b Fl(do_gsubst)c Fp(120a,)i Fl(Eand)g
Fp(81,)h Fl(Ediv)f Fp(81,)h Fl(Efitss)e Fp(81,)i Fl(Efitsu)e
Fp(81,)i Fl(Eforce)e Fp(81,)i Fl(Eforceable)d Fp(81,)187
2375 y Fl(Emod)h Fp(81,)i Fl(Enarrows)d Fp(81,)i Fl(Enarrowu)e
Fp(81,)j Fl(Enosimp)d Fp(81,)j Fl(Enot)e Fp(81,)h Fl(Eorb)g
Fp(81,)g Fl(Epatlabel)e Fp(81,)i Fl(Epc)h Fp(81,)187
2414 y Fl(Epc_known)c Fp(81,)j Fl(Eshift)f Fp(81,)h Fl(Eslice)e
Fp(81,)i Fl(Ewiden)f Fp(81,)h Fl(Semit)f Fp(81,)g Fl(Sstmts)g
Fp(81,)h(and)f Fl(Stoken)g Fp(81.)p eop
%%Page: 124 124
124 123 bop 129 141 a Fv(124)83 b Fr(expwalk.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(124a)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_gsubst)f Fp(121a)p
Fo(i)o Fv(+)p Fo(\021)544 b Fp(\(120a\))22 b Fm(/)5 b
Fp(123b)23 b(124b)t Fm(.)171 307 y Fr("Einstance")41
b(:)j(e)21 b(#)h(suppress)e(warning)g(---)h(will)g(confuse)g(users)563
357 y(#)h(---)f(and)g(we)h(do)f(this)g(with)g(eliminate_instanc)o(es)e
(now)563 407 y(#)j({)f(warning\("escaping)e(Einstance:)g(",)j
(expimage\(e\)\);)d(e})171 457 y("Ebinding_instanc)o(e")g(:)i(e)171
507 y("Einstance_input")d(:)215 557 y(if)j(\(x)g(:=)h(do_gsubst\(e.x,)d
(f,)i(closure\)\))f(===)h(e.x)g(then)g(e)215 606 y(else)g
(Einstance_input)o(\(x,)e(e.cons,)h(e.name\))171 656
y("Einstance_tagged)o(")f(:)215 706 y(if)i(\(x)g(:=)h(do_gsubst\(e.x,)d
(f,)i(closure\)\))f(===)h(e.x)g(then)g(e)215 756 y(else)g
(Einstance_tagge)o(d\(x,)d(e.cons,)j(e.uid\))129 808
y Fp(Uses)15 b Fl(do_gsubst)c Fp(120a,)i Fl(Ebinding_ins)o(ta)o(nce)e
Fp(81,)j Fl(Einstance)d Fp(81,)j Fl(Einstance_)o(inp)o(ut)d
Fp(81,)171 847 y Fl(Einstance_)o(tag)o(ged)d Fp(81,)j
Fl(eliminate_)o(ins)o(ta)o(nce)o(s)e Fp(178a,)h(and)h
Fl(expimage)d Fp(101a.)-33 938 y(124b)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(do_gsubst)f Fp(121a)p Fo(i)o Fv(+)p Fo(\021)550
b Fp(\(120a\))22 b Fm(/)5 b Fp(124a)22 b(124c)5 b Fm(.)171
988 y Fr("Eapp")42 b(:)215 1038 y(if)21 b(\(args)g(:=)g
(do_gsubst\(e.args,)d(f,)k(closure\)\))e(===)h(e.args)f(then)h(e)h
(else)f(Eapp\(e.f,)f(args\))171 1088 y("Eclosure_loc")41
b(:)21 b(e)171 1138 y("Eclosure_addr")e(:)i(e)171 1187
y("Eclosure_val")41 b(:)21 b(e)129 1239 y Fp(Uses)12
b Fl(do_gsubst)d Fp(120a,)h Fl(Eapp)g Fp(81,)h Fl(Eclosure_a)o(ddr)d
Fp(81,)j Fl(Eclosure_l)o(oc)d Fp(81,)j(and)g Fl(Eclosure_v)o(al)d
Fp(81.)-29 1331 y(124c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(do_gsubst)f Fp(121a)p Fo(i)o Fv(+)p Fo(\021)546 b
Fp(\(120a\))22 b Fm(/)5 b Fp(124b)22 b(125a)5 b Fm(.)171
1381 y Fr("Sif")130 b(:)21 b(if)h(\(arms)e(:=)i(do_gsubst\(e.arms)o(,)d
(f,)i(closure\)\))f(===)i(e.arms)e(then)h(e)454 1430
y(else)g(Sif\(arms\))171 1480 y("Sguarded")f(:)h(if)h(\(guard)e(:=)i
(do_gsubst\(e.gua)o(rd,)d(f,)i(closure\),)541 1530 y(x)h(:=)f
(do_gsubst\(e.x,)e(f,)j(closure\),)541 1580 y(guard)f(===)g(e.guard,)g
(x)g(===)g(e.x\))g(then)g(e)454 1630 y(else)g(Sguarded\(guard,)e(x\))
171 1679 y("Sepsilon")h(:)h(e)171 1729 y("Sfail")f(:)i(e)171
1779 y("Stagcase")e(:)h(if)h(\(arms)e(:=)i(do_gsubst_vals\(e)o(.arms)o
(,)d(f,)i(closure\),)541 1829 y(x)h(:=)f(do_gsubst\(e.x,)e(f,)j
(closure\),)541 1879 y(arms)f(===)h(e.arms,)e(x)i(===)f(e.x\))g(then)g
(e)454 1928 y(else)g({)171 1978 y(write\(&errout,)e("TAGCASE:)h(",)h
(expimage\(e.x\)\))171 2028 y(write\(&errout,)e("TAGCASE:)h(",)h
(expimage\(e.arms\)\))171 2078 y(write\(&errout,)e("TAGCASE:)h(",)h
(expimage\(x\)\))171 2128 y(write\(&errout,)e("TAGCASE:)h(",)h
(expimage\(arms\)\))454 2178 y(Stagcase\(x,)f(e.type,)g(arms\))171
2227 y(})171 2277 y("Efail")86 b(:)21 b(e)129 2329 y
Fp(Uses)14 b Fl(do_gsubst)9 b Fp(120a,)j Fl(Efail)f Fp(81,)i
Fl(expimage)d Fp(101a,)h Fl(Sepsilon)g Fp(81,)h Fl(Sfail)f
Fp(188c,)h Fl(Sguarded)e Fp(81,)171 2368 y Fl(Sif)h Fp(81,)f(and)h
Fl(Stagcase)e Fp(183a.)p eop
%%Page: 125 125
125 124 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(expwalk.nw)81 b Fv(125)-15 258 y Fp(125a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(do_gsubst)f Fp(121a)p Fo(i)o
Fv(+)p Fo(\021)548 b Fp(\(120a\))22 b Fm(/)5 b Fp(124c)22
b(125b)5 b Fm(.)187 307 y Fr("balance")42 b(:)21 b(if)g(l)h(:=)f
(do_gsubst\(e.left,)e(f,)i(closure\))f(&)535 357 y(r)i(:=)f
(do_gsubst\(e.right,)e(f,)i(closure\))f(&)535 407 y(l)i(===)f(e.left)g
(&)g(r)h(===)f(e.right)f(then)h(e)h(else)f(balance\(l,)f(r\))187
457 y("balitem")42 b(:)21 b(if)g(l)h(:=)f(do_gsubst\(e.v,)e(f,)j
(closure\))e(&)535 507 y(r)i(:=)f(do_gsubst\(e.value,)e(f,)i(closure\))
f(&)535 557 y(l)i(===)f(e.v)g(&)h(r)g(===)f(e.value)f(then)h(e)h(else)f
(balitem\(l,)e(r\))145 608 y Fp(Uses)12 b Fl(balance)d
Fp(141a,)h Fl(balitem)g Fp(141a,)g Fl(do_gsubst)e Fp(120a,)i(and)h
Fl(value)f Fp(136a.)-17 700 y(125b)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(do_gsubst)f Fp(121a)p Fo(i)o Fv(+)p Fo(\021)550
b Fp(\(120a\))22 b Fm(/)5 b Fp(125a)22 b(125c)5 b Fm(.)187
750 y Fr("Glines")85 b(:)22 b(e)187 799 y("Gresynch")41
b(:)22 b(e)187 849 y("Gblock")85 b(:)22 b(if)f(\(decls)g(:=)g
(do_gsubst\(e.decls,)d(f,)k(closure\),)579 899 y(stmts)f(:=)g
(do_gsubst\(e.stmts,)d(f,)k(closure\),)579 949 y(decls)f(===)g
(e.decls,)f(stmts)h(===)g(e.stmts\))f(then)h(e)492 999
y(else)g(Gblock\(decls,)e(stmts\))187 1048 y("Gdecl")107
b(:)22 b(if)f(\(init)g(:=)g(do_gsubst\(e.init,)e(f,)i(closure\)\))f
(===)h(e.init)g(then)g(e)492 1098 y(else)g(Gdecl\(e.name,)e(e.type,)h
(init\))187 1148 y("Gcase")107 b(:)22 b(if)f(\(x)h(:=)f
(do_gsubst\(e.x,)e(f,)i(closure\),)f(arms)h(:=)h(do_gsubst\(e.arm)o(s,)
d(f,)i(closure\),)579 1198 y(x)h(===)f(e.x,)g(arms)g(===)g(e.arms\))f
(then)h(e)492 1248 y(else)g(Gcase\(x,)f(arms\))187 1297
y("Gcasearm")41 b(:)22 b(if)f(\(x)h(:=)f(do_gsubst\(e.x,)e(f,)i
(closure\)\))f(===)h(e.x)h(then)f(e)492 1347 y(else)g
(Gcasearm\(e.tags,)d(x\))187 1397 y("Ginrange")41 b(:)22
b(if)f(\(x)h(:=)f(do_gsubst\(e.x,)e(f,)i(closure\)\))f(===)h(e.x)h
(then)f(e)492 1447 y(else)g(Ginrange\(e.lo,)e(x,)i(e.hi\))187
1497 y("Gsetname")41 b(:)22 b(e)187 1547 y("Gnomatch")41
b(:)22 b(e)187 1596 y("Gasgn")107 b(:)22 b(if)f(\(x)h(:=)f
(do_gsubst\(e.x,)e(f,)i(closure\)\))f(===)h(e.x)h(then)f(e)492
1646 y(else)g(Gasgn\(e.lhs,)e(x\))187 1696 y("Tunsigned")g(:)j(e)187
1746 y("Gcomment")41 b(:)22 b(e)187 1796 y("Gcommented":)d(if)i(\(x)h
(:=)f(do_gsubst\(e.e,)e(f,)i(closure\)\))f(===)h(e.e)h(then)f(e)492
1845 y(else)g(Gcommented\(x,)e(e.comment\))145 1897 y
Fp(Uses)13 b Fl(do_gsubst)c Fp(120a,)i Fl(Gasgn)g Fp(294a,)g
Fl(Gblock)f Fp(293a,)h Fl(Gcase)g Fp(294a,)g Fl(Gcasearm)f
Fp(294a,)h Fl(Gcomment)e Fp(20,)187 1937 y Fl(Gcommented)e
Fp(299a,)h Fl(Gdecl)h Fp(293a,)g Fl(Ginrange)e Fp(294a,)i
Fl(Glines)f Fp(293a,)h Fl(Gnomatch)f Fp(294a,)g Fl(Gresynch)g
Fp(293a,)187 1976 y Fl(Gsetname)h Fp(294a,)h(and)g Fl(Tunsigned)f
Fp(294a.)-13 2068 y(125c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(do_gsubst)f Fp(121a)p Fo(i)o Fv(+)p Fo(\021)546 b
Fp(\(120a\))22 b Fm(/)5 b Fp(125b)22 b(126a)5 b Fm(.)187
2117 y Fr("inject")85 b(:)22 b(if)f(\(p)h(:=)f(do_gsubst\(\\e.patte)o
(rn,)d(f,)k(closure\))e(|)i(&null,)579 2167 y(i)g(:=)f
(do_gsubst\(\\e.integ)o(er,)d(f,)k(closure\))e(|)i(&null,)579
2217 y(p)g(===)f(e.pattern,)f(i)h(===)g(e.integer\))f(then)h(e)492
2267 y(else)g(inject\(p,)f(i,)h(e.consop\))145 2319 y
Fp(Uses)12 b Fl(do_gsubst)d Fp(120a,)h Fl(inject)f Fp(29,)i(and)g
Fl(pattern)e Fp(55.)p eop
%%Page: 126 126
126 125 bop 129 141 a Fv(126)83 b Fr(expwalk.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(126a)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(do_gsubst)f Fp(121a)p
Fo(i)o Fv(+)p Fo(\021)668 b Fp(\(120a\))21 b Fm(/)6 b
Fp(125c)171 307 y Fr("Eclosure")20 b(:)h(if)h(\(v)f(:=)g
(do_gsubst\(e.values,)d(f,)k(closure\),)541 357 y(a)g(:=)f
(do_gsubst\(e.address)o(es,)e(f,)i(closure\),)541 407
y(v)h(===)f(e.values,)f(a)i(===)f(e.addresses\))454 457
y(then)g(e)454 507 y(else)g(Eclosure\(e.ty,)e(e.fun,)i(e.headertype,)e
(v,)i(a\))171 557 y("Elambda")42 b(:)21 b(if)h(\(x)f(:=)g
(do_gsubst\(e.body,)e(f,)i(closure\)\))f(===)h(e.body)g(then)g(e)454
606 y(else)g(Elambda\(e.formals,)d(x\))129 657 y Fp(Uses)12
b Fl(do_gsubst)d Fp(120a,)h Fl(Eclosure)f Fp(218,)h(and)h
Fl(Elambda)e Fp(217.)192 726 y Fv(Making)16 b(a)i(new)g(\\sum)f(of)g
(pro)q(ducts")h(table)g(in)o(v)o(olv)o(es)f(substituting)h(all)e(the)j
(k)o(eys.)129 775 y(The)14 b(only)e(tric)o(k)h(comes)f(in)h(when)g(one)
g(of)g(the)g(new)g(k)o(eys)h(is)e(itself)h(a)g(table.)k(In)c(that)g
(case,)129 825 y(w)o(e)i(ha)o(v)o(e)f(a)g(sum)f(of)h(terms)g(in)f(whic)
o(h)i(one)f(of)g(the)g(terms)g(is)g(itself)g(a)g(sum)f(of)h(terms,)g
(and)129 875 y(b)o(y)g(distributing)g(the)g(outer)h(co)q(e\016cien)o(t)
g(o)o(v)o(er)f(the)g(inner)h(terms,)e(w)o(e)h(can)g(wind)g(up)g(with)
129 925 y(a)f(single)g(sum)e(\(that)i(is,)g(a)g(single)f(table\).)18
b(Using)12 b Fr(+:=)h Fv(to)f(assign)h(the)h(co)q(e\016cien)o(ts)g(mak)
o(es)129 975 y(it)g(all)f(w)o(ork)g(lik)o(e)g(magic,)f(ev)o(en)i(when)h
(substitution)f(causes)h(duplicate)f(k)o(eys.)-33 1036
y Fp(126b)88 b Fo(h)p Fn(*)16 b Fp(117a)p Fo(i)n Fv(+)q
Fo(\021)1017 b Fm(/)5 b Fp(121b)22 b(126c)5 b Fm(.)171
1086 y Fr(procedure)20 b(do_gsubst_sumprod)o(_tabl)o(e\(e,)e(f,)k
(closure\))215 1136 y(t)f(:=)h(table\(0\))215 1185 y(every)e(k)i(:=)f
(key\(e\))g(&)g(kk)h(:=)f(do_gsubst\(k,)e(f,)j(closure\))e(do)258
1235 y(add_to_table\(t,)f(kk,)i(e[k]\))215 1285 y(every)f(k)i(:=)f
(key\(t\))g(&)g(t[k])g(=)h(0)g(do)f(delete\(t,)f(k\))h(#)h(delete)e
(zeroes)215 1335 y(return)g(if)h(tables_match\(e,)e(t\))j(then)f(e)g
(else)g(t)171 1385 y(end)129 1436 y Fp(De\014nes:)171
1475 y Fl(do_gsubst_)o(sum)o(pro)o(d_t)o(ab)o(le)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(123a.)129 1514 y(Uses)i Fl(add_to_tabl)o(e)
d Fp(126d,)h Fl(do_gsubst)e Fp(120a,)i Fl(tables_matc)o(h)f
Fp(127c,)h(and)h Fl(zeroes)e Fp(136a.)-29 1594 y(126c)88
b Fo(h)p Fn(*)16 b Fp(117a)p Fo(i)n Fv(+)q Fo(\021)1013
b Fm(/)5 b Fp(126b)23 b(126d)t Fm(.)171 1644 y Fr(procedure)d
(insert_condition\()o(s,)f(c\))215 1694 y(if)i(c)h(~===)e(1)i(&)g(not)f
(exps_eq\(c,)f(!s\))h(then)g(insert\(s,)f(c\))215 1744
y(return)g(s)171 1794 y(end)129 1844 y Fp(De\014nes:)171
1884 y Fl(insert_con)o(dit)o(ion)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d
(70c,)i(80a,)f(121b,)g(122a,)h(197{200,)e(264,)h(and)h(300.)129
1923 y(Uses)h Fl(exps_eq)d Fp(84c.)-33 2010 y(126d)88
b Fo(h)p Fn(*)16 b Fp(117a)p Fo(i)n Fv(+)q Fo(\021)1019
b Fm(/)5 b Fp(126c)22 b(127a)5 b Fm(.)171 2060 y Fr(procedure)20
b(add_to_table\(t,)f(k,)i(multiplier\))215 2110 y(case)g(type\(k\))f
(of)h({)258 2160 y("table")64 b(:)22 b(every)e(v)i(:=)f(key\(k\))g(do)g
(t[v])g(+:=)g(k[v])g(*)h(multiplier)258 2210 y("integer")e(:)i(t[1])f
(+:=)g(k)g(*)h(multiplier)258 2260 y(default)64 b(:)22
b(t[k])f(+:=)g(multiplier)215 2309 y(})215 2359 y(return)f(t)171
2409 y(end)129 2460 y Fp(De\014nes:)171 2499 y Fl(add_to_tab)o(le)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(95b)g(and)h(126b.)p
eop
%%Page: 127 127
127 126 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(expwalk.nw)81 b Fv(127)-15 258 y Fp(127a)88 b Fo(h)p
Fn(*)15 b Fp(117a)p Fo(i)o Fv(+)p Fo(\021)1014 b Fm(/)5
b Fp(126d)22 b(127b)5 b Fm(.)187 307 y Fr(procedure)20
b(lists_match\(l1,)e(l2\))230 357 y(if)k(n)f(:=)h(*l1)f(=)g(*l2)h(then)
274 407 y(if)f(l1[i)g(:=)h(1)f(to)h(n])f(~===)g(l2[i])g(then)g(fail)274
457 y(else)g(return)f(l2)230 507 y(else)h(fail)187 557
y(end)145 608 y Fp(De\014nes:)187 648 y Fl(lists_matc)o(h)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(93,)h(94a,)f(96a,)h(and)f(121{23.)
145 687 y(Uses)i Fl(fail)e Fp(410.)-17 779 y(127b)88
b Fo(h)p Fn(*)15 b Fp(117a)p Fo(i)o Fv(+)p Fo(\021)1020
b Fm(/)5 b Fp(127a)22 b(127c)5 b Fm(.)187 828 y Fr(procedure)20
b(sets_match\(s1,)f(s2\))230 878 y(if)j(n)f(:=)h(*s1)f(=)g(*s2)h(then)f
({)274 928 y(s)h(:=)f(set\(\))274 978 y(every)g(insert\(s,)f
(expimage\(!s1)f(|)j(!s2\)\))274 1028 y(if)f(*s)h(=)f(n)h(then)f
(return)f(s1)i(else)f(fail)230 1077 y(})h(else)f(fail)187
1127 y(end)145 1179 y Fp(De\014nes:)187 1219 y Fl(sets_match)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(94c,)i(121b,)f(and)h(122a.)145
1258 y(Uses)h Fl(expimage)d Fp(101a)h(and)h Fl(fail)f
Fp(410.)-13 1349 y(127c)88 b Fo(h)p Fn(*)15 b Fp(117a)p
Fo(i)o Fv(+)p Fo(\021)1133 b Fm(/)6 b Fp(127b)187 1399
y Fr(procedure)20 b(tables_match\(t1,)e(t2\))230 1449
y(if)k(k)f(:=)h(key\(t1)e(|)i(t2\))f(&)h(t1[k])e(~=)i(t2[k])f(then)f
(fail)h(else)g(return)g(t1)187 1499 y(end)145 1551 y
Fp(De\014nes:)187 1590 y Fl(tables_mat)o(ch)p Fp(,)8
b(used)j(in)g(c)o(h)o(unks)f(95b)g(and)h(126b.)145 1630
y(Uses)h Fl(fail)e Fp(410.)p eop
%%Page: 128 128
128 127 bop 129 141 a Fv(128)83 b Fr(expps.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)129 258 y Fj(5.10)66 b(Mapping)24
b(expressions)e(to)g(p)r(ost\014x)h(strings)129 349 y
Fv(The)17 b(idea)g(is)f(to)g(get)h(a)f(p)q(ost\014x,)h(executable)h
(represen)o(tation)g(of)e(function)g(b)q(o)q(dies.)26
b(As)129 398 y(with)16 b Fr(expuniq)p Fv(,)e(w)o(e)h(try)h(to)g(ensure)
h(t)o(w)o(o)e(represen)o(tations)i(of)e(the)h(same)f(function)g(map)129
448 y(to)f(the)h(same)e(string.)-31 510 y Fp(128a)88
b Fo(h)p Fn(*)16 b Fp(128a)p Fo(i)n(\021)1166 b Fp(129b)t
Fm(.)171 560 y Fr(procedure)20 b(expps\(e\))215 610 y(local)g
(leadingsign,)g(prefix)215 660 y(static)g(psopstab)215
710 y(initial)g({)p Fo(h)p Fn(init)14 b Fp(128c)p Fo(i)o
Fr(})215 760 y(return)20 b(case)h(type\(e\))f(of)i({)258
809 y Fo(h)p Fn(c)n(ases)15 b(for)g Fr(expps)e Fp(128b)p
Fo(i)258 859 y Fr(default)86 b(:)21 b(&fail)215 909 y(})g(|)h
(impossible\("post)o(fix)d(expression)g(",)j(image\(e\),)e(")h(:)h(",)f
(type\(e\)\))171 959 y(end)129 1011 y Fp(De\014nes:)171
1050 y Fl(expps)p Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(128{33)g(and)h
(227a.)129 1090 y(Uses)h Fl(fail)e Fp(410)h(and)g Fl(postfix)e
Fp(16f.)-33 1173 y(128b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(expps)g Fp(128b)p Fo(i)n(\021)782 b Fp(\(128a\))22
b(128d)t Fm(.)171 1222 y Fr("list")108 b(:)21 b("[")g(||)h
(commaseparate\(map)o(list)o(\(expp)o(s,)d(e\),)i(")h("\))f(||)g("]")
171 1272 y("set")130 b(:)21 b("[")g(||)h(commaseparate\(sor)o(t\(ma)o
(plist)o(\(expp)o(s,)d(sort\(e\)\)\),)h(","\))g(||)i("])f(set")171
1322 y("eqn")130 b(:)21 b(expps\(e.left\))e(||)j(")f(")h(||)f
(expps\(e.right\))e(||)j(")f(")h(||)f(\\psopstab[e.op])129
1374 y Fp(Uses)12 b Fl(eqn)f Fp(83c)g(and)f Fl(expps)g
Fp(128a.)-29 1465 y(128c)88 b Fo(h)p Fn(init)15 b Fp(128c)p
Fo(i)o(\021)1124 b Fp(\(128a\))171 1515 y Fr(psopstab)20
b(:=)h(table\(\))171 1565 y(psopstab["<"])41 b(:=)21
b("lt")171 1615 y(psopstab["<="])e(:=)i("le")171 1664
y(psopstab[">"])41 b(:=)21 b("gt")171 1714 y(psopstab[">="])e(:=)i
("ge")171 1764 y(psopstab["!="])e(:=)i("ne")171 1814
y(psopstab["="])41 b(:=)21 b("eq")-33 1905 y Fp(128d)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p
Fo(i)n Fv(+)q Fo(\021)631 b Fp(\(128a\))22 b Fm(/)5 b
Fp(128b)22 b(130a)5 b Fm(.)171 1955 y Fr("table")86 b(:)21
b({)480 b(#)21 b(standard)f(normal)h(form)258 2005 y
Fo(h)p Fn(make)15 b Fr(s)g Fn(r)n(epr)n(esent)f(table)h
Fr(e)g Fp(129a)p Fo(i)258 2055 y Fr(s)215 2104 y(})171
2154 y("string")64 b(:)21 b(e)171 2204 y("literal")42
b(:)21 b(image\(e.s\))f(||)h(")h(lit")171 2254 y("integer")42
b(:)21 b(string\(e\))171 2304 y("null")108 b(:)21 b("null")129
2356 y Fp(Uses)12 b Fl(literal)d Fp(45e.)p eop
%%Page: 129 129
129 128 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(expps.nw)81 b Fv(129)208 258 y(Be)20 b(sure)h(to)e(omit)f(m)o
(ultiplicativ)n(e)g(and)h(additiv)o(e)g(units.)35 b(Otherwise,)23
b(it)c(do)q(esn't)145 307 y(matter.)-15 370 y Fp(129a)88
b Fo(h)p Fn(make)16 b Fr(s)e Fn(r)n(epr)n(esent)g(table)h
Fr(e)g Fp(129a)p Fo(i)o(\021)738 b Fp(\(128d\))187 420
y Fr({)230 469 y(s)22 b(:=)f("";)h(firstterm)d(:=)j(1)230
519 y(t)g(:=)f(table\(0\))230 569 y(l)h(:=)f([])230 619
y(every)g(e[k)g(:=)h(key\(e\)])e(do)h({)274 669 y(put\(l,)g(x)g(:=)g
(expps\(k\)\))274 718 y(t[x])g(+:=)g(e[k])230 768 y(})230
818 y(l)h(:=)f(sort\(l\))230 868 y(every)g(x)h(:=)f(!l)g(&)h(t[x])f(~=)
g(0)h(do)f({)274 918 y(if)g(\\firstterm)f(then)318 967
y(s)h(||:=)g(psx\(x,)g(t[x]\))274 1017 y(else)318 1067
y(s)g(||:=)g(")h(")f(||)h(psabs\(x,)e(t[x]\))h(||)g(")h(")f(||)g(if)h
(t[x])f(>)g(0)h(then)f("add")g(else)g("sub")274 1117
y(firstterm)f(:=)h(&null)230 1167 y(})230 1217 y(if)h(s)f(==)h("")f
(then)g(s)h(:=)f("0")187 1266 y(})145 1318 y Fp(Uses)12
b Fl(expps)e Fp(128a,)g Fl(psabs)g Fp(129b,)g(and)h Fl(psx)f
Fp(129b.)-17 1401 y(129b)88 b Fo(h)p Fn(*)15 b Fp(128a)p
Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5 b Fp(128a)22 b(132a)5
b Fm(.)187 1451 y Fr(procedure)20 b(psabs\(x,)g(mul\))230
1501 y(return)h(if)g(x)h(==)f("1")g(then)g(mul)383 1551
y(else)g(if)g(abs\(mul\))f(=)i(1)g(then)f(x)383 1601
y(else)g(x)g(||)h(")f(")h(||)f(abs\(mul\))g(||)g(")h(mul")187
1650 y(end)187 1700 y(procedure)e(psx\(x,)g(mul\))230
1750 y(return)h(if)g(x)h(==)f("1")g(then)g(mul)383 1800
y(else)g(case)g(mul)g(of)g({)448 1850 y(1)h(:)f(x)427
1899 y(-1)g(:)g(x)h(||)f(")h(neg")427 1949 y(default)e(:)h(x)h(||)f(")h
(")g(||)f(mul)g(||)h(")f(mul")383 1999 y(})187 2049 y(end)145
2101 y Fp(De\014nes:)187 2140 y Fl(psabs)p Fp(,)10 b(used)g(in)h(c)o(h)
o(unk)f(129a.)187 2180 y Fl(psx)p Fp(,)g(used)h(in)g(c)o(h)o(unk)f
(129a.)p eop
%%Page: 130 130
130 129 bop 129 141 a Fv(130)83 b Fr(expps.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(130a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q Fo(\021)629
b Fp(\(128a\))22 b Fm(/)5 b Fp(128d)23 b(130b)t Fm(.)171
307 y Fr("Eorb")108 b(:)21 b({)h(l)f(:=)h(sort\(maplist\(expp)o(s,)d
(flatten\(e,)g(type\(e\)\)\)\))498 357 y(s)i(:=)h(l[1])498
407 y(every)f(s)g(||:=)g(")h(")f(||)h(l[2)f(to)g(*l])g(||)h(")f(orb")
498 457 y(s)454 507 y(})171 557 y("Eand")108 b(:)21 b({)h(l)f(:=)h
(sort\(maplist\(expp)o(s,)d(flatten\(e,)g(type\(e\)\)\)\))498
606 y(s)i(:=)h(l[1])498 656 y(every)f(s)g(||:=)g(")h(")f(||)h(l[2)f(to)
g(*l])g(||)h(")f(and")498 706 y(s)454 756 y(})129 805
y Fp(Uses)12 b Fl(Eand)e Fp(81,)h Fl(Eorb)g Fp(81,)g
Fl(expps)e Fp(128a,)i(and)f Fl(flatten)f Fp(116c.)-33
884 y(130b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g
Fp(128b)p Fo(i)n Fv(+)q Fo(\021)635 b Fp(\(128a\))22
b Fm(/)5 b Fp(130a)22 b(130c)5 b Fm(.)171 934 y Fr("Eslice")64
b(:)21 b(expps\(e.x\))f(||)h(")h(")g(||)f(e.lo)g(||)g(")h(")f(||)h
(\(e.lo)f(+)g(e.n)g(-)h(1\))f(||)h(")f(bitslice")171
984 y("Eshift")64 b(:)21 b(expps\(e.x\))f(||)h(")h(")g(||)f(e.n)g(||)g
(")h(bitshift")129 1033 y Fp(Uses)12 b Fl(Eshift)e Fp(81,)h
Fl(Eslice)e Fp(81,)i(and)g Fl(expps)f Fp(128a.)-29 1112
y(130c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g
Fp(128b)p Fo(i)n Fv(+)q Fo(\021)629 b Fp(\(128a\))22
b Fm(/)5 b Fp(130b)23 b(130d)t Fm(.)171 1162 y Fr("Enarrowu")d(:)h
(expps\(e.x\))f(||)h(")h(")g(||)f(e.n)g(||)g(")h(narrowu")171
1211 y("Enarrows")e(:)h(expps\(e.x\))f(||)h(")h(")g(||)f(e.n)g(||)g(")h
(narrows")171 1261 y("Ewiden")64 b(:)21 b(expps\(e.x\))f(||)h(")h(")g
(||)f(e.n)g(||)g(")h(widen")129 1310 y Fp(Uses)12 b Fl(Enarrows)d
Fp(81,)i Fl(Enarrowu)e Fp(81,)i Fl(Ewiden)e Fp(81,)i(and)g
Fl(expps)f Fp(128a.)-33 1390 y(130d)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q Fo(\021)637
b Fp(\(128a\))22 b Fm(/)5 b Fp(130c)22 b(130e)5 b Fm(.)171
1439 y Fr("Ediv")108 b(:)21 b(expps\(e.x\))f(||)h(")h(")g(||)f(e.n)g
(||)g(")h(idiv")171 1489 y("Emod")108 b(:)21 b(expps\(e.x\))f(||)h(")h
(")g(||)f(e.n)g(||)g(")h(mod")129 1538 y Fp(Uses)12 b
Fl(Ediv)e Fp(81,)h Fl(Emod)g Fp(81,)g(and)f Fl(expps)g
Fp(128a.)-29 1617 y(130e)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q Fo(\021)638 b Fp(\(128a\))22
b Fm(/)5 b Fp(130d)22 b(130f)5 b Fm(.)171 1667 y Fr("Semit")86
b(:)21 b(commaseparate\(mapli)o(st\(ex)o(pps,)d(e.x\),)j("\\n"\))g(||)g
("\\n")171 1717 y("Stoken")64 b(:)21 b(expps\(e.x\))f(||)h(")h(cl-loc)f
(force)f(")i(||)454 1767 y(\(if)f(e.offset)g(~=)g(0)h(then)f(e.offset)f
(||)h(")h(add)f(")g(else)g(""\))h(||)454 1817 y(e.n)f(||)h(")f
(emit-at")129 1866 y Fp(Uses)12 b Fl(expps)e Fp(128a,)g
Fl(Semit)g Fp(81,)h(and)g Fl(Stoken)e Fp(81.)-24 1945
y(130f)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g
Fp(128b)p Fo(i)n Fv(+)q Fo(\021)635 b Fp(\(128a\))22
b Fm(/)5 b Fp(130e)22 b(130g)5 b Fm(.)171 1995 y Fr("Efitsu")64
b(:)21 b(expps\(e.x\))f(||)h(")h(")g(||)f(e.n)g(||)g(")h(fitsu")171
2044 y("Efitss")64 b(:)21 b(expps\(e.x\))f(||)h(")h(")g(||)f(e.n)g(||)g
(")h(fitss")129 2093 y Fp(Uses)12 b Fl(Efitss)e Fp(81,)h
Fl(Efitsu)e Fp(81,)i(and)g Fl(expps)f Fp(128a.)-31 2173
y(130g)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g
Fp(128b)p Fo(i)n Fv(+)q Fo(\021)638 b Fp(\(128a\))22
b Fm(/)5 b Fp(130f)23 b(130h)t Fm(.)171 2223 y Fr("Epatlabel")c(:)j
(&fail)129 2271 y Fp(Uses)12 b Fl(Epatlabel)d Fp(81)i(and)f
Fl(fail)h Fp(410.)-33 2351 y(130h)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q Fo(\021)633
b Fp(\(128a\))22 b Fm(/)5 b Fp(130g)22 b(131a)5 b Fm(.)171
2401 y Fr("Eforce")85 b(:)22 b(expps\(e.x\))e(||)h(")h(force")171
2450 y("Eforceable":)d(expps\(e.x\))h(||)h(")h(known")129
2499 y Fp(Uses)12 b Fl(Eforce)e Fp(81,)h Fl(Eforceabl)o(e)e
Fp(81,)i(and)f Fl(expps)g Fp(128a.)p eop
%%Page: 131 131
131 130 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(expps.nw)81 b Fv(131)-15 258 y Fp(131a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q
Fo(\021)629 b Fp(\(128a\))22 b Fm(/)5 b Fp(130h)22 b(131b)5
b Fm(.)187 307 y Fr("Epc")151 b(:)22 b(&fail)187 357
y("Epc_known")d(:)j(&fail)145 409 y Fp(Uses)12 b Fl(Epc)f
Fp(81,)g Fl(Epc_known)d Fp(81,)j(and)g Fl(fail)f Fp(410.)-17
500 y(131b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g
Fp(128b)p Fo(i)n Fv(+)q Fo(\021)635 b Fp(\(128a\))22
b Fm(/)5 b Fp(131a)22 b(131c)5 b Fm(.)187 550 y Fr("Enot")129
b(:)22 b(expps\(e.x\))e(||)h(")h(not")145 602 y Fp(Uses)12
b Fl(Enot)e Fp(81)h(and)g Fl(expps)f Fp(128a.)-13 694
y(131c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g
Fp(128b)p Fo(i)n Fv(+)q Fo(\021)629 b Fp(\(128a\))22
b Fm(/)5 b Fp(131b)22 b(131d)5 b Fm(.)187 743 y Fr("Enosimp")63
b(:)22 b(expps\(e.x\))145 795 y Fp(Uses)12 b Fl(Enosimp)d
Fp(81)i(and)g Fl(expps)f Fp(128a.)-17 887 y(131d)88 b
Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p Fo(i)n
Fv(+)q Fo(\021)637 b Fp(\(128a\))22 b Fm(/)5 b Fp(131c)22
b(131e)5 b Fm(.)187 936 y Fr("Sstmts")85 b(:)22 b(commaseparate\(map)o
(list\()o(expps)o(,)d(e.x\),)i("\\n"\))f(||)i("\\n")145
988 y Fp(Uses)12 b Fl(expps)e Fp(128a)g(and)h Fl(Sstmts)f
Fp(81.)-13 1080 y(131e)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q Fo(\021)638 b Fp(\(128a\))22
b Fm(/)5 b Fp(131d)22 b(131f)5 b Fm(.)187 1129 y Fr("Einstance")19
b(:)j({)f(s)h(:=)f("<<)h(/instance-of)d(")j(||)f(e.cons.name)535
1179 y(every)g(i)h(:=)f(inputs_of\(e.cons\))d(do)579
1229 y(s)k(||:=)f(")g(/")h(||)f(i.name)g(||)g(")g(")h(||)f
(expps\(e.argt[i.name])o(\))535 1279 y(s)h(||)f(")h(>>")492
1329 y(})187 1378 y("Einstance_input)o(")d(:)361 1428
y(expps\(e.x\))h(||)h(")h(/")f(||)h(e.cons.name)d(||)i(")h(/")f(||)h
(e.name)e(||)i(")f(get_instance")187 1478 y("Einstance_tagge)o(d")e(:)
361 1528 y(expps\(e.x\))h(||)h(")h(/")f(||)h(e.cons.name)d(||)i(")h
(is_instance")187 1578 y("Ebinding_instan)o(ce")d(:)i(&fail)145
1630 y Fp(Uses)13 b Fl(Ebinding_in)o(sta)o(nce)c Fp(81,)k
Fl(Einstance)d Fp(81,)i Fl(Einstance_)o(inp)o(ut)e Fp(81,)i
Fl(Einstance_)o(tag)o(ged)d Fp(81,)187 1669 y Fl(expps)h
Fp(128a,)g Fl(fail)g Fp(410,)h(and)f Fl(inputs_of)f Fp(166a.)-8
1760 y(131f)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g
Fp(128b)p Fo(i)n Fv(+)q Fo(\021)633 b Fp(\(128a\))22
b Fm(/)5 b Fp(131e)22 b(132b)5 b Fm(.)187 1810 y Fr("Sif")130
b(:)21 b({)h(s)f(:=)h("[")514 1860 y(every)e(s)i(||:=)f("\\n")g(||)g
(expps\(!e.arms\))514 1910 y(s)g(||)h("\\n])f(if-guard")470
1960 y(})187 2009 y("Sguarded")f(:)h(psguard\(e.guard\))e(||)i
("\\n\\t{")f(||)i(expps\(e.x\))d(||)j("}")145 2061 y
Fp(Uses)12 b Fl(expps)e Fp(128a,)g Fl(psguard)f Fp(132a,)h
Fl(Sguarded)f Fp(81,)i(and)g Fl(Sif)g Fp(81.)p eop
%%Page: 132 132
132 131 bop 129 141 a Fv(132)83 b Fr(expps.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(132a)88 b Fo(h)p Fn(*)16
b Fp(128a)p Fo(i)n Fv(+)q Fo(\021)1133 b Fm(/)5 b Fp(129b)171
307 y Fr(procedure)20 b(psguard\(e\))215 357 y(return)g(case)h
(type\(e\))f(of)i({)258 407 y("integer")e(:)i(case)f(e)g(of)h({)f(0)h
(:)f("false";)f(1)i(:)g("true";)e(default:)g(impossible\("condit)o
(ion"\))e(})258 457 y("null")j(:)g("true")258 507 y("set")g(:)g({)324
557 y(l)g(:=)g(sort\(maplist\(expps,)d(sort\(e\)\)\))324
606 y(s)j(:=)g(l[1])324 656 y(every)f(s)i(||:=)f(")g(")h(||)f(l[2)h(to)
f(*l])g(||)g(")h(and")324 706 y(if)f(*l)g(=)h(0)f(then)g("true")g(else)
g(s)258 756 y(})258 806 y(default)f(:)i(expps\(e\))215
855 y(})171 905 y(end)129 957 y Fp(De\014nes:)171 997
y Fl(psguard)p Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(131f.)129
1036 y(Uses)i Fl(expps)e Fp(128a.)-33 1127 y(132b)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p
Fo(i)n Fv(+)q Fo(\021)642 b Fp(\(128a\))22 b Fm(/)5 b
Fp(131f)22 b(132c)5 b Fm(.)171 1177 y Fr("Stagcase")20
b(:)h({)h(s)f(:=)h("[")476 1227 y(every)f(c)g(:=)h(kept_constructor)o
(s\(e.t)o(ype\))c(do)520 1277 y(s)j(||:=)g("\\n/")g(||)g(c.name)g(||)g
(")h({")f(||)h(expps\(e.arms[c]\))c(||)j("}")476 1327
y(s)h(||:=)f("\\n]")f(||)i(expps\(e.x\))d(||)j(")f(tag-case")432
1376 y(})129 1428 y Fp(Uses)12 b Fl(expps)e Fp(128a,)g
Fl(kept_constr)o(uct)o(ors)e Fp(33d,)i(and)h Fl(Stagcase)e
Fp(183a.)-29 1520 y(132c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q Fo(\021)629 b Fp(\(128a\))22
b Fm(/)5 b Fp(132b)23 b(132d)t Fm(.)171 1569 y Fr("Sfail")86
b(:)21 b({)h(s)f(:=)h(image\(e.fmt\))d(||)j(")f([")498
1619 y(every)g(a)g(:=)h(e.a1)f(|)g(e.a2)g(|)h(e.a3)f(do)541
1669 y(s)h(||:=)f(")h(")f(||)h(expps\(\\a\))498 1719
y(s)f(:=)h(s)f(||)h(")f(])h(failmsg")454 1769 y(})171
1818 y("Sepsilon")e(:)h("")129 1870 y Fp(Uses)12 b Fl(expps)e
Fp(128a,)g Fl(Sepsilon)f Fp(81,)i(and)g Fl(Sfail)f Fp(188c.)-33
1962 y(132d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g
Fp(128b)p Fo(i)n Fv(+)q Fo(\021)635 b Fp(\(128a\))22
b Fm(/)5 b Fp(132c)22 b(133a)5 b Fm(.)171 2011 y Fr("Efail")86
b(:)21 b(&fail)129 2063 y Fp(Uses)12 b Fl(Efail)e Fp(81)h(and)g
Fl(fail)f Fp(410.)p eop
%%Page: 133 133
133 132 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(expps.nw)81 b Fv(133)-15 258 y Fp(133a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q
Fo(\021)629 b Fp(\(128a\))22 b Fm(/)5 b Fp(132d)22 b(133b)5
b Fm(.)187 307 y Fr("Glines")85 b(:)22 b(commaseparate\(map)o(list2)o
(\(expp)o(s,)d(e.x\),)h("\\n"\))187 357 y("Gresynch")41
b(:)22 b("")187 407 y("Gblock")85 b(:)22 b({)f(s)h(:=)f("enterscope)f
(")535 457 y(every)h(s)h(||:=)f(expps\(!e.decls\))d(||)k("\\n")535
507 y(every)f(s)h(||:=)f(expps\(!e.stmts\))d(||)k("\\n")535
557 y(s)g(||)f("exitscope")492 606 y(})187 656 y("Gdecl")107
b(:)22 b({)f(s)h(:=)f("/")h(||)f(e.name)g(||)g(")h(")f(||)g
(expps\(e.type\))535 706 y(s)h(||:=)f(expps\(\\e.init\))e(|)j
("&uninitialized)o(")535 756 y(s)g(||)f(")h(decl")492
806 y(})145 857 y Fp(Uses)12 b Fl(expps)e Fp(128a,)g
Fl(Gblock)g Fp(293a,)g Fl(Gdecl)g Fp(293a,)g Fl(Glines)g
Fp(293a,)g(and)g Fl(Gresynch)f Fp(293a.)-17 949 y(133b)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p
Fo(i)n Fv(+)q Fo(\021)635 b Fp(\(128a\))22 b Fm(/)5 b
Fp(133a)22 b(133c)5 b Fm(.)187 999 y Fr("Gcase")107 b(:)22
b(&fail)187 1048 y("Gcasearm")41 b(:)22 b(&fail)187 1098
y("Ginrange")41 b(:)22 b(&fail)145 1150 y Fp(Uses)12
b Fl(fail)e Fp(410,)h Fl(Gcase)f Fp(294a,)g Fl(Gcasearm)f
Fp(294a,)h(and)h Fl(Ginrange)d Fp(294a.)-13 1241 y(133c)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p
Fo(i)n Fv(+)q Fo(\021)629 b Fp(\(128a\))22 b Fm(/)5 b
Fp(133b)22 b(133d)5 b Fm(.)187 1291 y Fr("Gasgn")107
b(:)22 b(&fail)187 1341 y("Gsetname")41 b(:)22 b(&fail)187
1391 y("Gnomatch")41 b(:)22 b(&fail)187 1441 y("Tunsigned")d(:)j
(\(\\e.width)e(|)h("wordsize"\))f(||)h(")h(unsigned")145
1493 y Fp(Uses)9 b Fl(fail)f Fp(410,)g Fl(Gasgn)f Fp(294a,)h
Fl(Gnomatch)e Fp(294a,)i Fl(Gsetname)e Fp(294a,)i Fl(Tunsigned)e
Fp(294a,)h(and)h Fl(wordsize)f Fp(38c.)-17 1584 y(133d)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p
Fo(i)n Fv(+)q Fo(\021)637 b Fp(\(128a\))22 b Fm(/)5 b
Fp(133c)22 b(133e)5 b Fm(.)187 1634 y Fr("Eapp")20 b(:)i
(expps\(e.args\))d(||)i(")h(")g(||)f(image\(e.f\))f(||)h(")h(apply")145
1686 y Fp(Uses)12 b Fl(apply)e Fp(278,)g Fl(Eapp)h Fp(81,)g(and)f
Fl(expps)g Fp(128a.)-13 1777 y(133e)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(expps)g Fp(128b)p Fo(i)n Fv(+)q Fo(\021)638
b Fp(\(128a\))22 b Fm(/)5 b Fp(133d)22 b(133f)5 b Fm(.)187
1827 y Fr("Eclosure_loc")40 b(:)22 b("cl-loc")187 1877
y("Eclosure_addr")c(:)k(e.n)f(||)h(")f(cla")187 1926
y("Eclosure_val")40 b(:)22 b(e.n)f(||)h(")f(clv")145
1978 y Fp(Uses)12 b Fl(Eclosure_a)o(ddr)c Fp(81,)j Fl(Eclosure_l)o(oc)d
Fp(81,)j(and)g Fl(Eclosure_v)o(al)d Fp(81.)-8 2070 y(133f)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(expps)g Fp(128b)p
Fo(i)n Fv(+)q Fo(\021)753 b Fp(\(128a\))21 b Fm(/)6 b
Fp(133e)187 2119 y Fr("Eclosure")20 b(:)h(&fail)187 2169
y("Elambda")f(:)43 b({)230 2219 y(s)22 b(:=)f("[")230
2269 y(every)g(s)h(||:=)f(")g(/")h(||)f(!e.formals)230
2319 y(s)h(||:=)f(")h(])f({)h(")f(||)h(expps\(e.body\))d(||)i(")h(})f
(fn")187 2368 y(})145 2420 y Fp(Uses)12 b Fl(Eclosure)d
Fp(218,)h Fl(Elambda)g Fp(217,)g Fl(expps)g Fp(128a,)g(and)h
Fl(fail)f Fp(410.)p eop
%%Page: 134 134
134 133 bop 129 141 a Fv(134)83 b Fr(solve.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)p eop
%%Page: 135 135
135 134 bop 145 569 a Fq(Chapter)32 b(6)145 777 y Fu(Solving)145
1017 y Fj(6.1)66 b(Basic)22 b(linear)i(solving)145 1108
y Fv(V)m(ariables)13 b(ma)o(y)e(b)q(e)i Fn(unknown)p
Fv(,)h Fn(dep)n(endent)p Fv(,)g Fn(known)p Fv(,)f(or)g
Fn(inputs)p Fv(.)18 b(A)13 b(v)n(alue)f(is)h Fn(c)n(omputable)145
1158 y Fv(if)j(it)f(is)h(a)g(function)g(of)f(inputs,)i(whic)o(h)f(app)q
(ear)g(in)g(the)h(set)g Fr(inputs)p Fv(.)23 b(Both)17
b(dep)q(enden)o(t)145 1208 y(v)n(ariables)f(and)h(inputs)g(app)q(ear)g
(as)g(k)o(eys)g(in)g(the)g(table)g Fr(value)p Fv(.)25
b(Kno)o(wn)17 b(v)n(ariables)f(are)145 1258 y(dep)q(enden)o(t)i(v)n
(ariables)e(whose)g(v)n(alues)g(are)h(computable.)24
b(Unkno)o(wn)15 b(v)n(ariables)h(app)q(ear)145 1307 y(in)e(neither)h
Fr(value)d Fv(nor)i Fr(inputs)p Fv(.)830 2604 y(135)p
eop
%%Page: 136 136
136 135 bop 129 141 a Fv(136)83 b Fr(solve.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(The)j(new)h(solv)o(e)f(w)o(orks)g(in)g
(t)o(w)o(o)g(steps,)h(\014rst)g(\014nding)f(a)g(solution)f(in)h(the)h
(form)d(of)i(a)129 307 y Fr(value)d Fv(table,)h(then)g(applying)f(it.)
-31 370 y Fp(136a)88 b Fo(h)p Fn(*)16 b Fp(136a)p Fo(i)n(\021)1166
b Fp(136b)t Fm(.)171 420 y Fr(procedure)20 b(solve\(be,)g(inputspec\))
215 469 y(local)g(value,)h(constraints,)e(fieldsknown,)g(zeroes,)i
(balances)215 519 y(if)g(*be.eqns)f(=)i(0)f(then)g Fo(h)p
Fn(r)n(eturn)15 b(vacuous)h(solution)f Fp(137b)p Fo(i)20
b Fr(#)i(common)e(short)h(cut)215 619 y(value)42 b(:=)21
b(table\(\))108 b(#)22 b(values)e(of)i(dependent)d(variables)215
669 y(constraints)g(:=)i([])109 b(#)22 b(constraints)d(to)i(check)215
718 y(zeroes)129 b(:=)21 b([])109 b(#)22 b(expressions)d(equal)i(to)g
(zero)215 768 y(pending)107 b(:=)21 b([])109 b(#)22 b(pending)e
(equations)g(we)h(couldn't)f(solve)h(earlier)215 818
y(every)f(defined)h(|)g(used)g(:=)h(set\(\))195 b(#)21
b(sets)g(of)h(idents)e(defined)h(and)g(used)215 918 y(debugs\("#)e
(Inputs:"\);)h(every)h(debugs\(")f(",)h(expimage\(!inputspec\))o(\);)e
(debug\(\))215 967 y(inputs)h(:=)h(copy\(inputspec\))215
1017 y(insert\(inputs,)d(1\))109 b(#)22 b(1)f(is)h(hack)f(for)g
(finding)f(dependent)g(vars)215 1067 y(every)g(x)i(:=)f(!inputs)g(do)g
(value[x])f(:=)i(term2table\(x\))215 1117 y(every)e(eq)i(:=)f(!be.eqns)
f(do)258 1167 y(if)i(eq.op)e(==)i("=")f(then)g(put\(zeroes,)e
(subtract\(eq.left,)g(eq.right\)\))258 1217 y(else)i(put\(constraints,)
e(eq\))215 1266 y Fo(h)p Fn(initialize)13 b(b)n(alanc)n(e)j(machinery)f
(and)h(b)n(alanc)n(e)f(out)g(inputs)g Fp(142a)p Fo(i)215
1316 y(h)p Fn(empty)g Fr(zeroes)e Fp(138)p Fo(i)215 1366
y(h)p Fn(dump)i Fr(value)f Fn(and)i Fr(constraints)c
Fp(145d)p Fo(i)215 1416 y(h)p Fn(make)j(sur)n(e)f(al)r(l)h(dep)n
(endent)h(variables)e(ar)n(e)h(known)g Fp(145c)p Fo(i)215
1466 y(h)p Fn(build)f(and)i(r)n(eturn)e(solution)h Fp(137a)p
Fo(i)171 1515 y Fr(end)129 1567 y Fp(De\014nes:)171 1607
y Fl(constraint)o(s)p Fp(,)10 b(used)h(in)i(c)o(h)o(unks)e(22c,)g(23a,)
h(55,)g(65c,)f(67a,)h(70,)g(71,)g(73b,)f(93a,)h(94a,)f(104a,)h(117b,)
212 1646 y(122a,)g(136{38,)e(140a,)h(143,)h(145d,)f(170a,)g(195,)g
(264,)h(266a,)f(268,)g(269,)h(273a,)f(278,)g(283,)h(298b,)212
1686 y(300,)f(314d,)f(370d,)g(372a,)g(374,)h(375a,)f(and)h(377c.)171
1725 y Fl(defined)p Fp(,)e(used)i(in)g(c)o(h)o(unks)f(28a,)g(32a,)h
(37a,)f(72b,)h(136b,)f(137a,)g(140,)g(145e,)g(165d,)g(312,)h(and)g
(377c.)171 1764 y Fl(solve)p Fp(,)f(used)g(in)h(c)o(h)o(unks)f(145f,)h
(161a,)f(169,)g(172a,)g(260,)h(264,)f(and)h(265a.)171
1804 y Fl(used)p Fp(,)g(used)g(in)g(c)o(h)o(unks)g(9c,)g(33c,)g(36c,)g
(47e,)g(57,)g(73b,)g(77b,)g(81,)h(136b,)e(137a,)h(140,)g(143,)g(145e,)f
(159,)212 1843 y(161c,)h(165,)f(172a,)g(177,)h(239b,)f(242c,)g(268,)h
(270{72,)e(291a,)h(292a,)g(and)h(377c.)171 1883 y Fl(value)p
Fp(,)f(used)h(in)h(c)o(h)o(unks)e(15b,)h(41a,)f(51a,)h(53a,)g(55,)g
(61,)h(76a,)e(78b,)h(81,)g(88b,)g(90,)g(118c,)g(125a,)g(137a,)212
1922 y(138,)g(140{45,)f(156b,)h(177a,)f(195,)h(247,)g(271b,)f(293a,)h
(294a,)f(333a,)h(350,)g(351a,)f(353,)h(355d,)f(357b,)212
1962 y(and)h(377a.)171 2001 y Fl(zeroes)p Fp(,)e(used)i(in)g(c)o(h)o
(unks)f(126b,)g(138{40,)f(and)i(143.)129 2041 y(Uses)h
Fl(debug)e Fp(376a,)g Fl(debugs)g Fp(376a,)g Fl(expimage)f
Fp(101a,)h Fl(subtract)f Fp(144c,)h(and)h Fl(term2table)d
Fp(113b.)192 2103 y Fv(In)i(a)g(solution)g(the)h Fr(defined)d
Fv(and)j Fr(used)e Fv(\014elds)i(are)g(sets)g(of)f(strings,)h(whic)o(h)
f(ma)o(y)f(name)129 2153 y(v)n(ariables)17 b(or)g(\014elds.)28
b Fr(answers)16 b Fv(is)h(a)g(table)g(mapping)e(string)i(v)n(ariables)f
(to)h(expression)129 2202 y(v)n(alues.)-33 2265 y Fp(136b)88
b Fo(h)p Fn(*)16 b Fp(136a)p Fo(i)n Fv(+)q Fo(\021)1019
b Fm(/)5 b Fp(136a)22 b(139c)5 b Fm(.)171 2315 y Fr(record)21
b(solution\(answer)o(s,)e(constraints,)g(defined,)h(used\))129
2366 y Fp(De\014nes:)171 2406 y Fl(solution)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(137,)h(145c,)f(and)g(264.)129
2445 y(Uses)i Fl(constraints)c Fp(136a,)i Fl(defined)f
Fp(136a,)i(and)f Fl(used)g Fp(136a.)p eop
%%Page: 137 137
137 136 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(solve.nw)81 b Fv(137)-15 258 y Fp(137a)88 b Fo(h)p
Fn(build)15 b(and)h(r)n(eturn)e(solution)h Fp(137a)p
Fo(i)o(\021)734 b Fp(\(136a\))187 307 y Fr(answers)20
b(:=)i(table\(\))187 357 y(non_answer)e(:=)h(inputs)f(##)i(++)f
(fresh_vars)f(\(delete!)g(matcher)g(uses)h(these!\))187
407 y(every)g(ident)f(:=)i(key\(value\))d(&)j(type\(ident\))e(==)h
("string")f(&)i(not)f(member\(non_answe)o(r,)e(ident\))h(do)230
457 y(answers[ident])f(:=)j(simplify\(value[i)o(dent])o(\))274
507 y(#)g(we)f(think)g(simplify)f(is)h(OK)h(--)f(super)g(definitely)e
(not)j(OK!)187 557 y(every)f(insert\(used,)e(free_variables\(!a)o
(nswer)o(s)g(|)i(!constraints\)\))187 606 y(every)g(debug\("#)f(===>)h
(answers[",)e(expimage\(k)h(:=)h(key\(answers\)\),)e("])j(=)f(",)h
(expimage\(answers)o([k]\)\))187 656 y Fo(h)p Fn(dump)15
b(def-use)h(info)e Fp(145e)p Fo(i)187 706 y Fr(return)20
b(solution\(answers,)f(simplify\(constra)o(ints)o(\),)g(defined,)h
(used\))145 758 y Fp(Uses)13 b Fl(constraint)o(s)d Fp(136a,)h
Fl(debug)g Fp(376a,)g Fl(defined)g Fp(136a,)g Fl(expimage)f
Fp(101a,)h Fl(free_varia)o(ble)o(s)f Fp(84b,)187 797
y Fl(simplify)f Fp(92a,)h Fl(solution)f Fp(136b,)h Fl(used)h
Fp(136a,)f(and)g Fl(value)g Fp(136a.)-17 889 y(137b)88
b Fo(h)p Fn(r)n(eturn)15 b(vacuous)h(solution)f Fp(137b)p
Fo(i)n(\021)757 b Fp(\(136a\))187 938 y Fr(return)20
b(solution\(table\(\),)f([],)i(emptyset,)f(emptyset\))145
990 y Fp(Uses)12 b Fl(emptyset)d Fp(18a)i(and)f Fl(solution)f
Fp(136b.)p eop
%%Page: 138 138
138 137 bop 129 141 a Fv(138)83 b Fr(solve.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(In)o(v)n(arian)o(ts:)180
341 y(1.)20 b(If)d(v)n(ariable)f Fr(v)h Fv(is)g(kno)o(wn,)g(than)g(all)
f(of)g(its)h(ranges)h(and)f(extensions)h(are)f(kno)o(wn.)233
390 y Fn(what)e(has)g(this)g(to)g(do)g(with)f(b)n(alanc)n(es?)180
474 y Fv(2.)20 b(Ranges)d(and)g(extensions)h(of)e(expressions)i(\(as)g
(opp)q(osed)f(to)g(v)n(ariables)f(or)h(\014elds\))233
523 y(app)q(ear)e(only)e(when)h(the)h(expressions)g(are)f(computable.)
180 606 y(3.)20 b(No)14 b(k)o(ey)g(in)f Fr(zeroes)p Fv(,)f
Fr(pending)p Fv(,)g(or)i Fr(constraints)e Fv(is)i(dep)q(enden)o(t.)180
689 y(4.)20 b(Nothing)14 b(in)f(the)h(range)h(of)e Fr(value)g
Fv(is)g(dep)q(enden)o(t.)180 772 y(5.)20 b(V)m(alues)12
b(in)g Fr(zeroes)p Fv(,)f Fr(pending)p Fv(,)f Fr(constraints)p
Fv(,)g(and)i Fr(value)f Fv(are)i(all)e(in)g(table)h(form)233
822 y(\(so)i(destructiv)o(e)i(substitution)e(w)o(orks\).)-13
905 y Fp(138)88 b Fo(h)p Fn(empty)16 b Fr(zeroes)d Fp(138)p
Fo(i)o(\021)949 b Fp(\(136a\))171 955 y Fr(pending)20
b(:=)i([])239 b(#)22 b(equations)e(with)g(unknowns)h(but)g(no)g(unit)g
(coefficients)171 1005 y(while)g(*zeroes)f(>)i(0)f(do)h({)215
1055 y(while)e(z)i(:=)f(get\(zeroes\))f(do)h({)258 1104
y(every)g(v)g(:=)h(key\(z\))e(&)i(z[v])f(=)h(0)f(do)h(delete\(z,)d(v\))
258 1154 y(debug\("#)h(new)h(equation:)f(",)i(expimage\(z\),)d(")j(=)f
(0"\))258 1204 y Fo(h)p Fn(normalize)15 b Fr(z)f Fn(by)i(dividing)f
(out)g(the)g(gr)n(e)n(atest)f(c)n(ommon)h(divisor)g Fp(146a)p
Fo(i)258 1254 y Fr(if)22 b(v)f(:=)g(key\(z\))g(&)h(type\(v\))e(==)h
("string")f(&)i(not)f(member\(inputs,)e(v\))j(&)f(z[v])g(=)h(\(1)f(|)h
(-1\))f(then)g({)302 1304 y Fo(h)p Fn(make)15 b Fr(v)g
Fn(in)g Fr(z)f Fn(a)h(new)g(dep)n(endent)h(variable)f
Fp(140a)p Fo(i)302 1354 y Fr(if)21 b(computable\(inputs,)d(value[v]\))i
(then)h(push\(newlyknown,)e(v\))302 1403 y Fo(h)p Fn(use)c
Fr(newlyknown)e Fn(to)i(make)g(mor)n(e)f(variables)h(known)g
Fp(142c)p Fo(i)302 1453 y Fr(while)20 b(put\(zeroes,)g
(get\(pending\)\))258 1503 y(})i(else)f(if)g(v)h(:=)f(key\(z\))g(&)g
(not)g(computable\(inputs,)d(v\))k(then)f({)302 1553
y(debug\("#)f(no)h(new)g(dependent)f(variable)g(in)i(",)f
(expimage\(z\),)f(")h(=)h(0"\))302 1603 y(put\(pending,)d(z\))258
1652 y(})j(else)f(if)g(not)g(values_known_equal\()o(z,)e(0\))i(then)g
({)302 1702 y(debug\("#)f(new)h(constraint)f(",)h(expimage\(z\),)e(")j
(=)g(0"\))302 1752 y Fo(h)p Fn(make)15 b(sur)n(e)g Fr(z)f
Fn(is)h(satis\014able)g Fp(145b)p Fo(i)302 1802 y Fr(put\(constraints,)
j(zero_to_constraint)o(\(z\)\))258 1852 y(})215 1901
y(})215 1951 y Fo(h)p Fn(if)c(a)h Fr(pending)e Fn(e)n(quation)j(c)n(an)
f(b)n(e)g(\014xe)n(d)h(with)e Fr(div)g Fn(or)h Fr(mod)p
Fn(,)f(dr)n(ain)h Fr(pending)e Fp(139a)p Fo(i)171 2001
y Fr(})171 2051 y Fo(h)p Fn(make)i(sur)n(e)g(ther)n(e)f(ar)n(e)h(no)g
Fr(pending)f Fn(e)n(quations)h Fp(145f)s Fo(i)129 2103
y Fp(Uses)f Fl(computable)c Fp(139c,)i Fl(constrain)o(t)e
Fp(55,)j Fl(constraint)o(s)e Fp(136a,)g Fl(debug)h Fp(376a,)g
Fl(expimage)f Fp(101a,)171 2142 y Fl(value)f Fp(136a,)g
Fl(values_kno)o(wn_)o(equ)o(al)e Fp(144b,)i Fl(zeroes)g
Fp(136a,)g(and)h Fl(zero_to_co)o(nst)o(ra)o(int)d Fp(145a.)p
eop
%%Page: 139 139
139 138 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(solve.nw)81 b Fv(139)-15 258 y Fp(139a)88 b Fo(h)p
Fn(if)15 b(a)g Fr(pending)e Fn(e)n(quation)j(c)n(an)f(b)n(e)g(\014xe)n
(d)h(with)e Fr(div)g Fn(or)h Fr(mod)p Fn(,)f(dr)n(ain)g
Fr(pending)g Fp(139a)p Fo(i)n(\021)88 b Fp(\(138\))187
307 y Fr(pendingpending)19 b(:=)i([])187 357 y(while)g(z)g(:=)h
(get\(pending\))d(do)230 407 y(if)j(v)f(:=)h(key\(z\))e(&)i(type\(v\))e
(==)i("string")e(&)h(not)g(member\(inputs,)e(v\))j(then)f({)274
457 y(m)h(:=)f(-z[v])274 507 y(delete\(z,)f(v\))274 557
y(if)h(m)h(<)g(0)f(then)g({)h(m)f(:=)h(-m;)f(z)g(:=)h(subtract\(0,)d
(z\))j(})130 b(#)22 b(make)f(m)g(positive)274 606 y(m)h(~=)f(1)h(|)f
(impossible\("coeffi)o(cient)o("\))274 656 y Fo(h)p Fn(cr)n(e)n(ate)15
b(fr)n(esh)f(variables)g Fr(x)p Fn(,)h Fr(q)21 b(=)h(x)f(div)g(m)p
Fn(,)15 b Fr(r)21 b(=)h(x)g(mod)f(m)14 b Fp(139b)p Fo(i)274
706 y Fr(#)22 b(now)f(force)f(x)i(=)g(z,)f(v)h(=)f(q,)h(r)f(=)h(0)274
756 y(every)f(put\(zeroes,)e(subtract\(x,)h(z\))h(|)h(subtract\(v,)d
(q\))j(|)f(subtract\(r,)f(0\)\))274 806 y(while)h(put\(zeroes,)e
(get\(pendingpending\))f(|)k(get\(pending\)\))230 855
y(})g(else)274 905 y(put\(pendingpendin)o(g,)d(z\))145
957 y Fp(Uses)12 b Fl(subtract)d Fp(144c)h(and)h Fl(zeroes)e
Fp(136a.)-17 1048 y(139b)88 b Fo(h)p Fn(cr)n(e)n(ate)15
b(fr)n(esh)f(variables)g Fr(x)p Fn(,)h Fr(q)21 b(=)h(x)g(div)f(m)p
Fn(,)14 b Fr(r)22 b(=)f(x)h(mod)f(m)15 b Fp(139b)p Fo(i)n(\021)233
b Fp(\(139a\))187 1098 y Fr(every)21 b(x)g(|)h(q)f(|)h(r)f(:=)h
(fresh_variable\(v\))187 1148 y(put\(balances,)d(b)i(:=)h
(balance\([balitem\()o(x,)d(n_times_q_plus_r)o(\(m,)g(q,)i(r\)\)],)775
1198 y([balitem\(q,)f(Ediv\(x,)g(m\)\),)h(balitem\(r,)f(Emod\(x,)g
(m\)\)]\)\))187 1248 y(every)h(/baltab[x)e(|)j(q)g(|)f(r])h(:=)f([];)g
(every)g(put\(baltab[x)e(|)j(q)f(|)h(r],)f(b\))187 1297
y(debug\("New)f(balance:)g(",)h(balimage\(b\)\))145 1349
y Fp(Uses)15 b Fl(balance)d Fp(141a,)h Fl(balimage)f
Fp(156b,)h Fl(balitem)g Fp(141a,)g Fl(debug)g Fp(376a,)g
Fl(Ediv)g Fp(81,)h Fl(Emod)g Fp(81,)187 1389 y Fl(fresh_vari)o(abl)o(e)
9 b Fp(155b,)h(and)g Fl(n_times_q_p)o(lus)o(_r)e Fp(150b.)208
1459 y Fv(F)m(undamen)o(tal)j(concept:)20 b(computabilit)o(y)m(.)-13
1522 y Fp(139c)88 b Fo(h)p Fn(*)15 b Fp(136a)p Fo(i)o
Fv(+)p Fo(\021)1016 b Fm(/)5 b Fp(136b)22 b(141a)5 b
Fm(.)187 1571 y Fr(procedure)20 b(computable\(input)o(s,)f(val\))230
1621 y(if)j(member\(inputs,)d(val\))i(then)g(return)230
1671 y(else)g(if)h(v)f(:=)h(free_variables\(v)o(al\))d(&)i(not)g
(member\(inputs,)e(v\))j(then)f(fail)230 1721 y(else)g(return)187
1771 y(end)145 1823 y Fp(De\014nes:)187 1862 y Fl(computable)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(138,)i(142,)f(143b,)g(and)h(145c.)
145 1901 y(Uses)h Fl(fail)e Fp(410)h(and)g Fl(free_vari)o(abl)o(es)d
Fp(84b.)p eop
%%Page: 140 140
140 139 bop 129 141 a Fv(140)83 b Fr(solve.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(By)f(\(2\),)g Fr(v)g Fv(m)o(ust)f(b)q(e)
i(a)f(v)n(ariable,)f(\014eld,)h(or)g(range)h(or)f(extension)h(thereof.)
18 b(By)12 b(\(3\),)h(\(4\))129 307 y(is)i(main)o(tained.)j(\(2\))c(is)
h(main)o(tained)d(b)q(ecause)k Fr(subst)e Fv(substitutes)i(for)e(terms)
h(only)m(,)e(not)129 357 y(inside)h(of)g(ranges)g(or)g(extensions.)-31
420 y Fp(140a)88 b Fo(h)p Fn(make)16 b Fr(v)e Fn(in)h
Fr(z)g Fn(a)g(new)g(dep)n(endent)h(variable)e Fp(140a)p
Fo(i)o(\021)514 b Fp(\(138\))171 469 y Fr(debug\("#)20
b(new)h(dependent)f(variable:)g(",)i(expimage\(v\)\))171
519 y(m)g(:=)f(-)h(z[v])282 b(#)22 b(multiplier)d(of)j(1)f(or)h(-1)171
569 y(delete\(z,)e(v\))171 619 y(every)h(!z)g(*:=)g(m)171
669 y(value[v])f(:=)h(z)171 718 y Fo(h)p Fn(up)n(date)16
b(def-use)f(info)g(for)f Fr(v)h Fp(140b)p Fo(i)171 768
y Fr(every)21 b(dsubst\(!zeroes)e(|)i(!pending)f(|)i(!value)e(|)i
(!constraints,)d(v,)j(z\))171 818 y(debug\("#)e(value[",)g
(expimage\(v\),)g("])h(:=)g(",)h(expimage\(z\)\))129
870 y Fp(Uses)16 b Fl(constraints)c Fp(136a,)i Fl(debug)g
Fp(376a,)g Fl(dsubst)g Fp(90b,)g Fl(expimage)f Fp(101a,)h
Fl(value)g Fp(136a,)171 909 y(and)d Fl(zeroes)e Fp(136a.)-33
992 y(140b)88 b Fo(h)p Fn(up)n(date)16 b(def-use)f(info)g(for)f
Fr(v)h Fp(140b)p Fo(i)o(\021)737 b Fp(\(140a\))171 1042
y Fr(insert\(defined,)19 b(v\))171 1092 y(if)i(v)44 b(==)21
b(free_variables\(!ze)o(roes)d(|)k(!pending)e(|)i(!value\))e(then)215
1142 y(insert\(used,)f(v\))129 1194 y Fp(Uses)12 b Fl(defined)d
Fp(136a,)i Fl(free_vari)o(abl)o(es)d Fp(84b,)j Fl(used)f
Fp(136a,)g Fl(value)g Fp(136a,)g(and)h Fl(zeroes)f Fp(136a.)-29
1285 y(140c)88 b Fo(h)p Fn(up)n(date)16 b(def-use)f(info)g(for)f
Fr(vv)h Fp(140c)p Fo(i)o(\021)719 b Fp(\(144a\))171 1335
y Fr(insert\(defined,)19 b(vv\))171 1385 y(if)i(vv)h(==)f
(free_variables\(!ze)o(roes)d(|)k(!pending)e(|)i(!value\))e(then)215
1434 y(insert\(used,)f(vv\))129 1486 y Fp(Uses)12 b Fl(defined)d
Fp(136a,)i Fl(free_vari)o(abl)o(es)d Fp(84b,)j Fl(used)f
Fp(136a,)g Fl(value)g Fp(136a,)g(and)h Fl(zeroes)f Fp(136a.)p
eop
%%Page: 141 141
141 140 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(solve.nw)81 b Fv(141)145 258 y Fj(6.2)66 b(Balances)145
349 y Fv(Balances)18 b(are)f(a)g(hac)o(k)f(to)h(deal)g(with)f(sign)h
(extension,)h(slicing,)e(DIV)g(and)h(MOD,)g(and)145 398
y(other)d(computations)d(that)i(don't)f(\014t)h(the)g(simple)e
(linear-equation)h(mo)q(del.)k(The)d(idea)g(is)145 448
y(to)h(put)g(a)f(set)h(of)f(v)n(ariables)g(on)h(eac)o(h)g(side)g(of)f
(the)h(balance,)f(suc)o(h)h(that)g(eac)o(h)g(v)n(ariable)f(on)145
498 y(one)j(side)h(is)f(a)f(function)h(of)f(all)g(the)i(v)n(ariables)e
(on)g(the)i(other)g(side,)f(and)g(vice)g(v)o(ersa.)25
b(If)145 548 y(all)13 b(the)h(v)n(ariables)f(on)h(one)g(side)g(b)q
(ecome)g(kno)o(wn,)f(the)h(ones)g(on)g(the)g(other)h(side)f(are)g(also)
145 598 y(kno)o(wn.)k(The)c(reason)h(this)f(is)g(useful)g(is)g(that)g
(w)o(e)g(can)g(substitute)h(suc)o(h)g(v)n(ariables)e(in)h(for)145
647 y(slices,)f(extensions,)h(and)e(other)i(computations.)i(F)m(or)c
(example,)f(the)j(slices)f(of)f(a)g(v)n(ariable)145 697
y(balance)i(that)g(v)n(ariable:)369 778 y Fi(a)41 b Fv(=)h
Fi(x)p Fv([0)8 b(:)h(9])373 828 y Fi(b)41 b Fv(=)h Fi(x)p
Fv([10)8 b(:)h(15])373 877 y Fi(c)41 b Fv(=)h Fi(x)p
Fv([16)8 b(:)h(31])728 828 y Fo(\()-7 b(\))62 b Fi(x)41
b Fv(=)h Fi(a)11 b Fo(j)g Fi(b)e(<)-14 b(<)10 b Fv(10)h
Fo(j)g Fi(c)e(<)-14 b(<)10 b Fv(16)208 988 y(The)k(represen)o(tation)h
(of)f(a)f(balance)h(is:)-15 1050 y Fp(141a)88 b Fo(h)p
Fn(*)15 b Fp(136a)p Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5
b Fp(139c)22 b(141b)5 b Fm(.)187 1100 y Fr(record)20
b(balance\(left,)f(right\))108 b(#)22 b(lists)f(of)g(balitem)187
1150 y(record)f(balitem\(v,)g(value\))173 b(#)22 b(v)f(is)h(string,)e
(value)h(is)g(exp)145 1202 y Fp(De\014nes:)187 1241 y
Fl(balance)p Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(118c,)i(125a,)f(139b,)
g(143a,)g(150a,)g(152,)h(and)f(154.)187 1280 y Fl(balitem)p
Fp(,)f(used)h(in)i(c)o(h)o(unks)d(118c,)i(125a,)f(139b,)g(141b,)g
(150a,)g(152,)h(and)f(154.)145 1320 y(Uses)i Fl(value)e
Fp(136a.)145 1382 y Fv(where)16 b(the)f(only)f(free)h(v)n(ariables)f
(in)g(the)h Fr(value)f Fv(\014elds)h(are)g(the)g(v)n(ariables)f(listed)
g(on)h(the)145 1432 y(opp)q(osite)f(side)h(of)e(the)h(balance.)208
1482 y(The)g(solv)o(er)h(assumes)f(that)h(v)n(ariable)e(names)h(used)h
(in)f(balances)h(don't)f(collide)g(with)145 1532 y(other)i(names;)e
(it's)h(the)g(resp)q(onsibilit)o(y)g(of)f(whatev)o(er)i(agen)o(t)f(pro)
o(vides)g(the)h(balances)g(to)145 1581 y(mak)o(e)d(it)g(so.)208
1631 y(Once)i(a)f(balance)g(b)q(ecomes)h(kno)o(wn,)f(it's)f(useful)i
(to)f(iden)o(tify)g(the)h(side)f(on)g(whic)o(h)h(all)145
1681 y(v)n(ariables)e(are)i(kno)o(wn:)-17 1743 y Fp(141b)88
b Fo(h)p Fn(*)15 b Fp(136a)p Fo(i)o Fv(+)p Fo(\021)1016
b Fm(/)5 b Fp(141a)22 b(142b)5 b Fm(.)187 1793 y Fr(record)20
b(kbalance\(known,)f(unknown\))h(#)i(lists)f(of)g(balitem)145
1845 y Fp(De\014nes:)187 1884 y Fl(kbalance)p Fp(,)9
b(used)h(in)h(c)o(h)o(unk)f(142b.)145 1924 y(Uses)i Fl(balitem)d
Fp(141a.)p eop
%%Page: 142 142
142 141 bop 129 141 a Fv(142)83 b Fr(solve.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(T)m(o)h(disco)o(v)o(er)h(when)g(a)g(v)n
(ariable)f(completes)g(a)h(balance,)f(I)h(create)h(a)f(table)g(that)g
(lists)129 307 y(the)j(balances)f(asso)q(ciated)g(with)g(eac)o(h)g(v)n
(ariable.)25 b Fr(balsused)15 b Fv(ensures)k(I)d(don't)g(use)i(the)129
357 y(same)13 b(balance)h(more)f(than)h(once.)-31 420
y Fp(142a)88 b Fo(h)p Fn(initialize)14 b(b)n(alanc)n(e)i(machinery)f
(and)g(b)n(alanc)n(e)h(out)f(inputs)g Fp(142a)p Fo(i)o(\021)259
b Fp(\(136a\))171 469 y Fr(balances)20 b(:=)h(copy\(be.balances\))171
519 y(baltab)g(:=)g(table\(\))171 569 y(every)g(b)g(:=)h(!balances)e(&)
h(v)h(:=)f(\(!b.left)f(|)i(!b.right\).v)d(do)j({)215
619 y(/baltab[v])d(:=)j([])215 669 y(put\(baltab[v],)c(b\))171
718 y(})171 768 y(balsused)i(:=)h(set\(\))171 818 y(newlyknown)f(:=)h
(sort\(inputs\))171 868 y(oldknown)f(:=)h(set\(\))171
918 y Fo(h)p Fn(use)15 b Fr(newlyknown)e Fn(to)i(make)g(mor)n(e)g
(variables)f(known)h Fp(142c)p Fo(i)-33 1001 y Fp(142b)88
b Fo(h)p Fn(*)16 b Fp(136a)p Fo(i)n Fv(+)q Fo(\021)1013
b Fm(/)5 b Fp(141b)23 b(144b)t Fm(.)171 1051 y Fr(procedure)d
(balance_completed)o(\(bal,)e(value,)j(inputs\))215 1100
y(local)f(vl,)h(vr)215 1150 y(if)g(vl)g(:=)h(\(!bal.left\).v)d(&)i(not)
h(computable\(inpu)o(ts,)d(\\value[vl]\))g(then)258 1200
y(if)j(vr)f(:=)g(\(!bal.right\).v)e(&)j(not)f(computable\(inputs)o(,)e
(\\value[vr]\))h(then)171 1250 y({)171 1300 y(debug\("Balance)f(not)i
(completed;)f(",)345 1349 y(vl,)h(")h(=)g(",)f(expimage\(\\value[vl)o
(]\))e(|)i("???",)g(")g(unknown)g(on)g(left)g(and)g(",)345
1399 y(vr,)g(")h(=)g(",)f(expimage\(\\value[vr)o(]\))e(|)i("???",)g(")g
(unknown)g(on)g(right"\))302 1449 y(fail)171 1499 y(})258
1549 y(else)302 1598 y(return)f(kbalance\(bal.right,)e(bal.left\))215
1648 y(else)258 1698 y(return)j(kbalance\(bal.lef)o(t,)e(bal.right\))
171 1748 y(end)129 1800 y Fp(De\014nes:)171 1839 y Fl(balance_co)o(mpl)
o(ete)o(d)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(143b.)129
1879 y(Uses)h Fl(computable)c Fp(139c,)h Fl(debug)h Fp(376a,)g
Fl(expimage)e Fp(101a,)i Fl(fail)g Fp(410,)g Fl(kbalance)f
Fp(141b,)g(and)i Fl(value)e Fp(136a.)-29 1970 y(142c)88
b Fo(h)p Fn(use)16 b Fr(newlyknown)d Fn(to)h(make)i(mor)n(e)e
(variables)h(known)g Fp(142c)p Fo(i)o(\021)266 b Fp(\(138)10
b(142a\))171 2020 y Fr(while)21 b(v)g(:=)h(get\(newlyknown\))c(do)215
2070 y(if)j(not)g(member\(oldknown,)e(v\))i(then)g({)258
2119 y(insert\(oldknown,)e(v\))258 2169 y Fo(h)p Fn(debug)d(b)n
(alancing)f(act)g Fp(143a)p Fo(i)258 2219 y(h)p Fn(if)g
Fr(v)f Fn(c)n(ompletes)h(half)g(of)f(a)h(b)n(alanc)n(e,)g(make)h(the)f
(other)f(half)h(known)g Fp(143b)p Fo(i)258 2269 y Fr(every)21
b(v)g(:=)h(key\(value\))e(&)h(computable\(inputs,)d(value[v]\))i(do)302
2319 y(push\(newlyknown,)e(v\))215 2368 y(})129 2420
y Fp(Uses)12 b Fl(computable)c Fp(139c)j(and)f Fl(value)g
Fp(136a.)p eop
%%Page: 143 143
143 142 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(solve.nw)81 b Fv(143)-15 258 y Fp(143a)88 b Fo(h)p
Fn(debug)16 b(b)n(alancing)g(act)e Fp(143a)p Fo(i)o(\021)834
b Fp(\(142c\))187 307 y Fr(debug\(image\(v\),)18 b(")k(is)f(newly)g
(known)g("\))187 357 y(every)g(vb)g(:=)g(!\\baltab[v])f(do)230
407 y(if)i(member\(balsused,)c(vb\))j(then)274 457 y
(debug\("\045\045\045\045\045)e(appears)i(in)g(\(already)f(used\))h
(balance)f(",)i(balimage\(vb\)\))230 507 y(else)274 557
y(debug\("!!!!!)d(appears)i(in)g(another)f(balance)h(",)g
(balimage\(vb\)\))187 606 y(if)g(not)g(!\\baltab[v])f(then)230
656 y(debug)h(\(":-\()g(doesn't)f(appear)h(in)g(any)g(balances"\))145
708 y Fp(Uses)12 b Fl(balance)d Fp(141a,)h Fl(balimage)f
Fp(156b,)h Fl(debug)g Fp(376a,)g(and)h Fl(used)f Fp(136a.)-17
799 y(143b)88 b Fo(h)p Fn(if)15 b Fr(v)f Fn(c)n(ompletes)h(half)g(of)g
(a)g(b)n(alanc)n(e,)g(make)g(the)g(other)f(half)h(known)h
Fp(143b)p Fo(i)n(\021)117 b Fp(\(142c\))187 849 y Fr(every)21
b(vb)g(:=)g(!\\baltab[v])f(&)h(not)h(member\(balsused)o(,)d(vb\))i(&)
318 898 y(b)g(:=)h(balance_complet)o(ed\(vb)o(,)d(value,)i(inputs\))f
(do)h({)230 948 y(insert\(balsused,)e(vb\))230 998 y(tt)j(:=)f
(table\(\))f(#)i(used)f(to)g(substitute)f(all)h(balanced)f(goodies)h
(at)g(once)230 1048 y(every)g(vv)h(:=)f(\(ii)g(:=)g(!b.unknown\).v)f(&)
h(zz)h(:=)f(term2table\(subst_)o(tab\(i)o(i.val)o(ue,)d(value,)j(1\)\))
g(do)187 1098 y({)g(debug\("=>)f(balancing)g(tells)h(us)g(",)h(vv,)f(")
h(=)f(",)g(expimage\(zz\)\))274 1147 y(if)g(computable\(inputs,)d
(\\value[vv]\))i(then)h({)318 1197 y Fo(h)p Fn(make)15
b(new)g(c)n(onstr)n(aint)f(fr)n(om)h Fr(value[vv])p Fv(=)p
Fr(zz)d Fp(143c)p Fo(i)274 1247 y Fr(})22 b(else)f({)318
1297 y(if)g(\\value[vv])f(then)361 1347 y({)p Fo(h)p
Fn(make)15 b(new)g(e)n(quation)h Fr(value[vv])p Fv(=)p
Fr(zz)p Fn(,)c(then)k(up)n(date)f Fr(value[vv])e Fp(143d)p
Fo(i)o Fr(})318 1396 y(else)361 1446 y({)p Fo(h)p Fn(make)i
Fr(vv)g Fn(a)g(new)g(dep)n(endent)h(variable)e(with)g
Fr(value[vv])p Fv(=)p Fr(zz)f Fp(144a)p Fo(i)o Fr(})318
1496 y(tt[vv])20 b(:=)h(zz)318 1546 y(if)g(computable\(inputs)o(,)e
(zz\))i(then)g(push\(newlyknown,)e(vv\))274 1596 y(})187
1646 y(})230 1695 y(every)i(dsubst_tab\(!zeroes)d(|)k(!pending)e(|)i
(!value)e(|)i(!constraints,)d(tt\))187 1745 y(})145 1797
y Fp(Uses)c Fl(balance_com)o(ple)o(te)o(d)d Fp(142b,)h
Fl(computable)f Fp(139c,)h Fl(constraint)o(s)f Fp(136a,)h
Fl(debug)h Fp(376a,)187 1836 y Fl(dsubst_tab)8 b Fp(90b,)i
Fl(expimage)f Fp(101a,)h Fl(subst_tab)e Fp(89a,)j Fl(term2table)d
Fp(113b,)i Fl(used)g Fp(136a,)g Fl(value)g Fp(136a,)187
1876 y(and)g Fl(zeroes)g Fp(136a.)-13 1967 y(143c)88
b Fo(h)p Fn(make)16 b(new)f(c)n(onstr)n(aint)f(fr)n(om)g
Fr(value[vv])p Fv(=)p Fr(zz)f Fp(143c)p Fo(i)o(\021)427
b Fp(\(143b\))187 2016 y Fr(if)21 b(not)g(values_known_equal\()o(value)
o([vv],)d(zz\))j(then)g({)230 2066 y(put\(constraints,)e
(eqn\(value[vv],)g("=",)i(zz\)\))230 2116 y(debug\("#)g(new)g
(constraint)e(",)j(expimage\(constra)o(ints[)o(-1]\)\))187
2166 y(})145 2218 y Fp(Uses)13 b Fl(constraint)c Fp(55,)j
Fl(constrain)o(ts)d Fp(136a,)i Fl(debug)g Fp(376a,)g
Fl(eqn)g Fp(83c,)h Fl(expimage)e Fp(101a,)h Fl(value)f
Fp(136a,)187 2257 y(and)g Fl(values_know)o(n_e)o(qua)o(l)f
Fp(144b.)-17 2348 y(143d)88 b Fo(h)p Fn(make)16 b(new)f(e)n(quation)g
Fr(value[vv])p Fv(=)p Fr(zz)p Fn(,)e(then)i(up)n(date)g
Fr(value[vv])e Fp(143d)p Fo(i)o(\021)102 b Fp(\(143b\))187
2398 y Fr(put\(zeroes,)19 b(subtract\(value[vv],)f(zz\)\))187
2447 y(value[vv])i(:=)h(zz)145 2499 y Fp(Uses)12 b Fl(subtract)d
Fp(144c,)h Fl(value)g Fp(136a,)g(and)h Fl(zeroes)e Fp(136a.)p
eop
%%Page: 144 144
144 143 bop 129 141 a Fv(144)83 b Fr(solve.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(144a)88 b Fo(h)p Fn(make)16
b Fr(vv)e Fn(a)h(new)g(dep)n(endent)h(variable)f(with)f
Fr(value[vv])p Fv(=)p Fr(zz)f Fp(144a)p Fo(i)n(\021)184
b Fp(\(143b\))171 307 y Fr(value[vv])20 b(:=)h(zz)171
357 y Fo(h)p Fn(up)n(date)16 b(def-use)f(info)g(for)f
Fr(vv)g Fp(140c)p Fo(i)129 409 y Fp(Uses)e Fl(value)e
Fp(136a.)129 567 y Fj(6.3)67 b(Utilit)n(y)25 b(go)r(o)129
658 y Fv(This)12 b(hac)o(k)f(is)h(just)g(a)f(heuristic)h(that)g(tries)g
(to)f(a)o(v)o(oid)g(creating)h(unnecessary)h(constrain)o(ts,)129
708 y(so)h(false)g(negativ)o(es)g(are)g(OK.)-33 770 y
Fp(144b)88 b Fo(h)p Fn(*)16 b Fp(136a)p Fo(i)n Fv(+)q
Fo(\021)1017 b Fm(/)5 b Fp(142b)22 b(144c)5 b Fm(.)171
820 y Fr(procedure)20 b(values_known_equa)o(l\(e1,)e(e2\))215
870 y(if)j(e1)g(===)g(e2)h(then)f(return)f(e1)215 920
y(e1)h(:=)g(untable\(e1\))215 969 y(e2)g(:=)g(untable\(e2\))171
1019 y(debug\("vals)e(",)j(expimage\(e1\),)d(")j(?=)f(",)g
(expimage\(e2\)\))215 1069 y(return)f(case)h(type\(e1\))f(==)i
(type\(e2\))e(of)h({)258 1119 y("Ewiden")64 b(:)21 b(e1.n)g(=)h(e2.n)f
(&)h(exps_eq\(e1.x,)d(e2.x\))258 1169 y("Eslice")64 b(:)21
b(e1.n)g(==)h(e2.n)f(&)g(e1.lo)g(==)g(e2.lo)g(&)h(exps_eq\(e1.x,)d
(e2.x\))258 1219 y("table")86 b(:)21 b(constant\(subtract\(e1)o(,)e
(e2\)\))i(=)g(0)258 1268 y("integer")42 b(:)21 b(e1)h(=)f(e2)258
1318 y("string")64 b(:)21 b(e1)h(==)f(e2)258 1368 y(default)86
b(:)21 b(e1)h(===)f(e2)215 1418 y(})171 1468 y(end)129
1519 y Fp(De\014nes:)171 1559 y Fl(values_kno)o(wn_)o(equ)o(al)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(138)g(and)h(143c.)129
1598 y(Uses)j Fl(constant)d Fp(114b,)h Fl(debug)g Fp(376a,)g
Fl(Eslice)f Fp(81,)i Fl(Ewiden)f Fp(81,)h Fl(expimage)d
Fp(101a,)i Fl(exps_eq)g Fp(84c,)171 1638 y Fl(subtract)d
Fp(144c,)h(and)h Fl(untable)e Fp(114c.)192 1700 y Fv(Unlik)o(e)g
Fr(binop)p Fv(,)g Fr(subtract)f Fv(is)i(non-destructiv)o(e.)18
b(It)10 b(w)o(ould)f(not)h(b)q(e)h(safe)f(to)g(use)h
Fr(binop)129 1750 y Fv(within)j(the)g(solv)o(er.)-29
1812 y Fp(144c)88 b Fo(h)p Fn(*)16 b Fp(136a)p Fo(i)n
Fv(+)q Fo(\021)1015 b Fm(/)5 b Fp(144b)22 b(145a)5 b
Fm(.)171 1862 y Fr(procedure)20 b(subtract\(l,)f(r\))215
1912 y(z)i(:=)h(table\(0\))215 1962 y(l)f(:=)h(term2table\(l\))215
2011 y(r)f(:=)h(term2table\(r\))215 2061 y(every)e(v)i(:=)f(key\(l\))g
(do)g(z[v])43 b(:=)21 b(l[v])215 2111 y(every)f(v)i(:=)f(key\(r\))g(do)
g(z[v])g(-:=)g(r[v])215 2161 y(return)f(z)171 2211 y(end)129
2263 y Fp(De\014nes:)171 2302 y Fl(subtract)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(87b,)h(136a,)f(139a,)g(143d,)g(and)h
(144b.)129 2341 y(Uses)h Fl(term2table)c Fp(113b.)p eop
%%Page: 145 145
145 144 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(solve.nw)81 b Fv(145)208 258 y(When)18 b(con)o(v)o(erting)f(a)h
(redunden)o(t)h(zero)g(to)e(a)h(constrain)o(t,)h(I)e(mak)o(e)g(all)f
(co)q(e\016cien)o(ts)145 307 y(p)q(ositiv)o(e.)23 b(It's)16
b(not)g(necessary)h(for)f(correctness,)i(but)e(it)f(leads)h(to)g(more)e
(readable)i(con-)145 357 y(strain)o(ts)f(\(and)e(therefore)j(to)e(more)
e(readable)j(co)q(de\).)-15 416 y Fp(145a)88 b Fo(h)p
Fn(*)15 b Fp(136a)p Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5
b Fp(144c)22 b(146b)5 b Fm(.)187 465 y Fr(procedure)20
b(zero_to_constrai)o(nt\(z\))230 515 y(e)i(:=)f(eqn\(table\(0\),)e
("=",)i(table\(0\)\))230 565 y(every)g(k)h(:=)f(key\(z\))g(do)274
615 y(if)130 b(z[k])21 b(>)h(0)f(then)g(e.left[k])42
b(+:=)21 b(z[k])274 665 y(else)g(if)g(z[k])g(<)h(0)f(then)g(e.right[k])
f(-:=)h(z[k])230 714 y(return)g(e)187 764 y(end)145 812
y Fp(De\014nes:)187 852 y Fl(zero_to_co)o(nst)o(ra)o(int)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(138.)145 891 y(Uses)i
Fl(eqn)f Fp(83c.)-17 962 y(145b)88 b Fo(h)p Fn(make)16
b(sur)n(e)e Fr(z)h Fn(is)f(satis\014able)h Fp(145b)p
Fo(i)o(\021)747 b Fp(\(138\))187 1012 y Fr(debug\("####)19
b(sure)i(hope)g(",)h(expimage\(z\),)d(")j(is)f(satisfiable!!!"\))145
1060 y Fp(Uses)12 b Fl(debug)e Fp(376a)g(and)h Fl(expimage)e
Fp(101a.)-13 1135 y(145c)88 b Fo(h)p Fn(make)16 b(sur)n(e)e(al)r(l)h
(dep)n(endent)h(variables)e(ar)n(e)h(known)g Fp(145c)p
Fo(i)o(\021)378 b Fp(\(136a\))187 1185 y Fr(if)21 b(v)h(:=)f
(key\(value\))f(&)h(not)h(computable\(input)o(s,)d(value[v]\))h(then)h
({)230 1235 y(write\(&errout,)e("Error!)i(Incomplete)e(solution)h(for)i
(value[",)e(expimage\(v\),)f("])i(=)h(",)579 1285 y
(expimage\(value[v]\))o(\))230 1334 y(every)f(write\(&errout,)e(")43
b(value[",)21 b(expimage\(k)e(:=)j(key\(value\)\),)d("])i(=)h(",)f
(expimage\(value[k]\)\))230 1384 y(error\(\))187 1434
y(})187 1484 y(if)g(v)h(:=)f(key\(value\))f(&)h(type\(v\))g(==)g
("Eslice")f(&)i(not)f(member\(value,)e(v.x\))i(then)230
1534 y(error\("Solved)e(for)j(",)f(expimage\(v\),)e(")j(but)f(not)g
(for)g(",)h(expimage\(v.x\)\))187 1583 y(if)f(v)h(:=)f(key\(value\))f
(&)h(type\(v\))g(==)g("Ewiden")f(&)i(type\(v.x\))e(==)h("Eslice")f(&)
252 1633 y(not)h(member\(value,)e(v.x.x\))i(then)230
1683 y(error\("Solved)e(for)j(",)f(expimage\(v\),)e(")j(but)f(not)g
(for)g(",)h(expimage\(v.x.x\)\))145 1731 y Fp(Uses)11
b Fl(computabl)o(e)c Fp(139c,)i Fl(Eslice)f Fp(81,)i
Fl(Ewiden)e Fp(81,)i Fl(expimage)d Fp(101a,)i Fl(solution)e
Fp(136b,)i(and)g Fl(value)g Fp(136a.)-17 1806 y(145d)88
b Fo(h)p Fn(dump)16 b Fr(value)e Fn(and)h Fr(constraints)e
Fp(145d)p Fo(i)o(\021)624 b Fp(\(136a\))187 1856 y Fr(every)21
b(debug\("#)f(===>)h(value[",)f(expimage\(k)g(:=)h(key\(value\)\),)e
("])j(=)f(",)h(expimage\(value[)o(k]\)\))187 1906 y(every)f(debug\("#)f
(===>)h(constrain)41 b(",)22 b(expimage\(!constr)o(aints)o(\)\))145
1954 y Fp(Uses)12 b Fl(constraint)o(s)d Fp(136a,)h Fl(debug)g
Fp(376a,)g Fl(expimage)f Fp(101a,)h(and)h Fl(value)f
Fp(136a.)-13 2029 y(145e)88 b Fo(h)p Fn(dump)16 b(def-use)f(info)g
Fp(145e)p Fo(i)o(\021)861 b Fp(\(137a\))187 2079 y Fr(debugs\("#)20
b(defined:"\);)f(every)i(debugs\(")f(",)i(!defined\);)d(debug\(\))187
2129 y(debugs\("#)h(used:"\);)85 b(every)21 b(debugs\(")f(",)i
(!used\);)85 b(debug\(\))145 2177 y Fp(Uses)12 b Fl(debug)e
Fp(376a,)g Fl(debugs)g Fp(376a,)g Fl(defined)f Fp(136a,)h(and)h
Fl(used)f Fp(136a.)-8 2252 y(145f)88 b Fo(h)p Fn(make)16
b(sur)n(e)e(ther)n(e)h(ar)n(e)f(no)i Fr(pending)d Fn(e)n(quations)i
Fp(145f)s Fo(i)o(\021)441 b Fp(\(138\))187 2302 y Fr(if)21
b(*pending)f(>)i(0)f(then)g({)230 2352 y(every)g(write\(&errout,)e
("error:)h(equation)h(",)g(expimage\(!pending)o(\),)e(")i(=)h(0)43
b(is)22 b(unusable"\))230 2402 y(error\("Can't)e(solve)g(equations;)g
(some)h(are)g(useless"\))187 2451 y(})145 2499 y Fp(Uses)12
b Fl(expimage)d Fp(101a)h(and)h Fl(solve)f Fp(136a.)p
eop
%%Page: 146 146
146 145 bop 129 141 a Fv(146)83 b Fr(solve.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(146a)88 b Fo(h)p Fn(normalize)15
b Fr(z)g Fn(by)g(dividing)g(out)g(the)g(gr)n(e)n(atest)f(c)n(ommon)i
(divisor)e Fp(146a)p Fo(i)o(\021)183 b Fp(\(138\))171
307 y Fr(g)22 b(:=)f(&null)171 357 y(every)g(g)g(:=)h(gcd\(g,)e(!z\))
171 407 y(if)h(\\g)h(>)f(1)h(then)f(every)g(!z)g(/:=)g(g)129
459 y Fp(Uses)12 b Fl(gcd)f Fp(146b.)-33 550 y(146b)88
b Fo(h)p Fn(*)16 b Fp(136a)p Fo(i)n Fv(+)q Fo(\021)1134
b Fm(/)6 b Fp(145a)171 600 y Fr(procedure)20 b(gcd\(m,)g(n\))i(#)f
(Knuth)g(vol)g(1,)h(p)f(4)215 650 y(if)g(n)h(<)f(0)h(then)f(n)g(:=)h
(-n)215 700 y(if)f(/m)g(then)g(return)g(n)215 750 y(if)g(m)h(<)f(n)h
(then)f(m)g(:=:)g(n)215 799 y(while)f(r)i(:=)f(0)h(<)f(\(m)h(\045)f
(n\))h(do)f({m)h(:=)f(n;)g(n)h(:=)f(r})215 849 y(return)f(n)171
899 y(end)129 951 y Fp(De\014nes:)171 990 y Fl(gcd)p
Fp(,)10 b(used)h(in)g(c)o(h)o(unk)f(146a.)p eop
%%Page: 147 147
147 146 bop 145 569 a Fq(Chapter)32 b(7)145 777 y Fu(Balancing)39
b(out)g(nonlinear)145 901 y(expressions)145 1117 y Fv(This)20
b(co)q(de)g(uses)h(the)f(\\balance")f(mec)o(hanism)e(de\014ned)k(in)e
(the)h(solv)o(er)g(to)f(de\014ne)i(the)145 1167 y(relationships)14
b(among)e(extensions)j(and)e(slices)i(in)e(a)h(set)h(of)e(equations.)
208 1217 y Fn(This)h(was)h(the)g(old)f(story:)249 1296
y(Slic)n(es)j(make)h(things)f(tricky,)g(sinc)n(e)h(we)f(ne)n(e)n(dn)l
('t)g(always)g(have)h(a)g(c)n(omplete)249 1346 y(set)g(of)h(them.)29
b(We)19 b(ther)n(efor)n(e)f(have)h(to)f(\014nd)i(the)e(slic)n(es)g
(\014rst,)h(so)f(that)h(we)249 1396 y(substitute)c(variables)g(in)g
(only)g(when)g(we)g(have)h(a)f(c)n(omplete)g(set.)20
b(This)14 b(isn)l('t)249 1446 y(to)n(o)k(har)n(d,)g(b)n(e)n(c)n(ause)g
(the)g(original)f(sour)n(c)n(e)h(of)f(e)n(quations)i(is)e(the)h(p)n
(arser,)f(so)249 1496 y(slic)n(es)d(c)n(an)i(b)n(e)f(applie)n(d)g(to)f
(variables)h(only.)249 1561 y(Extensions)g(ar)n(e)g(simpler)e(sinc)n(e)
i(ther)n(e's)f(no)h(such)g(thing)g(as)g(an)g(inc)n(omplete)249
1611 y(set,)g(so)g(they'r)n(e)f(c)n(ompute)n(d)h(on)h(the)f(\015y)g(by)
g Fr(balexp)p Fn(.)208 1691 y Fv(In)e(the)h(new)h(w)o(orld,)d(things)i
(are)g(harder)g(b)q(ecause)i(the)e(parser)h(is)e(no)h(longer)f(the)h
(sole)145 1740 y(source)d(of)e(equations.)16 b(Instead,)11
b(w)o(e)f(ma)o(y)d(b)q(e)j(ask)o(ed)g(to)f(tak)o(e)h(a)f(solution)g
(and)g(in)o(v)o(ert)g(it)h(\(for)145 1790 y(deco)q(ding\).)22
b(Instead)16 b(of)e(using)h(only)f(v)n(ariables)g(that)h(app)q(ear)g
(in)g(the)g(sp)q(ec,)i(w)o(e)e(ha)o(v)o(e)g(to)145 1840
y(disco)o(v)o(er)c(new)h(opp)q(ortunities)f(and)f(in)o(tro)q(duce)i
(balancing)d(v)n(ariables.)17 b(W)m(e)10 b(do)g(this)h(with)g(a)145
1890 y(pro)q(cedure)h(called)e Fr(var_for)p Fv(,)e(whic)o(h)i(has)g
(the)g(prop)q(ert)o(y)h(that)f(if)f Fr(exps_eq\(e1,)20
b(e2\))9 b Fv(then)145 1940 y Fr(var_for\(e1\))20 b(==)h(var_for\(e2\))
n Fv(.)33 b Fr(var_for)17 b Fv(tak)o(es)i(a)g(couple)g(of)f(extra)i
(argumen)o(ts:)145 1989 y Fr(varaux)11 b Fv(to)g(k)o(eep)i(trac)o(k)e
(of)h(its)f(state,)i(and)e Fr(varmap)g Fv(to)g(pro)o(vide)h(an)f(in)o
(v)o(erting)g(map)f(\(from)145 2039 y(v)n(ariables)j(to)h
(expressions\).)208 2089 y(W)m(e)f(create)i(balances)g(in)e(three)i
(passes:)196 2169 y(1.)20 b(Find)14 b(all)f(slices,)i(extensions,)g
(narro)o(ws,)f(divs,)g(mo)q(ds,)e(and)i(their)h(argumen)o(ts.)k(In-)249
2219 y(tro)q(duce)c(v)n(ariables)e(in)g(opp)q(ortune)h(cases,)g(and)g
(salt)f(ev)o(erything)h(a)o(w)o(a)o(y)e(in)h(prelim-)249
2268 y(inary)g(sets)j(and)d(tables.)196 2350 y(2.)20
b(Go)9 b(through)h(the)h(accum)o(ulated)d(sets)k(and)d(tables,)i(and)e
(create)j(balances)e(whenev)o(er)249 2400 y(w)o(e)16
b(ha)o(v)o(e)f(accum)o(ulated)g(enough)g(pieces)i(to)e(b)q(e)h(able)g
(to)f(do)g(so.)23 b(F)m(or)15 b(example,)f(if)249 2449
y(w)o(e)h(see)i Fr(e)k(MOD)g(4)p Fv(,)15 b(w)o(e)g(don't)g(ha)o(v)o(e)f
(enough)i(to)e(create)j(a)e(balance,)f(but)i(if)e(w)o(e)h(see)249
2499 y Fr(e)22 b(MOD)f(4)e Fv(and)h Fr(e)i(DIV)f(4)p
Fv(,)g(w)o(e)f(do.)36 b(When)20 b(w)o(e)g(do)f(in)o(tro)q(duce)i(a)f
(balance,)h(add)830 2604 y(147)p eop
%%Page: 148 148
148 147 bop 129 141 a Fv(148)83 b Fr(balance.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)233 258 y(en)o(tries)21
b(to)e Fr(balmap)p Fv(,)g(whic)o(h)g(maps)f(expressions)j(to)e(v)n
(ariables)f(of)h(the)h(balance.)233 307 y(Sometimes)12
b(in)o(tro)q(ducing)i(balances)g(also)f(requires)i(in)o(tro)q(ducing)f
(new)g(equations.)180 390 y(3.)20 b(Substitute)15 b(the)f(v)n(ariables)
f(of)g(the)i(balance)f(in)f(the)h(equations.)k(This)c(requires)h(an)233
440 y(o)q(dd)f(form)e(of)h(top-do)o(wn)h(substitution;)f(see)j
Fr(balsub_f)c Fv(for)h(more)g(information.)129 611 y
Fj(7.1)67 b(Sup)r(erstructure)129 702 y Fv(This)12 b(co)q(de)g(sho)o
(ws)g(the)g(implemen)o(tati)o(on)d(of)h(the)j(three-pass)g(metho)q(d)d
(giv)o(en)h(ab)q(o)o(v)o(e.)17 b(The)129 752 y(\014rst)e(pass)g(is)e
(made)g(using)h(the)g(expression-w)o(alking)f(function)h
Fr(balpass1)p Fv(.)-31 814 y Fp(148a)88 b Fo(h)p Fn(*)16
b Fp(148a)p Fo(i)n(\021)1166 b Fp(148b)t Fm(.)171 864
y Fr(procedure)20 b(balpass1\(e,)f(varaux,)i(varmap)f
Fo(h)p Fr(,)15 b Fn(aux)h(tables)e Fp(149c)p Fo(i)o Fr(\))215
913 y(case)21 b(type\(e\))f(of)h({)258 963 y Fo(h)p Fn(c)n(ases)15
b(for)g(identifying)f(c)n(andidates)i Fp(149d)p Fo(i)215
1013 y Fr(})171 1063 y(end)129 1115 y Fp(De\014nes:)171
1154 y Fl(balpass1)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(148b.)192
1216 y Fv(The)g(second)i(pass)f(w)o(e)f(do)g(righ)o(t)g(in)g(line,)g
(and)g(the)h(third)f(pass)h(relies)g(on)f(the)h(recursiv)o(e-)129
1266 y(substition)j(pro)q(cedure)i Fr(balsub_f)p Fv(,)c(ab)q(out)i
(whic)o(h)f(more)g(b)q(elo)o(w.)-33 1329 y Fp(148b)88
b Fo(h)p Fn(*)16 b Fp(148a)p Fo(i)n Fv(+)q Fo(\021)1017
b Fm(/)5 b Fp(148a)22 b(149a)5 b Fm(.)171 1378 y Fr(procedure)20
b(balance_eqns\(eqns)o(\))215 1428 y(local)g(width)215
1478 y(if)h(*eqns)g(=)g(0)h(then)f(return)f(balanced_eqns\(eqns,)e
([]\))j(#)h(common)f(short)f(cut)215 1528 y(debug)g
(\("$$$$$$$$$$$$$$$$$)o($$$$$)o($$$$$)o($$$$)o($$$$$)o($$$$$)o($$$$$)o
($$$$$)o($$$$$)o($$$$)o($$$$")o(\))215 1578 y(pushtrace\("BALA)o
(NCE"\))215 1627 y(every)g Fo(h)p Fn(aux)c(tables)f Fr(|)f
Fp(149b)p Fo(i)21 b Fr(varaux)f(|)i(varmap)e(:=)i(table\(\))215
1677 y(expwalk\(eqns,)d(balpass1,)h(varaux,)g(varmap)g
Fo(h)p Fr(,)15 b Fn(aux)h(tables)e Fp(149c)p Fo(i)o Fr(\))215
1727 y(balances)20 b(:=)h([])215 1777 y(neweqns)f(:=)h(copy\(eqns\))215
1827 y(balmap)f(:=)h(table\(\))215 1876 y Fo(h)p Fn(use)15
b(auxiliaries)f(to)h(add)g(to)g Fr(balances)p Fn(,)e
Fr(neweqns)p Fn(,)g(and)j Fr(balmap)e Fp(150a)p Fo(i)215
1926 y Fr(neweqns)20 b(:=)h(gsubst\(neweqns,)e(balsub_f,)h(balmap\))215
1976 y(poptrace\(\))215 2026 y Fo(h)p Fn(br)n(ain)14
b(dump)i Fp(157)p Fo(i)215 2076 y Fr(return)k(balanced_eqns\(newe)o
(qns,)e(balances\))171 2126 y(end)171 2175 y(record)j(balanced_eqns\(e)
o(qns,)d(balances\))129 2227 y Fp(De\014nes:)171 2267
y Fl(balance_eq)o(ns)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(161a,)g
(260,)g(and)h(264.)129 2306 y(Uses)h Fl(balpass1)d Fp(148a,)h
Fl(balsub_f)f Fp(149a,)h Fl(debug)g Fp(376a,)g Fl(expwalk)g
Fp(117a,)g(and)g Fl(gsubst)g Fp(120a.)p eop
%%Page: 149 149
149 148 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(balance.nw)81 b Fv(149)-15 258 y Fp(149a)88 b Fo(h)p
Fn(*)15 b Fp(148a)p Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5
b Fp(148b)22 b(149e)5 b Fm(.)187 307 y Fr(procedure)20
b(balsub_f\(e,)f(balmap\))230 357 y(return)i(gsubst\(\\balmap[e])o(,)e
(balsub_f,)h(balmap\))187 407 y(end)145 457 y Fp(De\014nes:)187
496 y Fl(balsub_f)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(148b.)145
535 y(Uses)i Fl(gsubst)e Fp(120a.)145 687 y Fj(7.2)66
b(Balancing)24 b(out)e(DIV)g(and)h(MOD)145 778 y Fv(Eac)o(h)14
b(balancing)e(act)h(has)g(some)g(substitutions,)g(a)g(balance,)g(and)g
(some)f(equations.)18 b(F)m(or)145 827 y(DIV)c(and)g(MOD)g(w)o(e)g(ha)o
(v)o(e)578 907 y Fi(e)9 b Fr(DIV)g Fi(n)41 b Fo(7!)g
Fi(q)578 969 y(e)9 b Fr(MOD)g Fi(n)41 b Fo(7!)g Fi(m)446
1031 y(d)11 b Fv(=)h Fi(q)e Fo(\002)g Fi(n)f Fv(+)g Fi(m)46
b(.)-7 b(/)44 b(q)13 b Fv(=)f Fi(d)d Fr(DIV)f Fi(n;)f(m)12
b Fv(=)f Fi(d)e Fr(MOD)g Fi(n)684 1093 y(d)46 b Fv(=)g
Fi(e)208 1285 y Fv(I)11 b(use)h(t)o(w)o(o)f(auxiliary)e(tables,)j(one)f
(to)g(sa)o(v)o(e)h(DIV)f(expressions)h(and)f(one)h(to)f(sa)o(v)o(e)g
(MOD)145 1335 y(expressions.)-17 1395 y Fp(149b)88 b
Fo(h)p Fn(aux)16 b(tables)f Fr(|)f Fp(149b)p Fo(i)o(\021)848
b Fp(\(148b\))21 b(151a)5 b Fm(.)187 1444 y Fr(divs)21
b(|)g(mods)g(|)-13 1520 y Fp(149c)88 b Fo(h)p Fr(,)15
b Fn(aux)h(tables)e Fp(149c)p Fo(i)o(\021)869 b Fp(\(148\))22
b(151b)5 b Fm(.)187 1570 y Fr(,)21 b(divs,)g(mods)208
1636 y Fv(The)14 b Fr(divs)f Fv(table)h(represen)o(ts)i(a)e(mapping;)d
(when)j Fr(d)22 b(=)g(e)f(MOD)g(n)p Fv(,)13 b(w)o(e)i(ha)o(v)o(e)249
1709 y Fr(divs:)21 b(var_for\(e\))f(->)h(n)h(->)f(e)145
1783 y Fv(and)14 b(analogously)e(for)i Fr(mods)p Fv(.)-17
1843 y Fp(149d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e(identifying)h(c)n
(andidates)g Fp(149d)p Fo(i)o(\021)501 b Fp(\(148a\))21
b(151c)5 b Fm(.)187 1892 y Fr("Ediv")20 b(:)i(addnset\(divs,)d
(var_for\(e.x,)g(varaux,)i(varmap\),)f(e\))187 1942 y("Emod")g(:)i
(addnset\(mods,)d(var_for\(e.x,)g(varaux,)i(varmap\),)f(e\))145
1992 y Fp(Uses)12 b Fl(addnset)d Fp(149e,)h Fl(Ediv)h
Fp(81,)g Fl(Emod)f Fp(81,)h(and)f Fl(var_for)g Fp(156a.)208
2052 y Fv(\(Actually)m(,)g(to)g(tell)h(the)g(truth,)h(the)g(result)f
(of)f(the)i(mapping)d(is)h(the)i(set)g(of)e(expressions)145
2101 y(equiv)n(alen)o(t)j(to)h Fr(e)p Fv(,)f(not)h(just)g
Fr(e)g Fv(itself.\))-13 2161 y Fp(149e)88 b Fo(h)p Fn(*)15
b Fp(148a)p Fo(i)o Fv(+)p Fo(\021)1016 b Fm(/)5 b Fp(149a)22
b(150b)5 b Fm(.)187 2211 y Fr(procedure)20 b(addnset\(t,)f(vx,)j(e\))
230 2261 y(/t[vx])f(:=)g(table\(\))230 2311 y(/t[vx,)g(e.n])g(:=)g
(set\(\))230 2361 y(return)g(insert\(t[vx,)e(e.n],)i(e\))187
2410 y(end)145 2460 y Fp(De\014nes:)187 2499 y Fl(addnset)p
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(149d)i(and)f(151c.)p
eop
%%Page: 150 150
150 149 bop 129 141 a Fv(150)83 b Fr(balance.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(T)m(o)h(create)i
(balances,)e(w)o(e)h(lo)q(ok)f(for)g(dividends)h Fr(vd)f
Fv(that)h(also)f(app)q(ear)h(in)f Fr(mods)g Fv(with)129
307 y(the)h(same)f Fr(n)p Fv(,)f(and)h(w)o(e)g(create)i(a)e(balance)g
(for)g(eac)o(h)h(one.)k(If)14 b(needed,)h(w)o(e)f(also)g(in)o(tro)q
(duce)129 357 y(the)h(equation)e(making)f(the)i(dividend)g(equal)f(to)h
(the)h(v)n(ariable)d(w)o(e)j(in)o(tro)q(duced.)-31 420
y Fp(150a)88 b Fo(h)p Fn(use)16 b(auxiliaries)e(to)h(add)g(to)g
Fr(balances)p Fn(,)e Fr(neweqns)p Fn(,)g(and)j Fr(balmap)d
Fp(150a)p Fo(i)o(\021)88 b Fp(\(148b\))21 b(152a)5 b
Fm(.)171 469 y Fr(every)21 b(vd)g(:=)g(key\(divs\))f(&)i(n)g(:=)f
(key\(divs[vd]\))e(do)215 519 y(if)i(ms)g(:=)h(\\\(\\mods[vd]\)[n])c(&)
k(qs)f(:=)h(divs[vd,)e(n])h(then)g({)258 569 y(vq)h(:=)f(var_for\(!qs,)
e(varaux,)i(varmap\))258 619 y(vm)h(:=)f(var_for\(!ms,)e(varaux,)i
(varmap\))258 669 y(#)h(vq)f(=)h(vd)f(div)g(n,)h(vm)f(=)h(vd)f(mod)g
(n,)h(vd)f(=)g(vq)h(*)f(n)h(+)g(vm)258 718 y(put\(balances,)d
(balance\([balitem\(vd)o(,)g(n_times_q_plus_r\()o(n,)g(vq,)i(vm\)\)],)
738 768 y([balitem\(vq,)e(Ediv\(vd,)h(n\)\),)h(balitem\(vm,)f
(Emod\(vd,)g(n\)\)]\)\))258 818 y(debug\("==>)g(New)h(balance:",)f
(balimage\(balance)o(s[-1])o(\)\))258 868 y(put\(neweqns,)f(eqn\(vd,)i
("=",)g(vd)g(~===)g(varmap[vd]\)\))e(&)171 918 y(debug\("New)h
(balancing)g(equation)g(",)h(vd,)g(")h(=)f(",)h(expimage\(varmap[v)o
(d]\)\))258 967 y(every)f(balmap[!qs])e(:=)j(vq)258 1017
y(every)f(balmap[!ms])e(:=)j(vm)215 1067 y(})129 1119
y Fp(Uses)13 b Fl(balance)d Fp(141a,)h Fl(balimage)f
Fp(156b,)h Fl(balitem)f Fp(141a,)h Fl(debug)f Fp(376a,)h
Fl(Ediv)g Fp(81,)h Fl(Emod)f Fp(81,)h Fl(eqn)f Fp(83c,)171
1158 y Fl(expimage)e Fp(101a,)h Fl(n_times_q_)o(plu)o(s_r)e
Fp(150b,)i(and)h Fl(var_for)e Fp(156a.)192 1221 y Fv(Here's)20
b(a)f(con)o(v)o(enien)o(t)h(function)f(to)g(compute)g(the)h(sum)e(that)
i(forms)e(one)h(side)h(of)129 1271 y(balances)15 b(in)o(tro)q(duced)f
(for)g(DIV)g(and)f(MOD:)-33 1333 y Fp(150b)88 b Fo(h)p
Fn(*)16 b Fp(148a)p Fo(i)n Fv(+)q Fo(\021)1017 b Fm(/)5
b Fp(149e)23 b(151d)t Fm(.)171 1383 y Fr(procedure)d
(n_times_q_plus_r\()o(d,)f(q,)i(r\))215 1432 y(local)f(xtab)215
1482 y(xtab)h(:=)g(table\(0\);)f(xtab[q])g(:=)i(d;)f(xtab[r])f(:=)i(1)
215 1532 y(return)e(xtab)171 1582 y(end)129 1634 y Fp(De\014nes:)171
1673 y Fl(n_times_q_)o(plu)o(s_r)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d
(139b)i(and)f(150a.)p eop
%%Page: 151 151
151 150 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(balance.nw)81 b Fv(151)145 258 y Fj(7.3)66 b(Balancing)24
b(out)e(narro)n(ws)g(and)h(widens)145 349 y Fv(Here)c(w)o(e)f(ha)o(v)o
(e)g(t)o(w)o(o)f(sc)o(hemata)g(that)h(could)g(in)o(tro)q(duce)g
(isomorphic)e(balances.)30 b(They)145 398 y(are:)719
490 y Fi(e)12 b Fo(")771 496 y Fg(n)835 490 y Fo(7!)41
b Fi(w)627 552 y(w)13 b Fv(=)f Fi(n)f Fo(")771 558 y
Fg(n)838 552 y Fi(.)-7 b(/)45 b(n)11 b Fv(=)h Fi(w)g
Fo(#)1061 558 y Fg(n)768 614 y Fi(n)46 b Fv(=)h Fi(e)145
768 y Fv(and)719 859 y Fi(e)12 b Fo(#)771 865 y Fg(n)835
859 y Fo(7!)41 b Fi(n)627 921 y(w)13 b Fv(=)f Fi(n)f
Fo(")771 927 y Fg(n)838 921 y Fi(.)-7 b(/)45 b(n)11 b
Fv(=)h Fi(w)g Fo(#)1061 927 y Fg(n)762 984 y Fi(w)47
b Fv(=)g Fi(e)157 1137 y Fv(The)11 b(tric)o(k)h(here)g(is)f(to)g(a)o(v)
o(oid)f(in)o(tro)q(ducing)h(the)h(same)e(balance)i(t)o(wice)f(for)g
(the)h(case)g(where)145 1187 y(the)j(relev)n(an)o(t)f(stu\013)g(app)q
(ears)h(in)e(a)h(sep)q(erate)i(narro)o(w)e(and)f(widen.)-15
1249 y Fp(151a)88 b Fo(h)p Fn(aux)16 b(tables)f Fr(|)f
Fp(149b)p Fo(i)o Fv(+)p Fo(\021)694 b Fp(\(148b\))22
b Fm(/)5 b Fp(149b)22 b(153b)5 b Fm(.)187 1299 y Fr(extensions)20
b(|)h(narrows)f(|)-17 1382 y Fp(151b)88 b Fo(h)p Fr(,)15
b Fn(aux)h(tables)e Fp(149c)p Fo(i)o Fv(+)p Fo(\021)726
b Fp(\(148\))22 b Fm(/)5 b Fp(149c)22 b(153c)5 b Fm(.)187
1432 y Fr(,)21 b(extensions,)f(narrows)-13 1523 y Fp(151c)88
b Fo(h)p Fn(c)n(ases)16 b(for)e(identifying)h(c)n(andidates)g
Fp(149d)p Fo(i)o Fv(+)p Fo(\021)345 b Fp(\(148a\))22
b Fm(/)5 b Fp(149d)22 b(153d)5 b Fm(.)187 1573 y Fr("Ewiden")64
b(:)21 b(addnset\(extensions)o(,)e(var_for\(e.x,)g(varaux,)i(varmap\),)
f(e\))187 1623 y("Enarrows")g(:)h(addnset\(narrows,)84
b(var_for\(e.x,)19 b(varaux,)i(varmap\),)f(e\))145 1675
y Fp(Uses)12 b Fl(addnset)d Fp(149e,)h Fl(Enarrows)f
Fp(81,)i Fl(Ewiden)f Fp(81,)h(and)f Fl(var_for)g Fp(156a.)-17
1766 y(151d)88 b Fo(h)p Fn(*)15 b Fp(148a)p Fo(i)o Fv(+)p
Fo(\021)1033 b Fm(/)6 b Fp(150b)22 b(154)5 b Fm(.)p eop
%%Page: 152 152
152 151 bop 129 141 a Fv(152)83 b Fr(balance.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Here)g(w)o(e)g(ha)o
(v)o(e)f(the)h(sp)q(ecial)g(problem)e(that,)h(if)f(w)o(e)i(w)o(eren't)g
(careful,)f(w)o(e)h(could)f(in)o(tro-)129 307 y(duce)k(the)e(same)g
(balance)g(from)e(b)q(oth)j(an)f(extension)g(and)g(a)g(narro)o(w.)19
b Fr(baln2w)13 b Fv(maps)g Fr(vn)129 357 y Fv(to)j(the)h(list)e(of)g
Fr(vw)p Fv('s)g(in)h(ev)o(ery)g(balance)g(using)g(a)f(narro)o(w)h
Fr(vn)p Fv(,)f(so)h(w)o(e)g(don't)f(ev)o(er)i(create)129
407 y(the)e(same)e(balance)h(t)o(wice.)-31 469 y Fp(152a)88
b Fo(h)p Fn(use)16 b(auxiliaries)e(to)h(add)g(to)g Fr(balances)p
Fn(,)e Fr(neweqns)p Fn(,)g(and)j Fr(balmap)d Fp(150a)p
Fo(i)o Fv(+)p Fo(\021)87 b Fp(\(148b\))19 b Fm(/)5 b
Fp(150a)19 b(152b)5 b Fm(.)171 519 y Fr(baln2w)21 b(:=)g(table\(\))171
569 y(every)g(vn)g(:=)g(key\(extensions\))e(&)j(width)f(:=)g
(key\(extensions[vn)o(]\))e(do)i({)215 619 y(ws)g(:=)g(extensions[vn,)e
(width])215 669 y(vw)i(:=)g(var_for\(!ws,)f(varaux,)g(varmap\))g(|)i
(impossible\("no)d(extensions"\))215 718 y(#)i(vw)h(:=)f(vn!)g(><)g(vn)
h(:=)f(vw[])215 768 y(if)g(member\(\\baln2w[vn)o(],)e(vw\))i(then)g({)
258 818 y(debug\("DUPLICATE)e(balance)h(",)h(vn,)h(")f(|><|)g(",)g
(vw\))215 868 y(})g(else)g({)258 918 y Fo(h)p Fn(add)16
b(new)f(b)n(alanc)n(e)g(to)g Fr(baln2w)e Fp(153a)p Fo(i)258
967 y Fr(put\(balances,)19 b(balance\([balitem\(vw)o(,)g(Ewiden)42
b(\(vn,)21 b(width\)\)],)738 1017 y([balitem\(vn,)e(Enarrows\(vw,)g
(width\)\)]\)\))258 1067 y(debug\("==>)h(New)h(balance:",)f
(balimage\(balance)o(s[-1])o(\)\))215 1117 y(})215 1167
y(put\(neweqns,)f(eqn\(vn,)h("=",)h(vn)h(~===)f(varmap[vn]\)\))e(#)i
(could)g(tighten)g(\(1-element)e(table\))171 1217 y(#####)43
b(*ws)21 b(#)g(seems)g(to)g(be)h(needed)e(to)i(work)f(around)f(bug)h
(in)h(icont!)215 1266 y(every)e(balmap[!ws])g(:=)h(vw)171
1316 y(})129 1368 y Fp(Uses)14 b Fl(balance)d Fp(141a,)h
Fl(balimage)f Fp(156b,)h Fl(balitem)f Fp(141a,)h Fl(debug)g
Fp(376a,)g Fl(Enarrows)f Fp(81,)i Fl(eqn)g Fp(83c,)171
1408 y Fl(Ewiden)d Fp(81,)g(and)h Fl(var_for)e Fp(156a.)-33
1491 y(152b)88 b Fo(h)p Fn(use)16 b(auxiliaries)e(to)h(add)g(to)g
Fr(balances)p Fn(,)e Fr(neweqns)p Fn(,)g(and)j Fr(balmap)d
Fp(150a)p Fo(i)o Fv(+)p Fo(\021)87 b Fp(\(148b\))19 b
Fm(/)5 b Fp(152a)19 b(153e)5 b Fm(.)171 1540 y Fr(every)21
b(vw)g(:=)g(key\(narrows\))f(&)h(width)g(:=)h(key\(narrows[vw])o(\))d
(do)i({)215 1590 y(ns)g(:=)g(narrows[vw,)f(width])215
1640 y(vn)h(:=)g(var_for\(!ns,)f(varaux,)g(varmap\))g(|)i
(impossible\("no)d(narrows"\))215 1690 y(#)i(vw)h(:=)f(vn!)g(><)g(vn)h
(:=)f(vw[])215 1740 y(if)g(member\(\\baln2w[vn)o(],)e(vw\))i(then)g({)
258 1789 y(debug\("DUPLICATE)e(balance)h(",)h(vn,)h(")f(|><|)g(",)g
(vw\))215 1839 y(})g(else)g({)258 1889 y Fo(h)p Fn(add)16
b(new)f(b)n(alanc)n(e)g(to)g Fr(baln2w)e Fp(153a)p Fo(i)258
1939 y Fr(put\(balances,)19 b(balance\([balitem\(vw)o(,)g(Ewiden)42
b(\(vn,)21 b(width\)\)],)738 1989 y([balitem\(vn,)e(Enarrows\(vw,)g
(width\)\)]\)\))258 2038 y(debug\("==>)h(New)h(balance:",)f
(balimage\(balance)o(s[-1])o(\)\))215 2088 y(})215 2138
y(put\(neweqns,)f(eqn\(vw,)h("=",)h(vw)h(~===)f(varmap[vw]\)\))e(#)i
(could)g(tighten)g(\(1-element)e(table\))171 2188 y(#####)43
b(*ns)21 b(#)g(seems)g(to)g(be)h(needed)e(to)i(work)f(around)f(bug)h
(in)h(icont!)215 2238 y(every)e(balmap[!ns])g(:=)h(vn)171
2288 y(})171 2337 y(baln2w)g(:=)g(&null)g(#)g(make)g(it)h(possible)e
(to)h(garbage-collect)e(the)i(memory)129 2389 y Fp(Uses)14
b Fl(balance)d Fp(141a,)h Fl(balimage)f Fp(156b,)h Fl(balitem)f
Fp(141a,)h Fl(debug)g Fp(376a,)g Fl(Enarrows)f Fp(81,)i
Fl(eqn)g Fp(83c,)171 2429 y Fl(Ewiden)d Fp(81,)g(and)h
Fl(var_for)e Fp(156a.)p eop
%%Page: 153 153
153 152 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(balance.nw)81 b Fv(153)-15 258 y Fp(153a)88 b Fo(h)p
Fn(add)16 b(new)f(b)n(alanc)n(e)g(to)g Fr(baln2w)f Fp(153a)p
Fo(i)n(\021)714 b Fp(\(152\))187 307 y Fr(/baln2w[vn])19
b(:=)j(set\(\))187 357 y(insert\(baln2w[vn)o(],)d(vw\))145
515 y Fj(7.4)66 b(Balancing)24 b(out)e(slices)145 606
y Fv(Here)d(things)e(are)h(a)f(bit)h(o)q(dd,)f(b)q(ecause)j(w)o(e)d
(can)h(ha)o(v)o(e)f(slices)h(nested)h(within)e(slices.)29
b(I)145 656 y(ignore)15 b(that)g(problem)f(for)h(the)g(time)f(b)q(eing)
h(\(although)f(I)h(ha)o(v)o(e)g(some)f(co)q(de\);)i(instead)f(I)145
706 y(describ)q(e)h(the)e(simple)f(case:)626 797 y Fi(e)p
Fv([)p Fi(r)676 803 y Ff(1)695 797 y Fv(])41 b Fo(7!)g
Fi(s)850 803 y Ff(1)763 853 y Fv(.)763 870 y(.)763 887
y(.)622 949 y Fi(e)p Fv([)p Fi(r)672 955 y Fg(n)695 949
y Fv(])g Fo(7!)g Fi(s)850 955 y Fg(n)423 1019 y Fi(w)12
b Fv(=)509 980 y Fe(X)533 1068 y Fg(i)576 1019 y Fv(2)597
1002 y Fg(l)607 1006 y Fd(i)631 1019 y Fo(\002)e Fi(s)692
1025 y Fg(i)751 1019 y Fi(.)-7 b(/)45 b(s)850 1025 y
Ff(1)880 1019 y Fv(=)12 b Fi(w)q Fv([)p Fi(r)986 1025
y Ff(1)1004 1019 y Fv(])p Fi(;)7 b(:)g(:)g(:)t(;)g(s)1127
1025 y Fg(n)1161 1019 y Fv(=)12 b Fi(w)q Fv([)p Fi(r)1267
1025 y Fg(n)1289 1019 y Fv(])675 1107 y Fi(w)47 b Fv(=)g
Fi(e)-17 1261 y Fp(153b)88 b Fo(h)p Fn(aux)16 b(tables)f
Fr(|)f Fp(149b)p Fo(i)o Fv(+)p Fo(\021)816 b Fp(\(148b\))21
b Fm(/)6 b Fp(151a)187 1310 y Fr(slices)20 b(|)-13 1402
y Fp(153c)88 b Fo(h)p Fr(,)15 b Fn(aux)h(tables)e Fp(149c)p
Fo(i)o Fv(+)p Fo(\021)837 b Fp(\(148\))22 b Fm(/)6 b
Fp(151b)187 1452 y Fr(,)21 b(slices)-17 1543 y Fp(153d)88
b Fo(h)p Fn(c)n(ases)16 b(for)e(identifying)h(c)n(andidates)g
Fp(149d)p Fo(i)o Fv(+)p Fo(\021)469 b Fp(\(148a\))21
b Fm(/)6 b Fp(151c)187 1593 y Fr("Eslice")20 b(:)i({)f(vx)g(:=)h
(var_for\(e.x,)d(varaux,)i(varmap\))470 1643 y(/slices[vx])f(:=)h
(set\(\))470 1692 y(insert\(slices[vx],)d(e\))427 1742
y(})145 1794 y Fp(Uses)12 b Fl(Eslice)e Fp(81)h(and)f
Fl(var_for)g Fp(156a.)-13 1885 y(153e)88 b Fo(h)p Fn(use)16
b(auxiliaries)e(to)h(add)g(to)g Fr(balances)p Fn(,)e
Fr(neweqns)p Fn(,)g(and)j Fr(balmap)d Fp(150a)p Fo(i)o
Fv(+)p Fo(\021)88 b Fp(\(148b\))20 b Fm(/)6 b Fp(152b)187
1935 y Fr(every)21 b(vx)g(:=)g(key\(slices\))f(&)h(xslices)g(:=)g
(slices[vx])f(do)230 1985 y(slicetree\(vx,)f(xslices,)i(varaux,)f
(varmap,)g(0,)i(bitsizeof\(varmap)o([vx]\))o(,)448 2035
y(neweqns,)e(balances,)g(balmap\))145 2087 y Fp(Uses)12
b Fl(bitsizeof)d Fp(115c)h(and)h Fl(slicetree)d Fp(154.)p
eop
%%Page: 154 154
154 153 bop 129 141 a Fv(154)83 b Fr(balance.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(I'm)g(not)i(sure)h
(I'll)e(b)q(e)i(in)o(tro)q(ducing)e(equations)h(prop)q(erly)h(when)g
(it)e(gets)i(to)f(b)q(e)h(time)129 307 y(to)e(slice)g(a)g(tree...)-13
369 y Fp(154)88 b Fo(h)p Fn(*)16 b Fp(148a)p Fo(i)n Fv(+)q
Fo(\021)1013 b Fm(/)5 b Fp(151d)23 b(155b)t Fm(.)171
418 y Fr(procedure)d(slicetree\(vw,)f(xslices,)h(varaux,)g(varmap,)h
(lo,)g(hi,)g(neweqns,)f(balances,)g(balmap\))215 468
y(return)g(do_slicetree\(vw,)f(copy\(xslices\),)f(varaux,)j(varmap,)f
(lo,)h(hi,)650 518 y(neweqns,)g(balances,)e(balmap\))171
568 y(end)171 668 y(procedure)h(do_slicetree\(vw,)e(xslices,)j(varaux,)
f(varmap,)g(lo,)h(hi,)h(neweqns,)e(balances,)g(balmap\))215
717 y(sibs)h(:=)g(set\(\))215 767 y(sum)g(:=)g(table\(0\))215
817 y(leftbal)f(:=)h([])215 867 y(debug\("Slicing)d(",)k
(expimage\(sort\(xsl)o(ices)o(\)\),)d(")i(from)g(",)h(lo,)f(")g(to)h
(",)f(hi\))215 917 y(while)f(lo)i(<)f(hi)h(do)f({)258
966 y(kids)g(:=)g(set\(\))258 1016 y Fo(h)p Fn(make)15
b Fr(first)f Fn(the)h(lar)n(gest)f(slic)n(e)g(at)h Fr(lo)g
Fn(\()p Fr(fail)f Fn(if)g(not)h(ther)n(e)g(and)g(leftmost\))f
Fp(155a)p Fo(i)258 1066 y Fr(insert\(sibs,)19 b(first\))258
1116 y(delete\(xslices,)g(first\))258 1166 y(firstv)i(:=)g
(var_for\(first,)e(varaux,)h(varmap\))258 1215 y(sum[if)h(lo)g(=)h(0)f
(then)g(firstv)g(else)g(Eshift\(firstv,)e(lo\)])i(+:=)g(1)258
1265 y(put\(leftbal,)e(balitem\(firstv,)g(Eslice\(vw,)h(first.lo,)g
(first.n\)\)\))258 1315 y(every)h(slice)g(:=)g(!xslices)f(do)302
1365 y(if)h(slice.lo)f(+)i(slice.n)e(<=)i(first.lo)e(+)h(first.n)g
(then)g({)345 1415 y(insert\(kids,)f(slice\))345 1465
y(delete\(xslices,)f(slice\))302 1514 y(})i(else)g(if)h(slice.lo)e(<)h
(first.lo)g(+)g(first.n)f(then)345 1564 y(error\("Overlapping)e
(slices:)j(",)g(expimage\(subst_tab)o(\(firs)o(t,)e(varmap\)\),)h(")h
(and)g(",)999 1614 y(expimage\(subst_tab)o(\(slic)o(e,)e(varmap\)\)\))
258 1664 y(if)j(*kids)e(>)i(0)f(then)302 1714 y(do_slicetree\(fir)o
(stv,)d(kids,)j(varaux,)f(varmap,)h(first.lo,)f(first.lo)g(+)h
(first.n,)585 1763 y(neweqns,)f(balances,)g(balmap\))258
1813 y(lo)i(+:=)f(first.n)215 1863 y(})215 1913 y(*xslices)f(=)h(0)h(|)
302 1963 y(impossible\("left)o(over)c(slices:)j(",)g
(expimage\(subst_tab)o(\(sort)o(\(xsli)o(ces\))o(,)e(varmap\)\)\))215
2012 y(put\(balances,)g(balance\(leftbal,)f([balitem\(vw,)h(sum\)]\)\))
215 2062 y(debug\("==>)g(New)i(balance:",)f(balimage\(balances[)o
(-1]\)\))215 2112 y(every)g(slice)h(:=)g(!sibs)g(do)258
2162 y(balmap[slice])e(:=)j(var_for\(slice,)d(varaux,)h(varmap\))215
2212 y(put\(neweqns,)f(eqn\(vw,)h("=",)h(vw)h(~===)f(varmap[vw]\)\))e
(&)171 2262 y(debug\("New)h(balancing)g(equation)g(",)h(vw,)g(")h(=)f
(",)h(expimage\(varmap[v)o(w]\)\))171 2311 y(end)129
2362 y Fp(De\014nes:)171 2402 y Fl(slicetree)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(153e.)129 2441 y(Uses)h Fl(balance)d
Fp(141a,)h Fl(balimage)e Fp(156b,)i Fl(balitem)f Fp(141a,)h
Fl(debug)g Fp(376a,)g Fl(eqn)g Fp(83c,)g Fl(Eshift)g
Fp(81,)g Fl(Eslice)f Fp(81,)171 2480 y Fl(expimage)h
Fp(101a,)h Fl(subst_tab)f Fp(89a,)h(and)h Fl(var_for)e
Fp(156a.)p eop
%%Page: 155 155
155 154 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(balance.nw)81 b Fv(155)-15 258 y Fp(155a)88 b Fo(h)p
Fn(make)16 b Fr(first)d Fn(the)i(lar)n(gest)f(slic)n(e)h(at)g
Fr(lo)f Fn(\()p Fr(fail)g Fn(if)g(not)h(ther)n(e)g(and)h(leftmost\))d
Fp(155a)p Fo(i)o(\021)88 b Fp(\(154\))187 307 y Fr(first)21
b(:=)g(&null)187 357 y(every)g(slice)f(:=)i(!xslices)e(do)230
407 y(if)i(slice.lo)e(<)h(lo)h(then)f(fail)230 457 y(else)g(if)h
(slice.lo)e(=)h(lo)h(&)f(not)h(\(\(\\first\).n)d(>)j(slice.n\))e(then)
274 507 y(first)h(:=)g(slice)187 557 y(\\first)f(|)i(fail)145
608 y Fp(Uses)12 b Fl(fail)e Fp(410.)145 766 y Fj(7.5)66
b(Utilities)145 857 y Fv(There)21 b(are)f(no)o(w)g(all)e(sorts)j(of)e
(places)h(w)o(e)g(in)o(tro)q(duce)g(fresh)h(v)n(ariables.)34
b(Main)o(taining)145 907 y(the)17 b(global)d(set)j(of)f(fresh)h(v)n
(ariables)e(migh)o(t)f(b)q(e)j(a)e(bit)h(of)g(a)f(w)o(aste)i(of)e
(memory)m(,)f(but)i(it's)145 957 y(a)h(con)o(v)o(enien)o(t)f(w)o(a)o(y)
g(to)h(a)o(v)o(oid)e(putting)h(these)i(auxiliary)d(v)n(ariables)h
(where)h(they)g(aren't)145 1007 y(needed.)-17 1069 y
Fp(155b)88 b Fo(h)p Fn(*)15 b Fp(148a)p Fo(i)o Fv(+)p
Fo(\021)1037 b Fm(/)6 b Fp(154)22 b(155c)5 b Fm(.)187
1119 y Fr(global)20 b(fresh_variables)187 1169 y(procedure)g
(fresh_variable\(n)o(ame\))230 1219 y(static)h(n)230
1268 y(initial)g(n)g(:=)h(0)230 1318 y(insert\(fresh_variab)o(les,)c(s)
k(:=)f(fresh_base\(name\))e(||)i("#")g(||)h(\(n)f(+:=)g(1\)\))230
1368 y(return)g(s)187 1418 y(end)145 1470 y Fp(De\014nes:)187
1509 y Fl(fresh_vari)o(abl)o(e)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f
(49c,)g(139b,)h(156a,)f(182b,)g(217,)g(218,)h(and)f(265c.)187
1549 y Fl(fresh_vari)o(abl)o(es)o Fp(,)f(used)i(in)g(c)o(h)o(unks)f
(19a,)g(165d,)g(and)h(302b.)145 1588 y(Uses)h Fl(fresh_base)c
Fp(155c.)-13 1671 y(155c)88 b Fo(h)p Fn(*)15 b Fp(148a)p
Fo(i)o Fv(+)p Fo(\021)1016 b Fm(/)5 b Fp(155b)22 b(156a)5
b Fm(.)187 1721 y Fr(procedure)20 b(fresh_base\(name\))230
1771 y(static)h(tail)230 1820 y(initial)g(tail)g(:=)g('#')g(++)h
(&digits)230 1870 y(name)f(?)h(return)e(1\(tab\(upto\('#'\)|0\),)e
(tab\(many\(tail\)\))h(|)j("",)f(pos\(0\)\))187 1920
y(end)145 1972 y Fp(De\014nes:)187 2011 y Fl(fresh_base)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(155b.)p eop
%%Page: 156 156
156 155 bop 129 141 a Fv(156)83 b Fr(balance.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(The)g(pro)q(cedure)h
Fr(var_for)d Fv(pro)q(duces)j(a)f(fresh)g(v)n(ariable)e(to)i(stand)g
(in)f(for)g(the)h(expres-)129 307 y(sion)19 b Fr(e)p
Fv(.)32 b(Its)19 b(sp)q(ecial)g(prop)q(ert)o(y)h(is)e(that)h
Fr(var_for\(e1\))g(==)j(var_for\(e2\))16 b Fv(whenev)o(er)129
357 y Fr(exps_eq\(e1,)k(e2\))p Fv(.)-31 420 y Fp(156a)88
b Fo(h)p Fn(*)16 b Fp(148a)p Fo(i)n Fv(+)q Fo(\021)1017
b Fm(/)5 b Fp(155c)23 b(156b)t Fm(.)171 469 y Fr(procedure)d
(var_for\(e,)g(aux,)h(var2exp\))215 519 y(e)g(:=)h(untableexp\(e\))215
569 y(if)f(type\(e\))f(==)i("string")e(then)258 619 y(return)h
(var2exp[e])e(:=)j(e)215 669 y(/aux[type\(e\)])d(:=)i(table\(\))215
718 y(t)g(:=)h(aux[type\(e\)])215 768 y(return)e(\\t[e])h(|)g({)258
818 y(every)g(k)g(:=)h(key\(t\))e(do)302 868 y(if)h(exps_eq\(e,)f(k\))h
(then)g({)345 918 y(t[e])g(:=)h(t[k])345 967 y(break)302
1017 y(})258 1067 y(var2exp[/t[e])d(:=)j(fresh_variable\(f)o(ree_)o
(varia)o(bles\()o(e\))d(|)i("???"\)])g(:=)g(e)258 1117
y(t[e])215 1167 y(})171 1217 y(end)129 1268 y Fp(De\014nes:)171
1308 y Fl(var_for)p Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(149{54.)129
1347 y(Uses)i Fl(exps_eq)d Fp(84c,)i Fl(free_varia)o(ble)o(s)e
Fp(84b,)h Fl(fresh_varia)o(ble)e Fp(155b,)i(and)h Fl(untableex)o(p)e
Fp(88a.)129 1497 y Fj(7.6)67 b(Debugging)22 b(supp)r(ort)-33
1588 y Fp(156b)88 b Fo(h)p Fn(*)16 b Fp(148a)p Fo(i)n
Fv(+)q Fo(\021)1134 b Fm(/)6 b Fp(156a)171 1638 y Fr(procedure)20
b(balimage\(b\))215 1688 y(s)h(:=)h("")215 1737 y(every)e(ii)i(:=)f
(!b.left)f(do)258 1787 y(s)i(||:=)f("\\n)43 b(<<<)21
b(")g(||)h(ii.v)f(||)g(")h(=)f(")h(||)f(expimage\(ii.value\))215
1837 y(s)g(||:=)g("\\n)43 b(------------------)o(-----)o(")215
1887 y(every)20 b(ii)i(:=)f(!b.right)f(do)258 1937 y(s)i(||:=)f("\\n)43
b(>>>)21 b(")g(||)h(ii.v)f(||)g(")h(=)f(")h(||)f(expimage\(ii.value\))
215 1986 y(return)f(s)171 2036 y(end)129 2088 y Fp(De\014nes:)171
2128 y Fl(balimage)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(139b,)g(143a,)
g(150a,)h(152,)f(and)h(154.)129 2167 y(Uses)h Fl(expimage)d
Fp(101a)h(and)h Fl(value)f Fp(136a.)p eop
%%Page: 157 157
157 156 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(balance.nw)81 b Fv(157)2 258 y Fp(157)89 b Fo(h)p
Fn(br)n(ain)15 b(dump)h Fp(157)p Fo(i)o(\021)994 b Fp(\(148b\))187
307 y Fr(debug\("Old)20 b(equations:"\))187 357 y(every)h(debug\(")f
(",)h(expimage\(!eqns\)\))187 407 y(write\(\\baldebug,)d("After)j
(substituting:",)e(envimage\(balmap)o(,)g("balmap"\)\))187
457 y(debug\("New)h(equations:"\))187 507 y(every)h(debug\(")f(",)h
(expimage\(!neweqns\)\))187 557 y(debug\(\))145 608 y
Fp(Uses)12 b Fl(baldebug)d Fp(11c,)h Fl(debug)g Fp(376a,)h
Fl(envimage)d Fp(27a,)j(and)g Fl(expimage)d Fp(101a.)p
eop
%%Page: 158 158
158 157 bop 129 141 a Fv(158)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)p eop
%%Page: 159 159
159 158 bop 145 569 a Fq(Chapter)32 b(8)145 777 y Fu(Constructors)145
1080 y Fj(8.1)66 b(Creating)23 b(and)g(c)n(hec)n(king)h(constructors)
145 1179 y Ft(8.1.1)56 b(Basic)18 b(t)n(yp)r(es)145 1256
y Fv(Most)f(of)e(the)h(elemen)o(ts)g(of)g(a)f(constructor)j(are)e
(straigh)o(t)g(out)g(of)f(the)i(concrete)h(syn)o(tax.)145
1306 y(Op)q(erands)h(ma)o(y)c(b)q(e)j Fr(literal)e Fv(or)h
Fr(input)p Fv(.)27 b Fr(type)16 b Fv(is)h(a)g Fr(constype)p
Fv(.)26 b Fr(rho)17 b Fv(is)g(a)g(bit)g(o)q(dd;)145 1355
y(it)g(con)o(tains)g(the)g(initial)e(bindings)i(used)g(to)g(ev)n
(aluate)g(the)g(patterns)i(in)d(the)i(branc)o(hes,)145
1405 y(including)10 b(an)o(y)g(bindings)f(in)o(tro)q(duced)j(as)e(part)
h(of)e(explo)q(ding)h(the)h(constructor's)h(op)q(co)q(de.)145
1455 y(The)h(constructor's)g Fr(tag)e Fv(is)h(used)h(to)e(iden)o(tify)g
(instances)j(of)d(that)h(constructor.)19 b(T)m(ags)11
b(are)145 1505 y(unique)j(only)f(within)g(constructor)j(t)o(yp)q(es.)
208 1555 y(T)m(o)d(eac)o(h)h(branc)o(h)g(w)o(e)h(add)e(the)i(solution)e
(to)h(its)f(equations.)208 1604 y(The)i(constructor)h(t)o(yp)q(e)g(k)o
(eeps)g(trac)o(k)f(of)f(its)h(mem)o(b)q(ers,)e(the)j(n)o(um)o(b)q(er)e
(of)g(tags)h(used,)145 1654 y(and)20 b(the)h(line)f(on)f(whic)o(h)h
(the)h(t)o(yp)q(e)g(itself)f(w)o(as)g(used)h(\(to)f(enforce)h
(de\014nition)f(b)q(efore)145 1704 y(use\).)j(The)16
b Fr(members)e Fv(\014eld)h(is)g(initially)e(a)i(set.)23
b(When)15 b(the)h(t)o(yp)q(e)g(is)f(\014rst)h(used,)g(it)e(m)o(ust)145
1754 y(b)q(e)19 b(complete,)f(so)h(the)g Fr(members)d
Fv(are)j(turned)g(in)o(to)f(a)g(list)f(\(in)h(alphab)q(etical)g(order)h
(b)o(y)145 1804 y(constructor)d(name\).)2 1866 y Fp(159)89
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i\021)1202 b Fp(160)5
b Fm(.)187 1916 y Fr(record)20 b(constructor\(name,)f(opcode,)h
(operands,)g(type,)h(branches,)f(rho,)h(tag\))187 1966
y(record)f(branch\(eqns,)g(soln,)g(pat\))187 2015 y(record)g
(constype\(name,)f(members,)h(used,)h(ntags\))145 2067
y Fp(De\014nes:)187 2107 y Fl(branch)p Fp(,)9 b(used)i(in)g(c)o(h)o
(unks)f(161a,)g(165d,)g(190,)g(192,)h(and)g(193b.)187
2146 y Fl(constructo)o(r)p Fp(,)e(used)i(in)g(c)o(h)o(unks)g(14f,)g
(17a,)g(32,)g(41a,)g(46b,)g(49c,)g(81,)g(104b,)g(160{62,)e(165{67,)h
(171a,)228 2186 y(176,)h(181b,)f(190,)g(192,)h(193,)f(197b,)g(208{11,)g
(215,)g(224a,)g(232a,)h(243,)f(and)h(367.)187 2225 y
Fl(constype)p Fp(,)e(used)h(in)i(c)o(h)o(unks)e(17a,)g(32b,)h(33d,)f
(45d,)h(46b,)g(104b,)f(164a,)g(169,)h(171,)f(172a,)h(174a,)f(189a,)228
2264 y(203,)h(204a,)f(208a,)g(211a,)g(242b,)g(247,)h(250a,)f(256,)g
(262a,)h(311a,)f(and)g(317.)145 2304 y(Uses)i Fl(used)e
Fp(136a.)145 2366 y Fv(The)j(solution)f(\()p Fr(soln)p
Fv(\))f(in)h(a)g(branc)o(h)h(has)g(appropriate)f(expressions)i
(substituted)g(for)e(the)145 2416 y(free)j(v)n(ariables)e(represen)o
(ting)j(the)e(inputs.)830 2604 y(159)p eop
%%Page: 160 160
160 159 bop 129 141 a Fv(160)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Ft(8.1.2)56
b(In)n(terpreting)15 b(and)h(c)n(hec)n(king)g(constructor)g(sp)r
(eci\014cations)192 334 y Fv(The)k(parser)h(calls)e Fr
(note_constructor)d Fv(when)k(it)g(sees)h(a)e(constructor)i(sp)q
(eci\014ca-)129 384 y(tion.)d(One)13 b(sp)q(eci\014cation)h(ma)o(y)d
(create)j(man)o(y)d(constructors;)j Fr(note_constructor)c
Fv(calls)129 434 y Fr(explode)j Fv(to)h(generate)h(them)e(all.)k(Its)d
(e\013ects)i(are:)192 517 y Fo(\017)k Fv(add)14 b(the)g(constructor)i
(to)e(the)g(mem)o(b)q(ers)f(of)g(its)h(t)o(yp)q(e)192
600 y Fo(\017)20 b Fv(mak)o(e)11 b(sure)i(the)g(t)o(yp)q(e)f(hasn't)h
(b)q(een)g(used)g(an)f(an)g(argumen)o(t)f(to)h(another)g(construc-)233
650 y(tor)i(\(th)o(us)h(a)o(v)o(oiding)d(p)q(ossible)i(recursion\))192
733 y Fo(\017)20 b Fv(add)14 b(the)g(constructor)i(to)e(the)g
Fr(constructors)e Fv(name)g(space)-13 816 y Fp(160)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1053
b Fm(/)5 b Fp(159)22 b(161a)5 b Fm(.)171 866 y Fr(procedure)20
b(note_constructor\()o(opcod)o(e,)f(operands,)h(type,)g(branches\))258
915 y(local)h(cons,)g(template)258 1015 y Fo(h)p Fn(to)15
b(avoid)g(cir)n(cularity,)f(make)h(sur)n(e)f Fr(type)g
Fn(has)i(never)f(b)n(e)n(en)g(use)n(d)g Fp(165b)p Fo(i)258
1065 y Fr(template)20 b(:=)i(constemplate\(typ)o(e,)d(opcode,)h
(operands,)g(branches\))258 1115 y(every)h(cons)g(:=)g
(explode\(opcode,)e(template,)h(globals\))g(do)h({)345
1164 y(if)h(/constructors[co)o(ns.na)o(me])d(:=)i(cons)g(then)g({)432
1214 y(verbose\("New)f(constructor)f(",)j(cons.name\))432
1264 y(put\(conslist,)e(cons\))432 1314 y(insert\(type.members,)e
(cons\))432 1364 y Fo(h)p Fn(if)d(\014rst)f(time)h(thru,)f(che)n(ck)h
(for)g(unuse)n(d)h(de\014nitions)f(in)g Fr(cons)f Fp(165c)p
Fo(i)345 1414 y Fr(})22 b(else)f(if)g(*crhs\(constructors[)o(cons)o
(.name)o(]\).di)o(sjunc)o(ts)e(=)i(0)h(then)f({)432 1463
y(verbose\("Replacing)e(vacuous)h(constructor)f(",)j(cons.name\))432
1513 y(constructors[cons.na)o(me])d(:=)i(cons)432 1563
y(put\(conslist,)f(cons\))432 1613 y(insert\(type.members,)e(cons\))432
1663 y Fo(h)p Fn(if)d(\014rst)f(time)h(thru,)f(che)n(ck)h(for)g(unuse)n
(d)h(de\014nitions)f(in)g Fr(cons)f Fp(165c)p Fo(i)345
1712 y Fr(})22 b(else)f(if)g(*crhs\(cons\).disjunc)o(ts)e(=)i(0)h(then)
f({)432 1762 y(verbose\("Ignoring)e(extra,)h(vacuous)h(constructor)e
(",)j(cons.name\))345 1812 y(})g(else)f({)432 1862 y
(warning\("Ignoring)e(duplicate)h(definition)f(of)j(constructor)d(",)j
(cons.name\))171 1912 y(#)239 b(PPxwrite\(PPnew\(&erro)o(ut\),)171
1962 y(#)327 b("Keeping)20 b($t$o",)g(ppexpimage\(crhs\(con)o(struc)o
(tors[)o(cons.)o(name)o(]\)\),)e("$b$n",)171 2011 y(#)327
b("Discarding)19 b($t$o",)i(ppexpimage\(crhs\()o(cons\))o(\),)e("$b"\))
345 2061 y(})258 2111 y(})258 2161 y(return)171 2211
y(end)129 2262 y Fp(De\014nes:)171 2302 y Fl(note_const)o(ruc)o(tor)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(44a.)129 2341 y(Uses)14
b Fl(conslist)c Fp(32a,)i Fl(constempl)o(ate)e Fp(161a,)h
Fl(constructo)o(r)f Fp(159,)i Fl(constructor)o(s)e Fp(32a,)i
Fl(crhs)g Fp(168,)171 2381 y Fl(explode)d Fp(162b,)h
Fl(globals)g Fp(32a,)g Fl(ppexpimage)e Fp(101d,)i(and)h
Fl(verbose)e Fp(18a.)p eop
%%Page: 161 161
161 160 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(161)208 258 y(A)12 b(constructor)j(sp)q
(eci\014cation)e(de\014nes)h(one)f(or)g(more)e(constructors.)20
b(\(Multiple)12 b(con-)145 307 y(structors)24 b(are)e(sp)q(eci\014ed)h
(b)o(y)e(en)o(umerating)g(disjuncts)h(of)f(patterns)i(that)f(app)q(ear)
g(in)145 357 y(the)f(op)q(co)q(de,)i(or)e(b)o(y)f(en)o(umerating)g(v)n
(alues)g(of)g(\014elds)h(that)g(app)q(ear)g(in)f(the)h(op)q(co)q(de.\))
145 407 y Fr(constemplate)12 b Fv(returns)k(a)e(template)f(that)h(is)g
(\014lled)g(in)g(di\013eren)o(tly)g(for)g(eac)o(h)h(construc-)145
457 y(tor)20 b(\(b)o(y)f Fr(explode)p Fv(\).)33 b Fr
(instantiate_templa)o(te)16 b Fv(is)k(called)f(b)o(y)g
Fr(explode)f Fv(to)h(create)i(a)145 507 y(complete)15
b Fr(Stype)g Fv(from)f(a)h(template)g(and)h(en)o(vironmen)o(t)e
Fr(rho)p Fv(.)23 b(Di\013erences)18 b(b)q(et)o(w)o(een)f(a)145
557 y(template)c(and)h(a)g(full-\015edged)f(constructor:)208
631 y Fo(\017)20 b Fv(A)14 b(template)f(has)h(no)g(name,)e(initial)g
(en)o(vironmen)o(t,)g(or)i(tag)-15 705 y Fp(161a)88 b
Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1050
b Fm(/)6 b Fp(160)22 b(161b)5 b Fm(.)187 755 y Fr(procedure)20
b(constemplate\(typ)o(e,)f(opcode,)h(operands,)g(branches\))230
805 y(local)h(inputs,)f(inputs_labs)230 854 y Fo(h)p
Fn(make)c Fr(inputs)d Fn(the)i(set)g(of)g(input)g(names,)g(b)n
(ar\014ng)g(if)g(duplic)n(ates)g(exist)f Fp(161c)p Fo(i)230
904 y Fr(B)22 b(:=)f([])230 954 y(every)g(b)h(:=)f(!branches)f(do)h({)h
(#)g(b)f(===)g([eqns,)g(pat])274 1004 y Fo(h)p Fn(make)15
b Fr(inputs_labs)e(inputs)h Fn(plus)g(lab)n(els)h(de\014ne)n(d)h(in)f
Fr(b[2])p Fn(,)e(b)n(ar\014ng)j(on)f(duplic)n(ates)g
Fp(162a)p Fo(i)274 1054 y Fr(put\(B,)21 b(branch\(b[1],)e
(inject_soln\(solve)o(\(bal)o(ance_)o(eqns\()o(b[1]\))o(,)g
(inputs_labs\)\),)579 1103 y(\\b[2])i(|)g(implicit_pattern\(op)o(code,)
d(operands\)\)\))230 1153 y(})230 1203 y(return)j(constructor\(&null)o
(,)e(&null,)i(operands,)e(type,)i(B,)h(&null,)e(&null\))187
1253 y(end)145 1303 y Fp(De\014nes:)187 1342 y Fl(constempla)o(te)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(160.)145 1381 y(Uses)15
b Fl(balance_eqn)o(s)d Fp(148b,)h Fl(branch)g Fp(159,)g
Fl(constructor)e Fp(159,)j Fl(implicit_p)o(att)o(ern)d
Fp(164a,)187 1421 y Fl(inject_sol)o(n)e Fp(170b,)h(and)g
Fl(solve)g Fp(136a.)208 1487 y Fr(instantiate_tem)o(plate)f
Fv(instan)o(tiates)k(the)g(templates)f(b)o(y)g(assigning)g(name,)f(en)o
(vi-)145 1537 y(ronmen)o(t,)e(and)h(branc)o(h)g(tags.)16
b(Both)10 b(the)g(list)f(of)g(branc)o(hes)i(and)e(the)h(branc)o(hes)h
(themselv)o(es)145 1587 y(ha)o(v)o(e)j(to)g(b)q(e)g(copied.)-17
1647 y Fp(161b)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p
Fv(+)p Fo(\021)1033 b Fm(/)5 b Fp(161a)22 b(162b)5 b
Fm(.)187 1697 y Fr(procedure)20 b(instantiate_temp)o(late\()o(op,)f(t,)
i(rho\))230 1746 y(/t.type.ntags)e(:=)j(0)230 1796 y(t.type.ntags)e
(+:=)h(1)230 1846 y Fo(h)p Fn(che)n(ck)16 b(that)f Fr(t.type.ntags)d
Fn(do)n(esn)l('t)j(over\015ow)g(tag)g(bits)f Fp(165e)p
Fo(i)230 1896 y Fr(return)21 b(constructor\(iname)o(\(op\),)d(op,)j
(t.operands,)f(t.type,)g(t.branches,)g(rho,)h(t.type.ntags\))187
1946 y(end)145 1995 y Fp(De\014nes:)187 2035 y Fl(instantiat)o(e_t)o
(em)o(pla)o(te)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(162b.)145
2074 y(Uses)i Fl(constructo)o(r)d Fp(159)i(and)f Fl(iname)g
Fp(164b.)-13 2151 y(161c)88 b Fo(h)p Fn(make)16 b Fr(inputs)d
Fn(the)i(set)g(of)g(input)g(names,)g(b)n(ar\014ng)g(if)g(duplic)n(ates)
g(exist)f Fp(161c)p Fo(i)o(\021)89 b Fp(\(161a\))187
2200 y Fr(inputs)20 b(:=)i(set\(\))187 2250 y(every)f(i)g(:=)h
(inputs_of_opera)o(nds\(o)o(peran)o(ds\))d(do)230 2300
y(if)j(member\(inputs,)d(i.name\))h(then)274 2350 y(error\("Input)f
(named)i(",)g(i.name,)g(")g(is)h(used)f(twice)f(in)i(one)f
(constructor"\))230 2400 y(else)274 2450 y(insert\(inputs,)e(i.name\))
145 2499 y Fp(Uses)12 b Fl(constructo)o(r)d Fp(159,)h
Fl(inputs_of_o)o(per)o(and)o(s)f Fp(166a,)h(and)g Fl(used)h
Fp(136a.)p eop
%%Page: 162 162
162 161 bop 129 141 a Fv(162)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Note)k(that)f
(duplicate)h(lab)q(els)g(are)g(OK,)f(b)q(ecause)j(they)e(could)f(app)q
(ear)h(in)g(di\013eren)o(t)129 307 y(disjuncts.)h(W)m(e)12
b(ha)o(v)o(e)f(to)h(sort)g(that)g(stu\013)h(out)e(later.)18
b(\(Also)11 b(note)h(that)g(implicit)d(patterns)129 357
y(nev)o(er)15 b(de\014ne)g(lab)q(els.\))-31 420 y Fp(162a)88
b Fo(h)p Fn(make)16 b Fr(inputs_labs)c(inputs)i Fn(plus)h(lab)n(els)f
(de\014ne)n(d)i(in)f Fr(b[2])p Fn(,)f(b)n(ar\014ng)h(on)h(duplic)n
(ates)f Fp(162a)p Fo(i)n(\021)86 b Fp(\(161a\))171 469
y Fr(if)21 b(\\b[2])g(then)g({)215 519 y(inputs_labs)e(:=)i
(copy\(inputs\))215 569 y(every)f(labname)h(:=)g(pattern_label_name)o
(s\(b[)o(2]\))e(do)258 619 y(if)j(member\(inputs,)c(labname\))j(then)
302 669 y(error\("label)e(name)i(",)g(labname,)g(":)g(conflicts)f(with)
h(constructor)e(input)i(name"\))258 718 y(else)302 768
y(insert\(inputs_la)o(bs,)e(labname\))171 818 y(})j(else)f({)215
868 y(inputs_labs)e(:=)i(inputs)171 918 y(})129 970 y
Fp(Uses)12 b Fl(constructor)c Fp(159,)i Fl(input)g Fp(46a,)h
Fl(label)f Fp(383a,)g(and)h Fl(pattern_l)o(abe)o(l_n)o(ame)o(s)e
Fp(79a.)192 1032 y Fr(explode)17 b Fv(generates)k(all)d(those)i
(constructors)i(denoted)e(b)o(y)f(a)g(single)g(constructor)129
1082 y(sp)q(eci\014cation)e(b)o(y)e(en)o(umerating)g(disjuncts)i(and)e
(\014eld)h(v)n(alues)g(for)f(disjuncts)h(and)g(\014elds)129
1131 y(that)f(app)q(ear)h(in)e(the)i(constructor's)g(op)q(co)q(de.)22
b(Those)15 b(disjuncts)h(and)f(\014elds)g(are)g(b)q(ound)129
1181 y(in)f(the)g(initial)e(en)o(vironmen)o(t)h(for)h(the)g
(constructor.)-33 1244 y Fp(162b)88 b Fo(h)p Fn(*)16
b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(161b)23
b(163b)t Fm(.)171 1293 y Fr(procedure)d(explode\(opcode,)f(template,)h
(rho,)g(frame\))258 1343 y(/frame)h(:=)g(table\(\))258
1393 y(l)h(:=)f(copy\(opcode\))258 1443 y(if)h(type\(p)e(:=)h(l[i)h(:=)
f(1)h(to)f(*l]\))g(==)g("pattern")f(then)h({)345 1493
y(every)g(l[i])g(:=)g(!p.disjuncts)f(do)h({)432 1542
y(add_to_frame\(p.name,)d(pattern\([l[i]],)h(\\l[i].name)h(|)h
(p.name\),)f(frame\))432 1592 y(suspend)h(explode\(l,)f(template,)f
(rho,)i(frame\))432 1642 y(delete\(frame,)f(p.name\))345
1692 y(})258 1742 y(})i(else)f(if)g(type\(f)g(:=)g(l[i)g(:=)h(1)f(to)h
(*l]\))e(==)i("field")e(then)h({)345 1791 y(t)h(:=)f
(fieldname_table\(f\);)d Fo(h)p Fn(insist)d(on)g Fr(*\\t)21
b(>)h(0)14 b Fp(163a)p Fo(i)345 1841 y Fr(every)21 b(x)h(:=)f(t[l[i])g
(:=)g(key\(t\)])f(do)i({)432 1891 y(add_to_frame\(f.name,)c
(inject\(conspat\(f,)g("=",)j(x\),)h(x,)f(&null\),)f(frame\))432
1941 y(suspend)h(explode\(l,)f(template,)f(rho,)i(frame\))432
1991 y(delete\(frame,)f(f.name\))345 2041 y(})258 2090
y(})i(else)345 2140 y(suspend)f(instantiate_temp)o(late\()o(l,)e
(template,)h(extendscope\(rho,)e(copy\(frame\)\)\))171
2190 y(end)129 2242 y Fp(De\014nes:)171 2281 y Fl(explode)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(160.)129 2321 y(Uses)j
Fl(add_to_fram)o(e)d Fp(26a,)h Fl(conspat)g Fp(61,)h
Fl(extendscop)o(e)e Fp(26c,)h Fl(field)h Fp(55,)f Fl(fieldname_ta)o(bl)
o(e)f Fp(356a,)171 2360 y Fl(inject)g Fp(29,)g Fl(instantiate)o(_te)o
(mpl)o(ate)e Fp(161b,)i(and)h Fl(pattern)e Fp(55.)p eop
%%Page: 163 163
163 162 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(163)-15 258 y Fp(163a)88
b Fo(h)p Fn(insist)15 b(on)g Fr(*\\t)21 b(>)h(0)15 b
Fp(163a)p Fo(i)n(\021)775 b Fp(\(162b)10 b(163b\))187
307 y Fr(*\\t)21 b(>)h(0)f(|)h(error\("Can't)d(use)i(field)g(`",)g
(f.name,)f("')i(in)f(opcode)g(without)f(supplying)g(field)h(names"\))
145 359 y Fp(Uses)12 b Fl(field)e Fp(55.)208 430 y Fv(F)m(or)f
(constructor)i(applications,)e(w)o(e)g(explo)q(de)h(the)g(applied)f
(constructor's)i(name,)e(\014rst)145 480 y(using)15 b(the)h
(constructor's)h(\\lo)q(cal")d(en)o(vironmen)o(t\(s\))h(then)h(the)g
(global)e(en)o(vironmen)o(t)h(to)145 530 y(determine)g(the)g(meaning)d
(of)i(the)h(applied)f(constructor's)i(name.)j(F)m(or)14
b(example,)f(in)h(the)145 579 y(de\014nition)k(of)g(the)h(constructors)
h(generated)g(b)o(y)e Fr(P^Y)p Fv(,)f(the)i(pattern)h
Fr(P)e Fv(is)g(b)q(ound)g(to)h Fr(A)145 629 y Fv(in)e(the)g(en)o
(vironmen)o(t)f(created)j(for)e(the)g(constructor)i Fr(A^Y)d
Fn(or)h Fv(is)g(b)q(ound)g(to)g Fr(B)g Fv(in)f Fr(B^Y)p
Fv('s)145 679 y(en)o(vironmen)o(t.)h(In)d(the)g(de\014nition)g(of)f
(the)i(constructor)g Fr(R)p Fv(,)e(ho)o(w)o(ev)o(er,)h
Fr(P)f Fv(is)h(not)g(b)q(ound)g(in)145 729 y Fr(R)p Fv('s)f(en)o
(vironmen)o(t,)f(therefore)j(its)e(meaning)e(in)i(the)h(global)d(en)o
(viromen)o(t)h(is)h(used,)h(i.e.,)e Fr(\(A)145 779 y(|)22
b(B\)\(s\))13 b Fv(whic)o(h)g(is)h Fr(A\(s\))21 b(|)h(B\(s\))p
Fv(.)145 862 y Fr(patterns)108 b(P)21 b(is)h(A)f(|)h(B)145
911 y(constructors)189 961 y(P)f(r)h(is)f(r)189 1011
y(P^Y)g(s)h(is)f(P\(s\))g(&)h(Y)189 1061 y(R)f(s)h(is)f(P\(s\))208
1144 y(explode_names)16 b Fv(uses)k(a)f(pattern's)g(name)f(if)g(it)h
(is)g(b)q(ound)g(in)g Fr(rho)p Fv(,)g(otherwise)h(it)145
1194 y(explo)q(des)15 b(its)f(disjunct's)g(names.)-17
1256 y Fp(163b)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p
Fv(+)p Fo(\021)1033 b Fm(/)5 b Fp(162b)22 b(164a)5 b
Fm(.)187 1306 y Fr(procedure)20 b(explode_names\(op)o(code,)e(rho\))274
1356 y(l)k(:=)f(copy\(opcode\))274 1405 y(if)g(type\(p)g(:=)g(l[i)g(:=)
h(1)f(to)h(*l]\))f(==)g("pattern")f(then)h({)361 1455
y(if)h(l[i])e(:=)i(\\lookup\(p.name,)d(\\rho\))h(then)448
1505 y(suspend)h(explode_names\(l\))361 1555 y(else)g(every)g(l[i])g
(:=)g(!p.disjuncts)f(do)h({)448 1605 y(suspend)g(explode_names\(l\))361
1654 y(})274 1704 y(})h(else)f(if)g(type\(f)f(:=)i(l[i)f(:=)g(1)h(to)f
(*l]\))g(==)h("field")e(then)h({)361 1754 y(t)h(:=)f
(fieldname_table\(f\))o(;)e Fo(h)p Fn(insist)c(on)g Fr(*\\t)21
b(>)h(0)14 b Fp(163a)p Fo(i)361 1804 y Fr(every)21 b(x)g(:=)h(t[l[i])e
(:=)i(key\(t\)])e(do)448 1854 y(suspend)h(explode_names\(l\))274
1904 y(})h(else)361 1953 y(suspend)e(iname\(l\))187 2003
y(end)145 2055 y Fp(De\014nes:)187 2095 y Fl(explode_na)o(mes)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(41b,)h(48b,)f(and)h(52e.)145
2134 y(Uses)h Fl(field)e Fp(55,)h Fl(fieldname_)o(tab)o(le)d
Fp(356a,)i Fl(iname)g Fp(164b,)g Fl(lookup)g Fp(25a,)h(and)f
Fl(pattern)f Fp(55.)p eop
%%Page: 164 164
164 163 bop 129 141 a Fv(164)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(An)k(implicit)e
(pattern)j(conjoins)g(all)e(the)i(pattern)g(and)g(\014eld)f(names)g
(app)q(earing)g(in)129 307 y(the)e(op)q(co)q(de)g(and)e(op)q(erands.)
-31 370 y Fp(164a)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o
Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(163b)23 b(164b)t Fm(.)171
420 y Fr(procedure)d(implicit_pattern\()o(opcod)o(e,)f(operands\))215
469 y(l)i(:=)h([])215 519 y(every)e(op)i(:=)f(!opcode)f(do)258
569 y(case)h(type\(op\))f(of)i({)302 619 y("pattern")e(:)h(put\(l,)g
(Pident\(\\op.name\))o(\))e(|)j(impossible\("unna)o(med)d(opcode)h
(pattern"\))302 669 y("field")64 b(:)21 b(put\(l,)g
(Pident\(op.name\)\))258 718 y(})215 768 y(every)f(ipt)h(:=)h
(inputs_of_operand)o(s\(ope)o(rand)o(s\))d(do)258 818
y(if)j(type\(ipt.meanin)o(g\))d(==)i(\("field"|"integer")o(|"con)o
(stype)o("\))e(then)302 868 y(put\(l,)h(Pident\(ipt.name\)\))215
918 y(*l)h(>)h(0)f(|)258 967 y(error\("Cannot)e(use)i(implicit)g
(pattern)f(with)h(no)g(patterns)f(or)i(fields)e(on)i(lhs)f(\(",)389
1017 y(expimage\(opcode\),)d("\)"\))215 1067 y(return)i(Pand\(l\))171
1117 y(end)129 1169 y Fp(De\014nes:)171 1208 y Fl(implicit_p)o(att)o
(ern)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(161a.)129 1248
y(Uses)15 b Fl(constype)c Fp(159,)i Fl(expimage)f Fp(101a,)g
Fl(field)h Fp(55,)g Fl(inputs_of_o)o(pe)o(ran)o(ds)e
Fp(166a,)i Fl(Pand)g Fp(41a,)171 1287 y Fl(pattern)c
Fp(55,)i(and)g Fl(Pident)e Fp(41a.)192 1349 y Fv(These)15
b(auxiliary)d(functions)i(help)g(c)o(ho)q(ose)h(names)e(for)g
(constructors.)-33 1412 y Fp(164b)88 b Fo(h)p Fn(*)16
b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(164a)22
b(165a)5 b Fm(.)171 1461 y Fr(procedure)20 b(iname\(opcode\))215
1511 y(local)g(name)215 1561 y(name)h(:=)g("")215 1611
y(every)f(name)h(||:=)g(opcode_component_na)o(me\(!)o(opcod)o(e\))215
1661 y(if)g(\\lowercons)f(then)h(name)g(:=)g(map\(name\))215
1711 y(return)f(mapoutbadchars\(nam)o(e\))171 1760 y(end)171
1860 y(procedure)g(opcode_component_)o(name\()o(op\))215
1910 y(return)g(case)h(type\(op\))f(of)i({)411 1960 y("string")63
b(:)22 b(op)411 2009 y("disjunct")d(:)j({)454 2059 y(if)g(*\\op.name)e
(=)h(0)h(then)f(impossible\("disj)o(unct)d(with)j(empty)g(name"\))454
2109 y(\\op.name)f(|)i("???unnamed)e(disjunct???")454
2159 y(})411 2209 y(default)g(:)i(impossible\("opco)o(de)d(component",)
g(image\(op\)\))367 2258 y(})171 2308 y(end)129 2360
y Fp(De\014nes:)171 2400 y Fl(iname)p Fp(,)10 b(used)g(in)h(c)o(h)o
(unks)f(100a,)g(161b,)h(163b,)f(and)g(167.)171 2439 y
Fl(opcode_com)o(pon)o(ent)o(_na)o(me)o Fp(,)f(used)i(in)g(c)o(h)o(unk)f
(238a.)129 2478 y(Uses)i Fl(disjunct)d Fp(55,)i Fl(lowercons)d
Fp(18a,)j(and)g Fl(mapoutbad)o(cha)o(rs)d Fp(165a.)p
eop
%%Page: 165 165
165 164 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(165)-15 258 y Fp(165a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(164b)22 b(166a)5 b Fm(.)187 307 y Fr(procedure)20
b(mapoutbadchars\(n)o(ame\))230 357 y(static)h(nonalnum,)f(underscores)
230 407 y(initial)h({)274 457 y(nonalnum)f(:=)h(string\(&ascii)f(--)h
(&letters)f(--)h(&digits)g(--)g('_'\))274 507 y(underscores)e(:=)j
(repl\("_",)e(*nonalnum\))230 557 y(})230 606 y(return)h(map\(name,)f
(nonalnum,)g(underscores\))187 656 y(end)145 708 y Fp(De\014nes:)187
747 y Fl(mapoutbadc)o(har)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f
(164b)g(and)h(226.)-17 839 y(165b)88 b Fo(h)p Fn(to)15
b(avoid)h(cir)n(cularity,)d(make)i(sur)n(e)g Fr(type)f
Fn(has)h(never)g(b)n(e)n(en)g(use)n(d)g Fp(165b)p Fo(i)o(\021)173
b Fp(\(160\))187 889 y Fr(if)21 b(\\type.used)f(then)230
938 y(error\("You)g(can't)h(create)f(new)i(constructors)d(of)i(type)g
(",)h(type.name,)361 988 y("!\\n\\tThat)e(name)h(has)g(already)f(been)h
(used)g(\(on)g(line",)g(type.used,)f("\)"\))145 1040
y Fp(Uses)12 b Fl(constructo)o(rs)c Fp(32a,)j Fl(line)f
Fp(359a,)g(and)h Fl(used)f Fp(136a.)-13 1131 y(165c)88
b Fo(h)p Fn(if)15 b(\014rst)f(time)h(thru,)f(che)n(ck)h(for)g(unuse)n
(d)h(de\014nitions)f(in)g Fr(cons)f Fp(165c)p Fo(i)o(\021)225
b Fp(\(160\))187 1181 y Fr(if)21 b(/checked)f(then)h({)230
1231 y(checked)g(:=)g(1)230 1281 y Fo(h)p Fn(che)n(ck)16
b(for)e(unuse)n(d)i(de\014nitions)g(in)f Fr(cons)f Fp(165d)p
Fo(i)187 1331 y Fr(})-17 1422 y Fp(165d)88 b Fo(h)p Fn(che)n(ck)16
b(for)e(unuse)n(d)i(de\014nitions)g(in)f Fr(cons)f Fp(165d)p
Fo(i)n(\021)529 b Fp(\(165c\))187 1472 y Fr(every)21
b(i)g(:=)h(1)f(to)g(*cons.branches)e(&)j(b)g(:=)f(cons.branches[i])d
(do)k({)230 1522 y(u)g(:=)f(copy\(b.soln.used\))230 1571
y(every)g(insert\(u,)f(pattern_free_varia)o(bles\()o(b.pa)o(t\)\))230
1621 y(d)i(:=)f(copy\(b.soln.defined)o(\))230 1671 y(every)g
(insert\(d,)f(key\(cons.rho[1)f(to)i(*cons.rho)f(-)i(1]\))f(|)h
(inputs_of\(cons\).)o(name)o(\))230 1721 y(every)f(x)h(:=)f
(!\(d--u--fresh_vari)o(ables)o(\))e(do)274 1771 y(warning\()318
1821 y(if)i(\\cons.rho[1)e(to)j(*cons.rho-1][x])d(then)h("opcode)h
(part")318 1870 y(else)g(if)g(member\(b.soln.def)o(ined,)d(x\))k(then)e
("equation)g(result")318 1920 y(else)h("operand",)318
1970 y(")g(",)h(image\(x\),)d(")j(not)f(used)g(in)h(constructor)d(",)i
(cons.name,)427 2020 y(if)g(\(*cons.branches)e(=)i(1\))h(then)f(".")427
2070 y(else)f(")i(in)f(")h(||)f(ordinal\(i\))f(||)i(")f(branch."\))187
2119 y(})145 2171 y Fp(Uses)12 b Fl(branch)f Fp(159,)g
Fl(construct)o(or)e Fp(159,)i Fl(defined)f Fp(136a,)g
Fl(fresh_varia)o(ble)o(s)f Fp(155b,)i Fl(inputs_of)e
Fp(166a,)187 2211 y Fl(ordinal)g Fp(167c,)h Fl(pattern_fre)o(e_v)o(ari)
o(ab)o(les)e Fp(78b,)j(and)f Fl(used)h Fp(136a.)-13 2302
y(165e)88 b Fo(h)p Fn(che)n(ck)16 b(that)f Fr(t.type.ntags)d
Fn(do)n(esn)l('t)j(over\015ow)g(tag)g(bits)f Fp(165e)p
Fo(i)o(\021)279 b Fp(\(161b\))187 2352 y Fr(if)21 b(t.type.ntags)e(>=)j
(2^11)f(then)230 2402 y(impossible\("Too)e(many)i(type)g(tags)g(---)g
(change)g(mclib.nw)f(\(struct)g(instance\),)g(constructors.nw"\))145
2454 y Fp(Uses)12 b Fl(constructo)o(rs)c Fp(32a.)p eop
%%Page: 166 166
166 165 bop 129 141 a Fv(166)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Fj(8.2)67
b(Utilit)n(y)25 b(functions)129 357 y Ft(8.2.1)56 b(Input)18
b(generation)129 433 y Fr(inputs_of\(cons,)h(t\))10 b
Fv(generates)h(the)g(inputs)f(with)g(meanings)f(of)g(t)o(yp)q(e)h
Fr(t)p Fv(,)h(or)f(all)e(inputs)129 483 y(if)13 b Fr(t)h
Fv(is)g(omitted.)-31 546 y Fp(166a)88 b Fo(h)p Fn(*)16
b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1033 b Fm(/)5 b Fp(165a)23
b(166b)t Fm(.)171 595 y Fr(procedure)d(inputs_of\(cons,)f(t\))215
645 y(suspend)h(inputs_of_operand)o(s\(con)o(s.ope)o(rand)o(s,)f(t\))
171 695 y(end)171 745 y(procedure)h(inputs_of_operand)o(s\(ops)o(,)f
(t\))215 795 y(type\(ops\))g(==)j("list")e(|)i(impossible\("input)o
(s_of")o(\))215 844 y(suspend)e(if)h(\\t)h(then)f(\(type\(i)f(:=)h
(!ops\))g(==)g("input",)g(type\(i.meaning\))d(==)k(t,)f(i\))389
894 y(else)152 b(\(type\(i)20 b(:=)h(!ops\))g(==)g("input",)500
b(i\))171 944 y(end)129 996 y Fp(De\014nes:)171 1035
y Fl(inputs_of)p Fp(,)9 b(used)i(in)g(c)o(h)o(unks)g(97b,)g(108b,)f
(131e,)h(165d,)f(166b,)h(169,)g(172,)g(173,)g(188b,)f(189a,)h(201b,)212
1075 y(203,)g(204a,)f(211{13,)g(215,)g(243,)g(246,)h(250b,)f(254,)h
(315,)f(317,)h(318c,)f(and)g(368a.)171 1114 y Fl(inputs_of_)o(ope)o
(ran)o(ds)p Fp(,)e(used)j(in)g(c)o(h)o(unks)f(161c,)g(164a,)g(and)h
(243.)129 1154 y(Uses)h Fl(input)e Fp(46a.)192 1216 y
Fr(input_named\(cons)o(,)19 b(n\))13 b Fv(returns)j(the)e(input)g
(named)f Fr(n)g Fv(if)g(there)j(is)d(one.)-33 1278 y
Fp(166b)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p
Fo(\021)1037 b Fm(/)5 b Fp(166a)22 b(166c)5 b Fm(.)171
1328 y Fr(procedure)20 b(input_named\(cons,)e(n\))215
1378 y(return)i(if)h(i)h(:=)f(inputs_of\(cons\))e(&)j(i.name)e(==)i(n)f
(then)g(i)171 1428 y(end)129 1480 y Fp(De\014nes:)171
1519 y Fl(input_name)o(d)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(209c)h
(and)f(219b.)129 1558 y(Uses)i Fl(inputs_of)d Fp(166a.)129
1687 y Ft(8.2.2)56 b(Chec)n(king)18 b(constructor)g(t)n(yp)r(es)129
1764 y Fv(The)12 b(t)o(w)o(o)e Fr(enforce)f Fv(functions)i(distinguish)
f(b)q(et)o(w)o(een)i(t)o(yp)q(ed)g(and)e(un)o(t)o(yp)q(ed)h
(constructors)129 1814 y(b)o(y)j(comparing)e(their)i(argumen)o(t)f(\(a)
h(constructor)h(t)o(yp)q(e\))g(to)f(the)g(anon)o(ymous)e(t)o(yp)q(e.)
-29 1876 y Fp(166c)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o
Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(166b)23 b(166d)t Fm(.)171
1926 y Fr(procedure)d(enforce_instance\()o(ct\))215 1975
y(return)g(instructionctype)f(~===)i(ct)g(|)h(impossible\("ins)o(tance)
c(of)k(untyped)e(constructor"\))171 2025 y(end)129 2077
y Fp(De\014nes:)171 2117 y Fl(enforce_in)o(sta)o(nce)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(202b.)129 2156 y(Uses)j
Fl(constructor)c Fp(159)j(and)f Fl(instruction)o(cty)o(pe)e
Fp(32a.)-33 2239 y(166d)88 b Fo(h)p Fn(*)16 b Fp(159)p
Fo(i)o Fv(+)p Fo(\021)1037 b Fm(/)5 b Fp(166c)22 b(167a)5
b Fm(.)171 2289 y Fr(procedure)20 b(enforce_closure\(c)o(t\))215
2339 y(return)g(instructionctype)40 b(===)22 b(ct)f(|)h
(impossible\("clo)o(sure)c(of)k(typed)f(constructor"\))171
2388 y(end)129 2440 y Fp(Uses)12 b Fl(constructor)c Fp(159)j(and)f
Fl(instruction)o(cty)o(pe)e Fp(32a.)p eop
%%Page: 167 167
167 166 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(167)145 258 y Ft(8.2.3)56
b(Miscellan)n(y)145 334 y Fr(cons_named)15 b Fv(pro)q(duces)j(the)f
(constructor)i(named)c Fr(s)i Fv(and)f(issues)i(an)f(error)g(if)f(no)h
(suc)o(h)145 384 y(constructor)j(exists.)31 b Fr(is_constructor)15
b Fv(tests)k(if)e Fr(s)h Fv(is)g(a)f(constructor)j(and)d(prin)o(ts)i
(an)145 434 y(optional)13 b(message)g(if)g(it)h(is)g(not.)-15
496 y Fp(167a)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1031 b Fm(/)5 b Fp(166d)22 b(167b)5 b Fm(.)187
546 y Fr(procedure)20 b(cons_named\(s\))230 596 y(return)h
(is_constructor\(s,)d(error\))187 646 y(end)187 695 y(procedure)i
(is_constructor\(s)o(,)f(p\))230 745 y(return)i(\\constructors[s)e(|)i
(iname\([s]\)])f(|)h(\(\\p\)\(image\(s\),)e(")j(is)f(not)g(a)h
(constructor)d(name"\))187 795 y(end)145 847 y Fp(De\014nes:)187
886 y Fl(cons_named)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(41b,)i(79b,)f
(and)h(176.)187 926 y Fl(is_constru)o(cto)o(r)p Fp(,)d(used)j(in)g(c)o
(h)o(unks)f(48b)h(and)f(52e.)145 965 y(Uses)i Fl(constructo)o(r)d
Fp(159,)h Fl(constructor)o(s)f Fp(32a,)h(and)h Fl(iname)f
Fp(164b.)-17 1048 y(167b)88 b Fo(h)p Fn(*)15 b Fp(159)p
Fo(i)p Fv(+)p Fo(\021)1037 b Fm(/)5 b Fp(167a)22 b(167c)5
b Fm(.)187 1098 y Fr(procedure)20 b(discard_cons_nam)o(ed\(s\))230
1148 y(if)i(member\(construct)o(ors,)c(s)k(<-)f(\(s)h(|)f
(iname\([s]\)\)\))f(then)274 1198 y(delete\(constructo)o(rs,)f(s\))230
1248 y(else)274 1297 y(warning\("There)g(is)i(no)h(constructor)d(named)
i(",)g(s\))230 1347 y(return)187 1397 y(end)145 1449
y Fp(De\014nes:)187 1488 y Fl(discard_co)o(ns_)o(na)o(med)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(48b.)145 1528 y(Uses)i
Fl(constructo)o(r)d Fp(159,)h Fl(constructor)o(s)f Fp(32a,)h(and)h
Fl(iname)f Fp(164b.)-13 1619 y(167c)88 b Fo(h)p Fn(*)15
b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1050 b Fm(/)6 b Fp(167b)22
b(168)5 b Fm(.)187 1669 y Fr(procedure)20 b(ordinal\(n\))230
1719 y(return)h(case)g(n)g(of)h({)274 1768 y(1)g(:)f("1st")274
1818 y(2)h(:)f("2nd")274 1868 y(3)h(:)f("3rd")274 1918
y(default)f(:)i(n)f(||)h("th")230 1968 y(})187 2018 y(end)145
2069 y Fp(De\014nes:)187 2109 y Fl(ordinal)p Fp(,)9 b(used)h(in)i(c)o
(h)o(unks)d(165d)i(and)f(177c.)p eop
%%Page: 168 168
168 167 bop 129 141 a Fv(168)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Fj(8.3)67
b(Applying)24 b(constructors)129 357 y Ft(8.3.1)56 b(Righ)n
(t-hand-side)17 b(patterns)129 433 y Fv(F)m(or)i(ev)o(ery)h
(constructor,)h(I)e(compute)f(a)h(righ)o(t-hand)f(side,)i(whic)o(h)f
(is)g(a)f(pattern)i(with)129 483 y(free)c(v)n(ariables)d(for)h(the)h
(constructor's)h(inputs.)j(I)c(then)g(can)f(apply)g(the)h(constructor)h
(b)o(y)129 533 y(substituting)f(for)e(the)i(inputs.)192
583 y Fr(chrs)e Fv(computes)i(the)g(stu\013.)20 b(Ev)o(ery)15
b(input)f(mak)o(es)f(a)i(con)o(tribution)f(to)g(the)h(en)o(viron-)129
633 y(men)o(t.)k(I)c(don't)e(try)i(to)f(mak)o(e)f(constructor)j(inputs)
f(visible)f(as)g(lab)q(els.)20 b(This)14 b(is)g(p)q(erhaps)129
683 y(inconsisten)o(t)21 b(with)e(the)i(treatmen)o(t)e(of)g(free)i
(constructor)g(t)o(yp)q(es)g(in)e(matc)o(hing)f(state-)129
732 y(men)o(ts,)12 b(but)h(I)g(need)h(to)f(hear)g(an)g(argumen)o(t)e
(in)i(fa)o(v)o(or)e(b)q(efore)j(I'll)d(b)q(e)j(con)o(vinced)f(to)g(w)o
(ork)129 782 y(out)h(a)g(prop)q(er)h(seman)o(tics.)-13
844 y Fp(168)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(167c)23 b(170b)t Fm(.)171
894 y Fr(procedure)d(crhs\(cons\))215 944 y(local)g(rho,)h(labrho)215
994 y(static)f(cache)215 1044 y(initial)g(cache)h(:=)g(table\(\))215
1094 y(if)g(/cache[cons])e(then)i({)p Fo(h)p Fn(c)n(ompute)16
b(and)f(c)n(ache)h(p)n(attern)e(for)h Fr(cons)f Fp(169)p
Fo(i)171 1143 y Fr(PPxwrite\(PPnew\(\\m)o(debug)o(\),)19
b("crhs)i(for)g(",)g(cons.name,)f(")h(is)h(",)f(ppexpimage\(cache[c)o
(ons]\))o(\))171 1193 y(})215 1243 y(return)f(cache[cons])171
1293 y(end)129 1345 y Fp(De\014nes:)171 1384 y Fl(crhs)p
Fp(,)10 b(used)h(in)g(c)o(h)o(unks)f(160,)g(172a,)g(173a,)g(188b,)h
(233a,)f(and)g(308.)129 1424 y(Uses)i Fl(mdebug)e Fp(18a)g(and)h
Fl(ppexpimage)d Fp(101d.)p eop
%%Page: 169 169
169 168 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(169)2 258 y Fp(169)89 b
Fo(h)p Fn(c)n(ompute)16 b(and)f(c)n(ache)h(p)n(attern)f(for)f
Fr(cons)g Fp(169)p Fo(i)o(\021)567 b Fp(\(168\))187 307
y Fr(rho)21 b(:=)g(newscope\(cons.rho\))187 357 y(every)g(ipt)g(:=)g
(inputs_of\(cons\))e(do)230 407 y(case)i(type\(ipt.meaning\))e(of)i({)
274 457 y("constype")f(:)361 507 y(add_to_rho\(ipt.nam)o(e,)f
(inject\(consinput)o(_patt)o(ern\(i)o(pt\),)f(&null,)j(ipt\),)g(rho\))
274 557 y("field")f(|)i("integer")e(:)361 606 y(add_to_rho\(ipt.nam)o
(e,)f(inject\(fieldinpu)o(t_pat)o(tern\()o(ipt\),)f(ipt.name,)i
(&null\),)g(rho\))274 656 y("string"|)g("null")g(:)361
706 y(add_to_rho\(ipt.nam)o(e,)f(inject\(&null,)g(ipt.name,)h(&null\),)
g(rho\))274 756 y(default)86 b(:)21 b(impossible\("input)e(type"\))230
806 y(})187 855 y(p)i(:=)h(&null)187 905 y(every)f(b)g(:=)h
(!cons.branches)c(do)k({)230 955 y Fo(h)p Fn(c)n(onvert)15
b(br)n(anch)h Fr(b)e Fn(to)h(a)g(p)n(attern)g Fr(q)f
Fp(170a)p Fo(i)230 1005 y Fr(p)22 b(:=)f(orp\(\\p,)g(q\))g(|)h(q)187
1055 y(})187 1104 y(cache[cons])d(:=)j(subst\(eliminate_)o(contr)o
(adict)o(ions)o(\(p\),)c("nonexistent)i(variable",)f(0\))557
1154 y(#)j(can't)f(afford)f(to)i(simplify)e(--)h(makes)g(it)g(too)g
(hard)g(to)h(solve)e(eqns)535 1204 y(#)i(subst)f(eliminates)f(bad)h
(tag)g(conditions)145 1256 y Fp(Uses)f Fl(add_to_rho)d
Fp(26a,)h Fl(consinput_p)o(att)o(ern)e Fp(171a,)j Fl(constype)e
Fp(159,)187 1295 y Fl(eliminate_)o(con)o(tr)o(adi)o(cti)o(ons)d
Fp(71b,)i Fl(field)f Fp(55,)h Fl(fieldinput_)o(pat)o(ter)o(n)e
Fp(172b,)187 1335 y Fl(inject)9 b Fp(29,)i Fl(input)f
Fp(46a,)h Fl(inputs_of)d Fp(166a,)j Fl(newscope)e Fp(26b,)h
Fl(orp)h Fp(63a,)f Fl(simplify)f Fp(92a,)i Fl(solve)f
Fp(136a,)187 1374 y(and)g Fl(subst)g Fp(88b.)p eop
%%Page: 170 170
170 169 bop 129 141 a Fv(170)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(OK,)e(the)h
(treatmen)o(t)g(of)f(lab)q(els)g(is)h(a)f(dreadful)g(hac)o(k.)17
b(The)12 b(problem)f(is)g(that)h(with)f(the)129 307 y(pattern)j(in)e
(syn)o(tactic)h(form,)e(w)o(e)i(don't)f(kno)o(w)g(whic)o(h)g(disjuncts)
i(lab)q(els)e(actually)g(b)q(elong)129 357 y(to.)18 b(The)d(depressing)
g(solution)e(is)h(to)f(mak)o(e)g(m)o(ultiple)e(passes:)180
440 y(1.)20 b(Build)9 b(an)h(en)o(vironmen)o(t)e(mapping)g(lab)q(el)h
(names)g(to)g(themselv)o(es)h(\(mak)o(e)e(sure)j(there)233
490 y(are)k(no)e(con\015icts)i(with)e(inputs\).)180 573
y(2.)20 b(Con)o(v)o(ert)11 b(the)g(pattern)g(to)f(normal)f(form,)f
(whic)o(h)j(will)e(propagate)h(the)h(free-v)n(ariable)233
623 y(names)i(in)o(to)g(the)i(\014eld)f(bindings.)180
706 y(3.)20 b(Mak)o(e)j(a)f(separate)i(pass)f(o)o(v)o(er)f(eac)o(h)h
(disjunct,)i(con)o(v)o(erting)d(the)h(lab)q(el)f(names)233
756 y(to)e(suitable)g(expressions)i(of)e(t)o(yp)q(e)g
Fr(Epatlabel)p Fv(.)35 b(That)21 b(last)f(pass)g(is)g(done)h(b)o(y)233
806 y Fr(bind_and_remove_pat)o(labe)o(l_nam)o(es)p Fv(|i)o(t)9
b(also)h(n)o(ulls)h(out)g(the)i Fr(patlabel)c Fv(stu\013.)-31
889 y Fp(170a)88 b Fo(h)p Fn(c)n(onvert)15 b(br)n(anch)h
Fr(b)e Fn(to)h(a)g(p)n(attern)g Fr(q)g Fp(170a)p Fo(i)n(\021)635
b Fp(\(169\))171 938 y Fr(push\(rho,)20 b(b.soln.answers\))f(#)i
(answers)g(already)f(injected)g(by)h(inject_soln)171
988 y(t)h(:=)f(table\(\))171 1038 y(every)g(n)g(:=)h(pattern_label_na)o
(mes\(b)o(.pat\))c(do)215 1088 y(t[n])j(:=)g(n)171 1138
y(push\(rho,)f(t\))171 1187 y(q)i(:=)f(freshen_disjuncts)o(\(pnf\()o
(b.pat)o(,)e(rho\)\))171 1237 y(pop\(rho\))171 1287 y(pop\(rho\))171
1337 y(every)i(bind_condition\(q)o(,)e(!b.soln.constrain)o(ts\))171
1387 y(q)j(:=)f(bind_and_remove_p)o(atlab)o(el_na)o(mes\(q)o(\))129
1439 y Fp(Uses)14 b Fl(bind_and_rem)o(ov)o(e_p)o(atl)o(abe)o(l_n)o(am)o
(es)d Fp(57,)i Fl(bind_condi)o(tio)o(n)e Fp(80a,)i Fl(constraint)o(s)e
Fp(136a,)171 1478 y Fl(freshen_di)o(sju)o(nct)o(s)e Fp(80b,)h
Fl(inject_soln)e Fp(170b,)i Fl(pattern_la)o(bel)o(_na)o(mes)e
Fp(79a,)i(and)h Fl(pnf)g Fp(74.)-33 1569 y(170b)88 b
Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1053
b Fm(/)5 b Fp(168)22 b(171a)5 b Fm(.)171 1619 y Fr(procedure)20
b(inject_soln\(soln\))215 1669 y(every)g(k)i(:=)f(key\(soln.answers\))e
(do)258 1719 y(if)j(type\(symtab[k]\))c(==)k("field")e(then)302
1769 y(soln.answers[k])e(:=)345 1818 y(inject\(constraints2)o(patte)o
(rn\(fi)o(eldb)o(indin)o(g\(sym)o(tab[k)o(],)h(soln.answers[k]\))o(\),)
498 1868 y(soln.answers[k],)498 1918 y(&null\))215 1968
y(return)h(soln)171 2018 y(end)129 2070 y Fp(De\014nes:)171
2109 y Fl(inject_sol)o(n)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(161a)g
(and)h(170a.)129 2148 y(Uses)h Fl(constraints)o(2pa)o(tt)o(ern)c
Fp(61,)j Fl(field)f Fp(55,)h Fl(fieldbindi)o(ng)d Fp(55,)j
Fl(inject)f Fp(29,)h(and)f Fl(symtab)g Fp(32a)g(367.)p
eop
%%Page: 171 171
171 170 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(171)208 258 y(Making)12
b(an)i(instance)h(means)e(instan)o(tiating)f(the)j(precomputed)f(one.)
-15 320 y Fp(171a)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p
Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(170b)22 b(171b)5 b
Fm(.)187 370 y Fr(procedure)20 b(consinput_patter)o(n\(ipt)o(\))230
420 y(type\(ipt.meaning\))f(==)i("constype")f(|)h(impossible\("non-con)
o(struc)o(tor)e(input"\))230 469 y(return)i(subst\(constype_pa)o(ttern)
o(\(ipt.)o(meani)o(ng\),)d(ipt.meaning.name,)h(ipt.name\))187
519 y(end)145 571 y Fp(De\014nes:)187 610 y Fl(consinput_)o(pat)o(te)o
(rn)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(169)h(and)f(262a.)145
650 y(Uses)i Fl(constructo)o(r)d Fp(159,)h Fl(constype)f
Fp(159,)i Fl(constype_)o(pat)o(ter)o(n)e Fp(171b,)h Fl(input)g
Fp(46a,)g(and)h Fl(subst)f Fp(88b.)208 712 y Fv(W)m(e)17
b(get)g(the)h(precomputed)g(instance)g(b)o(y)g(using)f(the)h(righ)o
(t-hand)f(sides)h(of)f(all)f(the)145 762 y(constructors.)-17
824 y Fp(171b)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1033 b Fm(/)5 b Fp(171a)22 b(172b)5 b Fm(.)187
874 y Fr(procedure)20 b(constype_pattern)o(\(cons)o(type\))230
924 y(local)h(cons,)g(luid)230 974 y(static)g(cache,)f(uid)230
1024 y(initial)h({)g(cache)g(:=)g(table\(\);)g(uid)g(:=)g(0)h(})230
1073 y(if)g(/cache[constype])c(then)j({)p Fo(h)p Fn(c)n(ompute)16
b(and)f(c)n(ache)h(p)n(attern)e(for)h Fr(constype)e Fp(172a)p
Fo(i)n Fr(})230 1123 y(return)21 b(cache[constype])187
1173 y(end)145 1225 y Fp(De\014nes:)187 1264 y Fl(constype_p)o(att)o
(er)o(n)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(171a)h(and)f(233b.)145
1304 y(Uses)i Fl(constype)d Fp(159.)p eop
%%Page: 172 172
172 171 bop 129 141 a Fv(172)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Static)i(lo)q(cal)g
(v)n(ariables,)g(lik)o(e)g Fr(uid)g Fv(are)h(evil.)23
b Fr(constype_pattern)12 b Fv(is)k(called)f(recur-)129
307 y(siv)o(ely)f(via)e Fr(crhs)p Fv(.)18 b(Eac)o(h)c(instance)g(of)f
Fr(constype)f Fv(is)i(tagged)f(with)h Fr(uid)p Fv(,)e(but)i
Fr(uid)f Fv(can)h(b)q(e)129 357 y(up)q(dated)g(b)o(y)f(the)h(recursiv)o
(e)h(call)d(to)h Fr(crhs)p Fv(!)k(So)c Fr(luid)g Fv(preserv)o(es)i(its)
f(v)n(alue)e(across)i(recur-)129 407 y(siv)o(e)j(calls.)27
b(Y)m(uc)o(k)o(orama.)d(Y)m(ou)17 b(w)o(ouldn't)e(b)q(eliev)o(e)i(what)
g(tripp)q(ed)h(this)f(bug)f(|)g(Icon's)129 457 y(generation)f(of)e
(record)i(v)n(alues)e(in)h(alphab)q(etical)f(order.)-31
519 y Fp(172a)88 b Fo(h)p Fn(c)n(ompute)16 b(and)g(c)n(ache)f(p)n
(attern)g(for)f Fr(constype)f Fp(172a)p Fo(i)o(\021)443
b Fp(\(171b\))171 569 y Fr(p)22 b(:=)f(&null)171 619
y(uid)g(+:=)g(1)h(#)f(one)h(uid)f(per)g(constype???)f(will)g(fail)h
(with)g(multiple)g(args)g(of)g(some)g(constype)171 669
y(luid)g(:=)g(uid)171 718 y(every)g(cons)g(:=)g(kept_constructors\()o
(const)o(ype\))d(do)k({)215 768 y(t)f(:=)h(table\(\))63
b(#)22 b(substitution)d(table)i(to)g(get)h(inputs)e(from)h(instance)215
818 y(every)f(ipt)h(:=)h(inputs_of\(cons\))d(do)i({)258
868 y(t[ipt.name])f(:=)h(Einstance_input\(co)o(nsty)o(pe.na)o(me,)e
(cons,)h(ipt.name\))258 918 y(if)i(type\(ipt.meanin)o(g\))d(==)i
("string")f(then)302 967 y(t[ipt.name])f(:=)j(Eforce\(t[ipt.nam)o(e]\))
40 b(#)22 b(????)f(could)g(this)g(be)g(right?)215 1017
y(})215 1067 y(q)g(:=)h(freshen_disjunc)o(ts\(su)o(bst_t)o(ab\(cr)o
(hs\(c)o(ons\),)c(t,)k(1\)\))215 1117 y(bind_condition\()o(q,)d
(Einstance_tagged\()o(cons)o(type.)o(name,)f(cons,)j(luid\)\))215
1167 y(p)g(:=)h(orp\(\\p,)e(q\))h(|)h(q)171 1217 y(})171
1266 y(p)g(:=)f(seqpx\(latent_labe)o(l2pat)o(tern\()o(const)o(ype.)o
(name\))o(,)e(p\))345 1316 y(#)j(label)f(will)g(be)g(used)g(for)g
(binding)f(instances)g(later)h(on!)171 1366 y(cache[constype])e(:=)i(p)
65 b(#)22 b(can't)f(afford)f(to)h(simplify)g(--)g(makes)g(it)g(too)g
(hard)g(to)h(solve)e(eqns)129 1418 y Fp(Uses)14 b Fl(bind_condit)o(ion)
c Fp(80a,)j Fl(constype)e Fp(159,)i Fl(crhs)g Fp(168,)f
Fl(Eforce)g Fp(81,)h Fl(Einstance_i)o(npu)o(t)e Fp(81,)171
1457 y Fl(Einstance_)o(tag)o(ged)h Fp(81,)j Fl(fail)g
Fp(410,)f Fl(freshen_disj)o(un)o(cts)e Fp(80b,)j Fl(inputs_of)e
Fp(166a,)171 1497 y Fl(kept_const)o(ruc)o(tor)o(s)d Fp(33d,)h
Fl(label)g Fp(383a,)h Fl(latent_la)o(bel)o(2pa)o(tte)o(rn)d
Fp(60b,)j Fl(orp)g Fp(63a,)f Fl(seqpx)h Fp(64a,)171 1536
y Fl(simplify)d Fp(92a,)h Fl(solve)g Fp(136a,)g Fl(subst_tab)f
Fp(89a,)h(and)h Fl(used)f Fp(136a.)192 1598 y Fv(The)k(pattern)h
(corresp)q(onding)g(to)e(a)h(\014eld)g(input)g(is)f(a)h(\014eld)g
(binding.)-33 1661 y Fp(172b)88 b Fo(h)p Fn(*)16 b Fp(159)p
Fo(i)o Fv(+)p Fo(\021)1033 b Fm(/)5 b Fp(171b)22 b(173a)5
b Fm(.)171 1711 y Fr(procedure)20 b(fieldinput_patter)o(n\(ipt)o(\))215
1760 y(type\(symtab[ipt)o(.name)o(]\))f(==)i("field")g(|)g
(impossible\("input)d(name)j(is)h(not)f(field)g(name"\))215
1810 y(type\(ipt.meanin)o(g\))e(==)i(\("field"|"integer")o(\))e(|)j
(impossible\("non-)o(field)c(input"\))215 1860 y(return)i
(constraints2patter)o(n\(fie)o(ldbin)o(ding)o(\(symt)o(ab[ip)o(t.nam)o
(e],)f(ipt.name\)\))171 1910 y(end)129 1962 y Fp(De\014nes:)171
2001 y Fl(fieldinput)o(_pa)o(tte)o(rn)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(169.)129 2041 y(Uses)i Fl(constraints)o(2pa)o(tt)o(ern)c
Fp(61,)j Fl(field)f Fp(55,)h Fl(fieldbindi)o(ng)d Fp(55,)j
Fl(input)f Fp(46a,)h(and)f Fl(symtab)g Fp(32a)g(367.)p
eop
%%Page: 173 173
173 172 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(173)145 258 y Ft(8.3.2)56
b(Applying)18 b(the)g(patterns)145 334 y Fr(apply_constructor)10
b Fv(pro)q(duces)k(the)f(pattern)h(v)n(alue)e(and)h(constrain)o(ts)g
(for)g(a)f(construc-)145 384 y(tor)g(when)h(applied)e(to)h
Fr(args)f Fv(in)g(an)h(output)g(pattern)h(in)e(the)i(con)o(text)f(of)g
(an)f(en)o(vironmen)o(t)145 434 y Fr(rho)p Fv(.)16 b(W)m(e)10
b(ha)o(v)o(e)g(to)g(freshen)h(pattern)g(lab)q(els)f(to)g(main)o(tain)d
(the)k(nonduplication)d(in)o(v)n(arian)o(t.)-15 496 y
Fp(173a)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1031 b Fm(/)5 b Fp(172b)22 b(173b)5 b Fm(.)187
546 y Fr(procedure)20 b(apply_constructo)o(r\(con)o(s,)f(args,)i(rho,)f
(free_env\))230 596 y(local)h(inputs,)f(c,)i(l)187 646
y(pushtrace\("APPCO)o(NS"\))230 695 y(inputs)f(:=)g([];)g(every)g
(put\(inputs,)f(inputs_of\(cons\)\))230 745 y Fo(h)p
Fn(insist)15 b(input)g(lengths)g(match)g Fp(177d)p Fo(i)230
795 y Fr(t)22 b(:=)f(argtable\(inputs,)e(args,)i(rho,)g(free_env\))230
845 y(p)h(:=)f(freshen_patlabels\(s)o(ubst_)o(tab\(c)o(rhs\(c)o(ons\))o
(,)e(t,)i(1\)\))h(#)f(can't)g(afford)g(to)g(simplify)230
895 y(every)g(p.name)g(|)g(/\(!p.disjuncts\).nam)o(e)e(:=)i(cons.name)
361 944 y(#)h(overwrite)e(pattern)g(name)h(always,)f(but)h(only)g
(default)g(disjuncts)187 994 y(PPxwrite\(PPnew\(\\)o(mdebu)o(g\),)e
("applied)h(",)h(cons.name,)f(")h(to)h(get)f(",ppexpimage\(p\)\))187
1044 y(poptrace\(\))230 1094 y(return)g(p)187 1144 y(end)145
1196 y Fp(De\014nes:)187 1235 y Fl(apply_cons)o(tru)o(ct)o(or)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(75.)145 1274 y(Uses)k
Fl(argtable)d Fp(174a,)h Fl(crhs)g Fp(168,)g Fl(freshen_patl)o(ab)o
(els)e Fp(59d,)i Fl(inputs_of)f Fp(166a,)h Fl(mdebug)g
Fp(18a,)187 1314 y Fl(pattern)d Fp(55,)i Fl(ppexpimage)d
Fp(101d,)i Fl(simplify)f Fp(92a,)i(and)f Fl(subst_tab)f
Fp(89a.)208 1376 y Fr(app_to_instance)i Fv(is)k(almost)e(the)j(same,)e
(but)h(it)f(pro)q(duces)j(an)d(instance,)i(not)f(the)145
1426 y(pattern.)22 b(Y)m(ou)15 b(migh)o(t)e(w)o(onder)i(wh)o(y)g(w)o(e)
g(need)h(it.)k(W)m(ell,)14 b Fr(crhs)g Fv(pro)q(duces)i(a)f(pattern)h
(in)145 1476 y(whic)o(h)h(constructor)h(op)q(erands)g(are)f(exp)q
(ected)h(to)f(b)q(e)g Fn(instanc)n(es)p Fv(,)g(not)g(patterns.)27
b(That)145 1526 y(means)21 b(that)g Fr(apply_construct)o(or)d
Fv(exp)q(ects)23 b(its)e(constructor-t)o(yp)q(ed)i(argumen)o(ts)e(to)
145 1575 y(b)q(e)c(instances,)g(not)e(patterns.)25 b(But)17
b Fr(apply_constructor)12 b Fv(itself)k(pro)q(duces)h(a)f(pattern)145
1625 y(\(whic)o(h)f(it)f(m)o(ust)g(do,)g(b)q(ecause)j(that)e(pattern)g
(is)g(then)g(used)h(to)f(pro)q(duce)h(an)e(emitter)g(or)145
1675 y(whatev)o(er\).)22 b(So)15 b(then,)h(what)e(are)i(w)o(e)f(to)g
(do)g(when)g(the)h(argumen)o(t)d(to)i(a)g(constructor)i(is)145
1725 y(itself)10 b(a)g(constructor)i(application?)k(W)m(e)10
b(need)h(a)f(pro)q(cedure)i(that)f(will)d(apply)i(a)g(construc-)145
1775 y(tor)18 b(and)f(pro)q(duce)h(an)f(instance,)h(therefore)h
Fr(app_to_instance)p Fv(.)25 b(Note)17 b(that)g(the)h(call)145
1825 y(to)e Fr(subst_tab)f Fv(in)h Fr(apply_constructo)o(r)e
Fv(ab)q(o)o(v)o(e)i(actually)f(eliminates)g(the)i(instances.)145
1874 y(\(That's)d(a)g(sneaky)g(hac)o(k.\))208 1924 y(I)f(wish)g(I)g
(knew)g(whether)h(freshening)g(pattern)g(v)n(ariables)e(w)o(as)h
(needed)i(here,)f(or)f(ho)o(w)145 1974 y(to)h(do)g(it.)-17
2036 y Fp(173b)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p
Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(173a)22 b(174a)5 b
Fm(.)187 2086 y Fr(procedure)20 b(app_to_instance\()o(cons,)e(args,)j
(rho,)g(free_env\))230 2136 y(local)g(inputs)230 2186
y(inputs)g(:=)g([];)g(every)g(put\(inputs,)f(inputs_of\(cons\)\))230
2235 y Fo(h)p Fn(insist)15 b(input)g(lengths)g(match)g
Fp(177d)p Fo(i)230 2285 y Fr(return)21 b(Einstance\(cons,)e
(argtable\(inputs,)f(args,)j(rho,)g(free_env\)\))187
2335 y(end)145 2387 y Fp(De\014nes:)187 2426 y Fl(app_to_ins)o(tan)o
(ce)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(176.)145 2466
y(Uses)i Fl(argtable)d Fp(174a,)h Fl(Einstance)f Fp(81,)h(and)h
Fl(inputs_of)e Fp(166a.)p eop
%%Page: 174 174
174 173 bop 129 141 a Fv(174)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y Fr(argtable)d
Fv(builds)i(a)g(table)h(mapping)d(input)i(names)g(to)g(expresssions.)19
b(It)13 b(do)q(es)g(all)e(of)129 307 y(the)k(t)o(yp)q(e)f(c)o(hec)o
(king.)-31 370 y Fp(174a)88 b Fo(h)p Fn(*)16 b Fp(159)p
Fo(i)o Fv(+)p Fo(\021)1033 b Fm(/)5 b Fp(173b)22 b(175a)5
b Fm(.)171 420 y Fr(procedure)20 b(argtable\(inputs,)e(args,)j(rho,)g
(free_env\))215 469 y(t)g(:=)h(table\(\))215 519 y(every)e(ipt)h(:=)h
(inputs[i)e(:=)h(1)h(to)f(*args])g(do)258 569 y(t[ipt.name])f(:=)h
(case)g(type\(ipt.meaning\))d(of)k({)302 619 y("constype")d(:)j
Fo(h)p Fn(make)15 b Fr(args[i])f Fn(a)h(c)n(onstructor)f(input)i
Fp(176)p Fo(i)302 669 y Fr("integer")41 b(:)22 b Fo(h)p
Fn(make)15 b Fr(args[i])f Fn(a)h(signe)n(d)g(inte)n(ger)f(input)i
Fp(175b)p Fo(i)302 718 y Fr("field")k(|)i("string")e(|)h("null")g(:)585
768 y Fo(h)p Fn(make)15 b Fr(args[i])f Fn(an)h(unsigne)n(d)h(inte)n
(ger)e(input)i Fp(174b)p Fo(i)302 818 y Fr(default)85
b(:)22 b(impossible\("input)c(type"\))258 868 y(})215
918 y(return)i(t)171 967 y(end)129 1019 y Fp(De\014nes:)171
1059 y Fl(argtable)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(173.)129
1098 y(Uses)i Fl(constype)d Fp(159,)i Fl(field)f Fp(55,)g(and)h
Fl(input)f Fp(46a.)192 1161 y Fv(Field)18 b(inputs)h(\(t)o(ypically)f
(registers\))i(ma)o(y)d(ha)o(v)o(e)i(sp)q(ecial)g(names)f(asso)q
(ciated)i(with)129 1210 y(particular)15 b(v)n(alues.)k
Fr(fieldname_env_for)o(_ipt\()o(ipt\))11 b Fv(returns)16
b(an)e(en)o(vironmen)o(t)f(that)129 1260 y(is)d(empt)o(y)f(for)h
(non-\014eld)g(inputs,)g(but)g(that)g(con)o(tains)g(the)h(sp)q(ecial)f
(names)f(for)h(\014eld)g(inputs.)129 1310 y(W)m(e)h(can)g(a\013ord)f
(to)h(put)g(it)f(\014rst)i(b)q(ecause)g(w)o(e)f(c)o(hec)o(k)h
(elsewhere)g(that)f(these)h(sp)q(ecial)f(names)129 1360
y(nev)o(er)j(collide)e(with)g(op)q(erand)h(names)f(or)h(iden)o
(ti\014ers)g(used)h(in)e(equations,)h(and)f(therefore)129
1410 y(they)g(can't)f(collide)f(with)g(names)h(in)f Fr(rho)p
Fv(.)16 b(They)c(ha)o(v)o(e)e(to)h(go)f(\014rst)i(b)q(ecause)h(the)e
(deco)q(ding)129 1459 y(co)q(de)h(blindly)e(puts)h(all)f(free)h(iden)o
(ti\014ers)h(in)o(to)e Fr(rho)p Fv(,)g(ev)o(en)i(if)e(they)h(are)h(one)
f(of)f(these)i(sp)q(ecial)129 1509 y(names.)18 b(Extended)d(\014elds)g
(don't)e(use)i(the)g(sp)q(ecial)f(names.)j(If)d(w)o(e)g(lo)q(ok)f(up)h
(a)g(name)f(and)-1980 b Fk(\031Change)13 b(#29)129 1559
y Fv(get)j(a)f(\014eld,)g(w)o(e)h(treat)g(it)f(just)h(as)f(if)f(it)h(w)
o(eren't)h(de\014ned,)h(i.e.,)d(w)o(e)i(can)f(use)h(it)f(as)h(a)f(free)
129 1609 y(v)n(ariable.)j(This)d(c)o(hange)f(lets)h(us)g(use)g(the)f
(name)g(of)f(a)h(\014eld)g(as)h(a)f(binding)f(instance)i(in)f(a)129
1659 y(matc)o(hing)e(statemen)o(t.)18 b(Go)q(d)c(only)f(kno)o(ws)h
(what)f(other)i(consequences)i(it)c(ma)o(y)f(ha)o(v)o(e.)-33
1721 y Fp(174b)88 b Fo(h)p Fn(make)16 b Fr(args[i])d
Fn(an)j(unsigne)n(d)f(inte)n(ger)g(input)g Fp(174b)p
Fo(i)o(\021)446 b Fp(\(174a\))171 1771 y Fr(super_simplify\(gs)o
(ubst\()o(args[)o(i],)19 b(unsigned_arg_f,)f(rho,)j(free_env,)f(args,)h
(i,)g(ipt\)\))129 1823 y Fp(Uses)12 b Fl(gsubst)e Fp(120a,)g
Fl(super_simp)o(lif)o(y)f Fp(92c,)h(and)h Fl(unsigned_a)o(rg_)o(f)e
Fp(175a.)p eop
%%Page: 175 175
175 174 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(175)-15 258 y Fp(175a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(174a)22 b(175c)5 b Fm(.)187 307 y Fr(procedure)20
b(unsigned_arg_f\(e)o(,)f(rho,)i(free_env,)f(args,)h(i,)g(ipt\))230
357 y(local)g(fieldrho)230 407 y(return)g(case)g(type\(e\))f(of)i({)274
457 y("string")e(:)i({)339 507 y(fieldrho)e(:=)i(fieldname_env_for)o
(_ipt\()o(ipt\))c(|||)j(rho)339 557 y(\(if)h(is_defined\(e,)d
(fieldrho\))h(&)h(type\(lookup\(e,)e(fieldrho\)\))h(~==)h("field")f
(then)405 606 y(project\(lookup\(e)o(,)f(fieldrho\),)h("integer"\))361
656 y(else)405 706 y(new_binding_inst)o(ance\()o(e,)f(e,)i("integer",)f
(\\free_env\))339 756 y(\))i(|)g(badarg\(args,)d(i,)i(ipt,)g("integer)f
(or)i(field"\))274 806 y(})274 855 y("literal")e(:)h
(project\(lookup\(e.s,)d(fieldname_env_for_i)o(pt\(ip)o(t\)\),)g
("integer"\))i(|)1124 905 y(badarg\(args,)f(i,)j(ipt,)f("integer)f(or)h
(field"\))274 955 y("Eapp")g(:)g(error\("Constructor)d(application)i
(not)h(allowed;)f(expected)g(integer)g(or)i(field"\))230
1005 y(})187 1055 y(end)145 1107 y Fp(De\014nes:)187
1146 y Fl(unsigned_a)o(rg_)o(f)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f
(174b.)145 1185 y(Uses)k Fl(badarg)e Fp(177c,)g Fl(Eapp)g
Fp(81,)h Fl(field)f Fp(55,)g Fl(fieldname_en)o(v_)o(for)o(_ip)o(t)f
Fp(356b,)h Fl(is_defined)e Fp(25a,)187 1225 y Fl(literal)f
Fp(45e,)i Fl(lookup)e Fp(25a,)i Fl(new_bindi)o(ng_)o(ins)o(tan)o(ce)d
Fp(77b,)j(and)f Fl(project)g Fp(29.)-17 1316 y(175b)88
b Fo(h)p Fn(make)16 b Fr(args[i])d Fn(a)i(signe)n(d)g(inte)n(ger)g
(input)g Fp(175b)p Fo(i)o(\021)514 b Fp(\(174a\))187
1366 y Fr(Enarrows\(super_s)o(impli)o(fy\(gs)o(ubst\()o(args[)o(i],)19
b(signed_arg_f,)g(rho,)i(free_env,)f(args,)g(i,)i(ipt\)\),)383
1416 y(ipt.meaning\))145 1468 y Fp(Uses)12 b Fl(Enarrows)d
Fp(81,)i Fl(gsubst)e Fp(120a,)h Fl(signed_arg_f)e Fp(175c,)i(and)h
Fl(super_simp)o(li)o(fy)e Fp(92c.)-13 1559 y(175c)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(175a)22 b(177c)5 b Fm(.)187 1609 y Fr(procedure)20
b(signed_arg_f\(e,)e(rho,)j(free_env,)f(args,)h(i,)g(ipt\))230
1659 y(return)g(case)g(type\(e\))f(of)i({)274 1708 y("string")e(:)i
(\(if)f(is_defined\(e,)e(rho\))i(&)h(type\(lookup\(e,)c(rho\)\))j(~==)g
("field")g(then)579 1758 y(project\(lookup\(e,)d(rho\),)j("integer"\))
535 1808 y(else)579 1858 y(new_binding_instan)o(ce\(e,)d(e,)j
("integer",)f(\\free_env\))514 1908 y(\))h(|)h(badarg\(args,)d(i,)j
(ipt,)f("integer)f(or)h(field"\))274 1958 y("literal")f(:)h
(badarg\(args,)f(i,)h(ipt,)g("integer)f(or)i(field"\))274
2007 y("Eapp")f(:)g(error\("Constructor)d(application)i(not)h(allowed;)
f(expected)g(integer)g(or)i(field"\))230 2057 y(})187
2107 y(end)145 2159 y Fp(De\014nes:)187 2198 y Fl(signed_arg)o(_f)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(175b.)145 2238 y(Uses)15
b Fl(badarg)e Fp(177c,)g Fl(Eapp)h Fp(81,)g Fl(field)f
Fp(55,)h Fl(is_define)o(d)e Fp(25a,)h Fl(literal)g Fp(45e,)g
Fl(lookup)g Fp(25a,)187 2277 y Fl(new_bindin)o(g_i)o(ns)o(tan)o(ce)8
b Fp(77b,)j(and)f Fl(project)g Fp(29.)p eop
%%Page: 176 176
176 175 bop 129 141 a Fv(176)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-13 258 y Fp(176)88
b Fo(h)p Fn(make)16 b Fr(args[i])d Fn(a)i(c)n(onstructor)g(input)g
Fp(176)p Fo(i)o(\021)579 b Fp(\(174a\))171 307 y Fr(case)21
b(type\(x)f(:=)i(untable\(args[i]\)\))c(of)k({)215 357
y("Papp")e(:)i(impossible\("Papp)c(as)k(constructor)d(arg"\))215
407 y("Eapp")h(:)258 457 y(if)i(c)f(:=)g(cons_named\(x.f\))e(&)j
(c.type)e(===)h(ipt.meaning)f(then)302 507 y(app_to_instance\()o(c,)f
(x.args,)h(rho,)h(free_env\))258 557 y(else)302 606 y(badarg\(args,)e
(i,)i(ipt,)g("constructor)f(of)h(type)g(")h(||)f(ipt.meaning.name)d(||)
759 656 y(";)k(denotes)e(")i(||)f(c.type.name)f(||)h("\)"\))215
706 y("string")f(:)302 756 y(\(if)h(is_defined\(x,)e(rho\))i(then)367
806 y(if)g(x)h(:=)f(project\(lookup\(x,)e(rho\),)h("consop"\))g(then)
411 855 y(if)h(type\(x\))f(==)i("input")e(then)476 905
y(if)h(x.meaning)f(===)i(ipt.meaning)d(then)520 955 y(ipt.name)42
b(#)21 b(stands)g(for)g(an)g(instance,)f(not)h(a)h(pattern)476
1005 y(else)520 1055 y(badarg\(args,)d(i,)i(ipt,)g(")h(constructor)d
(of)j(type)f(")g(||)h(ipt.meaning.name)c(||)977 1104
y(")k(\(not)f(")g(||)h(x.meaning.name)d(||)i("\)"\))411
1154 y(else)454 1204 y(impossible\("consop)d(projected)i(into)h
(non-input"\))367 1254 y(else)411 1304 y(if)g(lookup\(x,)f(rho\))h(===)
g(ipt.meaning)f(then)454 1354 y Fo(h)p Fn(p)n(ossible)15
b(binding)g(instanc)n(e)h Fr(x)e Fn(of)h(c)n(onstructor)g(typ)n(e)g
Fr(ipt.meaning)d Fp(177a)p Fo(i)411 1403 y Fr(else)454
1453 y(&fail)324 1503 y(else)367 1553 y Fo(h)p Fn(p)n(ossible)j
(binding)g(instanc)n(e)h Fr(x)e Fn(of)h(c)n(onstructor)g(typ)n(e)g
Fr(ipt.meaning)d Fp(177a)p Fo(i)280 1603 y Fr(\))22 b(|)f
(badarg\(args,)e(i,)j(ipt,)f(")g(constructor)f(of)h(type)g(")h(||)f
(ipt.meaning.name\))215 1652 y(default)f(:)h(impossible\("argument)d
(to)k(constructor"\))171 1702 y(})129 1754 y Fp(Uses)14
b Fl(app_to_in)o(sta)o(nce)9 b Fp(173b,)j Fl(badarg)f
Fp(177c,)g Fl(cons_named)f Fp(167a,)h Fl(constructor)f
Fp(159,)h Fl(Eapp)h Fp(81,)171 1794 y Fl(fail)f Fp(410,)h
Fl(input)f Fp(46a,)h Fl(is_defined)d Fp(25a,)j Fl(lookup)f
Fp(25a,)g Fl(Papp)h Fp(41a,)g Fl(pattern)e Fp(55,)i Fl(project)f
Fp(29,)171 1833 y(and)g Fl(untable)e Fp(114c.)p eop
%%Page: 177 177
177 176 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(177)-15 258 y Fp(177a)88
b Fo(h)p Fn(p)n(ossible)15 b(binding)g(instanc)n(e)h
Fr(x)e Fn(of)h(c)n(onstructor)g(typ)n(e)g Fr(ipt.meaning)d
Fp(177a)p Fo(i)o(\021)112 b Fp(\(176\))187 307 y Fr(if)21
b(\\free_env)f(then)230 357 y(1\(y)i(:=)f(Ebinding_instance)o(\(x,)e
(ipt.meaning,)g(table\(\)\),)274 407 y(if)i(\(/free_env[x])e(:=)j
(binding_instance\()o(y,)d(ipt.meaning\)\))g(|)339 457
y(\(type\(free_env[x]\))f(==)k("binding_instanc)o(e",)361
507 y(type\(free_env[x].v)o(al\))d(==)i("Ebinding_instanc)o(e",)361
557 y(free_env[x].type)e(===)i(free_env[x].val.)o(type)d(===)k
(y.type\))274 606 y(then)318 656 y(&null)274 706 y(else)318
756 y(error\("Can't)d(re-use)h(",)i(x,)f(";)h(already)e(used)h(as)g(",)
h(type\(free_env[x])o(\),)d("\(",)448 806 y(expimage\(free_env[x)o
(]\),)g("\)",)448 855 y("\\n)i(---)h(new)f(value)g(as)g(",)g
(type\(y\),)f("\(",)h(expimage\(y\),)f("\))h(no)h(good"\)\))187
905 y(else)230 955 y(&fail)145 1007 y Fp(Uses)13 b Fl(binding_in)o(st)o
(anc)o(e)d Fp(77b,)h Fl(Ebinding_i)o(nst)o(an)o(ce)e
Fp(81,)j Fl(expimage)e Fp(101a,)g Fl(fail)i Fp(410,)f
Fl(used)g Fp(136a,)187 1046 y(and)f Fl(value)g Fp(136a.)145
1117 y Fv(This)16 b(w)o(as)f(the)h(old)f(co)q(de.)24
b(I)16 b(don't)f(understand)i(it,)e(but)h(it)f(w)o(as)g(causing)h
(errors)h(that)e(I)145 1167 y(didn't)f(w)o(an)o(t,)f(so)g(I)h(c)o
(hanged)h(it.)-17 1229 y Fp(177b)88 b Fo(h)p Fn(old)15
b(p)n(ossible)g(binding)g(instanc)n(e)h Fr(x)e Fn(of)h(c)n(onstructor)g
(typ)n(e)g Fr(ipt.meaning)d Fp(177b)p Fo(i)o(\021)187
1279 y Fr(if)21 b(\\free_env)f(then)230 1329 y(1\(y)i(:=)f
(Ebinding_instance)o(\(x,)e(ipt.meaning,)g(table\(\)\),)274
1378 y(\(/free_env[x])g(:=)i(binding_instance\(y,)d(ipt.meaning\)\))h
(|)296 1428 y(error\("Can't)g(re-use)i(",)g(x,)g(";)h(already)e(used)h
(as)g(",)h(expimage\(free_env)o([x]\))o(\)\))187 1478
y(else)230 1528 y(&fail)145 1580 y Fp(Uses)10 b Fl(binding_in)o(sta)o
(nce)c Fp(77b,)j Fl(Ebinding_)o(ins)o(tan)o(ce)d Fp(81,)j
Fl(expimage)e Fp(101a,)h Fl(fail)h Fp(410,)f(and)h Fl(used)f
Fp(136a.)-13 1663 y(177c)88 b Fo(h)p Fn(*)15 b Fp(159)p
Fo(i)p Fv(+)p Fo(\021)1037 b Fm(/)5 b Fp(175c)22 b(178a)5
b Fm(.)187 1713 y Fr(procedure)20 b(badarg\(args,)f(i,)i(ipt,)g
(expected\))230 1762 y(error\(expimage\(args)o([i]\),)d(")k([",)f
(image\(args[i]\),)e("]",)361 1812 y(")j(\(",)f(ordinal\(i\),)e(")j
(arg)f(",)h(ipt.name,)d("\))j(",)361 1862 y("does)f(not)g(denote)g(",)g
(if)g(any\('aeiou',)f(expected\))g(then)h("an)g(")g(else)g("a)h(",)f
(expected\))187 1912 y(end)145 1964 y Fp(De\014nes:)187
2003 y Fl(badarg)p Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(175)g(and)h
(176.)145 2043 y(Uses)h Fl(expimage)d Fp(101a)h(and)h
Fl(ordinal)e Fp(167c.)-17 2134 y(177d)88 b Fo(h)p Fn(insist)15
b(input)g(lengths)g(match)g Fp(177d)p Fo(i)o(\021)732
b Fp(\(173\))187 2184 y Fr(*inputs)20 b(=)i(*args)e(|)252
2234 y(error\(cons.name,)f(")i(expects)g(",)g(*inputs,)f(")i
(arguments,)d(but)j(you)f(gave)g(",)g(*args\))p eop
%%Page: 178 178
178 177 bop 129 141 a Fv(178)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Ft(8.3.3)56
b(Eliminating)15 b(instances)129 334 y Fv(This)h(co)q(de)h(is)f
(applied)f(to)h(ev)o(ery)h(pattern)g(as)f(the)g(last)g(step)h(in)f(con)
o(v)o(ersion)g(to)g(normal)129 384 y(form.)g(W)m(e)11
b(don't)h(remem)o(b)q(er)f(wh)o(y)g(it's)g(the)i Fn(last)e
Fv(step,)i(or)e(if)g(it)h(really)f(has)h(to)f(b)q(e)i(the)f(last.)-31
446 y Fp(178a)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p
Fo(\021)1054 b Fm(/)6 b Fp(177c)22 b(180)5 b Fm(.)171
496 y Fr(procedure)20 b(eliminate_instanc)o(es\(e\))215
546 y(return)g(gsubst\(e,)g(eliminate_instance)o(s_f\))171
596 y(end)129 648 y Fp(De\014nes:)171 687 y Fl(eliminate_)o(ins)o(tan)o
(ces)o Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(74)h(and)g(124a.)129
727 y(Uses)h Fl(eliminate_i)o(nst)o(an)o(ces)o(_f)c Fp(180)j(and)g
Fl(gsubst)e Fp(120a.)192 789 y Fr(eliminate_instan)o(ces_f)15
b Fv(simpli\014es)h(a)i(pattern)h(b)o(y)f(remo)o(ving)e(constructor)k
(in-)129 839 y(stances.)g(F)m(or)13 b(some)f(forgotten)i(reason,)772
824 y Ff(1)804 839 y Fv(these)h(transformations)d(are)i(not)f(sp)q
(eci\014ed)i(b)o(y)129 888 y(rewrite)g(rules)g(in)e Fr(exp.nw)p
Fv(.)192 938 y(The)k(basic)h(idea)f(is)g(that)g(if)f(w)o(e)i(ha)o(v)o
(e)f(an)g(instance,)h(w)o(e)g(can)f(simplify)d(a)o(w)o(a)o(y)i(some)129
988 y(predicates)g(on)d(the)i(instance)g(and)e(selection)i(of)e(elemen)
o(ts)h(of)f(the)i(instance.)-33 1050 y Fp(178b)88 b Fo(h)p
Fn(what)15 b(we)g(might)f(write)g(if)g(we)h(wer)n(e)f(doing)h(this)g
(with)f(r)n(ewrite)f(rules)h Fp(178b)p Fo(i)o(\021)100
b Fp(178c)5 b Fm(.)171 1100 y Fr(Einstance_tagged\()o(Einst)o(ance\()o
(c,)19 b(a\),)i(c2,)g(uid\))g(->)g(if)h(c)f(===)h(c2)f(then)g(1)h(else)
e(0)171 1150 y(Einstance_input\(E)o(insta)o(nce\(c)o(,)f(a\),)i(c2,)g
(name\))g(->)g(if)h(c)f(===)h(c2)f(then)g(a[name])1173
1200 y(else)g(Efail\(expimage\(e\)\))171 1250 y(Einstance_tagged\()o
(Ebind)o(ing_i)o(nstan)o(ce\(_,)d(_,)j(_\),_,)g(_\))h(->)f(1)h(#)f
(why?)g(helps)g(matching?)129 1301 y Fp(Uses)c Fl(Ebinding_i)o(nst)o
(an)o(ce)c Fp(81,)j Fl(Efail)e Fp(81,)i Fl(Einstance)d
Fp(81,)j Fl(Einstance)o(_in)o(put)d Fp(81,)171 1341 y
Fl(Einstance_)o(tag)o(ged)8 b Fp(81,)j(and)f Fl(expimage)f
Fp(101a.)129 1403 y Fv(The)22 b(real)e(kic)o(k)o(er)h(is)g(dealing)f
(with)h(names.)38 b(If)20 b(w)o(e)h(ha)o(v)o(e)g(a)f(binding)g
(instance)i(of)e(a)129 1453 y(constructor)14 b(t)o(yp)q(e,)e(w)o(e)g
(ha)o(v)o(e)g(a)f(name)g(for)h(it.)17 b(No)o(w,)11 b(if)g(w)o(e)h(w)o
(an)o(t)f(to)h(select)h(an)f(elemen)o(t)f(of)129 1503
y(that)j(constructor)i(t)o(yp)q(e,)e(w)o(e)g(need)h(a)e(name)g(for)g
(the)i(elemen)o(t,)d(to)q(o,)i(since)g(that)g(elemen)o(t)129
1553 y(itself)g(b)q(ecomes)g(a)g(binding)f(instance.)18
b(The)d(general)f(idea)f(is)-29 1615 y Fp(178c)88 b Fo(h)p
Fn(what)15 b(we)g(might)f(write)g(if)g(we)h(wer)n(e)f(doing)h(this)g
(with)f(r)n(ewrite)f(rules)h Fp(178b)p Fo(i)o Fv(+)p
Fo(\021)88 b Fm(/)5 b Fp(178b)20 b(178d)5 b Fm(.)171
1665 y Fr(Einstance_input\(E)o(bindi)o(ng_in)o(stanc)o(e\(nam)o(e,)19
b(_,)i(_\),)g(c,)h(fname\))e(->)236 1715 y(Ebinding_instance\(n)o(ame)f
(||)i(".")g(||)h(c.name)e(||)h(".")h(||)f(fname\))129
1766 y Fp(Uses)12 b Fl(Ebinding_in)o(sta)o(nc)o(e)d Fp(81)i(and)f
Fl(Einstance_in)o(pu)o(t)f Fp(81.)129 1829 y Fv(but)15
b(the)f(real)g(truth)g(is)g(in)g Fr(unwind_instance)o(_inpu)o(ts)p
Fv(.)192 1878 y(W)m(e)g(also)g(tak)o(e)g(this)h(opp)q(ortunit)o(y)f(to)
g(mak)o(e)f(some)h(decisions)h(ab)q(out)f(laten)o(t)h(pattern)129
1928 y(lab)q(els.)36 b(Laten)o(t)21 b(lab)q(els)e(asso)q(ciated)i(with)
f(binding)f(instances)i(of)e(constructor)j(t)o(yp)q(es)129
1978 y(b)q(ecome)17 b(real,)g(but)h(lab)q(els)e(asso)q(ciated)i(with)f
(literal)f(instances)i(\()p Fr(Einstance)p Fv(\))d(are)j(dis-)129
2028 y(carded.)-33 2090 y Fp(178d)88 b Fo(h)p Fn(what)15
b(we)g(might)f(write)g(if)g(we)h(wer)n(e)f(doing)h(this)g(with)f(r)n
(ewrite)f(rules)h Fp(178b)p Fo(i)o Fv(+)p Fo(\021)89
b Fm(/)6 b Fp(178c)171 2140 y Fr(latent_patlabel\(E)o(insta)o(nce\(_)o
(,)19 b(_\)\))i(->)h(vanishing_laten)o(t_pat)o(label)171
2190 y(latent_patlabel\(E)o(wildc)o(ard\(n)o(am\)\))c(->)k
(patlabel\(nam,)d(nam\))129 2242 y Fp(Uses)12 b Fl(Einstance)c
Fp(81,)i Fl(latent_patl)o(abe)o(l)e Fp(55,)j Fl(patlabel)d
Fp(55,)i(and)g Fl(vanishing_la)o(te)o(nt_)o(pat)o(lab)o(el)e
Fp(32a.)p 129 2276 573 2 v 176 2302 a Fc(1)193 2314 y
Fp(One)21 b(migh)o(t)f(susp)q(ect)f(the)i(reason)e(has)i(something)d
(to)j(do)g(with)g(the)f(complicated)e(logic)i(of)129
2354 y Fl(unwind_insta)o(nc)o(e_i)o(npu)o(ts)p Fp(,)8
b(whic)o(h)j(do)q(esn't)e(lo)q(ok)h(lik)o(e)h(it)g(could)e(b)q(e)i
(implemen)o(ted)d(with)j(mere)f(rewrite)129 2393 y(rules.)p
eop
%%Page: 179 179
179 178 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(179)208 258 y(With)15 b(rewrite)i(rules,)g
(w)o(e)g(w)o(ould)e(enjo)o(y)h(the)g(great)h(con)o(v)o(enience)g(that)g
(the)f(rewrite)145 307 y(engine)i(w)o(ould)e(simplify)e(the)k(elemen)o
(ts)f(of)f(ev)o(ery)i(expression)g(b)q(efore)g(simplifying)c(the)145
357 y(expression)h(itself,)f(since)g(it)g(w)o(orks)g(b)q(ottom-up.)j
(Unfortunately)m(,)c(w)o(e're)h(using)g Fr(gsubst)p Fv(,)145
407 y(whic)o(h)h(w)o(orks)f(top-do)o(wn,)f(and)i(the)g(co)q(de)g(is)f
(therefore)i(more)d(lab)q(ored)i(than)f(one)g(migh)o(t)145
457 y(lik)o(e.)208 507 y(Ev)o(en)h(after)g(all)f(these)i(so)q(othing)e
(explanations,)g(Mary)h(ma)o(y)e(still)h(b)q(e)h(afraid)f(of)g(this)145
557 y(co)q(de.)19 b(She)c(has)f(go)q(o)q(d)f(judgmen)o(t.)p
eop
%%Page: 180 180
180 179 bop 129 141 a Fv(180)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Mary's)k(go)q(o)q
(d)g(judgemen)o(t)g(is)g(b)q(orned)h(out)g(b)o(y)f(bug)g(n)o(um)o(b)q
(er)g(17.)29 b(In)17 b(an)g(e\013ort)i(to)129 307 y(\014x)e(bug)g(17,)g
(I'm)f(splitting)g(these)i(things)f(in)o(to)g(t)o(w)o(o)f(functions.)28
b(The)18 b(inner)f(function,)129 357 y Fr(do_eliminate_instanc)o(es_f)o
Fv(,)i(retains)j(v)n(alues)e(of)g(t)o(yp)q(e)h Fr(binding_instance_v)o
(ar)p Fv(.)129 407 y(The)15 b(outer)f(suc)o(h)h(function,)e
Fr(eliminate_instance)o(s_f)p Fv(,)d(rewrites)15 b(those)g(to)f
(strings.)68 b Fk(\031Change)14 b(#42)1591 461 y(\031Fixes)g(bug)g(#17)
-13 469 y Fp(180)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o
Fv(+)p Fo(\021)1037 b Fm(/)5 b Fp(178a)22 b(181c)5 b
Fm(.)171 519 y Fr(procedure)20 b(eliminate_instanc)o(es_f\()o(e\))215
569 y(return)g(eliminate_binding_)o(insta)o(nce_v)o(ars\()o(do_el)o
(imina)o(te_in)o(stanc)o(es_f\()o(e\)\))171 619 y(end)171
718 y(procedure)g(do_eliminate_inst)o(ances)o(_f\(e\))215
768 y(local)g(the_answer)215 818 y(static)g(issued_warning)215
868 y(pushtrace\("ELIM)o(INATE)o("\))215 918 y(the_answer)f(:=)j(case)f
(type\(e\))f(of)h({)258 967 y("Einstance_input")d(:)k
(unwind_instance_i)o(nputs)o(\(e\))258 1017 y("Einstance_tagged")c(:)k
({)345 1067 y(e.x)f(:=)h(gsubst\(e.x,)d(do_eliminate_instan)o(ces_f)o
(\))41 b(#)21 b(simplify)g(children)f(bottom-up)345 1117
y(case)h(type\(e.x\))f(of)i({)389 1167 y("Ebinding_instanc)o(e")d(:)i
(1)389 1217 y("binding_instance)o(_var")d(:)k(1)389 1266
y("Einstance")d(:)j(if)f(e.cons)g(===)g(e.x.cons)f(then)h(1)h(else)f(0)
389 1316 y(default)f(:)i(e)87 b(#)21 b(don't)g(let)g(gsubst)g
(continue;)f(we)h(did)g(it)h(already)345 1366 y(})302
1416 y(})258 1466 y("latent_patlabel")c(:)k({)324 1515
y(e.instance)d(:=)j(gsubst\(e.instanc)o(e,)d(do_eliminate_ins)o(tance)o
(s_f\))f(#)k(simplify)e(bottom-up)324 1565 y(case)g(type\(e.instance\))
f(of)i({)367 1615 y("Ebinding_instance)o(")e(:)j(patlabel\(e.inst)o
(ance.)o(name,)c(e.instance.name\))367 1665 y("string")260
b(:)22 b(e)43 b(#)22 b(no)f(change)367 1715 y("binding_instance_)o
(var")d(:)k(e)g(#)f(as)g(with)g(string)g(\(but)g(should)g(it)g(be)g
(patlabel?\))367 1764 y("Einstance_input")62 b(:)22 b({)p
Fo(h)p Fn(latent)14 b(p)n(attern)h(lab)n(el)f(of)h(an)g(instanc)n(e)h
(input)f Fp(181a)p Fo(i)o Fr(})367 1814 y("Einstance")194
b(:)22 b(vanishing_laten)o(t_pat)o(label)367 1864 y("Efail")282
b(:)22 b(Efail\("latent)d(pattern)h(label)h(of)g(")h(||)f
(e.instance.msg\))345 1914 y(default)304 b(:)22 b(impossible\("typ)o(e)
d(of)i(latent)g(pattern)f(label"\))302 1964 y(})258 2014
y(})215 2063 y(})h(|)h({poptrace\(\);)d(fail})215 2113
y(poptrace\(\))215 2163 y(return)h(the_answer)171 2213
y(end)129 2265 y Fp(De\014nes:)171 2304 y Fl(eliminate_)o(ins)o(tan)o
(ces)o(_f)o Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(17a,)g(178a,)g(and)h
(181b.)129 2344 y(Uses)k Fl(binding_in)o(st)o(anc)o(e_v)o(ar)c
Fp(181c,)i Fl(Ebinding_i)o(nst)o(an)o(ce)e Fp(81,)j Fl(Efail)e
Fp(81,)i Fl(Einstance)d Fp(81,)171 2383 y Fl(Einstance_)o(inp)o(ut)f
Fp(81,)i Fl(Einstance)o(_ta)o(gge)o(d)e Fp(81,)i Fl(eliminate_)o(bin)o
(din)o(g_i)o(nst)o(an)o(ce_)o(var)o(s)e Fp(181c,)171
2422 y Fl(fail)i Fp(410,)g Fl(gsubst)g Fp(120a,)g Fl(label)f
Fp(383a,)h Fl(latent_patl)o(ab)o(el)e Fp(55,)j Fl(patlabel)e
Fp(55,)h Fl(pattern)f Fp(55,)171 2462 y Fl(simplify)e
Fp(92a,)h Fl(unwind_inst)o(anc)o(e_i)o(npu)o(ts)e Fp(182a,)i(and)h
Fl(vanishing_)o(lat)o(ent)o(_pa)o(tl)o(abe)o(l)e Fp(32a.)p
eop
%%Page: 181 181
181 180 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(181)208 258 y(That)12 b(last)h(case)h(has)
f(caused)i(m)o(uc)o(h)c(consternation.)19 b(Originally)11
b(w)o(e)i(w)o(eren't)h(sure)g(if)145 307 y(a)d(laten)o(t)h(pattern)g
(lab)q(el)f(of)g(an)g(instance)h(input)g(should)f(v)n(anish)g(or)g
(just)h(sta)o(y)f(unc)o(hanged.)145 357 y(F)m(or)k(a)f(long)f(time)h(w)
o(e)h(just)f(let)h(it)f(sta)o(y)h(unc)o(hanged.)21 b(I)14
b(do)h(b)q(eliev)o(e)g(that's)f(righ)o(t,)g(since)h(I)145
407 y(think)h(the)h(recursiv)o(e)h(call)d(to)i Fr(eliminate_instan)o
(ces)c Fv(handles)j(the)h(cases)h(that)e(need)145 457
y(to)e(b)q(e)h(handled.)-15 519 y Fp(181a)88 b Fo(h)p
Fn(latent)15 b(p)n(attern)g(lab)n(el)f(of)h(an)g(instanc)n(e)h(input)f
Fp(181a)p Fo(i)o(\021)485 b Fp(\(180\))187 569 y Fr(/issued_warning)18
b(:=)k(1)f(&)230 619 y(warning\("Yes,)e(Virginia,)h(there)h(are)g
(latent)g(labels)f(of)i(instance)e(inputs:)g(",)i(expimage\(e\)\))187
669 y(e)f(#)h(change)f(nothing)145 720 y Fp(Uses)12 b
Fl(expimage)d Fp(101a.)208 783 y Fv(Let)14 b(it)f(b)q(e)i(noted)f(that)
g(at)g(one)g(p)q(oin)o(t)f(w)o(e)i(had)e(the)i(follo)o(wing)c
(Band-Aid:)-17 845 y Fp(181b)88 b Fo(h)p Fn(Band-A)o(id)16
b(that)f(onc)n(e)g(c)n(over)n(e)n(d)g(latent)g(p)n(attern)f(lab)n(el)h
(of)g(an)g(instanc)n(e)g(input)g Fp(181b)p Fo(i)o(\021)187
895 y Fr(#)21 b(fail)g(or)h(vanishing?)41 b(or)22 b(other?)e(not)h
(sure!)187 945 y(#)g(Should)g(this)g(arm)g(should)g(be)g(like)g(the)g
(one)g(above?)g(i.e.:)187 994 y(#)g(This)g(gets)g(us)h(part)f(of)g(the)
g(way)g(to)h(binding)e(an)h(a)h("constructor-typed)o(")d(operand)187
1044 y(#)i(in)h(a)f(constructor)f(application)f(to)j(a)f(location)f(in)
i(an)f(instruction)f(stream,)187 1094 y(#)h(but)h(it's)f(not)g(quite)f
(right.)187 1144 y(#)h(I)h(have)f(to)g(think)g(about)g(this)g(some)g
(more.)187 1194 y(eliminate_instan)o(ces_f)o(\(late)o(nt_pa)o(tlabe)o
(l\(unw)o(ind_)o(insta)o(nce_i)o(nputs)o(\(e.in)o(stanc)o(e,)e
(""\)\)\))145 1246 y Fp(Uses)10 b Fl(arm)e Fp(271b,)g
Fl(construct)o(or)e Fp(159,)i Fl(eliminate_i)o(nst)o(anc)o(es)o(_f)e
Fp(180,)i Fl(fail)g Fp(410,)g Fl(latent_patl)o(abe)o(l)e
Fp(55,)187 1285 y Fl(location)p Fp(,)j(and)h Fl(unwind_inst)o(an)o(ce_)
o(inp)o(uts)e Fp(182a.)145 1347 y Fv(This)14 b(w)o(as)g(b)q(efore)h(w)o
(e)f(in)o(tro)q(duced)g(b)q(ottom-up)f(simpli\014cation.)208
1397 y(Un)o(winding)c(the)j(instance)f(inputs)g(ma)o(y)e(mean)h(using)g
(an)h(argumen)o(t)e(table,)i(or)g(it)f(ma)o(y)145 1447
y(mean)j(creating)h(a)g(fresh)g(name)f(for)h(a)f(\014eld)h(of)g(a)f
(binding)g(instance.)-13 1509 y Fp(181c)88 b Fo(h)p Fn(*)15
b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1052 b Fm(/)6 b Fp(180)22
b(182a)5 b Fm(.)187 1559 y Fr(record)20 b(binding_instance_va)o(r\(s\))
187 1659 y(procedure)g(eliminate_bindin)o(g_ins)o(tance)o(_vars)o
(\(e\))230 1708 y(return)h(gsubst\(e,)f(eliminate_binding)o(_inst)o
(ance)o(_vars)o(_f\))187 1758 y(end)187 1858 y(procedure)g
(eliminate_bindin)o(g_ins)o(tance)o(_vars)o(_f\(e)o(\))230
1908 y(if)i(type\(e\))e(==)h("binding_instance_va)o(r")e(then)i(return)
f(e.s)187 1958 y(end)145 2009 y Fp(De\014nes:)187 2049
y Fl(binding_in)o(sta)o(nc)o(e_v)o(ar)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unks)f(180)g(and)h(182a.)187 2088 y Fl(eliminate_)o(bin)o(di)o(ng_)o
(ins)o(tan)o(ce_)o(va)o(rs)p Fp(,)d(used)j(in)g(c)o(h)o(unk)f(180.)145
2128 y(Uses)i Fl(gsubst)e Fp(120a.)p eop
%%Page: 182 182
182 181 bop 129 141 a Fv(182)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(If)c
Fr(unwind_instance_)o(inpu)o(ts)d Fv(succeeds,)13 b(w)o(e're)c(guaran)o
(teed)h(to)f(ha)o(v)o(e)g(made)f(progress,)129 307 y(so)14
b(w)o(e)h(can)f(safely)f(re-apply)h(it.)192 357 y(In)9
b(the)i(arm)d(for)i Fr(Einstance)e Fv(b)q(elo)o(w,)h(the)i(\\false")e
(branc)o(h)h(of)f(the)i(conditional)d(returns)129 407
y Fr(Efail)p Fv(,)15 b(b)q(ecause)j(nested)f(constructor)g
(applications)e(can)h(pro)q(duce)h(nonsense)g(\()p Fr(Efail)p
Fv(\))129 457 y(guarded)h(b)o(y)e(conditions)h(that)g(are)g(statically)
f(false.)26 b(F)m(or)17 b(example,)e(in)i(the)g(follo)o(wing)129
507 y(pattern,)e(the)f(\014rst)h(disjunct)f(is)g(alw)o(a)o(ys)f(true,)h
(and)g(the)g(second)h(is)f(alw)o(a)o(ys)f(false.)173
590 y Fr({Y\(x\))21 b(IS)g(Y})h(=>)f(\(?Y\(x\):\):)f(<pattern>)129
640 y(|)i({Y\(x\))f(IS)g(C,)h(...)f(})g(=>)h(\(?Y\(x\):\):)e
(\(?Y\(x\).C.B:\):)f(<pattern>)129 723 y Fv(The)14 b(binding)e
(instance)i Fr(\(?Y\(x\).C.B:\))c Fv(is)j(meaningless)f(b)q(ecause)j
Fr(Y\(x\))21 b(is)g(C)13 b Fv(is)g(false.)-31 785 y Fp(182a)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(181c)23 b(182b)t Fm(.)171 835 y Fr(procedure)d
(unwind_instance_i)o(nputs)o(\(e,)f(postfix_name\))215
884 y(/postfix_name)g(:=)i("")215 934 y(type\(e\))f(==)h
("Einstance_input")e(|)i(impossible\("unwind)o(ing)e(",)i
(expimage\(e\),)e(")j(:)f(",)h(type\(e\)\))215 984 y(postfix_name)d(:=)
i(".")g(||)h(e.cons.name)d(||)j(".")f(||)g(e.name)g(||)g(postfix_name)
215 1034 y(return)f(case)h(type\(e.x\))f(of)h({)258 1084
y("Ebinding_instance)o(")e(:)302 1134 y(binding_instance)o(_var\()367
1183 y(binding_instance_i)o(nput_)o(name\()o(e.x.)o(name)f(||)k
(postfix_name,)d(e.x.vart\)\))258 1233 y("Einstance")h(:)367
1283 y(if)h(e.x.cons)g(===)g(e.cons)f(then)h(e.x.argt[e.name])e(else)i
(Efail\(expimage\(e)o(\)\))258 1333 y("Einstance_input")d(:)302
1383 y(case)j(type\(x)f(:=)i(unwind_instance_)o(inpu)o(ts\(e.)o(x,)d
(postfix_name\)\))g(of)i({)345 1432 y("binding_instance_v)o(ar")e(:)i
(x)345 1482 y(default)g(:)g({)389 1532 y(e)g(:=)h(Einstance_input\(x)o
(,)d(e.cons,)h(e.name\))389 1582 y(unwind_instance_i)o(nputs)o(\(e,)f
(postfix_name\))g(|)i(e)44 b(#)21 b(guaranteed)f(to)h(terminate)345
1632 y(})302 1681 y(})215 1731 y(})171 1781 y(end)129
1833 y Fp(De\014nes:)171 1872 y Fl(unwind_ins)o(tan)o(ce_)o(inp)o(ut)o
(s)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(180)h(and)g(181b.)129
1912 y(Uses)18 b Fl(binding_in)o(sta)o(nce)o(_in)o(put)o(_n)o(ame)c
Fp(182b,)i Fl(binding_ins)o(ta)o(nce)o(_va)o(r)f Fp(181c,)171
1951 y Fl(Ebinding_i)o(nst)o(anc)o(e)f Fp(81,)i Fl(Efail)g
Fp(81,)g Fl(Einstance)e Fp(81,)i Fl(Einstance_i)o(npu)o(t)e
Fp(81,)171 1991 y(and)d Fl(expimage)d Fp(101a.)-33 2074
y(182b)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(182a)22 b(183a)5 b Fm(.)171 2124 y Fr(procedure)20
b(binding_instance_)o(input)o(_name)o(\(nam)o(e,)f(vart\))215
2173 y(/vart[name])g(:=)i(fresh_variable\(name\))215
2223 y(return)f(vart[name])171 2273 y(end)129 2325 y
Fp(De\014nes:)171 2364 y Fl(binding_in)o(sta)o(nce)o(_in)o(pu)o(t_n)o
(ame)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(182a.)129 2404
y(Uses)i Fl(fresh_varia)o(ble)c Fp(155b.)p eop
%%Page: 183 183
183 182 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(183)145 258 y Fj(8.4)66
b(Mac)n(hine-indep)r(enden)n(t)29 b(supp)r(ort)e(for)e(enco)r(ding)298
332 y(pro)r(cedures)145 423 y Fv(The)16 b(deal)f(here)h(is)f(to)g
(transform)f(a)h(pattern)g(with)g(tag)g(conditions)g(in)o(to)f(a)h
(nested)h(case)145 473 y(statemen)o(t.)-15 535 y Fp(183a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(182b)22 b(183b)5 b Fm(.)187 585 y Fr(record)20
b(Stagcase\(x,)g(type,)h(arms\))217 b(#)21 b(CASE)g(x)h(:)f(type)g(OF)h
(arms)f(END)145 637 y Fp(De\014nes:)187 677 y Fl(Stagcase)p
Fp(,)9 b(used)j(in)g(c)o(h)o(unks)e(83a,)i(86b,)f(93a,)g(109a,)g(118b,)
g(124c,)g(132b,)g(184a,)g(189b,)g(250a,)g(313,)228 716
y(331e,)f(and)h(344a.)145 778 y Fr(x)i Fv(is)g(the)g(instance)h(from)d
(whic)o(h)i(w)o(e)g(will)e(c)o(hec)o(k)j(the)g(tag,)e
Fr(type)g Fv(is)h(the)g(constructor)i(t)o(yp)q(e)145
828 y(\(of)h Fr(x)p Fv(\),)f(and)h Fr(arms)f Fv(is)g(a)h(table)f
(mapping)f(eac)o(h)i(constructor)i(of)d(the)h(t)o(yp)q(e)g(to)g(a)g
(pattern)145 878 y(\(or)e(another)h(case)f(statemen)o(t\).)208
928 y(W)m(e're)f(going)g(to)h(destro)o(y)g(the)h(pattern,)f(so)g(w)o(e)
g(use)h(a)e(fresh)i(one.)-17 990 y Fp(183b)88 b Fo(h)p
Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5
b Fp(183a)22 b(184a)5 b Fm(.)187 1040 y Fr(procedure)20
b(pattern_to_case\()o(p\))230 1090 y Fo(h)p Fn(err)n(or)14
b(if)g Fr(p)h Fn(has)g(no)h(disjuncts)f Fp(193c)p Fo(i)230
1139 y Fr(return)21 b(do_pattern_to_cas)o(e\(fre)o(shen_)o(disju)o
(ncts)o(\(p\)\))187 1189 y(end)145 1241 y Fp(De\014nes:)187
1280 y Fl(pattern_to)o(_ca)o(se)o Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f
(188b,)g(233,)g(and)h(308.)145 1320 y(Uses)h Fl(do_pattern)o(_to)o(_ca)
o(se)c Fp(184a)j(and)f Fl(freshen_dis)o(jun)o(cts)e Fp(80b.)208
1382 y Fv(T)m(o)15 b(pro)q(duce)i(a)e(case)i(statemen)o(t,)f(pull)f
(out)h(the)g(tags,)g(then)h(recurse.)26 b(It's)16 b(p)q(ossible)145
1432 y(that)g(some)f(constructors)i(ha)o(v)o(e)f(b)q(een)h(discarded)f
(b)q(et)o(w)o(een)h(the)g(time)d(w)o(e)i(de\014ned)h(pat-)145
1482 y(tern)i Fr(p)e Fv(and)g(the)h(time)e(w)o(e're)i(actually)f(doing)
g(the)h(pattern-to-case)h(con)o(v)o(ersion.)29 b(F)m(or)145
1532 y(example,)11 b(on)g(the)h(P)o(en)o(tium,)f(w)o(e)h(sp)q(ecify)g
(all)f(addressing)h(mo)q(des,)f(but)h(when)g(generating)145
1581 y(instructions)19 b(for)g(the)g(32-bit)e(instructions,)j(w)o(e)f
(discard)g(un)o(used)g(constructors)h(\(e.g.,)145 1631
y Fr(Index8)p Fv(\):)-13 1694 y Fp(183c)88 b Fo(h)p Fn(example)16
b Fp(183c)p Fo(i)n(\021)187 1743 y Fr(constructors)230
1793 y(Index8)43 b(base,index:)19 b(Eaddr)i(...)230 1843
y(Index32)g(base,index:)e(Eaddr)i(...)230 1893 y(Add)h(Eaddr,)e(r)i(is)
f(...)187 1943 y(discard)f(Index8)145 1994 y Fp(Uses)12
b Fl(constructo)o(rs)c Fp(32a.)p eop
%%Page: 184 184
184 183 bop 129 141 a Fv(184)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(W)m(e)18
b(drop)h(disjuncts)h(with)f(conditions)g(that)g(sa)o(y)g(an)f(instance)
i(is)f(tagged)g(with)g(a)129 307 y(discarded)d(constructor.)23
b(Since)15 b Fr(s.arms[cons])d Fv(is)j(non-n)o(ull)f(only)g(for)g(k)o
(ept)h(construc-)129 357 y(tors)g Fr(cons)p Fv(,)d(w)o(e)i(can)h(use)f
(that)g(test)h(to)f(drop)g(suc)o(h)h(disjuncts.)-31 420
y Fp(184a)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p
Fo(\021)1031 b Fm(/)5 b Fp(183b)23 b(184b)t Fm(.)171
469 y Fr(procedure)d(do_pattern_to_cas)o(e\(p\))215 519
y(local)g(rep)283 b(#)22 b(representative)c(tag)k(condition)215
569 y(if)f(rep)g(:=)g(tag_test_in_every_di)o(sjunc)o(t\(p\))d(then)j({)
258 619 y(s)h(:=)f(Stagcase\(rep.x,)e(rep.cons.type,)g(table\(\)\))258
669 y(every)i(s.arms[kept_const)o(ructo)o(rs\(s.)o(type)o(\)])e(:=)i
(pattern\([]\))258 718 y(every)g(d)g(:=)h(!p.disjuncts)d(do)j({)302
768 y(if)f(type\(c)g(:=)g(!d.conditions\))e(==)i("Einstance_tagged")d
(&)k(c.uid)f(=)g(rep.uid)g(&)367 818 y(exps_eq\(rep.x,)e(c.x\))302
868 y(then)i({)345 918 y(delete\(d.conditions)o(,)e(c\))345
967 y(put\(\(\\s.arms[c.cons)o(]\).di)o(sjunc)o(ts,)f(d\))302
1017 y(})j(else)345 1067 y(impossible\("Mislaid)d(a)k(tag)f(condition)f
(on)h(",)h(expimage\(rep.x\)\))258 1117 y(})258 1167
y(every)f(c)g(:=)h(key\(s.arms\))d(do)j(s.arms[c])e(:=)h
(do_pattern_to_case)o(\(s.ar)o(ms[c)o(]\))258 1217 y(return)g(s)215
1266 y(})g(else)g(if)g(rep)h(:=)f(tag_test_in_any_di)o(sjun)o(ct\(p\))d
(then)j({)280 1316 y(PPxwrite\(PPnew\(&e)o(rrout)o(\),)e("Can't)h
(eliminate)g(tag)h(condition)f(on)i(",)f(ppexpimage\(rep.x\),)672
1366 y(")h($t$ofrom)e(pattern)g($c",)h(ppexpimage\(p\)\))280
1416 y(impossible\("Repor)o(t)e(a)j(bug)f(in)g(the)g(toolkit"\))215
1466 y(})g(else)258 1515 y(return)g(simplify\(p\))171
1565 y(end)129 1617 y Fp(De\014nes:)171 1657 y Fl(do_pattern)o(_to)o
(_ca)o(se)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(183b.)129
1696 y(Uses)g Fl(Einstance_)o(tag)o(ged)c Fp(81,)j Fl(expimage)d
Fp(101a,)i Fl(exps_eq)f Fp(84c,)i Fl(kept_cons)o(tru)o(cto)o(rs)d
Fp(33d,)i Fl(pattern)f Fp(55,)171 1735 y Fl(ppexpimage)j
Fp(101d,)i Fl(simplify)f Fp(92a,)i Fl(Stagcase)e Fp(183a,)h
Fl(tag_test_i)o(n_a)o(ny_)o(di)o(sju)o(nct)e Fp(184b,)171
1775 y(and)h Fl(tag_test_)o(in_)o(eve)o(ry)o(_di)o(sju)o(nct)d
Fp(185a.)-33 1858 y(184b)88 b Fo(h)p Fn(*)16 b Fp(159)p
Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(184a)22 b(185a)5
b Fm(.)171 1908 y Fr(procedure)20 b(tag_test_in_any_d)o(isjun)o
(ct\(p\))215 1958 y(suspend)g(type\(rep)g(:=)h(!\\\(!p.disjuncts\).co)o
(nditi)o(ons\))d(==)k("Einstance_tagge)o(d")d(&)i(rep)171
2007 y(end)129 2059 y Fp(De\014nes:)171 2099 y Fl(tag_test_i)o(n_a)o
(ny_)o(dis)o(ju)o(nct)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(184a.)129
2138 y(Uses)i Fl(Einstance_t)o(agg)o(ed)c Fp(81.)p eop
%%Page: 185 185
185 184 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(185)-15 258 y Fp(185a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(184b)22 b(185b)5 b Fm(.)187 307 y Fr(procedure)20
b(tag_test_in_ever)o(y_dis)o(junct)o(\(p\))230 357 y(every)h(type\(rep)
f(:=)i(!\\p.disjuncts[1])o(.cond)o(itio)o(ns\))d(==)i
("Einstance_tagged")d(do)274 407 y(if)j(tag_test_not_in_dis)o(junct)o
(\(rep,)d(!p.disjuncts\))h(then)i(&null)g(else)g(return)f(rep)230
457 y(fail)187 507 y(end)187 606 y(procedure)g(tag_test_not_in_)o
(disju)o(nct\(r)o(ep,)f(d\))230 656 y(if)j(type\(c)e(:=)i
(!\\d.conditions\))c(==)k("Einstance_tagge)o(d")d(&)i(c.uid)g(=)h
(rep.uid)e(&)296 706 y(exps_eq\(rep.x,)f(c.x\))i(then)g(fail)230
756 y(else)g(return)187 806 y(end)145 857 y Fp(De\014nes:)187
897 y Fl(tag_test_i)o(n_e)o(ve)o(ry_)o(dis)o(jun)o(ct)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(184a.)145 936 y(Uses)i
Fl(Einstance_)o(tag)o(ged)c Fp(81,)j Fl(exps_eq)e Fp(84c,)i(and)f
Fl(fail)h Fp(410.)208 1007 y Fv(The)16 b(structure)i(of)d(an)g(enco)q
(ding)h(pro)q(cedure)i(is)e(complex)e(b)q(ecause)k(of)d(the)h(n)o(um)o
(b)q(er)145 1057 y(of)e(conditions)f(to)h(b)q(e)g(c)o(hec)o(k)o(ed.)20
b(Here)15 b(is)f(a)f(sk)o(etc)o(h)i(of)e(the)i(conditions:)249
1123 y Fr(iwidth)103 b Fv(input-width)13 b(conditions)g(for)h(the)h
(constructor)249 1173 y Fr(conds)125 b Fv(conditions)13
b(for)h(a)f(branc)o(h)i(to)e(b)q(e)i(tak)o(en)249 1223
y Fr(cknown)103 b Fv(conditions)13 b(that)h(m)o(ust)f(hold)g(b)q(efore)
i Fr(conds)e Fv(can)h(b)q(e)484 1273 y(ev)n(aluated)f(\(e.g.,)g(relo)q
(catable)h(addresses)i(are)e(kno)o(wn\))249 1327 y Fr(fits)147
b Fv(\014eld-width)13 b(conditions)h(for)f(\014elds)i(to)e(b)q(e)i
(emitted,)e(and)484 1376 y(conditions)g(that)h(attempts)g(to)f(narro)o
(w)h(actually)f(\014t)249 1430 y Fr(fknown)103 b Fv(conditions)13
b(that)h(m)o(ust)f(hold)g(b)q(efore)i(\014elds)f(can)g(b)q(e)h(emitted)
484 1480 y(or)e Fr(fits)g Fv(can)i(b)q(e)f(ev)n(aluated)g(\(again,)e
(relo)q(catable)484 1530 y(addresses\).)20 b Fr(fknown)12
b Fv(nev)o(er)j(rep)q(eats)h(an)o(y)d(conditions)484
1580 y(already)g(in)h Fr(cknown)p Fv(,)e(b)q(ecause)j(its)f(use)h(is)f
(alw)o(a)o(ys)e(guarded)484 1630 y(b)o(y)h Fr(cknown)145
1711 y Fv(The)20 b Fr(*known)e Fv(conditions)h(in\015uence)i(closure)f
(creation,)h(the)f Fr(*width)e Fv(conditions)h(are)145
1761 y(error)c(c)o(hec)o(ks)g(only)m(,)d(and)i Fr(conds)f
Fv(is)h(used)h(for)e(branc)o(h)h(selection.)208 1810
y(Rather)e(than)g(use)h(C)f(templates,)f(w)o(e)i(use)g(a)e
(language-indep)q(enden)o(t)i(represen)o(tation)145 1860
y(of)h(con)o(trol)f(\015o)o(w.)-17 1922 y Fp(185b)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(185a)22 b(186b)5 b Fm(.)187 1972 y Fr(record)20
b(Sstms\(stmts\))456 b(#)21 b(statement)f(sequence)208
2035 y Fv(A)d(constructor)j(branc)o(h)e(is)f(c)o(hosen)i(conserv)n
(ativ)o(ely)m(,)e(except)i(for)f(the)g(last)f(branc)o(h,)145
2084 y(whic)o(h)e(gets)h(sp)q(ecial)g(treatmen)o(t.)21
b(While)15 b(an)g(early)g(branc)o(h)g(is)g(tak)o(en)h(i\013)f(its)g
(conditions)145 2134 y(are)g(kno)o(wn)e(to)h(b)q(e)g(true,)h(a)e(late)h
(branc)o(h)g(is)g(tak)o(en)g(i\013)g(its)f(conditions)h(are)g(not)g
(kno)o(wn)g(to)145 2184 y(b)q(e)h(false.)208 2234 y(Field)e(conditions)
h(are)g(used)h(to)e(decide)i(branc)o(hes)g(no)o(w.)-13
2296 y Fp(185c)88 b Fo(h)p Fn(e)n(arly-br)n(anch.s)15
b Fp(185c)p Fo(i)n(\021)187 2346 y Fr(if)21 b(\(cknown)g(&&)g(conds)g
(&&)g(fknown)g(&&)g(fits\))g({)230 2396 y(emit)187 2445
y(})p eop
%%Page: 186 186
186 185 bop 129 141 a Fv(186)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(186a)88
b Fo(h)p Fn(old-e)n(arly-br)n(anch.s)15 b Fp(186a)p Fo(i)n(\021)171
307 y Fr(if)21 b(\(cknown)g(&&)g(conds\))g({)215 357
y(if)g(\(fknown\))f({)258 407 y(fits_aborts;)172 b(#)22
b(abort)e(if)i(fits)f(not)g(satisfied)258 457 y(emit_fields;)215
507 y(})g(else)258 557 y(create_closure;)171 606 y(})192
677 y Fv(The)14 b(Icon)g(branc)o(h)g(pro)q(cedures)j(add)c(their)i
(branc)o(hes)g(to)f(a)f(list)h(of)f(arms.)-33 739 y Fp(186b)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(185b)22 b(186c)5 b Fm(.)171 789 y Fr(procedure)20
b(old_early_branch\()o(arms,)e(cknown,)i(conds,)h(fknown,)f(fits,)h
(emit,)g(closure\))215 839 y(local)f(fits_and_emit)215
889 y(fits_and_emit)f(:=)i(Sif\([]\))215 938 y(every)f(c)i(:=)f
(!\\fits)g(do)258 988 y(put\(fits_and_emit.)o(arms,)d
(Sguarded\(Enot\(c\),)g(widthfailure\(c\)\)\))215 1038
y(put\(fits_and_em)o(it.ar)o(ms,)h(Sguarded\(1,)g(emit\)\))215
1088 y(return)h(put\(arms,)g(Sguarded\(Eand\(ckno)o(wn,)e(conds\),)672
1138 y(Sif\([Sguarded\(fkno)o(wn,)h(fits_and_emit\),)f(Sguarded\(1,)i
(closure\)]\)\)\))171 1187 y(end)171 1287 y(procedure)g
(early_branch\(arms)o(,)f(cknown,)h(conds,)h(emit\))215
1337 y(return)f(put\(arms,)g(Sguarded\(conjoin\(c)o(know)o(n,)f
(conds\),)h(emit\)\))171 1387 y(end)129 1439 y Fp(De\014nes:)171
1478 y Fl(early_bran)o(ch)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(190)g
(and)h(192.)129 1518 y(Uses)h Fl(conjoin)d Fp(186c,)i
Fl(Eand)f Fp(81,)h Fl(Enot)f Fp(81,)h Fl(Sguarded)e Fp(81,)i
Fl(Sif)f Fp(81,)h(and)g Fl(widthfailu)o(re)d Fp(198a.)192
1580 y Fr(conjoin)19 b Fv(eliminates)h(duplicate)h(conditions.)40
b(This)21 b(co)q(de)h(should)f(probably)g(b)q(e)129 1630
y(mo)o(v)o(ed)13 b(in)o(to)g(the)h(simpli\014er)f(somewhere,)g(but)h
(I'm)e(not)i(sure)h(where.)-29 1692 y Fp(186c)88 b Fo(h)p
Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1033 b Fm(/)5
b Fp(186b)22 b(187a)5 b Fm(.)171 1742 y Fr(procedure)20
b(conjoin\(L[]\))215 1791 y(pushtrace\("CONJ)o("\))215
1841 y(x)h(:=)h(do_conjoin\(1,)d(set\(\),)h(L\))215 1891
y(poptrace\(\))215 1941 y(return)g(x)171 1991 y(end)129
2043 y Fp(De\014nes:)171 2082 y Fl(conjoin)p Fp(,)9 b(used)i(in)g(c)o
(h)o(unks)f(68)h(and)f(186b.)129 2121 y(Uses)i Fl(do_conjoin)c
Fp(187a.)p eop
%%Page: 187 187
187 186 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(187)-15 258 y Fp(187a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(186c)22 b(188a)5 b Fm(.)187 307 y Fr(procedure)20
b(do_conjoin\(early)o(,)f(tested,)h(rest\))230 357 y(if)i(e)f(:=)h
(get\(rest\))e(then)274 407 y(case)h(type\(e\))f(of)i({)318
457 y(default)e(:)h({)361 507 y(e)h(:=)f(super_simplify\(e\))361
557 y(if)h(exps_eq\(!tested)o(,)d(e\))i(then)g({)187
606 y(#write\("TESTED)e(",)i(expimage\(e\)\))405 656
y(return)f(do_conjoin\(early,)f(tested,)h(rest\))361
706 y(})i(else)f({)187 756 y(#write\("USING)e(",)i(expimage\(e\)\))405
806 y(insert\(tested,)e(e\))405 855 y(return)h(binary_conjunction\()o
(early)o(,)f(do_conjoin\(e,)g(tested,)h(rest\)\))361
905 y(})318 955 y(})318 1005 y("set")g(:)i({)361 1055
y(every)f(push\(rest,)f(!e\))361 1104 y(return)h(do_conjoin\(early)o(,)
e(tested,)h(rest\))318 1154 y(})274 1204 y(})230 1254
y(else)274 1304 y(return)h(early)187 1354 y(end)187 1453
y(procedure)f(binary_conjuncti)o(on\(x,)e(y\))230 1503
y(return)j(if)g(x)h(===)f(1)h(then)f(y)g(else)g(if)h(y)f(===)g(1)h
(then)f(x)g(else)g(Eand\(x,)g(y\))187 1553 y(end)145
1605 y Fp(De\014nes:)187 1644 y Fl(do_conjoin)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)d(186c.)145 1684 y(Uses)j Fl(Eand)e
Fp(81,)h Fl(expimage)e Fp(101a,)h Fl(exps_eq)f Fp(84c,)i(and)g
Fl(super_sim)o(pli)o(fy)d Fp(92c.)-17 1775 y(187b)88
b Fo(h)p Fn(late-br)n(anch.s)15 b Fp(187b)p Fo(i)o(\021)187
1825 y Fr(if)21 b(\(cknown\))f({)230 1875 y(if)i(\(conds\))e({)274
1924 y(if)h(\(fknown\))f({)318 1974 y(fits_aborts;)318
2024 y(emit_fields;)274 2074 y(})i(else)f({)318 2124
y(unchecked_closu)o(re;)274 2173 y(})230 2223 y(})h(else)f({)274
2273 y(condition_failure)o(;)230 2323 y(})187 2373 y(})g(else)g({)230
2422 y(checked_closure;)187 2472 y(})p eop
%%Page: 188 188
188 187 bop 129 141 a Fv(188)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(188a)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(187a)23 b(188b)t Fm(.)171 307 y Fr(procedure)d
(last_branch\(arms,)e(cknown,)j(conds,)f(fknown,)g(fits_and_emit,)f
(uclosure,)650 357 y(condfail,)h(cclosure\))215 407 y(every)g
(put\(arms,)432 457 y(Sguarded\(cknown,)f(Sif\()520 507
y([Sguarded\(conds,)672 557 y(Sif\([Sguarded\(fkno)o(wn,)g
(fits_and_emit\),)f(Sguarded\(1,)i(uclosure\)]\)\),)541
606 y(Sguarded\(1,)g(condfail\)]\)\))f(|)432 656 y(Sguarded\(1,)h
(cclosure\)\))215 706 y(return)g(arms)171 756 y(end)129
808 y Fp(De\014nes:)171 847 y Fl(last_branc)o(h)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(190)h(and)f(192.)129 887
y(Uses)i Fl(Sguarded)d Fp(81)i(and)g Fl(Sif)f Fp(81.)-33
978 y(188b)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p
Fo(\021)1037 b Fm(/)5 b Fp(188a)22 b(188c)5 b Fm(.)171
1028 y Fr(procedure)20 b(emitter_body\(cons)o(\))215
1077 y(s)h(:=)h([])215 1127 y(every)e(f)i(:=)f(inputs_of\(cons,)e
("field"\).meaning)f(&)345 1177 y(not)j(member\(unchecked_fie)o(lds,)d
(f\))k(&)f(fwidth\(f\))f(<)i(wordsize)e(do)258 1227 y(put\(s,)h
(Sguarded\(Enot\(Ef)o(itsu\()o(liter)o(al\(f)o(.name)o(\),)e
(fwidth\(f\)\)\),)607 1277 y(Sfail\("field)g(")j(||)f(f.name)g(||)g(")h
(does)f(not)g(fit)g(in)g(")h(||)738 1327 y(fwidth\(f\))e(||)h(")g
(unsigned)g(bits"\)\)\))215 1376 y(every)f(f)i(:=)f
(symtab[inputs_of\(co)o(ns,)e("integer"\).name)o(])g(&)345
1426 y(not)i(member\(unchecked_fie)o(lds,)d(f\))k(&)f(fwidth\(f\))f(<)i
(wordsize)e(do)258 1476 y(put\(s,)h(Sguarded\(Enot\(Ef)o(itss\()o
(liter)o(al\(f)o(.name)o(\),)e(fwidth\(f\)\)\),)607 1526
y(Sfail\("field)g(")j(||)f(f.name)g(||)g(")h(does)f(not)g(fit)g(in)g(")
h(||)738 1576 y(fwidth\(f\))e(||)h(")g(signed)g(bits"\)\)\))215
1625 y(put\(s,)f(Sguarded\(1,)g(case_to_emitter\()o(patt)o(ern_t)o
(o_cas)o(e\()520 1675 y(subst_tab\(crhs\(c)o(ons\),)e(parmtab\(cons\),)
h(1\)\),)i(cons\)\)\))215 1725 y(return)f(super_simplify\(Sif)o
(\(s\)\))171 1775 y(end)129 1827 y Fp(De\014nes:)171
1866 y Fl(emitter_bo)o(dy)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(214a.)
129 1906 y(Uses)15 b Fl(case_to_emi)o(tte)o(r)d Fp(189b,)h
Fl(crhs)g Fp(168,)h Fl(Efitss)e Fp(81,)i Fl(Efitsu)f
Fp(81,)h Fl(Enot)f Fp(81,)h Fl(field)f Fp(55,)171 1945
y Fl(fwidth)f Fp(115d,)g Fl(inputs_of)e Fp(166a,)i Fl(literal)g
Fp(45e,)g Fl(parmtab)g Fp(189a,)g Fl(pattern_to)o(_ca)o(se)e
Fp(183b,)171 1985 y Fl(Sfail)h Fp(188c,)g Fl(Sguarded)e
Fp(81,)j Fl(Sif)f Fp(81,)h Fl(subst_tab)d Fp(89a,)i Fl(super_simpli)o
(fy)e Fp(92c,)i Fl(symtab)g Fp(32a)g(367,)171 2024 y
Fl(unchecked_)o(fie)o(lds)d Fp(354f,)i(and)h Fl(wordsize)e
Fp(38c.)192 2095 y Fr(Sfail)k Fv(is)g(lik)o(e)g Fr(printf)-29
2157 y Fp(188c)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o
Fv(+)p Fo(\021)1033 b Fm(/)5 b Fp(188b)22 b(189a)5 b
Fm(.)171 2207 y Fr(record)21 b(Sfail\(fmt,)e(a1,)i(a2,)h(a3\))129
2258 y Fp(De\014nes:)171 2298 y Fl(Sfail)p Fp(,)10 b(used)h(in)g(c)o(h)
o(unks)f(83a,)h(109b,)g(118b,)f(124c,)g(132c,)h(188b,)f(190,)h(192,)g
(198a,)f(209a,)h(215,)f(222c,)212 2337 y(332b,)h(and)f(344b.)p
eop
%%Page: 189 189
189 188 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(189)208 258 y Fr(parmtab)16
b Fv(pro)q(duces)j(a)f(substitution)g(table)g(that)g(do)q(es)g(the)h
(righ)o(t)e(thing)g(with)h(the)145 307 y(parameters)c(to)g(a)g(C)f
(emission)g(pro)q(cedure.)-15 370 y Fp(189a)88 b Fo(h)p
Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5
b Fp(188c)22 b(189b)5 b Fm(.)187 420 y Fr(procedure)20
b(parmtab\(cons\))230 469 y(t)i(:=)f(table\(\))230 519
y(every)g(ipt)g(:=)h(inputs_of\(cons\))c(do)274 569 y(t[ipt.name])h(:=)
j(case)f(type\(ipt.meaning\))d(of)j({)318 619 y("constype")e(:)j
(ipt.name)e(#)i(name)f(stands)f(for)h(an)h(instance)318
669 y("field")85 b(:)22 b(ipt.name)318 718 y("integer")41
b(:)22 b(Enarrows\(ipt.name)o(,)d(ipt.meaning\))318 768
y("string")63 b(:)22 b(Eforce\(ipt.name\))318 818 y("null")107
b(:)22 b(ipt.name)318 868 y(default)85 b(:)22 b(impossible\("input)c
(type"\))274 918 y(})230 967 y(return)j(t)187 1017 y(end)145
1069 y Fp(De\014nes:)187 1109 y Fl(parmtab)p Fp(,)9 b(used)h(in)i(c)o
(h)o(unks)d(188b)i(and)f(308.)145 1148 y(Uses)i Fl(constype)d
Fp(159,)h Fl(Eforce)g Fp(81,)h Fl(Enarrows)e Fp(81,)i
Fl(field)f Fp(55,)g Fl(input)g Fp(46a,)h(and)f Fl(inputs_of)f
Fp(166a.)145 1277 y Ft(8.4.1)56 b(Emission)-17 1353 y
Fp(189b)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(189a)22 b(193a)5 b Fm(.)187
1403 y Fr(procedure)20 b(case_to_emitter\()o(p,)f(cons\))230
1453 y(local)i(cknown,)f(conds,)h(fknown,)f(fits,)h(condition_failure_)
o(msg)230 1503 y(case)g(type\(p\))g(of)g({)274 1553 y("Stagcase")63
b(:)22 b({)339 1602 y(every)f(c)h(:=)f(kept_constructors\()o(p.typ)o
(e\))e(do)383 1652 y(p.arms[c])h(:=)h(case_to_emitter\(p.a)o(rms[)o
(c],)e(cons\))339 1702 y(return)i(p)274 1752 y(})274
1802 y("pattern")f(:)h({)p Fo(h)p Fn(turn)15 b(p)n(attern)g
Fr(p)g Fn(into)f(emitter)g(and)i(r)n(eturn)e(it)g Fp(190)p
Fo(i)p Fr(})230 1851 y(})187 1901 y(end)145 1953 y Fp(De\014nes:)187
1993 y Fl(case_to_em)o(itt)o(er)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f
(188b.)145 2032 y(Uses)i Fl(kept_const)o(ruc)o(tor)o(s)d
Fp(33d,)h Fl(pattern)f Fp(55,)i(and)g Fl(Stagcase)e Fp(183a.)p
eop
%%Page: 190 190
190 189 bop 129 141 a Fv(190)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(W)m(e)k(go)g(ahead)
h(and)g(p)q(ermit)f(enco)q(ding)h(of)f(patterns)i(with)e(no)h
(disjuncts,)h(b)q(ecause)129 307 y(they)c(migh)o(t)d(represen)o(t)k
(one)e(case)h(in)f(a)f(statemen)o(t)h(where)i(other)e(cases)h(are)g(v)n
(alid.)i(This)129 357 y(situation)12 b(holds)g(on)g(mac)o(hines)f(lik)o
(e)g(the)i(68k,)e(whic)o(h)h(forbid)g(certain)g(addressing)h(mo)q(des)
129 407 y(for)k(certain)g(instructions.)27 b(W)m(e)16
b(issue)i(a)e(w)o(arning)g(message,)h(and)f(if)g(sonmeb)q(o)q(dy)g
(tries)129 457 y(the)f(mo)q(de)e(at)h(enco)q(ding)g(time)e(they)j(get)f
(slapp)q(ed)g(with)g(an)f(error)i(message.)192 507 y(Note)20
b(that)f(w)o(e)h(just)g(set)g(the)g Fr(patlabel)e Fv(o\013sets,)k(not)d
(w)o(orrying)g(ab)q(out)g(whether)129 557 y(they're)11
b(shared)f(\(although)f(b)o(y)g(the)h(in)o(v)n(arian)o(t)e(they)i
(shouldn't)e(b)q(e\).)18 b(It)9 b(shouldn't)g(matter)129
606 y(b)q(ecause)16 b(the)f(o\013sets)g(are)f(then)h(used)f
(immediately)l(.)192 656 y(Except)g(for)f(the)i(last)e(disjunct)g
(\(branc)o(h\),)h(w)o(e)g(ha)o(v)o(e)f(to)h(attac)o(h)f(\\\014ts")h
(conditions)f(to)129 706 y(the)i(pattern)g(b)q(efore)f(the)h
(redundancy)g(c)o(hec)o(k.)-13 768 y Fp(190)88 b Fo(h)p
Fn(turn)15 b(p)n(attern)g Fr(p)g Fn(into)g(emitter)e(and)j(r)n(eturn)e
(it)h Fp(190)p Fo(i)o(\021)465 b Fp(\(189b\))171 818
y Fr(p)22 b(:=)f(freshen_disjuncts)o(\(p\))171 868 y(every)g
(add_fits_conditi)o(ons_a)o(nd_sa)o(nitiz)o(e\(p.)o(disju)o(ncts[)o(1)e
(to)i(*p.disjuncts-1],)e(cons\))171 918 y(remove_duplicate_)o(condi)o
(tions)o(\(p,)g(cons\))171 967 y(if)i(*p.disjuncts)f(=)h(0)h(then)f({)
215 1017 y Fo(h)p Fn(p)n(ossibly)14 b(warn)h(ab)n(out)g(b)n(ad)g(enc)n
(o)n(ding)h(for)e Fr(cons)h Fp(193d)p Fo(i)215 1067 y
Fr(return)20 b(Sfail\("impossible)e(encoding)j(\(no)g(disjuncts\))e
(---)j(perhaps)e(a)i(bad)f(address)f(mode?"\))171 1117
y(})171 1167 y(s)i(:=)f(Sif\([]\))171 1217 y Fo(h)p Fn(make)15
b Fr(condition_failure_m)o(sg)d Fn(c)n(omplain)j(of)g(unde)n(cide)n(d)h
(br)n(anch)f(or)f(unsatis\014e)n(d)i(c)n(onditions)f
Fp(193b)p Fo(i)171 1266 y Fr(while)21 b(*p.disjuncts)e(>)j(1)f(do)h({)f
(#)h(early)f(branches)215 1316 y(d)g(:=)h(get\(p.disjuncts)o(\))215
1366 y(set_patlabel_of)o(fsets)o(\(d\))215 1416 y(d)f(:=)h(gsubst\(d,)d
(Epatlabel_to_Epc\))215 1466 y(conds)h(:=)i(conditions_with_)o(narro)o
(ws_ch)o(eck\()o(d.con)o(ditio)o(ns,)d(cons\))215 1515
y(cknown)h(:=)h(known_conditions\(con)o(ds\))215 1565
y(early_branch\(s.)o(arms,)d(cknown,)j(conds,)f(disjunct_to_emissi)o
(on\(d\))o(\))171 1615 y(})171 1665 y(if)h(d)h(:=)f(get\(p.disjuncts\))
e(then)i({)g(#)h(last)f(branch)f(---)i(fits)f(conditions)e(not)i
(folded)g(in!)215 1715 y(*p.disjuncts)e(=)i(0)h(|)g(impossible\("bug)c
(in)k(constructors"\))215 1764 y(set_patlabel_of)o(fsets)o(\(d\))215
1814 y(d)f(:=)h(gsubst\(d,)d(Epatlabel_to_Epc\))215 1864
y(conds)h(:=)i(conditions_with_)o(narro)o(ws_ch)o(eck\()o(d.con)o
(ditio)o(ns,)d(cons\))215 1914 y(cknown)h(:=)h(known_conditions\(con)o
(ds\))215 1964 y(fknown)f(:=)h(known_conditions\(d.s)o(equen)o(ts\))215
2014 y Fo(h)p Fn(strip)14 b Fr(fknown)f Fn(of)i(c)n(onditions)h(alr)n
(e)n(ady)e(in)h Fr(cknown)f Fp(198c)p Fo(i)215 2063 y
Fr(fits)21 b(:=)g(fits_conditions_o)o(f\(d,)d(cons\))215
2113 y(sanitize_sequen)o(ts\(d,)g(fits\))215 2163 y(fwe)j(:=)g
(Sif\([]\))215 2213 y(every)f(c)i(:=)f(!\\fits)g(do)258
2263 y(put\(fwe.arms,)e(Sguarded\(Enot\(c\),)g(widthfailure\(c\))o
(\)\))215 2312 y(put\(fwe.arms,)g(Sguarded\(1,)g(disjunct_to_emissi)o
(on\(d\))o(\)\))215 2362 y(last_branch)g(\(s.arms,)h(cknown,)h(conds,)f
(fknown,)g(fwe,)h(Sclosure\(d\),)498 2412 y(Sfail\(condition_f)o(ailur)
o(e_ms)o(g)e(||)i(")h(for)f(constructor)f(")h(||)h(cons.name\),)498
2462 y(Sclosure\(d,)d(conds\)\))p eop
%%Page: 191 191
191 190 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(191)187 258 y Fr(})187 307
y(return)20 b(s)145 359 y Fp(Uses)d Fl(add_fits_c)o(on)o(dit)o(ion)o
(s_a)o(nd_)o(sa)o(nit)o(ize)c Fp(199b,)i Fl(address)f
Fp(383a,)h Fl(branch)f Fp(159,)187 399 y Fl(conditions)o(_wi)o(th)o
(_na)o(rro)o(ws_)o(che)o(ck)e Fp(200a,)i Fl(constructo)o(r)e
Fp(159,)j Fl(construct)o(ors)d Fp(32a,)187 438 y Fl(disjunct_t)o(o_e)o
(mi)o(ssi)o(on)e Fp(194b,)i Fl(early_bran)o(ch)e Fp(186b,)i
Fl(Enot)g Fp(81,)h Fl(Epatlabel)o(_to)o(_Ep)o(c)d Fp(193a,)187
478 y Fl(fits_condi)o(tio)o(ns)o(_of)d Fp(199a,)j Fl(freshen_di)o(sju)o
(nc)o(ts)e Fp(80b,)h Fl(gsubst)g Fp(120a,)h Fl(known_cond)o(it)o(ion)o
(s)e Fp(198b,)187 517 y Fl(last_branc)o(h)j Fp(188a,)h
Fl(remove_dup)o(lic)o(ate)o(_co)o(ndi)o(ti)o(ons)e Fp(197a,)j
Fl(sanitize_)o(seq)o(uen)o(ts)d Fp(194a,)187 557 y Fl(Sclosure)i
Fp(193f,)i Fl(set_patlab)o(el_)o(of)o(fse)o(ts)e Fp(59c,)i
Fl(Sfail)f Fp(188c,)h Fl(Sguarded)e Fp(81,)i Fl(Sif)h
Fp(81,)187 596 y(and)10 b Fl(widthfailur)o(e)f Fp(198a.)p
eop
%%Page: 192 192
192 191 bop 129 141 a Fv(192)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(This)h(old)f(co)q
(de)i(is)f(BOGUS)h(b)q(ecause)h(it)e(do)q(esn't)g(include)h(\\\014ts")f
(conditions)g(b)q(efore)129 307 y(the)i(redunancy)g(c)o(hec)o(k.)22
b(Therefore)16 b(all)d(but)i(the)h(\014rst)g(disjunct)f(gets)g(thro)o
(wn)g(out,)g(and)129 357 y(then)f(when)f(a)f(v)n(alue)g(do)q(esn't)h
(\014t,)f(the)h(to)q(olkit)f(go)q(es)h(b)q(elly-up)f(at)g(run)h(time.)j
(Not)d(prett)o(y)m(.)129 407 y(.)1450 b Fk(\031Fixes)14
b(bug)g(#15)-13 469 y Fp(192)88 b Fo(h)p Fn(old,)15 b(b)n(o)n(gus)g
(turn)g(p)n(attern)g Fr(p)g Fn(into)f(emitter)g(and)i(r)n(eturn)e(it)h
Fp(192)p Fo(i)o(\021)171 519 y Fr(remove_duplicate_)o(condi)o(tions)o
(\(p,)k(cons\))171 569 y(if)i(*p.disjuncts)f(=)h(0)h(then)f({)215
619 y Fo(h)p Fn(p)n(ossibly)14 b(warn)h(ab)n(out)g(b)n(ad)g(enc)n(o)n
(ding)h(for)e Fr(cons)h Fp(193d)p Fo(i)215 669 y Fr(return)20
b(Sfail\("impossible)e(encoding)j(\(no)g(disjuncts\))e(---)j(perhaps)e
(a)i(bad)f(address)f(mode?"\))171 718 y(})171 768 y(s)i(:=)f(Sif\([]\))
171 818 y Fo(h)p Fn(make)15 b Fr(condition_failure_m)o(sg)d
Fn(c)n(omplain)j(of)g(unde)n(cide)n(d)h(br)n(anch)f(or)f(unsatis\014e)n
(d)i(c)n(onditions)f Fp(193b)p Fo(i)171 868 y Fr(while)21
b(d)g(:=)h(get\(p.disjuncts\))c(do)k({)215 918 y(set_patlabel_of)o
(fsets)o(\(d\))215 967 y(d)f(:=)h(gsubst\(d,)d(Epatlabel_to_Epc\))215
1017 y(conds)h(:=)i(conditions_with_)o(narro)o(ws_ch)o(eck\()o(d.con)o
(ditio)o(ns,)d(cons\))215 1067 y(cknown)h(:=)h(known_conditions\(con)o
(ds\))215 1117 y(fknown)f(:=)h(known_conditions\(d.s)o(equen)o(ts\))215
1167 y Fo(h)p Fn(strip)14 b Fr(fknown)f Fn(of)i(c)n(onditions)h(alr)n
(e)n(ady)e(in)h Fr(cknown)f Fp(198c)p Fo(i)215 1217 y
Fr(fits)21 b(:=)g(fits_conditions_o)o(f\(d,)d(cons\))215
1266 y(sanitize_sequen)o(ts\(d,)g(fits\))215 1316 y(fwe)j(:=)g
(Sif\([]\))215 1366 y(every)f(c)i(:=)f(!\\fits)g(do)258
1416 y(put\(fwe.arms,)e(Sguarded\(Enot\(c\),)g(widthfailure\(c\))o
(\)\))215 1466 y(put\(fwe.arms,)g(Sguarded\(1,)g(disjunct_to_emissi)o
(on\(d\))o(\)\))171 1515 y(if)i(*p.disjuncts)f(>)h(0)h(then)f
(write\(&errout,)e("Early)h(branch)h(for)g(constructor)e(",)j
(cons.name\))215 1565 y(if)f(*p.disjuncts)e(>)j(0)f(then)258
1615 y(early_branch\(s.arm)o(s,)e(cknown,)h(conds,)h(fknown,)f(fits,)h
(disjunct_to_emis)o(sion\()o(d\),)e(Sclosure\(d\)\))215
1665 y(else)258 1715 y(last_branch)h(\(s.arms,)g(cknown,)g(conds,)h
(fknown,)f(fwe,)h(Sclosure\(d\),)541 1764 y(Sfail\(condition_fail)o
(ure_)o(msg)e(||)i(")h(for)f(constructor)e(")j(||)f(cons.name\),)541
1814 y(Sclosure\(d,)f(conds\)\))171 1864 y(})171 1914
y(return)h(s)129 1966 y Fp(Uses)13 b Fl(address)d Fp(383a,)h
Fl(branch)f Fp(159,)i Fl(condition)o(s_w)o(ith)o(_na)o(rr)o(ows)o(_ch)o
(eck)d Fp(200a,)i Fl(constructo)o(r)e Fp(159,)171 2005
y Fl(disjunct_t)o(o_e)o(mis)o(sio)o(n)h Fp(194b,)i Fl(early_branc)o(h)e
Fp(186b,)i Fl(Enot)g Fp(81,)h Fl(Epatlabel_)o(to_)o(Ep)o(c)e
Fp(193a,)171 2045 y Fl(fits_condi)o(tio)o(ns_)o(of)f
Fp(199a,)h Fl(gsubst)g Fp(120a,)h Fl(known_cond)o(iti)o(ons)e
Fp(198b,)h Fl(last_branch)e Fp(188a,)171 2084 y Fl(remove_dup)o(lic)o
(ate)o(_co)o(nd)o(iti)o(ons)i Fp(197a,)j Fl(sanitize_)o(seq)o(uen)o(ts)
e Fp(194a,)h Fl(Sclosure)f Fp(193f,)171 2124 y Fl(set_patlab)o(el_)o
(off)o(set)o(s)d Fp(59c,)h Fl(Sfail)g Fp(188c,)g Fl(Sguarded)f
Fp(81,)i Fl(Sif)g Fp(81,)g(and)f Fl(widthfailur)o(e)f
Fp(198a.)p eop
%%Page: 193 193
193 192 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(193)-15 258 y Fp(193a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(189b)22 b(193e)5 b Fm(.)187 307 y Fr(procedure)20
b(Epatlabel_to_Epc)o(\(x\))230 357 y(if)i(type\(x\))e(==)h("Epatlabel")
f(then)274 407 y(return)h(binop\(the_globa)o(l_pc,)d("+",)j
(x.l.offset\))187 457 y(end)145 509 y Fp(De\014nes:)187
548 y Fl(Epatlabel_)o(to_)o(Ep)o(c)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)
f(190,)h(192,)f(270a,)g(and)h(314a.)145 588 y(Uses)h
Fl(binop)e Fp(113a,)g Fl(Epatlabel)f Fp(81,)h(and)h Fl(the_global_)o
(pc)d Fp(19d.)-17 679 y(193b)88 b Fo(h)p Fn(make)16 b
Fr(condition_failur)o(e_ms)o(g)c Fn(c)n(omplain)j(of)g(unde)n(cide)n(d)
h(br)n(anch)f(or)g(unsatis\014e)n(d)g(c)n(onditions)h
Fp(193b)p Fo(i)n(\021)83 b Fp(\(190)7 b(192\))187 729
y Fr(condition_failur)o(e_msg)18 b(:=)230 779 y(if)k(*p.disjuncts)d(>)j
(1)f(then)g("Can't)g(decide)f(on)i(branch")230 828 y(else)f
("Conditions)f(not)h(satisfied")145 880 y Fp(Uses)12
b Fl(branch)e Fp(159.)-13 972 y(193c)88 b Fo(h)p Fn(err)n(or)14
b(if)g Fr(p)h Fn(has)g(no)h(disjuncts)f Fp(193c)p Fo(i)n(\021)709
b Fp(\(183b\))187 1021 y Fr(if)21 b(*p.disjuncts)e(=)j(0)g(then)230
1071 y(error\("Output)d(pattern)i(for)g(constructor)f(",)h(cons.name,)f
(")h(can)g(never)g(match)g(anything.\\n",)361 1121 y("\\tCould)f(you)h
(have)g(written)g(a)g(bad)h(conjunction?"\))145 1173
y Fp(Uses)12 b Fl(constructo)o(r)d Fp(159)i(and)f Fl(pattern)f
Fp(55.)-17 1264 y(193d)88 b Fo(h)p Fn(p)n(ossibly)15
b(warn)g(ab)n(out)g(b)n(ad)g(enc)n(o)n(ding)h(for)e Fr(cons)g
Fp(193d)p Fo(i)o(\021)371 b Fp(\(190)11 b(192\))187 1314
y Fr({)21 b(/warned_no_disjunct)o(s)e(:=)i(table\(\))230
1364 y(if)h(/warned_no_disju)o(ncts[)o(cons])c(:=)k(1)f(then)274
1414 y(warning\("construc)o(tor)e(",)i(cons.name,)448
1464 y(")h(has)f(an)g(encoding)g(with)g(no)g(matches)f(--)i(maybe)e(a)i
(bad)f(address)g(mode?"\))187 1513 y(})145 1565 y Fp(Uses)12
b Fl(address)d Fp(383a,)h Fl(constructor)e Fp(159,)j(and)f
Fl(warned_no_d)o(isj)o(unc)o(ts)e Fp(193e.)-13 1657 y(193e)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1042
b Fm(/)5 b Fp(193a)22 b(193f)5 b Fm(.)187 1706 y Fr(global)20
b(warned_no_disjuncts)145 1758 y Fp(De\014nes:)187 1798
y Fl(warned_no_)o(dis)o(ju)o(nct)o(s)p Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(193d.)-8 1889 y(193f)88 b Fo(h)p Fn(*)15 b Fp(159)p
Fo(i)p Fv(+)p Fo(\021)1037 b Fm(/)5 b Fp(193e)22 b(194a)5
b Fm(.)187 1939 y Fr(record)20 b(Sclosure\(disjunct,)e(conditions,)i
(creation\))145 1991 y Fp(De\014nes:)187 2030 y Fl(Sclosure)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(118b,)g(190,)h(192,)f(204b,)g
(214c,)g(332c,)h(and)f(344c.)145 2070 y(Uses)i Fl(disjunct)d
Fp(55.)-15 2161 y(193g)88 b Fo(h)p Fn(ar)n(gument)15
b(descriptions)g Fp(193g)p Fo(i)o(\021)187 2211 y Fr(expargs)20
b(disjunct)g(conditions)g(creation.)145 2263 y Fp(Uses)12
b Fl(disjunct)d Fp(55.)p eop
%%Page: 194 194
194 193 bop 129 141 a Fv(194)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Sanitize)h
Fr(d)p Fv('s)f(sequen)o(ts,)i(p)q(ossibly)f(adding)f(conditions)g(to)h
Fr(fits)p Fv(.)-31 320 y Fp(194a)88 b Fo(h)p Fn(*)16
b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1040 b Fm(/)5 b Fp(193f)23
b(194b)t Fm(.)171 370 y Fr(procedure)d(sanitize_sequents)o(\(d,)f
(fits\))215 420 y(l)i(:=)h([])215 469 y(every)e(put\(l,)h
(sanitize_for_outp)o(ut\(!d)o(.seq)o(uents)o(,)e(fits\)\))215
519 y(d.sequents)g(:=)j(l)171 569 y(end)129 621 y Fp(De\014nes:)171
660 y Fl(sanitize_s)o(equ)o(ent)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unks)f(190,)g(192,)h(199b,)f(and)h(314a.)129 700 y(Uses)h
Fl(sanitize_fo)o(r_o)o(ut)o(put)c Fp(70a.)192 762 y Fr
(sequent_to_stoke)o(n)e Fv(can't)k(kno)o(w)e(the)i(o\013sets,)h(so)f
Fr(disjunct_to_emi)o(ssion)c Fv(k)o(eeps)129 812 y(trac)o(k)15
b(of)e(them.)k(Y)m(ou)c(can)i(optionally)c(pass)k(the)f(initial)e
(o\013set.)-33 874 y Fp(194b)88 b Fo(h)p Fn(*)16 b Fp(159)p
Fo(i)o Fv(+)p Fo(\021)1053 b Fm(/)5 b Fp(194a)22 b(195)5
b Fm(.)171 924 y Fr(procedure)20 b(disjunct_to_emiss)o(ion\(d)o(,)f
(n\))215 974 y(s)i(:=)h(Semit\([]\))215 1024 y(/n)f(:=)g(0)215
1073 y(every)f(seq)h(:=)h(!d.sequents)d(&)j(type\(seq\))e(==)h
("sequent")f(do)i({)258 1123 y(put\(s.x,)e(sequent_to_Stoken\(s)o(eq,)f
(n\)\))258 1173 y(n)j(+:=)f(s.x[-1].n)215 1223 y(})215
1273 y(return)f(s)171 1322 y(end)129 1374 y Fp(De\014nes:)171
1414 y Fl(disjunct_t)o(o_e)o(mis)o(sio)o(n)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unks)f(190,)g(192,)h(205b,)f(209a,)g(215,)h(and)f(216.)129
1453 y(Uses)i Fl(Semit)e Fp(81,)h Fl(sequent)e Fp(55,)i(and)g
Fl(sequent_t)o(o_S)o(tok)o(en)d Fp(195.)p eop
%%Page: 195 195
195 194 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(195)2 258 y Fp(195)89 b
Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(194b)22 b(196a)5 b Fm(.)187 307 y Fr(procedure)20
b(sequent_to_Stoke)o(n\(s,)e(offset\))230 357 y(v)k(:=)f(&null)230
407 y(o)h(:=)f(start_overlap_check)o(\(\))230 457 y(every)g(c)h(:=)f
(!s.constraints)e(&)j(x)f(:=)h(case)f(type\(c\))f(of)h({)274
507 y("constraint":)361 557 y(if)h(c.lo)e(+)i(1)g(=)f(c.hi)g(then)g({)
448 606 y(add_overlap_field\(o)o(,)e(c.field\))448 656
y(if)j(0)f(<=)h(c.lo)f(<)g(2^fwidth\(c.field\))d(then)514
706 y(c.lo)448 756 y(else)j({)514 806 y(warning\("Field)e(value)h(",)i
(c.lo,)e(")i(exceeds)e(width)h(of)h(field)e(",)i(c.field.name\);)514
855 y(Eslice\(c.lo,)d(0,)i(fwidth\(c.field\)\))448 905
y(})361 955 y(})h(else)f(if)g(c.lo)g(<)h(c.hi)f(then)g({)492
1005 y(warning\("Field)e(",)i(c.field.name,)e(")j(is)f
(underconstrained)e(by)i(",)644 1055 y(constraintimage\(c\),)d(";)k(no)
f(value)g(output"\))492 1104 y(&fail)361 1154 y(})274
1204 y("fieldbinding":)e({)339 1254 y(add_overlap_field\(o)o(,)g
(c.field\))339 1304 y(if)j(member\(guarantee)o(d_fie)o(lds,)c
(c.field\))i(#)i(|)g(not)f(member\(unchecked_)o(fiel)o(ds,)e(c.field\))
339 1354 y(then)383 1403 y(c.code)339 1453 y(else)383
1503 y(Eslice\(c.code,)g(0,)i(fwidth\(c.field\)\))274
1553 y(})230 1603 y(})h(&)g(y)f(:=)h(emitshift\(x,)d(c.field.lo\))g(do)
274 1652 y(v)j(:=)f(Eorb\(\\v,)f(y\))h(|)h(y)230 1702
y(return)f(Stoken\(\\v)f(|)h(0,)296 1752 y(if)g(s.class.size)e(\045)j
(emit_unit_bits)d(=)j(0)f(then)g(s.class.size)e(/)j(emit_unit_bits)296
1802 y(else)f(error\("tokens)e(are)i(emitted)f(in)i(units)e(of)i(",)f
(token_unit_bits,)535 1852 y(",)h(but)f(some)g(pattern)f(is)i(",)f
(s.class.size,)e(")j(bits)f(wide"\),)296 1901 y(offset\))187
1951 y(end)145 2003 y Fp(De\014nes:)187 2043 y Fl(sequent_to)o(_St)o
(ok)o(en)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(194b.)145
2082 y(Uses)17 b Fl(add_overl)o(ap_)o(fie)o(ld)c Fp(196a,)h
Fl(constraint)f Fp(55,)i Fl(constraintim)o(ag)o(e)e Fp(371a)i(371a,)187
2121 y Fl(constraint)o(s)9 b Fp(136a,)i Fl(emitshift)e
Fp(196c,)i Fl(emit_unit_)o(bit)o(s)e Fp(18a,)j Fl(Eorb)f
Fp(81,)g Fl(Eslice)f Fp(81,)i Fl(fail)f Fp(410,)187 2161
y Fl(field)i Fp(55,)g Fl(fieldbindin)o(g)e Fp(55,)j Fl(fwidth)e
Fp(115d,)h Fl(guaranteed_)o(fi)o(eld)o(s)f Fp(354f,)h
Fl(pattern)f Fp(55,)187 2200 y Fl(start_over)o(lap)o(_c)o(hec)o(k)d
Fp(196a,)h Fl(Stoken)g Fp(81,)g Fl(unchecked_f)o(iel)o(ds)e
Fp(354f,)j(and)f Fl(value)g Fp(136a.)p eop
%%Page: 196 196
196 195 bop 129 141 a Fv(196)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(196a)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1054
b Fm(/)6 b Fp(195)22 b(196c)5 b Fm(.)171 307 y Fr(record)21
b(overlap_check\(f)o(ields)o(,)e(loset,)i(hiset\))171
357 y(procedure)f(start_overlap_che)o(ck\(\))215 407
y(return)g(overlap_check\(set\()o(\),)f(set\(\),)h(set\(\)\))171
457 y(end)171 557 y(procedure)g(add_overlap_field)o(\(o,)f(f\))215
606 y(if)i(overlaps\(o.loset,)d(o.hiset,)i(f.lo,)h(f.hi\))g(then)g({)
258 656 y Fo(h)p Fn(issue)15 b(err)n(or)f(message)h(ab)n(out)g
(overlapping)g(\014elds)h Fp(196b)p Fo(i)215 706 y Fr(})21
b(else)g({)258 756 y(insert\(o.fields,)e(f\))258 806
y(addinterval\(o.lose)o(t,)g(o.hiset,)h(f.lo,)h(f.hi\))215
855 y(})215 905 y(return)f(o)171 955 y(end)129 1007 y
Fp(De\014nes:)171 1046 y Fl(add_overla)o(p_f)o(iel)o(d)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(195.)171 1086 y Fl(start_over)o(lap)
o(_ch)o(eck)o Fp(,)f(used)h(in)h(c)o(h)o(unk)f(195.)129
1125 y(Uses)i Fl(addinterval)c Fp(288a)i(and)h Fl(overlaps)e
Fp(288b.)-33 1217 y(196b)88 b Fo(h)p Fn(issue)15 b(err)n(or)f(message)h
(ab)n(out)h(overlapping)f(\014elds)g Fp(196b)p Fo(i)o(\021)390
b Fp(\(196a\))171 1266 y Fr(every)21 b(g)g(:=)h(!o.fields)e(do)215
1316 y(if)h(f.hi)g(<=)g(g.lo)g(|)h(g.hi)f(<=)g(f.lo)g(then)258
1366 y(&null)215 1416 y(else)258 1466 y(error\("Cannot)e(use)i
(overlapping)f(fields)g(",)i(f.name,)e(")i(and)f(",)g(g.name,)g(")g(in)
h(the)f(same)g(token"\))171 1515 y(impossible\("some)d(fields)j
(overlap,)f(but)h(I)h(can't)f(tell)g(which)f(ones"\))129
1567 y Fp(Uses)12 b Fl(token)e Fp(359a.)-29 1659 y(196c)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(196a)22 b(197a)5 b Fm(.)171 1708 y Fr(procedure)20
b(emitshift\(x,)f(n\))215 1758 y(return)h(if)h(n)h(=)g(0)f(then)g(x)367
1808 y(else)g(if)g(\\simplify_emits)e(then)i(Eshift\(x,)f(n\))367
1858 y(else)h(Eshift\(Enosimp\(sup)o(er_si)o(mpli)o(fy\(x\))o(\),)e
(n\))171 1908 y(end)129 1960 y Fp(De\014nes:)171 1999
y Fl(emitshift)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(195.)129
2038 y(Uses)i Fl(Enosimp)d Fp(81,)i Fl(Eshift)f Fp(81,)h
Fl(simplify_e)o(mi)o(ts)d Fp(18a,)j(and)g Fl(super_sim)o(pli)o(fy)d
Fp(92c.)p eop
%%Page: 197 197
197 196 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(197)208 258 y(Delete)14
b Fr(p)p Fv('s)g(disjuncts)g(with)g(duplicate)g(conditions,)f(issuing)g
(suitable)h(w)o(arnings.)-15 320 y Fp(197a)88 b Fo(h)p
Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1039 b Fm(/)5
b Fp(196c)22 b(197c)5 b Fm(.)187 370 y Fr(procedure)20
b(remove_duplicate)o(_cond)o(ition)o(s\(p,)e(cons\))230
420 y(local)j(l)230 469 y(l)h(:=)f([])230 519 y(every)g(i)h(:=)f
(*p.disjuncts)e(to)j(1)f(by)h(-1)f(do)274 569 y(if)g(j)h(:=)f(1)h(to)f
(i-1)g(&)339 619 y(same_conditions\(p.d)o(isjun)o(cts[i)o(].con)o(diti)
o(ons,)d(p.disjuncts[j].condi)o(tion)o(s\))h(then)318
669 y Fo(h)p Fn(warn)14 b(of)h(r)n(e)n(dundant)h(disjunct)f
Fp(197b)p Fo(i)274 718 y Fr(else)318 768 y(push\(l,)20
b(p.disjuncts[i]\))230 818 y(if)i(*l)f(<)h(*p.disjuncts)d(then)i
(p.disjuncts)f(:=)h(l)230 868 y(return)187 918 y(end)145
970 y Fp(De\014nes:)187 1009 y Fl(remove_dup)o(lic)o(at)o(e_c)o(ond)o
(iti)o(ons)o Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(190,)h(192,)f(and)h
(313.)145 1048 y(Uses)h Fl(same_condi)o(tio)o(ns)c Fp(197c.)-17
1131 y(197b)88 b Fo(h)p Fn(warn)15 b(of)g(r)n(e)n(dundant)g(disjunct)g
Fp(197b)p Fo(i)o(\021)693 b Fp(\(197a\))187 1181 y Fr
(warning\("Pattern)18 b(on)k(right-hand)d(side)i(of)h(constructor)d(",)
j(cons.name,)361 1231 y(")g(has)f(redundant)f(disjuncts)g(",)h
(expimage\(p.disjunc)o(ts[j])o(\),)e(")i(and)h(",)361
1281 y(expimage\(p.disjunc)o(ts[i])o(\),)d(".\\tI'll)h(use)h(the)g
(first)g(one)g(for)g(encoding"\))145 1333 y Fp(Uses)12
b Fl(constructo)o(r)d Fp(159)i(and)f Fl(expimage)f Fp(101a.)-13
1424 y(197c)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(197a)22 b(198a)5 b Fm(.)187
1474 y Fr(procedure)20 b(same_conditions\()o(c1,)f(c2\))230
1524 y(if)j(/c1)f(&)h(/c2)f(then)g(return)230 1574 y(else)g(if)h(/c1)f
(|)g(/c2)h(then)f(fail)230 1623 y(else)g(if)h(*c1)f(=)g(*c2)h(then)f({)
274 1673 y(c)h(:=)f(copy\(c1\))274 1723 y(every)g(insert_condition)o
(\(c,)e(!c2\))274 1773 y(if)i(*c)h(>)f(*c1)g(then)g(fail)274
1823 y(else)g(return)230 1872 y(})h(else)f(fail)187 1922
y(end)145 1974 y Fp(De\014nes:)187 2014 y Fl(same_condi)o(tio)o(ns)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(197a.)145 2053 y(Uses)i
Fl(fail)e Fp(410)h(and)g Fl(insert_co)o(ndi)o(tio)o(n)e
Fp(126c.)p eop
%%Page: 198 198
198 197 bop 129 141 a Fv(198)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(198a)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(197c)23 b(198b)t Fm(.)171 307 y Fr(procedure)d
(widthfailure\(c\))215 357 y(c.n)h(<)g(wordsize)f(|)i
(impossible\("test)d(to)i(fit)g(in)g(word:)g(",)h(expimage\(c\)\))215
407 y(case)f(type\(c\))f(of)h({)258 457 y("Efitsu")f(:)i({f)f(:=)h
("0x\045x";)e(s)i(:=)f("unsigned"})258 507 y("Efitss")f(:)i({f)f(:=)h
("\045d";)64 b(s)22 b(:=)f("signed"})258 557 y(default)42
b(:)22 b(impossible\("width)c(condition"\))215 606 y(})215
656 y(return)i(Sfail\("`")g(||)h(expimage\(c.x\))f(||)h("')g(=)h(")f
(||)h(f)f(||)h(")f(won't)g(fit)g(in)h(")f(||)498 706
y(c.n)g(||)g(")h(")g(||)f(s)h(||)f(")h(bits.",)e(c.x\))171
756 y(end)129 808 y Fp(De\014nes:)171 847 y Fl(widthfailu)o(re)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(186b,)g(190,)g(192,)h(and)f(200b.)
129 887 y(Uses)i Fl(Efitss)e Fp(81,)h Fl(Efitsu)e Fp(81,)i
Fl(expimage)e Fp(101a,)h Fl(Sfail)g Fp(188c,)g(and)h
Fl(wordsize)e Fp(38c.)129 1023 y Ft(8.4.2)56 b(Conditions)-33
1100 y Fp(198b)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o
Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(198a)22 b(199a)5 b
Fm(.)171 1150 y Fr(procedure)20 b(known_conditions\()o(e\))215
1200 y(local)g(known)215 1250 y(known)g(:=)i(set\(\))215
1299 y(every)e(ff)i(:=)f(subterms_matching\()o(e,)e("Eforce"\))h(&)345
1349 y(cc)i(:=)f(super_simplify\(Efo)o(rceab)o(le\(f)o(f.x\)\))d(do)258
1399 y(insert_condition\(k)o(nown,)g(cc\))215 1449 y(if)j
(subterms_matching)o(\(e,)e("Epc"\))h(then)258 1499 y
(insert_condition\(k)o(nown,)e(Epc_known\(\)\))215 1548
y(delete\(known,)h(1\))215 1598 y(return)h(if)h(*known)g(=)h(0)f(then)g
(1)h(else)f(known)171 1648 y(end)129 1700 y Fp(De\014nes:)171
1739 y Fl(known_cond)o(iti)o(ons)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d
(190)i(and)g(192.)129 1779 y(Uses)16 b Fl(Eforce)d Fp(81,)h
Fl(Eforceable)e Fp(81,)i Fl(Epc)g Fp(81,)g Fl(Epc_known)e
Fp(81,)i Fl(insert_condi)o(ti)o(on)e Fp(126c,)171 1818
y Fl(subterms_m)o(atc)o(hin)o(g)d Fp(84a,)h(and)h Fl(super_simp)o(li)o
(fy)d Fp(92c.)-29 1910 y(198c)88 b Fo(h)p Fn(strip)15
b Fr(fknown)e Fn(of)i(c)n(onditions)g(alr)n(e)n(ady)g(in)g
Fr(cknown)f Fp(198c)p Fo(i)n(\021)327 b Fp(\(190)10 b(192\))171
1959 y Fr(if)21 b(type\(cknown\))f(==)h("set")g(then)215
2009 y(every)f(ff)i(:=)f(!fknown)f(do)258 2059 y(if)i(exps_eq\(ff,)d
(!cknown\))h(then)302 2109 y(delete\(fknown,)f(ff\))171
2159 y(if)i(*fknown)g(=)g(0)h(then)f(fknown)f(:=)i(1)129
2211 y Fp(Uses)12 b Fl(exps_eq)d Fp(84c.)p eop
%%Page: 199 199
199 198 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(199)208 258 y(A)o(t)10 b(this)h(p)q(oin)o
(t,)g(w)o(e)g(kno)o(w)f(that)h(\014eld)g(and)g(extended)h(inputs)f
(satisfy)g(the)g(appropriate)145 307 y(width)j(conditions.)-15
370 y Fp(199a)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1031 b Fm(/)5 b Fp(198b)22 b(199b)5 b Fm(.)187
420 y Fr(procedure)20 b(fits_conditions_)o(of\(d,)e(cons\))230
469 y(local)j(fits,)g(ff)230 519 y(fits)g(:=)h(set\(\))230
569 y(every)f(ff)h(:=)f(subterms_matching)o(\(d.se)o(quent)o(s,)e
("fieldbinding"\))f(&)361 619 y(not)j(member\(unchecked_fi)o(elds,)d
(ff.field\))i(do)274 669 y(if)h(not)h(known_to_fit\(in)o(put_f)o(itsu,)
c(ff.code,)i(cons,)h(fwidth\(ff.field\)\))d(then)318
718 y(insert_width_co)o(nditi)o(on\(fi)o(ts,)h(Efitsu\(ff.code,)f
(fwidth\(ff.field\)\)\))230 768 y(return)j(fits)g(++)g
(narrows_ok_conditio)o(ns\(d.)o(sequ)o(ents,)d(cons\))187
818 y(end)145 870 y Fp(De\014nes:)187 909 y Fl(fits_condi)o(tio)o(ns)o
(_of)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(190,)i(192,)f(and)h(199b.)
145 949 y(Uses)16 b Fl(Efitsu)d Fp(81,)i Fl(field)f Fp(55,)h
Fl(fieldbindi)o(ng)d Fp(55,)j Fl(fwidth)f Fp(115d,)g
Fl(input_fit)o(su)e Fp(201b,)187 988 y Fl(insert_wid)o(th_)o(co)o(ndi)o
(tio)o(n)f Fp(200b,)h Fl(known_to_f)o(it)f Fp(201a,)h
Fl(narrows_ok)o(_co)o(nd)o(iti)o(ons)e Fp(200a,)187 1028
y Fl(subterms_m)o(atc)o(hi)o(ng)e Fp(84a,)j(and)g Fl(unchecked)o(_fi)o
(eld)o(s)e Fp(354f.)-17 1111 y(199b)88 b Fo(h)p Fn(*)15
b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(199a)22
b(200a)5 b Fm(.)187 1161 y Fr(procedure)20 b(add_fits_conditi)o(ons_a)o
(nd_sa)o(nitiz)o(e\(d,)e(cons\))230 1210 y(local)j(fits)230
1260 y(fits)g(:=)h(fits_conditions_)o(of\(d,)c(cons\))230
1310 y(if)k(*fits)f(>)g(0)h(then)f({)274 1360 y(/d.conditions)e(:=)i
(set\(\))274 1410 y(every)g(insert_condition)o(\(d.co)o(nditi)o(ons,)d
(!fits\))230 1459 y(})230 1509 y(sanitize_sequents\(d)o(,)h(fits\))230
1559 y(return)i(d)187 1609 y(end)145 1661 y Fp(De\014nes:)187
1700 y Fl(add_fits_c)o(ond)o(it)o(ion)o(s_a)o(nd_)o(san)o(it)o(ize)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(190.)145 1740 y(Uses)i
Fl(fits_condi)o(tio)o(ns_)o(of)c Fp(199a,)i Fl(insert_condi)o(ti)o(on)e
Fp(126c,)j(and)f Fl(sanitize_se)o(que)o(nts)e Fp(194a.)p
eop
%%Page: 200 200
200 199 bop 129 141 a Fv(200)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(W)m(e)e(lost)h
(earlier)f(b)q(ecause)j(the)e(solv)o(er)g(con)o(v)o(erted)h(the)f
(condition:)k Fr(v)22 b(=)g(v[0:15]!)10 b Fv(to)233 341
y(Enarro)o(ws\(v,)k(16\))g(=)g(v[0:15].)129 424 y(Without)i(a)h(c)o
(hec)o(k)g(for)f(the)h(success)j(of)15 b(the)j(narro)o(w,)e(this)h
(condition)f(b)q(ecomes)h(a)f(tau-)129 474 y(tology)m(,)g(with)g(the)h
(result)g(that)g(w)o(e)g(w)o(ere)g(alw)o(a)o(ys)f(taking)g(an)g
(incorrect)i(branc)o(h)f(of)f(the)129 523 y(SP)m(AR)o(C)11
b Fr(set)g Fv(constructor.)19 b(By)12 b(seeking)f(out)h(narro)o(ws)f
(in)g(conditions,)h(w)o(e)f(mak)o(e)f(sure)j(to)129 573
y(include)e(the)f(correct)i(c)o(hec)o(k)f(\(although)f(w)o(e)g(con)o
(tin)o(ue)g(to)g(emit)f(C)h(co)q(de)h(for)f(the)h(tautology)m(,)129
623 y(whic)o(h)j(is)g(anno)o(ying\).)-31 685 y Fp(200a)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(199b)23 b(200b)t Fm(.)171 735 y Fr(procedure)d
(narrows_ok_condit)o(ions\()o(e,)f(cons\))215 785 y(local)h(ok)215
835 y(ok)h(:=)g(set\(\))215 884 y(every)f(ee)i(:=)f
(subterms_matching\()o(e,)e("Enarrowu"\))g(do)258 934
y(if)j(not)f(known_to_fit\(inp)o(ut_fi)o(tsu,)d(ee.x,)j(cons,)g(ee.n\))
g(then)302 984 y(insert_width_con)o(ditio)o(n\(ok,)d(Efitsu\(ee.x,)h
(ee.n\)\))215 1034 y(every)h(ee)i(:=)f(subterms_matching\()o(e,)e
("Enarrows"\))g(do)258 1084 y(if)j(not)f(known_to_fit\(inp)o(ut_fi)o
(tss,)d(ee.x,)j(cons,)g(ee.n\))g(then)302 1134 y(insert_width_con)o
(ditio)o(n\(ok,)d(Efitss\(ee.x,)h(ee.n\)\))215 1183 y(return)h(ok)171
1233 y(end)171 1333 y(procedure)g(conditions_with_n)o(arrow)o(s_che)o
(ck\(c)o(onds,)e(cons\))215 1383 y(if)j(*\\conds)f(>)i(0)f(then)g({)258
1432 y(c)h(:=)f(narrows_ok_conditi)o(ons\(c)o(onds,)d(cons\))258
1482 y(return)j(if)g(*c)g(>)h(0)g(then)f(c)g(++)h(conds)e(else)h(conds)
215 1532 y(})g(else)258 1582 y(return)g(1)171 1632 y(end)129
1684 y Fp(De\014nes:)171 1723 y Fl(conditions)o(_wi)o(th_)o(nar)o(ro)o
(ws_)o(che)o(ck)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(190)g(and)h(192.)
171 1762 y Fl(narrows_ok)o(_co)o(ndi)o(tio)o(ns)o Fp(,)e(used)i(in)g(c)
o(h)o(unk)f(199a.)129 1802 y(Uses)i Fl(Efitss)d Fp(81,)h
Fl(Efitsu)f Fp(81,)i Fl(Enarrows)d Fp(81,)i Fl(Enarrowu)f
Fp(81,)h Fl(input_fits)o(s)e Fp(201b,)i Fl(input_fits)o(u)e
Fp(201b,)171 1841 y Fl(insert_wid)o(th_)o(con)o(dit)o(io)o(n)h
Fp(200b,)h Fl(known_to_f)o(it)e Fp(201a,)j(and)f Fl(subterms_ma)o(tch)o
(in)o(g)f Fp(84a.)-33 1924 y(200b)88 b Fo(h)p Fn(*)16
b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(200a)22
b(201a)5 b Fm(.)171 1974 y Fr(procedure)20 b(insert_width_cond)o(ition)
o(\(fits)o(,)f(c\))215 2024 y(if)i(\(x)g(:=)h(super_simplify\(c)o(\)\))
d(===)i(0)h(then)258 2074 y(error\(widthfailure)o(\(c\).f)o(mt\))215
2124 y(else)258 2173 y(insert_condition\(f)o(its,)c(x\))215
2223 y(return)171 2273 y(end)129 2325 y Fp(De\014nes:)171
2364 y Fl(insert_wid)o(th_)o(con)o(dit)o(io)o(n)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(199a)h(and)f(200a.)129 2404
y(Uses)i Fl(insert_cond)o(iti)o(on)c Fp(126c,)i Fl(super_simpl)o(ify)e
Fp(92c,)j(and)f Fl(widthfailur)o(e)f Fp(198a.)p eop
%%Page: 201 201
201 200 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(201)208 258 y(Either)15
b(inputs)g(or)g(instances)h(can)f(b)q(e)h(kno)o(wn)e(to)h(\014t.)21
b(The)15 b(test)h(on)f(strings)g(is)g(v)n(alid)145 307
y Fn(only)g(when)g(al)r(l)f(fr)n(e)n(e)f(variables)h(r)n(epr)n(esent)g
(inputs)h(of)f(c)n(onstructor)h Fr(cons)p Fv(.)i(In)c(particular,)145
357 y(it)g(is)g(v)n(alid)e(when)j(patterns)g(are)f(prepared)h(for)f
(emission.)j(The)e(test)g(on)e(instance)i(inputs)145
407 y(is,)g(of)f(course,)i(alw)o(a)o(ys)d(v)n(alid.)17
b Fr(test)c Fv(is)h Fr(input_fitsu)d Fv(or)j Fr(input_fitss)p
Fv(.)-15 469 y Fp(201a)88 b Fo(h)p Fn(*)15 b Fp(159)p
Fo(i)p Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(200b)22 b(201b)5
b Fm(.)187 519 y Fr(procedure)20 b(known_to_fit\(tes)o(t,)f(code,)i
(cons,)f(width\))230 569 y(return)h(case)g(type\(code\))f(of)h({)274
619 y("string")216 b(:)22 b(test\(code,)e(cons,)g(width\))274
669 y("Einstance_input")e(:)k(known_to_fit\(test)o(,)d(code.name,)h
(code.cons,)f(width\))230 718 y(})187 768 y(end)145 820
y Fp(De\014nes:)187 860 y Fl(known_to_f)o(it)p Fp(,)8
b(used)j(in)g(c)o(h)o(unks)f(99b,)g(199a,)g(200a,)g(and)h(210a.)145
899 y(Uses)h Fl(Einstance_)o(inp)o(ut)c Fp(81.)-17 982
y(201b)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(201a)22 b(202b)5 b Fm(.)187 1032 y Fr(procedure)20
b(input_fitsu\(name)o(,)f(cons,)i(width\))230 1082 y(return)g(width)g
(>=)g(wordsize)f(|)274 1131 y(\(\(ipt)h(:=)g(inputs_of\(cons\)\).n)o
(ame)e(==)i(name)g(&)g(case)g(type\(ipt.meaning\))e(of)i({)318
1181 y("field")63 b(:)22 b(fwidth\(ipt.meaning)o(\))d(<=)i(width)318
1231 y("integer")e(:)j(ipt.meaning)e(<=)h(width)274 1281
y(}\))187 1331 y(end)187 1430 y(procedure)f(input_fitss\(name)o(,)f
(cons,)i(width\))230 1480 y(return)g(width)g(>=)g(wordsize)f(|)274
1530 y(\(\(ipt)h(:=)g(inputs_of\(cons\)\).n)o(ame)e(==)i(name)g(&)g
(case)g(type\(ipt.meaning\))e(of)i({)318 1580 y("integer")e(:)j
(ipt.meaning)e(<=)h(width)318 1630 y("field")63 b(:)22
b(fwidth\(ipt.meaning)o(\))d(<)j(width)274 1679 y(}\))187
1729 y(end)145 1781 y Fp(De\014nes:)187 1821 y Fl(input_fits)o(s)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(99b)h(and)f(200a.)187
1860 y Fl(input_fits)o(u)p Fp(,)e(used)j(in)g(c)o(h)o(unks)f(99b,)g
(199a,)h(and)f(200a.)145 1899 y(Uses)i Fl(field)e Fp(55,)h
Fl(fwidth)e Fp(115d,)i Fl(inputs_of)d Fp(166a,)i(and)h
Fl(wordsize)e Fp(38c.)p eop
%%Page: 202 202
202 201 bop 129 141 a Fv(202)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 261 y Fj(8.5)67
b(Supp)r(ort)24 b(for)e(enco)r(ding)h(pro)r(cedures)f(\(in)i(C\))129
360 y Ft(8.5.1)56 b(C)19 b(t)n(yp)r(e)f(declarations)f(for)i(instances)
129 437 y Fv(A)f(user-de\014ned)i(constructor)g(t)o(yp)q(e)f(is)e
(represen)o(ted)k(b)o(y)d Fi(T)6 b Fr(Instance)p Fv(,)17
b(a)g(C)h(t)o(yp)q(e)g(that)129 487 y(stores)g(an)e(instance)g(of)g(a)g
(constructor)h(t)o(yp)q(e)g Fi(T)6 b Fv(.)25 b(It)16
b(con)o(tains)g(a)g(union)f(of)g(all)g(p)q(ossible)129
536 y(constructors)h(of)c(t)o(yp)q(e)i Fi(T)6 b Fv(;)13
b(for)g(eac)o(h)h(one)g(it)e(stores)j(the)f(instance.)19
b(The)13 b(header)i Fr(h)e Fv(p)q(oin)o(ts)129 586 y(to)k(a)f
(statically)f(allo)q(cated)h(record)i(that)e(con)o(tains,)h(among)d
(other)j(information,)d(a)i(tag)129 636 y(that)e(iden)o(ti\014es)h(not)
f(just)g(the)g(constructor,)h(but)f(its)g(branc)o(h.)19
b(Here's)c(the)f(template:)-31 698 y Fp(202a)88 b Fo(h)p
Fn(instanc)n(e-typ)n(e.t)15 b Fp(202a)p Fo(i)o(\021)171
748 y Fr(typedef)20 b(struct)h(\045{name}_instance)d({$t)171
798 y(int)j(tag;)171 848 y(union)g({$t\045constructors)o($b)171
898 y(})h(u;$b)171 947 y(})g(\045{name}_Instanc)o(e;)129
999 y Fp(Uses)12 b Fl(constructor)o(s)d Fp(32a.)129 1062
y Fv(And)15 b(here's)g(the)f(co)q(de)h(the)f(do)q(es)h(the)f(emission.)
-33 1124 y Fp(202b)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o
Fv(+)p Fo(\021)1051 b Fm(/)5 b Fp(201b)22 b(203)5 b Fm(.)171
1174 y Fr(procedure)20 b(emit_instance_typ)o(e\(pp,)e(ct\))215
1223 y(local)i(constructors)215 1273 y(enforce_instanc)o(e\(ct\))215
1323 y(constructors)f(:=)i([])215 1373 y(every)f(put\(constructors,)f
(input_record_fo)o(r\(kep)o(t_con)o(struc)o(tors\()o(ct\)\)\))215
1423 y(emit_template\(p)o(p,)g("instance-type.t")o(,)g("name",)h
(ct.name,)g("constructors",)f(constructors\))215 1473
y(return)171 1522 y(end)129 1574 y Fp(De\014nes:)171
1614 y Fl(emit_insta)o(nce)o(_ty)o(pe)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(230b.)129 1653 y(Uses)18 b Fl(construct)o(ors)c
Fp(32a,)i Fl(enforce_i)o(nst)o(anc)o(e)e Fp(166c,)i Fl(input_rec)o(ord)
o(_fo)o(r)e Fp(203,)171 1693 y(and)d Fl(kept_cons)o(tru)o(cto)o(rs)d
Fp(33d.)p eop
%%Page: 203 203
203 202 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(203)208 258 y(There's)12
b(a)g(tric)o(k)f(to)h(the)g(la)o(y)o(out)f(of)g(an)g(input)h(record;)h
(w)o(e)f(use)g(bit)g(\014elds)g(to)f(hold)g(\014eld)145
307 y(inputs,)i(and)h(w)o(e)f(w)o(an)o(t)g(to)g(mak)o(e)f(them)h
(consecutiv)o(e)h(so)g(they)g(ha)o(v)o(e)f(a)g(decen)o(t)i(c)o(hance)f
(of)145 357 y(pac)o(king.)k(T)m(o)13 b(ac)o(hiev)o(e)h(this)g
(e\013ect,)h(w)o(e)f(run)g(through)g(the)h(inputs)f(t)o(wice.)2
420 y Fp(203)89 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1033 b Fm(/)5 b Fp(202b)22 b(204a)5 b Fm(.)187
469 y Fr(procedure)20 b(input_record_for)o(\(cons)o(,)f(struct_name\))
230 519 y(local)i(pp,)g(ipt)230 569 y(pp)h(:=)f([])230
619 y(put\(pp,)g("$nstruct)f({$t"\);)230 669 y(every)h(ipt)g(:=)h
(inputs_of\(cons\))c(do)153 b(##)21 b(emit)g(bit)g(fields)274
718 y(case)g(type\(ipt.meaning\))d(of)k({)318 768 y("field")63
b(:)22 b(put\(pp,)e("$nunsigned)g(")i(||)f(ipt.name)f(||)h(":")h(||)f
(fwidth\(ipt.meanin)o(g\)||")o(;"\))318 818 y("integer")e(:)j(put\(pp,)
e("$nint)h(")131 b(||)21 b(ipt.name)f(||)h(":")h(||)f(ipt.meaning)172
b(||";"\))274 868 y(})230 918 y(every)21 b(ipt)g(:=)h
(inputs_of\(cons\))c(do)153 b(##)21 b(emit)g(other)g(inputs)274
967 y(case)g(type\(ipt.meaning\))d(of)k({)318 1017 y("null")107
b(:)22 b(put\(pp,)e("$nint)h(")65 b(||)697 b(ipt.name)20
b(||";"\))318 1067 y("string")63 b(:)22 b(put\(pp,)e("$nRAddr)g(")i(||)
697 b(ipt.name)20 b(||";"\))318 1117 y("constype")f(:)j(put\(pp,)e
("$n")h(||)h(ipt.meaning.nam)o(e)d(||)i("_Instance)42
b(")22 b(||)f(ipt.name)f(||";"\))318 1167 y("field")g(|)h("integer")f
(:)i(&fail)318 1217 y(default)e(:)h(impossible\("input)e(meaning"\))274
1266 y(})230 1316 y(if)j(not)f(inputs_of\(cons\))e(then)274
1366 y(put\(pp,)h("\\nchar)h(avoid_empty_stru)o(cture)o(s;"\))230
1416 y(put\(pp,)g("$b$n})f(")i(||)f(\(\\struct_name)e(|)j(cons.name\))e
(||)h(";"\))230 1466 y(return)g(pp)187 1515 y(end)145
1567 y Fp(De\014nes:)187 1607 y Fl(input_reco)o(rd_)o(fo)o(r)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(202b.)145 1646 y(Uses)i
Fl(constype)d Fp(159,)h Fl(fail)h Fp(410,)f Fl(field)g
Fp(55,)h Fl(fwidth)f Fp(115d,)g Fl(input)g Fp(46a,)g(and)h
Fl(inputs_of)d Fp(166a.)p eop
%%Page: 204 204
204 203 bop 129 141 a Fv(204)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(While)g(w)o(e're)h
(pla)o(ying)e(the)i(input)g(game,)e(w)o(e)i(use)g(a)g(similar)d(tec)o
(hnique)j(to)g(compute)129 307 y(a)g(list)f(of)h(argumen)o(t)e
(declarations.)-31 370 y Fp(204a)88 b Fo(h)p Fn(*)16
b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1051 b Fm(/)5 b Fp(203)23
b(204b)t Fm(.)171 420 y Fr(procedure)d(arg_decls\(cons\))215
469 y(l)h(:=)h([])215 519 y(every)e(ipt)h(:=)h(inputs_of\(cons\))d(do)
258 569 y(put\(l,)i(case)g(type\(ipt.meaning)o(\))e(of)i({)432
619 y("null")108 b(:)22 b("int")432 669 y("string")64
b(:)22 b("RAddr")432 718 y("constype")e(:)i(ipt.meaning.name)c(||)k
("_Instance")432 768 y("field")86 b(:)22 b(unsigned_type\(fw)o(idth\()o
(ipt.m)o(eanin)o(g\)\))432 818 y("integer")42 b(:)22
b("int")432 868 y(default)86 b(:)22 b(impossible\("arg_)o(decls)c
(input"\))389 918 y(})j(||)h(")f(")h(||)f(ipt.name\))215
967 y(return)f(if)h(*l)h(=)f(0)h(then)f("void")g(else)g
(commaseparate\(l)o(\))171 1017 y(end)129 1069 y Fp(De\014nes:)171
1109 y Fl(arg_decls)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(213,)g(214a,)
g(and)h(246.)129 1148 y(Uses)j Fl(constype)d Fp(159,)i
Fl(field)f Fp(55,)h Fl(fwidth)f Fp(115d,)g Fl(input)g
Fp(46a,)h Fl(inputs_of)e Fp(166a,)h Fl(RAddr)g Fp(411a,)171
1187 y(and)f Fl(unsigned_)o(typ)o(e)e Fp(335a.)129 1337
y Fj(8.6)67 b(C)22 b(supp)r(ort)h(for)f(closures)129
1428 y Fv(Closures)15 b(are)f(n)o(um)o(b)q(ered)g(within)f(a)h
(particular)f(constructor,)j(except)f(for)e(the)i(\014rst.)-33
1490 y Fp(204b)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o
Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(204a)22 b(205a)5 b
Fm(.)171 1540 y Fr(procedure)20 b(emit_original_clo)o(sure_)o(funct)o
(ions)o(\(pp,)e(cons,)j(b\))215 1590 y(local)f(suffix)215
1640 y(every)g(cl)i(:=)f(subterms_matching\()o(b,)e("Sclosure"\))g(do)
258 1690 y(emit_original_clos)o(ure_f)o(uncti)o(on\(pp)o(,)g(cons,)i
(cons.name)f(||)h Fo(h)p Fn(su\016x)15 b(with)f(up)n(date)i
Fp(204c)p Fo(i)o Fr(,)21 b(cl\))215 1739 y(return)171
1789 y(end)129 1841 y Fp(De\014nes:)171 1881 y Fl(emit_origi)o(nal)o
(_cl)o(osu)o(re)o(_fu)o(nct)o(ion)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(16c.)129 1920 y(Uses)i Fl(emit_origin)o(al_)o(cl)o(osu)o(re_)o
(fun)o(cti)o(on)c Fp(205a,)i Fl(Sclosure)f Fp(193f,)h(and)h
Fl(subterms_ma)o(tc)o(hin)o(g)e Fp(84a.)-29 2003 y(204c)88
b Fo(h)p Fn(su\016x)16 b(with)e(up)n(date)h Fp(204c)p
Fo(i)o(\021)868 b Fp(\(204b\))171 2053 y Fr(\(if)21 b(/suffix)f(then)h
(\(suffix)g(:=)g(1,)h(""\))f(else)g("_")g(||)g(\(suffix)g(+:=)g(1\)\))p
eop
%%Page: 205 205
205 204 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(205)208 258 y(The)14 b(idea)g(with)g(a)f
(closure)i(is)f(to)g(ferret)i(out)e(all)e(the)j(free)g(v)n(ariables)e
(and)h(stu\013)h(them)145 307 y(in)o(to)f(a)h(custom)f(closure.)21
b(The)15 b(tric)o(k)g(is,)f(w)o(e)h(don't)g(w)o(an)o(t)f(to)g(use)i
Fn(instanc)n(e)p Fv(-v)n(alued)e(v)n(ari-)145 357 y(ables;)h(w)o(e)f(w)
o(an)o(t)g(the)h(comp)q(onen)o(ts)f(of)g(the)h(instance.)20
b(Step)15 b(1,)e(then,)i(is)f(to)h(grab)f(all)f(the)145
407 y(instance)19 b(selections,)h(noting)d(the)h(instances)h(that)f(w)o
(e're)h(not)f(in)o(terested)h(in.)30 b(Step)19 b(2)145
457 y(will)c(add)i(all)e(the)i(free)g(v)n(ariables.)25
b(The)17 b(things)g(to)f(sa)o(v)o(e,)h(are)g(the)g(selections)g(and)g
(free)145 507 y(v)n(ariables)c(that)h(aren't)g(selected)i(from.)208
557 y(Ev)o(erything)g(to)h(sa)o(v)o(e)f(is)h(put)g(in)f(the)h(closure.)
27 b(Equiv)n(alen)o(t)15 b(expressions)j(are)f(to)g(b)q(e)145
606 y(sa)o(v)o(ed)f(only)e(once,)i(so)g(w)o(e)f(use)i(a)e(table)g
(mapping)e(things)i(to)h(b)q(e)g(sa)o(v)o(ed)f(to)g(their)h(names)145
656 y(in)e(the)g(closure.)19 b Fr(closurenametab)11 b
Fv(computes)j(that)g(table.)208 706 y(The)g(de\014nition)f(of)h(a)f
(closure)i(t)o(yp)q(e)f(requires)h(the)g(in)o(v)o(erse)g(of)e(that)h
(table.)-15 768 y Fp(205a)88 b Fo(h)p Fn(*)15 b Fp(159)p
Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(204b)22 b(206c)5
b Fm(.)187 818 y Fr(procedure)20 b(emit_original_cl)o(osure)o(_func)o
(tion\()o(pp,)e(cons,)j(name,)g(cl\))230 868 y(local)g(selections,)f
(selected,)g(free,)g(save,)h(upc)230 918 y Fo(h)p Fn(make)16
b Fr(selections)p Fn(,)c Fr(selected)p Fn(,)h Fr(free)h
Fn(hold)h(sele)n(ctions,)g(things)g(sele)n(cte)n(d)f(fr)n(om,)g(and)i
(fr)n(e)n(e)e(variables)g Fp(206e)p Fo(i)230 967 y Fr(nt)22
b(:=)f(closurenametab\(sel)o(ectio)o(ns)e(++)i(free)g(--)g(selected\))
230 1017 y(mt)h(:=)f(meaningtab\(nt,)e(cons\))230 1067
y(emit_original_closu)o(re_ty)o(pedef)o(\(pp,)f(name,)j(cons,)g(mt\))
230 1117 y(emit_original_closu)o(re_re)o(locfn)o(\(pp,)d(name,)j(cons,)
g(mt\))230 1167 y(emit_original_closu)o(re_fu)o(nctio)o(n_def)o(\(pp,)d
(name,)j(cl,)g(nt\))230 1217 y(emit_closure_header)o(_def\()o(pp,)e
(name,)h(name)h(||)h("_app",)e(cl\))230 1266 y Fo(h)p
Fn(make)c Fr(cl.creation)c Fn(to)j(cr)n(e)n(ate)g(closur)n(e)f(and)i
(emit)e(plac)n(eholder)h Fp(205b)p Fo(i)230 1316 y Fr(return)187
1366 y(end)145 1418 y Fp(De\014nes:)187 1457 y Fl(emit_origi)o(nal)o
(_c)o(los)o(ure)o(_fu)o(nct)o(io)o(n)p Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(204b.)145 1497 y(Uses)21 b Fl(closurename)o(tab)c
Fp(207a,)i Fl(emit_closur)o(e_h)o(ead)o(er_)o(de)o(f)f
Fp(206c,)187 1536 y Fl(emit_origi)o(nal)o(_c)o(los)o(ure)o(_fu)o(nct)o
(io)o(n_d)o(ef)10 b Fp(209a,)i Fl(emit_orig)o(ina)o(l_c)o(los)o(ure)o
(_r)o(elo)o(cfn)e Fp(208c,)187 1576 y Fl(emit_origi)o(nal)o(_c)o(los)o
(ure)o(_ty)o(ped)o(ef)e Fp(208a,)i(and)h Fl(meaningtab)d
Fp(210a.)-17 1659 y(205b)88 b Fo(h)p Fn(make)16 b Fr(cl.creation)c
Fn(to)j(cr)n(e)n(ate)f(closur)n(e)h(and)h(emit)e(plac)n(eholder)h
Fp(205b)p Fo(i)o(\021)134 b Fp(\(205a\))187 1708 y Fo(h)p
Fn(make)15 b Fr(l)g Fn(a)g(list)f(of)h(assignments)g(by)g(using)g(the)g
(name)h(table)e Fr(nt)h Fp(206b)p Fo(i)187 1758 y Fr(upc)21
b(:=)g(if)h(subterms_matchin)o(g\(\\cl)o(.cond)o(ition)o(s)d(|)i
(cl.disjunct,)f("Epc",)g("Epc_known"\))g(then)h(1)339
1808 y(else)g(0)187 1858 y(cl.creation)e(:=)j(Sstmts\([)230
1908 y(literal\(template_to)o(_list)o(\("cre)o(ate-c)o(losur)o(e.t")o
(,)884 1958 y("name",)f(name,)f("save",)h(l,)g("clofun",)f(name)h(||)g
("_app"\)\),)230 2007 y(disjunct_to_emissio)o(n\(pla)o(ce_ho)o(lder\()o
(cl.di)o(sjun)o(ct\)\)])o(\))145 2059 y Fp(Uses)14 b
Fl(disjunct)d Fp(55,)i Fl(disjunct_to_)o(em)o(iss)o(ion)d
Fp(194b,)j Fl(Epc)g Fp(81,)g Fl(Epc_known)d Fp(81,)k
Fl(literal)d Fp(45e,)187 2099 y Fl(place_hold)o(er)d
Fp(72a,)j Fl(Sstmts)e Fp(81,)i(and)g Fl(subterms_m)o(atc)o(hi)o(ng)e
Fp(84a.)-13 2190 y(205c)88 b Fo(h)p Fn(cr)n(e)n(ate-closur)n(e.t)14
b Fp(205c)p Fo(i)o(\021)187 2240 y Fr($t{)21 b(\045{name}_Closure)e
(_c;)187 2290 y(_c)i(=)h(\(\045{name}_Closure)o(\))d
(mc_create_closure_)o(here)o(\(size)o(of)g(*_c,)i(&\045{clofun}_closu)o
(re_he)o(ader\))o(;)187 2339 y(\045{save}/*)f(this)h(line)g
(intentionally)e(left)i(blank)f(*/$b)187 2389 y(})145
2441 y Fp(Uses)12 b Fl(line)e Fp(359a)h(and)f Fl(mc_create_c)o(los)o
(ure)o(_h)o(ere)e Fp(408c.)p eop
%%Page: 206 206
206 205 bop 129 141 a Fv(206)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(206a)88
b Fo(h)p Fn(cr)n(e)n(ate-closur)n(e-at.t)14 b Fp(206a)p
Fo(i)o(\021)171 307 y Fr($t{)21 b(\045{name}_Closure)e(_c;)171
357 y(_c)i(=)h(\(\045{name}_Closure\))c(mc_create_closure_)o(at_of)o
(fset\()o(sizeo)o(f)h(*_c,)i(&\045{clofun}_closur)o(e_hea)o(der,)d
(\045offset\);)171 407 y(\045{save}/*)i(this)h(line)g(intentionally)e
(left)i(blank)g(*/$b)171 457 y(})129 509 y Fp(Uses)12
b Fl(line)e Fp(359a)h(and)f Fl(mc_create_c)o(los)o(ure)o(_at)o(_of)o
(fs)o(et)f Fp(408a.)-33 600 y(206b)88 b Fo(h)p Fn(make)16
b Fr(l)e Fn(a)i(list)d(of)i(assignments)h(by)f(using)g(the)g(name)g
(table)g Fr(nt)f Fp(206b)p Fo(i)o(\021)163 b Fp(\(205b\))171
650 y Fr(l)22 b(:=)f([])171 700 y(s)h(:=)f(set\(\))171
750 y(every)g(e)g(:=)h(key\(nt\))e(&)i(not)f(member\(s,)f(nt[e]\))g(do)
i({)215 799 y(insert\(s,)d(nt[e]\))215 849 y(put\(l,)h("_c->v.")g(||)i
(nt[e])e(||)i(")f(=)h(")g(||)f(pretty\(e\))f(||)h(";$n"\))171
899 y(})171 949 y(s)h(:=)f(&null)g(#)g(enable)g(garbage)f(collection)
129 1001 y Fp(Uses)12 b Fl(pretty)e Fp(18a.)192 1071
y Fv(Added)15 b(this)f(to)g(restructure)k(so)c(w)o(e)g(could)h(emit)e
(one)h(header)h(p)q(er)h(closure)f(function)129 1121
y(in)f(the)g(optimized)f(case)i(\(instead)f(of)f(one)h(header)h(p)q(er)
g(enco)q(ding)f(function\).)-1787 b Fk(\031Change)13
b(#34)-29 1183 y Fp(206c)88 b Fo(h)p Fn(*)16 b Fp(159)p
Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(205a)22 b(207a)5
b Fm(.)171 1233 y Fr(procedure)20 b(emit_closure_head)o(er_de)o(f\(pp,)
e(name,)j(clofun,)f(cl\))215 1283 y(local)g(upc)215 1333
y(upc)h(:=)g(if)g(subterms_matching\(\\c)o(l.con)o(diti)o(ons)e(|)i
(cl.disjunct,)f("Epc",)g("Epc_known"\))f(then)i(1)367
1383 y(else)g(0)215 1432 y(emit_template\(p)o(p,)e("closure-header.t)o
(",)g("clofun",)h(clofun,)g("name",)g(name,)h("uses-pc",)f(upc\))215
1482 y(return)171 1532 y(end)129 1584 y Fp(De\014nes:)171
1623 y Fl(emit_closu)o(re_)o(hea)o(der)o(_d)o(ef)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(205a.)129 1663 y(Uses)i Fl(disjunct)d
Fp(55,)i Fl(Epc)g Fp(81,)f Fl(Epc_known)f Fp(81,)i(and)f
Fl(subterms_mat)o(ch)o(ing)e Fp(84a.)-33 1746 y(206d)88
b Fo(h)p Fn(closur)n(e-he)n(ader.t)15 b Fp(206d)p Fo(i)n(\021)171
1796 y Fr(static)21 b(struct)f(closure_header)f(\045{clofun}_closure)o
(_head)o(er)g(=)i($t)171 1845 y({)h(\045{clofun},)d
(\045{name}_relocfn,)g(\045{uses-pc},)g(sizeof)i(\(struct)f
(\045{name}_closure\))f(};$b)-29 1928 y Fp(206e)88 b
Fo(h)p Fn(make)16 b Fr(selections)p Fn(,)c Fr(selected)p
Fn(,)h Fr(free)h Fn(hold)h(sele)n(ctions,)g(things)g(sele)n(cte)n(d)f
(fr)n(om,)g(and)i(fr)n(e)n(e)e(variables)g Fp(206e)p
Fo(i)o(\021)82 b Fp(\(205a\))171 1978 y Fr(every)21 b(selections)e(|)j
(selected)e(|)i(free)f(:=)g(set\(\))171 2028 y(every)g(s)g(:=)h
(subterms_matchin)o(g\(cl.)o(disju)o(nct)c(|)k(\\cl.conditions,)d
("Einstance_input)o("\))g(do)i({)215 2078 y(insert\(selectio)o(ns,)e
(s\))215 2128 y(insert\(selected)o(,)g(s.x\))171 2178
y(})171 2227 y(every)i(insert\(free,)e(free_variables\(cl.)o(disj)o
(unct)f(|)k(\\cl.conditions\)\))129 2279 y Fp(Uses)12
b Fl(disjunct)d Fp(55,)i Fl(Einstance_)o(inp)o(ut)d Fp(81,)j
Fl(free_variab)o(les)d Fp(84b,)i(and)h Fl(subterms_m)o(atc)o(hin)o(g)e
Fp(84a.)p eop
%%Page: 207 207
207 206 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(207)-15 258 y Fp(207a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(206c)22 b(208a)5 b Fm(.)187 307 y Fr(procedure)20
b(closurenametab\(s)o(ave\))230 357 y(local)h(namecounts,)f(saved,)g
(name)230 407 y(every)h(namecounts)f(|)h(t)h(:=)f(table\(\))230
457 y(saved)g(:=)h(set\(\))230 507 y(every)f(e)h(:=)f(!save)g(do)274
557 y(if)g(eprime)g(:=)g(!saved)g(&)g(exps_eq\(e,)f(eprime\))g(then)318
606 y(t[e])h(:=)g(t[eprime])274 656 y(else)g({)318 706
y(insert\(saved,)e(e\))318 756 y Fo(h)p Fn(set)14 b Fr(name)g
Fn(to)h(the)g(pr)n(op)n(er)g(name)g(of)g(the)g(\014eld)g(for)f
Fr(e)h Fp(207b)p Fo(i)318 806 y Fr(t[e])21 b(:=)g(name)274
855 y(})230 905 y(return)g(t)187 955 y(end)145 1007 y
Fp(De\014nes:)187 1046 y Fl(closurenam)o(eta)o(b)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(205a.)145 1086 y(Uses)i Fl(exps_eq)d
Fp(84c.)-17 1177 y(207b)88 b Fo(h)p Fn(set)15 b Fr(name)f
Fn(to)h(the)g(pr)n(op)n(er)f(name)i(of)f(the)g(\014eld)g(for)f
Fr(e)h Fp(207b)p Fo(i)n(\021)361 b Fp(\(207a\))187 1227
y Fr(name)21 b(:=)g(case)g(type\(e\))f(of)i({)230 1277
y("string")f(:)g(e)230 1327 y("Einstance_input")e(:)i(e.name)230
1376 y(default)g(:)g(impossible\("type)e(of)i(saved)g(exp"\))187
1426 y(})187 1476 y(if)g(/namecounts[name])d(then)230
1526 y(namecounts[name])h(:=)i(1)187 1576 y(else)230
1625 y(name)g(||:=)g("__")g(||)h(\(namecounts[name)o(])d(+:=)i(1\))145
1677 y Fp(Uses)12 b Fl(Einstance_)o(inp)o(ut)c Fp(81.)p
eop
%%Page: 208 208
208 207 bop 129 141 a Fv(208)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(T)m(o)h(compute)h
(the)h(closure)g(t)o(yp)q(e,)f(w)o(e)h(pac)o(k)f(the)h(names;)e(big)h
(ones)h(\014rst,)f(then)h(little)129 307 y(ones.)j(First)14
b(w)o(e)g(in)o(v)o(ert)g(the)h(table,)e(so)h(that)g(the)h(names)e(are)h
(the)g(unique)g(k)o(eys)h(in)e Fr(u)p Fv(.)-31 370 y
Fp(208a)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p
Fo(\021)1037 b Fm(/)5 b Fp(207a)22 b(208c)5 b Fm(.)171
420 y Fr(procedure)20 b(emit_original_clo)o(sure_)o(typed)o(ef\(p)o(p,)
f(name,)i(cons,)f(t\))215 469 y(l)h(:=)h([])215 519 y(every)e(fname)h
(:=)g(key\(t\))g(do)258 569 y(put\(l,)g(case)g(type\(t[fname]\))e(of)i
({)454 619 y("null")108 b(:)22 b("$cint)e(")65 b(||)22
b(fname)e(||)i(";")454 669 y("string")64 b(:)22 b("$cRAddr)e(")h(||)h
(fname)e(||)i(";")454 718 y("constype")e(:)i(impossible\("fai)o(led)d
(to)i(eliminate)f(an)h(instance"\))411 768 y(}\))215
818 y(every)f(fname)h(:=)g(key\(t\))g(do)258 868 y(put\(l,)g(case)g
(type\(t[fname]\))e(of)i({)454 918 y("field")64 b(:)22
b("$cunsigned)d(")j(||)f(fname)g(||)g(":")h(||)f(fwidth\(t[fname]\))d
(||)k(";")454 967 y("integer")e(:)i("$cint)e(")131 b(||)21
b(fname)g(||)g(":")h(||)f(t[fname])194 b(||)22 b(";")411
1017 y(}\))215 1067 y(emit_template\(p)o(p,)d("closure-type.t",)f
("name",)i(name,)h("decls",)f(l\))171 1117 y(end)129
1169 y Fp(De\014nes:)171 1208 y Fl(emit_origi)o(nal)o(_cl)o(osu)o(re)o
(_ty)o(ped)o(ef)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(205a.)129
1248 y(Uses)i Fl(constype)d Fp(159,)i Fl(field)f Fp(55,)g(and)h
Fl(fwidth)f Fp(115d.)-33 1331 y(208b)88 b Fo(h)p Fn(closur)n(e-typ)n
(e.t)15 b Fp(208b)p Fo(i)n(\021)171 1381 y Fr(typedef)20
b(struct)h(\045{name}_closure)e({$t)171 1430 y(ClosureHeader)g(h;)171
1480 y(ClosureLocation)g(loc;)171 1530 y(struct)i({)g($t${\045decls)f
($b$c$}})g(v;$b)171 1580 y(})i(*\045{name}_Closur)o(e;)129
1632 y Fp(Uses)12 b Fl(ClosureHead)o(er)c Fp(406a)j(and)f
Fl(ClosureLoca)o(tio)o(n)f Fp(406a.)-29 1723 y(208c)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(208a)22 b(209a)5 b Fm(.)171 1773 y Fr(procedure)20
b(emit_original_clo)o(sure_)o(reloc)o(fn\(p)o(p,)f(name,)i(cons,)f(t\))
215 1823 y(local)g(calls)215 1872 y(calls)g(:=)i([])215
1922 y(every)e(fname)h(:=)g(key\(t\))g(&)h(type\(t[fname]\))c(==)k
("string")e(do)280 1972 y(put\(calls,)g(template_to_list)o(\("rel)o
(oc-c)o(all.t)o(",)f("irec",)h("v",)h("input",)f(fname\)\))215
2022 y(emit_template\(p)o(p,)f("constructor-labe)o(ls.t)o(",)g
("ptrtype",)h(name)h(||)g("_Closure",)890 2072 y("name",)f(name,)h
("calls",)f(calls\))215 2121 y(return)171 2171 y(end)129
2223 y Fp(De\014nes:)171 2263 y Fl(emit_origi)o(nal)o(_cl)o(osu)o(re)o
(_re)o(loc)o(fn)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(205a.)129
2302 y(Uses)i Fl(constructor)c Fp(159)j(and)f Fl(input)g
Fp(46a.)p eop
%%Page: 209 209
209 208 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(209)208 258 y(The)14 b(emitter)f(co)q(de)i
(in)e Fr(Cexp)g Fv(assumes)h(that)g(the)h(closure)f(is)g(stored)h(in)e
Fr(_c)p Fv(.)-15 320 y Fp(209a)88 b Fo(h)p Fn(*)15 b
Fp(159)p Fo(i)p Fv(+)p Fo(\021)1039 b Fm(/)5 b Fp(208c)22
b(209c)5 b Fm(.)187 370 y Fr(procedure)20 b(emit_original_cl)o(osure)o
(_func)o(tion_)o(def\()o(pp,)f(name,)h(cl,)i(t\))230
420 y(local)f(es)230 469 y(tt)h(:=)f(copy\(t\))230 519
y(every)g(k)h(:=)f(key\(t\))g(do)g(tt[k])g(:=)g(literal\("_c->v.")e(||)
i(tt[k]\))230 569 y(tt[the_global_pc])e(:=)i(Eforce\(Eclosure_lo)o
(c\(\)\))230 619 y(PPxwrite\(pp,)f("static)g(void)h(",)g(name,)514
669 y("_app)f(\(RClosure)g(c,$o)h(Emitter)g(emitter,$o)e(FailCont)i
(fail\))f({$t$n",)514 718 y(name,)g("_Closure)g(_c)i(=)f(\(",)h(name,)e
("_Closure\))g(c;$n"\))230 768 y(es)i(:=)f(emitterstyle)230
818 y(emitterstyle)f(:=)h("closure")230 868 y(PPxwrite\(pp,)f(pretty\()
296 918 y(super_simplify\(S)o(if\([S)o(guard)o(ed\(su)o(bst_t)o(able)o
(_elem)o(ents\()o(cl.co)o(nditi)o(ons,)e(tt\),)928 967
y(disjunct_to_emis)o(sion\()1015 1017 y(subst_table_eleme)o(nts\(c)o
(l.dis)o(junct)o(,)h(tt\)\)\),)361 1067 y(###)i(disjunct_to_emissio)o
(n)e(should)i(be)g(changed)f(to)i(include)e(width)h(conditions)e(&c)601
1117 y(Sguarded\(1,)666 1167 y(Sfail\("Conditions)g(not)i(satisfied)f
(for)h(constructor)e(")j(||)f(name\)\)]\)\)\)\))230 1217
y(emitterstyle)f(:=)h(es)230 1266 y(PPxwrite\(pp,)f("$b$n}"\))187
1316 y(end)145 1368 y Fp(De\014nes:)187 1408 y Fl(emit_origi)o(nal)o
(_c)o(los)o(ure)o(_fu)o(nct)o(io)o(n_d)o(ef)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(205a.)145 1447 y(Uses)k Fl(constructor)c
Fp(159,)j Fl(disjunct)e Fp(55,)i Fl(disjunct_to)o(_em)o(iss)o(ion)d
Fp(194b,)j Fl(Eclosure_)o(loc)d Fp(81,)187 1486 y Fl(Eforce)k
Fp(81,)h Fl(Emitter)p Fp(,)e Fl(emitterstyl)o(e)g Fp(19b,)i
Fl(fail)f Fp(410,)h Fl(FailCont)p Fp(,)e Fl(literal)g
Fp(45e,)187 1526 y Fl(pretty)e Fp(18a,)h Fl(RClosure)p
Fp(,)e Fl(Sfail)h Fp(188c,)h Fl(Sguarded)e Fp(81,)i Fl(Sif)g
Fp(81,)h Fl(subst_tab)o(le_)o(ele)o(men)o(ts)d Fp(89b,)187
1565 y Fl(super_simp)o(lif)o(y)f Fp(92c,)h(and)h Fl(the_globa)o(l_p)o
(c)e Fp(19d.)-17 1648 y(209b)88 b Fo(h)p Fn(apply-fun.t)15
b Fp(209b)p Fo(i)o(\021)187 1698 y Fr(static)20 b(void)h
(\045{name}_app)f(\(RClosure)g(c,)h(Emitter)f(emitter,)h(FailCont)f
(fail\))h({)145 1750 y Fp(Uses)12 b Fl(Emitter)p Fp(,)d
Fl(fail)h Fp(410,)h Fl(FailCont)p Fp(,)e(and)h Fl(RClosure)p
Fp(.)-13 1841 y(209c)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p
Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(209a)22 b(210a)5 b
Fm(.)187 1891 y Fr(procedure)20 b(find_input\(name,)e(cons\))230
1941 y(return)j(input_named\(cons,)d(name\))187 1991
y(end)145 2043 y Fp(De\014nes:)187 2082 y Fl(find_input)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(210a.)145 2121 y(Uses)j
Fl(input_name)o(d)d Fp(166b.)p eop
%%Page: 210 210
210 209 bop 129 141 a Fv(210)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(210a)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(209c)23 b(210b)t Fm(.)171 307 y Fr(procedure)d
(meaningtab\(t,)f(cons\))215 357 y(u)i(:=)h(table\(\))215
407 y(every)e(k)i(:=)f(key\(t\))g(do)258 457 y(\(u[t[k]])f(:=)i
(known_to_fit\(fin)o(d_inp)o(ut,)c(k,)k(cons\).meaning\))d(|)345
507 y(impossible\("unknown)f(free)j(variable)f(",)i(k\))215
557 y(return)e(u)171 606 y(end)129 658 y Fp(De\014nes:)171
698 y Fl(meaningtab)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(205a.)129
737 y(Uses)i Fl(find_input)c Fp(209c)j(and)f Fl(known_to_fi)o(t)f
Fp(201a.)129 874 y Ft(8.6.1)56 b(Extracting)14 b(relo)r(catable)g
(addresses)h(from)g(instances)g(and)301 932 y(closures)129
1009 y Fv(There)g(are)f(three)g(p)q(ossible)g(sources)h(of)e(relo)q
(catable)g(addresses:)20 b(the)14 b(program)e(coun)o(ter,)129
1059 y(relo)q(catable)j(inputs,)e(or)h(constructors)i(\(input)e(or)g
(applied\).)192 1108 y Fr(uses_pc)c Fv(determines)i(if)f(a)g
(constructor)i Fn(dir)n(e)n(ctly)e Fv(uses)h(the)h(program)d(coun)o
(ter.)18 b(Con-)129 1158 y(serv)n(ativ)o(ely)m(,)d(w)o(e)h(estimate)f
(that)h(a)g(constructor)h(uses)g(the)f(program)e(coun)o(ter)j(if)e(an)o
(y)g(of)129 1208 y(its)f(branc)o(hes)g(ha)o(v)o(e)f(lab)q(els,)g(or)g
(if)f(some)h(constructor)i(used)f(in)f Fn(any)h Fv(of)e(the)i
(constructor's)129 1258 y(output)g(patterns)g(uses)h(the)f(program)e
(coun)o(ter.)18 b(This)c(is)f(o)o(v)o(erly)g(conserv)n(ativ)o(e)h(but)f
(easy)129 1308 y(to)h(implemen)o(t.)-33 1370 y Fp(210b)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(210a)22 b(211a)5 b Fm(.)171 1420 y Fr(procedure)20
b(uses_pc\(x\))215 1470 y(static)g(pccache)215 1519 y(initial)g
(pccache)g(:=)i(table\(\))215 1569 y(if)f(not)g(member\(pccache,)e(x\))
i(then)g({)258 1619 y(pccache[x])f(:=)h(0)258 1669 y(type\(x\))f(==)i
("constructor")d(|)j(impossible\("use)o(s_pc")o(\))258
1719 y(if)g(pattern_label_n)o(ames\()o(\(!x.b)o(ranch)o(es\).)o(pat\))c
(|)324 1768 y(uses_pc\(constru)o(ctors)o(_appl)o(ied_i)o(n\(\(!)o
(x.bra)o(nches)o(\).pat)o(\)\))h(then)302 1818 y(return)h(pccache[x])g
(:=)h(1)215 1868 y(})215 1918 y(return)f(0)i(<)f(pccache[x])171
1968 y(end)129 2020 y Fp(De\014nes:)171 2059 y Fl(uses_pc)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(211a,)g(213b,)g(and)g(406a.)129
2098 y(Uses)i Fl(constructor)c Fp(159,)i Fl(constructors)o(_a)o(ppl)o
(ied)o(_in)e Fp(79b,)i(and)h Fl(pattern_la)o(bel)o(_na)o(mes)d
Fp(79a.)p eop
%%Page: 211 211
211 210 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(211)208 258 y Fr(uses_reloc)12
b Fv(determines)j(if)f(the)h(giv)o(en)f(constructor)i(can)f(dep)q(end)h
(on)e(the)h(lab)q(el)f(of)145 307 y(some)i(relo)q(catable)h(address.)29
b Fr(uses_reloc)14 b Fv(holds)j(if)f Fr(uses_pc)f Fv(holds)i(or)g(if)f
(a)g(relo)q(cat-)145 357 y(able)j(address)i(is)e(in)g(the)h
(constructor's)g(inputs,)h(or)e(if)f Fr(uses_reloc)f
Fv(holds)i(for)g(some)145 407 y(constructor-t)o(yp)q(ed)d(input)e(or)g
(for)f(an)o(y)h(constructor)h(used)g(in)f(an)f(output)h(pattern.)-15
468 y Fp(211a)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1031 b Fm(/)5 b Fp(210b)22 b(212d)5 b Fm(.)187
518 y Fr(procedure)20 b(uses_reloc\(x\))252 568 y(static)h(cache)252
618 y(initial)g(cache)f(:=)i(table\(\))252 668 y(if)g(not)f
(member\(cache,)e(x\))i(then)g({)296 717 y(cache[x])f(:=)h(0)296
767 y(case)g(type\(x\))f(of)h({)339 817 y("constype")85
b(:)22 b(if)f(uses_reloc\(kept_con)o(struc)o(tors\()o(x\)\))e(then)i
(return)f(cache[x])g(:=)i(1)339 867 y("constructor")d(:)383
917 y(if)i(inputs_of\(x,)f("string"\))g(|)h(uses_pc\(x\))f(|)448
966 y(uses_reloc\(inputs_o)o(f\(x,)e("constype"\).meaning)g(|)688
1016 y(constructors_appli)o(ed_i)o(n\(\(!x)o(.bran)o(ches\))o(.pat\))o
(\))383 1066 y(then)427 1116 y(return)i(cache[x])g(:=)i(1)339
1166 y(default)f(:)g(impossible\("uses_re)o(loc"\))296
1216 y(})252 1265 y(})252 1315 y(return)g(0)g(<)h(cache[x])187
1365 y(end)145 1416 y Fp(Uses)14 b Fl(construct)o(or)c
Fp(159,)i Fl(constructor)o(s_a)o(ppl)o(ie)o(d_i)o(n)e
Fp(79b,)j Fl(constype)d Fp(159,)i Fl(inputs_of)e Fp(166a,)187
1455 y Fl(kept_const)o(ruc)o(to)o(rs)e Fp(33d,)j(and)g
Fl(uses_pc)e Fp(210b.)208 1517 y Fr(ptrtype)15 b Fv(is)i(the)h(exact)g
(p)q(oin)o(ter)f(t)o(yp)q(e)g(of)g(this)g(instance)h(or)f(closure.)29
b Fr(irec)16 b Fv(is)h(the)145 1566 y(record)e(con)o(taining)e(the)i
(inputs.)-17 1635 y Fp(211b)88 b Fo(h)p Fn(c)n(onstructor-lab)n(els.t)
14 b Fp(211b)p Fo(i)n(\021)187 1685 y Fr(static)20 b(void)h
(\045{name}_relocfn\(RCl)o(osure)d(c,)k(RelocCallback)d(f,)i(void)g
(*closure\))f({$t)187 1735 y(\045ptrtype)g(_c)h(=)h(\(\045ptrtype\))e
(c;)187 1784 y(\045calls$b})145 1835 y Fp(Uses)12 b Fl(RClosure)d
Fp(and)i Fl(RelocCall)o(bac)o(k)e Fp(405)h(405.)-13 1923
y(211c)88 b Fo(h)p Fn(r)n(elo)n(c-c)n(al)r(l.t)13 b Fp(211c)p
Fo(i)o(\021)187 1973 y Fr(\(*f\)\(closure,)19 b
(_c->\045irec.\045input\))o(;)145 2023 y Fp(Uses)12 b
Fl(input)e Fp(46a.)-17 2111 y(211d)88 b Fo(h)p Fn(c)n(ons-c)n(al)r(l.t)
15 b Fp(211d)p Fo(i)n(\021)187 2161 y Fr($t${\(*\(_c->\045irec)o
(.\045inp)o(ut.h-)o(>relo)o(cfn\)\))o($o\(\(I)o(nsta)o(nce*\))o(\(&_c-)
o(>\045ire)o(c.\045in)o(put\),)j(f,)j(closure\);$}$b)145
2212 y Fp(Uses)12 b Fl(input)e Fp(46a)h(and)f Fl(Instance)f
Fp(405)i(405.)-13 2299 y(211e)88 b Fo(h)p Fn(no-lab)n(els.t)15
b Fp(211e)p Fo(i)n(\021)187 2349 y Fr(static)20 b(void)h
(\045{name}_relocfn\(RCl)o(osure)d(c,)k(RelocCallback)d(f,)i(void)g
(*closure\))f({)230 2399 y(return;)187 2448 y(})145 2499
y Fp(Uses)12 b Fl(RClosure)d Fp(and)i Fl(RelocCall)o(bac)o(k)e
Fp(405)h(405.)p eop
%%Page: 212 212
212 211 bop 129 141 a Fv(212)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Ft(8.6.2)56
b(Creating)18 b(instances)129 334 y Fv(Instance)g(creation)g(is)e
(simple-minded|c)o(hec)o(k)f(the)i(widths)g(of)f(the)i(\014eld)e
(inputs,)i(and)129 384 y(stu\013)d(all)e(the)h(inputs)g(in)o(to)f(the)i
(instance.)-31 446 y Fp(212a)88 b Fo(h)p Fn(cr)n(e)n(ate-instanc)n(e-b)
n(o)n(dy.t)15 b Fp(212a)p Fo(i)o(\021)171 496 y Fr
(\045{class}\045{type}_I)o(nstan)o(ce)k(\045safename\(\045args\))f({$t)
171 546 y(\045{type}_Instance)g(_i)k(=)f({)h(\045{name}_TAG)e(};)171
596 y(\045{input-tests}\045{a)o(ssign)o(ments)o(}retu)o(rn)f(_i;$b)171
646 y(})129 697 y Fp(Uses)12 b Fl(input)e Fp(46a.)-33
781 y(212b)88 b Fo(h)p Fn(input-test.t)15 b Fp(212b)p
Fo(i)n(\021)171 830 y Fr($t${if)21 b(\(!\(${\045condition)o($}\)\))d
($c\(*fail\))i(\("\045name)h(=)g(\045\045d)g(won't)g(fit)g(in)h
(\045width)e(\045signed)h(bits"\);$}$b)129 882 y Fp(Uses)12
b Fl(fail)e Fp(410.)-29 974 y(212c)88 b Fo(h)p Fn(instanc)n
(e-assignment.t)16 b Fp(212c)p Fo(i)o(\021)171 1023 y
Fr(_i.u.\045name.\045l)j(=)j(\045r;)-33 1115 y Fp(212d)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(211a)22 b(212e)5 b Fm(.)171 1164 y Fr(procedure)20
b(input_width_tests)o(\(cons)o(\))215 1214 y(t)h(:=)h([])215
1264 y(every)e(i)i(:=)f(inputs_of\(cons\))e(&)j(case)f
(type\(i.meaning\))d(of)k({)258 1314 y("integer")e(:)i({)f(w)h(:=)f
(i.meaning;)f(s)i(:=)f("signed";)f(c)h(:=)h(Efitss\(literal\(i)o(.name)
o(\),)d(w\))i(})258 1364 y("field")64 b(:)22 b(if)f
(member\(unchecked_f)o(ield)o(s,)e(i.meaning\))h(then)h(&fail)520
1414 y(else)g({)g(w)h(:=)f(fwidth\(i.meaning\);)d(s)k(:=)f("unsigned")
672 1463 y(c)h(:=)f(Efitsu\(literal\(i.n)o(ame\),)d(w\))k(})215
1513 y(})f(do)h(put\(t,)e(template_to_list\(")o(input)o(-tes)o(t.t",)e
("name",)j(i.name,)f("width",)g(w,)h("signed",)f(s,)1195
1563 y("condition",)g(pretty\(c\)\)\))215 1613 y(return)g(t)171
1663 y(end)129 1715 y Fp(De\014nes:)171 1754 y Fl(input_widt)o(h_t)o
(est)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(213b.)129
1793 y(Uses)j Fl(Efitss)d Fp(81,)i Fl(Efitsu)e Fp(81,)i
Fl(fail)f Fp(410,)g Fl(field)g Fp(55,)h Fl(fwidth)e Fp(115d,)h
Fl(input)g Fp(46a,)g Fl(inputs_of)e Fp(166a,)171 1833
y Fl(literal)g Fp(45e,)i Fl(pretty)e Fp(18a,)i(and)f
Fl(unchecked_fi)o(el)o(ds)f Fp(354f.)-29 1924 y(212e)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(212d)22 b(213a)5 b Fm(.)171 1974 y Fr(procedure)20
b(emit_proc_declara)o(tion\()o(pp,)f(cons\))215 2024
y(if)i(cons.type)f(===)h(instructionctype)e(then)258
2074 y(emit_emitter_proto)o(\(pp,)f(cons\))215 2123 y(else)258
2173 y(emit_create_instan)o(ce_pr)o(oto\(p)o(p,)h(cons\))215
2223 y(return)171 2273 y(end)129 2325 y Fp(De\014nes:)171
2364 y Fl(emit_proc_)o(dec)o(lar)o(ati)o(on)o Fp(,)9
b(used)i(in)g(c)o(h)o(unks)f(230c)g(and)h(231d.)129 2404
y(Uses)19 b Fl(emit_creat)o(e_i)o(nst)o(anc)o(e_p)o(ro)o(to)c
Fp(213a,)i Fl(emit_emitte)o(r_p)o(rot)o(o)f Fp(214a,)171
2443 y(and)11 b Fl(instructi)o(onc)o(typ)o(e)e Fp(32a.)p
eop
%%Page: 213 213
213 212 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(213)-15 258 y Fp(213a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(212e)22 b(213b)5 b Fm(.)187 307 y Fr(procedure)20
b(emit_create_inst)o(ance_)o(proto)o(\(pp,)e(cons\))230
357 y(c_function_declarat)o(ion\(p)o(p,)h(cons.type.name)g(||)i
("_Instance",)e(Cnoreserve\(cons.nam)o(e\),)732 407 y
(arg_decls\(cons\)\))187 457 y(end)145 509 y Fp(De\014nes:)187
548 y Fl(emit_creat)o(e_i)o(ns)o(tan)o(ce_)o(pro)o(to)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(212e.)145 588 y(Uses)i
Fl(arg_decls)d Fp(204a,)h Fl(c_functio)o(n_d)o(ecl)o(ara)o(tio)o(n)f
Fp(338b,)h(and)g Fl(Cnoreserve)e Fp(337a.)-17 679 y(213b)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(213a)22 b(214a)5 b Fm(.)187 729 y Fr(procedure)20
b(emit_create_inst)o(ance_)o(body\()o(pp,)f(cons\))230
779 y(a)j(:=)f([])230 828 y(every)g(i)h(:=)f(inputs_of\(cons\).na)o(me)
e(do)296 878 y(put\(a,)h(template_to_list\("i)o(nstan)o(ce-as)o(sign)o
(ment.)o(t",)f("name",)h(cons.name,)g("l",)h(i,)g("r",)g(i\)\))230
928 y(emit_template\(pp,)e("create-instance)o(-body)o(.t",)f
("safename",)i(Cnoreserve\(cons.)o(name\))o(,)601 978
y("name",)g(cons.name,)g("type",)g(cons.type.name,)f("args",)h
(arg_decls\(cons\),)601 1028 y("class",)g(if)h(\\indirectname)e(then)i
("static)g(")g(else)g("",)601 1077 y("uses_pc",)f(if)h(uses_pc\(cons\))
e(then)i(1)h(else)f(0,)601 1127 y("input-tests",)e(input_width_test)o
(s\(con)o(s\),)g("assignments",)f(a\))230 1177 y(return)187
1227 y(end)145 1279 y Fp(De\014nes:)187 1318 y Fl(emit_creat)o(e_i)o
(ns)o(tan)o(ce_)o(bod)o(y)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(232a)g
(and)h(236a.)145 1358 y(Uses)i Fl(arg_decls)d Fp(204a,)i
Fl(Cnoreserve)d Fp(337a,)j Fl(indirectna)o(me)e Fp(18a,)i
Fl(input)f Fp(46a,)h Fl(inputs_of)e Fp(166a,)187 1397
y Fl(input_widt)o(h_t)o(es)o(ts)e Fp(212d,)j(and)f Fl(uses_pc)f
Fp(210b.)p eop
%%Page: 214 214
214 213 bop 129 141 a Fv(214)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Ft(8.6.3)56
b(Emitting)-31 334 y Fp(214a)88 b Fo(h)p Fn(*)16 b Fp(159)p
Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(213b)22 b(214c)5
b Fm(.)171 384 y Fr(procedure)20 b(emit_emitter_prot)o(o\(pp,)e(cons\))
215 434 y(c_function_decl)o(arati)o(on\(pp)o(,)h("void",)h
(Cnoreserve\(cons.nam)o(e\),)f(arg_decls\(cons\))o(\))215
484 y(return)171 534 y(end)171 633 y(procedure)h(emit_emitter_body)o
(\(pp,)e(cons\))215 683 y(b)j(:=)h(emitter_body\(co)o(ns\))215
733 y(emit_closure_fu)o(nctio)o(ns\(pp)o(,)d(cons,)i(b\))215
783 y(emit_template\(p)o(p,)e("emitter-body.t",)520 832
y("safename",)g(Cnoreserve\(cons.na)o(me\),)f("args",)j
(arg_decls\(cons\),)520 882 y("class",)f(if)h(\\indirectname)e(then)i
("static)g(")g(else)g(""\))215 932 y(PPxwrites\(pp,)e(pretty\(b\)\))215
982 y(if)i(\\gen_counters)e(then)258 1032 y(PPxwrites\(pp,)g("$n",)i
(cons.name,)f("_ctr++;"\))215 1081 y(PPxwrite\(pp,)f("$b$n}"\))215
1131 y(return)171 1181 y(end)129 1233 y Fp(De\014nes:)171
1272 y Fl(emit_emitt)o(er_)o(bod)o(y)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(232a.)171 1312 y Fl(emit_emitt)o(er_)o(pro)o(to)p
Fp(,)e(used)j(in)g(c)o(h)o(unk)f(212e.)129 1351 y(Uses)18
b Fl(arg_decls)c Fp(204a,)i Fl(c_function)o(_de)o(cla)o(rat)o(io)o(n)f
Fp(338b,)g Fl(Cnoreserve)f Fp(337a,)171 1391 y Fl(emit_closu)o(re_)o
(fun)o(cti)o(on)o(s)9 b Fp(18a,)i Fl(emitter_bo)o(dy)e
Fp(188b,)h Fl(gen_counte)o(rs)f Fp(18a,)h Fl(indirectnam)o(e)f
Fp(18a,)171 1430 y(and)i Fl(pretty)e Fp(18a.)-33 1521
y(214b)88 b Fo(h)p Fn(emitter-b)n(o)n(dy.t)14 b Fp(214b)p
Fo(i)o(\021)171 1571 y Fr(\045{class}void)19 b
(\045safename\(\045args\))g({$t)129 1729 y Fj(8.7)67
b(Optimizing)24 b(closures)129 1820 y Fv(W)m(e)14 b(don't)f(ha)o(v)o(e)
h(to)g(n)o(um)o(b)q(er)f(optimized)f(closures;)j(their)f(naming)e(is)i
(arbitrary)m(.)-29 1883 y Fp(214c)88 b Fo(h)p Fn(*)16
b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1053 b Fm(/)5 b Fp(214a)22
b(215)5 b Fm(.)171 1932 y Fr(procedure)20 b(emit_optimized_cl)o(osure)o
(_func)o(tion)o(s\(pp,)e(cons,)j(b\))215 1982 y(pushtrace\("CLO")o(\))
215 2032 y(every)f(cl)i(:=)f(subterms_matching\()o(b,)e("Sclosure"\))g
(do)258 2082 y(emit_optimized_clo)o(sure_)o(funct)o(ion\(p)o(p,)g
(cons,)h(cons.name,)g(cl\))215 2132 y(poptrace\(\))215
2181 y(return)171 2231 y(end)129 2283 y Fp(De\014nes:)171
2323 y Fl(emit_optim)o(ize)o(d_c)o(los)o(ur)o(e_f)o(unc)o(tio)o(ns)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(19a.)129 2362 y(Uses)i
Fl(emit_optimi)o(zed)o(_c)o(los)o(ure)o(_fu)o(nct)o(io)o(n)d
Fp(215,)h Fl(Sclosure)f Fp(193f,)h(and)h Fl(subterms_ma)o(tc)o(hin)o(g)
e Fp(84a.)p eop
%%Page: 215 215
215 214 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(215)208 258 y(W)m(e)15 b(really)h(ough)o
(t)f(to)h(add)g(a)g(string)g(t)o(yp)q(e)h(to)f(the)g(closure,)h(so)g
(that)f(w)o(e)g(could)g(giv)o(e)145 307 y(the)f(name)e(of)g(the)i
(constructor)h(when)e(conditions)g(aren't)g(satis\014ed)h(in)f(the)g
(closure.)20 b(As)145 357 y(it)15 b(is,)g(I)g(use)i(the)e(same)g(error)
h(message)f(for)g(eac)o(h)h(constructor|otherwise)h(they)f(w)o(on't)145
407 y(all)d(use)i(the)f(same)f(closure)i(function!)2
469 y Fp(215)89 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1054 b Fm(/)6 b Fp(214c)22 b(217)5 b Fm(.)187
519 y Fr(procedure)20 b(emit_optimized_c)o(losur)o(e_fun)o(ction)o
(\(pp,)e(cons,)j(name,)g(cl\))230 569 y(local)g(selections,)f
(selected,)g(free,)g(save,)h(upc,)g(latevars,)f(clo,)h(subst,)g(body)
230 619 y(latevars)g(:=)g(set\(\))230 669 y(every)g(insert\(latevars,)e
(inputs_of\(cons,)f("string"\).name\))230 718 y(body)j(:=)296
768 y(super_simplify\(S)o(if\([S)o(guard)o(ed\(cl)o(.cond)o(itio)o(ns,)
e(disjunct_to_emis)o(sion\()o(cl.d)o(isjun)o(ct\)\),)361
818 y(###)i(disjunct_to_emissio)o(n)e(should)i(be)g(changed)f(to)i
(include)e(width)h(conditions)e(&c)732 868 y(Sguarded\(1,)797
918 y(Sfail\("Conditions)f(not)j(satisfied)f(for)i(unnamed)e
(constructor"\)\))710 967 y(]\)\))230 1017 y(p)i(:=)f(hoist\(pp,)f
(Elambda\(sort\(lateva)o(rs\),)e(body\),)j(latevars\))230
1067 y(clo)h(:=)f(p.e)g(#)h(is)f(a)h(closure)230 1117
y(clo)g(:=)f(apply_subst\(clo,)d(p.sigma\))230 1167 y(free)j(:=)h
(set\(\);)e(every)h(insert\(free,)e(free_variables\(clo\))o(\))230
1217 y(free)i(:=)h(sort\(free\))187 1266 y(PPwrite\(pp,)d
("/****************")o(\))187 1316 y(PPxwrite\(pp,)g("CLOSURE)h(IS:$t)h
($o",)g(ppexpimage\(clo\),)d("$b"\))187 1366 y(PPwrite\(pp,)h
("****************/")o(\))230 1416 y Fo(h)p Fn(make)d
Fr(cl.creation)c Fn(to)j(cr)n(e)n(ate)g(optimize)n(d)f(closur)n(e)h
Fr(clo)f Fn(and)i(emit)e(plac)n(eholder)h Fp(216)p Fo(i)230
1466 y Fr(return)187 1515 y(end)145 1567 y Fp(De\014nes:)187
1607 y Fl(emit_optim)o(ize)o(d_)o(clo)o(sur)o(e_f)o(unc)o(ti)o(on)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(214c.)145 1646 y(Uses)k
Fl(apply_subs)o(t)d Fp(225a,)h Fl(constructo)o(r)f Fp(159,)h
Fl(disjunct)f Fp(55,)i Fl(disjunct_t)o(o_)o(emi)o(ssi)o(on)d
Fp(194b,)187 1686 y Fl(Elambda)h Fp(217,)i Fl(free_variab)o(le)o(s)e
Fp(84b,)i Fl(hoist)f Fp(218,)h Fl(inputs_of)e Fp(166a,)h
Fl(ppexpimage)f Fp(101d,)187 1725 y Fl(Sfail)f Fp(188c,)g
Fl(Sguarded)f Fp(81,)i Fl(Sif)f Fp(81,)h Fl(subst)f Fp(88b,)h(and)f
Fl(super_simpl)o(ify)e Fp(92c.)145 1787 y Fv(N.B.)16
b(I)g(think)g(there's)i(a)e(p)q(oten)o(tial)g(b)q(otc)o(h)h(b)q(ecause)
h Fr(latevars)c Fv(do)q(esn't)j(include)g(relo-)145 1837
y(catable)d(addresses)i(hidden)e(inside)g(constructor-t)o(yp)q(ed)i
(argumen)o(ts.)p eop
%%Page: 216 216
216 215 bop 129 141 a Fv(216)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-13 258 y Fp(216)88
b Fo(h)p Fn(make)16 b Fr(cl.creation)c Fn(to)j(cr)n(e)n(ate)g(optimize)
n(d)f(closur)n(e)h Fr(clo)f Fn(and)i(emit)e(plac)n(eholder)h
Fp(216)p Fo(i)o(\021)87 b Fp(\(215\))171 307 y Fr(l)22
b(:=)f([])171 357 y(every)g(i)g(:=)h(1)f(to)h(*clo.values)d(do)215
407 y(put\(l,)h(pretty\(Gasgn\(Eclos)o(ure_v)o(al\(i\))o(,)41
b(clo.values[i]\)\))18 b(||)k("$n"\))171 457 y(every)f(i)g(:=)h(1)f(to)
h(*clo.addresses)d(do)215 507 y(put\(l,)h(pretty\(Gasgn\(Eclos)o(ure_a)
o(ddr\(i)o(\),)f(clo.addresses[i])o(\)\))g(||)i("$n"\))171
557 y(upc)g(:=)h(if)f(subterms_matching)o(\(\\cl.)o(condi)o(tion)o(s)e
(|)j(cl.disjunct,)d("Epc",)i("Epc_known"\))e(then)i(1)324
606 y(else)f(0)171 656 y(cl.creation)f(:=)j(Sstmts\([)215
706 y(literal\(templat)o(e_to_)o(list\()o("crea)o(te-cl)o(osur)o(e.t",)
c("name",)j(clo.ty,)f("clofun",)g(clo.fun,)759 756 y("uses-pc",)g(upc,)
h("save",)f(l\)\),)215 806 y(disjunct_to_emi)o(ssion)o(\(plac)o(e_hol)o
(der\(c)o(l.di)o(sjunc)o(t\)\)]\))129 857 y Fp(Uses)12
b Fl(disjunct)c Fp(55,)i Fl(disjunct_to)o(_e)o(mis)o(sio)o(n)e
Fp(194b,)i Fl(Eclosure_)o(add)o(r)e Fp(81,)i Fl(Eclosure_va)o(l)e
Fp(81,)i Fl(Epc)g Fp(81,)171 897 y Fl(Epc_known)g Fp(81,)j
Fl(Gasgn)f Fp(294a,)g Fl(literal)f Fp(45e,)h Fl(place_hold)o(er)e
Fp(72a,)i Fl(pretty)g Fp(18a,)g Fl(Sstmts)g Fp(81,)171
936 y(and)f Fl(subterms_)o(mat)o(chi)o(ng)d Fp(84a.)p
eop
%%Page: 217 217
217 216 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(217)2 258 y Fp(217)89 b
Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1070
b Fm(/)6 b Fp(215)22 b(218)5 b Fm(.)187 307 y Fr(record)20
b(Elambda\(formals,)f(body\))187 357 y(record)h(hoisted\(e,)g(sigma\))
173 b(#)22 b(pair)f(containing)e(exp,)i(substitution)187
407 y(record)f(arrow\(v,)g(e\))305 b(#)22 b(part)f(of)g(a)h
(substitution)187 457 y(procedure)e(make_early\(v,)f(e,)i(sigma\))230
507 y(v)h(:=)f(fresh_variable\(v\))230 557 y(return)g(hoisted\(v,)f
(push\(sigma,)f(arrow\(v,)h(e\)\)\))187 606 y(end)187
706 y(procedure)g(make_late\(v,)f(e,)i(sigma\))230 756
y(return)g(hoisted\(e,)f(sigma\))187 806 y(end)187 905
y(procedure)g(make_time\(e,)f(latevars\))230 955 y(return)i(if)g
(islate\(e,)f(latevars\))g(then)h(make_late)f(else)h(make_early)187
1005 y(end)187 1104 y(procedure)f(islate\(e,)g(latevars\))230
1154 y(return)h(case)g(type\(e\))f(of)i({)274 1204 y("string")e(:)i
(member\(latevars,)c(e\))274 1254 y("list")64 b(:)22
b(islate\(!e,)d(latevars\))274 1304 y(default)42 b(:)22
b(1)230 1354 y(})187 1403 y(end)145 1455 y Fp(De\014nes:)187
1495 y Fl(arrow)p Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(219d,)g(220a,)g
(and)h(225.)187 1534 y Fl(Elambda)p Fp(,)e(used)h(in)i(c)o(h)o(unks)d
(111a,)i(119c,)f(126a,)g(133f,)g(215,)h(and)f(218.)187
1574 y Fl(hoisted)p Fp(,)f(used)h(in)i(c)o(h)o(unks)d(218)i(and)g
(221{23.)187 1613 y Fl(islate)p Fp(,)e(used)i(in)g(c)o(h)o(unks)f
(220{22.)187 1652 y Fl(make_early)o Fp(,)f(used)h(in)i(c)o(h)o(unks)d
(218)i(and)g(220{22.)187 1692 y Fl(make_late)p Fp(,)d(used)j(in)g(c)o
(h)o(unks)f(218)g(and)h(220{22.)187 1731 y Fl(make_time)p
Fp(,)d(used)j(in)g(c)o(h)o(unk)f(218.)145 1771 y(Uses)i
Fl(fresh_vari)o(abl)o(e)d Fp(155b.)p eop
%%Page: 218 218
218 217 bop 129 141 a Fv(218)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-13 258 y Fp(218)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1051
b Fm(/)5 b Fp(217)23 b(219b)t Fm(.)171 307 y Fr(record)e(Eclosure\(ty,)
e(fun,)i(headertype,)e(values,)i(addresses\))171 407
y(procedure)f(hoist\(pp,)g(e,)h(latevars\))215 457 y(local)f(body,)h
(sigma,)g(sigma1,)f(p,)h(free,)g(freeset,)f(clo,)h(clofun,)g(closubst,)
e(early,)i(late,)g(hd)215 507 y(local)f(values,)h(addresses)215
557 y(x)g(:=)h(case)e(type\(e\))h(of)g({)258 606 y("string")42
b(:)22 b(hoisted\(e,)d([]\))258 656 y("integer")h(:)i
(make_early\("lit")o(,)d(e,)i([]\))258 706 y("list")86
b(:)22 b(hoistlist\(pp,)d(e,)i(latevars\))258 756 y("Elambda")f(:)i({)
324 806 y(p)f(:=)g(hoist\(pp,)f(e.body,)h(set\(e.formals\)\))324
855 y(body)f(:=)i(p.e)324 905 y(sigma)e(:=)i(p.sigma)324
955 y Fo(h)p Fn(make)15 b Fr(addresses)e Fn(and)i Fr(values)f
Fn(fr)n(e)n(e)g(vars)h(of)g(b)n(o)n(dy)g(\(in)g(or)n(der)f(of)h(app)n
(e)n(ar)n(anc)n(e\))g Fp(219c)p Fo(i)324 1005 y Fr(if)21
b(\\lateconst)f(then)h({)367 1055 y Fo(h)p Fn(using)16
b Fr(sigma)p Fn(,)d(push)j(c)n(onstants)f(b)n(ack)g(into)g
Fr(body)f Fn(and)i(out)f(of)g Fr(values)e Fp(219d)p Fo(i)324
1104 y Fr(})324 1204 y(clo)21 b(:=)g(fresh_variable\("cl)o(o"\))324
1254 y Fo(h)p Fn(make)15 b Fr(closubst)e Fn(change)j(addr)n(esses)f
(and)h(values)f(to)g(sele)n(ct)f(fr)n(om)g Fr(clo)g Fp(220a)p
Fo(i)324 1304 y Fr(body)20 b(:=)i(apply_subst\(body,)c(closubst\))324
1403 y(clotype)i(:=)h(closure_type\(pp,)e(values,)h(addresses\))324
1453 y(clofun)g(:=)h(closure_function\(pp,)d(clotype,)i(addresses,)g
(body\))324 1503 y(hd)h(:=)g(closure_header_type)o(\(pp,)d(clofun,)j
(clotype,)f(body\))324 1553 y Fo(h)p Fn(make)15 b Fr(cloargs)e
Fn(the)i(list)f(of)h(closur)n(e)f(ar)n(gs,)h(using)g
Fr(values)f Fn(and)h Fr(sigma)f Fp(220b)p Fo(i)324 1603
y Fr(p)21 b(:=)g(hoistlist\(pp,)f(cloargs,)g(latevars\))324
1652 y(make_time\(p.e,)e(latevars\)\("closure")o(,)432
1702 y(Eclosure\(clotype,)h(clofun,)h(hd,)h(p.e,)g
(apply_subst\(address)o(es,)d(sigma\)\),)j(p.sigma\))258
1752 y(})258 1802 y("Epc")g(|)g("Epc_known")f(:)i(make_late\("pc",)c
(e,)k([]\))258 1852 y Fo(h)p Fn(other)15 b(c)n(ases)g(for)f(hoisting)h
Fp(220c)p Fo(i)258 1901 y(h)p Fn(gener)n(ate)n(d)g(c)n(ases)g(for)g
(hoisting)g Fp(219a)p Fo(i)258 1951 y Fr(default)20 b(:)i
(impossible\("hoisti)o(ng)d(",)i(image\(type\(e\)\)\))215
2001 y(})171 2051 y(###)g(PPxwrites\(pp,)e("Hoisting)h(",)i
(ppexpimage\(e\),)c("$t$ngot)j($t${$o",)f(ppexpimage\(x.e\),)171
2101 y(###)501 b("$}$b$nwith"\))171 2151 y(###)21 b(showsigma\(pp,)e
(x.sigma\))171 2200 y(###)i(PPxwrite\(pp,)e("$nso,)i(when)g(applied,)f
(have)h($t$o${",)171 2250 y(###)304 b(ppexpimage\(apply_sub)o(st\(x)o
(.e,)19 b(x.sigma\)\),)171 2300 y(###)392 b("$}$b$b$n"\))215
2350 y(return)20 b(x)171 2400 y(end)129 2452 y Fp(De\014nes:)171
2491 y Fl(Eclosure)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(111a,)g(119c,)
h(126a,)f(and)g(133f.)p eop
%%Page: 219 219
219 218 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(219)187 258 y Fl(hoist)p
Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(83a,)h(215,)f(221{23,)g(and)g
(290b.)145 297 y(Uses)16 b Fl(apply_subst)d Fp(225a,)h
Fl(closure_func)o(ti)o(on)f Fp(227a,)i Fl(closure_h)o(ead)o(er_)o(typ)o
(e)e Fp(228,)187 337 y Fl(closure_ty)o(pe)e Fp(224a,)i
Fl(Elambda)f Fp(217,)i Fl(Epc)f Fp(81,)h Fl(Epc_known)e
Fp(81,)h Fl(fresh_variab)o(le)e Fp(155b,)187 376 y Fl(hoisted)h
Fp(217,)i Fl(hoistlist)d Fp(223c,)i Fl(lateconst)f Fp(18a,)h
Fl(make_early)e Fp(217,)j Fl(make_late)d Fp(217,)187
415 y Fl(make_time)d Fp(217,)j Fl(ppexpimage)d Fp(101d,)i(and)h
Fl(showsigma)d Fp(225b.)-15 507 y(219a)88 b Fo(h)p Fn(gener)n(ate)n(d)
15 b(c)n(ases)h(for)e(hoisting)h Fp(219a)p Fo(i)o(\021)704
b Fp(\(218\))208 577 y Fv(A)14 b(v)n(alue)g(is)h(an)f(address)i(if)e
(it's)g(a)h(formal)d(parameter)i(or)h(if)f(it's)g(a)g(suitable)h
(elemen)o(t)145 627 y(of)f(an)f(instance)i(input:)-17
689 y Fp(219b)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1054 b Fm(/)6 b Fp(218)22 b(223c)5 b Fm(.)187
739 y Fr(procedure)20 b(is_address\(e,)f(addressparms\))230
789 y(return)i(e)h(===)f(!addressparms)e(|)383 839 y(\(type\(e\))h(==)h
("Einstance_input",)405 889 y(type\(input_named)o(\(e.co)o(ns,)e
(e.name\).meaning)o(\))g(==)i("string"\))187 938 y(end)145
990 y Fp(De\014nes:)187 1030 y Fl(is_address)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)d(219c.)145 1069 y(Uses)j Fl(Einstance_)o
(inp)o(ut)c Fp(81)j(and)g Fl(input_name)o(d)e Fp(166b.)208
1131 y Fv(Preserving)21 b(order)f(here)i(helps)e(k)o(eep)h(us)f(from)e
(creating)i(closure)h(functions)f(that)145 1181 y(di\013er)d(only)f(b)o
(y)g(a)g(p)q(erm)o(utation)f(of)h(argumen)o(ts.)25 b(W)m(e)15
b(ha)o(v)o(e)i(to)f(apply)g Fr(sigma)p Fv(,)f(and)h(see)145
1231 y(what)f(sort)f(of)g(v)n(alue)g(the)h(free)g(v)n(ariable)e(stands)
i(for,)f(in)g(order)h(to)f(classify)g(it)g(as)g(a)g(v)n(alue)145
1281 y(or)g(an)g(address.)-13 1343 y Fp(219c)88 b Fo(h)p
Fn(make)16 b Fr(addresses)d Fn(and)i Fr(values)f Fn(fr)n(e)n(e)g(vars)h
(of)f(b)n(o)n(dy)i(\(in)f(or)n(der)f(of)h(app)n(e)n(ar)n(anc)n(e\))g
Fp(219c)p Fo(i)o(\021)87 b Fp(\(218\))187 1393 y Fr(every)21
b(addresses)e(|)j(values)f(:=)g([])187 1443 y(freeset)f(:=)i(set\(\))
187 1493 y(every)f(v)g(:=)h(free_variables\()o(body\))c(&)k(not)f
(member\(freeset,)e(v\))i(&)318 1542 y(x)g(:=)h(apply_subst\(v,)c
(sigma\))187 1592 y(do)j({)230 1642 y(insert\(freeset,)e(v\))230
1692 y(put\(if)i(is_address\(x,)e(e.formals\))h(then)h(addresses)f
(else)h(values,)f(v\))187 1742 y(})145 1794 y Fp(Uses)12
b Fl(apply_subs)o(t)d Fp(225a,)h Fl(free_varia)o(ble)o(s)f
Fp(84b,)h(and)h Fl(is_address)d Fp(219b.)-17 1877 y(219d)88
b Fo(h)p Fn(using)16 b Fr(sigma)p Fn(,)d(push)j(c)n(onstants)f(b)n(ack)
g(into)g Fr(body)f Fn(and)i(out)f(of)g Fr(values)f Fp(219d)p
Fo(i)n(\021)89 b Fp(\(218\))187 1926 y Fr(l)21 b(:=)h([])187
1976 y(every)f(f)g(:=)h(!values)e(do)230 2026 y(if)i(x)f(:=)h
(constant\(apply_s)o(ubst\()o(f,)d(sigma\)\))h(then)274
2076 y(body)h(:=)g(apply_subst\(body,)e(arrow\(f,)h(x\)\))230
2126 y(else)274 2175 y(put\(l,)h(f\))187 2225 y(values)f(:=)i(l)145
2277 y Fp(Uses)12 b Fl(apply_subs)o(t)d Fp(225a,)h Fl(arrow)g
Fp(217,)g(and)h Fl(constant)e Fp(114b.)p eop
%%Page: 220 220
220 219 bop 129 141 a Fv(220)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(220a)88
b Fo(h)p Fn(make)16 b Fr(closubst)d Fn(change)j(addr)n(esses)f(and)h
(values)f(to)f(sele)n(ct)h(fr)n(om)f Fr(clo)g Fp(220a)p
Fo(i)o(\021)89 b Fp(\(218\))171 307 y Fr(closubst)20
b(:=)h([])171 357 y(every)g(i)g(:=)h(1)f(to)h(*values)e(do)215
407 y(put\(closubst,)f(arrow\(values[i],)f(Eclosure_val\(i\)\)\))171
457 y(every)j(i)g(:=)h(1)f(to)h(*addresses)d(do)215 507
y(put\(closubst,)g(arrow\(addresses[)o(i],)g(Eclosure_addr\(i)o(\)\)\))
129 559 y Fp(Uses)12 b Fl(arrow)e Fp(217,)h Fl(Eclosure_)o(add)o(r)e
Fp(81,)i(and)f Fl(Eclosure_va)o(l)f Fp(81.)-33 650 y(220b)88
b Fo(h)p Fn(make)16 b Fr(cloargs)d Fn(the)i(list)f(of)h(closur)n(e)f
(ar)n(gs,)h(using)g Fr(values)f Fn(and)h Fr(sigma)f Fp(220b)p
Fo(i)o(\021)88 b Fp(\(218\))171 700 y Fr(cloargs)20 b(:=)i([])171
750 y(every)f(put\(cloargs,)e(apply_subst\(!value)o(s,)g(sigma\)\))129
801 y Fp(Uses)12 b Fl(apply_subst)c Fp(225a.)-29 893
y(220c)88 b Fo(h)p Fn(other)15 b(c)n(ases)g(for)g(hoisting)g
Fp(220c)p Fo(i)n(\021)666 b Fp(\(218\))21 b(221a)5 b
Fm(.)171 943 y Fr("table")20 b(:)i({)215 992 y(kl)f(:=)g([];)g(every)g
(k)h(:=)f(key\(e\))g(&)g(e[k])g(~=)h(0)f(do)h(put\(kl,)e(k\))215
1042 y(hl)h(:=)g(hoistlist\(pp,)e(kl,)j(latevars\))215
1092 y(sigma)e(:=)i(hl.sigma)215 1142 y(hl)f(:=)g(hl.e)215
1192 y(if)g(x)h(:=)f(!hl)g(&)h(not)f(islate\(x,)f(latevars\))g(then)h
({)258 1241 y(t)h(:=)f(table\(0\))258 1291 y(every)g(k)g(:=)h(kl[i)f
(:=)g(1)h(to)f(*kl])g(&)h(x)f(:=)h(hl[i])e(&)i(not)f(islate\(x,)f
(latevars\))g(do)302 1341 y(t[x])h(+:=)g(e[k])258 1391
y(early)g(:=)g(make_early\("sum",)e(t,)i(sigma\))258
1441 y(sigma)g(:=)g(early.sigma)258 1491 y(early)g(:=)g(early.e)215
1540 y(})g(else)258 1590 y(early)g(:=)g(&null)215 1640
y(if)g(islate\(!hl,)e(latevars\))h(then)h({)258 1690
y(t)h(:=)f(table\(0\))258 1740 y(every)g(k)g(:=)h(kl[i)f(:=)g(1)h(to)f
(*kl])g(&)h(x)f(:=)h(hl[i])e(&)i(islate\(x,)e(latevars\))g(do)302
1789 y(t[x])h(+:=)g(e[k])258 1839 y(t[\\early])f(+:=)h(1)258
1889 y(make_late\("sum",)e(t,)i(sigma\))215 1939 y(})g(else)g({)258
1989 y(make_early\("sum",)d(\\early)j(|)h(0,)f(sigma\))215
2038 y(})171 2088 y(})129 2140 y Fp(Uses)12 b Fl(hoistlist)d
Fp(223c,)h Fl(islate)f Fp(217,)i Fl(make_early)d Fp(217,)j(and)f
Fl(make_late)f Fp(217.)p eop
%%Page: 221 221
221 220 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(221)-15 258 y Fp(221a)88
b Fo(h)p Fn(other)15 b(c)n(ases)g(for)f(hoisting)h Fp(220c)p
Fo(i)o Fv(+)p Fo(\021)516 b Fp(\(218\))22 b Fm(/)5 b
Fp(220c)22 b(221b)5 b Fm(.)187 307 y Fr("Eorb")20 b(:)i({)230
357 y(l)g(:=)f(hoistlist\(pp,)e(flatten\(e,)h("Eorb"\),)g(latevars\))
230 407 y(every)h(early)g(|)g(late)g(:=)h([])230 457
y(every)f(x)h(:=)f(!l.e)g(do)g(put\(if)g(islate\(x,)f(latevars\))g
(then)h(late)g(else)g(early,)f(x\))230 507 y(if)i(*late)f(>)g(0)h(then)
274 557 y(if)f(*early)g(=)g(0)h(then)318 606 y(make_late\("or",)c
(unflatten\(late,)h(Eorb,)i(0\),)g(l.sigma\))274 656
y(else)g({)318 706 y(early)f(:=)i(make_early\("or",)c
(unflatten\(early,)h(Eorb,)h(0\),)i(l.sigma\))318 756
y(push\(late,)d(early.e\))318 806 y(make_late\("or",)f
(unflatten\(late,)h(Eorb,)i(0\),)g(early.sigma\))274
855 y(})230 905 y(else)274 955 y(make_early\("or",)d(unflatten\(early,)
h(Eorb,)i(0\),)g(l.sigma\))187 1005 y(})145 1057 y Fp(Uses)13
b Fl(Eorb)e Fp(81,)g Fl(flatten)f Fp(116c,)h Fl(hoistlist)e
Fp(223c,)h Fl(islate)h Fp(217,)g Fl(make_early)d Fp(217,)k
Fl(make_late)d Fp(217,)187 1096 y(and)h Fl(unflatten)f
Fp(116d.)-17 1187 y(221b)88 b Fo(h)p Fn(other)15 b(c)n(ases)g(for)f
(hoisting)h Fp(220c)p Fo(i)o Fv(+)p Fo(\021)516 b Fp(\(218\))22
b Fm(/)5 b Fp(221a)22 b(222a)5 b Fm(.)187 1237 y Fr("set")21
b(:)g({)230 1287 y(sigma)g(:=)h([])230 1337 y(s)g(:=)f(set\(\))230
1387 y(every)g(x)h(:=)f(!e)g(do)h({)274 1437 y(p)g(:=)f(hoist\(pp,)f
(x,)h(latevars\))274 1486 y(insert\(s,)f(p.e\))274 1536
y(sigma)h(:=)g(compose\(sigma,)e(p.sigma\))230 1586 y(})230
1636 y(hoisted\(s,)h(sigma\))187 1686 y(})145 1738 y
Fp(Uses)12 b Fl(compose)d Fp(224b,)h Fl(hoist)g Fp(218,)h(and)f
Fl(hoisted)g Fp(217.)p eop
%%Page: 222 222
222 221 bop 129 141 a Fv(222)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(F)m(or)19
b(equations,)h(w)o(e)g(try)f(a)g(funky)g(heuristic,)i(namely)m(,)e(if)f
(w)o(e)i(see)g(a)f(zero)i(on)e(the)129 307 y(righ)o(t-hand)14
b(side,)f Fn(don)l('t)h Fv(hoist)g(it.)-31 370 y Fp(222a)88
b Fo(h)p Fn(other)15 b(c)n(ases)g(for)g(hoisting)g Fp(220c)p
Fo(i)n Fv(+)q Fo(\021)511 b Fp(\(218\))22 b Fm(/)5 b
Fp(221b)23 b(222b)t Fm(.)171 420 y Fr("eqn")e(:)g({)215
469 y(sigma)f(:=)i([])215 519 y(m)f(:=)h(make_early)215
569 y(_a0)f(:=)g(hoist\(pp,)f(e.left,)g(latevars\))215
619 y(sigma)g(:=)i(compose\(sigma,)d(_a0.sigma\))215
669 y(_a0)i(:=)g(_a0.e)215 718 y(if)g(islate\(_a0,)e(latevars\))h(then)
h(m)h(:=)f(make_late)215 768 y(if)g(\\latezero)f(&)h
(untable\(e.right\))e(===)i(0)h(then)f({)258 818 y(_a2)g(:=)h(0)258
868 y(m)g(:=)f(make_late)215 918 y(})g(else)g({)258 967
y(_a2)g(:=)h(hoist\(pp,)e(e.right,)g(latevars\))258 1017
y(sigma)h(:=)g(compose\(sigma,)e(_a2.sigma\))258 1067
y(_a2)i(:=)h(_a2.e)258 1117 y(if)g(islate\(_a2,)d(latevars\))h(then)h
(m)h(:=)f(make_late)215 1167 y(})215 1217 y(if)g(not)g(\(_a0)g(===)g
(e.left,)g(_a2)g(===)g(e.right\))f(then)258 1266 y(e)i(:=)f(eqn\(_a0,)f
(e.op,)h(_a2\))215 1316 y(m\("eqn",)f(e,)h(sigma\))171
1366 y(})129 1418 y Fp(Uses)14 b Fl(compose)e Fp(224b,)g
Fl(eqn)h Fp(83c,)g Fl(hoist)f Fp(218,)h Fl(islate)e Fp(217,)i
Fl(latezero)e Fp(18a,)i Fl(make_early)d Fp(217,)171 1457
y Fl(make_late)f Fp(217,)h(and)h Fl(untable)e Fp(114c.)192
1520 y Fv(W)m(e)k(can't)g(hoist)g(a)g(guard!)18 b(And)13
b(w)o(e)g(migh)o(t)f(as)h(w)o(ell)g(not)g(hoist)g(1)g(when)h(it's)e
(just)i(the)129 1569 y(guard)g(that's)g(alw)o(a)o(ys)f(satis\014ed.)-33
1632 y Fp(222b)88 b Fo(h)p Fn(other)15 b(c)n(ases)g(for)g(hoisting)g
Fp(220c)p Fo(i)n Fv(+)q Fo(\021)517 b Fp(\(218\))22 b
Fm(/)5 b Fp(222a)22 b(222c)5 b Fm(.)171 1681 y Fr("Sguarded")20
b(:)h({)215 1731 y(p)g(:=)h(if)f(guard_always_sati)o(sfied)o(\(e.gu)o
(ard\))d(then)j(hoisted\(1,)f([]\))324 1781 y(else)g(hoist\(pp,)g
(e.guard,)h(latevars\))215 1831 y(q)g(:=)h(hoist\(pp,)d(e.x,)i
(latevars\))215 1881 y(hoisted\(Sguarde)o(d\(p.e)o(,)e(q.e\),)i
(compose\(p.sigma,)d(q.sigma\)\))171 1931 y(})171 1980
y("Sepsilon")i(:)h(hoisted\(e,)f([]\))129 2032 y Fp(Uses)13
b Fl(compose)d Fp(224b,)i Fl(guard_alw)o(ays)o(_sa)o(tis)o(fi)o(ed)e
Fp(96b,)h Fl(hoist)g Fp(218,)g Fl(hoisted)g Fp(217,)g
Fl(Sepsilon)f Fp(81,)171 2072 y(and)h Fl(Sguarded)d Fp(81.)192
2134 y Fv(F)m(or)14 b Fr(Sfail)p Fv(,)f(w)o(e)i(ough)o(t)g(to)f(b)q(e)i
(able)e(to)h(k)o(eep)g(trac)o(k)g(of)f(the)i(t)o(yp)q(es)f(of)f(v)n
(ariables)g(that)129 2184 y(are)g(hoisted,)f(so)g(w)o(e)g(could)g
(hoist)g(b)q(oth)g(the)g(message)g(and,)g(if)f(need)i(b)q(e,)f(the)h
(argumen)o(ts.)-29 2246 y Fp(222c)88 b Fo(h)p Fn(other)15
b(c)n(ases)g(for)g(hoisting)g Fp(220c)p Fo(i)n Fv(+)q
Fo(\021)513 b Fp(\(218\))22 b Fm(/)5 b Fp(222b)22 b(223a)5
b Fm(.)171 2296 y Fr("Sfail")86 b(:)21 b(hoisted\(e,)f([]\))129
2348 y Fp(Uses)12 b Fl(hoisted)d Fp(217)i(and)g Fl(Sfail)f
Fp(188c.)p eop
%%Page: 223 223
223 222 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(223)208 258 y(F)m(or)14
b(emission,)g(w)o(e)h(ough)o(t)g(to)g(do)g(something)f(extra)h(sp)q
(ecial.)22 b(W)m(e)15 b(ough)o(t)g Fn(always)g Fv(to)145
307 y(hoist)j(emission,)e(con)o(v)o(erting)i(unkno)o(wn)f(tok)o(ens)h
(in)o(to)f(placeholders)i(as)e(w)o(e)h(go.)29 b(Then)145
357 y(w)o(e)20 b(can)h(build)e(closures)i(for)f(the)g(remaining)e(tok)o
(esn.)37 b(P)o(erhaps)21 b(if)e(w)o(e)h(ha)o(v)o(e)g(a)g(t)o(yp)q(e)145
407 y(mec)o(hanism,)11 b(w)o(e)j(can)h(do)e(that)h(one)g(da)o(y)m(.)208
457 y(F)m(or)f(no)o(w,)g(w)o(e)h(prev)o(en)o(t)h(hoisting)e(b)o(y)h(k)o
(eeping)g Fr(Stoken)p Fv(s)f(late.)-15 519 y Fp(223a)88
b Fo(h)p Fn(other)15 b(c)n(ases)g(for)f(hoisting)h Fp(220c)p
Fo(i)o Fv(+)p Fo(\021)516 b Fp(\(218\))22 b Fm(/)5 b
Fp(222c)22 b(223b)5 b Fm(.)187 569 y Fr("Stoken")20 b(:)i({)230
619 y(p)g(:=)f(hoist\(pp,)f(e.x,)h(latevars\))230 669
y(hoisted\(Stoken\(p.e,)d(e.n,)j(e.offset\),)f(p.sigma\))187
718 y(})145 770 y Fp(Uses)12 b Fl(hoist)e Fp(218,)g Fl(hoisted)g
Fp(217,)g(and)h Fl(Stoken)e Fp(81.)208 833 y Fv(F)m(or)14
b(a)g(particular)h(instance)g(input,)f(w)o(e)h(ha)o(v)o(e)f(to)h(c)o
(hec)o(k)h(its)e(t)o(yp)q(e)h(to)g(kno)o(w)f(whether)145
882 y(it)g(is)g(early)f(or)h(late.)-17 945 y Fp(223b)88
b Fo(h)p Fn(other)15 b(c)n(ases)g(for)f(hoisting)h Fp(220c)p
Fo(i)o Fv(+)p Fo(\021)633 b Fp(\(218\))22 b Fm(/)6 b
Fp(223a)187 994 y Fr("Eforce")20 b(:)i({)230 1044 y(p)g(:=)f
(hoist\(pp,)f(e.x,)h(latevars\))230 1094 y(hoisted\(Eforce\(p.e\))o(,)e
(p.sigma\))187 1144 y(})145 1196 y Fp(Uses)12 b Fl(Eforce)e
Fp(81,)g Fl(hoist)g Fp(218,)h(and)g Fl(hoisted)e Fp(217.)-13
1279 y(223c)88 b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p
Fo(\021)1033 b Fm(/)5 b Fp(219b)22 b(224a)5 b Fm(.)187
1329 y Fr(procedure)20 b(hoistlist\(pp,)f(l,)i(latevars\))230
1378 y(local)g(sigma,)g(newl,)f(e)230 1428 y(sigma)h(:=)h([])230
1478 y(newl)f(:=)h([])230 1528 y(every)f(e)h(:=)f(!l)g(do)h({)274
1578 y(p)g(:=)f(hoist\(pp,)f(e,)h(latevars\))274 1628
y(put\(newl,)f(p.e\))274 1677 y(sigma)h(:=)g(compose\(p.sigma,)e
(sigma\))230 1727 y(})230 1777 y(return)i(hoisted\(newl,)e(sigma\))187
1827 y(end)145 1879 y Fp(De\014nes:)187 1918 y Fl(hoistlist)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(218,)g(220c,)g(and)h(221a.)145
1958 y(Uses)h Fl(compose)d Fp(224b,)h Fl(hoist)g Fp(218,)h(and)f
Fl(hoisted)g Fp(217.)p eop
%%Page: 224 224
224 223 bop 129 141 a Fv(224)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(The)f(function)f
Fr(closure_type)e Fv(lo)q(oks)h(at)i(the)g(n)o(um)o(b)q(er)e(of)h(free)
h(and)g(b)q(ound)f(v)n(ariables)129 307 y(and)16 b(\014nds)h(\(or)f
(emits\))f(a)h(t)o(yp)q(e)g(suitable)g(for)g(use)g(as)g(the)h(closure.)
25 b(If)16 b(it)f(has)h(to)g(emit)f(a)129 357 y(new)g(t)o(yp)q(e,)f(it)
f(also)g(emits)g(a)h(\\relo)q(c)g(function")g(to)f(go)h(with)f(it.)-31
420 y Fp(224a)88 b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(223c)23 b(224b)t Fm(.)171
469 y Fr(procedure)d(closure_type\(pp,)e(values,)j(addresses\))215
519 y(static)f(closure_types)215 569 y(local)g(clname,)h(calls)215
619 y(initial)f(closure_types)f(:=)i(set\(\))215 669
y(clname)f(:=)h("O")h(||)f(*addresses)f(||)h("_")g(||)h(*values)215
718 y(if)f(not)g(member\(closure_typ)o(es,)e(clname\))h(then)h({)258
768 y(insert\(closure_typ)o(es,)e(clname\))258 818 y(every)i(calls)g(|)
g(l)h(:=)f([])258 868 y(every)g(i)g(:=)h(1)f(to)h(*addresses)e(do)h({)
302 918 y(put\(l,)f(")i($cRAddr)e(a")i(||)f(i)h(||)f(";"\))302
967 y(put\(calls,)e(template_to_list\("re)o(loc-)o(call.)o(t",)g
("irec",)h("v",)h("input",)f("a")h(||)h(i\)\))258 1017
y(})258 1067 y(every)f(i)g(:=)h(1)f(to)h(*values)e(do)302
1117 y(put\(l,)g(")i($cunsigned)e(u")h(||)g(i)h(||)f(";"\))258
1167 y(emit_template\(pp,)d("closure-type.t",)h("name",)h(clname,)g
("decls",)h(l\))258 1217 y(emit_template\(pp,)d("constructor-labels)o
(.t",)g("ptrtype",)i(clname)h(||)g("_Closure",)890 1266
y("name",)f(clname,)h("calls",)f(calls\))215 1316 y(})215
1366 y(return)g(clname)171 1416 y(end)129 1468 y Fp(De\014nes:)171
1507 y Fl(closure_ty)o(pe)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(218.)129
1547 y(Uses)i Fl(constructor)c Fp(159)j(and)f Fl(input)g
Fp(46a.)192 1609 y Fv(F)m(or)j(comp)q(ose,)g(the)i(righ)o(t-hand)e
(substitution)h(is)g(applied)f(\014rst.)-33 1671 y Fp(224b)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(224a)22 b(225a)5 b Fm(.)171 1721 y Fr(procedure)20
b(compose\(sigma1,)f(sigma2\))215 1771 y(return)h(if)h(*sigma1)g(=)g(0)
h(then)f(sigma2)367 1821 y(else)g(if)g(*sigma2)g(=)g(0)h(then)f(sigma1)
367 1870 y(else)g(push\(sigma1,)e(sigma2\))171 1920 y(end)129
1972 y Fp(De\014nes:)171 2011 y Fl(compose)p Fp(,)9 b(used)i(in)g(c)o
(h)o(unks)f(221{23.)p eop
%%Page: 225 225
225 224 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(225)-15 258 y Fp(225a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(224b)22 b(225b)5 b Fm(.)187 307 y Fr(procedure)20
b(apply_subst\(e,)f(sigma\))230 357 y(return)i(case)g(type\(sigma\))e
(of)j({)427 407 y("list")e(:)i({)514 457 y(every)e(s)i(:=)f(!sigma)g
(do)g(e)h(:=)f(apply_subst\(e,)e(s\))514 507 y(e)470
557 y(})427 606 y("arrow":)h(subst\(e,)g(sigma.v,)g(sigma.e\))427
656 y(default)g(:)43 b(impossible\("substit)o(utio)o(n"\))383
706 y(})187 756 y(end)187 806 y(procedure)20 b(apply_subst_list)o(\(e,)
f(sigma\))230 855 y(every)i(i)h(:=)230 905 y(return)f(case)g
(type\(sigma\))e(of)j({)427 955 y("list")e(:)i(apply_subst_list)o(\(e,)
d(sigma,)h(1\))427 1005 y("arrow":)g(subst\(e,)g(s.v,)h(s.e\))427
1055 y(default)f(:)43 b(impossible\("substit)o(utio)o(n"\))383
1104 y(})187 1154 y(end)145 1206 y Fp(De\014nes:)187
1246 y Fl(apply_subs)o(t)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(215)h
(and)f(218{20.)145 1285 y(Uses)i Fl(arrow)e Fp(217)h(and)f
Fl(subst)g Fp(88b.)-17 1376 y(225b)88 b Fo(h)p Fn(*)15
b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1052 b Fm(/)6 b Fp(225a)22
b(226)5 b Fm(.)187 1426 y Fr(procedure)20 b(showsigma\(pp,)f(sigma\))
230 1476 y(case)i(type\(sigma\))f(of)h({)274 1526 y("arrow")f(:)i
(PPxwrites\(pp,)d("$t$n${",)h(sigma.v,)g(")i(-->)f(",)710
1576 y(ppexpimage\(sigma.)o(e\),)d("$}$b"\))274 1625
y("list")42 b(:)22 b(every)f(showsigma\(pp,)e(!sigma\))274
1675 y(default)h(:)i(impossible\("subst)o(ituti)o(on"\))230
1725 y(})230 1775 y(return)187 1825 y(end)145 1877 y
Fp(De\014nes:)187 1916 y Fl(showsigma)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(218.)145 1955 y(Uses)i Fl(arrow)e Fp(217)h(and)f
Fl(ppexpimage)e Fp(101d.)p eop
%%Page: 226 226
226 225 bop 129 141 a Fv(226)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-13 258 y Fp(226)88
b Fo(h)p Fn(*)16 b Fp(159)p Fo(i)o Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(225b)22 b(227a)5 b Fm(.)171 307 y Fr(global)21
b(closure_functio)o(ns_po)o(stfix)171 357 y(procedure)f
(emit_closure_func)o(tions)o(_post)o(fix\()o(pp,)f(interfacebasenam)o
(e\))215 407 y(if)i(*\\closure_functio)o(ns_po)o(stfix)d(>)k(0)f(then)g
({)258 457 y(PPxwrite\(pp,)e("/******************)o(****)o(*****)o
(**$t")o(\))258 507 y(every)i(k)g(:=)h(key\(\\closure_func)o(tions)o
(_pos)o(tfix\))c(do)302 557 y(PPxwrite\(pp,)h("${",)i(k,)g(")h(=)f
($t$c",)g(closure_functions)o(_post)o(fix[k)o(],)e("$b$}"\))258
606 y(PPxwrite\(pp,)g("$b$n***************)o(*/"\))215
656 y(})215 706 y(PPxwrites\(pp,)g("ClosurePostfix)f(",)520
756 y(mapoutbadchars\(i)o(nterf)o(aceb)o(asena)o(me\),)g("_clofuns[])i
(=)i({$t"\))215 806 y(every)e(k)i(:=)f(key\(\\closure_functi)o(ons_p)o
(ostf)o(ix\))e(do)258 855 y(PPxwrites\(pp,)g("$n{)i(",)h(k,)f(",)g(",)h
(image\(closure_fu)o(nctio)o(ns_po)o(stfix)o([k]\))o(,)d(")j(},)f("\))
215 905 y(PPxwrites\(pp,)e("$n{)i(\(ApplyMethod\))e(0,)i(\(char)g(*\))g
(0)h(}"\))215 955 y(PPxwrite\(pp,)d("$b$n};"\))215 1005
y(return)171 1055 y(end)129 1107 y Fp(De\014nes:)171
1146 y Fl(closure_fu)o(nct)o(ion)o(s_p)o(os)o(tfi)o(x)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(227a.)171 1185 y Fl(emit_closu)o
(re_)o(fun)o(cti)o(on)o(s_p)o(ost)o(fix)o Fp(,)f(used)h(in)i(c)o(h)o
(unk)d(232a.)129 1225 y(Uses)j Fl(ApplyMethod)c Fp(406a,)i
Fl(ClosurePost)o(fi)o(x)f Fp(406b,)h(and)h Fl(mapoutbad)o(cha)o(rs)d
Fp(165a.)p eop
%%Page: 227 227
227 226 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)613
b Fr(constructors.nw)80 b Fv(227)-15 258 y Fp(227a)88
b Fo(h)p Fn(*)15 b Fp(159)p Fo(i)p Fv(+)p Fo(\021)1070
b Fm(/)6 b Fp(226)22 b(228)5 b Fm(.)187 307 y Fr(procedure)20
b(closure_function)o(\(pp,)e(cloty,)j(addresses,)f(body\))230
357 y(static)h(cache,)f(count)230 407 y(local)h(bodyimage,)f(es,)h
(orig_body,)f(bytecode)230 457 y(initial)h({)g(every)g
(closure_functions_)o(postf)o(ix)e(|)i(cache)g(:=)g(table\(\);)g(count)
f(:=)i(0)f(})230 507 y(tt)h(:=)f(table\(\))230 557 y(every)g(i)h(:=)f
(1)h(to)f(*addresses)f(do)h(tt[addresses[i]])e(:=)i(Eclosure_addr\(i\))
230 606 y(tt[the_global_pc])e(:=)i(Eforce\(Eclosure_lo)o(c\(\)\))230
656 y(orig_body)f(:=)i(body)230 706 y(body)f(:=)h(subst_table_elem)o
(ents\()o(body,)c(tt\))230 756 y(bodyimage)i(:=)i(expps\(body\))230
806 y(if)g(/cache[bodyimage)o(])d(then)i({)274 855 y(cache[bodyimage])d
(:=)k("_clofun_")e(||)h(\(count)f(+:=)i(1\))274 905 y
(closure_functions)o(_post)o(fix[c)o(ache[)o(bodyi)o(mage)o(]])d(:=)i
(bodyimage)274 955 y(verbose\("New)e(closure)i(function)f(for)h(\\n",)g
(bodyimage\))274 1005 y(PPxwrite\(pp,)e("/*)i(CLOSURE)g(FUNCTION)f
(_clofun_",)g(count,)g(")i(is)f($t$n",)g(bodyimage,)e("$b$n)i(*/"\))274
1055 y(bytecode)f(:=)h(expbc\(body\))f(||)h(bc_halt\(\))274
1104 y(PPwrite\(pp,)e("/*)j(bytecode)e(\(",)h(*bytecode,)f("\))h(is)g
(",)h(image\(bytecode\),)c(")k(*/"\))274 1154 y Fo(h)p
Fn(emit)15 b(new)f(closur)n(e)h(function)g(numb)n(er)n(e)n(d)g
Fr(count)f Fn(and)i(put)f(it)f(in)h(c)n(ache)h Fp(227b)p
Fo(i)230 1204 y Fr(})230 1254 y(return)21 b(cache[bodyimage])187
1304 y(end)145 1356 y Fp(De\014nes:)187 1395 y Fl(closure_fu)o(nct)o
(io)o(n)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(218.)145
1434 y(Uses)k Fl(bc_halt)p Fp(,)d Fl(closure_fu)o(nct)o(ion)o(s_)o(pos)
o(tfi)o(x)g Fp(226,)h Fl(Eclosure_a)o(ddr)e Fp(81,)j
Fl(Eclosure_l)o(oc)d Fp(81,)187 1474 y Fl(Eforce)i Fp(81,)i
Fl(expbc)p Fp(,)f Fl(expps)f Fp(128a,)h Fl(subst_table)o(_el)o(eme)o
(nts)e Fp(89b,)i Fl(the_global)o(_pc)e Fp(19d,)187 1513
y(and)f Fl(verbose)g Fp(18a.)-17 1605 y(227b)88 b Fo(h)p
Fn(emit)15 b(new)g(closur)n(e)f(function)i(numb)n(er)n(e)n(d)f
Fr(count)e Fn(and)j(put)f(it)g(in)g(c)n(ache)g Fp(227b)p
Fo(i)o(\021)88 b Fp(\(227a\))187 1654 y Fr(es)21 b(:=)h(emitterstyle)
187 1704 y(emitterstyle)d(:=)i("closure")187 1754 y(PPxwrite\(pp,)e
("static)h(void)h(_clofun_",)f(count,)470 1804 y("\(RClosure)g(c,$o)h
(Emitter)f(emitter,$o)g(FailCont)g(fail\))h({$t$n",)470
1854 y(cloty,)g("_Closure)f(_c)h(=)h(\(",)f(cloty,)f("_Closure\))g
(c;$n"\))187 1904 y(PPxwrite\(pp,)f(pretty\(body\)\))187
1953 y(emitterstyle)g(:=)i(es)187 2003 y(PPxwrite\(pp,)e("$b$n}"\))145
2055 y Fp(Uses)12 b Fl(Emitter)p Fp(,)d Fl(emittersty)o(le)g
Fp(19b,)h Fl(fail)g Fp(410,)h Fl(FailCont)p Fp(,)e Fl(pretty)g
Fp(18a,)i(and)f Fl(RClosure)p Fp(.)p eop
%%Page: 228 228
228 227 bop 129 141 a Fv(228)83 b Fr(constructors.nw)611
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Added)e(this)g(so)f
(w)o(e)h(could)g(emit)e(one)i(header)g(p)q(er)h(closure)f(function)g
(in)f(the)h(optimized)129 307 y(case)k(\(instead)g(of)e(one)h(header)h
(p)q(er)g(enco)q(ding)f(function\).)533 b Fk(\031Change)14
b(#34)-13 370 y Fp(228)88 b Fo(h)p Fn(*)16 b Fp(159)p
Fo(i)o Fv(+)p Fo(\021)1152 b Fm(/)6 b Fp(227a)171 420
y Fr(procedure)20 b(closure_header_ty)o(pe\(pp)o(,)f(clofun,)h
(clotype,)g(body\))215 469 y(local)g(upc)215 519 y(static)g(cache)215
569 y(initial)g(cache)h(:=)g(table\(\))215 619 y(if)g(/cache[clofun])e
(then)i({)258 669 y(cache[clofun])e(:=)j(clofun)e(||)i("_closure_heade)
o(r")258 718 y(upc)f(:=)h(if)f(subterms_matching\()o(body,)d("Epc",)j
("Epc_known"\))e(then)i(1)h(else)e(0)258 768 y(emit_template\(pp,)e
("closure-header.t",)825 818 y("clofun",)i(clofun,)g("name",)g
(clotype,)h("uses-pc",)e(upc\))215 868 y(})215 918 y(return)h
(cache[clofun])171 967 y(end)129 1219 y Fp(De\014nes:)171
1258 y Fl(closure_he)o(ade)o(r_t)o(ype)o Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(218.)129 1297 y(Uses)i Fl(Epc)f Fp(81,)g Fl(Epc_known)d
Fp(81,)j(and)g Fl(subterms_)o(mat)o(chi)o(ng)d Fp(84a.)p
eop
%%Page: 229 229
229 228 bop 145 569 a Fq(Chapter)32 b(9)145 777 y Fu(Managing)40
b(generation)f(of)145 901 y(binary)h(enco)s(ders)2 1122
y Fp(229)89 b Fo(h)p Fn(*)15 b Fp(229)p Fo(i\021)1184
b Fp(230a)5 b Fm(.)187 1172 y Fr(link)21 b(pretty)187
1222 y(procedure)f(emit_encoding\(ou)o(tfile)o(name\))230
1272 y(local)h(i,)h(f)230 1322 y(emit_encoding_inter)o(face\()o(open\()
o(i)d(:=)i(outfilename)f(||)h(interface_extension)o(,)e("w"\)\))i(|)274
1372 y(error\("Could)e(not)i(open)g(",)h(image\(i\),)e(")h(for)g
(writing"\))230 1421 y(emit_encoding_imple)o(menta)o(tion\()383
1471 y(open\(f)f(:=)i(outfilename)d(||)j(implementation_e)o(xtens)o
(ion,)c("w"\),)j(i,)h(outfilename\))d(|)274 1521 y(error\("Could)g(not)
i(open)g(",)h(image\(f\),)e(")h(for)g(writing"\))187
1571 y(end)145 1623 y Fp(De\014nes:)187 1662 y Fl(emit_encod)o(ing)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(20.)145 1702 y(Uses)17
b Fl(emit_enco)o(din)o(g_i)o(mpl)o(em)o(ent)o(ati)o(on)c
Fp(232a,)i Fl(emit_encod)o(in)o(g_i)o(nte)o(rfa)o(ce)e
Fp(230a,)187 1741 y Fl(implementa)o(tio)o(n_)o(ext)o(ens)o(ion)8
b Fp(18a,)i Fl(interface_ex)o(te)o(nsi)o(on)e Fp(18a,)j(and)g
Fl(pretty)e Fp(18a.)830 2604 y Fv(229)p eop
%%Page: 230 230
230 229 bop 129 141 a Fv(230)83 b Fr(encoding.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(230a)88
b Fo(h)p Fn(*)16 b Fp(229)p Fo(i)o Fv(+)p Fo(\021)1053
b Fm(/)5 b Fp(229)22 b(231a)5 b Fm(.)171 307 y Fr(procedure)20
b(emit_encoding_int)o(erfac)o(e\(out)o(file)o(\))215
357 y(local)g(cons,)h(t,)g(u)215 407 y(verbose\("Emitti)o(ng)e
(encoding)h(interface"\))215 457 y(pp)h(:=)g(PPnew\(outfile\))215
507 y(every)f(PPwrite\(pp,)g(pretty\(!header_li)o(nes\))o(\))215
557 y(PPwrite\(pp,)f("/*)i(must)g(#include)f(<mclib.h>)g(before)h(this)
g(file)g(*/"\))215 606 y Fo(h)p Fn(write)13 b(de\014nitions)j(of)f(al)r
(l)f(instanc)n(e)h(typ)n(es)g Fp(230b)p Fo(i)215 656
y Fr(if)21 b(\\gen_counters)e(then)i(declare_counter_t)o(ypes\()o(pp\))
215 706 y(if)g(\\indirectname)e(then)258 756 y(PPxwrite\(pp,)g("struct)
i(",)g(indirecttype,)e(")j({$t"\))215 806 y Fo(h)p Fn(emit)14
b(de)n(clar)n(ations)h(for)f(al)r(l)g(of)h(the)g(kept)g(c)n
(onstructors)g Fp(230c)p Fo(i)215 855 y Fr(if)21 b(\\gen_counters)e
(then)i(declare_counter_f)o(uns\(p)o(p\))215 905 y(if)g(\\indirectname)
e(then)258 955 y(PPxwrite\(pp,)g("$b$n};"\))215 1005
y(return)171 1055 y(end)129 1107 y Fp(De\014nes:)171
1146 y Fl(emit_encod)o(ing)o(_in)o(ter)o(fa)o(ce)p Fp(,)8
b(used)j(in)g(c)o(h)o(unks)f(229)h(and)f(235a.)129 1185
y(Uses)17 b Fl(declare_c)o(oun)o(ter)o(_fu)o(ns)c Fp(234a,)h
Fl(declare_cou)o(nte)o(r_t)o(ype)o(s)f Fp(234a,)i Fl(file)g
Fp(359a,)171 1225 y Fl(gen_counte)o(rs)9 b Fp(18a,)i
Fl(header_line)o(s)e Fp(20,)j Fl(indirectn)o(ame)d Fp(18a,)i
Fl(indirectty)o(pe)e Fp(18a,)i Fl(pretty)f Fp(18a,)171
1264 y(and)h Fl(verbose)e Fp(18a.)-33 1356 y(230b)88
b Fo(h)p Fn(write)14 b(de\014nitions)i(of)f(al)r(l)f(instanc)n(e)h(typ)
n(es)g Fp(230b)p Fo(i)o(\021)515 b Fp(\(230a\))171 1405
y Fr(s)22 b(:=)f(set\([instructionc)o(type])o(\))41 b(#)21
b(don't)g(try)g(to)h(emit)f(instance)f(def)h(for)g(untyped)f
(constructors)171 1455 y(every)h(cons)g(:=)g(kept_constructors\()o(\))e
(&)j(not)f(member\(s,)f(cons.type\))f(do)j({)215 1505
y(insert\(s,)d(cons.type\))215 1555 y(emit_instance_t)o(ype\(p)o(p,)g
(cons.type\))171 1605 y(})171 1654 y(s)j(:=)f(&null)g(#)g(enable)g
(garbage)f(collection)129 1706 y Fp(Uses)d Fl(constructo)o(rs)c
Fp(32a,)i Fl(emit_instanc)o(e_)o(typ)o(e)f Fp(202b,)g
Fl(instruction)o(cty)o(pe)f Fp(32a,)171 1746 y(and)e
Fl(kept_cons)o(tru)o(cto)o(rs)d Fp(33d.)192 1816 y Fv(If)k(an)h
(indirect)g(enco)q(der)i(is)e(emitted,)f(the)h(order)h(of)e(the)i
(constructors)h(has)e(to)g(matc)o(h)129 1866 y(exactly)19
b(the)g(order)h(used)f(in)g Fr(emit_encoding_in)o(terf)o(ace)p
Fv(.)29 b(A)o(t)19 b(one)g(time)e(w)o(e)i(rear-)129 1916
y(ranged)13 b(things)f(to)g(put)h(t)o(yp)q(ed)g(constructors)h
(\014rst,)f(but)f(on)g(Marc)o(h)h(3,)f(1996,)f(w)o(e)i(decided)129
1966 y(there)j(w)o(as)d(no)h(go)q(o)q(d)g(reason)g(to)g(rearrange)h
(the)f(users')h(constructor)h(declarations.)-29 2028
y Fp(230c)88 b Fo(h)p Fn(emit)15 b(de)n(clar)n(ations)g(for)f(al)r(l)g
(of)h(the)g(kept)g(c)n(onstructors)g Fp(230c)p Fo(i)n(\021)312
b Fp(\(230a\))171 2078 y Fr(every)21 b(emit_proc_declar)o(ation)o
(\(pp,)d(kept_constructors\(\))o(\))129 2130 y Fp(Uses)12
b Fl(emit_proc_d)o(ecl)o(ar)o(ati)o(on)c Fp(212e)j(and)f
Fl(kept_constr)o(uct)o(ors)e Fp(33d.)p eop
%%Page: 231 231
231 230 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(encoding.nw)81 b Fv(231)-15 258 y Fp(231a)88 b Fo(h)p
Fn(*)15 b Fp(229)p Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5
b Fp(230a)22 b(232a)5 b Fm(.)187 307 y Fr(procedure)20
b(emit_indirect_en)o(coder)o(\(pp\))230 357 y(e)i(:=)f([])230
407 y(every)g(cons)g(:=)g(kept_constructors\(\))d(do)274
457 y(put\(e,)j(Cnoreserve\(cons)o(.name)o(\))e(||)i(",)h($o"\))230
507 y(c)g(:=)f(if)h(\\gen_counters)d(then)i(counter_names\(\))d(else)j
("")230 557 y(emit_template\(pp,)e("proc-structure.)o(t",)623
606 y("indirectname",)f(indirectname,)h("indirecttype",)g
(indirecttype,)623 656 y("encoders",)g(e,)j("counters",)d(c\))230
706 y(return)187 756 y(end)145 808 y Fp(De\014nes:)187
847 y Fl(emit_indir)o(ect)o(_e)o(nco)o(der)o Fp(,)9 b(used)h(in)i(c)o
(h)o(unks)d(232a)i(and)f(236a.)145 887 y(Uses)15 b Fl(Cnoreserv)o(e)c
Fp(337a,)i Fl(counter_nam)o(es)e Fp(234a,)h Fl(gen_counters)f
Fp(18a,)i Fl(indirectn)o(ame)e Fp(18a,)187 926 y Fl(indirectty)o(pe)d
Fp(18a,)j(and)f Fl(kept_constr)o(uct)o(ors)e Fp(33d.)-17
1017 y(231b)88 b Fo(h)p Fn(pr)n(o)n(c-structur)n(e.t)14
b Fp(231b)p Fo(i)n(\021)187 1067 y Fr(static)20 b(struct)h
(\045indirecttype)e(encoding_procs)g(=)i({$t\045encoders\045counter)o
(s$b)187 1117 y(};)187 1167 y(struct)f(\045indirecttype)f
(*\045indirectname)g(=)j(&encoding_procs;)145 1219 y
Fp(Uses)12 b Fl(indirectna)o(me)c Fp(18a)j(and)g Fl(indirectty)o(pe)d
Fp(18a.)208 1289 y Fv(Here's)15 b(some)e(old)g(co)q(de)-13
1351 y Fp(231c)88 b Fo(h)p Fn(pr)n(o)n(c-structur)n(e.t)14
b(\(se)n(gr)n(e)n(gate)n(d)g(version\))h Fp(231c)p Fo(i)o(\021)187
1401 y Fr(static)20 b(struct)h(\045indirecttype)e(encoding_procs)g(=)i
({$t\045typed\045untyped\045co)o(unter)o(s$b)187 1451
y(};)187 1501 y(struct)f(\045indirecttype)f(*\045indirectname)g(=)j
(&encoding_procs;)145 1553 y Fp(Uses)12 b Fl(indirectna)o(me)c
Fp(18a)j(and)g Fl(indirectty)o(pe)d Fp(18a.)-17 1636
y(231d)88 b Fo(h)p Fn(emit)15 b(de)n(clar)n(ations)f(for)h(al)r(l)f(of)
h(the)g(kept)g(c)n(onstructors)f(\(se)n(gr)n(e)n(gate)n(d)h(version\))g
Fp(231d)p Fo(i)n(\021)187 1686 y Fr(every)21 b(t)g(|)h(u)f(:=)h([])187
1735 y(every)f(cons)g(:=)g(kept_constructors)o(\(\))e(do)230
1785 y(put\(if)i(cons.type)f(===)h(instructionctype)e(then)h(u)i(else)f
(t,)g(cons\))274 1835 y(every)g(emit_proc_declar)o(ation)o(\(pp,)d(!t)k
(|)f(!u\))145 1887 y Fp(Uses)12 b Fl(emit_proc_)o(dec)o(lar)o(ati)o(on)
c Fp(212e,)i Fl(instruction)o(cty)o(pe)e Fp(32a,)j(and)g
Fl(kept_cons)o(tru)o(cto)o(rs)d Fp(33d.)p eop
%%Page: 232 232
232 231 bop 129 141 a Fv(232)83 b Fr(encoding.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(232a)88
b Fo(h)p Fn(*)16 b Fp(229)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(231a)22 b(233a)5 b Fm(.)171 307 y Fr(procedure)20
b(emit_encoding_imp)o(lemen)o(tatio)o(n\(ou)o(tfile)o(,)f
(interfacename,)g(basename\))215 357 y(verbose\("Emitti)o(ng)g
(encoding)h(implementation"\))215 407 y(pp)h(:=)g(PPnew\(outfile\))215
457 y(every)f(PPwrite\(pp,)g(pretty\(!header_li)o(nes\))o(\))215
507 y(PPwrite\(pp,)f("#include)h(<mclib.h>"\))215 557
y(PPwrite\(pp,)f("#include)h(",)h(image\(interfacename)o(\)\))215
606 y(PPwrite\(pp,)e("#define)h(sign_extend\(N,SIZE)o(\))f(\\\\"\))215
656 y(PPwrite\(pp,)g(")43 b(\(\(\(int\)\(\(N\))20 b(<<)h
(\(sizeof\(unsigned\)*8)o(-\(SIZ)o(E\)\)\)\))d(",)476
706 y(">>)j(\(sizeof\(unsigned\)*8)o(-\(SI)o(ZE\)\)\))o("\))215
806 y(pushtrace\("ASS")o(\))215 855 y(if)g(\\gen_counters)e(then)i
(declare_counters\()o(pp\))215 905 y Fo(h)p Fn(write)13
b(tag)i(de\014nitions)h(for)e(typ)n(e)n(d)h Fr(kept_constructors)d
Fp(232b)p Fo(i)215 955 y Fr(every)20 b(cons)h(:=)h(kept_constructor)o
(s\(\))d(do)i({)258 1005 y(verbose\("Encoder)e(for)i(constructor)e(",)j
(cons.name\))258 1055 y(PPwrite\(pp,)e("/**************)o("\))258
1104 y(show_constructor\(p)o(p,)f(cons\))258 1154 y(PPwrite\(pp,)h
("***********/"\))258 1204 y(if)i(cons.type)d(~===)i(instructionctype)e
(then)302 1254 y(emit_create_inst)o(ance_)o(body\()o(pp,)g(cons\))258
1304 y(else)302 1354 y(emit_emitter_bod)o(y\(pp,)f(cons\))215
1403 y(})215 1453 y(PPwrite\(pp\))63 b(#)21 b(flush)g(prettyprinter)215
1503 y(poptrace\(\))215 1553 y(if)g(\\gen_counters)e(then)i
(define_counter_fu)o(ns\(pp)o(\))215 1603 y(if)g(\\indirectname)e(then)
i(emit_indirect_enc)o(oder\()o(pp\))215 1652 y(emit_closure_fu)o(nctio)
o(ns_po)o(stfix)o(\(pp,)d(basename\))215 1702 y(return)171
1752 y(end)129 1804 y Fp(De\014nes:)171 1843 y Fl(emit_encod)o(ing)o
(_im)o(ple)o(me)o(nta)o(tio)o(n)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f
(229.)129 1883 y(Uses)17 b Fl(construct)o(or)c Fp(159,)i
Fl(declare_co)o(unt)o(ers)e Fp(234a,)h Fl(define_coun)o(ter)o(_f)o(uns)
f Fp(234a,)171 1922 y Fl(emit_closu)o(re_)o(fun)o(cti)o(on)o(s_p)o(ost)
o(fix)f Fp(226,)j Fl(emit_create)o(_in)o(sta)o(nce)o(_bo)o(dy)e
Fp(213b,)171 1962 y Fl(emit_emitt)o(er_)o(bod)o(y)g Fp(214a,)h
Fl(emit_indir)o(ect)o(_e)o(nco)o(der)e Fp(231a,)i Fl(gen_counter)o(s)f
Fp(18a,)171 2001 y Fl(header_lin)o(es)d Fp(20,)i Fl(indirectn)o(ame)d
Fp(18a,)j Fl(instructio)o(nct)o(ype)d Fp(32a,)j Fl(kept_const)o(ru)o
(cto)o(rs)e Fp(33d,)171 2041 y Fl(pretty)g Fp(18a,)g
Fl(show_const)o(ruc)o(tor)e Fp(233a,)i Fl(sign_extend)o
Fp(,)f(and)h Fl(verbose)g Fp(18a.)-33 2132 y(232b)88
b Fo(h)p Fn(write)14 b(tag)h(de\014nitions)h(for)e(typ)n(e)n(d)h
Fr(kept_constructors)c Fp(232b)p Fo(i)o(\021)263 b Fp(\(232a\))171
2182 y Fr(every)21 b(cons)g(:=)g(kept_constructors\()o(\))e(&)j
(cons.type)d(~===)i(instructionctype)e(do)215 2231 y(PPwrite\(pp,)g
("#define)h(",)i(cons.name,)d("_TAG)i(",)g(cons.tag\))129
2283 y Fp(Uses)12 b Fl(instruction)o(cty)o(pe)c Fp(32a)j(and)f
Fl(kept_constru)o(ct)o(ors)e Fp(33d.)p eop
%%Page: 233 233
233 232 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(encoding.nw)81 b Fv(233)-15 258 y Fp(233a)88 b Fo(h)p
Fn(*)15 b Fp(229)p Fo(i)p Fv(+)p Fo(\021)1033 b Fm(/)5
b Fp(232a)22 b(233b)5 b Fm(.)187 307 y Fr(procedure)20
b(show_constructor)o(\(pp,)e(cons\))230 357 y(PPwrite\(pp\))230
407 y(PPwrites\(pp,)i(cons.name,)f(")j("\))230 457 y(every)f(o)h(:=)f
(!cons.operands)e(do)274 507 y(case)i(type\(o\))f(of)i({)318
557 y("literal")d(:)j(PPwrites\(pp,)d(o.s\))318 606 y("input")63
b(:)22 b(PPwrites\(pp,)d(o.name,)732 656 y(if)i(type\(o.meaning\))e(==)
i("integer")f(then)h("!")g(else)g(""\))318 706 y(default)63
b(:)22 b(impossible\("operan)o(d"\))274 756 y(})230 806
y(PPxwrites\(pp,)d(")j(is)f($t${$c"\))230 855 y(PPxwrite\(pp,)f
(ppexpimage\(patte)o(rn_to)o(_case)o(\(crh)o(s\(con)o(s\)\)\),)e
("$}$b$n"\))230 905 y(return)187 955 y(end)145 1007 y
Fp(De\014nes:)187 1046 y Fl(show_const)o(ruc)o(to)o(r)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(232a.)145 1086 y(Uses)i
Fl(crhs)e Fp(168,)h Fl(input)f Fp(46a,)g Fl(literal)g
Fp(45e,)g Fl(pattern_to)o(_ca)o(se)e Fp(183b,)j(and)f
Fl(ppexpimage)e Fp(101d.)-17 1177 y(233b)88 b Fo(h)p
Fn(*)15 b Fp(229)p Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5
b Fp(233a)22 b(234a)5 b Fm(.)187 1227 y Fr(procedure)20
b(show_constype\(ou)o(tfile)o(,)f(type\))230 1277 y(write\(outfile\))
230 1327 y(l)j(:=)f([];)h(every)e(put\(l,)h(kept_constructors)o(\(typ)o
(e\).na)o(me\))230 1376 y(PPwrite\(pp,)f(type.name,)g(")h(\(",)g
(commaseparate\(l,)e(")i(|)h("\),)f("\):"\))230 1426
y(show_case\(outfile,)d(pattern_to_case\(cons)o(type)o(_patt)o(ern\(t)o
(ype\)\))o(\))230 1476 y(write\(outfile\))230 1526 y(return)187
1576 y(end)145 1628 y Fp(Uses)12 b Fl(constype_p)o(att)o(ern)c
Fp(171b,)i Fl(kept_constr)o(uc)o(tor)o(s)f Fp(33d,)h(and)h
Fl(pattern_to)o(_ca)o(se)d Fp(183b.)p eop
%%Page: 234 234
234 233 bop 129 141 a Fv(234)83 b Fr(encoding.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(234a)88
b Fo(h)p Fn(*)16 b Fp(229)p Fo(i)o Fv(+)p Fo(\021)1151
b Fm(/)5 b Fp(233b)171 307 y Fr(procedure)20 b(declare_counters\()o
(pp\))215 357 y(every)g(PPwrite\(pp,)g("static)g(int)h(",)h
(kept_constructor)o(s\(\).n)o(ame,)c("_ctr)j(=)h(0;"\))215
407 y(return)171 457 y(end)171 507 y(procedure)e(declare_counter_t)o
(ypes\()o(pp\))215 557 y(PPwrite\(pp,)f("typedef)h(void)h
(\(*Printer\)\(void)e(*closure,)h(char)h(*fmt,)g(...\);"\))215
606 y(return)171 656 y(end)171 706 y(procedure)f(declare_counter_f)o
(uns\(p)o(p\))215 756 y(c_function_decl)o(arati)o(on\(pp)o(,)f("void",)
h("reset_cons_counter)o(s",)f("\(void\)"\))215 806 y(c_function_decl)o
(arati)o(on\(pp)o(,)g("void",)h("dump_cons_counters)o(","\(P)o(rinte)o
(r)f(p,)i(void)g(*closure\)"\))215 855 y(return)171 905
y(end)171 955 y(procedure)f(counter_names\(\))215 1005
y(return)g("reset_cons_counte)o(rs,)f(dump_cons_count)o(ers,)f($o")171
1055 y(end)171 1104 y(procedure)i(define_counter_fu)o(ns\(pp)o(\))215
1154 y(PPxwrites\(pp,)f(if)i(\\indirectname)e(then)i("static)f(")i
(else)f("",)498 1204 y("void)g(reset_cons_count)o(ers\()o(void\))d
({$t"\))215 1254 y(every)i(PPxwrites\(pp,)f("$n",)i
(kept_constructors\()o(\).nam)o(e,)e("_ctr)i(=)g(0;"\))215
1304 y(PPxwrite\(pp,)e("$b$n}"\))215 1354 y(PPxwrites\(pp,)g(if)i
(\\indirectname)e(then)i("static)f(")i(else)f("",)541
1403 y("void)g(dump_cons_counters)o(\(Prin)o(ter)e(p,)i(void)g
(*closure\))f({$t"\))215 1453 y(every)g(cons)h(:=)h(kept_constructor)o
(s\(\))d(do)258 1503 y(PPxwrites\(pp,)g("$np\(closure,)g(\\"\045d)i(",)
h(cons.name,)d(")j(:)g(",)f Fo(h)p Fn(typ)n(e)15 b(of)g
Fr(cons)f Fp(234b)p Fo(i)o Fr(,)389 1553 y("\\\\n\\",)20
b(",)i(cons.name,)d("_ctr\);"\))215 1603 y(PPxwrite\(pp,)g("$b$n}"\))
171 1652 y(end)129 1704 y Fp(De\014nes:)171 1744 y Fl(counter_na)o(mes)
o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(231a.)171 1783 y
Fl(declare_co)o(unt)o(er_)o(fun)o(s)p Fp(,)e(used)j(in)g(c)o(h)o(unk)f
(230a.)171 1823 y Fl(declare_co)o(unt)o(ers)o Fp(,)f(used)h(in)i(c)o(h)
o(unk)d(232a.)171 1862 y Fl(declare_co)o(unt)o(er_)o(typ)o(es)o
Fp(,)g(used)i(in)g(c)o(h)o(unk)f(230a.)171 1901 y Fl(define_cou)o(nte)o
(r_f)o(uns)o Fp(,)f(used)h(in)h(c)o(h)o(unk)f(232a.)129
1941 y(Uses)i Fl(c_function_)o(dec)o(la)o(rat)o(ion)c
Fp(338b,)i Fl(indirectnam)o(e)f Fp(18a,)h(and)h Fl(kept_cons)o(tru)o
(cto)o(rs)d Fp(33d.)-33 2032 y(234b)88 b Fo(h)p Fn(typ)n(e)16
b(of)e Fr(cons)g Fp(234b)p Fo(i)o(\021)960 b Fp(\(234a\))171
2082 y Fr(\(if)21 b(cons.type)f(===)h(instructionctype)e(then)i
("<instruction>")d(else)j(cons.type.name\))129 2134 y
Fp(Uses)12 b Fl(instruction)o(cty)o(pe)c Fp(32a.)p eop
%%Page: 235 235
235 234 bop 145 569 a Fq(Chapter)32 b(10)145 777 y Fu(Managing)40
b(generation)f(of)145 901 y(assem)m(bly)f(enco)s(ders)145
1117 y Fv(W)m(e)13 b(can)f(reuse)j(the)e(enco)q(ding)g(in)o(terface,)g
(since)g(the)h(assem)o(bly)d(stu\013)j(is)e(an)h(implem)o(en)o(ta-)145
1167 y(tion)h(of)f(it.)-15 1229 y Fp(235a)88 b Fo(h)p
Fn(*)15 b Fp(235a)p Fo(i)o(\021)1167 b Fp(236a)5 b Fm(.)187
1279 y Fr(link)21 b(pretty)187 1329 y(procedure)f(emit_assembly\(ou)o
(tfile)o(name\))230 1378 y(local)h(i,)h(f)230 1428 y
(verbose\("Emitting)d(encoding)h(interface"\))230 1478
y(emit_encoding_inter)o(face\()o(openf)o(ile\(i)e(:=)k(outfilename)d
(||)i(interface_extension)o(,)e("w"\)\))i(|)274 1528
y(error\("Could)e(not)i(open)g(",)h(image\(i\),)e(")h(for)g(writing"\))
230 1578 y(verbose\("Emitting)e(assembly)h(procedures"\))230
1628 y(emit_assembly_imple)o(menta)o(tion\()383 1677
y(openfile\(f)g(:=)h(outfilename)f(||)h(implementation_ex)o(tensi)o
(on,)e("w"\),)h(i\))i(|)274 1727 y(error\("Could)d(not)i(open)g(",)h
(image\(f\),)e(")h(for)g(writing"\))187 1777 y(end)145
1829 y Fp(De\014nes:)187 1868 y Fl(emit_assem)o(bly)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(20.)145 1908 y(Uses)17
b Fl(emit_asse)o(mbl)o(y_i)o(mpl)o(em)o(ent)o(ati)o(on)c
Fp(236a,)i Fl(emit_encod)o(in)o(g_i)o(nte)o(rfa)o(ce)e
Fp(230a,)187 1947 y Fl(implementa)o(tio)o(n_)o(ext)o(ens)o(ion)c
Fp(18a,)j Fl(interface_)o(ext)o(en)o(sio)o(n)e Fp(18a,)i
Fl(openfile)e Fp(24,)i Fl(pretty)f Fp(18a,)187 1987 y(and)f
Fl(verbose)g Fp(18a.)208 2049 y Fv(Here's)15 b(the)f(template)f(that)h
(b)q(egins)g(all)f(assem)o(bly)g(implem)o(en)o(tations:)-17
2111 y Fp(235b)88 b Fo(h)p Fn(assembly-impl.t)14 b Fp(235b)p
Fo(i)o(\021)187 2161 y Fr(#include)20 b(<mclib.h>)187
2211 y(#include)g(\045interface)187 2310 y(#define)g
(sign_extend\(N,SIZE)o(\))f(\\)230 2360 y(\(\(\(int\)\(\(N\))h(<<)h
(\(sizeof\(unsigned\)*8)o(-\(SIZ)o(E\)\)\))o(\))e(>>)i
(\(sizeof\(unsigned\)*8-)o(\(SIZ)o(E\)\)\))145 2462 y
Fp(Uses)12 b Fl(sign_exten)o(d)p Fp(.)830 2604 y Fv(235)p
eop
%%Page: 236 236
236 235 bop 129 141 a Fv(236)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(This)j(next)h
(should)f(probably)g(b)q(e)h(turned)h(in)o(to)e(something)f
(higher-order)i(at)f(some)129 307 y(p)q(oin)o(t.)k(W)m(e)14
b(reuse)i(the)f(same)f(implemen)o(tations)e(of)i(t)o(yp)q(ed)h
(constructors)h(to)f(bundle)f(up)129 357 y(their)j(argumen)o(ts.)25
b(W)m(e)17 b(also)e(create)j(a)f(lo)q(cal)e(pro)q(cedure)k(w)o(e)d(can)
h(call)f(for)g(eac)o(h)h(t)o(yp)q(ed)129 407 y(constructor)f(to)e(emit)
e(is)i(assem)o(bly)f(co)q(de.)-31 469 y Fp(236a)88 b
Fo(h)p Fn(*)16 b Fp(235a)p Fo(i)n Fv(+)q Fo(\021)1017
b Fm(/)5 b Fp(235a)22 b(238a)5 b Fm(.)171 519 y Fr(procedure)20
b(emit_assembly_imp)o(lemen)o(tatio)o(n\(ou)o(tfile)o(,)f
(interfacename\))215 569 y(pp)i(:=)g(PPnew\(outfile\))215
619 y(every)f(PPwrite\(pp,)g(pretty\(!header_li)o(nes\))o(\))215
669 y(emit_template\(p)o(p,)f("assembly-impl.t")o(,)g("interface",)g
(image\(interfacenam)o(e\)\))215 768 y(pushtrace\("ASS")o(\))215
818 y Fo(h)p Fn(write)13 b(tag)i(de\014nitions)h(for)e(typ)n(e)n(d)h
Fr(kept_constructors)d Fp(236b)p Fo(i)215 868 y Fr(every)20
b(cons)h(:=)h(kept_constructor)o(s\(\))d(do)i({)258 918
y(verbose\("Assembler)d(for)j(",)h(cons.name\))258 967
y(if)g(cons.type)d(~===)i(instructionctype)e(then)302
1017 y(emit_create_inst)o(ance_)o(body\()o(pp,)g(cons\))258
1067 y(emit_assembler_bod)o(y\(pp,)f(cons\))215 1117
y(})215 1167 y(PPwrite\(pp\))63 b(#)21 b(flush)g(prettyprinter)215
1217 y(if)g(\\gen_counters)e(then)258 1266 y(emit_counter_funs\()o
(outfi)o(le\))215 1316 y(poptrace\(\))215 1366 y(if)i(\\indirectname)e
(then)i(emit_indirect_enc)o(oder\()o(pp\))215 1416 y(return)171
1466 y(end)129 1518 y Fp(De\014nes:)171 1557 y Fl(emit_assem)o(bly)o
(_im)o(ple)o(me)o(nta)o(tio)o(n)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f
(235a.)129 1596 y(Uses)19 b Fl(emit_assemb)o(ler)o(_bo)o(dy)c
Fp(246,)j Fl(emit_create)o(_i)o(nst)o(anc)o(e_b)o(ody)d
Fp(213b,)171 1636 y Fl(emit_indir)o(ect)o(_en)o(cod)o(er)9
b Fp(231a,)i Fl(gen_counter)o(s)e Fp(18a,)j Fl(header_lin)o(es)d
Fp(20,)j Fl(indirectna)o(me)d Fp(18a,)171 1675 y Fl(instructio)o(nct)o
(ype)f Fp(32a,)i Fl(kept_constru)o(ct)o(ors)e Fp(33d,)j
Fl(pretty)e Fp(18a,)i(and)f Fl(verbose)g Fp(18a.)-33
1758 y(236b)88 b Fo(h)p Fn(write)14 b(tag)h(de\014nitions)h(for)e(typ)n
(e)n(d)h Fr(kept_constructors)c Fp(236b)p Fo(i)o(\021)263
b Fp(\(236a\))171 1808 y Fr(every)21 b(cons)g(:=)g(kept_constructors\()
o(\))e(&)j(cons.type)d(~===)i(instructionctype)e(do)215
1858 y(PPwrite\(pp,)g("#define)h(",)i(cons.name,)d("_TAG)i(",)g
(cons.tag\))129 1910 y Fp(Uses)12 b Fl(instruction)o(cty)o(pe)c
Fp(32a)j(and)f Fl(kept_constru)o(ct)o(ors)e Fp(33d.)p
eop
%%Page: 237 237
237 236 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(237)145 258 y Fj(10.1)66 b(Name)21
b(mapping)145 349 y Fv(And)e(no)o(w)g(w)o(e)g(start)g(in)f(with)h(name)
f(mapping)e(o-rama.)31 b(The)19 b(game)e(here)j(is)f(to)g(use)145
398 y(separate)c(mappings)c(for)i(ev)o(ery)h(p)q(ossible)g(comp)q(onen)
o(t)e(of)h(a)g(constructor.)19 b(By)14 b(p)q(ostulat-)145
448 y(ing)f(these)j(mappings)c(no)o(w,)h(w)o(e)h(separate)h(concerns,)g
(so)f(that)g(w)o(e)g(can)g(w)o(orry)f(elsewhere)145 498
y(ab)q(out)h(ho)o(w)g(they)g(are)g(de\014ned.)208 548
y(As)f(part)g(of)f(planning)g(the)i(mappings,)c(w)o(e)k(need)f(to)g
(think)g(ab)q(out)g(ho)o(w)f(w)o(e)h(w)o(an)o(t)g(the)145
598 y(co)q(de)h(organized)g(at)f(run)g(time.)k(In)c(particular,)f(w)o
(e)i(need)g(to)f(think)g(ab)q(out)g(where)h(to)g(use)145
647 y(sp)q(ecialized)e(prin)o(t)g(pro)q(cedures)h(and)f(where)g(to)f
(use)i(simple)d(format)f(strings.)18 b(W)m(e)11 b(assume)145
697 y(that)i(if)f(p)q(eople)h(w)o(an)o(t)f(sp)q(eed,)i(they'll)e(b)q(e)
h(emitting)e(binary)m(,)h(not)g(assem)o(bly)g(language,)f(so)145
747 y(for)i(simplicit)o(y)d(w)o(e)j(use)h(lots)f(and)f(lots)h(of)f(pro)
q(cedures.)20 b(W)m(e)13 b(ha)o(v)o(e)f(a)h(pro)q(cedure)i(for)d(eac)o
(h:)208 830 y Fo(\017)20 b Fv(\014eld)208 913 y Fo(\017)g
Fv(constructor)208 996 y Fo(\017)g Fv(constructor)c(t)o(yp)q(e)145
1079 y(W)m(e)f(try)h(to)g(reuse)h(\014eld)f(pro)q(cedures)h(where)g(p)q
(ossible.)24 b(The)16 b(application)e(m)o(ust)g(supply)145
1129 y(a)20 b(prin)o(t)f(pro)q(cedure)j Fr(asmprintf)c
Fv(in)h(the)i(st)o(yle)f(of)f Fr(fprintf)p Fv(,)g(and)h(also)f(a)g(pro)
q(cedure)145 1179 y Fr(asmprintreloc)p Fv(,)11 b(whic)o(h)j(prin)o(ts)g
(a)f(relo)q(catable)i(address.)208 1229 y(W)m(e're)g(going)f(to)i
(create)h(these)g(pro)q(cedures)h(lazily)m(.)j(The)16
b(\014eld-prin)o(ting)e(pro)q(cedure)145 1278 y(is)g(o\013)g(in)f(the)i
Fr(fieldinfo.nw)c Fv(mo)q(dule.)208 1393 y(The)j(mappings)e(are:)590
1317 y Fr(consname2asm)157 b Fv(constructor)15 b(names)590
1367 y Fr(field_asm_syntax)69 b Fv(\014eld)14 b(op)q(erands)590
1417 y Fr(intarg_asm_syntax)47 b Fv(non-\014eld)13 b(in)o(teger)i(op)q
(erands)590 1467 y(???)361 b(what)13 b(else?)p eop
%%Page: 238 238
238 237 bop 129 141 a Fv(238)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Ft(10.1.1)56
b(Mapping)19 b(constructor)f(names)129 334 y Fv(Use)g(the)f(mapping)d
(for)j(constructor's)h(complete)e(name,)f(if)h(it)g(exists.)27
b(Otherwise,)18 b(w)o(e)129 384 y(break)13 b(the)h(constructor)g(name)d
(in)o(to)h(its)g(comp)q(onen)o(ts)h(and)f(matc)o(h)f(the)i(individual)e
(com-)129 434 y(p)q(onen)o(ts.)19 b(W)m(e)14 b(nev)o(er)g(use)h
(full-name)c(mapping)h(and)i(comp)q(onen)o(t)o(wise)f(mapping)e(on)j
(the)129 484 y(same)f(constructor)j(name.)-31 546 y Fp(238a)88
b Fo(h)p Fn(*)16 b Fp(235a)p Fo(i)n Fv(+)q Fo(\021)1015
b Fm(/)5 b Fp(236a)23 b(238b)t Fm(.)171 596 y Fr(procedure)d
(consname2asm\(cons)o(\))215 646 y(local)g(n,)i(x,)f(cname)215
695 y(n)g(:=)h("")215 745 y(cname)e(:=)i("")215 795 y(every)e(cname)h
(||:=)g(opcode_component_n)o(ame\()o(!cons)o(.opco)o(de\))215
845 y(x)g(:=)h(map_fullname\(cn)o(ame\))215 895 y(pushtrace\("GLOB)o
("\))215 944 y(if)f(\(\\x\))g(then)258 994 y(n)h(:=)f(if)g
(\(\\lowercons\))f(then)h(map\(x\))f(else)h(x)215 1044
y(else)258 1094 y(every)g(x)g(:=)h(map_component\(opc)o(ode_c)o(ompo)o
(nent_)o(name\()o(!cons)o(.opco)o(de\),)c(cons.type\))i(do)302
1144 y(n)h(||:=)g(if)h(\(\\lowercons\))d(then)i(map\(x\))f(else)h(x)215
1194 y(poptrace\(\))215 1243 y(return)f(if)h(cons.type)f(===)i
(instructionctyp)o(e)d(|)j(*n)f(>)h(0)f(then)411 1293
y(if)g(/postfix)f(then)h(\(if)g(!asmoperands\(cons\))d(then)j(n)h(||)f
(")h(")43 b(else)21 b(n\))411 1343 y(else)282 b(")22
b(")f(||)h(n)367 1393 y(else)f("")171 1443 y(end)129
1495 y Fp(De\014nes:)171 1534 y Fl(consname2a)o(sm)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(246)g(and)h(254.)129
1573 y(Uses)j Fl(asmoperands)c Fp(243a,)i Fl(instructio)o(nct)o(ype)e
Fp(32a,)i Fl(lowercons)f Fp(18a,)h Fl(map_compone)o(nt)e
Fp(238b,)171 1613 y Fl(map_fullna)o(me)e Fp(238b,)j Fl(opcode_co)o(mpo)
o(nen)o(t_)o(nam)o(e)e Fp(164b,)h(and)g Fl(postfix)g
Fp(16f.)192 1675 y Fv(W)m(e)j(map)f(the)j(individual)d(comp)q(onen)o
(ts)h(b)o(y)h(op)q(co)q(de)h(globbing.)-33 1737 y Fp(238b)88
b Fo(h)p Fn(*)16 b Fp(235a)p Fo(i)n Fv(+)q Fo(\021)1017
b Fm(/)5 b Fp(238a)22 b(239a)5 b Fm(.)171 1787 y Fr(global)21
b(opcode_globs,)e(opcode_full)171 1837 y(procedure)h
(map_fullname\(name)o(\))215 1887 y(initial)g(/opcode_full)f(:=)j([])
215 1937 y(return)e(globmap\(name,)f(!opcode_full\))g(|)j(&null)171
1986 y(end)171 2036 y(procedure)e(map_component\(nam)o(e,)f(type\))215
2086 y(initial)h(/opcode_globs)f(:=)i([])215 2136 y(return)f
(globmap\(name,)f(!opcode_globs\))g(|)j(if)f(type)g(===)g
(instructionctype)e(then)i(name)g(else)g("")171 2186
y(end)129 2238 y Fp(De\014nes:)171 2277 y Fl(map_compon)o(ent)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(238a.)171 2316 y Fl(map_fullna)o(me)
p Fp(,)e(used)j(in)g(c)o(h)o(unk)f(238a.)171 2356 y Fl(opcode_ful)o(l)p
Fp(,)f(used)h(in)h(c)o(h)o(unk)f(239a.)171 2395 y Fl(opcode_glo)o(bs)p
Fp(,)e(used)j(in)g(c)o(h)o(unk)f(239a.)129 2435 y(Uses)i
Fl(globmap)d Fp(239b)i(and)f Fl(instruction)o(cty)o(pe)e
Fp(32a.)p eop
%%Page: 239 239
239 238 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(239)208 258 y(And)14 b(\014nally)m(,)d(here's)
k(where)g(w)o(e)g(install)d(the)j(globs.)-15 320 y Fp(239a)88
b Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p Fo(\021)1014
b Fm(/)5 b Fp(238b)22 b(239b)5 b Fm(.)187 370 y Fr(record)20
b(globpair\(lhs,)f(rhs\))187 420 y(procedure)h(asmopcode\(lhs,)f(rhs,)i
(full\))230 469 y(initial)g({)g(/opcode_globs)e(:=)j([])448
519 y(/opcode_full)e(:=)h([])405 569 y(})230 619 y(put\(if)g
(\(\\full\))f(then)h(opcode_full)f(else)h(opcode_globs,)e
(globpair\(lhs,)g(rhs\)\))230 669 y(return)187 718 y(end)145
770 y Fp(De\014nes:)187 810 y Fl(asmopcode)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unk)f(52c.)145 849 y(Uses)i Fl(opcode_ful)o(l)d
Fp(238b)h(and)h Fl(opcode_glo)o(bs)d Fp(238b.)208 911
y Fv(And)14 b(no)o(w,)f(the)h(implemen)o(tation)c(of)k(globbing.)-17
974 y Fp(239b)88 b Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o
Fv(+)p Fo(\021)1020 b Fm(/)5 b Fp(239a)22 b(239c)5 b
Fm(.)187 1024 y Fr(procedure)20 b(globmap\(name,)f(glob\))230
1073 y(l)j(:=)f([])65 b(#)22 b(used)f(for)g($n)230 1123
y(name)g(?)274 1173 y(if)g(consume_globs\(glob.)o(lhs,)d(l\))k(&)f
(pos\(0\))g(then)318 1223 y(return)f(insert_glob_matche)o(s\(glo)o
(b.rhs)o(,)f(l\))187 1273 y(end)145 1324 y Fp(De\014nes:)187
1364 y Fl(globmap)p Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(238b.)145
1403 y(Uses)i Fl(consume_gl)o(obs)c Fp(239c,)i Fl(insert_glob)o(_ma)o
(tch)o(es)e Fp(240c,)i(and)h Fl(used)f Fp(136a.)-13 1486
y(239c)88 b Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p
Fo(\021)1014 b Fm(/)5 b Fp(239b)22 b(240b)5 b Fm(.)187
1536 y Fr(procedure)20 b(consume_globs\(pa)o(t,)f(dollars,)h(i\))230
1586 y(suspend)h(case)g(type\(pat\))f(of)h({)274 1636
y("glob_any")f(:)h({)339 1686 y(while)g(*dollars)f(<)i(pat.number)e(do)
h(put\(dollars,)e(&null\))339 1735 y(dollars[pat.number])f(<-)k
(consume_globs\(!)o(pat.a)o(ltern)o(ative)o(s,)d(dollars\))274
1785 y(})274 1835 y("glob_wildcard")g(:)i(tab\(&pos)f(to)i(*&subject)e
(+)h(1\))274 1885 y("list")217 b(:)21 b({)p Fo(h)p Fn(glob)15
b(a)g(c)n(onc)n(atenation)h Fp(240a)p Fo(i)o Fr(})274
1935 y("string")173 b(:)21 b(=pat)274 1985 y(default)195
b(:)21 b(impossible\("glob)e(pattern"\))230 2034 y(})187
2084 y(end)145 2136 y Fp(De\014nes:)187 2175 y Fl(consume_gl)o(obs)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(239b)h(and)f(240a.)145
2215 y(Uses)i Fl(glob_any)d Fp(53a,)h Fl(glob_wildca)o(rd)f
Fp(53a,)h(and)h Fl(pattern)e Fp(55.)p eop
%%Page: 240 240
240 239 bop 129 141 a Fv(240)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(240a)88
b Fo(h)p Fn(glob)15 b(a)h(c)n(onc)n(atenation)g Fp(240a)p
Fo(i)n(\021)818 b Fp(\(239c\))171 307 y Fr(/i)21 b(:=)h(1)171
357 y(if)f(pat[i])g(then)215 407 y(consume_globs\(p)o(at[i])o(,)e
(dollars\))h(||)i(consume_globs\(p)o(at,)d(dollars,)h(i+1\))171
457 y(else)215 507 y("")129 559 y Fp(Uses)12 b Fl(consume_glo)o(bs)c
Fp(239c.)-33 650 y(240b)88 b Fo(h)p Fn(*)16 b Fp(235a)p
Fo(i)n Fv(+)q Fo(\021)1021 b Fm(/)5 b Fp(239c)22 b(240c)5
b Fm(.)171 700 y Fr(procedure)20 b(number_braces\(pat)o(\))215
750 y(do_number_brace)o(s\(pat)o(,)f(0\))215 799 y(return)h(pat)171
849 y(end)171 949 y(procedure)g(do_number_braces\()o(pat,)e
(bracecount\))215 999 y(case)j(type\(pat\))e(of)j({)258
1048 y("glob_any")129 b(:)21 b({)h(pat.number)e(:=)h(bracecount)f(+:=)h
(1)694 1098 y(bracecount)f(:=)h(do_number_braces\(p)o(at.al)o(terna)o
(tive)o(s,)e(bracecount\))650 1148 y(})258 1198 y("glob_wildcard")g(:)i
(&null)258 1248 y("list")217 b(:)21 b(every)g(i)h(:=)f(1)h(to)f(*pat)g
(do)694 1297 y(bracecount)f(:=)h(do_number_braces\(p)o(at[i])o(,)e
(bracecount\))258 1347 y("string")173 b(:)21 b(&null)258
1397 y(default)195 b(:)21 b(impossible\("glob)e(pattern:)h(",)h
(image\(pat\)\))215 1447 y(})215 1497 y(return)f(bracecount)171
1547 y(end)129 1598 y Fp(De\014nes:)171 1638 y Fl(number_bra)o(ces)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(53c.)129 1677 y(Uses)i
Fl(glob_any)d Fp(53a,)i Fl(glob_wild)o(car)o(d)e Fp(53a,)h(and)h
Fl(pattern)e Fp(55.)-29 1769 y(240c)88 b Fo(h)p Fn(*)16
b Fp(235a)p Fo(i)n Fv(+)q Fo(\021)1015 b Fm(/)5 b Fp(240b)22
b(241a)5 b Fm(.)171 1818 y Fr(procedure)20 b(insert_glob_match)o
(es\(rh)o(s,)f(dollars\))215 1868 y(s)i(:=)h("")215 1918
y(every)e(x)i(:=)f(!rhs)g(do)258 1968 y(s)h(||:=)f(case)g(type\(x\))f
(of)h({)302 2018 y("string")129 b(:)21 b(x)302 2068 y("glob_dollar")e
(:)i(\\dollars[x.number])d(|)694 2117 y(error\("No)i(match)h(for)g($",)
g(x.number,)f(")i(in)f(`",)g(grhsimage\(rhs\),)e("'"\))302
2167 y(default)h(:)i(impossible\("glob)c(rhs"\))258 2217
y(})215 2267 y(return)i(s)171 2317 y(end)129 2368 y Fp(De\014nes:)171
2408 y Fl(insert_glo)o(b_m)o(atc)o(hes)o Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(239b.)129 2447 y(Uses)i Fl(glob_dollar)c Fp(53a)j(and)f
Fl(grhsimage)f Fp(241a.)p eop
%%Page: 241 241
241 240 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(241)-15 258 y Fp(241a)88 b Fo(h)p
Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5
b Fp(240c)22 b(241b)5 b Fm(.)187 307 y Fr(procedure)20
b(grhsimage\(rhs\))230 357 y(s)i(:=)f("")230 407 y(every)g(x)h(:=)f
(!rhs)g(do)274 457 y(s)h(||:=)f(case)f(type\(x\))h(of)g({)318
507 y("string")129 b(:)21 b(x)318 557 y("glob_dollar")e(:)i("$")g(||)h
(x.number)318 606 y(default)e(:)h(impossible\("glob)e(rhs"\))274
656 y(})230 706 y(return)i(s)187 756 y(end)145 808 y
Fp(De\014nes:)187 847 y Fl(grhsimage)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(240c.)145 887 y(Uses)i Fl(glob_dolla)o(r)d Fp(53a.)145
1023 y Ft(10.1.2)56 b(Mapping)19 b(op)r(erands)145 1100
y Fv(First,)g(w)o(e're)f(only)f(allo)o(w)o(ed)g(to)h(map)e(in)o(tegers)
j(and)e(\014elds,)i(not)f(relo)q(catables)g(or)g(con-)145
1150 y(structor)e(t)o(yp)q(es.)-17 1212 y Fp(241b)88
b Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p Fo(\021)1016
b Fm(/)5 b Fp(241a)22 b(242d)5 b Fm(.)187 1262 y Fr(record)20
b(operand_syntax\(synt)o(ax,)f(nametable\))230 1312 y(#)j(syntax)f
(string,)f(optional)g(name)h(table,)g(optional)f(bound)g(on)i(values)e
(\(max+1\))187 1411 y(global)g(operand_syntax_tab)187
1511 y(procedure)g(asmoperand\(name,)e(syntax,)j(names\))230
1561 y(local)g(nametable)230 1611 y(initial)g(/operand_syntax_)o(tab)e
(:=)i(table\(\))230 1661 y Fo(h)p Fn(insist)15 b(that)g
Fr(name)f Fn(not)h(r)n(efer)f(to)h(a)g(c)n(onstructor)f(typ)n(e)h(or)g
(r)n(elo)n(c)n(atable)f Fp(242b)p Fo(i)230 1710 y(h)p
Fn(set)h Fr(nametable)e Fn(to)i(the)g(name)g(table,)g(che)n(cking)g
(for)g(c)n(onsistency)g Fp(242a)p Fo(i)230 1760 y(h)p
Fn(insist)g(on)g(names)h(if)e Fr(\045s)g Fn(is)h(use)n(d)g
Fp(242c)p Fo(i)230 1810 y Fr(\(return)21 b(/operand_syntax_)o(tab[n)o
(ame])d(:=)k(operand_syntax\(s)o(yntax)o(,)d(nametable\)\))g(|)296
1860 y(error\("Operand)g(syntax)h(for)h(",)h(name,)f(")g(already)f
(specified"\))187 1910 y(end)145 1961 y Fp(De\014nes:)187
2001 y Fl(asmoperand)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(52c.)187
2040 y Fl(operand_sy)o(nta)o(x)p Fp(,)f(used)j(in)g(c)o(h)o(unks)f
(242d)g(and)h(250a.)187 2080 y Fl(operand_sy)o(nta)o(x_)o(tab)o
Fp(,)e(used)h(in)i(c)o(h)o(unk)e(242d.)145 2119 y(Uses)i
Fl(max)f Fp(410.)p eop
%%Page: 242 242
242 241 bop 129 141 a Fv(242)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(242a)88
b Fo(h)p Fn(set)15 b Fr(nametable)e Fn(to)i(the)g(name)h(table,)e(che)n
(cking)h(for)g(c)n(onsistency)g Fp(242a)p Fo(i)o(\021)129
b Fp(\(241b\))171 307 y Fr(if)21 b(type\(names\))f(==)h("field")g(then)
215 357 y(names)f(:=)i(namespec\(\\fieldn)o(ame_t)o(able\()o(name)o
(s\)\))d(|)476 407 y(error\("No)h(names)h(supplied)f(for)h(field)g(",)g
(ii2\))171 457 y(nametable)f(:=)215 507 y(if)h(type\(f)f(:=)i
(symtab[name]\))d(==)i("field")g(then)g({)258 557 y(/names)g(:=)g
(namespec\(\\fieldnam)o(e_tab)o(le\(f)o(\)\))41 b(#)21
b(use)g(default)g(names)g(if)g(none)g(given)258 606 y
(check_namespec\(\\na)o(mes,)d(f\))215 656 y(})j(else)258
706 y(\(\\names\).nametable)171 756 y(if)g(\\names)g(&)g(/nametable)f
(then)h(impossible\("name)e(table:)h(",)i(image\(names\)\))129
808 y Fp(Uses)16 b Fl(check_names)o(pec)c Fp(355d,)i
Fl(field)g Fp(55,)h Fl(fieldname_)o(tab)o(le)e Fp(356a,)h
Fl(namespec)f Fp(355a,)171 847 y(and)e Fl(symtab)e Fp(32a)i(367.)-33
938 y(242b)88 b Fo(h)p Fn(insist)15 b(that)g Fr(name)f
Fn(not)h(r)n(efer)f(to)h(a)g(c)n(onstructor)f(typ)n(e)h(or)g(r)n(elo)n
(c)n(atable)f Fp(242b)p Fo(i)n(\021)89 b Fp(\(241b\))171
988 y Fr(if)21 b(type\(symtab[name]\))d(==)k(\("constype")d(|)j
("relocatable"\))d(then)215 1038 y(error\("You)g(may)i(specify)g(an)g
(operand)g(syntax)f(only)h(for)g(integer)g(or)g(field)g(operands"\))129
1090 y Fp(Uses)12 b Fl(constype)d Fp(159,)i Fl(field)f
Fp(55,)g Fl(relocatable)e Fp(47a,)j(and)f Fl(symtab)g
Fp(32a)h(367.)-29 1181 y(242c)88 b Fo(h)p Fn(insist)15
b(on)g(names)h(if)e Fr(\045s)h Fn(is)f(use)n(d)h Fp(242c)p
Fo(i)o(\021)664 b Fp(\(241b\))171 1231 y Fr(if)21 b(/nametable)f(&)i
(!percent_split\(s)o(yntax)o(\))d(==)i("\045s")g(then)215
1281 y(error\("You)e(used)i(\045s)h(to)f(format)g(operand)f(",)h(name,)
g(",)g(but)h(you)f(gave)g(no)g(name)g(specifier"\))129
1333 y Fp(Uses)12 b Fl(percent_spl)o(it)c Fp(251a)j(and)f
Fl(used)h Fp(136a.)192 1403 y Fv(T)m(o)16 b(implemen)o(t)e(lo)q(okup,)i
(w)o(e)i(m)o(ust)d(pro)o(vide)i(suitable)g(defaults.)27
b(The)17 b(only)g(tric)o(ky)129 1453 y(case)e(is)f(that)g(w)o(e)g(use)h
(a)e(\014eld's)h(name)f(if)g(it)h(exists,)g(otherwise)h(not.)-33
1515 y Fp(242d)88 b Fo(h)p Fn(*)16 b Fp(235a)p Fo(i)n
Fv(+)q Fo(\021)1015 b Fm(/)5 b Fp(241b)22 b(243a)5 b
Fm(.)171 1565 y Fr(procedure)20 b(operand_syntax_of)o(\(ipt\))215
1615 y(initial)g(/operand_syntax_t)o(ab)f(:=)i(table\(\))215
1665 y(return)f(\\operand_syntax_ta)o(b[ipt)o(.name)o(])f(|)258
1715 y(case)i(type\(ipt.meaning\))d(of)k({)302 1764 y("null")86
b(:)21 b(operand_syntax\("\045d")o(\))62 b(#)22 b(integer)302
1814 y("integer")e(:)h(operand_syntax\("\045d")o(\))62
b(#)22 b(signed)f(field)302 1864 y("field")64 b(:)21
b({)h(n)f(:=)h(fieldname_table\()o(symta)o(b[ipt)o(.name)o(]\))607
1914 y(operand_syntax\(if)c(\\n)j(then)g("\045s")g(else)g("\045u",)g
(n\))563 1964 y(})302 2014 y(default)64 b(:)21 b(impossible\("violate)o
(d)e(default)h(syntax)h(invariant"\))258 2063 y(})171
2113 y(end)129 2165 y Fp(De\014nes:)171 2205 y Fl(operand_sy)o(nta)o
(x_o)o(f)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(247.)129
2244 y(Uses)j Fl(field)e Fp(55,)h Fl(fieldname_)o(tab)o(le)d
Fp(356a,)j Fl(operand_s)o(ynt)o(ax)d Fp(241b,)j Fl(operand_s)o(ynt)o
(ax_)o(ta)o(b)e Fp(241b,)171 2283 y(and)h Fl(symtab)e
Fp(32a)i(367.)129 2433 y Fj(10.2)66 b(Assem)n(bly)23
b(syn)n(tax)g(of)f(constructors)p eop
%%Page: 243 243
243 242 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(243)208 258 y(Next,)20 b(the)f(syn)o(tax)g(ma)
o(y)e(b)q(e)j(giv)o(en)e(b)o(y)h(an)f Fr(asmsyntax)f
Fv(directiv)o(e,)j(or)f(it)g(ma)o(y)e(b)q(e)145 307 y(tak)o(en)d(from)e
(the)j(original)d(declaration.)-15 370 y Fp(243a)88 b
Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p Fo(\021)1014
b Fm(/)5 b Fp(242d)22 b(244b)5 b Fm(.)187 420 y Fr(global)20
b(asmsyntax)187 469 y(procedure)g(set_asmsyntax\(co)o(ns,)f(operands\))
230 519 y(local)i(oldoperands)230 569 y(initial)g(/asmsyntax)e(:=)j
(table\(\))230 619 y Fo(h)p Fn(insist)15 b(that)g Fr(operands)e
Fn(and)j(op)n(er)n(ands)f(of)g Fr(cons)f Fn(have)h(the)g(same)g(names)h
Fp(243b)p Fo(i)230 669 y(h)p Fn(insist)f(that)g Fr(operands)e
Fn(and)j(op)n(er)n(ands)f(of)g Fr(cons)f Fn(have)h(the)g(same)g(signe)n
(d)g(op)n(er)n(ands)h Fp(243c)p Fo(i)230 718 y Fr(\(/asmsyntax[cons])j
(:=)i(operands\))f(|)274 768 y({)p Fo(h)p Fr(operands)13
b Fn(matches)i(existing)g(assembly)g(syntax)h(for)e Fr(cons)g
Fp(244a)p Fo(i)o Fr(})21 b(|)274 818 y(error\("Conflictin)o(g)e
(assembly)h(syntax)h(already)f(given)h(for)g(constructor)f(",)h
(cons.name\))230 868 y(return)187 918 y(end)187 1017
y(procedure)f(asmoperands\(cons)o(\))230 1067 y(initial)h(/asmsyntax)e
(:=)j(table\(\))230 1117 y(return)f(\\asmsyntax[cons])d(|)k
(cons.operands)187 1167 y(end)145 1219 y Fp(De\014nes:)187
1258 y Fl(asmoperand)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(238a,)g
(246,)h(and)f(254.)187 1297 y Fl(asmsyntax)p Fp(,)e(used)j(in)g(c)o(h)o
(unk)f(244a.)187 1337 y Fl(set_asmsyn)o(tax)o Fp(,)f(used)h(in)h(c)o(h)
o(unk)f(52e.)145 1376 y(Uses)i Fl(constructo)o(r)d Fp(159.)-17
1459 y(243b)88 b Fo(h)p Fn(insist)15 b(that)g Fr(operands)e
Fn(and)j(op)n(er)n(ands)f(of)g Fr(cons)f Fn(have)h(the)g(same)g(names)h
Fp(243b)p Fo(i)n(\021)88 b Fp(\(243a\))187 1509 y Fr(s1)21
b(:=)h(set\(\);)e(every)h(insert\(s1,)f(inputs_of_opera)o(nds\(o)o
(peran)o(ds\).n)o(ame\))187 1559 y(s2)h(:=)h(set\(\);)e(every)h
(insert\(s2,)f(inputs_of\(cons\))o(.name)o(\))187 1609
y(every)h(x)g(:=)h(!s1)f(&)g(not)g(member\(s2,)f(x\))i(do)230
1659 y(error\("Operand)d(",)j(x,)f(")h(given)e(in)i(assembly)e(syntax)g
(for)i(",)f(cons.name,)361 1708 y(")h(is)f(not)g(in)h(the)f(original)f
(constructor)f(specification"\))187 1758 y(every)i(x)g(:=)h(!s2)f(&)g
(not)g(member\(s1,)f(x\))i(do)230 1808 y(warning\("Operand)d(",)i(x,)h
(")f(of)h(constructor)d(",)i(cons.name,)405 1858 y(")g(is)h(not)f
(shown)g(in)g(the)g(assembly)f(syntax"\))145 1910 y Fp(Uses)12
b Fl(constructo)o(r)d Fp(159,)h Fl(inputs_of)f Fp(166a,)h(and)h
Fl(inputs_of)o(_op)o(era)o(nds)d Fp(166a.)-13 2001 y(243c)88
b Fo(h)p Fn(insist)15 b(that)g Fr(operands)e Fn(and)j(op)n(er)n(ands)f
(of)g Fr(cons)f Fn(have)h(the)g(same)g(signe)n(d)g(op)n(er)n(ands)h
Fp(243c)p Fo(i)o(\021)86 b Fp(\(243a\))187 2051 y Fr(s1)21
b(:=)h(set\(\);)e(every)h(insert\(s1,)f(inputs_of_opera)o(nds\(o)o
(peran)o(ds,)f("integer"\).name)o(\))187 2101 y(s2)i(:=)h(set\(\);)e
(every)h(insert\(s2,)f(inputs_of\(cons,)e("integer"\).name\))187
2151 y(every)j(x)g(:=)h(!s1)f(&)g(not)g(member\(s2,)f(x\))i(do)230
2200 y(error\("Operand)d(",)j(x,)f(")h(of)f(constructor)f(",)h
(cons.name,)361 2250 y(")h(is)f(signed)g(in)g(assembly)f(syntax)h(but)g
(unsigned)f(in)h(the)h(constructor)d(specification"\))187
2300 y(every)i(x)g(:=)h(!s2)f(&)g(not)g(member\(s1,)f(x\))i(do)230
2350 y(error\("Operand)d(",)j(x,)f(")h(of)f(constructor)f(",)h
(cons.name,)361 2400 y(")h(is)f(unsigned)f(in)i(assembly)e(syntax)g
(but)h(signed)g(in)g(the)h(constructor)d(specification"\))145
2452 y Fp(Uses)12 b Fl(constructo)o(r)d Fp(159,)h Fl(inputs_of)f
Fp(166a,)h(and)h Fl(inputs_of)o(_op)o(era)o(nds)d Fp(166a.)p
eop
%%Page: 244 244
244 243 bop 129 141 a Fv(244)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Because)j(some)e
(constructors)i(explo)q(de)f(with)g(v)n(acuous)f(disjuncts,)h(w)o(e)g
(mak)o(e)e(it)h(OK)129 307 y(to)g(de\014ne)h(duplicate)f(syn)o(tax,)f
(but)h(w)o(e)h(do)e(insist)h(the)h(duplicates)f(b)q(e)g(iden)o(tical.)
-31 370 y Fp(244a)88 b Fo(h)p Fr(operands)14 b Fn(matches)h(existing)g
(assembly)g(syntax)g(for)g Fr(cons)f Fp(244a)p Fo(i)n(\021)228
b Fp(\(243a\))171 420 y Fr(oldoperands)19 b(:=)j(asmsyntax[cons])171
469 y(*operands)e(=)h(*oldoperands)f(&)215 519 y(if)h(i)h(:=)f(1)g(to)h
(*operands)e(&)h(not)h(operands_match\()o(opera)o(nds[i)o(],)d
(oldoperands[i]\))f(then)258 569 y({dump_em\("new",)h(operands\);)h
(dump_em\("old",)e(oldoperands\);)i(&fail})215 619 y(else)258
669 y(&null)129 720 y Fp(Uses)12 b Fl(asmsyntax)d Fp(243a,)h
Fl(dump_em)f Fp(244c,)h Fl(fail)h Fp(410,)f(and)h Fl(operands_)o(mat)o
(ch)d Fp(244b.)-33 804 y(244b)88 b Fo(h)p Fn(*)16 b Fp(235a)p
Fo(i)n Fv(+)q Fo(\021)1019 b Fm(/)5 b Fp(243a)22 b(244c)5
b Fm(.)171 853 y Fr(procedure)20 b(operands_match\(op)o(1,)f(op2\))215
903 y(return)h(case)h(type\(op1\))f(==)h(type\(op2\))f(of)i({)258
953 y("literal")e(:)i(op1.s)e(==)i(op2.s)258 1003 y("input")64
b(:)22 b(op1.name)e(==)h(op2.name)f(&)i(op1.meaning)d(===)j
(op2.meaning)215 1053 y(})171 1102 y(end)129 1154 y Fp(De\014nes:)171
1194 y Fl(operands_m)o(atc)o(h)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f
(244a.)129 1233 y(Uses)i Fl(input)e Fp(46a)h(and)f Fl(literal)g
Fp(45e.)-29 1324 y(244c)88 b Fo(h)p Fn(*)16 b Fp(235a)p
Fo(i)n Fv(+)q Fo(\021)1033 b Fm(/)5 b Fp(244b)22 b(245)5
b Fm(.)171 1374 y Fr(procedure)20 b(dump_em\(ty,)f(ops\))215
1424 y(writes\(&errout,)f(ty,)j(")h(syntax:"\))215 1474
y(every)e(writes\(&errout,)f(x)j(:=)f(!ops)g(&)498 1524
y(case)g(type\(x\))f(of)i({)607 1574 y("literal")e(:)h(x.s)607
1623 y("input")64 b(:)21 b(x.name)g(||)868 1673 y(if)h
(type\(x.meaning\))c(==)k("integer")e(then)h("!")868
1723 y(else)g("")607 1773 y(default)f(:)i(impossible\("oper)o(and)d
(type"\))498 1823 y(}\))215 1872 y(write\(&errout\))215
1922 y(return)171 1972 y(end)129 2024 y Fp(De\014nes:)171
2063 y Fl(dump_em)p Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(244a.)129
2103 y(Uses)i Fl(input)e Fp(46a)h(and)f Fl(literal)g
Fp(45e.)p eop
%%Page: 245 245
245 244 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(245)145 258 y Fj(10.3)66 b(Emitting)21
b(prin)n(t)g(pro)r(cedures)e(for)f(constructors)145 349
y Fv(The)12 b(\014rst)g(issue)h(is)e(\014guring)g(out)g(what)g(to)h
(call)e(the)i(prin)o(t)g(pro)q(cedures)h(and)f(what)f(storage)145
398 y(class)i(they)g(should)g(b)q(e.)18 b(Un)o(t)o(yp)q(ed)13
b(constructors)i(prin)o(t)d(directly)h(and)g(are)g(visible)f(\(if)f
(not)145 448 y(doing)h(indirect\),)h(whereas)h(t)o(yp)q(ed)f
(constructors)i(create)f(instances,)g(so)f(w)o(e)g(ha)o(v)o(e)f(to)h
(giv)o(e)145 498 y(them)g(di\013eren)o(t)i(names)e(and)h(w)o(e)g(ha)o
(v)o(e)g(to)g(mak)o(e)e(them)h(alw)o(a)o(ys)g(hidden)h(\(static\).)2
560 y Fp(245)89 b Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p
Fo(\021)1037 b Fm(/)6 b Fp(244c)22 b(246)5 b Fm(.)187
610 y Fr(procedure)20 b(assembler_proc_n)o(ame\(c)o(ons\))230
660 y(return)h(if)g(cons.type)f(===)h(instructionctype)e(then)i
(cons.name)383 710 y(else)g(cons.name)f(||)h("_asm")43
b(#)21 b(unsafe,)f(but)i(what)f(do)g(you)g(want?)187
760 y(end)187 809 y(procedure)f(assembler_proc_c)o(lass\()o(cons\))230
859 y(return)h(if)g(\\indirectname)e(|)44 b(cons.type)20
b(~===)h(instructionctype)d(then)j("static)f(")i(else)f("")187
909 y(end)145 961 y Fp(De\014nes:)187 1000 y Fl(assembler_)o(pro)o(c_)o
(cla)o(ss)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(246.)187
1040 y Fl(assembler_)o(pro)o(c_)o(nam)o(e)p Fp(,)f(used)h(in)h(c)o(h)o
(unks)f(246)h(and)f(250b.)145 1079 y(Uses)i Fl(indirectna)o(me)c
Fp(18a)j(and)g Fl(instructio)o(nc)o(typ)o(e)e Fp(32a.)p
eop
%%Page: 246 246
246 245 bop 129 141 a Fv(246)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y Fr
(emit_assembler_b)o(ody)e Fv(creates)k(an)f(assem)o(bly-emitting)d(pro)
q(cedure)k(for)f(the)g(con-)129 307 y(structor)h Fr(cons)p
Fv(.)i(Its)c(\014rst)h(act)f(is)g(to)g(mak)o(e)e(sure)j(there)g(are)g
(prin)o(t)e(pro)q(cedures)k(for)c(all)g(the)129 357 y(op)q(erands.)19
b(After)c(that,)e(it)h(just)g(prin)o(ts)g(all)f(the)h(syn)o(tax,)g
(then)g(p)q(ossibly)g(a)f(newline.)-13 420 y Fp(246)88
b Fo(h)p Fn(*)16 b Fp(235a)p Fo(i)n Fv(+)q Fo(\021)1052
b Fm(/)6 b Fp(245)22 b(247)5 b Fm(.)171 469 y Fr(procedure)20
b(emit_assembler_bo)o(dy\(pp)o(,)f(cons\))215 519 y(local)h(asmname)215
569 y(every)g(create_input_print_)o(proc\()o(pp,)f(inputs_of\(cons\))o
(\))215 619 y(emit_template\(p)o(p,)g("emitter-body.t",)607
669 y("safename",)g(Cnoreserve\(assemble)o(r_pro)o(c_nam)o(e\(con)o
(s\)\),)607 718 y("args",)h(arg_decls\(cons\),)607 768
y("class",)g(assembler_proc_cl)o(ass\(c)o(ons\)\))215
818 y(asmname)g(:=)h(consname2asm\(cons\))215 868 y(if)g(*asmname)f(>)i
(0)f(&)h(/postfix)e(then)258 918 y(emit_asm_printf\(pp)o(,)f("\045s",)i
(image\(asmname\)\))215 967 y(every)f(o)i(:=)f(!asmoperands\(cons\))d
(do)258 1017 y(case)j(type\(o\))f(of)i({)302 1067 y("literal")e(:)h
(emit_asm_printf\(pp,)d("\045s",)j(image\(o.s\)\))302
1117 y("input")42 b(:)389 1167 y(PPxwrites\(pp,)19 b("$n",)694
1217 y(create_input_prin)o(t_pro)o(c\(pp,)f(o\),)j("\(",)g
(Cnoreserve\(o.name\),)d("\);"\))302 1266 y(default)i(:)i
(impossible\("oper)o(and)d(type"\))258 1316 y(})215 1366
y(if)i(*asmname)f(>)i(0)f(&)h(\\postfix)e(then)258 1416
y(emit_asm_printf\(pp)o(,)f("\045s",)i(image\(asmname\)\))215
1466 y(if)g(cons.type)f(===)h(instructionctype)e(then)258
1515 y(emit_asm_printf\(pp)o(,)g("\\n"\))215 1565 y(PPxwrite\(pp,)g
("$b$n}"\))171 1615 y(end)129 1667 y Fp(De\014nes:)171
1706 y Fl(emit_assem)o(ble)o(r_b)o(ody)o Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(236a.)129 1746 y(Uses)19 b Fl(arg_decls)14 b Fp(204a,)j
Fl(asmoperand)o(s)e Fp(243a,)i Fl(assembler)o(_pr)o(oc_)o(cla)o(ss)e
Fp(245,)171 1785 y Fl(assembler_)o(pro)o(c_n)o(ame)g
Fp(245,)i Fl(Cnoreserve)e Fp(337a,)i Fl(consname2as)o(m)f
Fp(238a,)171 1825 y Fl(create_inp)o(ut_)o(pri)o(nt_)o(pr)o(oc)10
b Fp(247,)j Fl(emit_asm_)o(pri)o(ntf)d Fp(251b,)i Fl(input)f
Fp(46a,)i Fl(inputs_of)d Fp(166a,)171 1864 y Fl(instructio)o(nct)o(ype)
e Fp(32a,)i Fl(literal)g Fp(45e,)g(and)h Fl(postfix)e
Fp(16f.)129 2014 y Fj(10.4)66 b(Generating)23 b(prin)n(t)i(pro)r
(cedures)d(for)h(op)r(erands)129 2105 y Fv(Next)15 b(w)o(e)g(sho)o(w)f
(ho)o(w)g(to)g(create)h(a)f(prin)o(t)g(pro)q(cedure)i(for)e(an)g(op)q
(erand.)19 b(W)m(e)14 b(do)g(it)g(lazily)m(,)129 2155
y(and)g(w)o(e)g(return)h(the)g(name)e(of)g(the)h(pro)q(cedure.)p
eop
%%Page: 247 247
247 246 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(247)208 258 y(W)m(e're)14 b(allo)o(w)o(ed)g
(to)h(prin)o(t)f(an)o(y)h(in)o(teger)g(argumen)o(t)f(using)g(an)o(y)h
(syn)o(tax)f(w)o(e)h(lik)o(e.)21 b(Re-)145 307 y(lo)q(catable)14
b(addresses)i(constructor)f(t)o(yp)q(es)g(ha)o(v)o(e)f(constrained)g
(syn)o(taxes.)2 370 y Fp(247)89 b Fo(h)p Fn(*)15 b Fp(235a)p
Fo(i)o Fv(+)p Fo(\021)1053 b Fm(/)6 b Fp(246)22 b(248)5
b Fm(.)187 420 y Fr(procedure)20 b(create_input_pri)o(nt_pr)o(oc\(pp)o
(,)f(ipt\))230 469 y(return)i(case)g(type\(ipt.meaning\))d(of)k({)274
519 y("string")64 b(:)21 b("asmprintreloc")274 569 y("constype")f(:)h
(create_constype_pri)o(nt_pr)o(oc\(p)o(p,)e(ipt.name,)h(ipt.meaning\))
274 619 y("integer")42 b(:)21 b(create_integer_prin)o(t_pro)o(c\(pp)o
(,)e("signed",)64 b(ipt,)623 669 y(signed_type\(fwid)o(th\(f)18
b(:=)k(symtab[ipt.name])o(\)\),)d(operand_syntax_)o(of\(ip)o(t\)\))710
718 y(#)i(maybe)g(this)g(should)g(be)g(forced)g(to)g(\045d?)274
768 y("field")86 b(:)21 b(create_integer_prin)o(t_pro)o(c\(pp)o(,)e
("unsigned",)h(ipt,)623 818 y(unsigned_type\(fw)o(idth\()o(f)f(:=)i
(ipt.meaning\)\),)e(operand_syntax_of\()o(ipt\)\))274
868 y("null")108 b(:)21 b(create_integer_prin)o(t_pro)o(c\(pp)o(,)e
("signed",)64 b(ipt,)623 918 y(signed_type\(\),)19 b(operand_syntax_)o
(of\(ip)o(t\)\))274 967 y(default)86 b(:)21 b(impossible\("Bad)e
(operand)h(value",)h(type\(ipt.meaning)o(\)\))230 1017
y(})187 1067 y(end)145 1119 y Fp(De\014nes:)187 1158
y Fl(create_inp)o(ut_)o(pr)o(int)o(_pr)o(oc)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(246.)145 1198 y(Uses)16 b
Fl(asmprintrel)o(oc)c Fp(409a,)j Fl(constype)e Fp(159,)i
Fl(create_co)o(nst)o(ype)o(_pr)o(in)o(t_p)o(roc)d Fp(250a,)187
1237 y Fl(create_int)o(ege)o(r_)o(pri)o(nt_)o(pro)o(c)e
Fp(248,)j Fl(field)e Fp(55,)i Fl(fwidth)e Fp(115d,)h
Fl(operand_sy)o(nta)o(x_o)o(f)e Fp(242d,)187 1277 y Fl(signed_typ)o(e)f
Fp(335a,)h Fl(symtab)f Fp(32a)i(367,)g Fl(unsigned_)o(typ)o(e)e
Fp(335a,)h(and)g Fl(value)g Fp(136a.)p eop
%%Page: 248 248
248 247 bop 129 141 a Fv(248)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(There's)i(no)e
(science)j(here.)-13 320 y Fp(248)88 b Fo(h)p Fn(*)16
b Fp(235a)p Fo(i)n Fv(+)q Fo(\021)1033 b Fm(/)5 b Fp(247)23
b(249d)t Fm(.)171 370 y Fr(procedure)d(create_integer_pr)o(int_p)o
(roc\(p)o(p,)f(sign,)h(ipt,)h(argtype,)g(syntax\))215
420 y(local)f(namearray,)g(argname,)g(limit)215 469 y(if)h(p)h(:=)f
(lookup_printproc\()o(synta)o(x,)e(argtype\))h(then)h(return)f(p)215
519 y(argname)g(:=)h(ipt.name)215 569 y(emit_template\(p)o(p,)e
("int-print-header)o(.t",)629 619 y("name",)h(argname,)g("type",)g
(argtype,)h("sign",)f(sign\))215 669 y(l)h(:=)h(percent_split\(s)o
(yntax)o(.synt)o(ax\))215 718 y(if)f(!l)g(==)h("\045s")f(then)g({)258
768 y(\\syntax.nametable)d(|)k Fo(h)p Fn(c)n(omplain)15
b(no)h(names)f(sp)n(e)n(ci\014e)n(d)g Fp(249c)p Fo(i)258
818 y(h)p Fn(set)g Fr(limit)f Fn(b)n(ase)n(d)h(on)g Fr(ipt)g
Fn(and)g(the)g(name)h(table)e Fp(249a)p Fo(i)258 868
y Fr(namearray)20 b(:=)h(name_array_from_tabl)o(e\(sy)o(ntax.)o(namet)o
(able,)d(limit,)j(argname\))258 918 y(namearray.storagec)o(lass)d(:=)k
("static")258 967 y(PPxwrite\(pp,)d(pretty\(Gdeclnamearra)o(y\(na)o
(mearr)o(ay\)\),)f(";"\))j(#)h(local)f(name)f(array)258
1017 y(if)i(type\(ipt.meanin)o(g\))d(==)i("null")g(then)302
1067 y(PPxwrite\(pp,)e(pretty\(Sif\([)389 1117 y(Sguarded\(set\([lit)o
(eral\()o("0)g(<=)i(")h(||)f(argname\),)694 1167 y(literal\(argname)e
(||)i(")h(<)f(")h(||)f(limit\)]\),)585 1217 y(Sepsilon\(\)\),)389
1266 y(Sguarded\(set\(\),)585 1316 y(literal\("{asmprint)o(f\(as)o
(mprin)o(tfd,)d(")k(||)847 1366 y(image\(bad_opera)o(nd_na)o(me\(ar)o
(gname)o(,)d("\045d"\)\))h(||)i(",)f(")h(||)847 1416
y(argname)e(||)h("\);)g(return;}"\)\)]\)\)\))215 1466
y(})215 1515 y(every)f(x)i(:=)f(!l)h(do)258 1565 y(case)f(x)h(of)f({)
302 1615 y("\045s")g(:)g(emit_asm_printf\(pp,)d("\045s",)j
(namearray.codenam)o(e)e(||)i("[")h(||)f(argname)f(||)i("]"\))302
1665 y("\045d")f(|)g("\045u")g(|)h("\045x")f(:)g(emit_asm_printf\(pp,)d
(x,)k(argname\))302 1715 y("\045\045")f(:)g(emit_asm_printf\(pp,)d
("\045\045"\))302 1764 y(default)i(:)345 1814 y(if)i(match\("\045",)d
(x\))j(then)389 1864 y(error\("Unknown)d(escape)h(",)i(x,)f(")h(in)f
(syntax)g(string)f(for)h(argument)f(",)i(argname\))345
1914 y(else)389 1964 y(emit_asm_printf\(p)o(p,)d("\045s",)i
(image\(x\)\))258 2014 y(})215 2063 y(PPxwrite\(pp,)e("$b$n}"\))215
2113 y(p)i(:=)h("print_")e(||)h(sign)g(||)g("_")h(||)f(argname)215
2163 y(save_printproc\()o(p,)e(syntax,)h(argtype\))215
2213 y(return)g(p)171 2263 y(end)129 2315 y Fp(De\014nes:)171
2354 y Fl(create_int)o(ege)o(r_p)o(rin)o(t_)o(pro)o(c)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(247.)129 2393 y(Uses)j
Fl(asmprintf)d Fp(409a,)h Fl(asmprintfd)e Fp(409a,)i
Fl(bad_operand)o(_na)o(me)e Fp(357b,)i Fl(emit_asm_pri)o(nt)o(f)f
Fp(251b,)171 2433 y Fl(Gdeclnamea)o(rra)o(y)i Fp(293b,)h
Fl(literal)g Fp(45e,)h Fl(lookup_pri)o(nt)o(pro)o(c)e
Fp(249d,)h Fl(namearray)f Fp(291a,)171 2472 y Fl(name_array)o(_fr)o
(om_)o(tab)o(le)d Fp(357b,)i Fl(percent_sp)o(lit)e Fp(251a,)i
Fl(pretty)f Fp(18a,)i Fl(save_prin)o(tpr)o(oc)d Fp(249d,)p
eop
%%Page: 249 249
249 248 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(249)187 258 y Fl(Sepsilon)9
b Fp(81,)i Fl(Sguarded)d Fp(81,)j(and)g Fl(Sif)g Fp(81.)-15
336 y(249a)88 b Fo(h)p Fn(set)15 b Fr(limit)f Fn(b)n(ase)n(d)h(on)h
Fr(ipt)e Fn(and)h(the)g(name)h(table)e Fp(249a)p Fo(i)o(\021)420
b Fp(\(248\))187 386 y Fr(case)21 b(type\(ipt.meaning)o(\))e(of)i({)230
436 y("field")64 b(:)22 b(limit)f(:=)g(2^fwidth\(ipt.meani)o(ng\))230
486 y("integer")f(:)i(limit)f(:=)g(2^ipt.meaning)230
536 y(default)64 b(:)22 b({)f(limit)g(:=)h(0;)f(every)g(limit)g(<:=)g
(!syntax.nametabl)o(e;)e(limit)i(+:=)g(1)g(})187 585
y(})145 636 y Fp(Uses)12 b Fl(field)e Fp(55)h(and)g Fl(fwidth)e
Fp(115d.)-17 721 y(249b)88 b Fo(h)p Fn(int-print-he)n(ader.t)14
b Fp(249b)p Fo(i)o(\021)187 771 y Fr(static)20 b(void)h
(print_\045sign_\045name\(\045)o(type)d(\045name\))j({$t)-13
857 y Fp(249c)88 b Fo(h)p Fn(c)n(omplain)16 b(no)f(names)g(sp)n(e)n
(ci\014e)n(d)h Fp(249c)p Fo(i)n(\021)693 b Fp(\(248\))187
906 y Fr(error\("Tried)19 b(to)i(use)h(field)e(names)h(to)h(format)e
(argument)g(",)i(argname,)318 956 y(",)f(but)g(no)g(name)g(specifier)f
(was)i(given"\))145 1007 y Fp(Uses)12 b Fl(field)e Fp(55.)208
1074 y Fv(T)m(o)17 b(k)o(eep)j(trac)o(k)f(of)f(prin)o(t)g(pro)q
(cedures,)k(the)d(easy)g(case)h(is)e(one)h(in)f(whic)o(h)h(no)f
(\014eld)145 1124 y(names)13 b(are)h(used:)19 b(w)o(e)14
b(just)g(lo)q(ok)f(up)h(a)f(pro)q(cedure)j(b)o(y)e(its)f(syn)o(tax)h
(and)g(argumen)o(t)e(t)o(yp)q(e.)145 1174 y(Otherwise)g(w)o(e)e(need)i
(a)d(k)o(ey)i(that)f(captures)i(all)d(the)h(\014eld)h(names.)16
b(I)10 b(use)h Fr("\\0")e Fv(to)h(separate)145 1224 y(parts)17
b(of)f(a)g(k)o(ey)m(.)25 b(This)16 b(tric)o(k)h(isn't)e(p)q(erfectly)j
(safe,)e(but)h(names)f(are)g(most)f(unlik)o(ely)h(to)145
1273 y(con)o(tain)d(the)g(n)o(ull)f(c)o(haracter,)i(and)f(if)f(they)i
(do,)e(the)i(C)f(co)q(de)h(is)e(going)g(to)h(break)g(an)o(yw)o(a)o(y)m
(.)-17 1334 y Fp(249d)88 b Fo(h)p Fn(*)15 b Fp(235a)p
Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)6 b Fp(248)22 b(250a)5
b Fm(.)187 1384 y Fr(global)20 b(printproctab)187 1484
y(procedure)g(printproc_key\(sy)o(ntax,)e(argtype\))230
1534 y(k)k(:=)f(syntax.syntax)e(||)j("\\0")f(||)g(argtype)230
1583 y(if)h(find\("\045s",)d(syntax.syntax\))g(then)274
1633 y(k)j(||:=)f(nametablekey\(sy)o(ntax.)o(namet)o(able\))230
1683 y(return)g(k)187 1733 y(end)187 1832 y(procedure)f
(lookup_printproc)o(\(synt)o(ax,)f(argtype\))230 1882
y(initial)i(/printproctab)e(:=)i(table\(\))230 1932 y(return)g
(\\printproctab[pri)o(ntpro)o(c_key)o(\(synt)o(ax,)d(argtype\)])187
1982 y(end)187 2081 y(procedure)i(save_printproc\(p)o(rocna)o(me,)f
(syntax,)h(argtype\))230 2131 y(initial)h(/printproctab)e(:=)i
(table\(\))230 2181 y(\(/printproctab[prin)o(tproc)o(_key\()o(synta)o
(x,)e(argtype\)])h(:=)h(procname\))f(|)230 2231 y(impossible\("duplica)
o(ted)f(print)h(procedures"\))230 2281 y(return)h(procname)187
2331 y(end)145 2381 y Fp(De\014nes:)187 2420 y Fl(lookup_pri)o(ntp)o
(ro)o(c)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(248)h(and)g(250a.)187
2460 y Fl(save_print)o(pro)o(c)p Fp(,)d(used)j(in)g(c)o(h)o(unks)f(248)
h(and)f(250a.)145 2499 y(Uses)i Fl(nametablek)o(ey)c
Fp(358a.)p eop
%%Page: 250 250
250 249 bop 129 141 a Fv(250)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Here's)i(the)g
(prin)o(t)g(pro)q(cedure)h(for)e(a)g(constructor)i(t)o(yp)q(e.)21
b(Note)15 b(that)f(w)o(e)h(don't)f(ha)o(v)o(e)129 307
y(to)e(w)o(orry)h(ab)q(out)f(whether)h(the)g(prin)o(t)f(pro)q(cedures)i
(for)e(the)h(individual)d(constructors)k(are)129 357
y(out,)20 b(b)q(ecause)g(the)f(global)e(ordering)i(on)g(constructors)h
(guaran)o(tees)g(they'v)o(e)f(all)e(b)q(een)129 407 y(emitted.)280
392 y Ff(1)-31 469 y Fp(250a)88 b Fo(h)p Fn(*)16 b Fp(235a)p
Fo(i)n Fv(+)q Fo(\021)1015 b Fm(/)5 b Fp(249d)22 b(251a)5
b Fm(.)171 519 y Fr(procedure)20 b(create_constype_p)o(rint_)o(proc\()o
(pp,)e(argname,)j(constype\))215 569 y(local)f(call,)h(prefix)215
619 y(static)f(constype_syntax)215 669 y(initial)g(constype_syntax)f
(:=)i(operand_syntax\("")o(\))215 718 y(if)g(p)h(:=)f
(lookup_printproc\()o(const)o(ype_s)o(ynta)o(x,)e(constype.name\))g
(then)i(return)f(p)215 768 y(emit_template\(p)o(p,)f("constype-print-h)
o(eade)o(r.t",)f("type",)j(constype.name\))215 818 y(s)g(:=)h
(Stagcase\(argnam)o(e,)d(constype,)h(table\(\)\))215
868 y(every)g(cons)h(:=)h(kept_constructor)o(s\(con)o(styp)o(e\))d(do)i
({)258 918 y Fo(h)p Fn(let)15 b Fr(call)f Fn(r)n(epr)n(esent)g(a)h(c)n
(al)r(l)f(to)h(the)g(assembly)g(pr)n(o)n(c)g(for)f Fr(cons)g
Fp(250b)p Fo(i)258 967 y Fr(s.arms[cons])19 b(:=)j(literal\(call\))215
1017 y(})215 1067 y(PPxwrite\(pp,)d(pretty\(s\),)h("$b$n}"\))215
1117 y(p)h(:=)h("print_")e(||)h(constype.name)215 1167
y(save_printproc\()o(p,)e(operand_syntax\("")o(\),)g(constype.name\))
215 1217 y(return)h(p)171 1266 y(end)129 1318 y Fp(De\014nes:)171
1358 y Fl(create_con)o(sty)o(pe_)o(pri)o(nt)o(_pr)o(oc)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(247.)129 1397 y(Uses)15
b Fl(constype)c Fp(159,)i Fl(kept_constr)o(uct)o(or)o(s)e
Fp(33d,)i Fl(literal)f Fp(45e,)h Fl(lookup_prin)o(tpr)o(oc)e
Fp(249d,)171 1437 y Fl(operand_sy)o(nta)o(x)e Fp(241b,)h
Fl(pretty)f Fp(18a,)i Fl(save_print)o(pro)o(c)e Fp(249d,)h(and)g
Fl(Stagcase)f Fp(183a.)192 1499 y Fv(Just)14 b(blast)g(out)g(the)g
(argumen)o(ts.)6 b(.)h(.)f(and)14 b(mak)o(e)e(sure)j(to)f(ha)o(v)o(e)g
(inital)e(paren)o(thesis)j(.)-1951 b Fk(\031Change)13
b(#41)-33 1561 y Fp(250b)88 b Fo(h)p Fn(let)15 b Fr(call)f
Fn(r)n(epr)n(esent)g(a)h(c)n(al)r(l)g(to)f(the)h(assembly)g(pr)n(o)n(c)
g(for)f Fr(cons)g Fp(250b)p Fo(i)o(\021)197 b Fp(\(250a\))171
1611 y Fr(call)21 b(:=)g([assembler_proc_nam)o(e\(con)o(s\),)e("\("])
171 1661 y(prefix)i(:=)g("")171 1711 y(every)g(ipt)g(:=)g
(inputs_of\(cons\))e(do)i({)215 1760 y(put\(call,)e(prefix\);)i(prefix)
f(:=)i(",)f(")215 1810 y(put\(call,)e(pretty\(Einstance_inp)o(ut\(ar)o
(gnam)o(e,)g(cons,)i(ipt.name\)\)\))171 1860 y(})171
1910 y(put\(call,)f("\);"\))129 1962 y Fp(Uses)12 b Fl(assembler_p)o
(roc)o(_n)o(ame)c Fp(245,)j Fl(Einstance)o(_in)o(put)d
Fp(81,)j Fl(inputs_of)d Fp(166a,)j(and)f Fl(pretty)g
Fp(18a.)-29 2045 y(250c)88 b Fo(h)p Fn(c)n(onstyp)n(e-print-he)n
(ader.t)15 b Fp(250c)p Fo(i)o(\021)171 2095 y Fr(static)21
b(void)f(print_\045type\(\045type_In)o(stanc)o(e)f(\045type\))h({$t)p
129 2461 573 2 v 176 2487 a Fc(1)193 2499 y Fp(There)11
b(are)g(probably)e(sev)o(eral)h(lurking)f(bugs)i(if)g(someb)q(o)q(dy)e
(discards)h(a)h(t)o(yp)q(ed)f(constructor.)p eop
%%Page: 251 251
251 250 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(251)145 258 y Fj(10.5)66 b(Little)24
b(utilit)n(y)i(pro)r(cedures)145 349 y Fr(percent_split)11
b Fv(divides)j(up)g(a)g(syn)o(tax)g(string)g(suc)o(h)g(that)g(the)h
(escap)q(es)h(are)e(ob)o(vious.)-15 411 y Fp(251a)88
b Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p Fo(\021)1016
b Fm(/)5 b Fp(250a)22 b(251b)5 b Fm(.)187 461 y Fr(procedure)20
b(percent_split\(s\))230 510 y(l)i(:=)f([])230 560 y(s)h(?)274
610 y(while)f(not)g(pos\(0\))f(do)i({)318 660 y(if)f(not)g
(match\("\045"\))f(then)361 710 y(put\(l,)h(tab\(upto\('\045'\))e(|)i
(0\)\))318 760 y(while)f(match\("\045"\))g(do)361 809
y(put\(l,)h(move\(2\)\))f(|)h(error\("unescaped)e(\045)i(at)h(end)f(of)
g(syntax)g(string"\))274 859 y(})230 909 y(return)g(l)187
959 y(end)145 1011 y Fp(De\014nes:)187 1050 y Fl(percent_sp)o(lit)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(242c)h(and)f(248.)208
1112 y Fr(emit_asm_printf)g Fv(emits)j(a)h(call)f(to)h
Fr(asmprintf)1019 1097 y Ff(2)1035 1112 y Fv(.)-17 1175
y Fp(251b)88 b Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p
Fo(\021)1018 b Fm(/)5 b Fp(251a)22 b(253a)5 b Fm(.)187
1224 y Fr(procedure)20 b(emit_asm_printf\()o(pp,)f(fmt,)i(args[]\))230
1274 y(PPxwrites\(pp,)e("$nasmprintf\(asmprin)o(tfd,)f("\))230
1324 y(PPwrites\(pp,)i(image\(fmt\)\))230 1374 y(every)h(PPwrites\(pp,)
e(",)j(",)f(!args\))230 1424 y(PPwrites\(pp,)f("\);"\))230
1474 y(return)187 1523 y(end)145 1575 y Fp(De\014nes:)187
1615 y Fl(emit_asm_p)o(rin)o(tf)o Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f
(246)g(and)h(248.)145 1654 y(Uses)h Fl(asmprintfd)c Fp(409a.)p
145 2461 573 2 v 192 2487 a Fc(2)209 2499 y Fp(Note)j(the)g(complete)e
(lac)o(k)h(of)i(consistency)c(in)j(m)o(y)g(use)g(of)g(the)g(underscore)
p eop
%%Page: 252 252
252 251 bop 129 141 a Fv(252)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)p eop
%%Page: 253 253
253 252 bop 145 569 a Fq(Chapter)32 b(11)145 777 y Fu(Emitting)39
b(assem)m(bly-language)145 901 y(grammars)-15 1122 y
Fp(253a)88 b Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p
Fo(\021)1014 b Fm(/)5 b Fp(251b)22 b(253b)5 b Fm(.)187
1172 y Fr(procedure)20 b(emit_asm_grammar)o(\(outf)o(ilena)o(me\))230
1222 y(local)h(outfile)230 1272 y(verbose\("Emitting)e
(assembly-languag)o(e)g(grammar"\))230 1322 y(\(outfile)i(:=)g
(openfile\(outfilen)o(ame,)d("w"\)\))j(|)535 1372 y(error\("could)f
(not)h(open)g(",)g(image\(outfilename\),)d(")k(for)f(writing"\))230
1421 y(pushtrace\("ASMGRAMM)o(AR"\))230 1471 y(every)g
(emit_cons_producti)o(on\(ou)o(tfile)o(,)e(kept_constructors)o(\(\)\))
230 1521 y(poptrace\(\))230 1571 y(return)187 1621 y(end)145
1672 y Fp(De\014nes:)187 1712 y Fl(emit_asm_g)o(ram)o(ma)o(r)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(20.)145 1751 y(Uses)i
Fl(emit_cons_)o(pro)o(duc)o(tio)o(n)d Fp(254,)h Fl(kept_constr)o(uc)o
(tor)o(s)f Fp(33d,)h Fl(openfile)f Fp(24,)i(and)g Fl(verbose)e
Fp(18a.)208 1822 y Fv(W)m(e)14 b(use)j(the)f(non)o(terminal)d
Fr(Instruction)g Fv(for)i(un)o(t)o(yp)q(ed)h(constructors.)24
b(F)m(or)15 b(t)o(yp)q(ed)145 1872 y(constructors)h(w)o(e)e(use)h(the)g
(name)d(of)i(the)g(t)o(yp)q(e)g(plus)g(the)h(w)o(ord)e
Fr(Operand)p Fv(.)-17 1934 y Fp(253b)88 b Fo(h)p Fn(*)15
b Fp(235a)p Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)6 b Fp(253a)22
b(254)5 b Fm(.)187 1984 y Fr(procedure)20 b(nonterminal_name)o(\(cons)o
(\))230 2034 y(return)h(if)g(cons.type)f(===)h(instructionctype)e(then)
i("Instruction")383 2083 y(else)g(cons.type.name)e(||)i("Operand")187
2133 y(end)145 2185 y Fp(De\014nes:)187 2225 y Fl(nontermina)o(l_n)o
(am)o(e)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(254.)145
2264 y(Uses)i Fl(instructio)o(nct)o(ype)c Fp(32a.)830
2604 y Fv(253)p eop
%%Page: 254 254
254 253 bop 129 141 a Fv(254)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(T)m(o)k(emit)f(a)h
(pro)q(duction,)h(w)o(e)g(use)h(the)f(op)q(erands)h(and)e(the)h
(concrete)i(syn)o(tax.)29 b(W)m(e)129 307 y(share)20
b Fr(consname2asm)d Fv(to)i(determine)f(the)i(syn)o(tax)f(for)g(the)g
(constructor)i(name)d(\(and)129 357 y(whether)e(to)d(use)i(it)f(at)f
(all!\).)k(The)d(seman)o(tic)f(action)h(calls)f(an)h(enco)q(ding)g(pro)
q(cedure.)-13 420 y Fp(254)88 b Fo(h)p Fn(*)16 b Fp(235a)p
Fo(i)n Fv(+)q Fo(\021)1033 b Fm(/)5 b Fp(253b)22 b(255)5
b Fm(.)171 469 y Fr(procedure)20 b(emit_cons_product)o(ion\(o)o(utfil)o
(e,)f(cons\))215 519 y(local)h(asmname,)g(i,)i(operand_positions)o(,)d
(procname)215 569 y(every)h(create_field_nonter)o(minal)o(\(outf)o
(ile,)e(inputs_of\(cons,)h("field"\)\))215 619 y(writes\(outfile,)f
(nonterminal_name\(co)o(ns\),)g(")k(:"\))215 669 y(asmname)e(:=)h
(consname2asm\(cons\))215 718 y(i)g(:=)h(1)215 768 y(if)f(*asmname)f(>)
i(0)f(then)258 818 y(i)h(+:=)f(emit_literal_synt)o(ax\(ou)o(tfile)o(,)e
(asmname\))215 868 y(operand_positio)o(ns)g(:=)i([])215
918 y(every)f(o)i(:=)f(!asmoperands\(cons\))d(do)258
967 y(case)j(type\(o\))f(of)i({)302 1017 y("literal")e(:)h(i)h(+:=)f
(emit_literal_synt)o(ax\(ou)o(tfile)o(,)e(o.s\))302 1067
y("input")64 b(:)43 b({)389 1117 y(put\(operand_posit)o(ions,)18
b("$")j(||)h(i\))389 1167 y(i)f(+:=)h(emit_operand_syn)o(tax\(o)o(utfi)
o(le,)d(o\))345 1217 y(})302 1266 y(default)h(:)i(impossible\("oper)o
(and)d(type"\))258 1316 y(})215 1366 y(procname)h(:=)h
(Cnoreserve\(cons.na)o(me\))215 1416 y(write\(outfile,)d(")k(/*)f(",)
411 1466 y(if)g(cons.type)f(===)h(instructionctype)e(then)i("")g(else)g
("$0)g(=)h(",)411 1515 y(\(\\indirectname)d(||)i("->")g(|)h(""\))f(||)g
(procname,)520 1565 y("\(",)g(commaseparate\(op)o(eran)o(d_pos)o(ition)
o(s\),)e("\);)i(*/;"\))215 1615 y(return)171 1665 y(end)129
1717 y Fp(De\014nes:)171 1756 y Fl(emit_cons_)o(pro)o(duc)o(tio)o(n)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(253a.)129 1796 y(Uses)20
b Fl(asmoperands)c Fp(243a,)j Fl(Cnoreserve)d Fp(337a,)j
Fl(consname2)o(asm)d Fp(238a,)171 1835 y Fl(create_fie)o(ld_)o(non)o
(ter)o(mi)o(nal)9 b Fp(257,)i Fl(emit_litera)o(l_s)o(ynt)o(ax)e
Fp(255,)j Fl(emit_oper)o(and)o(_sy)o(nta)o(x)d Fp(256,)171
1875 y Fl(field)j Fp(55,)i Fl(indirectn)o(ame)c Fp(18a,)j
Fl(input)g Fp(46a,)f Fl(inputs_of)f Fp(166a,)i Fl(instructio)o(nct)o
(yp)o(e)e Fp(32a,)171 1914 y Fl(literal)e Fp(45e,)i(and)f
Fl(nonterminal)o(_na)o(me)e Fp(253b.)p eop
%%Page: 255 255
255 254 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(255)208 258 y(This)13 b(is)h(a)g(\014rst)g
(cut)h(and)f(will)e(ha)o(v)o(e)i(to)f(b)q(e)i(re\014ned)g(to)f(tok)o
(enize)g(things)g(prop)q(erly)m(.)2 320 y Fp(255)89 b
Fo(h)p Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p Fo(\021)1053
b Fm(/)6 b Fp(254)22 b(256)5 b Fm(.)187 370 y Fr(procedure)20
b(emit_literal_syn)o(tax\(o)o(utfil)o(e,)f(s\))230 420
y(static)i(alphanum,)f(letters,)g(multichar)230 469 y(initial)h({)g
(letters)g(:=)g(&letters)f(++)i('_.')448 519 y(alphanum)e(:=)i(letters)
e(++)i(&digits)448 569 y(multichar)e(:=)i(["<=",)e(">=",)h("!="])427
619 y(})230 669 y(n)h(:=)f(0)230 718 y(s)h(?)g({)274
768 y(optwhite\(\))274 818 y(while)f(not)g(pos\(0\))f(do)i({)318
868 y(if)f(any\(letters\))e(then)361 918 y(writes\(outfile,)g(")i(",)h
(image\(tab\(many\(a)o(lphan)o(um\)\)\))o(\))318 967
y(else)f(if)g(any\(&digits\))e(then)i({)361 1017 y(warning\("Can't)e
(put)i(digits)g(in)g(assembly)f(syntax"\))361 1067 y
(tab\(many\(&digits\)\))318 1117 y(})h(else)361 1167
y(writes\(outfile,)e(")i(",)h(image\(=!multicha)o(r)d(|)j
(move\(1\)\)\))318 1217 y(n)f(+:=)g(1)318 1266 y(optwhite\(\))274
1316 y(})230 1366 y(})230 1416 y(return)g(n)187 1466
y(end)145 1518 y Fp(De\014nes:)187 1557 y Fl(emit_liter)o(al_)o(sy)o
(nta)o(x)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(254)h(and)f(257.)145
1596 y(Uses)i Fl(optwhite)d Fp(364a.)p eop
%%Page: 256 256
256 255 bop 129 141 a Fv(256)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(This,)e(to)q(o,)g
(is)g(temp)q(orary)g(and)g(b)q(ogus.)17 b(W)m(e)11 b(need)h(to)f(tak)o
(e)g(the)h(same)e(directiv)o(es)j(used)129 307 y(to)h(create)g
Fr(operand_syntax_tab)c Fv(and)j(use)h(them)e(to)h(create)i(a)e
(sensible)h(input)f(syn)o(tax.)-13 370 y Fp(256)88 b
Fo(h)p Fn(*)16 b Fp(235a)p Fo(i)n Fv(+)q Fo(\021)1052
b Fm(/)6 b Fp(255)22 b(257)5 b Fm(.)171 420 y Fr(global)21
b(operand_input_s)o(yntax)o(_tab)171 469 y(procedure)f
(emit_operand_synt)o(ax\(ou)o(tfile)o(,)f(ipt\))215 519
y(initial)h(/operand_input_sy)o(ntax_)o(tab)f(:=)i(table\(\))215
569 y(s)g(:=)h(\\operand_input_)o(synta)o(x_tab)o([ipt.)o(name)o(])d(|)
258 619 y(case)i(type\(ipt.meaning\))d(of)k({)302 669
y("null")107 b(:)22 b("Integer")302 718 y("integer")41
b(:)22 b("Integer")302 768 y("field")85 b(:)22 b(field_nonterminal[)o
(ipt.)o(meani)o(ng])302 818 y("string")63 b(:)22 b("Relocatable")302
868 y("constype")d(:)j(ipt.meaning.name)d(||)i("Operand")302
918 y(default)85 b(:)22 b(impossible\("type)d(of)i(operand"\))258
967 y(})215 1017 y(writes\(outfile,)d(")k(",)f(s\))215
1067 y(return)f(1)171 1117 y(end)129 1169 y Fp(De\014nes:)171
1208 y Fl(emit_opera)o(nd_)o(syn)o(tax)o Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(254.)129 1248 y(Uses)i Fl(constype)d Fp(159,)i
Fl(field)f Fp(55,)g(and)h Fl(field_nont)o(erm)o(ina)o(l)e
Fp(257.)p eop
%%Page: 257 257
257 256 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)700
b Fr(assembly.nw)81 b Fv(257)2 258 y Fp(257)89 b Fo(h)p
Fn(*)15 b Fp(235a)p Fo(i)o Fv(+)p Fo(\021)1053 b Fm(/)6
b Fp(256)22 b(258)5 b Fm(.)187 307 y Fr(global)20 b(field_nonterminal)f
(#)i(maps)g(fields)g(to)g(nonterminal)f(names)187 407
y(procedure)g(create_field_non)o(termi)o(nal\(o)o(utfil)o(e,)f(ipt\))
230 457 y(local)i(nt,)g(prefix)230 507 y(/field_nonterminal)d(:=)k
(table\(\))230 557 y(f)g(:=)f(ipt.meaning)230 606 y(if)h
(member\(field_non)o(termi)o(nal,)c(f\))k(then)f(return)f
(field_nonterminal[f)o(])230 656 y(t)i(:=)f(fieldname_table\(f)e(:=)i
(ipt.meaning\))230 706 y(return)g(field_nonterminal)o([f])e(:=)274
756 y(if)i(/t)h(then)318 806 y("Integer")274 855 y(else)f(if)g(fprime)g
(:=)g(key\(field_nontermin)o(al\))d(&)k(t)g(===)f(fieldname_table\(f)o
(prim)o(e\))e(then)318 905 y(field_nontermin)o(al[fp)o(rime])f(#)k
(reuse)274 955 y(else)f({)318 1005 y(nt)g(:=)g(f.name)g(||)g("Field")
318 1055 y(write\(outfile,)d(nt\))318 1104 y(prefix)i(:=)h(":")318
1154 y(every)f(p)i(:=)f(!sort\(t,)f(2\))i(do)f({)361
1204 y(writes\(outfile,)e(")43 b(",)22 b(prefix\))361
1254 y(emit_literal_synta)o(x\(out)o(file,)c(p[1]\))361
1304 y(write\(outfile,)h(")j(/*)f($0)g(=)h(",)f(p[2],)g(";)g(*/"\))361
1354 y(prefix)g(:=)g("|")318 1403 y(})318 1453 y(write\(outfile,)d(")44
b(;\\n"\))318 1503 y(nt)274 1553 y(})187 1603 y(end)145
1654 y Fp(De\014nes:)187 1694 y Fl(create_fie)o(ld_)o(no)o(nte)o(rmi)o
(nal)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)d(254.)187 1733
y Fl(field_nont)o(erm)o(in)o(al)p Fp(,)f(used)j(in)g(c)o(h)o(unk)f
(256.)145 1773 y(Uses)i Fl(emit_liter)o(al_)o(syn)o(tax)c
Fp(255)j(and)f Fl(fieldname_t)o(abl)o(e)f Fp(356a.)p
eop
%%Page: 258 258
258 257 bop 129 141 a Fv(258)83 b Fr(assembly.nw)699
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(Here)i(w)o(e)f
(remo)o(v)o(e)f(whitespace)i(from)d(b)q(et)o(w)o(een)j(the)g(op)q
(erands)g(of)-13 320 y Fp(258)88 b Fo(h)p Fn(*)16 b Fp(235a)p
Fo(i)n Fv(+)q Fo(\021)1152 b Fm(/)6 b Fp(257)171 370
y Fr(procedure)20 b(strip_asm_whitesp)o(ace\(c)o(ons\))215
420 y(every)g(o)i(:=)f(!cons.operands)e(&)j(type\(o\))e(==)h("literal")
f(do)258 469 y(o.s)h(:=)h(strip_whitespace)o(\(o.s\))215
519 y(return)e(cons)171 569 y(end)171 669 y(procedure)g
(strip_whitespace\()o(s\))215 718 y(r)h(:=)h("")215 768
y(s)f(?)h({)258 818 y(while)f(r)g(||:=)g(tab\(upto\(')f(\\t'\)\))h(do)g
(tab\(many\(')f(\\t'\)\))258 868 y(return)h(r)g(||)h(tab\(0\))215
918 y(})171 967 y(end)129 1069 y Fp(De\014nes:)171 1109
y Fl(strip_asm_)o(whi)o(tes)o(pac)o(e)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(20.)129 1148 y(Uses)i Fl(literal)d Fp(45e.)p eop
%%Page: 259 259
259 258 bop 145 569 a Fq(Chapter)32 b(12)145 777 y Fu(Supp)s(ort)38
b(for)145 901 y(pattern-matc)m(hing)145 1026 y(statemen)m(ts)145
1241 y Fv(Muc)o(h)17 b(of)e(what)h(happ)q(ens)h(here)h(is)d(the)i(dual)
f(of)f(what)h(is)g(done)g(in)g Fr(constructors.nw)p Fv(.)145
1291 y(Abstract)c(syn)o(tax)e(is)f(con)o(v)o(erted)j(to)e(patterns,)h
(but)f(this)g(time)f(the)i(free)f(v)n(ariables)g(m)o(ust)f(b)q(e)145
1341 y(disco)o(v)o(ered,)14 b(and)f(they)g(b)q(ecome)g(the)g(inputs)g
(to,)g(not)g(the)g(outputs)h(from,)c(the)k(equation-)145
1391 y(solving)f(pro)q(cess.)145 1528 y Fj(12.1)66 b(P)n(attern)23
b(syn)n(tax)g(in)h(deco)r(ding)145 1619 y Fv(F)m(ree)12
b(v)n(ariables)e(induce)i(\014eld)f(or)g(constructor)h(bindings)f
(\(although)f(w)o(e)h(ha)o(v)o(e)g(no)g(supp)q(ort)145
1669 y(y)o(et)18 b(for)f(constructor)i(bindings\).)28
b(What)17 b(w)o(e)g(really)g(w)o(an)o(t)g(is)g(for)g(all)f(the)i
(constructor)145 1719 y(stu\013)12 b(to)e(D)o(WIM.)f(Whatev)o(er)i
(that)g(is.)17 b(All)9 b(patterns)j(are)f(resolv)o(ed)g(in)o(to)f
(absolute)g(normal)145 1769 y(form)i(\(q.v.\).)2 1831
y Fp(259)89 b Fo(h)p Fn(*)15 b Fp(259)p Fo(i\021)1202
b Fp(260)5 b Fm(.)187 1881 y Fr(procedure)20 b(resolve_case_pat)o
(terns)o(\(cs\))230 1930 y(a)i(:=)f([])230 1980 y(every)g(put\(a,)g
(new_matching_arm)o(s\(!cs)o(.arms)o(,)e(cs.succptr\)\))230
2030 y(cs.arms)i(:=)g(a)230 2080 y(return)g(cs)187 2130
y(end)145 2182 y Fp(De\014nes:)187 2221 y Fl(resolve_ca)o(se_)o(pa)o
(tte)o(rns)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(21a.)145
2260 y(Uses)i Fl(new_matchi)o(ng_)o(arm)o(s)d Fp(260)h(and)h
Fl(succptr)e Fp(360b.)830 2604 y Fv(259)p eop
%%Page: 260 260
260 259 bop 129 141 a Fv(260)83 b Fr(match.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(In)g(resolving)f(an)g(arm,)g(the)h
(\014rst)h(step)f(is)g(to)g(\014nd)g(all)e(the)j(free)f(iden)o
(ti\014ers,)g(so)g(w)o(e)g(can)129 307 y(do)18 b(some)e(suitable)h
(injection)g(with)g(them.)28 b(W)m(e'll)15 b(also)i(iden)o(tify)f(the)i
(subset)h(of)e(those)129 357 y(iden)o(ti\014ers)f(that)f(b)q(ecome)g
(the)g(binding)f(instances)i(that)f(migh)o(t)e(b)q(e)j(used)g(in)e
(equations.)129 407 y(W)m(e)g(can)h(then)g(put)f(the)h(pattern)g
(\014rst)g(in)o(to)f(normal)e(form,)g(then)j(in)o(to)e(absolute)i
(normal)129 457 y(form.)192 507 y(A)o(t)g(that)h(p)q(oin)o(t,)f(w)o(e)h
(ha)o(v)o(e)f(our)h(usual)f(enco)q(ding-t)o(yp)q(e)h(pattern,)g(with)f
(\014elds)h(b)q(ound)129 557 y(to)h(expressions,)h(whic)o(h)f(is)g
(emphatically)d(no)i(go)q(o)q(d)h(for)f(deco)q(ding.)27
b(The)17 b(next)g(step)h(is)129 606 y(to)13 b(in)o(tro)q(duce)h(fresh)g
(v)n(ariables)f(to)g(the)g(\014eld)h(bindings)e(for)h(whic)o(h)g(w)o(e)
g(need)h(expressions,)129 656 y(creating)i(a)f(set)i(of)e(equations)g
(used)i(solely)d(to)i(in)o(v)o(ert)f(the)h(\014eld)g(bindings.)22
b(W)m(e'll)14 b(solv)o(e)129 706 y(that)j(set)h(of)e(equations,)h
(giving)e(us)i(our)g(go)q(o)f(solely)g(in)g(terms)g(of)h(the)g
(absolute)g(\014elds.)129 756 y(W)m(e'll)c(then)h(b)q(e)h(able)e(to)h
(apply)f(it)h(to)f(an)o(y)h(conditions.)192 806 y(Ev)o(en)o(tually)19
b(w)o(e'll)g(also)h(ha)o(v)o(e)g(to)g(deal)g(with)g(an)o(y)g(explicit)g
(equations,)i(including)129 855 y(iden)o(tifying)16 b(an)o(y)h
(additional)e(binding)h(instances)i(of)f(iden)o(ti\014ers)h(that)f(app)
q(ear)h(only)e(in)129 905 y(suc)o(h)f(equations.)192
955 y(Only)c(iden)o(ti\014ers)h(that)f(are)h(b)q(ound)f(in)g(ev)o(ery)h
(disjunct)g(can)f(reliably)g(b)q(e)h(used)g(in)f(co)q(de)129
1005 y(or)j(in)g(equations.)192 1055 y Fn(old:)20 b(In)c(principle,)f
(an)h(identi\014er)f(c)n(ould)h(b)n(e)f(b)n(ound)i(to)f(di\013er)n(ent)
f(\014elds)h(in)f(di\013er)n(ent)129 1104 y(disjuncts.)21
b(I)15 b(r)n(esolve)g(that)g(pr)n(oblem)g(by)h(forbidding)f(the)h(c)n
(onstruct;)f(a)h(single)f(identi\014er)129 1154 y(must)21
b(always)e(b)n(e)i(b)n(ound)g(to)f(the)g(same)h(\014eld,)g(although)g
(it)e(may)i(app)n(e)n(ar)f(in)g(di\013er)n(ent)129 1204
y(p)n(ositions)15 b(and)h(ther)n(efor)n(e)e(in)h(di\013er)n(ent)g
(absolute)f Fv(\014elds.)-13 1266 y Fp(260)88 b Fo(h)p
Fn(*)16 b Fp(259)p Fo(i)o Fv(+)p Fo(\021)1051 b Fm(/)5
b Fp(259)23 b(262b)t Fm(.)171 1316 y Fr(procedure)d(new_matching_arms)o
(\(a,)f(succptr\))215 1366 y(local)h(idents,)h(Ii,)g(id,)g
(patlabeltab,)e(freevars)215 1416 y(pp)i(:=)g(PPnew\(\\mdebug\))171
1466 y(###)43 b(idents)20 b(:=)i(set\(\);)e(every)h(insert\(idents,)e
(pattern_free_varia)o(bles\()o(a.pa)o(ttern)o(\)\))171
1515 y(###)43 b(rho)21 b(:=)g(newscope\(globals\))171
1565 y(###)43 b(<inject)20 b([[idents]])g(into)h([[rho]]>)171
1615 y(###)43 b(patlabeltab)19 b(:=)j(table\(\))171 1665
y(###)43 b(every)21 b(n)g(:=)h(pattern_label_na)o(mes\(a)o(.pat)o
(tern\))c(do)171 1715 y(###)87 b(patlabeltab[n])18 b(:=)k(n)171
1764 y(###)43 b(push\(rho,)20 b(patlabeltab\))215 1814
y(freevars)g(:=)h(table\(\))215 1864 y(x)g(:=)h(pnf\(a.pattern,)c
(globals,)j(freevars\))215 1914 y(PPxwrite\(\\pp,)e("after)h(pnf)h(we)h
(have)f(case)g(arm)g($t$o",)f(ppexpimage\(x\),)f("$b"\))215
1964 y(x)i(:=)h(bind_patlabel_n)o(ames\()o(x,)d(1\))215
2014 y(PPxwrite\(\\pp,)g("after)h(binding)h(patlabel)f(names)g(we)i
(have)f(case)g(arm)g($t$o",)f(ppexpimage\(x\),)f("$b"\))215
2063 y(every)h(set_patlabel_offset)o(s\(!x.)o(disju)o(ncts)o(\))215
2113 y(PPxwrite\(\\pp,)f("after)h(setting)h(offsets)f(we)h(have)g(case)
g(arm)g($t$o",)g(ppexpimage\(x\),)e("$b"\))215 2163 y(a.pattern)g(:=)j
(anf\(x\))215 2213 y(a.pattern)d(:=)j(gsubst\(a.pattern,)c
(always_fail\))63 b(#)22 b(remove)e(wildcards)g(and)h(instances,)1217
2263 y(#)h(turn)f(latent)f(to)i(real)e(labels)215 2312
y(PPxwrite\(\\pp,)f("after)h(anf+subst)g(we)i(have)e(case)h(arm)h
($t$o",)e(ppexpimage\(a.patte)o(rn\),)e("$b"\))215 2362
y Fo(h)p Fn(r)n(emove)c(fr)n(om)g Fr(freevars)g Fn(names)h(of)g(p)n
(attern)g(lab)n(els)f(in)h Fr(a.pattern)e Fp(261a)p Fo(i)215
2412 y Fr(if)21 b(*freevars)f(>)h(0)h(then)258 2462 y(write\(\\mdebug,)
d("caught)h(free)h(variables:",)f(envimage\(freevar)o(s,)f
("freevars"\)\))p eop
%%Page: 261 261
261 260 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(match.nw)81 b Fv(261)230 258 y Fo(h)p Fn(dump)16
b(image)f(of)g(c)n(ase)g(arm)f(b)n(efor)n(e)h(simpli\014c)n(ation)f
Fp(261b)p Fo(i)230 307 y Fr(x)22 b(:=)f(simplify\(a.pattern\))230
357 y(if)h(not)f(exps_eq\(x,)f(a.pattern\))f(then)i({)274
407 y(a.pattern)f(:=)h(x)274 457 y Fo(h)p Fn(dump)16
b(image)f(of)f(c)n(ase)h(arm)g(after)f(simpli\014c)n(ation)h
Fp(261c)p Fo(i)230 507 y Fr(})22 b(else)274 557 y(write\(\\mdebug,)d
("Case)i(arm)g(doesn't)f(simplify"\))230 606 y(idents)h(:=)g
(all_disjuncts_ids\(a)o(.patt)o(ern,)d(free_var_or_patlabe)o(lbind)o
(ing_n)o(ame,)841 656 y("Ignoring)i(bound)g(identifier)g(",)841
706 y(")h(because)g(it)g(doesn't)f(appear)h(in)g(every)g(disjunct"\))
230 756 y(if)h(*idents)e(>)i(0)f(then)274 806 y(write\(\\mdebug,)e
("Saw)i(binding)f(instances)g(of)h(",)h(commafy\(sort\(iden)o(ts\)\)\))
230 855 y(else)274 905 y(write\(\\mdebug,)d("No)i(binding)f
(instances"\))230 955 y(a.soln)h(:=)g(solve\(balance_eqns\()o(\\a.eq)o
(ns\),)d(idents\))230 1005 y Fo(h)p Fn(c)n(onvert)d(\014eld)h(bindings)
f(to)g(answers,)f(split)g(arm)h(as)g(ne)n(e)n(de)n(d,)g(and)h(susp)n
(end)f(r)n(esults)f Fp(263a)p Fo(i)187 1055 y Fr(end)145
1107 y Fp(De\014nes:)187 1146 y Fl(new_matchi)o(ng_)o(ar)o(ms)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(259.)145 1185 y(Uses)j
Fl(all_disjunc)o(ts_)o(ids)c Fp(58,)j Fl(always_fail)d
Fp(262b,)j Fl(anf)g Fp(269,)g Fl(arm)g Fp(271b,)f Fl(balance_eq)o(ns)f
Fp(148b,)187 1225 y Fl(bind_patla)o(bel)o(_n)o(ame)o(s)15
b Fp(57,)i Fl(disjunct)e Fp(55,)i Fl(envimage)e Fp(27a,)h
Fl(exps_eq)g Fp(84c,)187 1264 y Fl(free_var_o)o(r_p)o(at)o(lab)o(elb)o
(ind)o(ing)o(_n)o(ame)11 b Fp(262c,)h Fl(globals)g Fp(32a,)h
Fl(gsubst)f Fp(120a,)g Fl(inject)h Fp(29,)187 1304 y
Fl(mdebug)e Fp(18a,)h Fl(newscope)f Fp(26b,)h Fl(patlabel)f
Fp(55,)h Fl(pattern)f Fp(55,)i Fl(pattern_fr)o(ee_)o(va)o(ria)o(ble)o
(s)d Fp(78b,)187 1343 y Fl(pattern_la)o(bel)o(_n)o(ame)o(s)h
Fp(79a,)i Fl(pnf)g Fp(74,)g Fl(ppexpimage)e Fp(101d,)i
Fl(set_patla)o(bel)o(_of)o(fs)o(ets)e Fp(59c,)187 1383
y Fl(simplify)e Fp(92a,)h Fl(solve)g Fp(136a,)g Fl(subst)g
Fp(88b,)h(and)f Fl(succptr)g Fp(360b.)-15 1466 y(261a)88
b Fo(h)p Fn(r)n(emove)15 b(fr)n(om)f Fr(freevars)f Fn(names)j(of)f(p)n
(attern)f(lab)n(els)h(in)g Fr(a.pattern)e Fp(261a)p Fo(i)n(\021)94
b Fp(\(260\))187 1515 y Fr(every)21 b(delete\(freevars)o(,)e
(key\(\\\(!a.pattern.d)o(isju)o(ncts\))o(.patl)o(abelb)o(indin)o
(gs\)\))145 1567 y Fp(Uses)12 b Fl(pattern)d Fp(55.)-17
1659 y(261b)88 b Fo(h)p Fn(dump)16 b(image)f(of)g(c)n(ase)g(arm)f(b)n
(efor)n(e)h(simpli\014c)n(ation)f Fp(261b)p Fo(i)o(\021)380
b Fp(\(260\))187 1708 y Fr(PPxwrites\(\\pp,)19 b("Before)h
(simplification,)f(case)i(arm)g(is)g($t${$c",)f(ppexpimage\(a.patter)o
(n\)\))187 1758 y(PPxwrites\(\\pp,)f("$o{)i(",)g(ppexpimage\(\\a.eqns)o
(\),)e(")i(}"\))187 1808 y(PPxwrite\(\\pp,)e("$}$b"\))145
1860 y Fp(Uses)12 b Fl(arm)f Fp(271b,)f Fl(pattern)f
Fp(55,)i(and)f Fl(ppexpimage)f Fp(101d.)-13 1951 y(261c)88
b Fo(h)p Fn(dump)16 b(image)f(of)g(c)n(ase)g(arm)f(after)g(simpli\014c)
n(ation)h Fp(261c)p Fo(i)o(\021)404 b Fp(\(260\))187
2001 y Fr(PPxwrites\(\\pp,)19 b("After)h(simplification,)f(case)i(arm)g
(is)g($t${$c",)g(ppexpimage\(a.pa)o(ttern)o(\)\))187
2051 y(PPxwrites\(\\pp,)e("$o{)i(",)g(ppexpimage\(\\a.eqns)o(\),)e(")i
(}"\))187 2101 y(PPxwrite\(\\pp,)e("$}$b"\))145 2202
y Fp(Uses)12 b Fl(arm)f Fp(271b,)f Fl(pattern)f Fp(55,)i(and)f
Fl(ppexpimage)f Fp(101d.)p eop
%%Page: 262 262
262 261 bop 129 141 a Fv(262)83 b Fr(match.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(Note)f(that)g(w)o(e're)h(letting)f
(\014eld)g(names)f(b)q(e)i(used)g(either)g(to)f(stand)g(for)g(patterns)
i(or)e(to)129 307 y(b)q(e)k(binding)e(instances)i(of)e(in)o(tegers)i
(\(just)f(lik)o(e)f(prede\014ned)i(iden)o(ti\014ers\).)22
b(W)m(e)15 b(think)f(it's)129 357 y(OK)i(to)e(allo)o(w)f(b)q(oth,)h
(but)h(w)o(e're)g(not)g(sure.)21 b(In)14 b(an)o(y)h(case,)g(it)f(w)o
(as)h(to)q(o)f(anno)o(ying)f(not)i(to)129 407 y(allo)o(w)e(\014led)h
(names)f(as)h(binding)f(instances)i(in)e(constructor)j(applications.)
-31 469 y Fp(262a)88 b Fo(h)p Fn(inje)n(ct)15 b Fr(idents)f
Fn(into)h Fr(rho)f Fp(262a)p Fo(i)o(\021)171 519 y Fr(every)21
b(i)g(:=)h(!idents)e(do)215 569 y(case)h(type\(symtab[i]\))d(of)k({)258
619 y("field")86 b(:)21 b(add_to_rho\(i,)f(inject\(constrai)o(nts2p)o
(atter)o(n\(fie)o(ldbin)o(ding)o(\(symt)o(ab[i])o(,)f(i\)\),)999
669 y(i,)i(&null\),)g(rho\))258 718 y("pattern")42 b(:)21
b(add_to_rho\(i,)f(inject\(symtab[i)o(],)f(&null,)h(&null\),)h(rho\))
258 768 y("constype")f(:)324 818 y(add_to_rho\()389 868
y(i,)389 918 y(inject\(seqpx\(labe)o(l2pat)o(tern\()o(i\),)672
967 y(consinput_pattern\()o(ipt)f(:=)i(input\(Ewildcard\(i\))o(,)e
(symtab[i]\)\)\),)541 1017 y(&null,)541 1067 y(ipt\),)389
1117 y(rho\))258 1167 y("null")108 b(:)21 b(add_to_rho\(i,)f
(inject\(&null,)f(i,)i(&null\),)f(rho\))258 1217 y(default)86
b(:)21 b(error\("I)g(can't)f(make)h(sense)g(of)g(",)h(image\(i\),)e(")h
(\(a)h(",)f(type\(symtab[i]\),)672 1266 y("\))h(within)e(a)i
(pattern"\))215 1316 y(})129 1368 y Fp(Uses)13 b Fl(add_to_rho)d
Fp(26a,)h Fl(consinput_p)o(at)o(ter)o(n)f Fp(171a,)h
Fl(constraints)o(2p)o(att)o(ern)e Fp(61,)j Fl(constype)e
Fp(159,)171 1408 y Fl(field)i Fp(55,)g Fl(fieldbindin)o(g)f
Fp(55,)h Fl(inject)f Fp(29,)i Fl(input)f Fp(46a,)g Fl(label2patt)o(ern)
e Fp(60a,)i Fl(pattern)f Fp(55,)171 1447 y Fl(seqpx)f
Fp(64a,)g(and)h Fl(symtab)f Fp(32a)g(367.)-33 1530 y(262b)88
b Fo(h)p Fn(*)16 b Fp(259)p Fo(i)o Fv(+)p Fo(\021)1054
b Fm(/)6 b Fp(260)22 b(262c)5 b Fm(.)171 1580 y Fr(procedure)20
b(always_fail\(\))215 1630 y(fail)171 1679 y(end)129
1731 y Fp(De\014nes:)171 1771 y Fl(always_fai)o(l)p Fp(,)9
b(used)h(in)h(c)o(h)o(unk)f(260.)129 1810 y(Uses)i Fl(fail)e
Fp(410.)-29 1901 y(262c)88 b Fo(h)p Fn(*)16 b Fp(259)p
Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(262b)22 b(263c)5
b Fm(.)171 1951 y Fr(procedure)20 b(free_var_or_patla)o(belbi)o(nding)o
(_nam)o(e\(d\))215 2001 y(suspend)g(free_variables\(d\))e(|)k
(key\(\\d.patlabelb)o(indin)o(gs\))171 2051 y(end)129
2103 y Fp(De\014nes:)171 2142 y Fl(free_var_o)o(r_p)o(atl)o(abe)o(lb)o
(ind)o(ing)o(_na)o(me)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(260.)129
2182 y(Uses)i Fl(free_variab)o(les)c Fp(84b.)p eop
%%Page: 263 263
263 262 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(match.nw)81 b Fv(263)-15 258 y Fp(263a)88 b Fo(h)p
Fn(c)n(onvert)15 b(\014eld)g(bindings)h(to)f(answers,)f(split)g(arm)h
(as)g(ne)n(e)n(de)n(d,)g(and)h(susp)n(end)f(r)n(esults)f
Fp(263a)p Fo(i)o(\021)86 b Fp(\(260\))187 307 y Fr(acount)20
b(:=)i(0)187 357 y(lasta)f(:=)g(&null)187 407 y(every)g(d)g(:=)h
(!a.pattern.disj)o(uncts)c(do)k({)230 457 y(s)g(:=)f
(fieldbindings_to_so)o(ln\(d,)d(idents\))230 507 y(l)k(:=)f(if)h
(\\succptr)e(then)h(d.length)f(else)h(&null)230 557 y(if)h
(\(\\lasta\).imp_sol)o(n)d(===)i(s)h(&)f(lasta.patlen)f(===)h(l)g(&)296
606 y(patlabelbindings)o(_matc)o(h\(las)o(ta.pa)o(ttern)o(.dis)o(junct)
o(s[1].)o(patla)o(belbi)o(nding)o(s,)797 656 y(d.patlabelbinding)o(s\))
230 706 y(then)274 756 y(put\(lasta.pattern)o(.disj)o(uncts)o(,)e(d\))
230 806 y(else)i({)274 855 y Fo(h)p Fn(show)15 b(last)f(answers)h(and)h
(c)n(onditions)f Fp(263b)p Fo(i)274 905 y Fr(suspend)20
b(\\lasta)274 955 y(lasta)h(:=)g(copy\(a\))274 1005 y(lasta.pattern)e
(:=)i(copy\(a.pattern\))274 1055 y(lasta.pattern.dis)o(junct)o(s)e(:=)i
([d])274 1104 y(lasta.imp_soln)e(:=)i(s)274 1154 y(lasta.patlen)e(:=)j
(l)274 1204 y(acount)f(+:=)g(1)230 1254 y(})187 1304
y(})187 1354 y(if)g(acount)g(>)g(1)h(then)230 1403 y(write\(\\mdebug,)d
("split)i(case)g(arm)g(at)g(",)h(image\(a.file\),)d(",)i(line)g(",)g
(a.line,)557 1453 y(")h(because)e(of)i(varying)e(implicit)g(solutions)g
(or)h(pattern)g(lengths"\))187 1503 y Fo(h)p Fn(show)15
b(last)f(answers)h(and)g(c)n(onditions)h Fp(263b)p Fo(i)187
1553 y Fr(suspend)k(\\lasta)145 1604 y Fp(Uses)15 b Fl(arm)f
Fp(271b,)g Fl(fieldbindi)o(ngs)o(_to)o(_s)o(oln)e Fp(264,)h
Fl(file)h Fp(359a,)g Fl(line)f Fp(359a,)h Fl(mdebug)f
Fp(18a,)187 1643 y Fl(patlabelbi)o(ndi)o(ng)o(s_m)o(atc)o(h)c
Fp(263c,)h Fl(pattern)f Fp(55,)i Fl(split)f Fp(277a,)g(and)h
Fl(succptr)e Fp(360b.)-17 1732 y(263b)88 b Fo(h)p Fn(show)15
b(last)g(answers)f(and)i(c)n(onditions)f Fp(263b)p Fo(i)o(\021)581
b Fp(\(263a\))187 1781 y Fr(write\(\\mdebug,)19 b("Answers)h(and)h
(conditions)f(\(",)h(image\(\\lasta\),)e("\))i(at)h(length)e(",)514
1831 y(\(\\lasta\).patlen,)514 1881 y(")h(\(",)g
(image\(\(\\lasta\).imp_s)o(oln\))o(,)e("\):",)i(solnimage\(\(\\lasta)o
(\).im)o(p_sol)o(n\)\))145 1932 y Fp(Uses)12 b Fl(mdebug)e
Fp(18a)g(and)h Fl(solnimage)d Fp(377c.)-13 2021 y(263c)88
b Fo(h)p Fn(*)15 b Fp(259)p Fo(i)p Fv(+)p Fo(\021)1054
b Fm(/)6 b Fp(262c)22 b(264)5 b Fm(.)187 2070 y Fr(procedure)20
b(patlabelbindings)o(_matc)o(h\(t1,)e(t2\))230 2120 y(if)131
b(/t1)21 b(then)g(return)f(\(/t2)h(|)h(*t2)f(=)h(0,)f(t1\))230
2170 y(else)g(if)h(/t2)f(then)g(return)f(\(/t1)h(|)h(*t1)f(=)h(0,)f
(t1\))230 2220 y(else)g(if)h(k)f(:=)h(key\(t1\))e(&)i(\(/t2[k])e(|)i
(t1[k])e(~=)i(t2[k]\))e(then)h(fail)230 2270 y(else)g(if)h(k)f(:=)h
(key\(t2\))e(&)i(\(/t1[k])e(|)i(t1[k])e(~=)i(t2[k]\))e(then)h(fail)230
2319 y(else)g(return)g(t1)187 2369 y(end)145 2420 y Fp(De\014nes:)187
2460 y Fl(patlabelbi)o(ndi)o(ng)o(s_m)o(atc)o(h)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(263a.)145 2499 y(Uses)i Fl(fail)e
Fp(410.)p eop
%%Page: 264 264
264 263 bop 129 141 a Fv(264)83 b Fr(match.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(F)m(or)g(eac)o(h)h(disjunct,)g(w)o(e)g
(turn)g(\014eld)g(bindings)f(in)o(to)g(answ)o(ers)i(and)f(conditions,)f
(using)129 307 y(the)i(follo)o(wing)c(steps:)180 390
y(1.)20 b(Remo)o(v)o(e)15 b(all)g(the)j(\014eld)e(bindings)g(from)f
(the)i(constrain)o(ts,)g(making)d(a)j(new)g(equa-)233
440 y(tion)g(for)g(eac)o(h)g(\014eld)h(binding.)27 b(Because)19
b(the)f(solv)o(e)f(w)o(orks)g(with)g(v)n(ariables,)g(use)233
490 y(the)f(function)e Fr(afield_var)f Fv(to)i(map)e(eac)o(h)j
(absolute)f(\014eld)g(to)g(its)g(corresp)q(onding)233
540 y(v)n(ariable.)28 b(The)18 b(table)g Fr(afield_vars_inve)o(rse)c
Fv(is)k(used)g(later)g(to)f(p)q(erform)g(the)233 590
y(in)o(v)o(erse)f(mapping.)k(The)c(v)n(ariables)e(in)o(tro)q(duced)i(b)
o(y)f Fr(afield_var)e Fv(stand)j(for)f(the)233 640 y(absolute)e
(\014elds)g(in)f(the)h(bindings,)f(and)h(they)g(are)g(exactly)f(the)i
(v)n(ariables)d(that)i(are)233 689 y(the)i(inputs)f(to)g(the)g
(equations.)180 772 y(2.)20 b(Solv)o(e)13 b(the)h(equations,)f(and)g
(build)g(the)h(answ)o(ers)g(table)g(b)o(y)f(using)g(the)h(v)n(alues)f
(they)233 822 y(giv)o(e)j(to)f(the)i(iden)o(ti\014ers)f(in)g
Fr(idents)p Fv(.)22 b(A)o(t)16 b(this)g(p)q(oin)o(t)f(w)o(e)h(in)o(v)o
(erse-map)f(the)i(v)n(ari-)233 872 y(ables,)c(so)h(the)g(results)h(are)
f(free)g(in)f(absolute)h(\014elds,)f(not)h(in)f(these)i(auxiliary)d(v)n
(ari-)233 922 y(ables.)180 1005 y(3.)20 b(Add)d(an)o(y)e(constrain)o
(ts)i(pro)q(duced)h(b)o(y)e(the)g(equations)h(to)f(the)g(conditions)g
(of)g(the)233 1055 y(disjunct,)e(p)q(erforming)e(the)j(same)e(in)o(v)o
(erse)h(mapping.)-13 1138 y Fp(264)88 b Fo(h)p Fn(*)16
b Fp(259)p Fo(i)o Fv(+)p Fo(\021)1039 b Fm(/)5 b Fp(263c)22
b(265c)5 b Fm(.)171 1187 y Fr(procedure)20 b(fieldbindings_to_)o
(soln\()o(d,)f(idents\))215 1237 y(local)h(newconstraints,)f
(newconditions,)g(eqns,)i(soln,)f(inputs,)h(x,)g(result)215
1287 y(every)f(newconstraints)f(|)j(eqns)f(:=)g([])215
1337 y(inputs)f(:=)h(set\(\))215 1387 y(every)f(insert\(inputs,)f
(key\(\\d.patlabelbin)o(dings)o(\)\))215 1437 y(afield_vars)g(:=)i
(table\(\))215 1486 y(every)f(c)i(:=)f(!d.aconstraints)e(do)258
1536 y(case)i(type\(c\))f(of)i({)302 1586 y("constraint")63
b(:)21 b(put\(newconstraints)o(,)e(c\))302 1636 y("fieldbinding")g(:)i
({)367 1686 y(insert\(inputs,)e(x)j(:=)f(afield_var\(c.fiel)o(d\)\))367
1735 y(put\(eqns,)f(eqn\(x,)h("=",)g(c.code\)\))302 1785
y(})302 1835 y(default)f(:)i(impossible\("cons)o(train)o(t)d(type"\))
258 1885 y(})215 1935 y(d.aconstraints)f(:=)k(newconstraints)215
1985 y(newconditions)d(:=)i(set\(\))215 2034 y(every)f(e)i(:=)f
(!\\d.conditions)e(do)258 2084 y(case)i(type\(e\))f(of)i({)302
2134 y("eqn")64 b(:)22 b(put\(eqns,)e(e\))302 2184 y(default)g(:)i
(insert\(newcondit)o(ions,)c(e\))258 2234 y(})215 2283
y(d.conditions)h(:=)i(if)h(*newconditions)d(>)i(0)h(then)f
(newconditions)e(else)i(&null)215 2333 y(soln)g(:=)g
(solve\(balance_eqn)o(s\(eqn)o(s\),)e(inputs\))258 2383
y(#)j(soln.answers)d(:)j(bound)e([[idents]])g(->)h(exps)g(in)h
(afield_vars)215 2433 y(result)e(:=)h(solution\(table\(\),)e(set\(\)\))
215 2483 y Fo(h)p Fn(make)c(sur)n(e)f(ther)n(e's)h(an)g(answer)g(for)f
(every)h(non-lab)n(el)g(in)g Fr(idents)e Fp(265a)p Fo(i)p
eop
%%Page: 265 265
265 264 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(match.nw)81 b Fv(265)230 258 y Fr(every)21 b(id)h(:=)f(!idents)f
(do)274 307 y(result.answers[id)o(])f(:=)318 357 y(if)i
(member\(\\d.patlabe)o(lbind)o(ings,)d(id\))j(then)361
407 y(binop\(the_global_p)o(c,)e("+",)i(d.patlabelbindin)o(gs[id)o(]\))
318 457 y(else)361 507 y(super_simplify\(sub)o(st_ta)o(b\(sol)o(n.ans)o
(wers)o([id],)d(afield_vars_inverse)o(,)h(1\)\))448 557
y(#)j(is)f(super_simplify)e(really)i(safe)g(here?)42
b(dunno...)230 606 y(every)21 b(insert_condition\(r)o(esult)o(.cons)o
(train)o(ts,)427 656 y(super_simplify\()o(subst)o(_tab\()o(!soln)o
(.con)o(strai)o(nts,)d(afield_vars_inverse)o(,)h(1\)\)\))230
706 y(return)i(unique_soln\(resul)o(t\))187 756 y(end)145
808 y Fp(De\014nes:)187 847 y Fl(fieldbindi)o(ngs)o(_t)o(o_s)o(oln)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(263a.)145 887 y(Uses)j
Fl(afield_va)o(r)c Fp(265c,)i Fl(afield_var)o(s)e Fp(265c,)i
Fl(afield_vars)o(_in)o(ve)o(rse)e Fp(265c,)h Fl(balance_eqn)o(s)f
Fp(148b,)187 926 y Fl(binop)i Fp(113a,)h Fl(constraint)e
Fp(55,)i Fl(constraint)o(s)e Fp(136a,)i Fl(eqn)g Fp(83c,)g
Fl(field)g Fp(55,)g Fl(fieldbindi)o(ng)e Fp(55,)187 965
y Fl(insert_con)o(dit)o(io)o(n)f Fp(126c,)h Fl(solution)f
Fp(136b,)h Fl(solve)g Fp(136a,)g Fl(subst_tab)f Fp(89a,)i
Fl(super_sim)o(pli)o(fy)d Fp(92c,)187 1005 y Fl(the_global)o(_pc)g
Fp(19d,)i(and)h Fl(unique_sol)o(n)e Fp(266a.)-15 1096
y(265a)88 b Fo(h)p Fn(make)16 b(sur)n(e)e(ther)n(e's)g(an)i(answer)e
(for)h(every)f(non-lab)n(el)i(in)e Fr(idents)g Fp(265a)p
Fo(i)o(\021)138 b Fp(\(264\))187 1146 y Fr(if)21 b(\(id)g(:=)h
(!idents,)e(not)h(member\(\\d.patlabel)o(bind)o(ings,)d(id\),)j
(/soln.answers[id]\))d(then)j({)230 1196 y(PPxwrite\(PPnew\(&err)o
(out\),)o("Erro)o(r:)e(trouble)h(with)h(disjunct)f(${$t$o",)g
(ppexpimage\(d\),)f("$b$}"\))230 1246 y Fo(h)p Fn(make)d
Fr(l)e Fn(list)g(of)h Fr(idents)f Fn(not)h(in)g Fr(soln.answers)d
Fp(265b)p Fo(i)230 1295 y Fr(error\("Can't)20 b(solve)g(for)i(",)f
(commafy\(sort\(l\)\),)d(envimage\(soln.answe)o(rs,)h("soln.answers"\))
o(\))187 1345 y(})145 1397 y Fp(Uses)12 b Fl(disjunct)d
Fp(55,)i Fl(envimage)e Fp(27a,)h Fl(ppexpimage)e Fp(101d,)i(and)h
Fl(solve)f Fp(136a.)208 1468 y Fv(Better)15 b(error)g(message:)1010
b Fk(\031Change)14 b(#15)-17 1530 y Fp(265b)88 b Fo(h)p
Fn(make)16 b Fr(l)e Fn(list)g(of)h Fr(idents)f Fn(not)h(in)g
Fr(soln.answers)d Fp(265b)p Fo(i)o(\021)388 b Fp(\(265a\))187
1580 y Fr(l)21 b(:=)h([])187 1630 y(every)f(/soln.answers[x)d(:=)k
(!idents])e(&)h(not)h(member\(\\d.patla)o(belbi)o(nding)o(s,)d(x\))i
(do)230 1679 y(put\(l,)g(x\))-13 1762 y Fp(265c)88 b
Fo(h)p Fn(*)15 b Fp(259)p Fo(i)p Fv(+)p Fo(\021)1052
b Fm(/)6 b Fp(264)22 b(266a)5 b Fm(.)187 1812 y Fr(global)20
b(afield_vars,)g(afield_vars_inve)o(rse)187 1862 y(procedure)g
(afield_var\(af\))230 1912 y(initial)h({)274 1962 y(every)g
(afield_vars)e(|)j(afield_vars_inver)o(se)d(:=)i(table\(\))230
2011 y(})230 2061 y(afield_vars_inverse)o([/afi)o(eld_v)o(ars[a)o(f])e
(:=)i(fresh_variable\(af.)o(field)o(.name)o(\)])e(:=)i(af)230
2111 y(return)g(afield_vars[af])187 2161 y(end)145 2213
y Fp(De\014nes:)187 2252 y Fl(afield_var)o Fp(,)9 b(used)h(in)i(c)o(h)o
(unk)d(264.)187 2292 y Fl(afield_var)o(s)p Fp(,)f(used)j(in)g(c)o(h)o
(unk)f(264.)187 2331 y Fl(afield_var)o(s_i)o(nv)o(ers)o(e)p
Fp(,)f(used)h(in)h(c)o(h)o(unk)f(264.)145 2371 y(Uses)i
Fl(field)e Fp(55)h(and)g Fl(fresh_var)o(iab)o(le)d Fp(155b.)p
eop
%%Page: 266 266
266 265 bop 129 141 a Fv(266)83 b Fr(match.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(266a)88 b Fo(h)p Fn(*)16
b Fp(259)p Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(265c)23
b(266b)t Fm(.)171 307 y Fr(procedure)d(unique_soln\(soln\))215
357 y(static)g(cache)215 407 y(initial)g(cache)h(:=)g(table\(\))215
457 y(/cache[*soln.co)o(nstra)o(ints])d(:=)k(table\(\))215
507 y(t)f(:=)h(cache[*soln.con)o(strai)o(nts])215 557
y(l)f(:=)h(sort\(soln.answe)o(rs\))215 606 y(k)f(:=)h("";)215
656 y(every)e(p)i(:=)f(!sort\(soln.answers\))d(do)k(k)f(||:=)g(p[1])g
(||)g(")h(")g(||)f(type\(p[2]\))f(||)h(")h(")215 706
y(/t[k])e(:=)i(set\(\))215 756 y(if)f(s)h(:=)f(!t[k])g(&)g
(answers_eq\(s.answer)o(s,)e(soln.answers\))g(&)280 806
y(exps_eq\(s.constra)o(ints,)f(soln.constraints\))g(then)258
855 y(return)j(s)215 905 y(else)g({)258 955 y(insert\(t[k],)e(soln\))
258 1005 y(return)i(soln)215 1055 y(})171 1104 y(end)129
1156 y Fp(De\014nes:)171 1196 y Fl(unique_sol)o(n)p Fp(,)9
b(used)h(in)h(c)o(h)o(unk)f(264.)129 1235 y(Uses)i Fl(answers_eq)c
Fp(266b,)i Fl(constraints)e Fp(136a,)i(and)h Fl(exps_eq)e
Fp(84c.)-33 1327 y(266b)88 b Fo(h)p Fn(*)16 b Fp(259)p
Fo(i)o Fv(+)p Fo(\021)1152 b Fm(/)6 b Fp(266a)171 1376
y Fr(procedure)20 b(answers_eq\(a1,)f(a2\))215 1426 y(if)i(a1)g(===)g
(a2)h(then)f(return)215 1476 y(*a1)g(=)g(*a2)g(|)h(fail)215
1526 y(if)f(id)g(:=)h(key\(a1\))e(&)i(not)f(exps_eq\(a1[id],)d
(\\a2[id]\))j(then)g(fail)215 1576 y(return)171 1625
y(end)129 1677 y Fp(De\014nes:)171 1717 y Fl(answers_eq)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(266a.)129 1756 y(Uses)i
Fl(exps_eq)d Fp(84c)i(and)g Fl(fail)f Fp(410.)p eop
%%Page: 267 267
267 266 bop 145 569 a Fq(Chapter)32 b(13)145 777 y Fu(Generating)40
b(decision)e(trees)145 992 y Fv(The)16 b(crux)h(of)e(the)h(problem)f
(is)g(to)h(transform)e(a)i Fn(matching)h(statement)f
Fv(in)o(to)f(a)g Fn(de)n(cision)145 1042 y(tr)n(e)n(e)p
Fv(.)i(A)12 b(matc)o(hing)e(statemen)o(t)i(has)h(a)e
Fn(value)p Fv(,)i(a)e(sequence)k(of)c Fn(arms)p Fv(,)h(and)g(a)f
Fn(tr)n(ailer)p Fv(.)16 b(Eac)o(h)145 1092 y(arm)e(has)g(a)h(pattern,)g
(and)g(co)q(de)g(to)g(b)q(e)g(executed.)23 b(When)15
b(the)g(matc)o(hing)e(statemen)o(t)i(is)145 1142 y(executed,)d(it)d(c)o
(ho)q(oses)i(the)f(\014rst)h(arm)d(whose)i(pattern)g(matc)o(hes)f(the)i
(v)n(alue,)e(then)h(executes)145 1192 y(the)15 b(corresp)q(onding)h(co)
q(de,)f(then)g(executes)i(the)e(trailer.)20 b(I)15 b(generate)h(a)e
Fn(de)n(cision)i(tr)n(e)n(e)e Fv(to)145 1241 y(do)i(the)h(job.)25
b(Eac)o(h)16 b(in)o(ternal)g(no)q(de)h(of)e(the)i(decision)f(tree)i
(tests)g(a)e(\014eld)g(of)f(a)h(w)o(ord.)25 b(It)145
1291 y(then)17 b(c)o(ho)q(oses)g(an)f(edge)g(\(c)o(hild\))g(based)h(on)
e(what)h(range)g(constrain)o(ts)h(can)f(b)q(e)h(satis\014ed)145
1341 y(b)o(y)e(the)h(v)n(alue)e(of)g(that)h(\014eld,)g(and)g(it)f(con)o
(tin)o(ues)i(testing)f(\014elds)h(un)o(til)e(it)g(reac)o(hes)j(a)d
(leaf,)145 1391 y(at)g(whic)o(h)g(time)e(it)i(executes)i(the)e(co)q(de)
h(asso)q(ciated)g(with)e(that)h(leaf.)208 1441 y(The)d(goal)g(of)g
(tree)h(generation)g(is)f(not)h(to)f(generate)i(just)e(an)o(y)g(tree,)i
(but)f(the)g(tree)h(with)145 1491 y(the)f(few)o(est)g(no)q(des.)18
b(This)11 b(problem)f(is)h(NP-complete,)g(so)g(I)g(apply)g(a)f(few)i
(heuristics.)18 b(The)145 1540 y(results,)d(at)f(least)g(for)f(the)i
(mac)o(hine)d(descriptions)j(I)f(use,)g(seem)g(to)g(b)q(e)g(as)g(go)q
(o)q(d)g(as)f(what)145 1590 y(I)h(w)o(ould)f(come)g(up)h(with)g(b)o(y)f
(hand.)830 2604 y(267)p eop
%%Page: 268 268
268 267 bop 129 141 a Fv(268)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(When)f(a)g(pattern)g(is)g(in)g(normal)d
(form,)i(it)g(is)h(not)g(ob)o(vious)f(what)h(w)o(ord)g(is)g(tested)h(b)
o(y)f(a)129 307 y(particular)i(range)g(constrain)o(t;)f(one)h(needs)h
(to)f(kno)o(w)f(the)h(p)q(osition)f(of)g(the)i(sequen)o(t)f(con-)129
357 y(taining)g(the)h(range)g(constrain)o(t.)20 b(T)m(o)14
b(mak)o(e)f(the)i(problem)e(simpler,)g(I)h(put)h(the)g(patterns)129
407 y(in)o(to)f(a)f(new)i Fn(absolute)g(normal)f(form)p
Fv(,)f(whic)o(h)h(is)g(describ)q(ed)h(b)o(y)f(the)g(follo)o(wing)e
(rules:)180 490 y(1.)20 b(Eac)o(h)e(disjunction)f(con)o(tains)g(not)g
(a)h(list)e(of)h(sequen)o(ts)i(but)f(a)f(set)h(of)f(range)g(con-)233
540 y(strain)o(ts)e(and)e(\014eld)h(bindings.)180 623
y(2.)20 b(The)13 b(range)g(constrain)o(ts)g(and)g(\014eld)f(bindings)g
(are)h(made)f(\\absolute")g(b)o(y)g(using)h(an)233 673
y Fr(absolute_field)f Fv(in)i(place)g(of)g(a)g Fr(field)p
Fv(.)k(The)d Fr(absolute_field)d Fv(giv)o(es)i(the)h(bit)233
723 y(o\013set)g(of)e(the)h(w)o(ord)f(con)o(taining)f(the)j(\014eld)e
(\(its)h(size)g(is)f(a)o(v)n(ailable)f(from)f(the)k(\014eld's)233
772 y(class\).)129 855 y(In)f(supp)q(ort)h(of)e(this)h(sc)o(heme,)g(w)o
(e)g(use)h(\\absolute)e(disjuncts.")-13 918 y Fp(268)88
b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o(\021)1202 b Fp(269)5
b Fm(.)171 967 y Fr(record)21 b(adisjunct\(acons)o(train)o(ts,)e(name,)
h(conditions,)g(length,)g(patlabelbindings\))1043 1017
y(#)h(list)g(of)h(absolute)e(constraints,)f(name,)i(conds)171
1067 y(record)g(absolute_field\()o(field)o(,)e(offset\))86
b(#)21 b(used)g(to)h(make)f(absolute)f(constraints)129
1119 y Fp(De\014nes:)171 1158 y Fl(absolute_f)o(iel)o(d)p
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)e(85a,)g(93a,)h(104a,)f(117c,)g
(122b,)g(271a,)h(298b,)f(301a,)g(335b,)g(346c,)212 1198
y(371b,)h(and)f(372a.)171 1237 y Fl(adisjunct)p Fp(,)e(used)j(in)g(c)o
(h)o(unks)f(85a,)g(93a,)h(94b,)f(103a,)g(117b,)h(122a,)f(269,)g(279a,)g
(370b,)g(and)h(372a.)129 1277 y(Uses)h Fl(constraints)c
Fp(136a,)i Fl(field)g Fp(55,)h(and)g Fl(used)f Fp(136a.)129
1339 y Fv(W)m(e)15 b(ha)o(v)o(e)f(to)h(store)h(the)f(length)g
(explicitly)e(in)i(an)f Fr(adisjunct)p Fv(,)f(b)q(ecause)j(sequen)o(ts)
g(that)129 1389 y(constrain)11 b(no)f(\014elds)h(are)g(lost.)16
b(The)11 b Fr(patlabelbindings)c Fv(binds)j(lab)q(el)g(names)g(to)g
(o\013sets,)129 1439 y(whic)o(h)k(are)h(expressed)h(in)d(PC)h(units,)g
(not)g(bits.)p eop
%%Page: 269 269
269 268 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(269)145 258 y Fj(13.1)66 b(T)-6
b(ransformation)23 b(to)f(absolute)h(normal)g(form)145
349 y Fv(The)e(transformation)d(is)h(simply)f(a)i(matter)f(of)g(adding)
g(up)h(w)o(ord)g(sizes)h(to)f(compute)145 398 y(o\013sets.)g(I)13
b(cac)o(he)i(absolute)f(\014elds)h(to)e(a)o(v)o(oid)g(allo)q(cating)f
(gazillions)g(of)h(them.)2 461 y Fp(269)89 b Fo(h)p Fn(*)15
b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1052 b Fm(/)6 b Fp(268)22
b(270a)5 b Fm(.)187 510 y Fr(procedure)20 b(anf\(p\))230
560 y(return)h(pattern\(maplist\(a)o(nfd,)d(p.disjuncts\),)h(p.name\))
187 610 y(end)187 710 y(procedure)h(anfd\(d\))230 760
y(local)h(offset)230 809 y(offset)g(:=)g(0)230 859 y(l)h(:=)f([])230
909 y(t)h(:=)f(table\(\))230 959 y(every)g(s)h(:=)f(!d.sequents)f(do)
274 1009 y(case)h(type\(s\))f(of)i({)318 1058 y("sequent")41
b(:)22 b({)f(every)g(put\(l,)g(aconstraint\(!s.c)o(onstr)o(aints)o(,)e
(offset\)\))644 1108 y(offset)i(+:=)g(s.class.size)601
1158 y(})318 1208 y("patlabel")e(:)j(t[\\s.name])e(:=)h
(bits_to_pcunits\(o)o(ffset)o(\))318 1258 y("latent_patlabe)o(l")e(:)i
(&null)318 1307 y(default)85 b(:)22 b(impossible\("seque)o(nt)d
(type"\))274 1357 y(})230 1407 y(a)j(:=)f(adisjunct\(l,)f(d.name,)g
(d.conditions,)f(offset,)h(if)i(*t)f(>)h(0)f(then)g(t)h(else)f(&null\))
230 1457 y(return)g(gsubst\(a,)f(Epatlabel_to_Epc_)o(by_ta)o(ble,)e(t,)
k(a\))187 1507 y(end)145 1559 y Fp(De\014nes:)187 1598
y Fl(anf)p Fp(,)10 b(used)h(in)g(c)o(h)o(unk)f(260.)145
1637 y(Uses)15 b Fl(aconstrain)o(t)c Fp(270b,)i Fl(adisjunct)f
Fp(268,)h Fl(bits_to_pc)o(uni)o(ts)e Fp(64b,)j Fl(constrain)o(ts)d
Fp(136a,)187 1677 y Fl(Epatlabel_)o(to_)o(Ep)o(c_b)o(y_t)o(abl)o(e)f
Fp(270a,)i Fl(gsubst)g Fp(120a,)g Fl(latent_pat)o(la)o(bel)e
Fp(55,)j Fl(patlabel)d Fp(55,)187 1716 y Fl(pattern)f
Fp(55,)i(and)g Fl(sequent)e Fp(55.)p eop
%%Page: 270 270
270 269 bop 129 141 a Fv(270)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(During)i(deco)q(ding)i(w)o(e)g(eliminate)
d(the)j(pattern)h(lab)q(el)e(o\013sets)h(b)o(y)f(using)h(a)f(table)g
(of)129 307 y(bindings.)i(If)13 b(the)i(lab)q(el)e(is)h(already)f(b)q
(ound,)h(of)f(course,)i(w)o(e)f(need)h(do)f(nothing.)-31
370 y Fp(270a)88 b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p
Fo(\021)1051 b Fm(/)5 b Fp(269)23 b(270b)t Fm(.)171 420
y Fr(procedure)d(Epatlabel_to_Epc_)o(by_ta)o(ble\(x)o(,)f(t,)i(a\))215
469 y(if)g(type\(x\))f(==)i("Epatlabel")d(then)258 519
y(return)i(if)g(/x.l.name)f(then)h(Epatlabel_to_Epc\()o(x\))411
569 y(else)g({)215 619 y(write\(\\mdebug,)d("====>)j(RESORTED)f(TO)i
(TABLE)e(in)i(",)f(expimage\(x\)\))215 669 y(binop\(the_globa)o(l_pc,)d
("+",)j(\\t[\\x.l.name]\))e(|)520 718 y(impossible\("in)g(",)i
(expimage\(a\),)e("---Label)h(",)i(x.l.name,)759 768
y(")g(not)f(used)g(yet,)g(but)g(is)h(not)f(in)g(table:",)759
818 y(envimage\(t,)f("pattern_table"\)\))432 868 y(})171
918 y(end)129 970 y Fp(De\014nes:)171 1009 y Fl(Epatlabel_)o(to_)o(Epc)
o(_by)o(_t)o(abl)o(e)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(269.)129
1048 y(Uses)k Fl(binop)d Fp(113a,)g Fl(envimage)g Fp(27a,)h
Fl(Epatlabel)d Fp(81,)k Fl(Epatlabel)o(_to)o(_Ep)o(c)d
Fp(193a,)i Fl(expimage)e Fp(101a,)171 1088 y Fl(mdebug)g
Fp(18a,)g Fl(the_global)o(_pc)e Fp(19d,)j(and)f Fl(used)h
Fp(136a.)192 1150 y Fv(I)16 b(don't)f(cac)o(he)i(constrain)o(ts,)g(but)
g(I)f(do)f(cac)o(he)i(\014elds.)26 b(I)16 b(ha)o(v)o(e)f(absolutely)h
(no)g(mea-)129 1200 y(suremen)o(ts)f(to)e(justify)g(either)i(decision,)
e(but)h(it)f(simpli\014es)f(the)i(co)q(de)h(to)e(mak)o(e)f(absolute)129
1250 y(\014elds)j(unique)f(\(as)g(\014elds)g(are\))h(b)q(ecause)g(they)
g(can)f(b)q(e)g(inserted)h(in)o(to)e(sets.)-33 1312 y
Fp(270b)88 b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(270a)22 b(271a)5 b Fm(.)171
1362 y Fr(procedure)20 b(aconstraint\(c,)f(offset\))215
1412 y(return)h(case)h(type\(c\))f(of)i({)258 1461 y("constraint")63
b(:)22 b(constraint\(afiel)o(d\(c.)o(field)o(,)d(offset\),)h(c.lo,)h
(c.hi\))258 1511 y("fieldbinding")e(:)324 1561 y(if)i(x)g(:=)h
(constant\(super_si)o(mplif)o(y\(c.)o(code\))o(\))d(then)367
1611 y(constraint\(afield\()o(c.fie)o(ld,)g(offset\),)h(x,)h(x+1\))324
1661 y(else)367 1711 y(fieldbinding\(afiel)o(d\(c.f)o(ield,)d
(offset\),)i(c.code\))258 1760 y(default)g(:)i(impossible\("constr)o
(aint)c(type"\))215 1810 y(})171 1860 y(end)129 1912
y Fp(De\014nes:)171 1951 y Fl(aconstrain)o(t)p Fp(,)9
b(used)h(in)h(c)o(h)o(unk)f(269.)129 1991 y(Uses)16 b
Fl(afield)d Fp(271a,)h Fl(constant)e Fp(114b,)i Fl(constraint)e
Fp(55,)j Fl(field)e Fp(55,)i Fl(fieldbind)o(ing)d Fp(55,)171
2030 y(and)f Fl(super_sim)o(pli)o(fy)d Fp(92c.)p eop
%%Page: 271 271
271 270 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(271)-15 258 y Fp(271a)88 b Fo(h)p
Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1031 b Fm(/)5
b Fp(270b)22 b(271b)5 b Fm(.)187 307 y Fr(procedure)20
b(afield\(f,)g(offset\))230 357 y(static)h(tables)230
407 y(initial)g(tables)f(:=)i(table\(\))230 457 y(/tables[offset])d(:=)
i(table\(\))230 507 y(/tables[offset][f])d(:=)k(absolute_field\(f,)c
(offset\))230 557 y(return)j(tables[offset][f])187 606
y(end)145 658 y Fp(De\014nes:)187 698 y Fl(afield)p Fp(,)9
b(used)i(in)g(c)o(h)o(unk)f(270b.)145 737 y(Uses)i Fl(absolute_f)o(iel)
o(d)d Fp(268.)145 895 y Fj(13.2)66 b(Structure)22 b(of)e(matc)n(hing)h
(statemen)n(ts)f(and)g(tree)332 970 y(no)r(des)145 1061
y Fv(The)13 b(arms)f(of)g(the)h(matc)o(hing)e(statemen)o(t)h(ha)o(v)o
(e)h(some)e(extra)i(information.)i(The)e(\014le)g(and)145
1111 y(line)k(n)o(um)o(b)q(er)g(help)h(with)f(error)i(message)e(and)g
(mak)o(e)f(it)h(p)q(ossible)h(to)g(generate)g Fr(#line)145
1160 y Fv(statemen)o(ts)13 b(that)g(iden)o(tify)f(the)i(source)g(of)e
(the)i(co)q(de.)k(The)13 b(original)e(arm)h(giv)o(es)g(the)i(arm)145
1210 y(from)e(whic)o(h)i(the)g(curren)o(t)h(arm)d(is)h(deriv)o(ed,)h
(and)f(is)h(useful)g(for)f(man)o(y)f(of)g(the)j(heuristics.)-17
1272 y Fp(271b)88 b Fo(h)p Fn(*)15 b Fp(268)p Fo(i)p
Fv(+)p Fo(\021)1052 b Fm(/)6 b Fp(271a)22 b(272)5 b Fm(.)187
1322 y Fr(record)20 b(matching_stmt\(arms,)o(valco)o(de,su)o(ccptr)o
(,tra)o(iler\))535 1372 y(#)i(case)f(arms,)g(code)g(to)g(compute)f
(value,)h(id)g(to)h(set)f(to)g(end)h(of)f(p,)g(trailing)f(code)187
1422 y(record)g(arm\(file,)g(line,)h(pattern,)f(eqns,)h(soln,)g
(imp_soln,)f(patlen,)g(name,)h(code,)f(original\))535
1472 y(#)i(line,)f(file,)g(original\(patter)o(n\))e(are)i(used)g(for)g
(error)g(reporting)535 1522 y(#)h(These)f(fields)f(are)i(the)f
(original)f(contents:)535 1571 y(#)66 b(pattern)20 b(\(in)h(absoslute)f
(normal)h(form\))f(is)i(pattern)e(to)i(match)535 1621
y(#)66 b(eqns)21 b(are)g(equations)f(given)g(explicitly)g(with)h(arm)g
(\(or)h(else)e(null\))535 1671 y(#)66 b(name)21 b(is)g(identifier)f
(given)g(in)i(square)e(brackets)h(\(or)g(else)g(null\))535
1721 y(#)66 b(code)21 b(is)g(the)g(list)g(of)h(code)e(lines)h(on)h(the)
f(right)g(hand)g(side)f(of)i(the)f(=>)145 1773 y Fp(De\014nes:)187
1812 y Fl(arm)p Fp(,)10 b(used)h(in)g(c)o(h)o(unks)f(51a,)g(96a,)h
(102a,)f(181b,)g(260,)h(261,)f(263a,)g(273{75,)g(280b,)g(301,)g(and)h
(372a.)187 1852 y Fl(matching_s)o(tmt)o Fp(,)e(used)h(in)h(c)o(h)o
(unks)f(51a)h(and)g(372a.)145 1891 y(Uses)h Fl(file)e
Fp(359a,)g Fl(line)h Fp(359a,)f Fl(pattern)f Fp(55,)i
Fl(succptr)e Fp(360b,)h Fl(used)h Fp(136a,)f(and)g Fl(value)g
Fp(136a.)p eop
%%Page: 272 272
272 271 bop 129 141 a Fv(272)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y Fr(imp_soln)c Fv(giv)o(es)h(answ)o(ers)h
(and)f(conditions)f(asso)q(ciated)i(with)f(iden)o(ti\014ers)h(that)f
(app)q(ear)g(as)129 307 y(\014eld)15 b(bindings)f(or)g(constructor)i
(op)q(erands)g(in)e(the)h(pattern.)20 b(These)c(iden)o(ti\014ers)f(are)
g(the)129 357 y Fn(inputs)f Fv(to)g(the)g(equations.)k(This)13
b(construct)j(is)d(a)g(little)g(o)q(dd,)g(b)q(ecause)j(the)e(meanings)e
(of)129 407 y(b)q(ound)g(iden)o(ti\014ers)g(and)f(the)i(conditions)e
(that)g(need)i(to)e(b)q(e)h(satis\014ed)g(are)g(more)f(naturally)129
457 y(asso)q(ciated)h(with)e(disjuncts,)i(not)f(arms.)16
b(W)m(e)10 b(\\raise)h(the)g(di\013erences")i(b)o(y)e(splitting)f(arms)
129 507 y(un)o(til)15 b(eac)o(h)g(arm)f(as)h(a)f(unique)h(suc)o(h)h
(\\implicit)c(solution.")20 b(W)m(e)15 b(further)g(guaran)o(tee)h(the)
129 557 y(uniqueness)g(of)e(the)h Fr(imp_soln)e Fv(\014eld.)20
b(The)15 b(reason)g(for)f(going)f(to)i(all)e(this)i(trouble)f(is)h(to)
129 606 y(simplify)f(the)j(task)g(of)f(dagging)f(the)i(ev)o(en)o(tual)g
(decision)g(tree:)24 b(w)o(e'll)15 b(b)q(e)j(able)e(to)g(unify)129
656 y(no)q(des)e(just)f(b)o(y)g(taking)f(the)i Fr(image\(\))d
Fv(of)i(the)g Fr(imp_soln)f Fv(\014eld)h(\(along)f(with)g(a)h(few)g
(other)129 706 y(go)q(o)q(dies,)h(of)f(course\).)192
756 y(If)h Fr(succptr)e Fv(w)o(as)i(requested)j(in)c(the)i(corresp)q
(onding)g(case)h(statmen)o(t,)d Fr(patlen)g Fv(giv)o(es)129
806 y(the)i(length)f(of)f(the)i(pattern)g(in)e(the)i(arm.)i(W)m(e)d
(split)f(arms)g(as)h(needed)i(to)e(mak)o(e)e(lengths)129
855 y(unique.)29 b(If)17 b Fr(succptr)f Fv(w)o(asn't)i(requiested,)h
Fr(patlen)d Fv(is)i(n)o(ull.)27 b Fr(patlen)17 b Fv(is)g(assigned)h(b)o
(y)129 905 y Fr(resolve_case_arms)p Fv(.)192 955 y(Eac)o(h)11
b(no)q(de)g(of)g(the)g(decision)g(tree)h(is)f(asso)q(ciated)h(with)e(a)
h(particular)g(matc)o(hing)e(state-)129 1005 y(men)o(t.)26
b(In)o(ternal)17 b(no)q(des)h(ha)o(v)o(e)f(c)o(hildren,)g(and)g(a)f
Fr(field)g Fv(and)h Fr(offset)e Fv(that)i(sa)o(y)g(whic)o(h)129
1055 y(\014eld)d(of)f(whic)o(h)h(w)o(ord)f(w)o(e)h(decided)g(to)g(test)
h(on.)i(The)d(edges)h(that)f(p)q(oin)o(t)f(to)g(the)h(c)o(hildren)129
1104 y(record)k(the)g(in)o(terv)n(al)e(of)g(v)n(alues)g(for)h(the)g
(particular)g(c)o(hild.)26 b(Leaf)17 b(no)q(des)g(ha)o(v)o(e)g(a)f
Fr(name)129 1154 y Fv(that)e(records)i(the)e(name)f(of)g(the)i(pattern)
f(kno)o(wn)g(to)g(matc)o(h)e(at)i(that)g(leaf)f(no)q(de.)-13
1217 y Fp(272)88 b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p
Fo(\021)1033 b Fm(/)5 b Fp(271b)22 b(273a)5 b Fm(.)171
1266 y Fr(record)21 b(node\(cs,)f(children,)g(field,)g(offset,)g(name,)
h(parent\))345 1316 y(#)h(matching)e(statement,)g(list)h(of)g(edges)g
(to)g(children,)f(field)h(chosen,)f(pattern)h(name)345
1366 y(#)153 b(\(name)20 b(field)h(used)g(to)h(support)e(name)h
(operator,)f(assigned)g(only)h(to)g(leaves\))171 1416
y(record)g(edge\(node,)e(lo,)i(hi\))345 1466 y(#)h(node)f(pointed)f(to)
i(and)f(lo)g(and)g(hi)h(interval)e(of)h(field)g(for)g(this)g(edge)129
1518 y Fp(De\014nes:)171 1557 y Fl(edge)p Fp(,)10 b(used)h(in)g(c)o(h)o
(unks)f(274,)g(277a,)g(and)h(291b.)171 1596 y Fl(node)p
Fp(,)g(used)g(in)h(c)o(h)o(unks)f(17b,)g(22c,)h(23a,)f(274,)g(276a,)g
(277a,)g(280,)g(281,)h(284,)f(285a,)g(290{92,)f(296a,)212
1636 y(297a,)h(299,)f(333d,)g(334b,)g(346a,)g(373b,)h(and)f(374.)129
1675 y(Uses)i Fl(field)e Fp(55,)h Fl(pattern)e Fp(55,)i(and)g
Fl(used)f Fp(136a.)p eop
%%Page: 273 273
273 272 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(273)208 258 y(T)m(o)15 b(create)j(a)f(decision)f
(tree,)i(I)f(b)q(egin)g(with)f(a)g(no)q(de)h(con)o(taining)f(the)h
(full,)e(original)145 307 y(matc)o(hing)f(statemen)o(t.)25
b(I)16 b(then)g(use)h(a)f(\\w)o(ork)f(queue")i(approac)o(h)f(to)g(c)o
(hec)o(k)g(eac)o(h)h(no)q(de)145 357 y(and)g(see)h(if)d(it)i(needs)h
(to)e(b)q(e)h(split.)26 b(If)16 b(no)h(pattern)g(matc)o(hes)f(the)i(no)
q(de,)f(or)g(if)e(the)j(\014rst)145 407 y(pattern)d(alw)o(a)o(ys)f
(matc)o(hes)f(\(with)i(a)e(unique)i(name\),)e(no)h(further)h(splitting)
e(needs)j(to)e(b)q(e)145 457 y(done,)g(and)g(I)g(assign)f(a)h(name)f
(to)g(the)i(leaf.)832 442 y Ff(1)868 457 y Fv(Otherwise,)g(I)e(split)h
(the)g(no)q(de.)-15 519 y Fp(273a)88 b Fo(h)p Fn(*)15
b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1050 b Fm(/)6 b Fp(272)22
b(273b)5 b Fm(.)187 569 y Fr(procedure)20 b(needs_splitting\()o(n\))274
619 y(local)h(name)274 669 y(if)g(*n.cs.arms)f(=)i(0)f(then)g(fail)274
718 y(if)g(not)h(guard_always_sa)o(tisfi)o(ed\(n.)o(cs.ar)o(ms[1)o
(].imp)o(_soln)o(.cons)o(train)o(ts\))d(then)361 768
y(return)i(#)g(first)g(arm)g(can't)g(always)g(match.)274
818 y(p)h(:=)f(n.cs.arms[1].patt)o(ern)274 868 y(name)g(:=)g
(\\p.disjuncts[1].nam)o(e)e(|)j(p.name)274 918 y(every)f(d)g(:=)h
(!p.disjuncts)d(do)i({)361 967 y(n)h(:=)f(\\d.name)f(|)i(p.name)361
1017 y(if)g(n)f(~===)g(name)g(then)405 1067 y(return)64
b(#)21 b(needs)g(splitting)f(if)i(names)e(or)i(answers)e(are)h
(different)361 1117 y(else)g(if)g(adalwaysmatches\(d\))e(then)405
1167 y(fail)42 b(#)22 b(always)f(matches,)f(needn't)g(split)274
1217 y(})274 1266 y(return)478 b(#)22 b(pattern)e(doesn't)g(always)h
(match)g(->)g(split)187 1316 y(end)145 1368 y Fp(De\014nes:)187
1408 y Fl(needs_spli)o(tti)o(ng)o Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f
(274)g(and)h(280b.)145 1447 y(Uses)18 b Fl(adalwaysmat)o(che)o(s)d
Fp(273b,)i Fl(arm)g Fp(271b,)f Fl(constraints)f Fp(136a,)h
Fl(fail)h Fp(410,)187 1486 y Fl(guard_alwa)o(ys_)o(sa)o(tis)o(fie)o(d)9
b Fp(96b,)h Fl(pattern)f Fp(55,)i(and)g Fl(split)f Fp(277a.)208
1549 y Fv(I)17 b(need)h(di\013eren)o(t)f(pro)q(cedures)j(to)d(c)o(hec)o
(k)h(matc)o(hing)d(b)q(ecause)k(the)e(patterns)h(are)g(in)145
1598 y(absolute)c(normal)e(form.)-17 1661 y Fp(273b)88
b Fo(h)p Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1052
b Fm(/)6 b Fp(273a)22 b(274)5 b Fm(.)187 1711 y Fr(procedure)20
b(aalwaysmatches\(p)o(\))274 1760 y(return)h(adalwaysmatches)o(\(!p.d)o
(isjun)o(cts\))187 1810 y(end)187 1860 y(procedure)f(adalwaysmatches\()
o(d\))230 1910 y(if)i(type\(!d.aconstra)o(ints\))c(==)k("constraint")d
(then)i(fail)230 1960 y(else)g(return)g(guard_always_sati)o(sfied)o
(\(d.co)o(ndit)o(ions\))187 2009 y(end)145 2061 y Fp(De\014nes:)187
2101 y Fl(aalwaysmat)o(che)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f
(278.)187 2140 y Fl(adalwaysma)o(tch)o(es)o Fp(,)f(used)i(in)g(c)o(h)o
(unks)f(273a)g(and)h(370b.)145 2180 y(Uses)h Fl(constraint)c
Fp(55,)j Fl(fail)f Fp(410,)h(and)f Fl(guard_always)o(_s)o(ati)o(sfi)o
(ed)e Fp(96b.)p 145 2421 573 2 v 192 2448 a Fc(1)209
2460 y Fp(If)j(the)f(name)g(isn't)h(used,)f(I)h(assign)f(the)h(name)f
Fl("-unused-")o Fp(,)f(b)q(ecause)g(that)h(will)i(mak)o(e)e(it)h
(easier)f(to)145 2499 y(com)o(bine)f(no)q(des)i(in)g(the)g(dagging)e
(phase.)p eop
%%Page: 274 274
274 273 bop 129 141 a Fv(274)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y Fr(tree)g Fv(con)o(v)o(erts)i(a)e(matc)o
(hing)f(statemen)o(t)i(in)o(to)f(a)h(decision)g(tree.)-13
320 y Fp(274)88 b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p
Fo(\021)1033 b Fm(/)5 b Fp(273b)22 b(275a)5 b Fm(.)171
370 y Fr(procedure)20 b(tree\(cs\))258 420 y(local)h(armcount,)f(arm,)h
(armname,)f(nodename)258 469 y(static)h(heuristics)258
519 y(initial)f({)324 569 y(heuristics)f(:=)j([leafarms,)d(childarms,)h
(nomatch,)g(childdisjuncts,)f(branchfactor])258 619 y(})258
669 y(root)i(:=)g(node\(copy\(cs\),)e([]\))43 b(#)22
b(need)f(empty)g(children)f(in)h(case)g(root)g(not)g(split)258
718 y(work)g(:=)g([edge\(root\)])172 b(#)22 b(work)f(queue)g(of)g
(edges)g(\(nodes\))f(to)i(be)f(expanded)258 768 y(while)g(n)g(:=)h
(get\(work\).node)d(do)345 818 y(if)j(\(needs_splitting)o(\(n\))d(&)i
(*\(afields)f(:=)h(mentions\(n.cs\)\))e(>)j(0\))f(then)g({)432
868 y Fo(h)p Fn(split)15 b(no)n(de)g Fr(n)g Fn(and)h(add)f(childr)n(en)
g(to)g(work)f(queue)h Fp(276a)p Fo(i)345 918 y Fr(})22
b(else)f({)432 967 y(write\(\\sdebug,)e("Not)i(splitting)f(",)563
1017 y(commaseparate\(mapli)o(st\(e)o(xpima)o(ge,)f(n.cs.arms\),)g
("\\n"\)\))432 1067 y(armcount)i(:=)g(*n.cs.arms)432
1117 y(trim_impossible_arms)o(\(n.cs)o(\))432 1167 y(n.name)g(:=)g
(case)g(*n.cs.arms)f(of)h({)694 1217 y(0)h(:)f("-NOMATCH-")694
1266 y(default:)f(get_nodename\(n\))650 1316 y(})432
1366 y(if)i(\\lc_pat_names)d(then)i(n.name)f(:=)i(map\(\\n.name\))432
1416 y(if)g(armcount)e(>)i(*n.cs.arms)d(then)476 1466
y(write\(\\sdebug,)g("Trimmed)h(node)h(is)g(",)563 1515
y(commaseparate\(mapli)o(st\(e)o(xpima)o(ge,)e(n.cs.arms\),)g
("\\n"\)\))324 1565 y(})258 1615 y(return)i(root)171
1665 y(end)129 1717 y Fp(De\014nes:)171 1756 y Fl(tree)p
Fp(,)10 b(used)h(in)g(c)o(h)o(unks)f(9{11,)g(21a,)g(and)h(295b.)129
1796 y(Uses)j Fl(arm)f Fp(271b,)f Fl(branchfac)o(tor)e
Fp(281d,)i Fl(childarms)f Fp(281a,)h Fl(childdisj)o(unc)o(ts)e
Fp(281c,)i Fl(edge)h Fp(272,)171 1835 y Fl(expimage)d
Fp(101a,)h Fl(get_noden)o(ame)e Fp(275a,)i Fl(lc_pat_nam)o(es)e
Fp(18a,)j Fl(leafarms)d Fp(280b,)i Fl(mentions)f Fp(282b,)171
1875 y Fl(needs_spli)o(tti)o(ng)j Fp(273a,)h Fl(node)h
Fp(272,)g Fl(nomatch)f Fp(281b,)g Fl(sdebug)g Fp(18a,)h
Fl(split)f Fp(277a,)171 1914 y(and)d Fl(trim_impo)o(ssi)o(ble)o(_a)o
(rms)d Fp(283a.)p eop
%%Page: 275 275
275 274 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(275)208 258 y(W)m(e)14 b(w)o(an)o(t)f(to)i(assign)
f(eac)o(h)h(leaf)f(no)q(de)g(a)g(name,)f(whic)o(h)h(is)h(deriv)o(ed)g
(from)d(the)j(names)145 307 y(of)d(the)h(pattern)f(arms)g(that)g(the)g
(no)q(de)h(matc)o(hes.)k(If)12 b(all)f(pattern)i(arms)e(in)g(the)i(no)q
(de)g(ha)o(v)o(e)145 357 y(the)j(same)d(name)h Fi(N)19
b Fv(or)c(are)g(the)g(n)o(ull)f(string,)g(i.e.,)g(they)h(do)f(not)h(sp)
q(ecify)g(a)g(name,)e(then)145 407 y(the)k(no)q(de's)f(name)e(is)i
(simply)e Fi(N)5 b Fv(.)23 b(This)16 b(case)h(alw)o(a)o(ys)d(holds)i
(when)g(the)h(no)q(de)f(matc)o(hes)145 457 y(exactly)f(one)g(arm;)e
(one)i(arm)e(and)i(a)f(default)g(\(wildcard\))h(arm;)e(or)h(m)o
(ultiple)f(arms)g(that)145 507 y(all)18 b(matc)o(h)f(the)i(same)f
(constructor)i(\(p)q(ossibly)e(applied)g(to)h(di\013eren)o(t)g(argumen)
o(ts\).)32 b(If)145 557 y(the)17 b(names)e(of)h(the)h(pattern)g(arms)e
(in)g(the)i(no)q(de)g(are)f(not)g(the)h(same,)e(then)i(the)g(no)q(de's)
145 606 y(name)c(is)h(am)o(biguous,)d(b)q(ecause)16 b(no)e(single)f
(name)g(exists)i(for)e(all)g(p)q(ossible)h(matc)o(hes.)k(An)145
656 y(am)o(biguous)9 b(no)q(de)j(name)e(will)g(cause)i(an)f(error)h(in)
f Fr(genarm)p Fv(,)f(if)h(an)o(y)f(of)h(the)h(no)q(de's)g(pattern)145
706 y(arms)h(attempts)h(to)f(bind)h(a)35 b Fr([name])21
b Fv(.)-15 768 y Fp(275a)88 b Fo(h)p Fn(*)15 b Fp(268)p
Fo(i)p Fv(+)p Fo(\021)1050 b Fm(/)6 b Fp(274)22 b(276b)5
b Fm(.)187 818 y Fr(procedure)20 b(get_nodename\(n\))187
868 y(local)h(nodename,)e(armname)274 918 y(nodename)h(:=)h(armname)g
(:=)g(&null)274 967 y(every)g(arm)g(:=)g(!n.cs.arms)f(do)318
1017 y(if)h(\(armname)f(:=)h(\\\()p Fo(h)p Fn(Get)15
b(name)g(fr)n(om)g(p)n(attern)f Fr(arm)h Fp(275b)p Fo(i)n
Fr(\)\))22 b(then)f({)361 1067 y(write\(\\sdebug,)e("[",)i
(image\(arm.name\),")o(])e(=)j(",)470 1117 y(image\(armname\),)d(")i
(for)h(",expimage\(arm.)o(patte)o(rn\)\))361 1167 y(if)g(\(\\nodename)d
(~==)i(armname\))g(then)405 1217 y(nodename)f(:=)h Fo(h)p
Fn(A)o(mbiguous)16 b(name)f(warning)g Fp(275c)p Fo(i)361
1266 y Fr(else)21 b(nodename)f(:=)i(armname)318 1316
y(})274 1366 y(return)f(nodename)187 1416 y(end)145 1468
y Fp(De\014nes:)187 1507 y Fl(get_nodena)o(me)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(274.)145 1547 y(Uses)i Fl(arm)f
Fp(271b,)f Fl(expimage)f Fp(101a,)h Fl(pattern)f Fp(55,)i(and)g
Fl(sdebug)e Fp(18a.)-17 1630 y(275b)88 b Fo(h)p Fn(Get)15
b(name)h(fr)n(om)e(p)n(attern)h Fr(arm)f Fp(275b)p Fo(i)n(\021)684
b Fp(\(275a\))187 1679 y Fr(if)21 b(\\arm.name)f(then)h({)230
1729 y(\\arm.pattern.disjun)o(cts[1)o(].nam)o(e)e(|)j(\\arm.pattern.na)
o(me)d(|)i(&null)187 1779 y(#)g("-unnamed-")187 1829
y(})g(else)g(&null)145 1881 y Fp(Uses)12 b Fl(arm)f Fp(271b)f(and)h
Fl(pattern)e Fp(55.)-13 1972 y(275c)88 b Fo(h)p Fn(A)o(mbiguous)16
b(name)f(warning)g Fp(275c)p Fo(i)o(\021)716 b Fp(\(275a\))187
2022 y Fr(\(warning\("ambigu)o(ous)19 b(name)i(for)g(pattern)f(arm)h
(at)h(",)f(arm.original.file,)d(",)k(line)e(",)383 2072
y(arm.original.line)o(,)f(":)i(",)h(commaseparate\(ma)o(plist)o(\(expi)
o(mage,)c(n.cs.arms\),)383 2121 y("\\nAre)i(you)i(trying)e(to)i(decode)
e(a)i(synthetic)e(instruction?\\n"\))o(\),)187 2171 y(&null\))145
2223 y Fp(Uses)12 b Fl(arm)f Fp(271b,)f Fl(expimage)f
Fp(101a,)h Fl(file)g Fp(359a,)g Fl(line)h Fp(359a,)f(and)g
Fl(pattern)g Fp(55.)p eop
%%Page: 276 276
276 275 bop 129 141 a Fv(276)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(Splitting)8 b(a)h(no)q(de)h(in)o(v)o(olv)
o(es)f(c)o(ho)q(osing)g(a)h(\014eld,)g(\014nding)f(out)g(whic)o(h)h(in)
o(terv)n(als)f(of)g(v)n(alues)129 307 y(of)14 b(that)h(\014eld)g(are)g
(in)o(teresting,)g(and)f(creating)h(a)g(c)o(hild)f(no)q(de)h(for)f(eac)
o(h)h(suc)o(h)g(in)o(terv)n(al)f(of)129 357 y(v)n(alues.)28
b(The)18 b(patterns)h(in)d(the)i(matc)o(hing)e(statemen)o(t)h(of)g(the)
g(c)o(hild)g(no)q(de)h(re\015ect)h(the)129 407 y(kno)o(wledge)14
b(of)f(the)i(v)n(alue)e(in)o(terv)n(al)g(of)g(the)i(tested)g(\014eld.)
192 457 y(I)j(mak)o(e)g(the)h(decision)g(b)o(y)f(splitting)g(the)h(no)q
(de)h(on)e Fn(e)n(ach)h Fv(\014eld)g(men)o(tioned)f(in)g(the)129
507 y(matc)o(hing)d(statemen)o(t.)27 b(I)17 b(then)h(compute)e(some)g
(heuristic)i(functions)f(of)f(the)h(c)o(hildren)129 557
y(from)c(eac)o(h)h(splitting)f(and)h(use)g(the)h(b)q(est-scoring)g
(\014eld.)192 606 y(Some)d(debugging)i(information)d(ma)o(y)h(b)q(e)i
(written)h(to)e Fr(hdebug)g Fv(or)h Fr(sdebug)p Fv(.)-31
669 y Fp(276a)88 b Fo(h)p Fn(split)15 b(no)n(de)g Fr(n)g
Fn(and)h(add)f(childr)n(en)g(to)g(work)f(queue)h Fp(276a)p
Fo(i)o(\021)409 b Fp(\(274\))171 718 y Fr(afields)20
b(:=)i(mentions\(n.cs\))171 768 y(*afields)e(>)i(0)f(|)h
(impossible\("inter)o(nal)d(node)h(mentions)h(no)g(fields"\))171
818 y(candidates)f(:=)h(table\(\))171 868 y(every)g(f)g(:=)h(!afields)e
(do)258 918 y(candidates[f])f(:=)j(split\(n,)e(f\))171
967 y Fo(h)p Fn(if)14 b(debugging,)i(split)e(al)r(l)h(and)g(r)n(ep)n
(ort)f Fp(276c)p Fo(i)171 1017 y Fr(*afields)20 b(>)i(1)f(&)h
(write\(\\hdebug,)d("Choosing)h(one)h(of)g(",)h(patimage\(afields)o
(\)\))171 1067 y(every)f(h)g(:=)h(!heuristics)d(do)j({)258
1117 y(if)g(*afields)e(=)h(1)h(then)f(break)258 1167
y(afields)f(:=)i(findmaxima\(h,)d(candidates,)g(afields\))171
1217 y(write\(\\hdebug,)g(image\(h\),)h(")h(chose)g(",)h
(patimage\(afield)o(s\)\))171 1266 y(})171 1316 y(*afields)e(>)i(0)f(|)
h(impossible\("no)d(fields"\))171 1366 y(*afields)h(=)i(1)f(|)h
(write\(\\hdebug,)d("tie)i(among)f(fields",)h(patimage\(afields)o(\),)e
(")i(near)g(",)650 1416 y(image\(n.cs.arms[1].)o(origi)o(nal.f)o
(ile\),)d(",)k(line)f(",)650 1466 y(n.cs.arms[1].origin)o(al.li)o(ne\))
171 1515 y(work)g(|||:=)g(n.children)e(:=)j(candidates[n.fie)o(ld)d(:=)
i(?afields])171 1565 y(*afields)f(=)i(1)f(|)h(write\(\\hdebug,)d
("arbitrarily)g(chose)i(",)g(patimage\(n.field\)\))129
1617 y Fp(Uses)11 b Fl(field)d Fp(55,)i Fl(file)f Fp(359a,)f
Fl(findmaxima)f Fp(280a,)i Fl(hdebug)f Fp(18a,)h Fl(line)g
Fp(359a,)g Fl(mentions)e Fp(282b,)i Fl(node)g Fp(272,)171
1657 y Fl(patimage)g Fp(372a,)h(and)h Fl(split)f Fp(277a.)-33
1740 y(276b)88 b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(275a)22 b(277a)5 b Fm(.)171
1789 y Fr(procedure)20 b(parentchoices\(n\))215 1839
y(l)h(:=)h([])215 1889 y(n)f(:=)h(n.parent)215 1939 y(while)e(\\n)i(do)
f({)h(push\(l,)e(n.field\);)g(n)i(:=)f(n.parent)f(})215
1989 y(return)g(l)171 2038 y(end)129 2090 y Fp(Uses)12
b Fl(field)e Fp(55.)-29 2182 y(276c)88 b Fo(h)p Fn(if)15
b(debugging,)h(split)e(al)r(l)g(and)i(r)n(ep)n(ort)e
Fp(276c)p Fo(i)n(\021)608 b Fp(\(276a\))171 2231 y Fr(if)21
b(\\tryall)g(&)g(\\hdebug)g(&)g(*afields)f(>)i(1)g(then)108
b({)215 2281 y(write\(\\hdebug,)18 b(repl\("=",10\),)i(")h(Splitting)f
(",)h(repl\("=",)f(10\)\))215 2331 y(every)g(findmaxima\(!heurist)o
(ics,)e(candidates,)i(afields\))g(do)h(write\(\\hdebug\))215
2381 y(write\(\\hdebug,)d(repl\("=",)i(30\),)h("\\n"\))171
2431 y(})129 2483 y Fp(Uses)12 b Fl(findmaxima)c Fp(280a,)i
Fl(hdebug)g Fp(18a,)h(and)f Fl(tryall)g Fp(18a.)p eop
%%Page: 277 277
277 276 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(277)208 258 y(T)m(o)12 b(split)g(a)h(no)q(de,)g(I)
f(lo)q(ok)g(at)h(eac)o(h)g(in)o(terv)n(al)f(of)h(v)n(alues)f(that)h
(migh)o(t)e(b)q(e)i(in)o(teresting.)18 b(I)145 307 y(apply)c(that)h(in)
o(terv)n(al)f(to)g(the)i(matc)o(hing)d(statemen)o(t,)h(and)h(if)e
(there)k(can)d(b)q(e)i(an)o(y)e(matc)o(h,)145 357 y(I)g(create)h(and)f
(add)g(a)f(new)i(c)o(hild)e(no)q(de.)19 b Fr(f)13 b Fv(is)h(an)g
(absolute)g(\014eld.)-15 420 y Fp(277a)88 b Fo(h)p Fn(*)15
b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1050 b Fm(/)6 b Fp(276b)22
b(278)5 b Fm(.)187 469 y Fr(procedure)20 b(split\(n,)g(f\))274
519 y(local)h(vals,v,d,val,c,p)o(,j,i,)o(newd,)o(cst,c)o(hild)o(,newp)o
(,)e(xxx)274 619 y(patterns)h(:=)h([])274 669 y(children)f(:=)h([])274
718 y(every)g(put\(patterns,)e(\(!n.cs.arms\).patt)o(ern\))274
768 y(r)j(:=)f(intervals\(pattern)o(s,)e(f\))274 818
y Fo(h)p Fn(if)14 b(debugging,)i(write)e(ab)n(out)h(splitting)f(this)h
(no)n(de)g Fp(277b)p Fo(i)274 918 y Fr(every)21 b(i)g(:=)h(1)f(to)h(*r)
f(-)h(1)f(do)361 967 y(put\(children,)e(edge\(node\(apply\(n.c)o(s,)g
(f,)i(r[i],)g(r[i+1]\),[]\),)e(r[i],)i(r[i+1]\)\))274
1067 y(write\(\\sdebug,)e("Done)i(splitting.\\n"\))274
1117 y(every)g(\(!children\).node)o(.pare)o(nt)e(:=)i(n)274
1167 y(return)g(children)187 1217 y(end)145 1268 y Fp(De\014nes:)187
1308 y Fl(split)p Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(11l,)h(12a,)f
(263a,)g(273a,)h(274,)f(and)h(276a.)145 1347 y(Uses)h
Fl(apply)e Fp(278,)g Fl(edge)h Fp(272,)f Fl(intervals)f
Fp(282a,)h Fl(node)g Fp(272,)h Fl(pattern)e Fp(55,)i(and)f
Fl(sdebug)g Fp(18a.)-17 1430 y(277b)88 b Fo(h)p Fn(if)15
b(debugging,)g(write)f(ab)n(out)h(splitting)f(this)h(no)n(de)h
Fp(277b)p Fo(i)n(\021)402 b Fp(\(277a\))187 1480 y Fr
(writes\(\\sdebug,)18 b("Splitting)i("\))187 1530 y(outpattern\(\\sdeb)
o(ug,)f(patterns[1]\))187 1580 y(every)i(i)g(:=)h(2)f(to)g(*patterns)f
(do)i({)f(writes\(\\sdebug,)e(")j(|)f("\);)g(outpattern\(\\sdebug,)d
(patterns[i]\)})187 1630 y(write\(\\sdebug,)h(")i(on)h(",)f
(f.field.name,)e(")j(at)f(",)g(f.offset\))145 1681 y
Fp(Uses)12 b Fl(field)e Fp(55,)h Fl(outpattern)d Fp(369b,)i(and)h
Fl(sdebug)e Fp(18a.)p eop
%%Page: 278 278
278 277 bop 129 141 a Fv(278)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(What)d(is)h(the)h(new)f(matc)o(hing)f
(statemen)o(t)h(that)g(results)h(from)d(applying)h Fr(lo)h
Fo(\024)h Fr(f)f Fi(<)h Fr(hi)129 307 y Fv(to)k Fr(cs)p
Fv(?)23 b(F)m(or)15 b(eac)o(h)i(arm,)d(I)h(matc)o(h)g(the)h(pattern)h
(against)e(the)h(in)o(terv)n(al.)23 b(If)15 b(it)g(succeeds,)129
357 y(I)k(create)h(a)e(new)h(arm)e(for)h(the)h(new)g(matc)o(hing)d
(statemen)o(t,)j(con)o(taining)f(the)h(reduced)129 407
y(pattern.)g Fr(f)14 b Fv(is)g(an)f(absolute)h(\014eld.)-13
469 y Fp(278)88 b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(277a)22 b(279a)5 b Fm(.)171
519 y Fr(procedure)20 b(apply\(cs,)g(f,)h(lo,)g(hi\))258
569 y(local)g(newarm)258 619 y(result)g(:=)g(copy\(cs\))258
669 y(result.arms)f(:=)h([])258 718 y(write\(\\sdebug,)e(")87
b(Applying)20 b(",)i(stringininterva)o(l\(pat)o(image)o(\(f\),)c(lo,)j
(hi\)\))258 768 y(every)g(a)g(:=)h(!cs.arms)e(do)h({)345
818 y(newarm)g(:=)g(copy\(a\))345 868 y(put\(result.arms,)e(if)i
(newarm.pattern)e(:=)i(pmatch\(a.pattern,)e(f,)i(lo,)g(hi\))g(then)g
(newarm\))258 918 y(})258 967 y(if)h(*result.arms)d(>)i(1)h(&)g
(aalwaysmatches\()o(resul)o(t.arm)o(s[1].)o(patte)o(rn\))d(&)324
1017 y(guard_always_sa)o(tisfi)o(ed\(re)o(sult.)o(arms)o([1].i)o(mp_so)
o(ln.co)o(nstra)o(ints\))f(then)j({)h(#)f(change)g(21)345
1067 y(write\(\\sdebug,)e(")87 b(Trimming)20 b(results)h(of)g(apply)g
(to)g(",)h(expimage\(result)o(.arms)o([1]\)\))345 1117
y(result.arms)e(:=)h([result.arms[1]])258 1167 y(})258
1217 y(return)g(result)171 1266 y(end)129 1318 y Fp(De\014nes:)171
1358 y Fl(apply)p Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(133d,)g(277a,)h
(406,)f(and)h(407.)129 1397 y(Uses)g Fl(aalwaysmat)o(che)o(s)c
Fp(273b,)i Fl(constraints)e Fp(136a,)i Fl(expimage)e
Fp(101a,)i Fl(guard_alway)o(s_s)o(ati)o(sf)o(ied)e Fp(96b,)171
1437 y Fl(patimage)i Fp(372a,)h Fl(pattern)f Fp(55,)i
Fl(pmatch)f Fp(279a,)g Fl(sdebug)f Fp(18a,)i(and)g Fl(stringini)o(nte)o
(rva)o(l)e Fp(372b.)p eop
%%Page: 279 279
279 278 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(279)208 258 y Fr(pmatch)12 b Fv(b)q(oth)h(tests)i
(to)e(see)i(whether)f Fr(lo)d Fo(\024)h Fr(f)f Fi(<)h
Fr(hi)h Fv(and,)g(if)f(so,)i(returns)g(the)g(new)g Fr(p)p
Fv(.)145 307 y Fr(f)g Fv(is)g(an)f(absolute)h(\014eld.)-15
370 y Fp(279a)88 b Fo(h)p Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p
Fo(\021)1052 b Fm(/)6 b Fp(278)22 b(280a)5 b Fm(.)187
420 y Fr(procedure)20 b(pmatch\(p,)g(f,)h(lo,)g(hi\))274
469 y(result)g(:=)g(pattern\([],)e(p.name\))274 519 y(every)i(d)g(:=)h
(!p.disjuncts)d(do)361 569 y(if)j(c)f(:=)g(!d.aconstraints)e(&)j
(c.field)e(===)h(f)h(&)f(type\(c\))g(==)g("constraint")e(then)1407
619 y(#)j(disjunct)e(mentions)g(f)448 669 y(if)i(c.lo)f(<=)g(lo)g(&)h
(hi)f(<=)h(c.hi)f(then)g({)239 b(#)22 b(this)f(constraint)e(is)j
(matched)535 718 y(newd)f(:=)h(adisjunct\([],)d(d.name,)h
(d.conditions,)f(d.length,d.patlabel)o(bindi)o(ngs\))535
768 y(every)i(c)h(:=)f(!d.aconstraints)e(&)i(c.field)g(~===)g(f)g(do)
623 818 y(put\(newd.aconstr)o(aints)o(,)e(c\))535 868
y(put\(result.disjuncts)o(,)g(newd\))448 918 y(})j(else)535
967 y(c.hi)f(<=)h(lo)f(|)h(c.lo)f(>=)g(hi)h(|)f(impossible\("bad)e
(intervals"\))361 1017 y(else)980 b(#)22 b(disjunct)e(does)h(not)g
(mention)f(f)448 1067 y(put\(result.disjunct)o(s,)f(d\))274
1117 y Fo(h)p Fn(if)14 b(debugging,)i(write)e(ab)n(out)h(r)n(esults)f
(of)h Fr(pmatch)e Fp(279b)p Fo(i)274 1167 y Fr(if)21
b(*result.disjuncts)e(>)i(0)h(then)f(return)f(result)187
1217 y(end)145 1268 y Fp(De\014nes:)187 1308 y Fl(pmatch)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(278.)145 1347 y(Uses)i
Fl(adisjunct)c Fp(268,)i Fl(constraint)e Fp(55,)i Fl(disjunct)f
Fp(55,)h Fl(field)g Fp(55,)h Fl(intervals)d Fp(282a,)i
Fl(mentions)e Fp(282b,)187 1387 y(and)i Fl(pattern)g
Fp(55.)-17 1470 y(279b)88 b Fo(h)p Fn(if)15 b(debugging,)g(write)f(ab)n
(out)h(r)n(esults)f(of)h Fr(pmatch)f Fp(279b)p Fo(i)n(\021)414
b Fp(\(279a\))187 1520 y Fr(if)21 b(*result.disjuncts)d(>)k(0)g(then)f
(writes\(\\sdebug,)d(")174 b(===>)21 b("\))h(&)f(outpattern\(\\sdebug,)
d(p\))187 1569 y(#)j(else)g(writes\(\\sdebug,)e(")283
b("\))22 b(&)f(outpattern\(\\sdebug)o(,)e(p\))187 1669
y(if)i(*result.disjuncts)d(>)k(0)g(then)f(write\(\\sdebug,)d(")k
(matches"\))187 1719 y(#)f(else)g(write\(\\sdebug,)e(")j(does)f(not)g
(match"\))145 1771 y Fp(Uses)12 b Fl(outpattern)c Fp(369b)i(and)h
Fl(sdebug)f Fp(18a.)p eop
%%Page: 280 280
280 279 bop 129 141 a Fv(280)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y Fj(13.3)66 b(T)-6 b(ree-minimizati)q(on)
25 b(heuristics)129 349 y Fv(First,)14 b(the)h(b)q(oilerplate)e(that)h
(tak)o(es)h(a)e(heuristic)i Fr(h)p Fv(,)e(candidate)h(splittings,)f
(and)h(a)f(set)i(of)129 398 y(\014elds,)f(and)g(returns)h(the)g(set)g
(of)e(\014elds)h(with)g(the)g(largest)g(score)i(on)d
Fr(h)p Fv(.)-31 461 y Fp(280a)88 b Fo(h)p Fn(*)16 b Fp(268)p
Fo(i)o Fv(+)p Fo(\021)1033 b Fm(/)5 b Fp(279a)23 b(280b)t
Fm(.)171 510 y Fr(procedure)d(findmaxima\(h,)f(candidates,)h(afields\))
258 560 y(local)h(max)258 610 y(S)h(:=)f([])258 660 y(every)g(f)g(:=)h
(!afields)e(do)h({)345 710 y(score)g(:=)g(h\(candidates[f],)e(f\))345
760 y(write\(\\hdebug,"Fiel)o(d)g(",)i(patimage\(f\),)f(")h(scores)g
(",)g(score,)g(")g(on)h(",)f(image\(h\)\))345 809 y(/max)g(:=)h(score)e
(-)i(1)345 859 y(if)g(score)e(>)i(max)f(then)g({)432
909 y(max)h(:=)f(score)432 959 y(S)h(:=)f([f])345 1009
y(})h(else)f(if)g(score)g(=)h(max)f(then)432 1058 y(put\(S,)g(f\))258
1108 y(})258 1158 y(return)g(set\(S\))171 1208 y(end)129
1260 y Fp(De\014nes:)171 1299 y Fl(findmaxima)o Fp(,)9
b(used)i(in)g(c)o(h)o(unk)f(276.)129 1339 y(Uses)i Fl(hdebug)e
Fp(18a,)g Fl(max)h Fp(410,)f(and)h Fl(patimage)e Fp(372a.)192
1401 y Fv(Here's)16 b(a)e(big)g(pile)g(of)g(heuristics.)22
b(I'm)12 b(not)j(sure)h(I'v)o(e)e(ev)o(er)h(needed)i(more)c(than)i(the)
129 1451 y(\014rst)g(t)o(w)o(o,)e(but)h(they're)h(am)o(using)d(and)h
(easy)i(enough)f(to)f(write.)-33 1513 y Fp(280b)88 b
Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(280a)22 b(281a)5 b Fm(.)171 1563 y Fr(#)22
b(leafarms:)d(prefer)i(candidate)f(with)h(most)g(arms)g(that)g(appear)f
(at)i(leaf)171 1613 y(#)239 b(nodes.)43 b(Each)21 b(original)f(arm)h
(counted)f(only)h(once.)171 1662 y(#)239 b(Not)22 b(matching)e(is)h
(also)g(counted)f(as)i(an)f(arm.)171 1762 y(procedure)f
(leafarms\(children)o(,)f(f\))258 1812 y(arms)i(:=)g(set\(\))258
1862 y(every)g(n)g(:=)h(\(!children\).node)c(&)k(*n.cs.arms)e(>)h(0)h
(do)324 1911 y(if)f(not)g(needs_splitting\(n\))d(then)411
1961 y(insert\(arms,)h(n.cs.arms[1].orig)o(inal\))258
2011 y(return)i(*arms)f(+)i(if)f(*\(!children\).node.c)o(s.arm)o(s)e(=)
j(0)f(then)g(1)h(else)f(0)171 2061 y(end)129 2113 y Fp(De\014nes:)171
2152 y Fl(leafarms)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(274)h(and)g
(281b.)129 2192 y(Uses)h Fl(arm)f Fp(271b,)f Fl(needs_spli)o(tti)o(ng)e
Fp(273a,)i(and)h Fl(node)f Fp(272.)p eop
%%Page: 281 281
281 280 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(281)-15 258 y Fp(281a)88 b Fo(h)p
Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1031 b Fm(/)5
b Fp(280b)22 b(281b)5 b Fm(.)187 307 y Fr(#)21 b(childarms:)f(prefer)h
(the)g(candidate)f(with)h(the)g(fewest)f(arms)h(in)h(children)187
407 y(procedure)e(childarms\(childr)o(en,)f(f\))274 457
y(sum)i(:=)h(0)274 507 y(every)f(sum)g(-:=)g(*\(!children\).node.)o
(cs.ar)o(ms)274 557 y(return)g(sum)187 606 y(end)145
658 y Fp(De\014nes:)187 698 y Fl(childarms)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unks)f(274)g(and)h(281b.)145 737 y(Uses)h Fl(node)e
Fp(272.)-17 828 y(281b)88 b Fo(h)p Fn(*)15 b Fp(268)p
Fo(i)p Fv(+)p Fo(\021)1037 b Fm(/)5 b Fp(281a)22 b(281c)5
b Fm(.)187 878 y Fr(#)21 b(nomatch:)g(if)g(tied)g(on)g(leafarms)f(and)i
(childarms,)d(take)i(candidate)187 928 y(#)218 b(with)20
b(real)h(leaf)g(in)h(preference)e(to)h(nomatch)f(leaf)187
1028 y(procedure)g(nomatch\(children)o(,)f(f\))274 1077
y(return)i(if)g(*\(!children\).node)o(.cs.a)o(rms)e(=)i(0)h(then)f(-1)g
(else)g(0)187 1127 y(end)145 1179 y Fp(De\014nes:)187
1219 y Fl(nomatch)p Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(274.)145
1258 y(Uses)i Fl(childarms)d Fp(281a,)h Fl(leafarms)f
Fp(280b,)h(and)g Fl(node)h Fp(272.)-13 1349 y(281c)88
b Fo(h)p Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(281b)22 b(281d)5 b Fm(.)187 1399 y Fr(#)21
b(childdisjuncts:)e(prefer)i(the)g(candidate)f(with)h(the)g(fewest)f
(disjuncts)g(in)i(children)187 1499 y(procedure)e(childdisjuncts\(c)o
(hildr)o(en,)f(f\))274 1549 y(sum)i(:=)h(0)274 1598 y(every)f(sum)g
(-:=)g(*\(!\(!children\).nod)o(e.cs.)o(arms)o(\).pat)o(tern.)o(disju)o
(ncts)274 1648 y(return)g(sum)187 1698 y(end)145 1750
y Fp(De\014nes:)187 1789 y Fl(childdisju)o(nct)o(s)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(274.)145 1829 y(Uses)i
Fl(node)e Fp(272)h(and)g Fl(pattern)e Fp(55.)-17 1920
y(281d)88 b Fo(h)p Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(281c)22 b(282a)5 b Fm(.)187 1970 y Fr(#)21
b(branchfactor:)41 b(prefer)21 b(the)g(candidate)f(with)h(the)g(fewest)
g(children)187 2070 y(procedure)f(branchfactor\(chi)o(ldren)o(,)f(f\))
274 2119 y(return)i(-)g(*children)187 2169 y(end)145
2221 y Fp(De\014nes:)187 2261 y Fl(branchfact)o(or)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(274.)p eop
%%Page: 282 282
282 281 bop 129 141 a Fv(282)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y Fj(13.4)66 b(Utilit)n(y)25
b(functions)129 349 y Fv(If)13 b(an)f(absolute)h(\014eld)g
Fr(f)f Fv(is)h(to)f(b)q(e)h(used)h(to)e(split)h(patterns,)g
Fr(intervals)e Fv(returns)j(a)f(sorted)129 398 y(list)h(de\014ning)g
(the)g(in)o(terv)n(als)g(that)g(need)g(to)g(b)q(e)h(considered.)-31
461 y Fp(282a)88 b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p
Fo(\021)1031 b Fm(/)5 b Fp(281d)23 b(282b)t Fm(.)171
510 y Fr(procedure)d(intervals\(pattern)o(s,)f(f\))258
560 y(cuts)i(:=)g(set\([0,)g(2^fwidth\(f.field\))o(]\))258
610 y(every)g(p)g(:=)h(!patterns)e(&)h(d)h(:=)f(!p.disjuncts)f(&)h(c)h
(:=)f(!d.aconstraints)e(&)i(c.field)g(===)g(f)h(&)389
660 y(type\(c\))e(==)i("constraint")258 710 y(do)345
760 y(every)f(insert\(cuts,)e(c.lo)i(|)h(c.hi\))258 809
y(return)f(sort\(cuts\))171 859 y(end)129 911 y Fp(De\014nes:)171
950 y Fl(intervals)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(277a)g(and)h
(279a.)129 990 y(Uses)h Fl(constraint)c Fp(55,)j Fl(field)f
Fp(55,)h(and)g Fl(fwidth)e Fp(115d.)192 1052 y Fr(mentions)19
b Fv(pro)q(duces)j(the)g(set)g(con)o(taining)e(all)f(absolute)i
(\014elds)h(men)o(tioned)d(in)i(a)129 1102 y(matc)o(hing)12
b(statemen)o(t.)18 b(Men)o(tions)13 b(in)g(\014eld)h(bindings)f
Fn(don)l('t)g Fv(coun)o(t;)h(this)f(information)e(is)129
1152 y(for)j(building)e(decision)i(trees)i(only)m(.)698
1137 y Ff(2)-33 1214 y Fp(282b)88 b Fo(h)p Fn(*)16 b
Fp(268)p Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(282a)22
b(283a)5 b Fm(.)171 1264 y Fr(procedure)20 b(mentions\(cs\))258
1314 y(result)h(:=)g(set\(\))258 1364 y(every)g(a)g(:=)h(!cs.arms)e(&)i
(d)f(:=)h(!a.pattern.disj)o(uncts)c(&)k(c)f(:=)h(!d.aconstraints)c(&)
389 1413 y(type\(c\))i(==)i("constraint")258 1463 y(do)324
1513 y(insert\(result,)c(c.field\))258 1563 y(return)j(result)171
1613 y(end)129 1664 y Fp(De\014nes:)171 1704 y Fl(mentions)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(274,)h(276a,)f(and)g(279a.)129
1743 y(Uses)i Fl(constraint)c Fp(55,)j Fl(field)f Fp(55,)h(and)g
Fl(pattern)e Fp(55.)p 129 2421 573 2 v 176 2448 a Fc(2)193
2460 y Fp(The)f(original)e(design)g(had)h(no)h(\014eld)f(bindings)e
(and)i(omitting)f(them)g(seems)h(to)h(b)q(e)f(the)g(b)q(est)h
(migration)129 2499 y(path.)p eop
%%Page: 283 283
283 282 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(283)-15 258 y Fp(283a)88 b Fo(h)p
Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1031 b Fm(/)5
b Fp(282b)22 b(283b)5 b Fm(.)187 307 y Fr(procedure)20
b(trim_impossible_)o(arms\()o(cs\))230 357 y(l)i(:=)f([])230
407 y(every)g(a)h(:=)f(!cs.arms)f(do)274 457 y(if)h
(arm_conditions_alwa)o(ys_sa)o(tisfi)o(ed\(a\))d(then)j({)318
507 y(put\(l,)f(a\))318 557 y(if)h(*l)g(<)h(*cs.arms)e(then)h(cs.arms)f
(:=)i(l)318 606 y(return)e(cs)274 656 y(})i(else)f(if)g
(member\(a.imp_soln)o(.cons)o(train)o(ts,)d(0\))k(|)427
706 y(constant\(!\(\\a.s)o(oln\).)o(const)o(raint)o(s\))d(=)i(0)h(then)
f({)318 756 y(cs.arms)f(:=)h(l)318 806 y(return)f(cs)274
855 y(})i(else)f({)318 905 y(put\(l,)f(a\))274 955 y(})230
1005 y(return)h(cs)187 1055 y(end)145 1107 y Fp(De\014nes:)187
1146 y Fl(trim_impos)o(sib)o(le)o(_ar)o(ms)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unk)f(274.)145 1185 y(Uses)i Fl(arm_condit)o(ion)o(s_a)o(lwa)o(ys)
o(_sa)o(tis)o(fie)o(d)d Fp(283b,)h Fl(constant)f Fp(114b,)h(and)g
Fl(constraints)e Fp(136a.)-17 1277 y(283b)88 b Fo(h)p
Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1037 b Fm(/)5
b Fp(283a)22 b(283c)5 b Fm(.)187 1327 y Fr(procedure)20
b(arm_conditions_a)o(lways)o(_sati)o(sfied)o(\(a\))230
1376 y(return)h(guard_always_sati)o(sfied)o(\(a.im)o(p_sol)o(n.co)o
(nstra)o(ints\))d(&)383 1426 y(/a.soln)i(|)i(guard_always_sati)o(sfied)
o(\(a.s)o(oln.c)o(onstr)o(aints)o(\))187 1476 y(end)145
1528 y Fp(De\014nes:)187 1567 y Fl(arm_condit)o(ion)o(s_)o(alw)o(ays)o
(_sa)o(tis)o(fi)o(ed)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(283a.)145
1607 y(Uses)i Fl(constraint)o(s)d Fp(136a)h(and)h Fl(guard_alwa)o(ys)o
(_sa)o(tis)o(fie)o(d)e Fp(96b.)-13 1698 y(283c)88 b Fo(h)p
Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1033 b Fm(/)5
b Fp(283b)22 b(284a)5 b Fm(.)187 1748 y Fr(#)21 b(find_id:)g(tab)g(to)g
(and)g(past)g(identifier)f(id,)h(returning)f(its)h(position)187
1798 y(#)g(ignores)g(quotes,)f(comment)g(brackets)187
1897 y(procedure)g(find_id\(id\))274 1947 y(static)h(notlnum)274
1997 y(initial)f(notlnum)h(:=)g(~)h(\(&letters)e(++)h(&digits)f(++)i
('_'\))274 2047 y(tab\(p)f(:=)g(find\(id\)\))f(&)i(p)f(=)h(1)f(|)h
(\(move\(-1\))e(&)h(any\(notlnum\))f(&)h(move\(1\)\))g(&)514
2097 y(=id)g(&)g(pos\(0\))g(|)h(any\(notlnum\))d(&)i(suspend)g(p)187
2146 y(end)p eop
%%Page: 284 284
284 283 bop 129 141 a Fv(284)83 b Fr(tree.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y Fj(13.5)66 b(T)-6 b(ree)23
b(c)n(hec)n(king)129 349 y Fv(Once)18 b(the)g(tree)g(is)e(generated,)j
(it's)d(useful)h(to)g(c)o(hec)o(k)g(it)g(for)f(redundan)o(t)i(arms)d
(and)i(for)129 398 y(arms)g(that)h(nev)o(er)h(matc)o(h.)28
b(These)19 b(c)o(hec)o(ks)g(will)e(help)g(users)j(catc)o(h)e(mistak)o
(es)f(in)g(their)129 448 y(sp)q(eci\014cations.)24 b(Note)16
b(that)g(I)f(m)o(ust)g(c)o(hec)o(k)h(the)g(\\original")d(arms;)i
(that's)h(wh)o(y)f(they're)129 498 y(there.)-31 560 y
Fp(284a)88 b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(283c)23 b(284b)t Fm(.)171
610 y Fr(procedure)d(checktree\(n,)f(cs\))258 660 y(originals)h(:=)h
(set\(\))258 710 y(every)g(insert\(originals,)d(\(!cs.arms\).origina)o
(l\))258 760 y(deletematching\(n,)g(originals\))258 809
y(every)j(show_unmatched\(n,)d(!originals\))258 859 y(if)k
(hasnomatch\(n\))d(then)345 909 y(warning\("Matching)g(statement)h(at)h
(",)g(image\(cs.arms[1].fi)o(le\),)d(",)k(line)f(",)520
959 y(n.cs.arms[1].lin)o(e)e(-)j(1,)f(")g(doesn't)g(cover)g(all)g
(cases"\))258 1009 y(return)g(n)171 1058 y(end)129 1110
y Fp(De\014nes:)171 1150 y Fl(checktree)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(22b.)129 1189 y(Uses)f Fl(deletematc)o(hi)o(ng)c
Fp(284b,)i Fl(file)g Fp(359a,)f Fl(hasnomatch)f Fp(284c,)i
Fl(line)g Fp(359a,)g(and)g Fl(show_unmat)o(che)o(d)e
Fp(285a.)-33 1272 y(284b)88 b Fo(h)p Fn(*)16 b Fp(268)p
Fo(i)o Fv(+)p Fo(\021)1037 b Fm(/)5 b Fp(284a)22 b(284c)5
b Fm(.)171 1322 y Fr(procedure)20 b(deletematching\(n,)e(originals\))
258 1372 y(if)k(*originals)d(=)j(0)f(then)g(return)258
1422 y(else)g(if)g(*n.children)f(>)i(0)f(then)g(every)g
(deletematching\(\(!)o(n.chi)o(ldren)o(\).no)o(de,)e(originals\))258
1471 y(else)i(every)g(delete\(originals,)d(\(!n.cs.arms\).origi)o
(nal\))171 1521 y(end)129 1573 y Fp(De\014nes:)171 1613
y Fl(deletematc)o(hin)o(g)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(284a.)
129 1652 y(Uses)i Fl(node)e Fp(272.)-29 1743 y(284c)88
b Fo(h)p Fn(*)16 b Fp(268)p Fo(i)o Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(284b)22 b(285a)5 b Fm(.)171 1793 y Fr(procedure)20
b(hasnomatch\(n\))258 1843 y(if)i(*n.children)d(>)j(0)f(then)g(return)g
(hasnomatch\(\(!n.c)o(hildr)o(en\).n)o(ode\))258 1893
y(else)g(if)g(*n.cs.arms)f(=)i(0)f(then)g(return)43 b(#)21
b(found)g(it)171 1943 y(end)129 1994 y Fp(De\014nes:)171
2034 y Fl(hasnomatch)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(284a.)129
2073 y(Uses)i Fl(node)e Fp(272.)p eop
%%Page: 285 285
285 284 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(tree.nw)81 b Fv(285)164 258 y(If)19 b(an)g(arm)f(nev)o(er)i(matc)o
(hes,)g(I)f(push)h(its)f(pattern)h(through)g(the)f(tree)i(and)e(\014nd)
g(out)145 307 y(com)o(binations)12 b(of)h(arms)g(do)h(matc)o(h)e(that)i
(pattern.)-1368 b Fk(\031Change)14 b(#33)-15 370 y Fp(285a)88
b Fo(h)p Fn(*)15 b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(284c)22 b(285b)5 b Fm(.)187 420 y Fr(procedure)20
b(show_unmatched\(n)o(,)f(a\))230 469 y(warning\("No)h(word)h(matches)f
(pattern)h(at)g(",)g(image\(a.file\),)e(",)j(line)f(",)g(a.line,)f
("."\))230 519 y(write\(&errout,")84 b(Covered)21 b(by)g(patterns)f
(at"\))230 569 y(every)h(find_covering_arms)o(\(n,)e(a,)i
(!a.pattern.disjun)o(cts\))230 619 y(return)187 669 y(end)187
768 y(procedure)f(find_covering_ar)o(ms\(n,)e(a,)k(ad\))230
818 y(if)g(*n.children)d(=)j(0)f(then)274 868 y(every)g(a)g(:=)h
(!n.cs.arms)d(do)318 918 y(write\(&errout,)f("\\t",)j(image\(a.file\),)
e(",)i(line)g(",)h(a.line\))230 967 y(else)f({)274 1017
y(c)h(:=)f(find_or_invent_co)o(nstra)o(int\(n)o(.fiel)o(d,)e(ad\))274
1067 y(every)i(e)g(:=)h(!n.children)d(&)j(intervals_inters)o(ect\(c)o
(.lo,)c(c.hi,)j(e.lo,)g(e.hi\))g(do)318 1117 y(find_covering_a)o
(rms\(e)o(.node)o(,)e(a,)i(ad\))230 1167 y(})230 1217
y(return)187 1266 y(end)145 1318 y Fp(De\014nes:)187
1358 y Fl(show_unmat)o(che)o(d)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f
(284a.)145 1397 y(Uses)j Fl(field)d Fp(55,)i Fl(file)f
Fp(359a,)g Fl(find_or_in)o(ven)o(t_c)o(on)o(str)o(ain)o(t)e
Fp(285b,)i Fl(intervals_i)o(nte)o(rse)o(ct)e Fp(285b,)187
1437 y Fl(line)h Fp(359a,)g Fl(node)h Fp(272,)f(and)h
Fl(pattern)e Fp(55.)-17 1520 y(285b)88 b Fo(h)p Fn(*)15
b Fp(268)p Fo(i)p Fv(+)p Fo(\021)1152 b Fm(/)6 b Fp(285a)187
1569 y Fr(procedure)20 b(intervals_inters)o(ect\(l)o(o1,)f(hi1,)i(lo2,)
f(hi2\))230 1619 y(if)i(hi1)f(<=)g(lo2)g(|)h(hi2)f(<=)h(lo1)f(then)g
(fail)g(else)g(return)187 1669 y(end)187 1769 y(#)g(absolute)g
(disjuncts!)187 1818 y(procedure)f(find_or_invent_c)o(onstr)o(aint\()o
(f,)f(d\))230 1868 y(return)i(if)g(type\(c)g(:=)g(!d.aconstraints\))e
(==)i("constraint")e(&)j(c.field)e(===)i(f)f(then)g(c)383
1918 y(else)g(constraint\(f,)e(0,)i(2^fwidth\(f.field\)\))187
1968 y(end)145 2020 y Fp(De\014nes:)187 2059 y Fl(find_or_in)o(ven)o
(t_)o(con)o(str)o(ain)o(t)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(285a.)
187 2099 y Fl(intervals_)o(int)o(er)o(sec)o(t)p Fp(,)f(used)h(in)h(c)o
(h)o(unk)f(285a.)145 2138 y(Uses)i Fl(constraint)c Fp(55,)j
Fl(fail)f Fp(410,)h Fl(field)f Fp(55,)h(and)f Fl(fwidth)g
Fp(115d.)p eop
%%Page: 286 286
286 285 bop 129 141 a Fv(286)83 b Fr(dag.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)p eop
%%Page: 287 287
287 286 bop 145 569 a Fq(Chapter)32 b(14)145 777 y Fu(Con)m(v)m(erting)
39 b(trees)g(to)g(dags)145 992 y Fv(The)16 b(problem)e(with)h(the)h
(trees)h(generated)g(in)e(the)h(previous)g(section)g(is)g(that)f
(there's)i(a)145 1042 y(di\013eren)o(t)g(edge,)g(and)f(therefore)i(a)e
(di\013eren)o(t)h(c)o(hild,)f(for)g(eac)o(h)g(p)q(ossible)h(in)o(terv)n
(al)e(of)h(the)145 1092 y(\014eld)d(tested,)g(ev)o(en)g(if)f(those)h(c)
o(hildren)f(b)q(oth)g(execute)i(exactly)f(the)g(same)e(\\original")f
(arm)145 1142 y(of)k(the)h(case)h(statemen)o(t.)j(The)c(co)q(de)h(in)e
(this)g(section)h(con)o(v)o(erts)h(the)f(trees)h(to)e(dags,)h(and)145
1192 y(as)h(part)g(of)g(the)g(pro)q(cess)i(it)e(com)o(bines)f(edges)i
(p)q(oin)o(ting)d(to)i(the)h(same)e(no)q(de.)24 b(This)16
b(can)145 1241 y(reduce)g(the)e(size)h(of)e(the)i(tree)g(b)o(y)f(h)o
(uge)g(factors.)208 1291 y(T)m(o)g(mak)o(e)g(the)i(transformation)d(w)o
(ork,)i(I)g(ha)o(v)o(e)g(to)g(represen)o(t)j(a)d Fn(set)h(of)g
(intervals)f Fv(on)145 1341 y(eac)o(h)e(edge,)g(not)f(just)h(a)f
(single)g(in)o(terv)n(al.)17 b(Because)d(no)e(t)o(w)o(o)g(in)o(terv)n
(als)g(o)o(v)o(erlap,)g(I)g(can)h(use)145 1391 y(a)f(w)o(onderful)g
(dirt)o(y)g(tric)o(k,)g(detailed)g(b)q(elo)o(w.)18 b(I)12
b(also)f Fn(may)i Fv(con)o(v)o(ert)g(a)f(no)q(de's)g(name)f(string)145
1441 y(to)k(a)f Fr(namearray)e Fv(mapping)h(\014eld)h(v)n(alues)h(to)f
(strings.)20 b(The)15 b(goal)f(is)g(for)g(c)o(hildren)h(of)f(the)145
1491 y(same)i(paren)o(t)h(to)f(share)h(a)f(single)g(name)g(arra)o(y;)h
(that)f(w)o(a)o(y)g(the)h(edges)g(can)g(b)q(e)g(merged)145
1540 y(and)d(the)h(name)f(op)q(erator)h(can)f(b)q(e)h(implemen)o(ted)d
(with)i(an)g(arra)o(y)h(reference.)22 b(If)14 b(I)g(don't)145
1590 y(con)o(v)o(ert)f(a)f(no)q(de's)g(name,)f(the)i(only)e(p)q(enalt)o
(y)h(is)g(that)h(the)f(tree)i(migh)o(t)c(b)q(e)j(bigger.)k(\(Co)q(de)
145 1640 y(generation)d(will)f(b)q(e)h(di\013eren)o(t)h(for)f(the)g(t)o
(w)o(o)g(cases.\))830 2604 y(287)p eop
%%Page: 288 288
288 287 bop 129 141 a Fv(288)83 b Fr(dag.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(No)o(w,)i(the)i(dirt)o(y)f(represen)o
(tation)h(tric)o(k:)22 b(I)16 b(can)g(represen)o(t)j(a)c(set)i(of)e(n)o
(um)o(b)q(ers)h Fi(S)j Fv(\(a)129 307 y(union)14 b(of)f(in)o(terv)n
(als\))h(as)g(t)o(w)o(o)f(sets,)i Fi(l)q(o)f Fv(and)g
Fi(hi)p Fv(,)f(suc)o(h)i(that)233 390 y Fi(l)q(o)10 b
Fo(\\)f Fi(hi)i Fv(=)h Fo(;)233 474 y Fv(if)h Fr(sort)o
Fv(\()p Fi(l)q(o)d Fo([)f Fi(hi)p Fv(\))j(=)g Fi(a;)7
b(b;)g(c;)g(d;)g(:)f(:)h(:)l Fv(,)14 b(then)g Fi(S)h
Fv(=)c([)p Fi(a;)c(b)h Fo(\000)i Fv(1])e Fo([)h Fv([)p
Fi(c;)e(d)h Fo(\000)i Fv(1])e Fo([)h Fi(:)e(:)g(:)n Fv(.)129
557 y(The)19 b(pro)q(cedure)h Fr(addinterval)c Fv(adds)i(a)g(new)g(in)o
(terv)n(al)f(to)h(suc)o(h)h(a)f(set)h Fi(S)r Fv(,)g(relying)f(on)129
606 y(the)e(fact)f(that)h(no)e(t)o(w)o(o)h(in)o(terv)n(als)g(o)o(v)o
(erlap.)21 b(The)16 b(implem)o(en)o(tation)c(ma)o(y)h(b)q(e)j(treated)g
(as)129 656 y(\\blac)o(k)e(magic")d(or)j(\\mathematics;")d(tak)o(e)j(y)
o(our)f(pic)o(k.)1018 641 y Ff(1)-31 718 y Fp(288a)88
b Fo(h)p Fn(*)16 b Fp(288a)p Fo(i)n(\021)1166 b Fp(288b)t
Fm(.)171 768 y Fr(procedure)20 b(addinterval\(loset)o(,)f(hiset,)i
(lonum,)f(hinum\))258 818 y(if)i(member\(loset,)d(hinum\))h(then)h
(delete\(loset,)e(hinum\))i(else)g(insert\(hiset,)e(hinum\))258
868 y(if)j(member\(hiset,)d(lonum\))h(then)h(delete\(hiset,)e(lonum\))i
(else)g(insert\(loset,)e(lonum\))258 918 y(return)171
967 y(end)129 1019 y Fp(De\014nes:)171 1059 y Fl(addinterva)o(l)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(196a)g(and)h(291b.)192
1121 y Fv(A)16 b(new)h(in)o(terv)n(al)e(o)o(v)o(erlaps)h(unless)i(it)d
(falls)h(b)q(et)o(w)o(een)h(t)o(w)o(o)f(existing)g(in)o(terv)n(als.)25
b(The)129 1171 y(lo)q(cal)12 b(v)n(ariable)f Fr(leftcount)g
Fv(is)h(the)h(n)o(um)o(b)q(er)f(of)g(in)o(terv)n(als)g(completely)f(to)
i(the)g(left)f(of)g(the)129 1221 y(new)j(in)o(terv)n(al.)k
Fr(rightcount)12 b Fv(is)i(the)h(n)o(um)o(b)q(er)f(of)f(in)o(terv)n
(als)h(completely)f(to)h(the)h(righ)o(t)f(of)129 1271
y(the)i(new)f(in)o(terv)n(al.)20 b(If)15 b(these)h(total)e(to)h(the)h
(n)o(um)o(b)q(er)e(of)g(in)o(terv)n(als,)g(there)i(is)f(no)g(o)o(v)o
(erlap.)129 1320 y(Otherwise,)g(there)h(is)d(an)h(o)o(v)o(erlap.)-33
1383 y Fp(288b)88 b Fo(h)p Fn(*)16 b Fp(288a)p Fo(i)n
Fv(+)q Fo(\021)1017 b Fm(/)5 b Fp(288a)22 b(289a)5 b
Fm(.)171 1432 y Fr(procedure)20 b(overlaps\(loset,)f(hiset,)h(lonum,)h
(hinum\))215 1482 y(local)f(leftcount,)g(rightcount)215
1532 y(leftcount)41 b(:=)22 b(0;)f(every)g(lonum)g(>=)g(!hiset)f(do)i
(leftcount)42 b(+:=)21 b(1)215 1582 y(rightcount)e(:=)j(0;)f(every)g
(hinum)g(<=)g(!loset)f(do)i(rightcount)e(+:=)h(1)215
1632 y(return)f(leftcount)g(+)i(rightcount)d(<)j(*loset)171
1681 y(end)129 1733 y Fp(De\014nes:)171 1773 y Fl(overlaps)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(196a.)p 129 2461 573
2 v 176 2487 a Fc(1)193 2499 y Fp(Extra)g(credit)g(for)h(pro)q(ofs)f
(of)i(correctness.)p eop
%%Page: 289 289
289 288 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(dag.nw)82 b Fv(289)208 258 y(T)m(o)13 b(sho)o(w)h(a)f(bit)h(set,)g
(giv)o(e)f(the)i(n)o(um)o(b)q(er)e(of)g(bits.)-15 320
y Fp(289a)88 b Fo(h)p Fn(*)15 b Fp(288a)p Fo(i)o Fv(+)p
Fo(\021)1014 b Fm(/)5 b Fp(288b)22 b(289b)5 b Fm(.)187
370 y Fr(procedure)20 b(showbitset\(loset)o(,)f(hiset,)i(width\))230
420 y(l)h(:=)f(sort\(loset)f(++)h(hiset\))230 469 y(b)h(:=)f(0)230
519 y(i)h(:=)f(0)230 569 y(s)h(:=)f("")230 619 y(while)g(i)h(<)f(width)
g(do)g({)274 669 y(if)g(i)h(=)g(l[1])e(then)h({)318 718
y(get\(l\))318 768 y(b)g(:=)h(1)f(-)h(b)274 818 y(})274
868 y(s)g(||:=)f(b)274 918 y(i)h(+:=)f(1)230 967 y(})230
1017 y(return)g(reverse\(s\))187 1067 y(end)208 1129
y Fv(T)m(o)9 b(con)o(v)o(ert)i(trees)g(to)f(dags)g(I)g(need)h(to)f(b)q
(e)h(able)f(to)g(compare)f(t)o(w)o(o)h(no)q(des)h(for)e(structural)145
1179 y(iden)o(tit)o(y)m(,)h(and)g(the)g(easiest)i(w)o(a)o(y)d(is)h(to)g
(compute)g(a)g(canonical)f(represen)o(tation)j(as)e(a)g(string:)167
1262 y Fr(node)21 b(:)h([fname:patimage\()o(list)c(of)k(edges\)])276
1312 y(|)g(\(image\(node.name)o(\):im)o(age\(n)o(ode.c)o(s.arm)o
(s.\(or)o(igina)o(l,im)o(p_sol)o(n\)\))167 1362 y(edge)f(:)h
(patimage\(list)d(of)i(sort\(loset)f(++)h(hiset\)\):node)-17
1445 y Fp(289b)88 b Fo(h)p Fn(*)15 b Fp(288a)p Fo(i)o
Fv(+)p Fo(\021)1018 b Fm(/)5 b Fp(289a)22 b(290a)5 b
Fm(.)187 1495 y Fr(procedure)20 b(nodetostring\(n,)e(depth\))274
1544 y(static)j(cache)274 1594 y(initial)f(cache)h(:=)g(table\(\))274
1644 y(/depth)g(:=)g(0)274 1694 y(if)g(/cache[n])f(then)361
1744 y(if)i(*n.children)d(>)j(0)f(then)g({)448 1794 y(result)g(:=)g
("[")g(||)h(n.field.field.na)o(me)d(||)i("@")g(||)h(n.field.offset)d
(||)i(":")448 1843 y(every)g(result)g(||:=)g(edgetostring\(!n)o(.chil)o
(dren,)d(depth+2\))448 1893 y(cache[n])i(:=)i(result)e(||)i("]")361
1943 y(})g(else)f({)448 1993 y(cache[n])f(:=)i("\(")f(||)g
(image\(n.name\))448 2043 y(every)g(a)h(:=)f(!n.cs.arms)f(do)492
2092 y(cache[n])g(||:=)h(":")g(||)h(image\(a.origina)o(l\))d(||)i(":")g
(||)h(image\(a.imp_soln)o(\))d(||)797 2142 y(":")i(||)h
(image\(a.patlen\))448 2192 y(cache[n])e(||:=)h("\)")361
2242 y(})274 2292 y(return)g(\\cache[n])187 2342 y(end)145
2393 y Fp(De\014nes:)187 2433 y Fl(nodetostri)o(ng)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(290.)145 2472 y(Uses)i
Fl(edgetostri)o(ng)c Fp(290a)j(and)f Fl(field)g Fp(55.)p
eop
%%Page: 290 290
290 289 bop 129 141 a Fv(290)83 b Fr(dag.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(290a)88 b Fo(h)p Fn(*)16
b Fp(288a)p Fo(i)n Fv(+)q Fo(\021)1013 b Fm(/)5 b Fp(289b)23
b(290b)t Fm(.)171 307 y Fr(procedure)d(edgetostring\(e,de)o(pth\))258
357 y(return)h(left\("\\n",)e(depth\))i(||)389 407 y("{")g(||)g
(patimage\(sort\(e.lo)e(++)i(e.hi\)\))f(||)i(":")f(||)g
(nodetostring\(e.node)o(,dept)o(h\))e(||)i("}")171 457
y(end)129 509 y Fp(De\014nes:)171 548 y Fl(edgetostri)o(ng)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(289b.)129 588 y(Uses)i
Fl(node)e Fp(272,)h Fl(nodetostri)o(ng)d Fp(289b,)j(and)f
Fl(patimage)f Fp(372a.)192 658 y Fv(Con)o(v)o(ersion)i(to)g(dag)g(is)h
(the)g(usual)f(b)q(ottom-up)f(hashing;)h(here)i(I)e(compute)g(the)h
(string)129 708 y(and)k(then)f(use)i(the)e(string)h(to)f(index)g(in)o
(to)g(a)f(table.)22 b(The)16 b(real)f(w)o(ork)g(of)g(merging)e(edges)
129 758 y(is)g(done)g(b)o(y)g Fr(combinechildren)p Fv(.)i(If)d(edge)i
(merging)d(results)j(in)e(a)h(single)f(eac)o(h,)i(the)f(no)q(de)129
808 y(is)g(replaced)g(b)o(y)g(its)f(c)o(hild,)g(pro)o(vided)h(the)g
(edge)g(really)f(co)o(v)o(ers)h(all)f(p)q(ossible)h(v)n(alues)f(of)g
(the)129 857 y(\014eld.)-33 920 y Fp(290b)88 b Fo(h)p
Fn(*)16 b Fp(288a)p Fo(i)n Fv(+)q Fo(\021)1019 b Fm(/)5
b Fp(290a)22 b(290c)5 b Fm(.)171 970 y Fr(procedure)20
b(tree2dag\(n,)f(nodetable,)h(depth\))258 1019 y(outtree\(\\ascii_tre)o
(e,)f(n\))258 1069 y(/nodetable)h(:=)h(table\(\))258
1119 y(/depth)g(:=)g(0)258 1169 y(if)h(*n.children)d(>)j(0)f(then)345
1219 y(combinechildren\(n,)d(nodetable,)i(depth+2\))42
b(#)22 b(converts)e(edges)h(to)g(set)g(form)258 1268
y(if)h(*n.children)d(=)j(1)f(then)g({)345 1318 y(e)h(:=)f
(n.children[1])345 1368 y(if)h(covers\(n.childre)o(n[1],)c
(fwidth\(n.field.fie)o(ld\)\))g(then)432 1418 y(n)k(:=)f
(n.children[1].node)106 b(#)21 b(all)g(roads)g(to)h(child:)e(hoist)h
(it)345 1468 y(else)432 1518 y(warning\("node)f(with)h(one)g(child)f
(doesn't)h(match)g(all)g(cases"\))258 1567 y(})258 1617
y(s)h(:=)f(nodetostring\(n,)e(depth\))258 1667 y(outtree\(\\ascii_dag)o
(,)g(n\))258 1717 y(/nodetable[s])g(:=)j(n)258 1767 y(return)f
(nodetable[s])171 1816 y(end)129 1868 y Fp(De\014nes:)171
1908 y Fl(tree2dag)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(22b)h(and)f
(291b.)129 1947 y(Uses)j Fl(combinechild)o(re)o(n)d Fp(291b,)i
Fl(covers)f Fp(290c,)g Fl(field)g Fp(55,)i Fl(fwidth)e
Fp(115d,)g Fl(hoist)g Fp(218,)h Fl(node)g Fp(272,)171
1987 y Fl(nodetostri)o(ng)c Fp(289b,)j(and)f Fl(outtree)f
Fp(373b.)192 2049 y Fv(Here's)17 b(where)g(I)g(c)o(hec)o(k)g(co)o(v)o
(erage.)25 b(Only)16 b(success)j(or)d(failure)f(of)h
Fr(covers)f Fv(is)h(mean-)129 2099 y(ingful,)c(not)i(the)h(v)n(alue)e
(returned.)-29 2161 y Fp(290c)88 b Fo(h)p Fn(*)16 b Fp(288a)p
Fo(i)n Fv(+)q Fo(\021)1015 b Fm(/)5 b Fp(290b)22 b(291a)5
b Fm(.)171 2211 y Fr(procedure)20 b(covers\(e,)g(width\))258
2261 y(l)i(:=)f(sort\(e.lo)f(++)h(e.hi\))258 2310 y(return)g(*l)g(=)h
(2)f(&)h(l[1])f(=)g(0)h(&)g(l[2])f(=)g(2^width)171 2360
y(end)129 2412 y Fp(De\014nes:)171 2452 y Fl(covers)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(290b.)p eop
%%Page: 291 291
291 290 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(dag.nw)82 b Fv(291)208 258 y(The)13 b(complicated)e(stu\013)i
(here)h(is)f(iden)o(tifying)e(a)h(name)g(arra)o(y)m(.)17
b(A)o(t)12 b(eac)o(h)i(no)q(de,)f(either)145 307 y(all)j(edges)i(go)f
(in)f(an)h(exiting)g(name)e(arra)o(y)i(or)g(a)g(new)g(name)f(arra)o(y)h
(is)g(used.)28 b(If)17 b(not,)g(I)145 357 y(create)f(a)d(new)i(one.)-15
420 y Fp(291a)88 b Fo(h)p Fn(*)15 b Fp(288a)p Fo(i)o
Fv(+)p Fo(\021)1018 b Fm(/)5 b Fp(290c)22 b(291b)5 b
Fm(.)187 469 y Fr(record)20 b(namearray\(field,)f(tbl,)i(hi,)g
(codename,)f(storageclass\))187 519 y(#)h(field)g(used)g(as)g(index,)g
(table[integer])e(of)i(name,)g(bound)g(on)g(table,)g(name)g(of)g(this)g
(array)187 569 y(global)f(natable)145 621 y Fp(De\014nes:)187
660 y Fl(namearray)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(248,)g
(292{94,)g(333d,)g(334b,)g(346a,)g(and)h(357b.)187 700
y Fl(natable)p Fp(,)e(used)h(in)i(c)o(h)o(unks)d(291b)i(and)f(292a.)145
739 y(Uses)i Fl(field)e Fp(55)h(and)g Fl(used)f Fp(136a.)145
801 y Fv(The)j(\014elds)g Fr(codename)d Fv(and)i Fr(storageclass)e
Fv(can)j(b)q(e)f(defaulted)h(\(to)f(a)g(gensym'ed)g(name)145
851 y(and)i(to)g Fr(static)p Fv(,)e(resp)q(ectiv)o(ely\).)-17
914 y Fp(291b)88 b Fo(h)p Fn(*)15 b Fp(288a)p Fo(i)o
Fv(+)p Fo(\021)1016 b Fm(/)5 b Fp(291a)22 b(292b)5 b
Fm(.)187 963 y Fr(procedure)20 b(arraycandidates\()o(n\))274
1013 y(initial)g(MAXRANGE)g(:=)i(32)274 1063 y(suspend)e(e)i(:=)f
(!n.children)f(&)h(type\(e.node.name\))e(==)i("string")f(&)448
1113 y(e.hi)h(-)h(e.lo)f(<=)g(MAXRANGE)f(&)i(e)187 1163
y(end)187 1262 y(procedure)e(combinechildren\()o(n,)f(nodetable,)h
(depth\))274 1312 y(initial)g(natable)h(:=)g(table\(\))274
1412 y(if)g(arraycandidates\(n\).)o(node.)o(name)d(~==)k
(arraycandidates)o(\(n\).n)o(ode.n)o(ame)d(then)h({)361
1461 y Fo(h)p Fn(change)c(names)g(of)e(childr)n(en)h(fr)n(om)f(strings)
g(to)h(name)n(arr)n(ays)g(when)g(p)n(ossible)g Fp(292a)p
Fo(i)274 1511 y Fr(})274 1611 y(lotable)20 b(:=)i(table\(\))274
1661 y(hitable)e(:=)i(table\(\))274 1711 y(every)f(e)g(:=)h
(!n.children)d(&)j(child)f(:=)g(tree2dag\(e.node,)d(nodetable,)i
(depth\))h(do)g({)361 1760 y(/lotable[child])e(:=)i(set\(\))361
1810 y(/hitable[child])e(:=)i(set\(\))361 1860 y(addinterval\(lotabl)o
(e[chi)o(ld],)d(hitable[child],)h(e.lo,)i(e.hi\))274
1910 y(})274 1960 y(n.children)f(:=)h([])274 2009 y(every)g(child)f(:=)
i(key\(lotable\))d(do)361 2059 y(put\(n.children,)g(edge\(child,)g
(lotable[child],)g(hitable[child]\)\))274 2109 y(return)187
2159 y(end)145 2211 y Fp(De\014nes:)187 2250 y Fl(arraycandi)o(dat)o
(es)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(292a.)187 2290
y Fl(combinechi)o(ldr)o(en)o Fp(,)f(used)i(in)g(c)o(h)o(unk)f(290b.)145
2329 y(Uses)17 b Fl(addinterv)o(al)c Fp(288a,)i Fl(edge)f
Fp(272,)h Fl(MAXRANGE)f Fp(299b,)g Fl(natable)g Fp(291a,)h
Fl(node)g Fp(272,)187 2368 y(and)10 b Fl(tree2dag)f Fp(290b.)p
eop
%%Page: 292 292
292 291 bop 129 141 a Fv(292)83 b Fr(dag.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(292a)88 b Fo(h)p Fn(change)16
b(names)g(of)f(childr)n(en)f(fr)n(om)g(strings)h(to)f(name)n(arr)n(ays)
h(when)g(p)n(ossible)g Fp(292a)p Fo(i)o(\021)87 b Fp(\(291b\))171
307 y Fr(mightuse)20 b(:=)h(set\(\))239 b(#)22 b(name)f(arrays)f(we)i
(might)e(use)i(must)f(have)g(right)f(field)171 357 y(every)h(na)g(:=)g
(!\\natable[n.field])e(do)258 407 y(insert\(mightuse,)g(na\))171
457 y(every)i(e)g(:=)h(arraycandidates\()o(n\))d(&)i(na)h(:=)f
(!mightuse)f(do)258 507 y(if)i(\\na.tbl[e.lo)d(to)i(e.hi)g(-)h(1])f
(~==)g(e.node.name)f(then)43 b(#)21 b(slot)g(used)g(with)g(wrong)g
(name)345 557 y(delete\(mightuse,)e(na\))171 606 y(if)i(*mightuse)f(>)i
(0)f(then)258 656 y(willuse)f(:=)i(?mightuse)171 706
y(else)f({)258 756 y(/natable[n.field])d(:=)k(set\(\))258
806 y(insert\(natable[n.f)o(ield])o(,)d(willuse)h(:=)i
(namearray\(n.fiel)o(d,)d(table\(\),)h(0\)\))171 855
y(})171 905 y(every)h(e)g(:=)h(arraycandidates\()o(n\))d(&)302
955 y(e.lo)i(-)g(willuse.hi)f(<=)h(MAXRANGE)g(do)g({)389
1005 y(every)g(willuse.tbl[e.lo)d(to)k(e.hi)e(-)i(1])f(:=)h
(e.node.name;)389 1055 y(e.node.name)d(:=)j(willuse)389
1104 y(willuse.hi)e(<:=)h(e.hi)302 1154 y(})129 1206
y Fp(Uses)14 b Fl(arraycandi)o(da)o(tes)c Fp(291b,)h
Fl(field)h Fp(55,)g Fl(MAXRANGE)f Fp(299b,)h Fl(namearray)e
Fp(291a,)i Fl(natable)e Fp(291a,)171 1246 y Fl(node)g
Fp(272,)h(and)f Fl(used)h Fp(136a.)-33 1337 y(292b)88
b Fo(h)p Fn(*)16 b Fp(288a)p Fo(i)n Fv(+)q Fo(\021)1133
b Fm(/)5 b Fp(291b)171 1387 y Fr(procedure)20 b(namesused\(n,)f
(result\))258 1437 y(/result)h(:=)i(set\(\))258 1486
y(if)g(type\(n.name\))d(==)i("namearray")f(then)h(insert\(result,)e
(n.name\))258 1536 y(every)i(namesused\(\(!n.chi)o(ldren)o(\).nod)o(e,)
e(result\))258 1586 y(return)i(result)171 1636 y(end)129
1688 y Fp(De\014nes:)171 1727 y Fl(namesused)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(295b.)129 1767 y(Uses)i Fl(namearray)d
Fp(291a)h(and)h Fl(node)f Fp(272.)p eop
%%Page: 293 293
293 292 bop 145 569 a Fq(Chapter)32 b(15)145 777 y Fu(Co)s(de)39
b(generation)g(for)145 901 y(matc)m(hing)145 1117 y Fv(This)17
b(mo)q(dule)e(con)o(tains)i(the)g(language-indep)q(enden)o(t)g(part)g
(of)f(co)q(de)h(generation)g(for)g(a)145 1167 y(matc)o(hing)c(statemen)
o(t.)20 b(The)14 b(records)i(b)q(eginning)e(with)g Fr(G)h
Fv(de\014ne)g(the)g(structure,)h(whic)o(h)145 1217 y(is)e(to)g(b)q(e)g
(instan)o(tiated)g(in)f(a)h(language-dep)q(enden)o(t)h(w)o(a)o(y)m(.)
-15 1279 y Fp(293a)88 b Fo(h)p Fn(*)15 b Fp(293a)p Fo(i)o(\021)1165
b Fp(293b)5 b Fm(.)187 1329 y Fr(record)20 b(Glines\(x\))347
b(#)22 b(list)f(of)g(lines)g(to)g(be)h(written)e(out)187
1378 y(record)g(Gresynch\(line,)f(file\))108 b(#)22 b(C)f(#line)g(or)g
(m3)h(<*)f(LINE)g(...)g(*>)187 1428 y(record)f(Gblock\(decls,)f
(stmts\))108 b(#)22 b(block)f(with)f(local)h(variables)187
1478 y(record)f(Gdecl\(name,)g(type,)h(init\))42 b(#)22
b(variable)e(with)h(name,)g(type,)f(optional)h(initial)f(value)187
1528 y(record)g(Gcall\(name,)g(args\))173 b(#)22 b(call)f(to)g(named)g
(function)145 1580 y Fp(De\014nes:)187 1619 y Fl(Gblock)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(86c,)g(109d,)g(119a,)h(125b,)f
(133a,)g(295{97,)f(301a,)h(331d,)g(332e,)h(and)f(344e.)187
1659 y Fl(Gcall)p Fp(,)g(used)g(in)h(c)o(h)o(unks)f(309,)h(311a,)f
(330e,)g(and)h(343b.)187 1698 y Fl(Gdecl)p Fp(,)f(used)g(in)h(c)o(h)o
(unks)f(86c,)h(109d,)f(119a,)g(125b,)g(133a,)g(295b,)g(297c,)g(301a,)h
(332e,)f(and)g(344e.)187 1738 y Fl(Glines)p Fp(,)f(used)i(in)g(c)o(h)o
(unks)f(86c,)g(109d,)g(119a,)h(125b,)f(133a,)g(294d,)g(295b,)g(302a,)g
(332d,)g(and)h(344d.)187 1777 y Fl(Gresynch)p Fp(,)e(used)h(in)h(c)o(h)
o(unks)f(86c,)h(109d,)f(119a,)g(125b,)g(133a,)g(294d,)g(295b,)g(302a,)g
(332d,)g(and)h(344d.)145 1816 y(Uses)h Fl(file)e Fp(359a,)g
Fl(line)h Fp(359a,)f(and)h Fl(value)f Fp(136a.)145 1879
y Fv(F)m(or)17 b Fr(Gdecl)p Fv(,)g(w)o(e)h(require)h(only)d(that)i(a)f
(t)o(yp)q(e)h(or)g(an)f(initial)f(v)n(alue)h(b)q(e)h(sp)q(eci\014ed,)h
(as)f(in)145 1928 y(Mo)q(dula-3.)30 b(Emitters)18 b(for)g(C)g(ma)o(y)e
(ha)o(v)o(e)i(to)g(infer)g(a)g(t)o(yp)q(e)h(when)g(an)f(initial)e(v)n
(alue)i(is)145 1978 y(giv)o(en.)-17 2049 y Fp(293b)88
b Fo(h)p Fn(*)15 b Fp(293a)p Fo(i)o Fv(+)p Fo(\021)1018
b Fm(/)5 b Fp(293a)22 b(294a)5 b Fm(.)187 2099 y Fr(record)20
b(Gdeclnamearray\(na\))149 b(#)22 b(declares)e(CONST)h(ARRAY)f(OF)i
(TEXT)f(specified)f(by)884 2148 y(#)i(namearray)e(na.)145
2200 y Fp(De\014nes:)187 2240 y Fl(Gdeclnamea)o(rra)o(y)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(248,)g(295b,)h(333b,)f(345a,)g(and)
g(356c.)145 2279 y(Uses)i Fl(namearray)d Fp(291a.)830
2604 y Fv(293)p eop
%%Page: 294 294
294 293 bop 129 141 a Fv(294)83 b Fr(gencode.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(294a)88
b Fo(h)p Fn(*)16 b Fp(293a)p Fo(i)n Fv(+)q Fo(\021)1013
b Fm(/)5 b Fp(293b)23 b(294d)t Fm(.)171 307 y Fr(record)e(Gcase\(x,)f
(arms\))238 b(#)22 b(CASE)f(x)g(OF)h(arms)f(END;)171
357 y(record)g(Gcasearm\(tags,)d(x\))174 b(#)22 b(tags)f(is)g(sorted)g
(list)g(of)g(lo,)g(hi)h(s.t.)f(lo)g(<=)g(x)h(<)g(hi)171
457 y(record)f(Ginrange\(lo,)e(x,)i(hi\))130 b(#)22 b(predicate)e(lo)h
(<=)h(x)f(<)h(hi)171 507 y(record)f(Gsetname\(lhs,)e(name\))129
b(#)22 b(lhs)f(:=)g(name)g(\(where)g(name)g(is)g(string)g(or)g
(namearray\))171 606 y(record)g(Gnomatch\(\))324 b(#)22
b(what)f(happens)f(when)h(there's)g(no)g(match)171 706
y(record)g(Tunsigned\(width)o(\))193 b(#)22 b(unsigned)e(value)h(of)g
(width)g(bits)g(\(word)g(size)g(if)g(/width\))171 756
y(record)g(Tsigned\(width\))236 b(#)22 b(signed)e(value)h(of)h(width)e
(bits)h(\(word)g(size)g(if)g(/width\))171 806 y(record)g(Gasgn\(lhs,)e
(x\))261 b(#)22 b(set)f(lhs)g(:=)h(x)129 857 y Fp(De\014nes:)171
897 y Fl(Gasgn)p Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(86c,)h(110b,)f
(119a,)g(125b,)g(133c,)g(216,)h(301a,)f(334b,)g(and)h(346a.)171
936 y Fl(Gcase)p Fp(,)f(used)g(in)h(c)o(h)o(unks)f(86c,)h(110a,)f
(119a,)g(125b,)g(133b,)g(296b,)g(334a,)h(and)f(345c.)171
976 y Fl(Gcasearm)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f(86c,)h(110a,)f
(119a,)g(125b,)g(133b,)g(299b,)g(334a,)g(and)h(345c.)171
1015 y Fl(Ginrange)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f(86c,)h(110a,)f
(119a,)g(125b,)g(133b,)g(294c,)g(297a,)h(299c,)f(334b,)g(and)g(346a.)
171 1055 y Fl(Gnomatch)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f(86c,)h
(110b,)f(119a,)g(125b,)g(133c,)g(300,)h(334c,)f(and)h(346b.)171
1094 y Fl(Gsetname)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f(86c,)h(110b,)f
(119a,)g(125b,)g(133c,)g(301a,)g(333d,)g(334b,)h(and)f(346a.)171
1134 y Fl(Tsigned)p Fp(,)f(used)i(in)g(c)o(h)o(unks)f(333a)g(and)h
(334c.)171 1173 y Fl(Tunsigned)p Fp(,)d(used)j(in)g(c)o(h)o(unks)f
(86c,)g(110b,)g(119a,)h(125b,)f(133c,)g(297c,)g(333a,)g(334c,)g(and)h
(346b.)129 1212 y(Uses)h Fl(namearray)d Fp(291a)h(and)h
Fl(value)f Fp(136a.)-33 1304 y(294b)88 b Fo(h)p Fn(ar)n(gument)16
b(descriptions)e Fp(294b)p Fo(i)o(\021)171 1354 y Fr(expargs)20
b(decls)h(stmts)g(init.)-29 1445 y Fp(294c)88 b Fo(h)p
Fn(r)n(ewrite)14 b(rules)g Fp(294c)p Fo(i)o(\021)171
1495 y Fr(Ginrange\(lo,)19 b(N,)j(hi\))f(->)g(if)h(lo)f(<=)g(N)h(<)g
(hi)f(then)g(1)g(else)g(0)129 1547 y Fp(Uses)12 b Fl(Ginrange)d
Fp(294a.)-33 1638 y(294d)88 b Fo(h)p Fn(*)16 b Fp(293a)p
Fo(i)n Fv(+)q Fo(\021)1017 b Fm(/)5 b Fp(294a)22 b(295a)5
b Fm(.)171 1688 y Fr(global)21 b(gen_file_header)o(,)e(gen_outer_decls)
171 1738 y(procedure)h(genheader\(header\))215 1787 y(return)g
(Glines\([)432 1837 y(Gresynch\(codeline)f(:=)i(1\),)432
1887 y(literal\(gen_file_hea)o(der\),)432 1937 y(Gresynch\(header.line)
o(,)e(header.file\),)432 1987 y(Glines\(header.code\),)432
2036 y(Gresynch\(codeline)g(+:=)i(100\)]\))171 2086 y(end)129
2138 y Fp(De\014nes:)171 2178 y Fl(gen_file_h)o(ead)o(er)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(338a)g(and)h(348.)171
2217 y Fl(genheader)p Fp(,)d(used)j(in)g(c)o(h)o(unk)f(21a.)171
2256 y Fl(gen_outer_)o(dec)o(ls)p Fp(,)e(used)j(in)g(c)o(h)o(unks)f
(295b,)g(338a,)g(and)h(348.)129 2296 y(Uses)h Fl(codeline)d
Fp(295a,)h Fl(file)h Fp(359a,)f Fl(Glines)f Fp(293a,)h
Fl(Gresynch)f Fp(293a,)h Fl(line)h Fp(359a,)f(and)h Fl(literal)e
Fp(45e.)p eop
%%Page: 295 295
295 294 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(gencode.nw)81 b Fv(295)-15 258 y Fp(295a)88 b Fo(h)p
Fn(*)15 b Fp(293a)p Fo(i)o Fv(+)p Fo(\021)1014 b Fm(/)5
b Fp(294d)22 b(295b)5 b Fm(.)187 307 y Fr(global)20 b(fetchtab)369
b(#)22 b(code)f(to)g(use)g(to)h(fetch)e(words:)h(size)g(->)g(fetch)g
(string)187 357 y(global)f(codeline)145 409 y Fp(De\014nes:)187
449 y Fl(codeline)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(294d,)g(295b,)g
(and)h(302a.)187 488 y Fl(fetchtab)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f
(19a,)h(52a,)f(295b,)g(302,)h(303a,)f(338a,)g(and)h(348.)-17
579 y(295b)88 b Fo(h)p Fn(*)15 b Fp(293a)p Fo(i)o Fv(+)p
Fo(\021)1018 b Fm(/)5 b Fp(295a)22 b(296a)5 b Fm(.)187
629 y Fr(procedure)20 b(gencase\(cs,)f(root\))230 679
y(static)i(label)230 729 y(local)g(decls)230 779 y(initial)g(label)f
(:=)i(0)230 828 y(/root)f(:=)h(tree\(cs\))230 878 y
(outtree\(\\ascii_tree)o(,)d(root\))230 928 y(decls)i(:=)h
([Gdecl\("MATCH_p)o(",)d(fetchtab["type"])o(,)g(cs.valcode\)])230
978 y(every)i(put\(decls,)f(!gen_outer_decls)e(|)k(Gdeclnamearray\(!n)o
(amesu)o(sed\(r)o(oot\)\))o(\))230 1028 y(return)f(Glines\([Gblock\(de)
o(cls,)d([Gresynch\(codeline)g(+:=)k(100\),)e(gennode\(root,)f
(set\(\)\)]\)])h(|||)535 1077 y(armscode\(cs.trailer\))o(\))187
1127 y(end)145 1179 y Fp(De\014nes:)187 1219 y Fl(gencase)p
Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(22b.)145 1258 y(Uses)16
b Fl(armscode)c Fp(302a,)i Fl(codeline)f Fp(295a,)h Fl(fetchtab)e
Fp(295a,)i Fl(Gblock)f Fp(293a,)h Fl(Gdecl)g Fp(293a,)187
1297 y Fl(Gdeclnamea)o(rra)o(y)8 b Fp(293b,)i Fl(gennode)f
Fp(296a,)h Fl(gen_outer)o(_de)o(cls)e Fp(294d,)h Fl(Glines)h
Fp(293a,)f Fl(Gresynch)g Fp(293a,)187 1337 y Fl(label)h
Fp(383a,)g Fl(namesused)e Fp(292b,)j Fl(outtree)e Fp(373b,)h(and)h
Fl(tree)f Fp(274.)p eop
%%Page: 296 296
296 295 bop 129 141 a Fv(296)83 b Fr(gencode.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(I)19
b(sp)q(ecial-case)h(the)g(case)g(of)f(t)o(w)o(o)g(c)o(hildren)g(where)i
(one)e(has)g(a)g(single)g(range;)j(the)129 307 y(generated)c(co)q(de)g
(is)e(cleaner)h(if)f(I)g(just)h(use)g(one)g Fr(if)f Fv(statemen)o(t.)25
b(Actually)m(,)16 b(I)g(could)h(do)129 357 y(this)d(an)o(y)g(time)e(I)i
(ha)o(v)o(e)g(only)f(t)o(w)o(o)g(c)o(hildren.)7 b(.)g(.)720
b Fk(\031Change)14 b(#28)-31 420 y Fp(296a)88 b Fo(h)p
Fn(*)16 b Fp(293a)p Fo(i)n Fv(+)q Fo(\021)1017 b Fm(/)5
b Fp(295b)22 b(297c)5 b Fm(.)171 469 y Fr(procedure)20
b(gennode\(n,)g(wordsmatched\))258 519 y(local)h(firstif,)f(decls,)h
(added,)f(single_range,)f(other_child,)h(answer)258 569
y(while)h(*n.children)e(=)j(1)g(do)345 619 y(n)g(:=)f
(n.children[1].node)258 669 y(if)h(*n.children)d(>)j(0)f(then)g({)345
718 y(decls)g(:=)g([])171 768 y(pushtrace\("DECLS")o(\))345
818 y(added)g(:=)g(add_decls\(decls,)e(wordsmatched,)g
(node_fields\(n.fiel)o(d\)\))171 868 y(poptrace\(\))345
918 y(if)j(*n.children)d(=)j(2)f(&)h(single_range)d(:=)j(!n.children)d
(&)j(*single_range.lo)c(=)k(1)f(then)g({)389 967 y Fo(h)p
Fn(set)15 b Fr(answer)e Fn(to)i(single)g Fr(if)f Fn(statement)h
Fp(297a)p Fo(i)345 1017 y Fr(})22 b(else)f({)389 1067
y Fo(h)p Fn(split)14 b(childr)n(en)h(into)g Fr(if)f Fn(and)i(c)n(ase)f
(tests,)f(and)i(make)f(c)n(ombination)g Fr(answer)f Fp(296b)p
Fo(i)345 1117 y Fr(})345 1167 y(every)21 b(delete\(wordsmatche)o(d,)e
(!added\))345 1217 y(return)i(answer)258 1266 y(})h(else)f({)345
1316 y(decls)g(:=)g([])345 1366 y(added)g(:=)g(add_decls\(decls,)e
(wordsmatched,)g(constraint_fields\()o(n.cs)o(.arms)o(\)\))345
1416 y(s)j(:=)f(genarms\(n.cs.arms,)d(n,)k(wordsmatched\))345
1466 y(answer)f(:=)g(subst_for_pc\(Gblock)o(\(dec)o(ls,)e([s]\),)h
(address_to_integer\()o("MATC)o(H_p"\))o(\))345 1515
y(every)h(delete\(wordsmatche)o(d,)e(!added\))345 1565
y(return)i(answer)258 1615 y(})171 1665 y(end)129 1717
y Fp(De\014nes:)171 1756 y Fl(gennode)p Fp(,)9 b(used)i(in)g(c)o(h)o
(unks)f(295b,)g(297a,)g(and)g(299.)129 1796 y(Uses)k
Fl(add_decls)d Fp(297c,)h Fl(address_to)o(_in)o(te)o(ger)e
Fp(303a,)i Fl(constraint_)o(fie)o(lds)e Fp(298b,)i Fl(field)g
Fp(55,)171 1835 y Fl(Gblock)e Fp(293a,)g Fl(genarms)f
Fp(300,)h Fl(node)h Fp(272,)f Fl(node_fields)e Fp(298a,)i(and)h
Fl(subst_for_)o(pc)d Fp(89c.)-33 1918 y(296b)88 b Fo(h)p
Fn(split)15 b(childr)n(en)f(into)h Fr(if)g Fn(and)g(c)n(ase)g(tests,)g
(and)g(make)g(c)n(ombination)h Fr(answer)d Fp(296b)p
Fo(i)o(\021)88 b Fp(\(296a\))171 1968 y Fr(edges)21 b(:=)g(table\(\))
171 2018 y(every)g(e)g(:=)h(!n.children)d(do)j(edges[sort\(e.lo)o
(\)[1]])c(:=)k(e)171 2068 y(edges)f(:=)g(sort\(edges\))171
2117 y(ifarms)g(:=)g([])171 2167 y(every)g(addarms\(ifarms,)d(n.field,)
j(\(!edges\)[2],)e(wordsmatched\))171 2217 y(casearms)h(:=)h([])171
2267 y(every)g(genedge\(casearms)o(,)e(n.field,)h(\(!edges\)[2],)f
(wordsmatched\))171 2317 y(put\(ifarms,)g(Sguarded\(1,)h
(Gcase\(afieldexp\(n)o(.fiel)o(d\),)f(casearms\)\)\))171
2366 y(answer)i(:=)g(subst_for_pc\(Gblo)o(ck\(de)o(cls,)d
([Sif\(ifarms\)]\),)h(address_to_intege)o(r\("MA)o(TCH_p)o("\)\))129
2418 y Fp(Uses)14 b Fl(addarms)c Fp(299c,)i Fl(address_to)o(_in)o(te)o
(ger)e Fp(303a,)h Fl(afieldexp)f Fp(299a,)i Fl(field)f
Fp(55,)h Fl(Gblock)f Fp(293a,)171 2458 y Fl(Gcase)f Fp(294a,)g
Fl(genedge)f Fp(299b,)h Fl(Sguarded)f Fp(81,)i Fl(Sif)g
Fp(81,)g(and)f Fl(subst_for_p)o(c)f Fp(89c.)p eop
%%Page: 297 297
297 296 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(gencode.nw)81 b Fv(297)-15 258 y Fp(297a)88 b Fo(h)p
Fn(set)15 b Fr(answer)f Fn(to)h(single)f Fr(if)h Fn(statement)g
Fp(297a)p Fo(i)n(\021)574 b Fp(\(296a\))187 307 y Fr(other_child)19
b(:=)j(single_range)d(~===)i(!n.children)187 357 y Fo(h)p
Fn(if)14 b Fr(other_child)p Fn('s)f(r)n(ange)i(has)g(one)g(element,)g
(exchange)h(it)e(with)h Fr(single_range)d Fp(297b)p Fo(i)187
407 y Fr(f)21 b(:=)h(afieldexp\(n.fiel)o(d\))187 457
y(s)f(:=)h(Sif\([Sguarded\(Gi)o(nrang)o(e\(!si)o(ngle_)o(range)o(.lo,)c
(f,)k(!single_range.hi)o(\),)601 507 y(gennode\(single_ra)o(nge.n)o
(ode,)c(wordsmatched\)\),)405 557 y(Sguarded\(1,)h
(gennode\(other_child)o(.nod)o(e,)g(wordsmatched\)\)]\))187
606 y(answer)h(:=)i(subst_for_pc\(Gbl)o(ock\(d)o(ecls,)c([s]\),)j
(address_to_intege)o(r\("MA)o(TCH_p)o("\)\))145 658 y
Fp(Uses)13 b Fl(address_to_)o(int)o(ege)o(r)d Fp(303a,)i
Fl(afieldexp)e Fp(299a,)h Fl(field)g Fp(55,)i Fl(Gblock)e
Fp(293a,)g Fl(gennode)g Fp(296a,)187 698 y Fl(Ginrange)e
Fp(294a,)h Fl(node)g Fp(272,)h Fl(Sguarded)e Fp(81,)h
Fl(Sif)h Fp(81,)g(and)g Fl(subst_for)o(_pc)d Fp(89c.)208
768 y Fv(This)j(little)g(go)q(o)q(die)h(mak)o(es)f(it)g(a)h(bit)f(more)
g(lik)o(ely)g(to)g(use)i(just)f(one)g(equalit)o(y)f(test.)18
b(It's)145 818 y(not)e(clear)g(whether)h(it's)e(the)h(righ)o(t)f
(heuristic)i(when)f(b)q(oth)f(ranges)i(con)o(tain)e(more)f(than)145
868 y(one)g(elemen)o(t.)-17 930 y Fp(297b)88 b Fo(h)p
Fn(if)15 b Fr(other_child)p Fn('s)d(r)n(ange)j(has)g(one)h(element,)e
(exchange)j(it)d(with)g Fr(single_range)e Fp(297b)p Fo(i)o(\021)86
b Fp(\(297a\))187 980 y Fr(if)21 b(*other_child.lo)e(=)i(1)h(&)g
(\(!other_child.lo)c(+)k(1)f(=)h(!other_child.hi\))c(then)j({)230
1030 y(*other_child.hi)e(=)j(1)f(|)h(impossible\("range)o(s"\))230
1080 y(other_child)e(:=:)h(single_range)187 1129 y(})208
1192 y(wordsmatched)11 b Fv(is)j(sligh)o(tly)f(misnamed.)k(It)d(con)o
(tains)h(the)g Fn(names)f Fv(of)g(all)f(the)i(w)o(ords)145
1241 y(that)g(ha)o(v)o(e)g(b)q(een)h(fetc)o(hed,)g(and)f(it)f(also)h
(con)o(tains)g(the)g(absolute)g(\014elds)g(that)g(ha)o(v)o(e)g(b)q(een)
145 1291 y(fetc)o(hed.)-13 1354 y Fp(297c)88 b Fo(h)p
Fn(*)15 b Fp(293a)p Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5
b Fp(296a)22 b(298a)5 b Fm(.)187 1403 y Fr(procedure)20
b(add_decls\(decls,)e(wordsmatched,)h(fields\))230 1453
y(local)i(added)230 1503 y(added)g(:=)h(set\(\))230 1553
y(every)f(w)h(:=)f(wordname\(f)f(:=)h(!fields\))f(&)i(not)f
(member\(wordsmatche)o(d,)e(w\))i(do)h({)274 1603 y(put\(decls,)e
(Gdecl\(wordname\(f)o(\),)f(Tunsigned\(f.fiel)o(d.cla)o(ss.si)o(ze\),)
644 1652 y(fetchcode\(address_ad)o(d\("M)o(ATCH_)o(p",)g(f.offset\),)g
(f.field.class.size\))o(\)\))274 1702 y(every)i(insert\(wordsmatc)o
(hed)e(|)i(added,)g(w\))230 1752 y(})230 1802 y(#)h(with)f
([[afieldexp]],)e(these)i(are)g(no)g(longer)g(needed)230
1852 y(##)44 b(every)20 b(f)i(:=)f(!fields)g(&)g(not)g
(member\(wordsmatched)o(,)e(f\))i(do)h({)230 1901 y(##)87
b(put\(decls,)20 b(Gdecl\(afieldname\()o(f\),)f(Tunsigned\(fwidt)o
(h\(f.f)o(ield\))o(\),)230 1951 y(##)501 b(Eslice\(literal\(wor)o
(dname)o(\(f\)\),)18 b(f.field.lo,)i(fwidth\(f.field\)\))o(\)\))230
2001 y(##)87 b(every)21 b(insert\(wordsmatch)o(ed)e(|)i(added,)g(f\))
230 2051 y(##)44 b(})230 2101 y(return)21 b(added)187
2151 y(end)145 2202 y Fp(De\014nes:)187 2242 y Fl(add_decls)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(296a)g(and)h(301a.)145
2281 y(Uses)h Fl(address_a)o(dd)c Fp(302c,)i Fl(afieldexp)e
Fp(299a,)i Fl(Eslice)f Fp(81,)i Fl(fetchcode)d Fp(302d,)i
Fl(field)f Fp(55,)i Fl(fwidth)e Fp(115d,)187 2321 y Fl(Gdecl)h
Fp(293a,)g Fl(literal)f Fp(45e,)i Fl(Tunsigned)d Fp(294a,)i(and)h
Fl(wordname)e Fp(298c.)p eop
%%Page: 298 298
298 297 bop 129 141 a Fv(298)83 b Fr(gencode.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(298a)88
b Fo(h)p Fn(*)16 b Fp(293a)p Fo(i)n Fv(+)q Fo(\021)1017
b Fm(/)5 b Fp(297c)23 b(298b)t Fm(.)171 307 y Fr(procedure)d
(node_fields\(f\))215 357 y(return)g(case)h(type\(f\))f(of)i({)258
407 y("set")64 b(:)22 b(f)258 457 y("list")42 b(:)22
b(set\(f\))258 507 y(default)e(:)i(set\([f]\))215 557
y(})171 606 y(end)129 658 y Fp(De\014nes:)171 698 y Fl(node_field)o(s)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(296a.)192 768 y Fv(Mak)o(e)k(sure)h
(to)e(declare)i(these)g(\014elds)g(b)q(efore)f(use.)-1407
b Fk(\031Change)13 b(#43)-418 822 y(\031Fixes)h(bug)f(#18)-33
831 y Fp(298b)88 b Fo(h)p Fn(*)16 b Fp(293a)p Fo(i)n
Fv(+)q Fo(\021)1019 b Fm(/)5 b Fp(298a)22 b(298c)5 b
Fm(.)171 880 y Fr(procedure)20 b(constraint_fields)o(\(arms)o(\))215
930 y(local)g(fields)215 980 y(fields)g(:=)h(set\(\))215
1030 y(every)f(a)i(:=)f(!arms)g(do)258 1080 y(every)g(insert\(fields,)
541 1129 y(absolute_fields\(\(\\a.)o(imp_)o(soln\))o(.cons)o(train)o
(ts)e(|)890 1179 y(subst_tab\(!\(\\a.sol)o(n\).co)o(nstra)o(ints,)1108
1229 y(\(\\a.imp_soln\).answ)o(ers,)f(1\)\)\))215 1279
y(return)i(fields)171 1329 y(end)171 1428 y(procedure)g
(absolute_fields\(e)o(\))215 1478 y(suspend)g(subterms_matching)o(\(e,)
f("absolute_field)o("\))171 1528 y(end)129 1580 y Fp(De\014nes:)171
1619 y Fl(constraint)o(_fi)o(eld)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(296a.)129 1659 y(Uses)i Fl(absolute_fi)o(eld)c
Fp(268,)i Fl(constraints)e Fp(136a,)i Fl(subst_tab)f
Fp(89a,)h(and)h Fl(subterms_m)o(atc)o(hin)o(g)e Fp(84a.)192
1721 y Fv(W)m(e)i(use)h(a)f(st)o(ylized)g Fr(wordname)f
Fv(to)h(refer)h(to)g(the)g(w)o(ord)f(con)o(taining)f(a)h(particular)g
(\014eld.)129 1771 y(It's)j(uniquely)g(determined)g(b)o(y)f(its)h(size)
h(and)e(o\013set.)-29 1833 y Fp(298c)88 b Fo(h)p Fn(*)16
b Fp(293a)p Fo(i)n Fv(+)q Fo(\021)1013 b Fm(/)5 b Fp(298b)23
b(298d)t Fm(.)171 1883 y Fr(procedure)d(wordname\(f\))215
1933 y(return)g("MATCH_w_")g(||)h(f.field.class.size)d(||)k("_")f(||)g
(f.offset;)171 1982 y(end)129 2034 y Fp(De\014nes:)171
2074 y Fl(wordname)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(297c)h(and)f
(299a.)129 2113 y(Uses)i Fl(field)e Fp(55.)129 2175 y
Fv(A)k(similar)e(tric)o(k)i(giv)o(es)g(us)g(a)f(unique)h(name)f(for)h
(eac)o(h)g(absolute)g(\014eld.)-33 2238 y Fp(298d)88
b Fo(h)p Fn(*)16 b Fp(293a)p Fo(i)n Fv(+)q Fo(\021)1019
b Fm(/)5 b Fp(298c)22 b(299a)5 b Fm(.)171 2288 y Fr(##)43
b(procedure)20 b(afieldname\(f\))171 2337 y(##)87 b(return)20
b("MATCH_f_")g(||)h(f.field.name)f(||)h("_")g(||)h(f.offset)171
2387 y(##)43 b(end)129 2439 y Fp(Uses)12 b Fl(field)e
Fp(55.)p eop
%%Page: 299 299
299 298 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(gencode.nw)81 b Fv(299)145 258 y(BUT)13 b(w)o(e're)f(no)f(longer)h
(using)g(that)f(tric)o(k;)i(instead,)f(w)o(e're)g(grabbing)f(the)h(w)o
(ord)g(directly)m(.)-15 320 y Fp(299a)88 b Fo(h)p Fn(*)15
b Fp(293a)p Fo(i)o Fv(+)p Fo(\021)1014 b Fm(/)5 b Fp(298d)22
b(299b)5 b Fm(.)187 370 y Fr(record)20 b(Gcommented\(e,)f(comment\))187
420 y(procedure)h(afieldexp\(f\))230 469 y(return)h(Gcommented\(Eslice)
o(\(lite)o(ral\(w)o(ordna)o(me\(f)o(\)\),)e(f.field.lo,)g
(fwidth\(f.field\)\),)623 519 y(f.field.name)g(||)i(")h(at)f(")h(||)f
(f.offset\))187 569 y(end)145 621 y Fp(De\014nes:)187
660 y Fl(afieldexp)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(93a,)g(296,)h
(297,)f(299c,)g(335b,)g(and)h(346c.)187 700 y Fl(Gcommented)o
Fp(,)e(used)h(in)i(c)o(h)o(unks)d(86c,)i(93a,)f(110a,)h(119a,)f(125b,)g
(334c,)g(and)h(346a.)145 739 y(Uses)h Fl(Eslice)e Fp(81,)g
Fl(field)g Fp(55,)h Fl(fwidth)f Fp(115d,)g Fl(literal)f
Fp(45e,)i(and)f Fl(wordname)f Fp(298c.)-17 822 y(299b)88
b Fo(h)p Fn(*)15 b Fp(293a)p Fo(i)o Fv(+)p Fo(\021)1020
b Fm(/)5 b Fp(299a)22 b(299c)5 b Fm(.)187 872 y Fr(global)20
b(MAXRANGE)187 972 y(procedure)g(genedge\(casearms)o(,)f(f,)i(e,)h
(wordsmatched\))274 1021 y(local)f(tags)274 1071 y(tags)g(:=)g([])274
1121 y(r)h(:=)f(sort\(e.lo)f(++)h(e.hi\))274 1171 y(while)g(lo)g(:=)g
(get\(r\))g(&)h(hi)f(:=)g(get\(r\))g(do)361 1221 y(if)h(hi)f(-)g(lo)h
(<=)f(MAXRANGE)f(then)448 1271 y(every)h(put\(tags,)f(lo)h(|)h(hi\))274
1320 y(if)f(*tags)g(>)h(0)f(then)361 1370 y(put\(casearms,)e
(Gcasearm\(tags,)g(gennode\(e.node,)g(wordsmatched\)\)\))274
1420 y(return)187 1470 y(end)145 1522 y Fp(De\014nes:)187
1561 y Fl(genedge)p Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(296b.)187
1601 y Fl(MAXRANGE)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f(291b,)g(292a,)g
(and)h(299c.)145 1640 y(Uses)h Fl(Gcasearm)d Fp(294a,)h
Fl(gennode)f Fp(296a,)h(and)h Fl(node)f Fp(272.)-13 1731
y(299c)88 b Fo(h)p Fn(*)15 b Fp(293a)p Fo(i)o Fv(+)p
Fo(\021)1033 b Fm(/)6 b Fp(299b)22 b(300)5 b Fm(.)187
1781 y Fr(procedure)20 b(addarms\(ifarms,)e(f,)k(e,)f(wordsmatched\))
274 1831 y(r)h(:=)f(sort\(e.lo)f(++)h(e.hi\))274 1881
y(while)g(lo)g(:=)g(get\(r\))g(&)h(hi)f(:=)g(get\(r\))g(do)361
1931 y(if)h(hi)f(-)g(lo)h(>)f(MAXRANGE)g(then)448 1980
y(put\(ifarms,)f(Sguarded\(Ginrange)o(\(lo,)e(afieldexp\(f\),)h(hi\),)
906 2030 y(gennode\(e.node,)g(wordsmatched\)\)\))274
2080 y(return)187 2130 y(end)145 2182 y Fp(De\014nes:)187
2221 y Fl(addarms)p Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(296b.)145
2261 y(Uses)16 b Fl(afieldexp)c Fp(299a,)i Fl(gennode)f
Fp(296a,)g Fl(Ginrange)g Fp(294a,)h Fl(MAXRANGE)e Fp(299b,)i
Fl(node)g Fp(272,)187 2300 y(and)c Fl(Sguarded)f Fp(81.)p
eop
%%Page: 300 300
300 299 bop 129 141 a Fv(300)83 b Fr(gencode.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-13 258 y Fp(300)88
b Fo(h)p Fn(*)16 b Fp(293a)p Fo(i)n Fv(+)q Fo(\021)1019
b Fm(/)5 b Fp(299c)22 b(301a)5 b Fm(.)171 307 y Fr(procedure)20
b(genarms\(arms,)f(thenode,)h(wordsmatched\))258 357
y(local)h(ifarms)258 407 y(ifarms)g(:=)g([])258 457 y(every)g(a)g(:=)h
(!arms)f(do)g({)302 507 y(c)g(:=)h(copy\(\(\\a.imp_sol)o(n\).co)o
(nstra)o(ints)o(\))d(|)j(set\(\))302 557 y(every)e
(insert_condition\(c,)520 606 y(subst_tab\(!\(\\a.s)o(oln\).)o(cons)o
(train)o(ts,)f(\(\\a.imp_soln\).an)o(swer)o(s,)g(1\)\))302
656 y(put\(ifarms,)g(Sguarded\(c,)h(genarm\(a,)g(thenode,)g
(wordsmatched\)\)\))258 706 y(})258 756 y(put\(ifarms,)g(Sguarded\(1,)f
(Gnomatch\(\)\)\))258 806 y(return)i(Sif\(ifarms\))171
855 y(end)129 907 y Fp(De\014nes:)171 947 y Fl(genarms)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(296a.)129 986 y(Uses)i
Fl(constraints)c Fp(136a,)j Fl(genarm)f Fp(301a,)g Fl(Gnomatch)f
Fp(294a,)i Fl(insert_co)o(ndi)o(tio)o(n)e Fp(126c,)h
Fl(Sguarded)g Fp(81,)171 1026 y Fl(Sif)h Fp(81,)f(and)h
Fl(subst_tab)e Fp(89a.)p eop
%%Page: 301 301
301 300 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(gencode.nw)81 b Fv(301)208 258 y(It)14 b(migh)o(t)e(b)q(e)j
(surprising)g(to)f(see)i(us)f(declaring)f(iden)o(ti\014ers)h(with)g
(the)g(n)o(ull)e(t)o(yp)q(e)i(\(us-)145 307 y(ing)g Fr(Gdecl)g
Fv(b)q(elo)o(w\),)g(but)h(that's)g(what)f(w)o(e)h(use)h(when)f(the)g
(exact)g(t)o(yp)q(e)h(is)e(unkno)o(wn)g(or)145 357 y(unimp)q(ortan)o
(t.)30 b(Emitters)18 b(for)g(languages)g(lik)o(e)f(SML)i(or)f(Mo)q
(dula-3)f(can)i(then)g(ignore)145 407 y(t)o(yp)q(e)c(en)o(tirely)m(.)
208 457 y(Something)g(is)h(going)g(a)o(wry)g(in)g(the)h(equation)g
(solv)o(er.)26 b(P)o(attern)18 b(lab)q(els)e(are)h(inputs)145
507 y(to)h(the)g(solv)o(er,)g(and)f(therefore)j(should)d(not)g(app)q
(ear)h(in)g Fr(answers)p Fv(;)f(ho)o(w)o(ev)o(er,)h(they)h(do)145
557 y(app)q(ear)d(in)e Fr(answers)p Fv(,)f(whic)o(h)i(means)f(they)h(w)
o(ere)h(declared)g(t)o(wice.)21 b(Omitting)13 b(the)j(co)q(de)145
606 y(to)d(declare)g(pattern)g(lab)q(els)g(seems)f(to)h(solv)o(e)f(the)
h(problem,)e(but)i(wh)o(y?)k(Notice)c(also)f(that)145
656 y(the)j(omitted)d(co)q(de)i(could)g(nev)o(er)h(ha)o(v)o(e)e(b)q
(een)i(righ)o(t)e(to)h(b)q(egin)f(with,)g(since)i(it)e(b)q(ound)h(the)
145 706 y(lab)q(el)g(to)f(an)h Fn(o\013set)p Fv(,)g(not)g(to)f(its)h
(true)h(v)n(alue.)-15 768 y Fp(301a)88 b Fo(h)p Fn(*)15
b Fp(293a)p Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)6 b Fp(300)22
b(302a)5 b Fm(.)187 818 y Fr(procedure)20 b(genarm\(a,)g(thenode,)g
(wordsmatched\))274 868 y(local)h(bindings,)f(fused,)g(block,)h(decls,)
f(stmts,)h(patlabels)274 918 y(/continue)f(:=)h(0)274
967 y Fo(h)p Fn(insist)15 b(ther)n(e)f(ar)n(e)g(no)i(\014eld)f
(bindings)g(in)g(arm)g Fr(a)f Fp(301b)p Fo(i)274 1017
y Fr(fused)21 b(:=)g(set\(\);)274 1067 y(every)g(insert\(fused,)e
(subterms_matching)o(\(!\(\\)o(a.imp)o(_soln)o(\).ans)o(wers,)f
("absolute_field"\)\))274 1117 y(decls)j(:=)g([])274
1167 y(added)g(:=)g(add_decls\(decls,)e(wordsmatched,)g(fused\))187
1217 y(#)87 b(patlabels)20 b(:=)h(a.pattern.disjunct)o(s[1].)o(patl)o
(abelb)o(indin)o(gs)187 1266 y(#)87 b(every)21 b(id)g(:=)g
(key\(\\patlabels\))e(do)187 1316 y(#)130 b(put\(decls,)20
b(Gdecl\(id,)g(unsigned_type\(\),)e(patlabels[id]\)\))274
1366 y(every)j(id)g(:=)g(key\(\(\\a.imp_soln\).an)o(swers)o(\))e(&)i
(not)h(is_wildcard\(id\))c(do)318 1416 y(put\(decls,)h(Gdecl\(id,)h
(&null,)h(a.imp_soln.answe)o(rs[id)o(]\)\))274 1466 y(every)g(id)g(:=)g
(key\(\(\\a.soln\).answer)o(s\))e(&)i(not)g(is_wildcard\(id\))41
b(do)318 1515 y(put\(decls,)19 b(Gdecl\(id,)h(&null,)h
(a.soln.answers[i)o(d]\)\))274 1565 y(if)g(\(\\a.name)f(&)i
(/thenode.name\))d(then)318 1615 y(warning\("Name)g(`")i(||)g(a.name)g
(||)g("')h(in)f(pattern)f(arm)i(is)f(unbound.\\n"\))274
1665 y(put\(decls,)f(Gsetname\(\\a.name)o(,)f(\\thenode.name\)\))274
1715 y(every)i(delete\(wordsmatc)o(hed,)d(!added\))274
1764 y(stmts)j(:=)g(armscode\(a\))274 1814 y(push\(stmts,)e
(Gasgn\(\\thenode.cs.su)o(ccptr)o(,)g(address_add\("MATC)o(H_p",)f
(\\a.patlen\)\)\))274 1864 y(write\(\\mdebug,)h("successor)h(for)h(",)g
(image\(a\),)f(")i(at)f(",)g(\\a.patlen\))274 1914 y(return)g
(subst_for_pc\(Gb)o(lock\()o(decls)o(,)e(stmts\),)h
(address_to_integer\()o("MATC)o(H_p")o(\)\))187 1964
y(end)145 2016 y Fp(De\014nes:)187 2055 y Fl(genarm)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(300.)145 2095 y(Uses)j
Fl(absolute_f)o(iel)o(d)c Fp(268,)j Fl(add_decls)d Fp(297c,)i
Fl(address_add)e Fp(302c,)i Fl(address_to)o(_in)o(teg)o(er)e
Fp(303a,)187 2134 y Fl(arm)k Fp(271b,)g Fl(armscode)e
Fp(302a,)i Fl(Gasgn)f Fp(294a,)h Fl(Gblock)f Fp(293a,)h
Fl(Gdecl)g Fp(293a,)f Fl(Gsetname)g Fp(294a,)187 2173
y Fl(is_wildcar)o(d)d Fp(302b,)i Fl(mdebug)f Fp(18a,)h
Fl(pattern)f Fp(55,)i Fl(subst_for)o(_pc)d Fp(89c,)i
Fl(subterms_m)o(at)o(chi)o(ng)e Fp(84a,)187 2213 y Fl(succptr)g
Fp(360b,)h(and)h Fl(unsigned_t)o(yp)o(e)e Fp(335a.)-17
2296 y(301b)88 b Fo(h)p Fn(insist)15 b(ther)n(e)f(ar)n(e)h(no)g
(\014eld)g(bindings)h(in)f(arm)f Fr(a)h Fp(301b)p Fo(i)n(\021)425
b Fp(\(301a\))187 2346 y Fr(if)21 b(type\(c)g(:=)g
(!\(!\(\\a.pattern\).di)o(sjunc)o(ts\).a)o(cons)o(train)o(ts\))e(==)i
("fieldbinding")230 2395 y(then)g(impossible\("field)e(binding)h(in)h
(arm:)g(",)h(expimage\(c\)\))145 2447 y Fp(Uses)12 b
Fl(arm)f Fp(271b,)f Fl(expimage)f Fp(101a,)h Fl(field)g
Fp(55,)h Fl(fieldbind)o(ing)d Fp(55,)j(and)g Fl(pattern)e
Fp(55.)p eop
%%Page: 302 302
302 301 bop 129 141 a Fv(302)83 b Fr(gencode.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(302a)88
b Fo(h)p Fn(*)16 b Fp(293a)p Fo(i)n Fv(+)q Fo(\021)1015
b Fm(/)5 b Fp(301a)23 b(302b)t Fm(.)171 307 y Fr(procedure)d
(armscode\(a\))215 357 y(return)g([Gresynch\(a.line,)e(a.file\),)j
(Glines\(a.code\),)d(Gresynch\(codeline)g(+:=)k(100\)])171
407 y(end)129 459 y Fp(De\014nes:)171 498 y Fl(armscode)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(295b)h(and)f(301a.)129
538 y(Uses)i Fl(codeline)d Fp(295a,)h Fl(file)h Fp(359a,)f
Fl(Glines)f Fp(293a,)h Fl(Gresynch)f Fp(293a,)h(and)h
Fl(line)f Fp(359a.)192 608 y Fv(W)m(e)k(don't)g(create)h(declarations)g
(for)f(the)h Fr(_)f Fv(wildcard.)19 b(A)o(t)c(the)g(momen)o(t,)c(its)k
(imple-)129 658 y(men)o(tation)e(is)i(as)f(a)h(fresh)g(v)n(ariable,)e
(and)h(since)i(fresh)f(v)n(ariables)f(should)g(not)h(otherwise)129
708 y(leak)f(out)g(\(aren't)g(v)n(alid)e(C)i(names)f(an)o(yw)o(a)o
(y\),)g(this)g(should)h(b)q(e)h(enough:)-1702 b Fk(\031Change)13
b(#30)-33 770 y Fp(302b)88 b Fo(h)p Fn(*)16 b Fp(293a)p
Fo(i)n Fv(+)q Fo(\021)1019 b Fm(/)5 b Fp(302a)22 b(302c)5
b Fm(.)171 820 y Fr(procedure)20 b(is_wildcard\(v\))215
870 y(return)g(member\(fresh_varia)o(bles,)e(v\))171
920 y(end)129 972 y Fp(De\014nes:)171 1011 y Fl(is_wildcar)o(d)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(301a.)129 1051 y(Uses)i
Fl(fresh_varia)o(ble)o(s)d Fp(155b.)129 1200 y Fj(15.1)66
b(Handling)24 b(fetc)n(h)e(and)h(address)f(templates)129
1291 y Fr(fetchcode)12 b Fv(do)q(es)j(the)g(expansion)e(of)h(the)g
(fetc)o(h)h(table.)-29 1353 y Fp(302c)88 b Fo(h)p Fn(*)16
b Fp(293a)p Fo(i)n Fv(+)q Fo(\021)1013 b Fm(/)5 b Fp(302b)23
b(302d)t Fm(.)171 1403 y Fr(procedure)d(address_add\(addre)o(ss,)f
(offset\))215 1453 y(if)i(offset)f(\045)i(pc_unit_bits)d(~=)j(0)f(then)
258 1503 y(error\("Tried)e(to)j(fetch)f(at)g(offset)g(",)g(offset,)f
(",)i(but)f(pc_unit_bits)e(=)j(",)389 1553 y(pc_unit_bits,)d(")j
(doesn't)e(divide)g(",)i(offset\))215 1602 y(offset)e(/:=)h
(pc_unit_bits;)215 1652 y(return)f(interpret_fetchtab)o(\(\\fet)o
(chtab)o(["ad)o(d"],)e(address,)j(offset,)f(&null,)g("address)h(add"\))
f(|)258 1702 y(error\("No)g(template)g(given)h(for)g('address)f
(add'"\))171 1752 y(end)129 1804 y Fp(De\014nes:)171
1843 y Fl(address_ad)o(d)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(297c)h
(and)f(301a.)129 1883 y(Uses)i Fl(address)d Fp(383a,)i
Fl(fetchtab)d Fp(295a,)j Fl(interpret)o(_fe)o(tch)o(tab)d
Fp(303b,)i(and)h Fl(pc_unit_b)o(its)d Fp(18a.)-33 1966
y(302d)88 b Fo(h)p Fn(*)16 b Fp(293a)p Fo(i)n Fv(+)q
Fo(\021)1019 b Fm(/)5 b Fp(302c)22 b(303a)5 b Fm(.)171
2016 y Fr(procedure)20 b(fetchcode\(address)o(,)f(width\))215
2065 y(return)h(interpret_fetchtab)o(\(\\fet)o(chtab)o([wid)o(th)f(|)i
("any"],)g(address,)f(&null,)g(width,)h("fetch"\))f(|)258
2115 y(error\("No)g(template)g(given)h(to)g(fetch)g(",)g(width,)g
("-bit)g(word"\))171 2165 y(end)129 2217 y Fp(De\014nes:)171
2256 y Fl(fetchcode)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(297c.)129
2296 y(Uses)i Fl(address)d Fp(383a,)i Fl(fetchtab)d Fp(295a,)j(and)f
Fl(interpret_f)o(etc)o(ht)o(ab)f Fp(303b.)p eop
%%Page: 303 303
303 302 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(gencode.nw)81 b Fv(303)-15 258 y Fp(303a)88 b Fo(h)p
Fn(*)15 b Fp(293a)p Fo(i)o Fv(+)p Fo(\021)1014 b Fm(/)5
b Fp(302d)22 b(303b)5 b Fm(.)187 307 y Fr(procedure)20
b(address_to_integ)o(er\(ad)o(dress)o(\))230 357 y(return)h
(interpret_fetchta)o(b\(\\fe)o(tchta)o(b["in)o(tege)o(r"],)d(address,)j
(&null,)f(&null,)797 407 y("address)g(to)i(integer"\))d(|)274
457 y(error\("No)h(template)g(given)h(for)g('address)f(to)h
(integer'"\))187 507 y(end)145 559 y Fp(De\014nes:)187
598 y Fl(address_to)o(_in)o(te)o(ger)o Fp(,)9 b(used)h(in)i(c)o(h)o
(unks)d(296,)i(297a,)f(and)h(301a.)145 637 y(Uses)h Fl(address)d
Fp(383a,)h Fl(fetchtab)f Fp(295a,)h(and)h Fl(interpret_)o(fet)o(cht)o
(ab)d Fp(303b.)-17 729 y(303b)88 b Fo(h)p Fn(*)15 b Fp(293a)p
Fo(i)o Fv(+)p Fo(\021)1135 b Fm(/)6 b Fp(303a)187 779
y Fr(procedure)20 b(interpret_fetcht)o(ab\(s,)e(address,)i(offset,)h
(width,)f(msg\))230 828 y(r)i(:=)f("\(")230 878 y(s)h(?)g({)274
928 y(while)f(r)g(||:=)g(tab\(upto\('\045'\)\))e(do)j({)318
978 y(="\045")318 1028 y(r)f(||:=)g(case)g(move\(1\))f(of)i({)514
1077 y("a")f(:)g(\\address)g(|)g(error\("\045a)f(illegal)g(in)i
(template)e(for)h(",)h(msg\))514 1127 y("o")f(:)g(\\offset)43
b(|)21 b(error\("\045o)f(illegal)g(in)i(template)e(for)h(",)h(msg\))514
1177 y("w")f(:)g(\\width)65 b(|)21 b(error\("\045w)f(illegal)g(in)i
(template)e(for)h(",)h(msg\))514 1227 y("\045")f(:)g("\045")514
1277 y(default)f(:)i(error\("Bad)d(escape)i(in)g(fetch)g(string)g(for)g
(",)862 1327 y(width,)g("-bit)g(word:)f(\045",)i(move\(-1\),)e(";)h
(try)g(\045a,)g(\045o,)g(or)h(\045w"\))470 1376 y(})274
1426 y(})274 1476 y(return)f(r)g(||)g(tab\(0\))g(||)g("\)")230
1526 y(})187 1576 y(end)145 1628 y Fp(De\014nes:)187
1667 y Fl(interpret_)o(fet)o(ch)o(tab)o Fp(,)9 b(used)h(in)i(c)o(h)o
(unks)d(302)i(and)g(303a.)145 1706 y(Uses)h Fl(address)d
Fp(383a.)p eop
%%Page: 304 304
304 303 bop 129 141 a Fv(304)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)p eop
%%Page: 305 305
305 304 bop 145 569 a Fq(Chapter)32 b(16)145 777 y Fu(Sp)s
(eci\014cation)38 b(Chec)m(k)m(er)145 992 y Fv(The)11
b(to)q(olkit)e(can)i(generate)g(a)f(program,)f(whic)o(h)h(with)g(some)g
(simple)e(shell)j(scripts,)g(can)g(b)q(e)145 1042 y(used)17
b(to)f(c)o(hec)o(k)h(the)g(consistency)h(of)d(an)h(arc)o(hitecture's)i
(to)q(olkit)d(sp)q(eci\014cation)i(against)145 1092 y(the)j(mac)o
(hine/assem)o(bly)c(language)i(recognized)i(b)o(y)f(existing)g(assem)o
(blers)g(and)f(disas-)145 1142 y(sem)o(blers)c(for)f(that)g(arc)o
(hitecture.)20 b(The)13 b Fr(-checker)p Fn(\014le)f Fv(option)h(writes)
h(the)g(C)f(source)i(for)145 1192 y(the)e(c)o(hec)o(k)o(er)h(program)c
(in)i Fn(\014le)p Fv(.)18 b(Debugging)11 b(information)e(is)j(written)h
(in)o(to)f Fn(\014le)g Fv(using)g(the)145 1241 y Fr(-debug-checker)p
Fn(\014le)c Fv(option.)17 b(See)12 b(the)g(reference)h(man)o(ual)c(for)
h(a)h(complete)g(description)145 1291 y(of)j(the)g(c)o(hec)o(k)o(er's)h
(functionalit)o(y)m(.)208 1341 y(The)e(to)q(olkit-generated)g(program)e
(\\c)o(hec)o(ks")j(a)f(sp)q(eci\014cation)h(b)o(y)e(applying)g(pairs)h
(of)145 1391 y(constructors)18 b(for)d(eac)o(h)g(instruction.)23
b(The)16 b(\014rst)g(constructor)h(emits)d(the)i(instruction's)145
1441 y(binary)j(co)q(de.)34 b(F)m(or)18 b(con)o(v)o(enience,)j(a)e
(constructor's)h(binary)f(represen)o(tation)h(is)f(emit-)145
1491 y(ted)g(using)e(assem)o(bly)f(directiv)o(es)j(\(e.g.,)f
Fr(.byte,)i(.word,)h(.long)p Fv(\),)c(whic)o(h)g(allo)o(ws)g(the)145
1540 y(c)o(hec)o(k)o(er)d(to)f(emit)e(b)q(oth)i(represen)o(tations)h
(in)e(one)h(assem)o(bly)f(\014le.)17 b(The)c(second)h(construc-)145
1590 y(tor)g(in)f(a)g(pair)g(emits)g(the)h(the)g(assem)o(bly-language)d
(represen)o(tation)k(of)e(the)i(instruction.)145 1640
y(When)k(executed,)j(the)e(c)o(hec)o(k)o(er)g(program)e(emits)g(its)h
(output)g(in)o(to)f(an)h(assem)o(bly)f(\014le,)145 1690
y(whic)o(h)d(is)f(then)h(assem)o(bled)e(b)o(y)i(the)g(nativ)o(e)f
(assem)o(bler.)19 b(This)14 b(tec)o(hnique)h(assumes)f(that)145
1740 y(the)k(nativ)o(e)e(assem)o(bler)g(p)q(ermits)h(b)q(oth)g
(instructions)g(and)g(data)f(in)g(the)i(text)f(segmen)o(t;)145
1789 y(the)g(SGI-Irix)f(assem)o(bler)g(is)g(the)h(only)f(one)g(that)h
(w)o(e)f(ha)o(v)o(e)h(found)f(that)g(prohibits)g(this)145
1839 y(mix.)208 1889 y(The)g(resulting)f(ob)r(ject)i(\014le)f(is)f
(disassem)o(bled)g(using)h(a)f(nativ)o(e)g(disassem)o(bler)g(or)h(de-)
145 1939 y(bugger.)26 b(W)m(e)16 b(use)h Fr(gdb)k(-batch)15
b Fv(to)h(disassem)o(ble)g(the)h(ob)r(ject)g(\014le.)25
b Fr(gdb)15 b Fv(reads)i(the)g(\014le)145 1989 y Fr
(gdb-{asm,bin}output)o Fv(,)i(whic)o(h)h(disassem)o(ble)g(the)h
(instructions)h(generated)f(b)o(y)g(the)145 2038 y(c)o(hec)o(k)o(er.)
-15 2101 y Fp(305a)88 b Fo(h)p Fn(gdb-binoutput)16 b
Fp(305a)p Fo(i)o(\021)187 2151 y Fr(disas)21 b(main)g(_asmoutput)145
2202 y Fp(Uses)12 b Fl(main)e Fp(20.)-17 2285 y(305b)88
b Fo(h)p Fn(gdb-asmoutput)16 b Fp(305b)p Fo(i)o(\021)187
2335 y Fr(disas)21 b(_asmoutput)e(_endoutput)830 2604
y Fv(305)p eop
%%Page: 306 306
306 305 bop 129 141 a Fv(306)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(If)g(the)h(sp)q
(eci\014cation's)g(assem)o(bly-to-binary)d(mappings)g(are)j(correct,)h
(the)f(assem)o(bly)129 307 y(output)h(should)f(con)o(tain)g(pairs)g(of)
f(matc)o(hing)g(instructions;)h(a)g(matc)o(hed)f(pair)h(indicates)129
357 y(that)f(the)g(assem)o(bler's)f(binary)g(enco)q(ding)h(of)f(an)h
(instruction)f(matc)o(hes)h(the)g(to)q(olkit's)e(en-)129
407 y(co)q(ding.)18 b(A)13 b(short)g(script)g(compares)g(pairs)g(of)f
(instructions)h(and)g(\015ags)f(an)o(y)h(mismatc)o(hed)129
457 y(pairs.)28 b(Because)19 b(the)f(c)o(hec)o(k)o(er)g(emits)e
(mismatc)o(hed)f(pairs)i(in)g(assem)o(bly)m(,)e(the)j(user)g(can)129
507 y(easily)c(iden)o(tify)f(the)h(source)i(of)d(the)h(discrepancy)i
(in)d(the)h(original)e(sp)q(eci\014cation.)-13 569 y
Fp(306)88 b Fo(h)p Fn(chkr\014lter)15 b Fp(306)p Fo(i)o(\021)171
619 y Fr(#!/bin/sh)171 669 y(#)171 718 y(#)22 b(Usage:)e(chckfilter)g
(<gawk)h(or)g(nawk>)g(<object)f(file)h(name>)171 768
y(#)171 818 y(#)65 b(Compare)20 b(pairs)h(of)h(disassembled)d
(instructions)171 868 y(GNAWK=$1)171 918 y(shift)171
967 y(gdb)i(-batch)g(-x)g(gdb-asmoutput)e($1)j(|)f(\\)215
1017 y(sed)g(-e)g('s/^[^:]*://g')e(>$1.asmoutput)171
1067 y(gdb)i(-batch)g(-x)g(gdb-binoutput)e($1)j(|)f(\\)215
1117 y(sed)g(-e)g('s/^[^:]*://g')e(>$1.binoutput)171
1167 y(echo)i("Differences")171 1217 y(#)h(Display)e(diffs)h(in)g(2)h
(column)e(format)171 1266 y(diff)h($1.asmoutput)e($1.binoutput)h(|)h
(expand)g(|)g(\\)215 1316 y($GNAWK)f('/^---$/)g({)i(next)f(})171
1366 y(/^<)g(/)h({)f(left[nextleft++])e(=)i(substr\($0,3\);)e(next)i(})
171 1416 y(/^>)g(/)h({)f(right[nextright++])d(=)k(substr\($0,3\);)d
(next)i(})171 1466 y(function)f(dump)h(\(\))g({)215 1515
y(if)g(\(nextright==1)e(&&)i(right[0]=="#)f(ERROR"\))g({)345
1565 y(nextleft)g(=)i(1;)f(left[0])g(=)g(">>>)g(ERROR)g(<<<")215
1615 y(})215 1665 y(while)f(\(nextleft)g(<)i(nextright\))e
(left[nextleft++)o(]="")215 1715 y(while)g(\(nextright)g(<)i
(nextleft\))e(right[nextright)o(++]=")o(")215 1764 y(for)h(\(i=0;)f
(i<nextleft;)g(i++\))h({)302 1814 y(printf)f("\045-38.38s)g(|)i
(\045-38.38s\\n",)d(left[i],)h(right[i])215 1864 y(})215
1914 y(nextleft)g(=)h(nextright)f(=)i(0)171 1964 y(})171
2063 y({)g(dump\(\);)e(print)h(})171 2113 y(END)g({dump\(\)})171
2163 y(')171 2213 y(rm)g(-f)h($1.asmoutput)d($1.binoutput)129
2265 y Fp(Uses)12 b Fl(file)e Fp(359a)h(and)f Fl(next)h
Fp(399c.)p eop
%%Page: 307 307
307 306 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(307)145 258 y Fj(16.1)66 b(Ho)n(w)21
b(to)i(build)h(a)f(c)n(hec)n(k)n(er)145 349 y Fv(The)11
b(to)q(olkit)e(distribution)g(includes)i(the)g(directory)g
Fr(base-checker)p Fv(,)d(whic)o(h)i(con)o(tains)g(all)145
398 y(the)i(\014les)f(necessary)i(to)d(build)g(c)o(hec)o(k)o(ers)j(for)
d(the)i(MIPS,)e(SP)m(AR)o(C,)g(and)h(P)o(en)o(tium)e(targets.)145
448 y(It)16 b(also)f(con)o(tains)h(a)f(mak)o(e\014le)f(that)i(will)e
(build)h(and)g(run)h(a)f(c)o(hec)o(k)o(er.)25 b(W)m(e)15
b(describ)q(e)j(the)145 498 y(steps)e(necessary)f(to)f(build)f(and)h
(run)g(a)g(c)o(hec)o(k)o(er)h(here.)208 548 y(A)10 b(c)o(hec)o(k)o(er)i
(requires)f(an)f(assem)o(bly)g(emitter)f(\(e.g.,)h Fn(tar)n(get)t
Fr(-asm.c)p Fv(\),)f(a)h(binary)g(emitter)145 598 y(\(e.g.,)j
Fn(tar)n(get)t Fr(-bin.c)p Fv(\),)e(target-sp)q(eci\014c)16
b(co)q(de)f(to)e(emit)g(b)o(ytes)h(in)f(assem)o(bly)g(pseudo-ops,)145
647 y(the)21 b(c)o(hec)o(k)o(er)h(program)c(and)i(the)h(to)q(olkit)e
(library)m(.)35 b(The)21 b(c)o(hec)o(k)o(er)g(program)e(accesses)145
697 y(the)f(binary)f(and)f(assem)o(bly)g(emitters)h(indirectly)g(via)f
(the)i(in)o(terfaces)g Fn(tar)n(get)p Fr(_asm)e Fv(and)145
747 y Fn(tar)n(get)p Fr(_bin)p Fv(.)208 797 y(T)m(o)11
b(c)o(hec)o(k)i(instructions)g(that)g(tak)o(e)f(relo)q(catable)h(op)q
(erands,)g(w)o(e)f(use)h(a)f(tric)o(k)h(to)f(guar-)145
847 y(an)o(tee)21 b(that)f(the)g(address)h(assigned)f(b)o(y)g(the)g
(assem)o(bler)f(matc)o(hes)h(that)g(used)g(b)o(y)g(the)145
897 y(binary)12 b(emitter.)17 b(The)c(address)g(in)f(the)h(\014le)f
Fr(chkraddr)e Fv(is)j(the)f(en)o(try)h(p)q(oin)o(t)f(for)g
Fr(main)p Fv(;)f(w)o(e)145 946 y(get)i(that)g(v)n(alue)f(b)q(efore)i
(building)d(the)j(c)o(hec)o(k)o(er)g(program,)d(then)i(use)h(it)f(to)f
(assign)h(kno)o(wn)145 996 y(addresses)j(to)e(relo)q(catable)g(op)q
(erands.)2 1058 y Fp(307)89 b Fo(h)p Fn(rules)15 b(to)g(build)f(che)n
(ck)i(addr)n(ess)f Fp(307)p Fo(i)o(\021)187 1108 y Fr(chkraddr:)361
1158 y(echo)21 b("main\(\){}")f(>_boot.c)361 1208 y($\(CC\))h(-g)g
(_boot.c)g(-o)g(_boot)361 1258 y(nm)h(_boot)e(|)i(egrep)f("T)g(_main|T)
f(main")h(|)h(\\)601 1307 y(awk)f('{print)f("0x"$$1}')g(|)i(cpif)f($@)
361 1357 y(rm)h(-f)f(_boot.c)f(_boot)145 1409 y Fp(Uses)12
b Fl(main)e Fp(20.)208 1471 y Fv(A)15 b(sp)q(eci\014cation)h(is)f(c)o
(hec)o(k)o(ed)h(in)f(sev)o(eral)h(steps.)23 b(All)15
b(of)f(these)j(steps)f(app)q(ear)g(in)f(the)145 1521
y Fr(base-checker)p Fv('s)g(mak)o(e\014le.)27 b(First,)18
b(the)g(c)o(hec)o(k)o(er)h(program)c(emits)i(assem)o(bly)f(co)q(de)i
(in)145 1571 y(the)d(\014le)p 286 1571 13 2 v 29 w Fn(tar)n(get.s)p
Fv(.)i(The)d(assem)o(bly)f(\014le)h(is)f(assem)o(bled)h(in)o(to)f(the)h
(binary)f(\014le)p 1381 1571 V 30 w Fn(tar)n(get.out)p
Fv(.)145 1621 y(Then)g(the)g Fr(chkrfilter)d Fv(shell)i(script)h
(disassem)o(bles)e(the)i(binary)f(\014le)g(and)g(compares)g(the)145
1671 y(t)o(w)o(o)i(represen)o(tations.)20 b(An)o(y)13
b(di\013erences)k(are)d(prin)o(ted)g(to)g(standard)g(output.)p
eop
%%Page: 308 308
308 307 bop 129 141 a Fv(308)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Fj(16.2)66
b(Building)25 b(a)d(c)n(hec)n(k)n(er)129 349 y Fr(emit_checker)7
b Fv(pro)q(duces)k(the)f(c)o(hec)o(k)o(er.)18 b(F)m(or)9
b(eac)o(h)h(constructor,)h Fr(generate_input_va)o(lues)129
398 y Fv(pro)q(duces)26 b(a)d(table)g(that)h(asso)q(ciates)g(op)q
(erands')g(names)f(with)g(sets)i(of)e(test)h(inputs)129
448 y(that)d(satisfy)g(the)h(constructor's)g(constrain)o(ts.)40
b(F)m(or)21 b(eac)o(h)g(instruction)g(constructor,)129
498 y Fr(generate_checker)15 b Fv(en)o(umerates)k(all)e(the)h(test)i(v)
n(alues)d(of)h(the)h(op)q(erands)g(asso)q(ciated)129
548 y(with)14 b(that)f(constructor,)i(and)f(it)f(emits)g(assem)o(bly)f
(and)i(binary)f(forms)f(b)o(y)i(applying)e(the)129 598
y(constructor)h(to)e(eac)o(h)h(com)o(bination.)i(If)d(an)g(op)q(erand)g
(is)g(of)f(a)h(constructor)i(t)o(yp)q(e)e(\(i.e.,)g(not)129
647 y(a)17 b(\014eld)h(or)f(in)o(teger\))g(the)h(c)o(hec)o(k)o(er)h
(rep)q(eats)g(the)f(en)o(umeration)e(pro)q(cess)j(recursiv)o(ely)f(on)
129 697 y(constructors)d(of)d(that)h(t)o(yp)q(e.)18 b(This)12
b(recursion)i(explores)f(the)g(en)o(tire)g(state)h(space)f(de\014ned)
129 747 y(b)o(y)h(the)h(constructors)h(and)d(the)i(sets)g(of)e(op)q
(erand)i(v)n(alues.)192 797 y Fr(generate_checker)f Fv(emits)i(a)i(C)f
(program)f(that)i(applies)f(the)h(pairs)f(of)g(construc-)129
847 y(tors.)28 b(The)17 b(assem)o(bly)f(constructors)j(are)e(accessed)j
(indirectly)c(through)h(the)h(in)o(terface)129 897 y
Fn(name)p Fr(_asm)c Fv(and)f(the)h(binary)f(constructors)i(via)e
Fn(name)p Fr(_bin)p Fv(.)18 b(An)13 b(in)o(terface)h(name)f(m)o(ust)129
946 y(b)q(e)i(sp)q(eci\014ed)g(using)f(the)g Fr(-indirect)e
Fv(command-line)f(option.)-13 1009 y Fp(308)88 b Fo(h)p
Fn(*)16 b Fp(308)p Fo(i)o(\021)1202 b Fp(309)5 b Fm(.)171
1058 y Fr(global)21 b(chkr_input_tbl)171 1108 y(global)g(TESTLIMIT)171
1158 y(global)g(zerotab)171 1208 y(procedure)f(emit_checker\(outf)o
(ilena)o(me\))215 1258 y(local)g(outfile,)g(altoutfile,)g(pp)215
1357 y(TESTLIMIT)f(:=)j(1024)215 1407 y(zerotab)e(:=)h(table\(0\))215
1457 y(zerotab[1])e(:=)j(0)215 1507 y(verbose\("Emitti)o(ng)d(checker)h
(program"\))215 1557 y(if)h(\(/chkr_input_tbl\))d(then)j
(chkr_input_tbl)e(:=)i(table\(\))215 1606 y(if)g(\(/indirectname\))e
(then)258 1656 y(error\("Interface)g(name)i(undefined.)e(Checker)i
(requires)f(``-indirect'')f(option"\))215 1706 y(outfile)h(:=)h
(openfile\(outfilenam)o(e)e(||)i(implementation_exte)o(nsion)o(,)e
("cw"\))i(|)258 1756 y(error\("Could)e(not)j(open)f(",)g(outfilename,)e
(")j(for)f(writing"\))215 1806 y(pp)g(:=)g(PPnew\(outfile\))215
1855 y(emit_template\(p)o(p,)e("checker.t",)g("interface",)520
1905 y(image\(outfilenam)o(e)g(||)i(interface_extension)o(\),)e
("irname",)h(indirectname\))215 1955 y(every)g(cons)h(:=)h
(kept_constructor)o(s\(\))d(do)i({)258 2005 y(write\(\\cdebug,)e
("\\nChecker)h(for)h(")h(||)f(expimage\(cons.nam)o(e\)\))258
2055 y(p)h(:=)f(pattern_to_case\(su)o(bst_t)o(ab\(cr)o(hs\(c)o(ons\),)d
(parmtab\(cons\),)h(1\)\))258 2104 y(chkr_input_tbl[con)o(s.nam)o(e])g
(:=)i(generate_input_val)o(ues\(p)o(,)e(cons\))215 2154
y(})215 2204 y(generate_checke)o(r\(pp,)f(outfilename,)i
(indirectname\))215 2254 y(PPxwrites\(pp,)f("$b}$n"\))215
2304 y(PPwrite\(pp\))63 b(#)21 b(flush)g(prettyprinter)215
2354 y(return)171 2403 y(end)129 2455 y Fp(De\014nes:)171
2495 y Fl(chkr_input)o(_tb)o(l)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f
(309)h(and)f(311a.)p eop
%%Page: 309 309
309 308 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(309)187 258 y Fl(emit_check)o(er)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(20.)187 297 y Fl(TESTLIMIT)p
Fp(,)e(used)j(in)g(c)o(h)o(unk)f(317.)187 337 y Fl(zerotab)p
Fp(,)f(used)h(in)i(c)o(h)o(unk)e(315a.)145 376 y(Uses)19
b Fl(cdebug)d Fp(18a,)h Fl(crhs)h Fp(168,)f Fl(expimage)e
Fp(101a,)i Fl(generate_ch)o(eck)o(er)e Fp(309,)187 415
y Fl(generate_i)o(npu)o(t_)o(val)o(ues)c Fp(313,)h Fl(implementati)o
(on)o(_ex)o(ten)o(sio)o(n)f Fp(18a,)i Fl(indirectna)o(me)e
Fp(18a,)187 455 y Fl(interface_)o(ext)o(en)o(sio)o(n)g
Fp(18a,)j Fl(kept_cons)o(tru)o(cto)o(rs)d Fp(33d,)i Fl(openfile)f
Fp(24,)h Fl(parmtab)f Fp(189a,)187 494 y Fl(pattern_to)o(_ca)o(se)c
Fp(183b,)i Fl(subst_tab)f Fp(89a,)h(and)h Fl(verbose)e
Fp(18a.)208 557 y Fr(generate_checke)o(r)g Fv(emits)i(the)i(ASCI)q
(I-enco)q(ded)h(binary)e(instructions)g(in)g(the)h(text)145
606 y(section)k Fr(main)f Fv(and)g(then)g(the)h(assem)o(bly)e
(instructions)i(in)f Fr(_asmoutput)e Fv(.)25 b(UNIX-st)o(yle)145
656 y(assem)o(bler)15 b(pseudo-ops)g(are)g(in)o(terlea)o(v)o(ed)g(b)q
(et)o(w)o(een)h(the)g(t)o(w)o(o)e(sections)i(so)e(that)h(the)h(dis-)145
706 y(assem)o(bler)e(can)g(\014nd)g(the)g(en)o(try)h(p)q(oin)o(ts)f(of)
f(eac)o(h)h(section.)2 768 y Fp(309)89 b Fo(h)p Fn(*)15
b Fp(308)p Fo(i)p Fv(+)p Fo(\021)1070 b Fm(/)6 b Fp(308)22
b(310)5 b Fm(.)187 818 y Fr(procedure)20 b(generate_checker)o(\(pp,)e
(outfilename,)i(indirectname\))230 868 y(local)h(cons,)g(test,)g
(asmoutput,)e(binoutput,)h(outfile,)g(app)230 918 y(count)h(:=)h(0)230
967 y(asmoutput)e(:=)i([])230 1017 y(binoutput)e(:=)i("")230
1067 y(asmir)f(:=)h(indirectname)d(||)i("_asm")g(||)g("->")230
1117 y(binir)g(:=)h(indirectname)d(||)i("_bin")g(||)g("->")230
1217 y(outfile)g(:=)g(openfile\(outfilena)o(me)e(||)i("_tmp_",)f
("cw"\))h(|)274 1266 y(error\("Could)e(not)i(open)g(",)h(outfilename,)d
(")j(for)f(writing"\))230 1316 y(app)h(:=)f(PPnew\(outfile\))230
1366 y(every)g(cons)g(:=)g(kept_constructors\(\))d(do)274
1416 y(if)j(cons.type)f(===)h(instructionctype)e(then)318
1466 y(every)h(test)h(:=)h(generate_tests\(c)o(ons,)c(1,)k
(!chkr_input_tbl[)o(cons.)o(name])o(,)d(asmir\))h(do)i({)361
1515 y(pexp)f(:=)g(pretty\(Gcall\(cons.na)o(me,)e(test\)\))361
1565 y(asmoutput)h(:=)h("/*)h(Pair)f(")g(||)h(string\(count)d(+:=)i
(1\))g(||)h(":")f(||)g(pexp)g(||)h(")f(*/\\n")361 1615
y(asmoutput)f(||:=)h(asmir)g(||)g(pexp)g(||)h(";\\n")361
1665 y(PPxwrite\(app,)d(asmoutput\))361 1715 y(binoutput)h(:=)h("/*)h
(Pair)f(")g(||)h(string\(count\))d(||)i(":")g(||)h(pexp)f(||)g(")h
(*/\\n")361 1764 y(binoutput)e(||:=)h(binir)g(||)g(pexp)g(||)h(";\\n")
361 1814 y(PPxwrite\(pp,)d(binoutput\))318 1864 y(})230
1914 y(emit_template\(pp,)g("inchecker.t"\))230 1964
y(PPwrite\(app\))41 b(#)22 b(flush)f(assembly)f(prettyprinter)230
2014 y(outfile)h(:=)g(openfile\(outfilena)o(me)e(||)i("_tmp_",)f("r"\))
h(|)274 2063 y(error\("Could)e(not)i(open)g(",)h(outfilename,)d(")j
(for)f(reading"\))230 2113 y(every)g(line)g(:=)43 b(!outfile)20
b(do)274 2163 y(PPxwrite\(pp,)f(line\))230 2213 y(emit_template\(pp,)g
("afterchecker.t")o(\))230 2263 y(remove\(outfilename)f(||)k("_tmp_"\))
187 2312 y(end)145 2364 y Fp(De\014nes:)187 2404 y Fl(generate_c)o(hec)
o(ke)o(r)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(308.)145
2443 y(Uses)15 b Fl(chkr_input_t)o(bl)d Fp(308,)i Fl(Gcall)f
Fp(293a,)h Fl(generate_t)o(es)o(ts)e Fp(310,)i Fl(indirectna)o(me)e
Fp(18a,)187 2483 y Fl(instructio)o(nct)o(yp)o(e)d Fp(32a,)h
Fl(kept_constr)o(uct)o(ors)e Fp(33d,)i Fl(line)h Fp(359a,)f
Fl(openfile)f Fp(24,)i(and)f Fl(pretty)g Fp(18a.)p eop
%%Page: 310 310
310 309 bop 129 141 a Fv(310)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y Fr(generate_tests)h
Fv(generates)19 b(the)e(test)i(inputs)e(for)g(argumen)o(ts)f
Fr(idx)h Fv(through)g(the)129 307 y(last)j(argumen)o(t)e(to)h
(constructor)i Fr(cons)p Fv(.)34 b(It)20 b(susp)q(ends)h(a)e(list)g(of)
g(test)i(v)n(alues)e(for)g(the)129 357 y(op)q(erands)c(from)d
Fr(idx)i Fv(to)f Fr(*cons.operands)p Fv(.)-13 420 y Fp(310)88
b Fo(h)p Fn(*)16 b Fp(308)p Fo(i)o Fv(+)p Fo(\021)1053
b Fm(/)5 b Fp(309)22 b(311a)5 b Fm(.)171 469 y Fr(procedure)20
b(generate_tests\(co)o(ns,)f(idx,)i(test_values,)e(asmir\))215
519 y(local)h(i,)i(rest)215 569 y(write\(\\cdebug,)c("Generate)i(tests)
h(for)g(",)h(cons.name,)d(")j(",)541 619 y(idx,)f(")h(",)f
(expimage\(cons.opera)o(nds[i)o(dx]\)\))215 669 y Fo(h)p
Fn(print)14 b Fr(test_values)f Fp(314e)p Fo(i)215 718
y Fr(if)21 b(idx)g(>)h(*cons.operands)d(then)258 768
y(suspend)h([])215 818 y(else)h(if)g(type\(cons.operand)o(s[idx)o(]\))e
(==)i("literal")f(then)258 868 y(suspend)g(generate_tests\(cons,)e
(idx+1,)j(test_values,)e(asmir\))215 918 y(else)258 967
y(every)i(rest)g(:=)g(generate_tests\(cons)o(,)e(idx+1,)h(test_values,)
g(asmir\))g(&)389 1017 y(i)h(:=)h(tests_of\(cons.ope)o(rands)o([idx)o
(],)d(test_values,)g(asmir\))258 1067 y(do)j({)302 1117
y(push\(rest,)d(i\))302 1167 y(suspend)h(rest)302 1217
y(pop\(rest\))258 1266 y(})171 1316 y(end)129 1368 y
Fp(De\014nes:)171 1408 y Fl(generate_t)o(est)o(s)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(309)h(and)f(311a.)129 1447
y(Uses)i Fl(cdebug)e Fp(18a,)g Fl(expimage)f Fp(101a,)h
Fl(literal)g Fp(45e,)g(and)h Fl(tests_of)e Fp(311a.)p
eop
%%Page: 311 311
311 310 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(311)-15 258 y Fp(311a)88 b Fo(h)p
Fn(*)15 b Fp(308)p Fo(i)p Fv(+)p Fo(\021)1070 b Fm(/)6
b Fp(310)22 b(312)5 b Fm(.)187 307 y Fr(procedure)20
b(tests_of\(input,)e(tbl,)j(asmir\))230 357 y(local)g(i,)h(m,)f(n)230
407 y(if)h(type\(input\))d(==)j("literal")e(then)h(suspend)f("")230
457 y(else)h(if)h(type\(input\))d(==)j("input")e(then)h({)274
507 y(case)g(type\(input.meanin)o(g\))e(of)i({)318 557
y("integer")e(:)j({)361 606 y(input)f(:=)g(lookuptype\(input.na)o(me,)e
("field"\))361 656 y Fo(h)p Fn(che)n(ck)d(that)e(test)h(values)g(exist)
g(for)f(input)h Fp(311b)p Fo(i)361 706 y Fr(suspend)20
b(tbl[input.name])318 756 y(})318 806 y("string")g(:)h({)361
855 y Fo(h)p Fn(che)n(ck)16 b(that)e(test)h(values)g(exist)g(for)f
(input)h Fp(311b)p Fo(i)361 905 y Fr(suspend)20 b(if)i(\(input.meaning)
d(==)i("reloc")f(&)i(integer\(tbl[input.)o(name])o(\)\))d(then)448
955 y(Gcall\("unsigned_to_)o(raddr)o(",)g([tbl[input.name])o(]\))361
1005 y(else)i(tbl[input.name])318 1055 y(})318 1104 y("field")f(|)h
("null")g(|)h("string")e(:)h({)361 1154 y Fo(h)p Fn(che)n(ck)16
b(that)e(test)h(values)g(exist)g(for)f(input)h Fp(311b)p
Fo(i)361 1204 y Fr(suspend)20 b(tbl[input.name])318 1254
y(})318 1304 y("constype")f(:)383 1354 y(every)i(m)g(:=)h
(kept_constructor)o(s\(inp)o(ut.m)o(eanin)o(g\))d(&)514
1403 y(i)i(:=)h(generate_tests\(m)o(,)d(1,)i(!chkr_input_tbl[m.n)o
(ame],)d(asmir\))383 1453 y(do)427 1503 y(suspend)i(Gcall\(asmir)f(||)j
(m.name,)e(i\))318 1553 y(default)g(:)h(typeerror\(input.mean)o(ing,)d
("field,)j(input,)f(or)i(constype",)d(input.name\))274
1603 y(})230 1652 y(})187 1702 y(end)145 1754 y Fp(De\014nes:)187
1794 y Fl(tests_of)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(310.)145
1833 y(Uses)k Fl(chkr_input)o(_tb)o(l)d Fp(308,)h Fl(constype)f
Fp(159,)h Fl(field)g Fp(55,)h Fl(Gcall)f Fp(293a,)g Fl(generate_te)o
(sts)e Fp(310,)187 1872 y Fl(input)i Fp(46a,)g Fl(kept_constr)o(uct)o
(ors)e Fp(33d,)j Fl(literal)e Fp(45e,)h Fl(lookuptype)f
Fp(25a,)h Fl(typeerror)f Fp(28b,)187 1912 y(and)f Fl(unsigned_to)o(_ra)
o(ddr)o Fp(.)-17 2003 y(311b)88 b Fo(h)p Fn(che)n(ck)16
b(that)f(test)f(values)h(exist)g(for)f(input)h Fp(311b)p
Fo(i)o(\021)528 b Fp(\(311a\))187 2053 y Fr(inputs)20
b(:=)i(\\tbl[input.name])c(|)k(\\)187 2103 y(error\("No)e(test)h
(values)f(specified)g(for)h(`",)h(input.name,)d("'"\))145
2155 y Fp(Uses)12 b Fl(input)e Fp(46a.)p eop
%%Page: 312 312
312 311 bop 129 141 a Fv(312)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y Fr(merge_chkr_table)o
(s)i Fv(merges)i(t)o(w)o(o)h(input)f(tables)h(and)f(complains)f(if)h
(test)i(v)n(alues)129 307 y(ha)o(v)o(e)14 b(already)g(b)q(een)h
(supplied)f(for)f(an)h(input.)-13 370 y Fp(312)88 b Fo(h)p
Fn(*)16 b Fp(308)p Fo(i)o Fv(+)p Fo(\021)1053 b Fm(/)5
b Fp(311a)22 b(313)5 b Fm(.)171 420 y Fr(procedure)20
b(merge_chkr_tables)o(\(L\))215 469 y(local)g(t,)i(k)215
519 y(chkr_tbl)e(:=)h(table\(\))215 619 y(every)f(t)i(:=)f(!L)h(do)f({)
258 669 y(every)g(k)g(:=)h(key\(t\))e(do)i({)302 718
y(if)f(/chkr_tbl[k])e(then)i(chkr_tbl[k])f(:=)h(t[k])302
768 y(else)g(warning\("Checker)d(inputs)j(for)g(",)g(k,)h(")f(already)g
(defined.)f(Using)g(first)h(set."\))258 818 y(})215 868
y(})215 918 y(return)f(chkr_tbl)171 967 y(end)129 1019
y Fp(Uses)12 b Fl(defined)d Fp(136a.)p eop
%%Page: 313 313
313 312 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(313)145 258 y Fj(16.3)66 b(Generating)23
b(Inputs)g(for)f(Chec)n(k)n(er)145 349 y Fv(T)m(o)11
b(test)i(eac)o(h)g(constructor,)g(w)o(e)g(generate)g(one)f(or)g(more)f
(sets)i(of)e(input)h(v)n(alues.)17 b(F)m(or)12 b(eac)o(h)145
398 y(of)18 b(the)h(constructor's)g(branc)o(hes)h(\(i.e.,)e(sets)h(of)f
(equations\),)g(the)h(goal)e(is)h(to)g(generate)145 448
y(one)d(input)g(set)h(that)f(satis\014es)h(only)e(that)h(branc)o(h;)h
(this)f(guaran)o(tees)g(that)g(eac)o(h)h(branc)o(h)145
498 y(of)f(eac)o(h)g(constructor)i(is)e(tested)i(at)e(least)g(once.)22
b(If)15 b(the)g(constructor)i(is)e(unconditional,)145
548 y(only)c(one)h(set)h(of)e(input)h(v)n(alues)g(is)f(generated;)j(if)
d(it)g(is)h(conditional,)e(one)j(set)f(is)g(generated)145
598 y(for)18 b(eac)o(h)g(branc)o(h.)31 b(In)18 b(the)h(general)f(case,)
h(determining)e(that)h(a)g(set)h(of)e(conditions)h(is)145
647 y(satis\014able)e(is)h(undecideable,)g(b)q(ecause)h
Fn(why)p Fv(?.)24 b Fn(what's)17 b(the)g(r)n(e)n(duction?)25
b Fv(F)m(or)16 b(example,)145 697 y(a)j(branc)o(h's)g(equations)f(ma)o
(y)f(include)h(m)o(utually)e(unsatis\014able)j(constrain)o(ts,)h(e.g.)
32 b Fr(rd)145 747 y(=)22 b(1,)f(rd)h(=)f(2)p Fv(,)d(in)f(whic)o(h)h
(case,)h(no)e(set)i(of)e(input)g(v)n(alues)g(exists)i(that)e
(satis\014es)i(these)145 797 y(equations.)208 847 y(Instead,)12
b(w)o(e)g(use)h(heuristics)g(to)f(generate)h(the)f(test)h(v)n(alues)f
(for)f(a)h(particular)f(branc)o(h.)145 897 y(First,)16
b(w)o(e)g(\014nd)g(equalit)o(y)f(conditions)g(that)h(constrain)g(an)g
(input)f(to)h(a)f(constan)o(t)h(v)n(alue,)145 946 y(e.g.,)g(the)h
(condition)f Fr(rd)21 b(=)h(1)16 b Fv(determines)g Fr(rd)p
Fv('s)g(test)i(v)n(alue.)24 b(That)17 b(initial)d(set)j(is)f(used)145
996 y(to)f(simplify)c(the)k(branc)o(h's)g(conditions,)f(whic)o(h)h(ma)o
(y)d(determine)j(other)g(inputs')f(v)n(alues.)145 1046
y(T)m(est)d(v)n(alues)f(are)g(added)h(un)o(til)e(no)h(new)g(inputs)g
(are)h(constrained.)18 b(If)9 b(some)g(inputs)i(remain)145
1096 y(unconstrained,)16 b(they)f(are)g(assigned)f(a)h(random)e(test)i
(v)n(alue)f(within)g(the)h(input's)g(width)145 1146 y(constrain)o(ts.)2
1208 y Fp(313)89 b Fo(h)p Fn(*)15 b Fp(308)p Fo(i)p Fv(+)p
Fo(\021)1054 b Fm(/)6 b Fp(312)22 b(314c)5 b Fm(.)187
1258 y Fr(procedure)20 b(generate_input_v)o(alues)o(\(p,)f(cons\))230
1307 y(local)i(d,)h(conds,)e(fits,)h(test_values,)e(test_sets,)h(f,)h
(tmp,)g(names)230 1357 y(test_sets)f(:=)i([])230 1407
y(case)f(type\(p\))g(of)g({)274 1457 y("Stagcase")63
b(:)22 b({)339 1507 y(every)f(c)h(:=)f(kept_constructors\()o(p.typ)o
(e\))e(do)383 1557 y(test_sets)h(|||:=)h(generate_input_v)o(alue)o
(s\(p.a)o(rms[c)o(],)e(cons\))274 1606 y(})274 1656 y("pattern")h(:)h
({)318 1706 y(remove_duplicat)o(e_con)o(ditio)o(ns\(p,)d(cons\))318
1756 y(while)i(d)i(:=)f(get\(p.disjuncts\))e(do)i({)361
1806 y(test_values)f(:=)h(table\(\))361 1855 y(test_values[Epc])e(:=)i
(Epc)361 1905 y Fo(h)p Fn(extr)n(act)15 b Fr(d)p Fn('s)f(c)n(onditions)
h Fp(314a)p Fo(i)361 1955 y(h)p Fn(cr)n(e)n(ate)g(initial)f(set)g(of)h
Fr(test_values)e Fp(318c)p Fo(i)361 2005 y(h)p Fn(gener)n(ate)i(input)g
(values)h Fp(317)p Fo(i)361 2055 y Fr(put\(test_sets,)j(test_values\))
318 2104 y(})274 2154 y(})230 2204 y(})230 2254 y(return)i(test_sets)
187 2304 y(end)145 2356 y Fp(De\014nes:)187 2395 y Fl(generate_i)o(npu)
o(t_)o(val)o(ues)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(308.)145
2434 y(Uses)j Fl(Epc)f Fp(81,)h Fl(kept_cons)o(tru)o(cto)o(rs)d
Fp(33d,)h Fl(pattern)g Fp(55,)h Fl(remove_dupl)o(ica)o(te_)o(co)o(ndi)o
(tio)o(ns)e Fp(197a,)187 2474 y(and)g Fl(Stagcase)f Fp(183a.)p
eop
%%Page: 314 314
314 313 bop 129 141 a Fv(314)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y(This)d(co)q(de)g(is)f
(deriv)o(ed)h(from)d(the)j(co)q(de)g(in)f Fr(constructors.nw)d
Fv(that)k(extracts)g(a)f(disjunct's)129 307 y(conditions)k(b)q(efore)g
(emitting)e(its)i(enco)q(ding)g(co)q(de.)18 b(T)m(o)12
b(generate)i(input)e(v)n(alues,)g(w)o(e)h(only)129 357
y(need)i(the)g(\014eld-width)e(constrain)o(ts)i(in)e
Fr(fits)g Fv(and)h(the)h(general)f(conditions)f(in)h
Fr(conds)p Fv(.)-31 420 y Fp(314a)88 b Fo(h)p Fn(extr)n(act)15
b Fr(d)p Fn('s)f(c)n(onditions)i Fp(314a)p Fo(i)o(\021)815
b Fp(\(313\))171 469 y Fr(set_patlabel_offs)o(ets\(d)o(\))171
519 y(d)22 b(:=)f(gsubst\(d,)f(Epatlabel_to_Epc\))171
569 y(ds_conds)g(:=)h(extract_conditions\(d)o(,)e(cons\))171
619 y(conds)i(:=)g(ds_conds[2])171 669 y(fits)g(:=)43
b(ds_conds[4])171 718 y(sanitize_sequents)o(\(d,)19 b(fits\))171
768 y Fo(h)p Fn(eliminate)c Fr(Eforce)e Fn(on)j(r)n(elo)n(c)n(atable)e
(inputs)h Fp(314b)p Fo(i)171 818 y(h)p Fn(add)h(c)n(onstr)n(aints)e(on)
i(unc)n(onstr)n(aine)n(d)f(inputs)g Fp(315a)p Fo(i)171
868 y(h)p Fn(add)h(c)n(onstr)n(aints)e(on)i(\014eld)f(inputs)g
Fp(315b)p Fo(i)171 918 y(h)p Fn(omit)g(c)n(onstr)n(aints)f(and)i(c)n
(onditions)f(on)h(c)n(onstructor-typ)n(e)n(d)e(op)n(er)n(ands)i
Fp(315c)p Fo(i)171 967 y(h)p Fn(print)f Fr(fits)f Fn(and)h
Fr(conds)f Fp(314d)p Fo(i)129 1019 y Fp(Uses)19 b Fl(Epatlabel)o(_to)o
(_Ep)o(c)c Fp(193a,)h Fl(gsubst)g Fp(120a,)h Fl(sanitize_s)o(equ)o(ent)
o(s)e Fp(194a,)171 1059 y(and)c Fl(set_patla)o(bel)o(_of)o(fs)o(ets)d
Fp(59c.)192 1121 y Fv(Relo)q(catable)h(addresses)i(are)f(alw)o(a)o(ys)e
("forceable",)i(b)q(ecause)h(the)f(c)o(hec)o(k)o(er)h(determines)129
1171 y(their)k(v)n(alues.)-33 1233 y Fp(314b)88 b Fo(h)p
Fn(eliminate)15 b Fr(Eforce)f Fn(on)h(r)n(elo)n(c)n(atable)f(inputs)h
Fp(314b)p Fo(i)o(\021)485 b Fp(\(314a\))171 1283 y Fr(every)21
b(f)g(:=)h(!fits)e(do)i(f.x)f(:=)g(unforce\(f.x\))129
1385 y Fp(Uses)12 b Fl(unforce)d Fp(314c.)-29 1468 y(314c)88
b Fo(h)p Fn(*)16 b Fp(308)p Fo(i)o Fv(+)p Fo(\021)1053
b Fm(/)5 b Fp(313)22 b(318a)5 b Fm(.)171 1518 y Fr(procedure)20
b(unforce\(x\))215 1567 y(return)g(if)h(\(type\(x\))g(==)g("Eforce"\))f
(then)h(x.x)g(else)g(x)171 1617 y(end)129 1669 y Fp(De\014nes:)171
1708 y Fl(unforce)p Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(314b)g(and)g
(318a.)129 1748 y(Uses)i Fl(Eforce)e Fp(81.)-33 1839
y(314d)88 b Fo(h)p Fn(print)15 b Fr(fits)f Fn(and)i Fr(conds)d
Fp(314d)p Fo(i)o(\021)788 b Fp(\(314a\))171 1889 y Fr(if)21
b(\(*fits)g(>)g(0\))h(then)f(write\(\\cdebug,)e("Width)h(constraints)g
(for)h(")h(||)f(cons.name\))171 1939 y(write\(\\cdebug,)e(")65
b(")22 b(||)f(expimage\(fits\)\))171 1989 y(write\(\\cdebug,)e
(print_conditions\()o(conds)o(\)\))129 2041 y Fp(Uses)12
b Fl(cdebug)e Fp(18a,)g Fl(constraints)e Fp(136a,)i Fl(expimage)f
Fp(101a,)h(and)h Fl(print_cond)o(iti)o(ons)d Fp(319c.)-29
2132 y(314e)88 b Fo(h)p Fn(print)15 b Fr(test_values)e
Fp(314e)p Fo(i)n(\021)861 b Fp(\(310\))171 2182 y Fr(every)21
b(k)g(:=)h(key\(test_values\))c(do)215 2231 y(write\(\\cdebug,)g
("test_values[",)h(expimage\(k\),)g("])j(=)f(",)h(expimage\(test_va)o
(lues[)o(k]\)\))129 2283 y Fp(Uses)12 b Fl(cdebug)e Fp(18a)g(and)h
Fl(expimage)e Fp(101a.)p eop
%%Page: 315 315
315 314 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(315)-15 258 y Fp(315a)88 b Fo(h)p
Fn(add)16 b(c)n(onstr)n(aints)f(on)g(unc)n(onstr)n(aine)n(d)h(inputs)f
Fp(315a)p Fo(i)n(\021)462 b Fp(\(314a\))187 307 y Fr(every)21
b(i)g(:=)h(inputs_of\(cons\))c(&)k(type\(i.meaning\))c(==)k("null")e
(do)187 357 y({)230 407 y(write\(\\cdebug,)f("adding)i(Efitsu\(")f(||)h
(i.name)g(||)g(",)g("||)h(wordsize)e(||)h("\),)g(")h(||)f
(type\(i.meaning\)\))230 457 y(constrained)f(:=)h(&null)230
507 y(every)g(f)h(:=)f(!fits)g(&)g(string\(f.x\))f(==)h(i.name)g(do)274
557 y(constrained)e(:=)j(1)230 606 y(/constrained)e(&)h(insert\(fits,)f
(Efitsu\(i.name,)e(wordsize\)\))187 656 y(#)43 b(if)22
b(\(string\(i.meani)o(ng\))d(==)i("reloc"\))f(then)h({)187
706 y(#)87 b(if)21 b(\(type\(conds\))e(==)j("integer"\))e(then)h(conds)
f(:=)i(set\(\))187 756 y(#)87 b(insert\(conds,)19 b(eqn\(Emod\(i.name,)
f(4\),)k("=",)e(zerotab\)\))187 806 y(#)43 b(})187 855
y(})145 907 y Fp(Uses)16 b Fl(cdebug)d Fp(18a,)h Fl(Efitsu)f
Fp(81,)i Fl(Emod)f Fp(81,)g Fl(eqn)h Fp(83c,)f Fl(inputs_of)e
Fp(166a,)i Fl(wordsize)f Fp(38c,)187 947 y(and)d Fl(zerotab)g
Fp(308.)145 1017 y Fv(W)m(e)i(insert)h(constrain)o(ts)g(on)f(\014eld)g
(op)q(erands)i(in)o(to)d Fr(fits)h Fv(so)g(w)o(e)g(can)h(generate)g
(test)h(v)n(alues)145 1067 y(for)g(them.)-17 1129 y Fp(315b)88
b Fo(h)p Fn(add)16 b(c)n(onstr)n(aints)f(on)g(\014eld)g(inputs)g
Fp(315b)p Fo(i)o(\021)634 b Fp(\(314a\))187 1179 y Fr(every)21
b(i)g(:=)h(inputs_of\(cons,)c("field"\))i(do)230 1229
y(insert\(fits,)g(Efitsu\(i.name,)f(fwidth\(i.meanin)o(g\)\)\))187
1279 y(every)i(i)g(:=)h(inputs_of\(cons,)c("integer"\))i(do)230
1329 y(insert\(fits,)g(Efitss\(i.name,)f(i.meaning\)\))145
1430 y Fp(Uses)12 b Fl(Efitss)e Fp(81,)g Fl(Efitsu)g
Fp(81,)h Fl(field)f Fp(55,)h Fl(fwidth)e Fp(115d,)h(and)h
Fl(inputs_of)e Fp(166a.)145 1493 y Fv(A)16 b(constructor's)h(pattern)g
(ma)o(y)c(include)j(constrain)o(ts)h(and)e(conditions)g(on)h(its)f(in)o
(teger,)145 1542 y(\014eld,)24 b(and)d(relo)q(catable)h(op)q(erands,)i
(and)e(on)g(the)g(inputs)g(to)f(its)h(constructor-t)o(yp)q(ed)145
1592 y(op)q(erands.)35 b(W)m(e)18 b(can)i(omit)d(the)i(constrain)o(ts)h
(on)f(constructor-t)o(yp)q(ed)i(op)q(erands)f(from)145
1642 y Fr(fits)e Fv(and)f Fr(conds)p Fv(,)h(b)q(ecause)i(these)f
(constrain)o(ts)g(are)g(satis\014ed)f(when)h(test)g(v)n(alues)f(are)145
1692 y(generated)e(for)d(instances)i(of)e(the)i(op)q(erands')f
(constructor)i(t)o(yp)q(es.)-13 1754 y Fp(315c)88 b Fo(h)p
Fn(omit)15 b(c)n(onstr)n(aints)g(and)g(c)n(onditions)h(on)f(c)n
(onstructor-typ)n(e)n(d)g(op)n(er)n(ands)g Fp(315c)p
Fo(i)o(\021)88 b Fp(\(314a\))187 1804 y Fr(tmp)21 b(:=)g(copy\(fits\))
187 1854 y(every)g(f)g(:=)h(!\\fits)e(&)i(\(type\(f.x\))d(==)j
("Einstance_input)o("\))d(do)230 1904 y(delete\(tmp,)h(f\))187
1953 y(fits)h(:=)g(tmp)187 2003 y(tmp)g(:=)g(conds)187
2053 y(every)g(c)g(:=)h(!conds)e(&)i(subterms_matchin)o(g\(c,)c
("Einstance_input"\))g(do)230 2103 y(delete\(tmp,)i(c\))187
2153 y(conds)h(:=)g(tmp)145 2254 y Fp(Uses)12 b Fl(Einstance_)o(inp)o
(ut)c Fp(81)j(and)g Fl(subterms_m)o(atc)o(hin)o(g)e Fp(84a.)p
eop
%%Page: 316 316
316 315 bop 129 141 a Fv(316)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(316a)88
b Fo(h)p Fn(insert)15 b(e)n(quality)g(c)n(onditions)g(in)g
Fr(test_values)d Fp(316a)p Fo(i)o(\021)428 b Fp(\(318c\))171
307 y Fr(every)21 b(c)g(:=)h(!conds)42 b(do)21 b({)215
357 y(if)g(\()p Fo(h)p Fn(e)n(quality)15 b(c)n(ondition)g
Fp(316b)p Fo(i)o Fr(\))21 b(then)g({)258 407 y(verbose\("inserting)d
(test_values[")h(||)j(expimage\(x\))d(||)j("])f(=)h(")f(||)h(v\))258
457 y(test_values[x])d(:=)i(v)215 507 y(})171 557 y(})129
608 y Fp(Uses)12 b Fl(expimage)d Fp(101a)h(and)h Fl(verbose)e
Fp(18a.)-33 700 y(316b)88 b Fo(h)p Fn(e)n(quality)15
b(c)n(ondition)h Fp(316b)p Fo(i)n(\021)865 b Fp(\(316a\))171
750 y Fr(type\(c\))20 b(==)i("eqn")e(&)i(c.op)f(==)g("=")h(&)193
799 y(\(\(v)f(:=)g(integer\(untableexp\()o(c.rig)o(ht\)\))d(&)k(\(not)f
(integer\(c.left\)\))d(&)k(x)g(:=)f(c.left\))f(|)215
849 y(\(v)h(:=)g(integer\(untableexp\()o(c.lef)o(t\)\))40
b(&)22 b(\(not)f(integer\(c.right\)\))d(&)k(x)f(:=)h(c.right\)\))129
901 y Fp(Uses)12 b Fl(eqn)f Fp(83c)g(and)f Fl(untableexp)e
Fp(88a.)192 972 y Fv(The)k(initial)f(set)i(of)e(test)j(v)n(alues)e
(includes)g(equalit)o(y)g(conditions)f(in)h Fr(conds)p
Fv(,)f(e.g.)17 b Fr(rd)22 b(=)129 1021 y(1)p Fv(,)15
b(and)g(equalit)o(y)f(conditions)h(deriv)o(ed)g(from)f(this)h(initial)e
(set,)j(e.g.,)e Fr(rd)21 b(=)h(1,)f(rs)g(=)h(rd)129 1071
y(=>)g(rs)f(=)h(1)p Fv(.)192 1121 y(W)m(e)16 b(try)h(to)g(generate)h
(random)e(test)h(v)n(alues)g(for)g(an)o(y)f(op)q(erand)h(without)g(an)f
(initial)129 1171 y(v)n(alue)j(un)o(til)g(all)f(conditions)h(dep)q
(enden)o(t)j(on)d(the)h(op)q(erand)g(are)g(satis\014ed.)36
b(F)m(or)19 b(most)129 1221 y(op)q(erands,)13 b(w)o(e)f(c)o(ho)q(ose)g
(a)g(random)e(v)n(alue)h(that)h(falls)e(within)h(its)h(\014eld-width)f
(constrain)o(ts.)129 1271 y(If)g(a)g(\014eld)h(op)q(erand,)g(ho)o(w)o
(ev)o(er,)f(is)g(sparsely)h(p)q(opulated,)g(i.e.,)e(a)h(set)h(of)f
(meaningful)e(v)n(alues)129 1320 y(are)15 b(sp)q(eci\014ed)g(b)o(y)f
(the)g(user,)h(w)o(e)f(c)o(ho)q(ose)h(a)e(random)g(v)n(alue)g(from)f
(this)i(set.)-29 1383 y Fp(316c)88 b Fo(h)p Fn(sp)n(arsely)15
b(p)n(opulate)n(d)h Fp(316c)p Fo(i)n(\021)880 b Fp(\(317\))171
1432 y Fr(names)21 b(:=)g(\\fieldname_table\(i)o(.mean)o(ing\))129
1484 y Fp(Uses)12 b Fl(fieldname_t)o(abl)o(e)d Fp(356a.)p
eop
%%Page: 317 317
317 316 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(317)2 258 y Fp(317)89 b Fo(h)p
Fn(gener)n(ate)15 b(input)h(values)f Fp(317)p Fo(i)o(\021)837
b Fp(\(313\))187 307 y Fr(every)21 b(\(i)g(:=)g(inputs_of\(cons\))e(&)
339 357 y(type\(i.meaning\))g(~==)i("constype")f(&)339
407 y(/test_values[i.name)o(]\))f(do)i({)230 457 y(every)g(f)h(:=)f
(!fits)g(&)g(string\(f.x\))f(==)h(i.name)g(do)g({)274
507 y(unsatisfied)e(:=)j(1)274 557 y(count)f(:=)g(0)274
606 y(if)g(\(type\(i.meaning\))e(==)i("field")g(&)g Fo(h)p
Fn(sp)n(arsely)15 b(p)n(opulate)n(d)g Fp(316c)p Fo(i)o
Fr(\))22 b(then)318 656 y(test_values[f.x)o(])d(:=)i(?names)274
706 y(else)318 756 y(test_values[f.x)o(])e(:=)i(random_nbit_value\(f)o
(\))274 806 y(while)g(\(\\unsatisfied)e(&)i(count)g(<)h(TESTLIMIT\))d
(do)j({)318 855 y(verbose\("Try)d(")i(||)h(expimage\(f.x\))d(||)i(")h
(=)f(")h(||)f(expimage\(test_values)o([f.x)o(]\)\))318
905 y Fo(h)p Fn(che)n(ck)15 b(c)n(onditions)g Fp(319b)p
Fo(i)318 955 y Fr(if)21 b(\(\\unsatisfied\))e(then)i({)361
1005 y(slices)g(:=)g(slices_of\(f.x,)e(unsatisfied\))361
1055 y(verbose\("Slices)g(are:)i("\))361 1104 y(every)g
(verbose\(expimage\()o(!slic)o(es\)\))361 1154 y(test_values[f.x])e(:=)
i(interleave_slices)o(\(rand)o(om_nb)o(it_va)o(lue\(f)o(\),)e(slices\))
318 1204 y(})318 1254 y(count)h(+:=)h(1)274 1304 y(})274
1354 y(if)g(\(count)g(==)g(TESTLIMIT\))f(then)h({)318
1403 y(warning\("Checke)o(r)e(can't)i(generate)f(test)h(values)f(for)i
(")f(||)h(i.name)e(||)492 1453 y(print_conditions\()o(unsat)o(isfie)o
(d,)f("not)i(satisfied."\)\))274 1503 y(})230 1553 y(})187
1603 y(})187 1652 y(if)g(\(*test_values)e(>)j(1\))f(then)230
1702 y(write\(\\cdebug,)e("Tests)i(")g(||)274 1752 y(\(if)g
(\(*p.disjuncts)e(>)j(1\))f(then)g(")h(for)f(disjunct:\\n")e(||)j
(expimage\(d\))274 1802 y(else)f(":"\)\))187 1852 y(every)g(i)g(:=)h
(inputs_of\(cons\))c(&)k(\\test_values[i.n)o(ame])c(do)230
1901 y(write\(\\cdebug,)h(expimage\(i.name\))g(||)i(")h(=)f(")h(||)f
(expimage\(test_value)o(s[i.n)o(ame])o(\)\))187 2001
y Fo(h)p Fn(che)n(ck)15 b(c)n(onditions)h Fp(319b)p Fo(i)187
2051 y Fr(if)21 b(\(\\unsatisfied\))e(then)i({)230 2101
y(warning\("Checker)e(can't)i(generate)f(test)h(values)f(for)h
(disjunct:",)405 2151 y("\\n",)f(expimage\(d\),)42 b(print_condition)o
(s\(uns)o(atisf)o(ied,)18 b("not)j(satisfied."\)\))187
2200 y(})187 2250 y(if)g(\(\\unknown\))f(then)h({)230
2300 y(warning\("Test)e(values)i(for)g(disjunct:",)405
2350 y("\\n",)f(expimage\(d\),)405 2400 y(print_conditions)o(\(unkn)o
(own,)e("may)j(not)g(be)h(satisfied)e(by)h(test)g(inputs."\)\))187
2449 y(})145 2499 y Fp(Uses)13 b Fl(cdebug)e Fp(18a,)g
Fl(constype)f Fp(159,)i Fl(disjunct)e Fp(55,)i Fl(expimage)e
Fp(101a,)h Fl(field)g Fp(55,)h Fl(inputs_of)e Fp(166a,)p
eop
%%Page: 318 318
318 317 bop 129 141 a Fv(318)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)171 258 y Fl(interleave)o(_sl)o
(ice)o(s)f Fp(318b,)i Fl(print_condi)o(tio)o(ns)e Fp(319c,)i
Fl(random_nbi)o(t_v)o(al)o(ue)e Fp(320a,)171 297 y Fl(slices_of)d
Fp(318a,)h Fl(TESTLIMIT)e Fp(308,)j(and)f Fl(verbose)g
Fp(18a.)129 368 y Fr(slices_of)i Fv(pro)r(jects)k(conditions)d(dep)q
(enden)o(t)j(on)e(slices)g(of)f Fr(v)p Fv(.)-31 430 y
Fp(318a)88 b Fo(h)p Fn(*)16 b Fp(308)p Fo(i)o Fv(+)p
Fo(\021)1035 b Fm(/)5 b Fp(314c)23 b(318b)t Fm(.)171
480 y Fr(procedure)d(slices_of\(v,)f(conds\))215 530
y(local)h(s)215 579 y(s)h(:=)h(set\(\))215 629 y(every)e(c)i(:=)f
(!conds)g(do)258 679 y(if)h(\(type\(c.left\))d(==)i("Eslice")f(&)i
(\(c.left.x)e(:=)h(unforce\(c.left.x\)\))d(==)j(v\))h(then)302
729 y(insert\(s,eqn\(c.l)o(eft,)c(c.op,)j(integer\(untableexp)o(\(c.ri)
o(ght\)\))o(\)\))258 779 y(else)g(if)g(\(type\(c.right\))e(==)j
("Eslice")e(&)h(\(c.right.x)f(:=)i(unforce\(c.right)o(.x\)\))c(==)k
(v\))f(then)302 828 y(insert\(s,)f(eqn\(c.right,)f(c.op,)i
(integer\(untablee)o(xp\(c.)o(left\))o(\)\)\))215 878
y(return)f(s)171 928 y(end)129 980 y Fp(De\014nes:)171
1019 y Fl(slices_of)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(317.)129
1059 y(Uses)i Fl(eqn)f Fp(83c,)f Fl(Eslice)g Fp(81,)h
Fl(unforce)e Fp(314c,)h(and)h Fl(untableexp)d Fp(88a.)129
1121 y Fv(No)o(w)i(try)g(to)g(in)o(terlea)o(v)o(e)g(the)g(slices,)h
(generating)f(random)f(bits)h(for)f(the)i(unsp)q(eci\014ed)g(parts.)129
1171 y(No)j(c)o(hec)o(king)g(for)g(o)o(v)o(erlapping)f(slices!)18
b(The)d(solv)o(er)f(should)f(do)h(that.)-33 1233 y Fp(318b)88
b Fo(h)p Fn(*)16 b Fp(308)p Fo(i)o Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(318a)22 b(319c)5 b Fm(.)171 1283 y Fr(procedure)20
b(interleave_slices)o(\(resu)o(lt,)f(slices\))215 1333
y(local)h(e,)i(mask)215 1383 y(every)e(e)i(:=)f(!slices)g(&)g(e.op)g
(==)h("=")f(do)g({)258 1432 y(mask)g(:=)g(icom\(ishift\(2^\(e.lef)o
(t.n\)-)o(1,)e(e.left.lo\)\))258 1482 y(result)i(:=)g
(ior\(iand\(result,)e(mask\),)h(ishift\(iand\(e.righ)o(t,)f
(2^\(e.left.n\)-1\),)f(e.left.lo\)\))215 1532 y(})215
1582 y(return)i(result)171 1632 y(end)129 1684 y Fp(De\014nes:)171
1723 y Fl(interleave)o(_sl)o(ice)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(317.)129 1762 y(Uses)i Fl(mask)e Fp(352a.)-29
1845 y(318c)88 b Fo(h)p Fn(cr)n(e)n(ate)15 b(initial)f(set)h(of)f
Fr(test_values)f Fp(318c)p Fo(i)o(\021)608 b Fp(\(313\))171
1895 y Fr(every)21 b(i)g(:=)h(inputs_of\(cons,)c("string"\))i(&)302
1945 y(i.meaning)g(==)h("reloc")f(&)i(test_values[i.nam)o(e])d(:=)i
("reloc")171 1995 y(n_tests)f(:=)i(0)171 2045 y Fo(h)p
Fn(insert)14 b(e)n(quality)h(c)n(onditions)g(in)g Fr(test_values)e
Fp(316a)p Fo(i)171 2095 y Fr(while)21 b(\(*test_values)e(>)i(n_tests\))
g(do)g({)215 2144 y(n_tests)f(:=)h(*test_values)215 2194
y Fo(h)p Fn(simplify)14 b(c)n(onditions)h Fp(319a)p Fo(i)215
2244 y(h)p Fn(insert)f(e)n(quality)h(c)n(onditions)g(in)g
Fr(test_values)e Fp(316a)p Fo(i)171 2294 y Fr(})129 2346
y Fp(Uses)f Fl(inputs_of)d Fp(166a.)p eop
%%Page: 319 319
319 318 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(319)-15 258 y Fp(319a)88 b Fo(h)p
Fn(simplify)14 b(c)n(onditions)i Fp(319a)p Fo(i)n(\021)847
b Fp(\(318c\))187 307 y Fr(new_conds)20 b(:=)h(set\(\))187
357 y(every)g(insert\(new_cond)o(s,)e(\(simplify_conditi)o(ons\()o
(conds)o(,)g(test_values\)\)[2]\))187 407 y(conds)i(:=)g(new_conds)145
509 y Fp(Uses)12 b Fl(simplify_c)o(ond)o(iti)o(ons)c
Fp(320b.)145 579 y Fv(Simplifying)k(conditions)i(can)i(pro)q(duce)g
(satis\014ed)g(conditions,)e(unsatis\014ed)i(conditions,)145
629 y(or)e(conditions)g(with)f(unkno)o(wn)h(satis\014abilit)o(y)m(.)-17
691 y Fp(319b)88 b Fo(h)p Fn(che)n(ck)16 b(c)n(onditions)f
Fp(319b)p Fo(i)o(\021)906 b Fp(\(317\))187 741 y Fr(unsatisfied)19
b(:=)j(&null)187 791 y(unknown)e(:=)i(&null)187 841 y(every)f(l)g(:=)h
(simplify_condit)o(ions\()o(conds)o(,)d(test_values\))g(do)j({)230
891 y(c)g(:=)f(l[1])230 941 y(newc)g(:=)h(l[2])230 990
y(if)g(\(type\(newc\))d(==)j("eqn"\))e(then)h({)274 1040
y(if)g(\(reduceable\(newc\)\))d(then)318 1090 y(/unknown)i(:=)h([c])g
(|)h(push\(unknown,)d(c\))274 1140 y(else)i(if)g(\(not)g
(tautology\(newc\)\))e(then)318 1190 y(/unsatisfied)g(:=)i([c])g(|)h
(push\(unsatisfied,)c(c\))230 1239 y(})187 1289 y(})145
1341 y Fp(Uses)12 b Fl(eqn)f Fp(83c,)f Fl(reduceable)e
Fp(321,)j Fl(simplify_c)o(ond)o(iti)o(on)o(s)e Fp(320b,)h(and)h
Fl(tautology)d Fp(321.)-13 1424 y(319c)88 b Fo(h)p Fn(*)15
b Fp(308)p Fo(i)p Fv(+)p Fo(\021)1033 b Fm(/)5 b Fp(318b)22
b(320a)5 b Fm(.)187 1474 y Fr(procedure)20 b(print_conditions)o(\(cond)
o(s,)f(msg\))230 1524 y(local)i(l)230 1574 y(l)h(:=)f([])230
1623 y(\(*conds)g(==)g(0\))g(&)44 b(return)20 b("")230
1673 y(every)h(put\(l,)g(expimage\(!conds\))o(\))230
1723 y(return)43 b("Conditions)19 b(")j(||)f(\(\\msg)g(|)h(")f("\))h
(||)f(":")43 b(||)21 b(")87 b(")22 b(||)f(commaseparate\(l\))187
1823 y(end)145 1875 y Fp(De\014nes:)187 1914 y Fl(print_cond)o(iti)o
(on)o(s)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(314d)g(and)h(317.)145
1953 y(Uses)h Fl(expimage)d Fp(101a.)p eop
%%Page: 320 320
320 319 bop 129 141 a Fv(320)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y Fr(random_nbit_valu)o
(e)j Fv(pro)q(duces)k(a)f(random)e(v)n(alue)h(in)g(the)i(range)f(0)p
Fi(:::)p Fv(2)1395 243 y Fg(n)1428 258 y Fo(\000)12 b
Fv(1)19 b(for)129 307 y(unsigned,)j Fi(n)p Fv(-bit)e(v)n(alues)g(and)g
(v)n(alues)g(in)g(the)h(range)f Fo(\000)p Fv(2)1084 292
y Ff(\()1099 307 y Fi(n)14 b Fo(\000)f Fv(1\))p Fi(:::)p
Fv(2)1277 292 y Ff(\()1291 307 y Fi(n)g Fo(\000)h Fv(1\))f
Fo(\000)h Fv(1)20 b(for)129 357 y(signed,)14 b Fi(n)p
Fv(-bit)f(v)n(alues.)-31 420 y Fp(320a)88 b Fo(h)p Fn(*)16
b Fp(308)p Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(319c)23
b(320b)t Fm(.)171 469 y Fr(procedure)d(random_nbit_value)o(\(f\))215
519 y(local)g(v)215 569 y(return)g(case)h(type\(f\))f(of)i({)258
619 y("Efitsu":)e(?\(2^\(f.n\)-1\))258 669 y("Efitss":)g({)i(v)f(:=)h
(?\(2^\(f.n-1\)\))520 718 y(if)f(\(?2)g(=)h(1\))f(then)43
b(-v)520 768 y(else)21 b(if)g(\(v)g(=)h(2^\(f.n-1\)\))e(then)h(v)g(-)h
(1)520 818 y(else)f(v)476 868 y(})258 918 y(default)f(:)i
(error\("Invalid)d(field-width)g(constraint:)h(",)h(expimage\(f\)\))215
967 y(})171 1017 y(end)129 1069 y Fp(De\014nes:)171 1109
y Fl(random_nbi)o(t_v)o(alu)o(e)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f
(317.)129 1148 y(Uses)i Fl(constraint)c Fp(55,)j Fl(Efitss)f
Fp(81,)h Fl(Efitsu)e Fp(81,)i Fl(expimage)e Fp(101a,)h(and)h
Fl(field)f Fp(55.)192 1210 y Fr(simplify_conditi)o(ons)j
Fv(simpli\014es)j(eac)o(h)h(condition)f(in)g(a)h(set)g(of)f(conditions)
h(and)129 1260 y(then)e(susp)q(ends)h(a)d(list)h(pair)f(whic)o(h)h(con)
o(tains)g(the)g(original)e(and)i(new)g(condition.)-33
1322 y Fp(320b)88 b Fo(h)p Fn(*)16 b Fp(308)p Fo(i)o
Fv(+)p Fo(\021)1053 b Fm(/)5 b Fp(320a)22 b(321)5 b Fm(.)171
1372 y Fr(procedure)20 b(simplify_conditio)o(ns\(co)o(nditi)o(ons,)e
(values\))215 1422 y(local)i(c,)i(cp)215 1472 y(every)e(c)i(:=)f
(!\\conditions)f(do)h({)171 1522 y(#)87 b(write\("==>)20
b(")h(||)h(image\(type\(c\)\))d(||)i(",")g(||)g(expimage\(c\)\))258
1571 y(cp)h(:=)f(simplify\(subst_ta)o(b\(c,)d(values\)\))171
1621 y(#)87 b(write\("<==)20 b(")h(||)h(image\(type\(cp\)\))c(||)k(",")
f(||)g(expimage\(cp\)\))258 1671 y(suspend)f([c,)i(cp])215
1721 y(})171 1771 y(end)129 1823 y Fp(De\014nes:)171
1862 y Fl(simplify_c)o(ond)o(iti)o(ons)o Fp(,)9 b(used)h(in)h(c)o(h)o
(unk)f(319.)129 1901 y(Uses)i Fl(expimage)d Fp(101a,)h
Fl(simplify)f Fp(92a,)i(and)f Fl(subst_tab)f Fp(89a.)p
eop
%%Page: 321 321
321 320 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(321)145 258 y(An)14 b(equation)g(is)g
(reduceable)h(if)e(it)g(con)o(tains)h(a)g(v)n(ariable)f(expression.)2
320 y Fp(321)89 b Fo(h)p Fn(*)15 b Fp(308)p Fo(i)p Fv(+)p
Fo(\021)1150 b Fm(/)6 b Fp(320b)187 370 y Fr(procedure)20
b(reduceable\(c\))230 420 y(return)h(not)g(integer\(untableexp)o
(\(c.le)o(ft\)\))d(|)k(not)f(integer\(untableexp)o(\(c.ri)o(ght\))o(\))
187 469 y(end)187 519 y(procedure)f(tautology\(c\))230
569 y(local)h(l,r)230 619 y(if)h(\(l)f(:=)h(integer\(untable)o(exp\(c)o
(.left)o(\)\))d(&)318 669 y(r)i(:=)h(integer\(untable)o(exp\(c)o(.righ)
o(t\)\)\))c(then)274 718 y(return)j(case)f(c.op)h(of)h({)318
768 y("=")43 b(:)21 b(l)h(=)f(r)318 818 y(">=")g(:)g(l)h(>=)f(r)318
868 y("<=")g(:)g(l)h(<=)f(r)318 918 y("!=")g(:)g(l)h(~=)f(r)318
967 y("<")43 b(:)21 b(l)h(>)f(r)318 1017 y(">")43 b(:)21
b(l)h(<)f(r)274 1067 y(default:)f(error\("Invalid)f(operator)h(")i(||)f
(c.op\))274 1117 y(})230 1167 y(return)187 1217 y(end)145
1268 y Fp(De\014nes:)187 1308 y Fl(reduceable)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)d(319b.)187 1347 y Fl(tautology)p
Fp(,)f(used)j(in)g(c)o(h)o(unk)f(319b.)145 1387 y(Uses)i
Fl(untableexp)c Fp(88a.)p eop
%%Page: 322 322
322 321 bop 129 141 a Fv(322)83 b Fr(checker.nw)721 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-13 258 y Fp(322)88
b Fo(h)p Fn(che)n(cker.t)15 b Fp(322)p Fo(i)o(\021)171
307 y Fr(#include)20 b(<mclib.h>)171 357 y(#include)g(\045interface)171
407 y(#include)g(<stdio.h>)171 457 y(#include)g(<stdarg.h>)171
507 y(extern)h(struct)f(\045{irname}_asm)f(*\045{irname}_asm;)171
557 y(extern)i(struct)f(\045{irname}_asm)f(*\045{irname}_bin;)171
606 y(static)i(void)f(checkerfail\(char)f(*,)i(...\);)171
656 y(static)g(void)f(reloc_print\(RAddr)f(r\);)171 756
y(static)i(void)f(reloc_print\(RAddr)f(r\))i({$t)171
806 y(assert\(location_k)o(nown\()o(r\)\);)171 855 y
(asmprintf\(asmprin)o(tfd,)d("\045\045s",)j(r->label->name\);)171
905 y(/*)g(asmprintf\(asmprintf)o(d,)e("0x\045\04508x",)h
(location\(r\)\);)f(*/$b)171 955 y(})171 1005 y(static)i(void)f
(checkerfail\(char)f(*fmt,)i(...\))g({$t)171 1055 y(va_list)f(ap;)171
1154 y(va_start\(ap,)f(fmt\);)171 1204 y(fprintf\(stderr,)g("Error)h
(in)i(checker:)e("\);)171 1254 y(vfprintf\(stderr,)e(fmt,)j(ap\);)171
1304 y(fprintf\(stderr,)e("\\n"\);)171 1354 y(va_end\(ap\);)171
1403 y(exit\(1\);)171 1453 y($b}$n)171 1503 y(void)43
b(*mc_alloc\(int)19 b(size,)i(Mc_alloc_pool)e(pool\))h({$t)171
1553 y(char)h(*p)g(=)h(\(char)f(*\)malloc\(size\);)171
1603 y(return)g(\(void)f(*\)p;)171 1652 y($b}$n)171 1702
y(RClosure)g(mc_alloc_closure\(s)o(ize_i)o(n_byt)o(es,)e(dest_block,)i
(dest_lc\))171 1752 y(unsigned)g(size_in_bytes;)f(RBlock)i(dest_block;)
e(unsigned)h(dest_lc;)g({$t)171 1802 y(RClosure)g(cl;)171
1852 y(checkerfail\("atte)o(mpt)f(to)i(call)g(mc_alloc_closure!)o("\);)
171 1901 y(return)g(cl;)171 1951 y($b}$n)171 2001 y(main\(\){$t)171
2051 y(RBlock)g(rb;)171 2101 y(RAddr)43 b(reloc;)171
2151 y(fail)21 b(=)h(&checkerfail;)171 2200 y(asmprintreloc)d(=)j
(&reloc_print;)171 2250 y(rb)f(=)h(block_new\(0\);)171
2300 y(block_label\(rb\)->)o(name)c(=)k("reloc";)171
2350 y(set_block\(rb\);)171 2400 y(set_address\(rb,)d
(\(unsigned\)CHKRAD)o(DR\);)171 2449 y(reloc)i(=)g
(addr_new\(block_labe)o(l\(rb\))o(,)e(0x0\);)p eop
%%Page: 323 323
323 322 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)722
b Fr(checker.nw)81 b Fv(323)187 258 y Fr(printf\(".text\\n")o(\);)187
307 y(printf\(".globl)19 b(reloc\\n"\);)187 357 y(printf\(".globl)g
(main\\n"\);)187 407 y(printf\(".globl)g(_main\\n"\);)187
457 y(printf\("reloc:\\n)o("\);)187 507 y(printf\("main:\\n")o(\);)187
557 y(printf\("_main:\\n)o("\);)145 658 y Fp(Uses)12
b Fl(addr_new)p Fp(,)e Fl(asmprintf)f Fp(409a,)h Fl(asmprintfd)f
Fp(409a,)h Fl(asmprintrel)o(oc)f Fp(409a,)h Fl(block_label)f
Fp(399a,)187 698 y Fl(block_new)j Fp(398d,)i Fl(fail)g
Fp(410,)g Fl(label)f Fp(383a,)h Fl(location)p Fp(,)f
Fl(location_)o(kno)o(wn)p Fp(,)f Fl(main)i Fp(20,)187
737 y Fl(mc_alloc_c)o(los)o(ur)o(e)p Fp(,)c Fl(Mc_alloc_p)o(ool)o
Fp(,)g Fl(RAddr)h Fp(411a,)g Fl(RBlock)p Fp(,)g Fl(RClosure)p
Fp(,)f Fl(set_addres)o(s)g Fp(399g,)187 777 y(and)g Fl(set_block)f
Fp(385b.)-15 868 y(323a)88 b Fo(h)p Fn(inche)n(cker.t)15
b Fp(323a)p Fo(i)o(\021)187 918 y Fr(printf\(".text\\n")o(\);)187
967 y(printf\(".globl)k(_asmoutput\\n"\);)187 1017 y(printf\("_asmoutp)
o(ut:\\n)o("\);)-17 1158 y Fp(323b)88 b Fo(h)p Fn(after)n(che)n(cker.t)
14 b Fp(323b)p Fo(i)o(\021)187 1208 y Fr(printf\(".text\\n")o(\);)187
1258 y(printf\(".globl)19 b(_endoutput\\n"\);)187 1308
y(printf\("_endoutp)o(ut:\\n)o("\);)187 1358 y(exit\(0\);)p
eop
%%Page: 324 324
324 323 bop 129 141 a Fv(324)83 b Fr(Cexp.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)p eop
%%Page: 325 325
325 324 bop 145 569 a Fq(Chapter)32 b(17)145 777 y Fu(Con)m(v)m(erting)
39 b(Expressions)g(to)145 901 y(C)145 1117 y Fr(prettyC)13
b Fv(returns)j(C)f(co)q(de)g(for)f(an)h(expression)h(\(or)e(statemen)o
(t\))h(with)f(em)o(b)q(edded)h(pret-)145 1167 y(t)o(yprin)o(ting)g
(escap)q(es.)26 b Fr(nohex)14 b Fv(is)i(a)f(purely)h(in)o(ternal)g
(\015ag.)23 b(If)15 b(it)g(is)h(non-n)o(ull,)e(constan)o(ts)145
1217 y(are)h(in)e(hex;)h(otherwise)h(they're)f(in)g(decimal.)2
1279 y Fp(325)89 b Fo(h)p Fn(*)15 b Fp(325)p Fo(i\021)1191
b Fp(329f)5 b Fm(.)187 1329 y Fr(procedure)20 b(prettyC\(e,)f
(precedence,)h(associativity,)f(nohex\))230 1378 y Fo(h)p
Fn(lo)n(c)n(al)c(de)n(clar)n(ations)f(for)h Fr(prettyC)e
Fp(327b)p Fo(i)230 1428 y Fr(initial)21 b({)p Fo(h)p
Fn(initialize)13 b Fr(Cprec)h Fn(and)i Fr(Cassoc)e Fp(336a)p
Fo(i)n Fr(})230 1478 y(/precedence)20 b(:=)h(0)230 1528
y(/associativity)e(:=)j("L")230 1578 y(return)f(case)g(type\(e\))f(of)i
({)274 1628 y Fo(h)p Fn(c)n(ases)15 b(for)f Fr(prettyC)g
Fp(326a)p Fo(i)274 1677 y Fr(default)86 b(:)21 b(impossible\("Bad)e
(code)i(to)g(prettyC"\))230 1727 y(})187 1777 y(end)145
1829 y Fp(De\014nes:)187 1868 y Fl(prettyC)p Fp(,)9 b(used)h(in)i(c)o
(h)o(unks)d(19a,)i(326{35,)e(and)i(338a.)830 2604 y Fv(325)p
eop
%%Page: 326 326
326 325 bop 129 141 a Fv(326)83 b Fr(Cexp.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(326a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o(\021)762 b Fp(\(325\))21
b(327c)5 b Fm(.)171 307 y Fr("list")108 b(:)21 b(commaseparate\(mapli)o
(st2\(p)o(rett)o(yC,)e(e,)i(Cprec[","]\),)e(",)j($o"\))171
357 y("set")130 b(:)21 b(commaseparate\(mapli)o(st2\(p)o(rett)o(yC,)e
(sort\(e\),)h(Cprec["&&"]\),)f(")i(&&)h($o"\))171 407
y("eqn")130 b(:)21 b({)h(o)f(:=)h(Cop\(e.op\))498 457
y(Cbracket\(prettyC\()o(e.lef)o(t,)40 b(Cprec[o]\))20
b(||)i(")f(")h(||)f(o)h(||)f(")h($o")f(||)694 507 y(prettyC\(e.right,)d
(Cprec[o]\),)i("==",)h(precedence\))454 557 y(})171 606
y("table")86 b(:)21 b({)480 b(#)21 b(standard)f(normal)h(form)258
656 y Fo(h)p Fn(make)15 b Fr(s)g Fn(r)n(epr)n(esent)f(table)h
Fr(e)p Fn(,)f(but)h(elide)g(additive)g(and)h(multiplic)n(ative)d(units)
i Fp(326b)p Fo(i)258 706 y Fr("$t${")21 b(||)g(s)h(||)f("$}$b")215
756 y(})171 806 y("string")64 b(:)21 b(e)171 855 y("literal")42
b(:)21 b(list_to_string\(e.s\))171 905 y("integer")42
b(:)21 b(if)h(e)f(>)h(max_decimal)d(then)i("0x")g(||)h(hexstring\(e\))d
(else)i(string\(e\))129 957 y Fp(Uses)15 b Fl(Cbracket)c
Fp(335c,)i Fl(Cop)g Fp(336b,)g Fl(Cprec)f Fp(335c,)h
Fl(eqn)g Fp(83c,)g Fl(hexstring)e Fp(337b,)i Fl(literal)f
Fp(45e,)171 996 y Fl(max_decima)o(l)d Fp(15d,)h(and)h
Fl(prettyC)e Fp(325.)129 1066 y Fv(The)18 b(old)f(v)o(ersion)g(prin)o
(ted)g(in)g(an)o(y)g(old)f(order,)i(but)g(the)g(new)f(v)o(ersion)g
(prin)o(ts)h(p)q(ositiv)o(e)129 1116 y(terms)c(\014rst,)g(then)h
(negativ)o(e)f(terms,)f(with)g(the)i(constan)o(t)f(term)g(last)f(in)h
(its)f(group.)-1879 b Fk(\031Change)13 b(#23)-33 1177
y Fp(326b)88 b Fo(h)p Fn(make)16 b Fr(s)e Fn(r)n(epr)n(esent)h(table)f
Fr(e)p Fn(,)h(but)g(elide)f(additive)h(and)h(multiplic)n(ative)e(units)
g Fp(326b)p Fo(i)o(\021)88 b Fp(\(326a\))171 1227 y Fr({)215
1277 y(s)21 b(:=)h("";)f(leadingsign)e(:=)j("")215 1327
y Fo(h)p Fn(add)15 b(p)n(ositive)g(terms)f(to)h Fr(s)f
Fp(326c)p Fo(i)215 1377 y Fr(leadingsign)19 b(:=)i(")h(-)g($o")215
1426 y Fo(h)p Fn(add)15 b(ne)n(gative)g(terms)g(to)f
Fr(s)h Fp(326d)p Fo(i)215 1476 y Fr(s)21 b(:=)h(if)f(s)g(==)h("")f
(then)g("0")g(else)g(Cbracket\(s,)f("+",)h(precedence\))171
1526 y(})129 1578 y Fp(Uses)12 b Fl(Cbracket)d Fp(335c.)-29
1659 y(326c)88 b Fo(h)p Fn(add)16 b(p)n(ositive)f(terms)f(to)h
Fr(s)f Fp(326c)p Fo(i)o(\021)769 b Fp(\(326b\))171 1709
y Fr(every)21 b(e[k)g(:=)g(1)h(~===)f(key\(e\)])f(>)i(0)f(do)h({)258
1759 y(s)g(||:=)f(leadingsign)258 1809 y(s)h(||:=)f(\(1)g(~=)g
(abs\(e[k]\)\))f(||)i("*")86 b(#)22 b(print)e(coefficient)g(if)h(not)h
(1)258 1858 y(s)g(||:=)f(prettyC\(k,)e(Cprec["*"]\))258
1908 y(leadingsign)h(:=)h(")h(+)f($o")171 1958 y(})171
2008 y(if)g(e[1])g(>)h(0)f(then)g(s)h(||:=)f(leadingsign)f(||)h
(string\(e[1]\))129 2059 y Fp(Uses)12 b Fl(Cprec)e Fp(335c)h(and)f
Fl(prettyC)f Fp(325.)-33 2149 y(326d)88 b Fo(h)p Fn(add)16
b(ne)n(gative)f(terms)f(to)h Fr(s)g Fp(326d)p Fo(i)o(\021)754
b Fp(\(326b\))171 2199 y Fr(every)21 b(e[k)g(:=)g(1)h(~===)f(key\(e\)])
f(<)i(0)f(do)h({)258 2249 y(s)g(||:=)f(leadingsign)258
2298 y(s)h(||:=)f(\(1)g(~=)g(abs\(e[k]\)\))f(||)i("*")86
b(#)22 b(print)e(coefficient)g(if)h(not)h(1)258 2348
y(s)g(||:=)f(prettyC\(k,)e(Cprec["*"]\))171 2398 y(})171
2448 y(if)i(e[1])g(<)h(0)f(then)g(s)h(||:=)f(leadingsign)f(||)h
(string\(-e[1]\))129 2499 y Fp(Uses)12 b Fl(Cprec)e Fp(335c)h(and)f
Fl(prettyC)f Fp(325.)p eop
%%Page: 327 327
327 326 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(Cexp.nw)81 b Fv(327)-15 258 y Fp(327a)88 b Fo(h)p
Fn(old)15 b(make)h Fr(s)e Fn(r)n(epr)n(esent)g(table)h
Fr(e)p Fn(,)f(but)h(elide)g(additive)g(and)h(multiplic)n(ative)d(units)
i Fp(327a)p Fo(i)o(\021)187 307 y Fr({)230 357 y(#)22
b(print)f(constant)f(term)h(if)g(nonzero)230 407 y(if)h(e[1])f(~=)g(0)h
(then)f({)g(s)h(:=)f(string\(e[1]\))f(;)h(leadingsign)f(:=)h(")h(+)f
($o")g(})230 457 y(else)g(s)h(:=)f(leadingsign)f(:=)h("")230
507 y(#)h(print)f(every)f(nonconstant)g(term)h(k)230
557 y(every)g(k)h(:=)f(1)h(~===)f(key\(e\))f(do)i({)318
606 y(s)f(||:=)g(if)g(e[k])g(<)h(0)g(then)f(")g(-)h(")f(else)g
(leadingsign)318 656 y(leadingsign)e(:=)i(")h(+)g($o")318
706 y(s)f(||:=)g(\(1)g(~=)h(abs\(e[k]\)\))e(||)h("*")87
b(#)21 b(print)g(coefficient)e(if)j(not)f(1)318 756 y(s)g(||:=)g
(prettyC\(k,)f(Cprec["*"]\))230 806 y(})230 855 y(s)i(:=)f(if)h(s)f(==)
h("")f(then)g("0")g(else)g(Cbracket\(s,)f("+",)h(precedence\))187
905 y(})145 954 y Fp(Uses)12 b Fl(Cbracket)d Fp(335c,)h
Fl(constant)f Fp(114b,)h Fl(Cprec)g Fp(335c,)g(and)h
Fl(prettyC)e Fp(325.)-17 1035 y(327b)88 b Fo(h)p Fn(lo)n(c)n(al)15
b(de)n(clar)n(ations)f(for)h Fr(prettyC)e Fp(327b)p Fo(i)o(\021)543
b Fp(\(325\))22 b(329c)5 b Fm(.)187 1085 y Fr(local)21
b(leadingsign)-13 1165 y Fp(327c)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)608
b Fp(\(325\))22 b Fm(/)5 b Fp(326a)22 b(327d)5 b Fm(.)187
1215 y Fr("Eorb")108 b(:)21 b({)h(s)f(:=)h(prettyC\(e.x,)d(Cprec["|"],)
g("L"\))514 1265 y(t)i(:=)h(prettyC\(e.y,)d(Cprec["|"],)g("R"\))514
1315 y(Cbracket\(s)g(||)j(")f(|)h($o")f(||)h(t,)f("|",)g(precedence\))
470 1365 y(})187 1414 y("Eand")108 b(:)21 b({)h(s)f(:=)h(prettyC\(e.x,)
d(Cprec["&&"],)g("L"\))514 1464 y(t)i(:=)h(prettyC\(e.y,)d
(Cprec["&&"],)g("R"\))514 1514 y(Cbracket\(s)g(||)j(")f(&&)h($o")f(||)g
(t,)h("&&",)e(precedence\))470 1564 y(})145 1613 y Fp(Uses)12
b Fl(Cbracket)d Fp(335c,)h Fl(Cprec)g Fp(335c,)g Fl(Eand)h
Fp(81,)f Fl(Eorb)h Fp(81,)g(and)f Fl(prettyC)f Fp(325.)-17
1694 y(327d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f
Fp(326a)p Fo(i)o Fv(+)p Fo(\021)614 b Fp(\(325\))22 b
Fm(/)5 b Fp(327c)22 b(327e)5 b Fm(.)187 1743 y Fr("Eslice")64
b(:)21 b({)h(s)f(:=)h(prettyC\(super_si)o(mplif)o(y\(Es)o(hift\()o
(e.x,)c(-e.lo\)\),)j(Cprec["&"],)e("L"\))514 1793 y(Cbracket\(s)g(||)j
(")f(&)h(")g(||)f(mask\(e.n\),)f("&",)h(precedence\))470
1843 y(})187 1893 y("Eshift")64 b(:)21 b({)h(s)f(:=)h(prettyC\(e.x,)d
(Cprec["<<"]\))514 1943 y(s)i(||:=)g(if)h(e.n)f(<)g(0)h(then)f(\(")g
(>>)h(")f(||)h(-e.n\))666 1992 y(else)261 b(\(")21 b(<<)h(")f(||)43
b(e.n\))514 2042 y(Cbracket\(s,)19 b("<<",)i(precedence\))470
2092 y(})145 2141 y Fp(Uses)15 b Fl(Cbracket)d Fp(335c,)h
Fl(Cprec)g Fp(335c,)h Fl(Eshift)e Fp(81,)i Fl(Eslice)f
Fp(81,)h Fl(mask)g Fp(352a,)f Fl(prettyC)f Fp(325,)187
2181 y(and)e Fl(super_simpl)o(ify)e Fp(92c.)-13 2261
y(327e)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f
Fp(326a)p Fo(i)o Fv(+)p Fo(\021)608 b Fp(\(325\))22 b
Fm(/)5 b Fp(327d)22 b(328a)5 b Fm(.)187 2311 y Fr("Enarrowu")20
b(:)h(prettyC\(e.x,)e(precedence,)h(associativity\))f(#)i(checked,)g
(so)g(must)g(be)g(identity)187 2361 y("Enarrows")f(:)h
(prettyC\(super_simp)o(lify\()o(Eslic)o(e\(e.)o(x,)e(0,)i(e.n\)\),)g
(precedence,)e(associativity\))187 2411 y("Ewiden")64
b(:)21 b("sign_extend\($t${$)o(o")e(||)i(prettyC\(e.x\))e(||)j(",)f
($o")g(||)h(e.n)f(||)g("$}$b\)")145 2460 y Fp(Uses)15
b Fl(Enarrows)c Fp(81,)j Fl(Enarrowu)e Fp(81,)h Fl(Eslice)f
Fp(81,)i Fl(Ewiden)e Fp(81,)i Fl(prettyC)e Fp(325,)h
Fl(sign_exten)o(d)p Fp(,)187 2499 y(and)d Fl(super_simpl)o(ify)e
Fp(92c.)p eop
%%Page: 328 328
328 327 bop 129 141 a Fv(328)83 b Fr(Cexp.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(328a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)610
b Fp(\(325\))22 b Fm(/)5 b Fp(327e)23 b(328b)t Fm(.)171
307 y Fr("Ediv")108 b(:)21 b({)h(s)f(:=)h(prettyC\(e.x,)d(Cprec["/"]\))
498 357 y(s)i(:=)h("\(\(int\)")e(||)h(s)h(||)f("\)")65
b(#)22 b(temporary)e(hack)h(to)g(fix)g(a)h(bug)498 407
y(s)f(||:=)g(")h(/)g(")f(||)h(e.n)498 457 y(Cbracket\(s,)d("/",)i
(precedence\))454 507 y(})171 557 y("Emod")108 b(:)21
b({)h(s)f(:=)h(prettyC\(e.x,)d(Cprec["\045"]\))498 606
y(s)i(||:=)g(")h(\045)g(")f(||)h(e.n)498 656 y(Cbracket\(s,)d("\045",)i
(precedence\))454 706 y(})129 758 y Fp(Uses)12 b Fl(Cbracket)d
Fp(335c,)h Fl(Cprec)g Fp(335c,)g Fl(Ediv)h Fp(81,)g Fl(Emod)f
Fp(81,)h(and)f Fl(prettyC)g Fp(325.)192 828 y Fv(Ha)o(v)o(e)j(to)h(b)q
(e)h(careful)f(emitting)e(no)h(tok)o(ens.)-1306 b Fk(\031Change)13
b(#35)-33 891 y Fp(328b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)608 b Fp(\(325\))22
b Fm(/)5 b Fp(328a)23 b(329d)t Fm(.)171 941 y Fr("Semit")86
b(:)215 990 y(if)21 b(*e.x)g(=)g(0)h(then)f("{/*emit)f(epsilon*/}")g
(else)h({)258 1040 y(s)h(:=)f(if)g(*e.x)g(>)h(1)g(then)f("$t${{)f($c")h
(else)g("")258 1090 y Fo(h)p Fn(if)15 b(dir)n(e)n(ct)f(style)g(and)i
(late)e(p)n(c,)h(add)h Fr(ENCODE_pc)d Fn(de)n(clar)n(ation)h(to)h
Fr(s)g Fn(and)g(set)g Fr(pc_override)e Fp(329a)p Fo(i)258
1140 y Fr(s)22 b(||:=)f(commaseparate\(ma)o(plist)o(\(pret)o(tyC,)d
(e.x\),)j(")h($c"\))258 1190 y Fo(h)p Fn(r)n(estor)n(e)14
b Fr(pc_override)f Fp(329b)p Fo(i)258 1239 y Fr(s)22
b(||)f(if)g(*e.x)g(>)h(1)g(then)f(")g($b$c}$}")f(else)h("")215
1289 y(})171 1339 y("Stoken")f(:)215 1389 y(case)h(emitterstyle)e(of)i
({)258 1439 y("direct")f(:)i({)p Fo(h)p Fn(dir)n(e)n(ct)14
b(c)n(al)r(l)g(thr)n(ough)h Fr(emittername)e Fp(328c)p
Fo(i)o Fr(})258 1488 y("closure":)20 b({)p Fo(h)p Fn(closur)n(e)14
b(c)n(al)r(l)h(to)g Fr(emitter)e Fp(328d)p Fo(i)o Fr(})215
1538 y(})21 b(|)h(impossible\("emit)o(ter)d(style"\))129
1590 y Fp(Uses)12 b Fl(emitterstyl)o(e)d Fp(19b,)h Fl(epsilon)f
Fp(62b,)i Fl(prettyC)e Fp(325,)i Fl(Semit)f Fp(81,)g(and)h
Fl(Stoken)f Fp(81.)-29 1673 y(328c)88 b Fo(h)p Fn(dir)n(e)n(ct)15
b(c)n(al)r(l)f(thr)n(ough)h Fr(emittername)e Fp(328c)p
Fo(i)n(\021)606 b Fp(\(328b\))171 1723 y Fr(s)22 b(:=)f(emittername)e
(||)j("$t\(")f(||)g(prettyC\(e.x,)e(Cprec[","]\))h(||)h(",)h($o")f(||)g
(e.n)g(||)h("\)")171 1773 y(Cbracket\("$c")d(||)i(s,)h("app",)e
(precedence\))g(||)h(";$b")129 1825 y Fp(Uses)12 b Fl(Cbracket)d
Fp(335c,)h Fl(Cprec)g Fp(335c,)g Fl(emittername)e Fp(18a,)j(and)f
Fl(prettyC)g Fp(325.)192 1895 y Fv(F)m(or)16 b(the)h(closure)h(call,)e
(w)o(e)h(assume)f(that)h(the)h(closure)f(is)g(stored)g(in)g(lo)q(cal)f
(v)n(ariable)129 1945 y Fr(_c)p Fv(.)-33 2007 y Fp(328d)88
b Fo(h)p Fn(closur)n(e)15 b(c)n(al)r(l)f(to)h Fr(emitter)f
Fp(328d)p Fo(i)n(\021)763 b Fp(\(328b\))171 2057 y Fr(o)22
b(:=)f(if)g(e.offset)f(>)i(0)g(then)f(")g(+)h(")f(||)h(e.offset)e(else)
h("")171 2107 y(s)h(:=)f("emitter$t\(_c->lo)o(c.des)o(t_blo)o(ck,)e
($o_c->loc.dest_)o(lc")g(||)i(o)h(||)f(",)g($o")g(||)280
2157 y(prettyC\(e.x,)e(Cprec[","]\))h(||)h(",)h($o")f(||)g(e.n)g(||)h
("\)")171 2207 y(Cbracket\("$c")d(||)i(s,)h("app",)e(precedence\))g(||)
h(";$b")129 2258 y Fp(Uses)12 b Fl(Cbracket)d Fp(335c,)h
Fl(Cprec)g Fp(335c,)g(and)h Fl(prettyC)e Fp(325.)p eop
%%Page: 329 329
329 328 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(Cexp.nw)81 b Fv(329)208 258 y(This)10 b(co)q(de)h(\014xes)g(bug)f
(5)h(b)o(y)f(using)g Fr(ENCODE_pc)e Fv(instead)j(of)f
Fr(cur_pc)f Fv(when)i(an)f(emitted)145 307 y(tok)o(en)18
b(other)g(than)f(the)i(\014rst)f(requires)h(the)f(program)d(coun)o
(ter.)30 b(It's)18 b(needed)h(b)q(ecause)145 357 y Fr(cur_pc\(\))c
Fv(c)o(hanges)i(as)f(a)g(side)h(e\013ect)h(of)d Fr(emit)p
Fv(,)h(but)g(\\the)h(program)d(coun)o(ter")j(alw)o(a)o(ys)145
407 y(refers)f(to)d(the)i(lo)q(cation)e(of)g(the)i Fn(\014rst)e
Fv(tok)o(en)h(emitted.)-1409 b Fk(\031Change)14 b(#8)-15
469 y Fp(329a)88 b Fo(h)p Fn(if)15 b(dir)n(e)n(ct)f(style)g(and)i(late)
e(p)n(c,)h(add)h Fr(ENCODE_pc)d Fn(de)n(clar)n(ation)h(to)h
Fr(s)g Fn(and)g(set)g Fr(pc_override)e Fp(329a)p Fo(i)n(\021)85
b Fp(\(328b\))187 519 y Fr(if)21 b(*e.x)g(>)h(1)f(&)h(emitterstyle)d
(==)j("direct")e(&)h(expwalk\(e.x[2:0],)e(equals_pc\))g(then)i({)230
569 y(s)h(||:=)f("unsigned)f(ENCODE_pc)g(=)h(cur_pc\(\);)f($c")230
619 y(save_pc_override)f(:=)i(pc_override)230 669 y(pc_override)f(:=)h
("ENCODE_pc")187 718 y(})145 770 y Fp(Uses)12 b Fl(cur_pc)e
Fp(403c,)g Fl(emittersty)o(le)e Fp(19b,)j Fl(equals_pc)d
Fp(78a,)j Fl(expwalk)e Fp(117a,)h(and)h Fl(pc_overrid)o(e)e
Fp(329f.)-17 853 y(329b)88 b Fo(h)p Fn(r)n(estor)n(e)14
b Fr(pc_override)f Fp(329b)p Fo(i)n(\021)805 b Fp(\(328b\))187
903 y Fr(pc_override)19 b(:=)j(save_pc_override)145 955
y Fp(Uses)12 b Fl(pc_overrid)o(e)d Fp(329f.)-13 1046
y(329c)88 b Fo(h)p Fn(lo)n(c)n(al)15 b(de)n(clar)n(ations)f(for)h
Fr(prettyC)e Fp(327b)p Fo(i)o Fv(+)p Fo(\021)392 b Fp(\(325\))22
b Fm(/)5 b Fp(327b)22 b(333c)5 b Fm(.)187 1096 y Fr(local)21
b(save_pc_overrid)o(e)-17 1187 y Fp(329d)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o
Fv(+)p Fo(\021)610 b Fp(\(325\))22 b Fm(/)5 b Fp(328b)22
b(329e)5 b Fm(.)187 1237 y Fr("Epc")21 b(:)g(\\pc_override)e(|)j
("cur_pc\(\)")187 1287 y("Epc_known")d(:)j("cur_pc_known\(\)")145
1339 y Fp(Uses)12 b Fl(cur_pc)e Fp(403c,)g Fl(cur_pc_kno)o(wn)e
Fp(403c,)i Fl(Epc)h Fp(81,)g Fl(Epc_known)e Fp(81,)h(and)h
Fl(pc_overrid)o(e)e Fp(329f.)-13 1430 y(329e)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o
Fv(+)p Fo(\021)608 b Fp(\(325\))22 b Fm(/)5 b Fp(329d)22
b(329g)5 b Fm(.)187 1480 y Fr("Eclosure_loc")40 b(:)22
b("_c->loc")187 1530 y("Eclosure_addr")c(:)k("_c->v.a")e(||)h(e.n)187
1580 y("Eclosure_val")40 b(:)22 b("_c->v.u")e(||)h(e.n)145
1632 y Fp(Uses)12 b Fl(Eclosure_a)o(ddr)c Fp(81,)j Fl(Eclosure_l)o(oc)d
Fp(81,)j(and)g Fl(Eclosure_v)o(al)d Fp(81.)-8 1723 y(329f)88
b Fo(h)p Fn(*)15 b Fp(325)p Fo(i)p Fv(+)p Fo(\021)1054
b Fm(/)6 b Fp(325)22 b(331c)5 b Fm(.)187 1773 y Fr(global)20
b(pc_override)145 1825 y Fp(De\014nes:)187 1864 y Fl(pc_overrid)o(e)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(329.)-15 1955 y(329g)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f Fp(326a)p
Fo(i)o Fv(+)p Fo(\021)612 b Fp(\(325\))22 b Fm(/)5 b
Fp(329e)22 b(330a)5 b Fm(.)187 2005 y Fr("Efitsu")64
b(:)21 b({)h(s)f(:=)h("\(unsigned\)\(")d(||)i(prettyC\(e.x\))e(||)j
("\))f(<)h(")f(||)h(tworaised\(e.n\))514 2055 y(Cbracket\(s,)d("<",)i
(precedence\))470 2105 y(})187 2155 y("Efitss")64 b(:)21
b({)h(s)f(:=)h("\(unsigned\)\(")d(||)i(prettyC\(addconst\(e)o(.x,)e
(2^\(e.n-1\)\)\))g(||)1080 2205 y("\))j(<)f(")h(||)f(tworaised\(e.n\))
514 2254 y(Cbracket\(s,)e("<",)i(precedence\))470 2304
y(})145 2356 y Fp(Uses)11 b Fl(addconst)c Fp(114a,)i
Fl(Cbracket)f Fp(335c,)h Fl(Efitss)f Fp(81,)i Fl(Efitsu)e
Fp(81,)i Fl(prettyC)e Fp(325,)h(and)h Fl(tworaised)d
Fp(352a.)p eop
%%Page: 330 330
330 329 bop 129 141 a Fv(330)83 b Fr(Cexp.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(330a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)608
b Fp(\(325\))22 b Fm(/)5 b Fp(329g)23 b(330b)t Fm(.)171
307 y Fr("Eforce")d(|)i("Eforceable")41 b(:)21 b({)607
357 y(\(if)g(type\(e.x\))f(==)h("Eclosure_loc")e(then)i("pc_")g(else)g
(""\))g(||)607 407 y("location")f(||)607 457 y(\(if)h(type\(e\))f(==)i
("Eforceable")d(then)i("_known")f(else)h(""\))g(||)607
507 y("$t${\(")f(||)i(prettyC\(e.x\))d(||)i("\)$}$b")454
557 y(})129 608 y Fp(Uses)12 b Fl(Eclosure_lo)o(c)d Fp(81,)h
Fl(Eforce)g Fp(81,)h Fl(Eforceable)d Fp(81,)j Fl(location)p
Fp(,)e(and)h Fl(prettyC)g Fp(325.)-33 700 y(330b)88 b
Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f Fp(326a)p
Fo(i)o Fv(+)p Fo(\021)612 b Fp(\(325\))22 b Fm(/)5 b
Fp(330a)22 b(330c)5 b Fm(.)171 750 y Fr("Enot")129 b(:)22
b({)g(s)f(:=)h("!")f(||)g(prettyC\(e.x,)e(Cprec["!"]\))520
799 y(Cbracket\(s,)g("!",)i(precedence\))476 849 y(})129
901 y Fp(Uses)12 b Fl(Cbracket)d Fp(335c,)h Fl(Cprec)g
Fp(335c,)g Fl(Enot)h Fp(81,)g(and)f Fl(prettyC)f Fp(325.)-29
992 y(330c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f
Fp(326a)p Fo(i)o Fv(+)p Fo(\021)606 b Fp(\(325\))22 b
Fm(/)5 b Fp(330b)23 b(330d)t Fm(.)171 1042 y Fr("Enosimp")63
b(:)22 b(prettyC\(e.x,)d(precedence,)h(associativity\))129
1094 y Fp(Uses)12 b Fl(Enosimp)d Fp(81)i(and)g Fl(prettyC)e
Fp(325.)-33 1185 y(330d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)614 b Fp(\(325\))22
b Fm(/)5 b Fp(330c)22 b(330e)5 b Fm(.)171 1235 y Fr("Sstmts")85
b(:)22 b("$t${{)f($c")g(||)g(commaseparate\(mapl)o(ist2\()o(prett)o
(yC,)e(e.x\),)h(")i($c"\))f(||)g(")h($b$c}$}")129 1287
y Fp(Uses)12 b Fl(prettyC)d Fp(325)i(and)g Fl(Sstmts)e
Fp(81.)-29 1378 y(330e)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)615 b Fp(\(325\))22
b Fm(/)5 b Fp(330d)22 b(330f)5 b Fm(.)171 1428 y Fr("Gcall")20
b(:)i({)f(l)h(:=)f([];)h(every)e(put\(l,)h(prettyC\(!e.args\)\))432
1478 y(Cnoreserve\(e.name\))e(||)i("\(")g(||)g(commaseparate\(l\))e(||)
i("\)")367 1528 y(})129 1580 y Fp(Uses)12 b Fl(Cnoreserve)c
Fp(337a,)i Fl(Gcall)g Fp(293a,)h(and)f Fl(prettyC)f Fp(325.)-24
1671 y(330f)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f
Fp(326a)p Fo(i)o Fv(+)p Fo(\021)612 b Fp(\(325\))22 b
Fm(/)5 b Fp(330e)22 b(331a)5 b Fm(.)171 1721 y Fr("Einstance_input")18
b(:)k({)498 1771 y(s)f(:=)h(prettyC\(e.x,)d(Cprec["."]\))h(||)h(".u.")g
(||)g(e.cons.name)f(||)h(".")g(||)h(e.name)498 1821 y(Cbracket\(s,)d
(".",)i(precedence\))454 1870 y(})171 1920 y("Einstance_tagged)o(")e(:)
j({)498 1970 y(s)f(:=)h(prettyC\(e.x,)d(Cprec["="]\))h(||)h(".tag)g(==)
g(")h(||)f(e.cons.name)f(||)h("_TAG")498 2020 y(Cbracket\(s,)e("==",)i
(precedence\))454 2070 y(})129 2121 y Fp(Uses)16 b Fl(Cbracket)d
Fp(335c,)i Fl(Cprec)f Fp(335c,)g Fl(Einstance_i)o(np)o(ut)f
Fp(81,)i Fl(Einstance)o(_ta)o(gge)o(d)e Fp(81,)171 2161
y(and)e Fl(prettyC)e Fp(325.)p eop
%%Page: 331 331
331 330 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(Cexp.nw)81 b Fv(331)208 258 y(I)14 b(assume)g(the)h(if)f(statemen)
o(t)g(has)h(b)q(een)h(simpli\014ed,)c(so)j(there)g(are)g(no)g(arms)e(b)
q(ey)o(ond)145 307 y(an)o(y)h Fr(else)f Fv(arm)-15 370
y Fp(331a)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f
Fp(326a)p Fo(i)o Fv(+)p Fo(\021)615 b Fp(\(325\))22 b
Fm(/)5 b Fp(330f)22 b(331b)5 b Fm(.)187 420 y Fr("Sif")130
b(:)21 b({)h(preif)e(:=)i("")514 469 y(s)f(:=)h("")514
519 y(every)e(a)i(:=)f(!e.arms)g(do)g({)557 569 y(s)h(||:=)f(preif)g
(||)g(Ctest\(a.guard\))e(||)i(Carm\(a.x\))557 619 y(preif)g(:=)g
("$celse)g(")514 669 y(})514 718 y("${")g(||)g(s)h(||)f("$}")470
768 y(})145 820 y Fp(Uses)12 b Fl(Carm)e Fp(331d,)g Fl(Ctest)g
Fp(331c,)h(and)f Fl(Sif)h Fp(81.)-17 903 y(331b)88 b
Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f Fp(326a)p
Fo(i)o Fv(+)p Fo(\021)612 b Fp(\(325\))22 b Fm(/)5 b
Fp(331a)22 b(331e)5 b Fm(.)187 953 y Fr("Efail")20 b(:)i
(error\("Generate-)o(time)c(operation)i(failed:)h(",)g(e.msg\))145
1005 y Fp(Uses)12 b Fl(Efail)e Fp(81.)-13 1096 y(331c)88
b Fo(h)p Fn(*)15 b Fp(325)p Fo(i)p Fv(+)p Fo(\021)1040
b Fm(/)5 b Fp(329f)22 b(331d)5 b Fm(.)187 1146 y Fr(procedure)20
b(Ctest\(guard\))230 1196 y(return)h(if)g(guard_always_satisf)o(ied\(g)
o(uard\))d(then)j("")383 1246 y(else)g("if)g($t${\(")g(||)g
(prettyC\(guard\))e(||)i("\)$}$b)g(")187 1295 y(end)145
1347 y Fp(De\014nes:)187 1387 y Fl(Ctest)p Fp(,)10 b(used)g(in)h(c)o(h)
o(unk)f(331a.)145 1426 y(Uses)i Fl(guard_alwa)o(ys_)o(sat)o(isf)o(ie)o
(d)d Fp(96b)i(and)f Fl(prettyC)f Fp(325.)-17 1518 y(331d)88
b Fo(h)p Fn(*)15 b Fp(325)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(331c)22 b(332a)5 b Fm(.)187 1567 y Fr(procedure)20
b(Carm\(e\))230 1617 y(return)h(if)g(type\(e\))g(==)g
(\("Gblock"|"Sstmts")o(\))e(then)i(prettyC\(e\))f(||)h(")h(")383
1667 y(else)f("$t$c${")f(||)h(prettyC\(e\))f(||)i("$}$b)e(")187
1717 y(end)145 1769 y Fp(De\014nes:)187 1808 y Fl(Carm)p
Fp(,)10 b(used)g(in)i(c)o(h)o(unk)e(331a.)145 1848 y(Uses)i
Fl(Gblock)e Fp(293a,)g Fl(prettyC)f Fp(325,)h(and)h Fl(Sstmts)f
Fp(81.)-13 1939 y(331e)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)606 b Fp(\(325\))22
b Fm(/)5 b Fp(331b)22 b(332b)5 b Fm(.)187 1989 y Fr("Stagcase")20
b(:)h({)h(s)f(:=)h("switch)e(\(")h(||)h(prettyC\(e.x,)d(Cprec["."]\))h
(||)h(".tag\))g({$t${")492 2038 y(every)g(c)g(:=)h(kept_constructor)o
(s\(e.)o(type\))c(do)535 2088 y(s)k(||:=)f("$ccase)f(")i(||)f(c.name)g
(||)g("_TAG:)g($t$c${")f(||)753 2138 y(prettyC\(e.arms[c]\))e(||)k(")f
($cbreak;$}$b")492 2188 y(s)g(||)h("$cdefault:)d(assert\(0\);$}$b$c})g
(/*)i(")h(||)819 2238 y(Cuncomment\(prett)o(yC\(e.)o(x\)\))d(||)i(")h
(*/")448 2288 y(})145 2339 y Fp(Uses)10 b Fl(Cprec)e
Fp(335c,)h Fl(Cuncomment)d Fp(332a,)i Fl(kept_constru)o(ct)o(ors)e
Fp(33d,)j Fl(prettyC)e Fp(325,)i(and)g Fl(Stagcase)e
Fp(183a.)p eop
%%Page: 332 332
332 331 bop 129 141 a Fv(332)83 b Fr(Cexp.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y(C)h(commen)o(ts)e(don't)i(nest,)g(but)g
(some)f(implemenations)e(migh)o(t.)-31 319 y Fp(332a)88
b Fo(h)p Fn(*)16 b Fp(325)p Fo(i)o Fv(+)p Fo(\021)1033
b Fm(/)5 b Fp(331d)22 b(333a)5 b Fm(.)171 369 y Fr(procedure)20
b(Cuncomment\(s\))215 419 y(r)h(:=)h("")215 469 y(s)f(?)h({)258
519 y(while)f(r)g(||:=)g(tab\(upto\('/*'\)\))e(do)302
568 y(if)i(="/*")g(then)g(r)g(||:=)g("--")302 618 y(else)g(if)g(="*/")g
(then)g(r)g(||:=)g("--")302 668 y(else)g(r)g(||:=)g(move\(1\))258
718 y(return)g(r)g(||)h(tab\(0\))215 768 y(})171 818
y(end)129 869 y Fp(De\014nes:)171 908 y Fl(Cuncomment)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(17a,)g(331e,)g(and)h(334.)-33
990 y(332b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f
Fp(326a)p Fo(i)o Fv(+)p Fo(\021)614 b Fp(\(325\))22 b
Fm(/)5 b Fp(331e)22 b(332c)5 b Fm(.)171 1040 y Fr("Sfail")86
b(:)21 b({)h(s)f(:=)h("fail\($t${")d(||)j(image\(escape_dol)o(lars\()o
(e.fmt)o(\)\))498 1090 y(every)f(a)g(:=)h(e.a1)f(|)g(e.a2)g(|)h(e.a3)f
(do)541 1139 y(s)h(||:=)f(",)g($o")h(||)f(prettyC\(\\a,)e(Cprec[","]\))
498 1189 y(s)i(||:=)g("$}$b\);")498 1239 y(Cbracket\(s,)e("app",)i
(precedence\))454 1289 y(})171 1339 y("Sepsilon")f(:)h("{/*)g(skip)g
(*/}")129 1390 y Fp(Uses)12 b Fl(Cbracket)d Fp(335c,)h
Fl(Cprec)g Fp(335c,)g Fl(escape_doll)o(ars)e Fp(112b,)i
Fl(fail)g Fp(410,)h Fl(prettyC)e Fp(325,)i Fl(Sepsilon)d
Fp(81,)171 1429 y(and)j Fl(Sfail)f Fp(188c.)-29 1519
y(332c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f
Fp(326a)p Fo(i)o Fv(+)p Fo(\021)606 b Fp(\(325\))22 b
Fm(/)5 b Fp(332b)23 b(332d)t Fm(.)171 1569 y Fr("Sclosure")d(:)h
(prettyC\(\\e.creation)o(\))e(|)j(impossible\("cre)o(ating)c
(closure"\))129 1620 y Fp(Uses)12 b Fl(prettyC)d Fp(325)i(and)g
Fl(Sclosure)e Fp(193f.)-33 1709 y(332d)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)614
b Fp(\(325\))22 b Fm(/)5 b Fp(332c)22 b(332e)5 b Fm(.)171
1759 y Fr("Glines")85 b(:)22 b({)g(s)f(:=)h("";)f(every)g(s)g(||:=)g
(prettyC\(!e.x\))e(||)j("\\n";)e(s)i(})171 1809 y("Gresynch")41
b(:)22 b("$n#line)e(")i(||)f(e.line)43 b(||)21 b(")g(")h(||)f
(image\(\\e.file)f(|)h("generated-code"\))129 1860 y
Fp(Uses)12 b Fl(file)e Fp(359a,)h Fl(Glines)e Fp(293a,)h
Fl(Gresynch)f Fp(293a,)h Fl(line)h Fp(359a,)f(and)g Fl(prettyC)g
Fp(325.)-29 1950 y(332e)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)606 b Fp(\(325\))22
b Fm(/)5 b Fp(332d)23 b(333b)t Fm(.)171 2000 y Fr("Gblock")85
b(:)22 b({)g(s)f(:=)h("{)f(${$t$c")520 2049 y(every)f(s)i(||:=)f
(prettyC\(!e.decls\))d(||)k(";$n")520 2099 y(s)f(||:=)g
(commaseparate\(mapl)o(ist\(p)o(retty)o(C,)e(e.stmts\),)h("$c"\))520
2149 y(s)h(||)h("$b)f($c}$}")476 2199 y(})171 2249 y("Gdecl")107
b(:)22 b({)g(s)f(:=)h("${")f(||)g(prettyC\(\\e.type)e(|)i
(infer_C_type\(e.init)o(\)\))520 2298 y(s)g(||:=)g(")h(")f(||)h(e.name)
520 2348 y(s)f(||:=)g(")h(=)f($t$c")g(||)h(prettyC\(\\e.init)o(\))d(||)
i("$b")520 2398 y(s)g(||)h("$}")476 2448 y(})129 2499
y Fp(Uses)12 b Fl(Gblock)e Fp(293a,)g Fl(Gdecl)g Fp(293a,)g
Fl(infer_C_ty)o(pe)e Fp(333a,)j(and)f Fl(prettyC)f Fp(325.)p
eop
%%Page: 333 333
333 332 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(Cexp.nw)81 b Fv(333)-15 258 y Fp(333a)88 b Fo(h)p
Fn(*)15 b Fp(325)p Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5
b Fp(332a)22 b(335a)5 b Fm(.)187 307 y Fr(procedure)20
b(infer_C_type\(val)o(ue\))230 357 y(if)i(/value)e(then)h
(impossible\("variabl)o(e)e(with)i(no)g(type)g(and)g(no)h(value"\))230
407 y(return)f(case)g(type\(value\))e(of)j({)274 457
y("Ewiden")e(:)i(Tsigned\(value.n\))274 507 y(default)42
b(:)22 b(Tunsigned\(wordsi)o(ze\))230 557 y(})187 606
y(end)145 658 y Fp(De\014nes:)187 698 y Fl(infer_C_ty)o(pe)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(332e.)145 737 y(Uses)i
Fl(Ewiden)e Fp(81,)g Fl(Tsigned)g Fp(294a,)g Fl(Tunsigned)e
Fp(294a,)j Fl(value)f Fp(136a,)g(and)g Fl(wordsize)f
Fp(38c.)-17 828 y(333b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)610 b Fp(\(325\))22
b Fm(/)5 b Fp(332e)22 b(333d)5 b Fm(.)187 878 y Fr("Gdeclnamearray")18
b(:)k({)230 928 y(/na_count)e(:=)i(0)230 978 y(/e.na.codename)d(:=)j
("MATCH_name_")d(||)i(e.na.field.field.n)o(ame)e(||)i("_")g(||)h
(\(na_count)d(+:=)j(1\))230 1028 y(/e.na.storageclass)c(:=)k("static")
230 1077 y(s)g(:=)f(e.na.storageclass)e(||)i(")h(char)f(*")g(||)g
(e.na.codename)e(||)j("[])f(=)h({")230 1127 y(s)g(||:=)f("${$t")230
1177 y(every)g(i)h(:=)f(0)h(to)f(e.na.hi)f(-)i(1)g(do)274
1227 y(s)g(||:=)f(")g($c")g(||)h(escape_dollars\(i)o(mage\()o(\\e.n)o
(a.tbl)o([i]|0)o(\)\))d(||)i(",")230 1277 y(s)h(||)f("$b)h($c$}}")187
1327 y(})145 1378 y Fp(Uses)12 b Fl(escape_dol)o(lar)o(s)d
Fp(112b,)h Fl(field)g Fp(55,)h(and)f Fl(Gdeclnamear)o(ray)e
Fp(293b.)-13 1470 y(333c)88 b Fo(h)p Fn(lo)n(c)n(al)15
b(de)n(clar)n(ations)f(for)h Fr(prettyC)e Fp(327b)p Fo(i)o
Fv(+)p Fo(\021)511 b Fp(\(325\))22 b Fm(/)6 b Fp(329c)187
1520 y Fr(static)20 b(na_count)-17 1611 y Fp(333d)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f Fp(326a)p
Fo(i)o Fv(+)p Fo(\021)608 b Fp(\(325\))22 b Fm(/)5 b
Fp(333b)22 b(334a)5 b Fm(.)187 1661 y Fr("Gsetname")41
b(:)22 b("char)f(*")g(||)g(e.lhs)g(||)h(")f(=)h(${$t$o")e(||)h(case)g
(type\(e.name\))f(of)h({)601 1711 y("string")85 b(:)22
b(image\(e.name\))601 1760 y("namearray")d(:)j(e.name.codename)d(||)i
("[")g(||)h(prettyC\(e.name.)o(field)o(\))d(||)i("]")601
1810 y(default)107 b(:)22 b(impossible\("type)c(of)k(node)f(name)g
(field"\))492 1860 y(})g(||)h("$b$}")145 1912 y Fp(Uses)12
b Fl(field)e Fp(55,)h Fl(Gsetname)e Fp(294a,)h Fl(namearray)e
Fp(291a,)j Fl(node)f Fp(272,)g(and)h Fl(prettyC)e Fp(325.)p
eop
%%Page: 334 334
334 333 bop 129 141 a Fv(334)83 b Fr(Cexp.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(334a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)606
b Fp(\(325\))22 b Fm(/)5 b Fp(333d)23 b(334b)t Fm(.)171
307 y Fr("Gcase")107 b(:)22 b({)g(s)f(:=)h("switch)e(\(")h(||)h
(prettyC\(e.x\))d(||)i("\))h({$t${)f(")520 357 y(every)f(s)i(||:=)f
(prettyC\(!e.arms\))520 407 y(s)g(||)h("$cdefault:)d
(assert\(0\);$}$b$c})f(/*)k(")f(||)868 457 y(Cuncomment\(prettyC\()o
(e.x\)\))d(||)k(")f(*/")498 507 y(})171 557 y("Gcasearm")41
b(:)22 b({)g(s)f(:=)h("$n")520 606 y(every)e(i)i(:=)f(1)h(to)f(*e.tags)
g(by)g(2)h(do)f({)563 656 y(if)h(e.tags[i])e(+)h(1)h(=)f(e.tags[i+1])f
(then)607 706 y(s)h(||:=)g("$ocase)g(")g(||)h(e.tags[i])e(||)h(":)g(")
563 756 y(else)607 806 y(every)g(s)g(||:=)g("$ocase)f(")i(||)f
(\(e.tags[i])f(to)i(\(e.tags[i+1]-1\))o(\))d(||)i(":)h(")520
855 y(})520 905 y(s)f(||:=)g("$t$c${")f(||)i(prettyC\(e.x\))d(||)i
("$cbreak;$}$b")476 955 y(})129 1007 y Fp(Uses)12 b Fl(Cuncomment)c
Fp(332a,)i Fl(Gcase)g Fp(294a,)h Fl(Gcasearm)d Fp(294a,)j(and)f
Fl(prettyC)f Fp(325.)-33 1098 y(334b)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o Fv(+)p Fo(\021)612
b Fp(\(325\))22 b Fm(/)5 b Fp(334a)22 b(334c)5 b Fm(.)171
1148 y Fr("Ginrange")41 b(:)22 b({)g(x)f(:=)h(prettyC\(e.x,)d
(Cprec["<"]\))520 1198 y(if)i(e.lo)g(+)h(1)f(=)h(e.hi)f(then)g({)563
1248 y(Cbracket\(x)f(||)h(")h(==)f(")h(||)f(e.lo,)g("==",)g
(Cprec["&&"]\))520 1297 y(})g(else)g({)563 1347 y(c1)h(:=)f
(Cbracket\(e.lo)e(||)i(")h(<=)f(")h(||)f(x,)h("<=",)f(Cprec["&&"]\))563
1397 y(c2)h(:=)f(Cbracket\(x)f(||)h(")h(<)f(")h(||)f(e.hi,)g("<",)g
(Cprec["&&"]\))563 1447 y(Cbracket\(c1)f(||)h(")h(&&)f(")h(||)f(c2,)g
("&&",)g(precedence\))520 1497 y(})476 1547 y(})171 1596
y("Gsetname")41 b(:)22 b("${")f(||)g(e.lhs)g(||)h(")f(=)h($t$o")e(||)i
(case)f(type\(e.name\))e(of)j({)585 1646 y("string")86
b(:)21 b(image\(e.name\))585 1696 y("namearray")f(:)h(e.name.codename)e
(||)i("[")g(||)h(e.name.field.nam)o(e)d(||)i("]")585
1746 y(default)108 b(:)21 b(impossible\("type)e(of)i(node)g(name)g
(field"\))476 1796 y(})h(||)f(";$b$}")171 1845 y("Gasgn")42
b(:)22 b("${")f(||)g(prettyC\(e.lhs\))e(||)i(")h(=)f($t$o")g(||)h
(prettyC\(e.x,)d(Cprec["="]\))g(||)j(";$b$}")129 1897
y Fp(Uses)14 b Fl(Cbracket)c Fp(335c,)i Fl(Cprec)f Fp(335c,)h
Fl(field)f Fp(55,)h Fl(Gasgn)g Fp(294a,)f Fl(Ginrange)f
Fp(294a,)i Fl(Gsetname)e Fp(294a,)171 1937 y Fl(namearray)f
Fp(291a,)h Fl(node)g Fp(272,)g(and)h Fl(prettyC)e Fp(325.)-29
2028 y(334c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyC)f
Fp(326a)p Fo(i)o Fv(+)p Fo(\021)606 b Fp(\(325\))22 b
Fm(/)5 b Fp(334b)23 b(335b)t Fm(.)171 2078 y Fr("Gnomatch")41
b(:)22 b("assert\(0\);)e(/*)h(no)g(match)g(*/$n")171
2128 y("Tunsigned")e(:)j(unsigned_type\(e.wi)o(dth\))171
2178 y("Tsigned")63 b(:)22 b(signed_type\(e.widt)o(h\))171
2227 y("Gcomment")41 b(:)22 b("/*)f(")h(||)f(Cuncomment\(e.s\))e(||)i
(")h(*/")171 2277 y("Gcommented")d(:)215 2327 y(prettyC\(e.e,)g
(precedence,)g(associativity,)g(nohex\))i(||)280 2377
y(")h(/*)f(")g(||)h(Cuncomment\(e.comm)o(ent\))c(||)k(")f(*/")129
2429 y Fp(Uses)14 b Fl(Cuncomment)d Fp(332a,)h Fl(Gcomment)f
Fp(20,)i Fl(Gcommented)e Fp(299a,)h Fl(Gnomatch)f Fp(294a,)i
Fl(prettyC)e Fp(325,)171 2468 y Fl(signed_typ)o(e)e Fp(335a,)h
Fl(Tsigned)f Fp(294a,)h Fl(Tunsigned)f Fp(294a,)h(and)h
Fl(unsigned_)o(typ)o(e)e Fp(335a.)p eop
%%Page: 335 335
335 334 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(Cexp.nw)81 b Fv(335)-15 258 y Fp(335a)88 b Fo(h)p
Fn(*)15 b Fp(325)p Fo(i)p Fv(+)p Fo(\021)1037 b Fm(/)5
b Fp(333a)22 b(335c)5 b Fm(.)187 307 y Fr(procedure)20
b(unsigned_type\(wi)o(dth\))230 357 y(return)h("unsigned")f(||)h
(unsigned_width_com)o(ment)o(\(widt)o(h\))187 407 y(end)187
457 y(procedure)f(signed_type\(widt)o(h\))230 507 y(return)h("int")g
(||)g(signed_width_comme)o(nt\(wi)o(dth\))187 557 y(end)187
606 y(procedure)f(unsigned_width_c)o(ommen)o(t\(wid)o(th\))230
656 y(return)h(if)g(\\width)g(<)g(wordsize)g(then)g(")g(/*)h([0..")e
(||)i(\(2^width-1\))d(||)j("])f(*/")g(else)g("")187 706
y(end)187 756 y(procedure)f(signed_width_com)o(ment\()o(width)o(\))230
806 y(return)h(if)g(\\width)g(<)g(wordsize)g(then)274
855 y(")h(/*)f([")g(||)h(-\(2^\(width-1\)\))d(||)i("..")g(||)g
(\(2^\(width-1\)-1\))e(||)i("])h(*/")230 905 y(else)274
955 y("")187 1005 y(end)145 1057 y Fp(De\014nes:)187
1096 y Fl(signed_typ)o(e)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(247)h
(and)f(334c.)187 1136 y Fl(unsigned_t)o(ype)o Fp(,)f(used)h(in)h(c)o(h)
o(unks)f(204a,)g(247,)h(301a,)f(and)h(334c.)145 1175
y(Uses)h Fl(wordsize)d Fp(38c.)-17 1266 y(335b)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(prettyC)f Fp(326a)p Fo(i)o
Fv(+)p Fo(\021)729 b Fp(\(325\))22 b Fm(/)6 b Fp(334c)187
1316 y Fr("absolute_field")18 b(:)252 1366 y(prettyC\(super_simp)o
(lify\()o(afiel)o(dexp\()o(e\)\),)g(precedence,)i(associativity,)f
(nohex\))145 1418 y Fp(Uses)12 b Fl(absolute_f)o(iel)o(d)d
Fp(268,)h Fl(afieldexp)f Fp(299a,)h Fl(prettyC)f Fp(325,)i(and)f
Fl(super_simpl)o(ify)e Fp(92c.)-13 1509 y(335c)88 b Fo(h)p
Fn(*)15 b Fp(325)p Fo(i)p Fv(+)p Fo(\021)1033 b Fm(/)5
b Fp(335a)22 b(336b)5 b Fm(.)187 1559 y Fr(global)20
b(Cprec,)h(Cassoc)187 1609 y(procedure)f(Cbracket\(s,)f(op,)i(p,)h(a\))
230 1659 y(/a)g(:=)f("L")230 1708 y(return)g("${")g(||)g(\(if)g
(Cprec[op])f(>)i(p)g(|)f(\(Cprec[op])f(=)h(p)h(&)g(Cassoc[p])e(==)h
(a\))g(then)g(s)601 1758 y(else)g("\(")g(||)g(s)h(||)f("\)"\))g(||)h
("$}")187 1808 y(end)145 1860 y Fp(De\014nes:)187 1899
y Fl(Cassoc)p Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(336a.)187
1939 y Fl(Cbracket)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f(326{30,)f(332b,)
i(and)f(334b.)187 1978 y Fl(Cprec)p Fp(,)g(used)g(in)h(c)o(h)o(unks)f
(326{28,)g(330{32,)f(334b,)h(and)h(336a.)p eop
%%Page: 336 336
336 335 bop 129 141 a Fv(336)83 b Fr(Cexp.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(336a)88 b Fo(h)p Fn(initialize)14
b Fr(Cprec)g Fn(and)i Fr(Cassoc)d Fp(336a)p Fo(i)o(\021)696
b Fp(\(325\))171 307 y Fr(ops)21 b(:=)h(["N",)e(["low"],)345
357 y("L",)h([";"],)345 407 y("L",)g([","],)345 457 y("R",)g(["=",)g
("+=",)g("-=",)g("*=",)f("/=",)h("\045=",)g("&=",)g("^=",)f("|=",)h
(">>=",)g("<<="],)345 507 y("R",)g([":?"],)345 557 y("L",)g(["||"],)345
606 y("L",)g(["&&"],)345 656 y("L",)g(["|"],)345 706
y("L",)g(["^"],)345 756 y("L",)g(["&"],)345 806 y("L",)g(["==",)g
("!="],)345 855 y("L",)g(["<=",)g("<",)g(">=",)g(">"],)345
905 y("L",)g([">>",)g("<<"],)345 955 y("L",)g(["+",)g("-"],)345
1005 y("L",)g(["\045",)g("/",)g("*"],)345 1055 y("R",)g(["!",)g("~",)g
("++",)g("--",)g("cast",)f("sizeof"],)345 1104 y("L",)h([".",)g("->",)g
("app"],)345 1154 y("N",)g(["high"])324 1204 y(])171
1254 y(Cprec)g(:=)g(table\([]\))42 b(#)21 b(missed)g(lookups)f(break)h
(arithmetic)f(comparisons)171 1304 y(Cassoc)h(:=)g(table\(\))171
1354 y(every)g(i)g(:=)h(1)f(to)h(*ops)f(by)g(2)h(do)f({)215
1403 y(every)f(Cprec[!ops[i+1]])f(:=)i(i)215 1453 y(Cassoc[i])e(:=)j
(ops[i])171 1503 y(})129 1555 y Fp(Uses)12 b Fl(Cassoc)e
Fp(335c)g(and)h Fl(Cprec)f Fp(335c.)-33 1646 y(336b)88
b Fo(h)p Fn(*)16 b Fp(325)p Fo(i)o Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(335c)22 b(337a)5 b Fm(.)171 1696 y Fr(procedure)20
b(Cop\(op\))215 1746 y(return)g(if)h(op)h(==)f("=")g(then)g("==")g
(else)g(op)171 1796 y(end)129 1848 y Fp(De\014nes:)171
1887 y Fl(Cop)p Fp(,)10 b(used)h(in)g(c)o(h)o(unk)f(326a.)p
eop
%%Page: 337 337
337 336 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(Cexp.nw)81 b Fv(337)-15 258 y Fp(337a)88 b Fo(h)p
Fn(*)15 b Fp(325)p Fo(i)p Fv(+)p Fo(\021)1031 b Fm(/)5
b Fp(336b)22 b(337b)5 b Fm(.)187 307 y Fr(procedure)20
b(Cnoreserve\(word\))230 357 y(static)h(reserved)230
407 y(initial)g(reserved)f(:=)h(set\([)361 457 y("asm",)g("auto",)f
("break",)g("case",)h("char",)f("const",)g("continue",)361
507 y("default",)g("double",)g("do",)h("else",)f("enum",)g("extern",)g
("float",)g("for",)361 557 y("goto",)g("if",)h("int",)g("long",)f
("register",)g("return",)g("short",)361 606 y("signed",)g("sizeof",)g
("static",)g("struct",)g("switch",)g("typedef",)g("union",)361
656 y("unsigned",)g("void",)g("volatile",)g("while"]\))230
706 y(return)h(if)g(member\(reserved,)e(word\))i(then)g
(Cnoreserve\(word)o(||"_")o(\))e(else)i(word)187 756
y(end)145 808 y Fp(De\014nes:)187 847 y Fl(Cnoreserve)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(213,)i(214a,)f(231a,)g(246,)h(254,)
f(and)h(330e.)-17 938 y(337b)88 b Fo(h)p Fn(*)15 b Fp(325)p
Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(337a)22 b(338a)5
b Fm(.)187 988 y Fr(procedure)20 b(hexstring\(i,n\))252
1038 y(local)h(s)252 1088 y(if)h(i)f(=)h(0)f(then)g(s)h(:=)f("0")252
1138 y(else)g({)318 1187 y(s)g(:=)h("")318 1237 y(while)e(i)i(~=)f(0)h
(do)f({)383 1287 y(s)h(:=)f("0123456789abcdef)o("[ian)o(d\(i,1)o(5\))e
(+)i(1])h(||)f(s)383 1337 y(i)h(:=)f(ishift\(i,-4\))383
1387 y(})318 1437 y(})252 1486 y(if)h(\\n)f(>)h(*s)f(then)g(s)g(:=)h
(right\(s,n,"0"\))252 1536 y(return)f(s)187 1586 y(end)145
1638 y Fp(De\014nes:)187 1677 y Fl(hexstring)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(326a.)p eop
%%Page: 338 338
338 337 bop 129 141 a Fv(338)83 b Fr(Cexp.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)129 258 y Fj(17.1)66 b(Supp)r(ort)24
b(for)e(deco)r(ding)h(co)r(de)f(in)h(C)-31 349 y Fp(338a)88
b Fo(h)p Fn(*)16 b Fp(325)p Fo(i)o Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(337b)23 b(338b)t Fm(.)171 398 y Fr(procedure)d
(Generate_C\(\))215 448 y(pretty)g(:=)h(prettyC)215 498
y(hex_prefix)e(:=)j("0x")215 548 y(gen_outer_decls)c(:=)k([])215
598 y(gen_file_header)c(:=)k(["#include)d(<assert.h>\\n",)280
647 y("#define)h(sign_extend\(N,SIZE)o(\))f(",)i(#)h(no)f(newline)g
(after)f(#define)367 697 y("\(\(\(int\)\(\(N\))f(<<)j
(\(sizeof\(unsigned)o(\)*8-\()o(SIZE\))o(\)\)\))d(>>)i
(\(sizeof\(unsigned\))o(*8-\(S)o(IZE\)\))o(\)")280 747
y(])215 797 y(fetchtab["type")o(])e(:=)i("unsigned)f(char)h(*";)215
847 y(fetchtab["add"])d(:=)k("\(\(\045a\))e(+)i(\045o\)")215
897 y(fetchtab["integ)o(er"])c(:=)k("\(unsigned\)\(\045a\)")171
946 y(#)43 b(fetchtab[8])f(:=)21 b("\(unsigned\)*\(unsig)o(ned)d(char)j
(*\))h(\(\045a+\045o/8\)")171 996 y(#)43 b(fetchtab[16])20
b(:=)h("\(unsigned\)*\(unsig)o(ned)d(short)j(*\)\(\045a+\045o/16\)")171
1046 y(#)43 b(fetchtab[32])20 b(:=)h("\(unsigned\)*\(unsig)o(ned)d(*\))
131 b(\(\045a+\045o/32\)")171 1096 y(end)129 1148 y Fp(De\014nes:)171
1187 y Fl(Generate_C)o Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(10i)g(and)h
(20.)129 1227 y(Uses)j Fl(fetchtab)c Fp(295a,)i Fl(gen_file_h)o(ead)o
(er)e Fp(294d,)i Fl(gen_outer_)o(dec)o(ls)e Fp(294d,)i
Fl(hex_prefi)o(x)e Fp(352a,)171 1266 y Fl(pretty)g Fp(18a,)g
Fl(prettyC)f Fp(325,)i(and)f Fl(sign_extend)o Fp(.)192
1337 y Fv(Used)15 b(to)e(declare)i(functions)f(according)g(to)g(the)g
(prop)q(er)h(st)o(yle)f(of)f(indirection.)-33 1399 y
Fp(338b)88 b Fo(h)p Fn(*)16 b Fp(325)p Fo(i)o Fv(+)p
Fo(\021)1152 b Fm(/)6 b Fp(338a)171 1449 y Fr(procedure)20
b(c_function_declar)o(ation)o(\(pp,)e(returntype,)i(name,)h(args,)f
(indirect\))215 1498 y(emit_template\(p)o(p,)f(if)i(\\indirectname)e
(then)i("indirect-proto.t")d(else)j("direct-proto.t",)607
1548 y("return",)f(returntype,)f("name",)i(name,)f("args",)h(args\))215
1598 y(return)171 1648 y(end)129 1700 y Fp(De\014nes:)171
1739 y Fl(c_function)o(_de)o(cla)o(rat)o(io)o(n)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(213a,)g(214a,)g(and)h(234a.)129
1779 y(Uses)h Fl(indirectnam)o(e)d Fp(18a.)-29 1862 y(338c)88
b Fo(h)p Fn(dir)n(e)n(ct-pr)n(oto.t)14 b Fp(338c)p Fo(i)o(\021)171
1911 y Fr(extern)21 b(\045return)f(\045name\(\045args\);)-33
2003 y Fp(338d)88 b Fo(h)p Fn(indir)n(e)n(ct-pr)n(oto.t)14
b Fp(338d)p Fo(i)o(\021)171 2053 y Fr(\045return)20 b
(\(*\045name\)\(\045args\);)p eop
%%Page: 339 339
339 338 bop 145 569 a Fq(Chapter)32 b(18)145 777 y Fu(Con)m(v)m(erting)
39 b(Expressions)g(to)145 901 y(Mo)s(dula-3)145 1117
y Fr(prettyM3)12 b Fv(returns)j(Mo)q(dula-3)d(co)q(de)i(for)f(an)g
(expression)i(\(or)f(statemen)o(t\))f(with)g(em)o(b)q(ed-)145
1167 y(ded)19 b(prett)o(yprin)o(ting)e(escap)q(es.)32
b Fr(nohex)16 b Fv(is)i(a)g(purely)f(in)o(ternal)h(\015ag.)29
b(If)17 b(it)h(is)f(non-n)o(ull,)145 1217 y(constan)o(ts)e(are)f(in)g
(hex;)g(otherwise)g(they're)h(in)f(decimal.)-15 1279
y Fp(339a)88 b Fo(h)p Fn(*)15 b Fp(339a)p Fo(i)o(\021)1169
b Fp(343e)5 b Fm(.)187 1329 y Fr(procedure)20 b(prettyM3\(e,)f
(precedence,)h(associativity,)f(nohex\))230 1378 y Fo(h)p
Fn(lo)n(c)n(al)c(de)n(clar)n(ations)f(for)h Fr(prettyM3)e
Fp(341b)p Fo(i)230 1428 y Fr(initial)21 b({)p Fo(h)p
Fn(initialize)13 b Fr(M3prec)h Fn(and)i Fr(M3assoc)d
Fp(347a)p Fo(i)o Fr(})230 1478 y(/precedence)20 b(:=)h(0)230
1528 y(/associativity)e(:=)j("L")230 1578 y(return)f(case)g(type\(e\))f
(of)i({)274 1628 y Fo(h)p Fn(c)n(ases)15 b(for)f Fr(prettyM3)g
Fp(339b)p Fo(i)274 1677 y Fr(default)86 b(:)21 b(impossible\("Bad)e
(code)i(to)g(prettyM3"\))230 1727 y(})187 1777 y(end)145
1829 y Fp(De\014nes:)187 1868 y Fl(prettyM3)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(340{46)g(and)g(348.)-17
1951 y(339b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f
Fp(339b)p Fo(i)o(\021)718 b Fp(\(339a\))21 b(340a)5 b
Fm(.)830 2604 y Fv(339)p eop
%%Page: 340 340
340 339 bop 129 141 a Fv(340)83 b Fr(M3exp.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(340a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)568
b Fp(\(339a\))22 b Fm(/)5 b Fp(339b)22 b(341c)5 b Fm(.)171
307 y Fr("list")108 b(:)21 b(commaseparate\(mapli)o(st2\(p)o(rett)o
(yM3,)d(e,)k(M3prec[","]\),)d(",)i($o"\))171 357 y("set")130
b(:)21 b(commaseparate\(mapli)o(st2\(p)o(rett)o(yM3,)d(sort\(e\),)j
(M3prec["AND"]\),)d(")k(AND)f($o"\))171 407 y("eqn")130
b(:)21 b({)h(o)f(:=)h(M3op\(e.op\))498 457 y(M3bracket\(prettyM)o
(3\(e.l)o(eft,)40 b(M3prec[o]\))20 b(||)h(")h(")f(||)h(o)f(||)h(")f
($o")g(||)716 507 y(prettyM3\(e.right)o(,)e(M3prec[o]\),)h("=",)h
(precedence\))454 557 y(})171 606 y("table")86 b(:)21
b({)480 b(#)21 b(standard)f(normal)h(form)258 656 y Fo(h)p
Fn(make)15 b Fr(s)g Fn(r)n(epr)n(esent)f(table)h Fr(e)p
Fn(,)f(but)h(elide)g(additive)g(and)h(multiplic)n(ative)d(units)i
Fp(340b)p Fo(i)258 706 y Fr("$t${")21 b(||)g(s)h(||)f("$}$b")215
756 y(})171 806 y("string")64 b(:)21 b(if)h(e)f(==)h("$pc")e(then)h
("$$pc")g(else)g(e)171 855 y("literal")42 b(:)21 b
(list_to_string\(e.s\))171 905 y("integer")42 b(:)21
b(string\(e\))129 957 y Fp(Uses)12 b Fl(eqn)f Fp(83c,)f
Fl(literal)g Fp(45e,)g Fl(M3bracket)f Fp(346d,)h Fl(M3op)g
Fp(347b,)g Fl(M3prec)g Fp(346d,)g(and)h Fl(prettyM3)d
Fp(339a.)129 1028 y Fv(The)18 b(old)f(v)o(ersion)g(prin)o(ted)g(in)g
(an)o(y)g(old)f(order,)i(but)g(the)g(new)f(v)o(ersion)g(prin)o(ts)h(p)q
(ositiv)o(e)129 1077 y(terms)c(\014rst,)g(then)h(negativ)o(e)f(terms,)f
(with)g(the)i(constan)o(t)f(term)g(last)f(in)h(its)f(group.)-1879
b Fk(\031Change)13 b(#23)-33 1140 y Fp(340b)88 b Fo(h)p
Fn(make)16 b Fr(s)e Fn(r)n(epr)n(esent)h(table)f Fr(e)p
Fn(,)h(but)g(elide)f(additive)h(and)h(multiplic)n(ative)e(units)g
Fp(340b)p Fo(i)o(\021)88 b Fp(\(340a\))171 1190 y Fr({)215
1239 y(s)21 b(:=)h("";)f(leadingsign)e(:=)j("")215 1289
y Fo(h)p Fn(add)15 b(p)n(ositive)g(terms)f(to)h Fr(s)f
Fp(340c)p Fo(i)215 1339 y Fr(leadingsign)19 b(:=)i(")h(-)g($o")215
1389 y Fo(h)p Fn(add)15 b(ne)n(gative)g(terms)g(to)f
Fr(s)h Fp(340d)p Fo(i)215 1439 y Fr(s)21 b(:=)h(if)f(s)g(==)h("")f
(then)g("0")g(else)g(M3bracket\(s,)f("+",)h(precedence\))171
1488 y(})129 1540 y Fp(Uses)12 b Fl(M3bracket)d Fp(346d.)-29
1623 y(340c)88 b Fo(h)p Fn(add)16 b(p)n(ositive)f(terms)f(to)h
Fr(s)f Fp(340c)p Fo(i)o(\021)769 b Fp(\(340b\))171 1673
y Fr(every)21 b(e[k)g(:=)g(1)h(~===)f(key\(e\)])f(>)i(0)f(do)h({)258
1723 y(s)g(||:=)f(leadingsign)258 1773 y(s)h(||:=)f(\(1)g(~=)g
(abs\(e[k]\)\))f(||)i("*")86 b(#)22 b(print)e(coefficient)g(if)h(not)h
(1)258 1823 y(s)g(||:=)f(prettyM3\(k,)e(M3prec["*"]\))258
1872 y(leadingsign)h(:=)h(")h(+)f($o")171 1922 y(})171
1972 y(if)g(e[1])g(>)h(0)f(then)g(s)h(||:=)f(leadingsign)f(||)h
(string\(e[1]\))129 2024 y Fp(Uses)12 b Fl(M3prec)e Fp(346d)g(and)h
Fl(prettyM3)e Fp(339a.)-33 2115 y(340d)88 b Fo(h)p Fn(add)16
b(ne)n(gative)f(terms)f(to)h Fr(s)g Fp(340d)p Fo(i)o(\021)754
b Fp(\(340b\))171 2165 y Fr(every)21 b(e[k)g(:=)g(1)h(~===)f(key\(e\)])
f(<)i(0)f(do)h({)258 2215 y(s)g(||:=)f(leadingsign)258
2265 y(s)h(||:=)f(\(1)g(~=)g(abs\(e[k]\)\))f(||)i("*")86
b(#)22 b(print)e(coefficient)g(if)h(not)h(1)258 2315
y(s)g(||:=)f(prettyM3\(k,)e(M3prec["*"]\))171 2364 y(})171
2414 y(if)i(e[1])g(<)h(0)f(then)g(s)h(||:=)f(leadingsign)f(||)h
(string\(-e[1]\))129 2466 y Fp(Uses)12 b Fl(M3prec)e
Fp(346d)g(and)h Fl(prettyM3)e Fp(339a.)p eop
%%Page: 341 341
341 340 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(M3exp.nw)81 b Fv(341)-15 258 y Fp(341a)88 b Fo(h)p
Fn(old)15 b(make)h Fr(s)e Fn(r)n(epr)n(esent)g(table)h
Fr(e)p Fn(,)f(but)h(elide)g(additive)g(and)h(multiplic)n(ative)d(units)
i Fp(341a)p Fo(i)o(\021)187 307 y Fr({)230 357 y(#)22
b(print)f(constant)f(term)h(if)g(nonzero)230 407 y(if)h(e[1])f(~=)g(0)h
(then)f({)g(s)h(:=)f(string\(e[1]\))f(;)h(leadingsign)f(:=)h(")h(+)f
($o")g(})230 457 y(else)g(s)h(:=)f(leadingsign)f(:=)h("")230
507 y(#)h(print)f(every)f(nonconstant)g(term)h(k)230
557 y(every)g(k)h(:=)f(1)h(~===)f(key\(e\))f(do)i({)318
606 y(s)f(||:=)g(if)g(e[k])g(<)h(0)g(then)f(")g(-)h(")f(else)g
(leadingsign)318 656 y(leadingsign)e(:=)i(")h(+)g($o")318
706 y(s)f(||:=)g(\(1)g(~=)h(abs\(e[k]\)\))e(||)h("*")87
b(#)21 b(print)g(coefficient)e(if)j(not)f(1)318 756 y(s)g(||:=)g
(prettyM3\(k,)f(M3prec["*"]\))230 806 y(})230 855 y(s)i(:=)f(if)h(s)f
(==)h("")f(then)g("0")g(else)g(M3bracket\(s,)e("+",)i(precedence\))187
905 y(})145 957 y Fp(Uses)12 b Fl(constant)d Fp(114b,)h
Fl(M3bracket)f Fp(346d,)h Fl(M3prec)f Fp(346d,)h(and)h
Fl(prettyM3)e Fp(339a.)-17 1048 y(341b)88 b Fo(h)p Fn(lo)n(c)n(al)15
b(de)n(clar)n(ations)f(for)h Fr(prettyM3)e Fp(341b)p
Fo(i)o(\021)500 b Fp(\(339a\))21 b(345b)5 b Fm(.)187
1098 y Fr(local)21 b(leadingsign)-13 1190 y Fp(341c)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f Fp(339b)p
Fo(i)o Fv(+)p Fo(\021)566 b Fp(\(339a\))22 b Fm(/)5 b
Fp(340a)22 b(341d)5 b Fm(.)187 1239 y Fr("Eorb")108 b(:)21
b("Word.Or\(${$t$c")e(||)i(prettyM3\(e.x\))e(||)i(",)h($c")f(||)g
(prettyM3\(e.y\))e(||)j("$b$}\)")187 1289 y("Eand")108
b(:)21 b({)h(s)f(:=)h(prettyM3\(e.x,)d(M3prec["AND"],)g("L"\))514
1339 y(t)i(:=)h(prettyM3\(e.y,)d(M3prec["AND"],)g("R"\))514
1389 y(M3bracket\(s)g(||)j(")f(AND)g($o")h(||)f(t,)g("AND",)g
(precedence\))470 1439 y(})145 1491 y Fp(Uses)12 b Fl(Eand)e
Fp(81,)h Fl(Eorb)g Fp(81,)f Fl(M3bracket)f Fp(346d,)h
Fl(M3prec)g Fp(346d,)g(and)g Fl(prettyM3)f Fp(339a.)-17
1582 y(341d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f
Fp(339b)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(339a\))22
b Fm(/)5 b Fp(341c)22 b(341e)5 b Fm(.)187 1632 y Fr("Eslice")64
b(:)21 b("Word.Extract\(${$t)o($c")e(||)i(prettyM3\(e.x\))e(||)i(",)h
($c")f(||)g(e.lo)g(||)h(",)f(")h(||)1734 1681 y(e.n)f(||)h("$b$}\)")187
1731 y("Eshift")64 b(:)21 b("Word.Shift\(${$t$c)o(")63
b(||)21 b(prettyM3\(e.x\))e(||)i(",)h($c")f(||)g(e.n)h(||)f("$b$}\)")
145 1783 y Fp(Uses)12 b Fl(Eshift)e Fp(81,)g Fl(Eslice)g
Fp(81,)h(and)g Fl(prettyM3)d Fp(339a.)-13 1875 y(341e)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f Fp(339b)p
Fo(i)o Fv(+)p Fo(\021)566 b Fp(\(339a\))22 b Fm(/)5 b
Fp(341d)22 b(342a)5 b Fm(.)187 1924 y Fr("Enarrowu")20
b(:)h(prettyM3\(e.x,)e(precedence,)h(associativity\))f(#)i(checked,)f
(so)i(must)f(be)g(identity)187 1974 y("Enarrows")f(:)h
(prettyM3\(super_sim)o(plify)o(\(Esli)o(ce\(e)o(.x,)e(0,)i(e.n\)\),)g
(precedence,)e(associativity\))187 2024 y("Ewiden")64
b(:)21 b("Word.Insert\(${$t$)o(c")e(||)i(prettyM3\(e.x\))e(||)710
2074 y(",)i($cMATCH_bits[")e(||)710 2124 y(prettyM3\(super_si)o(mpli)o
(fy\(Es)o(lice\()o(e.x,)f(e.n-1,)j(1\)\)\))g(||)710 2173
y("],)g($c")g(||)h(e.n)f(||)g(",)g($cWord.Size)f(-)i(")f(||)h(e.n)f(||)
g("$b$}\)")145 2225 y Fp(Uses)d Fl(Enarrows)c Fp(81,)j
Fl(Enarrowu)e Fp(81,)h Fl(Eslice)f Fp(81,)i Fl(Ewiden)e
Fp(81,)i Fl(prettyM3)d Fp(339a,)187 2265 y(and)c Fl(super_simpl)o(ify)e
Fp(92c.)p eop
%%Page: 342 342
342 341 bop 129 141 a Fv(342)83 b Fr(M3exp.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(342a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)568
b Fp(\(339a\))22 b Fm(/)5 b Fp(341e)23 b(342b)t Fm(.)171
307 y Fr("Ediv")108 b(:)21 b({)h(s)f(:=)h(prettyM3\(e.x,)d
(M3prec["DIV"]\))498 357 y(s)i(||:=)g(")h(DIV)f(")h(||)f(e.n)498
407 y(M3bracket\(s,)e("DIV",)i(precedence\))454 457 y(})171
507 y("Emod")108 b(:)21 b({)h(s)f(:=)h(prettyM3\(e.x,)d
(M3prec["MOD"]\))498 557 y(s)i(||:=)g(")h(MOD)f(")h(||)f(e.n)498
606 y(M3bracket\(s,)e("MOD",)i(precedence\))454 656 y(})129
708 y Fp(Uses)12 b Fl(Ediv)e Fp(81,)h Fl(Emod)g Fp(81,)g
Fl(M3bracket)d Fp(346d,)i Fl(M3prec)g Fp(346d,)g(and)g
Fl(prettyM3)f Fp(339a.)-33 799 y(342b)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)570
b Fp(\(339a\))22 b Fm(/)5 b Fp(342a)22 b(342c)5 b Fm(.)171
849 y Fr("Semit")86 b(:)21 b({)h(s)f(:=)h(emittername)d(||)j("$t\(")e
(||)i(prettyM3\(e.x,)d(M3prec[","]\))g(||)j(",)f($o")g(||)607
899 y(e.n)g(||)g("\);$b")498 949 y(M3bracket\("$c")e(||)i(s,)h("app",)e
(precedence\))454 999 y(})129 1051 y Fp(Uses)12 b Fl(emittername)c
Fp(18a,)i Fl(M3bracket)f Fp(346d,)h Fl(M3prec)g Fp(346d,)g
Fl(prettyM3)f Fp(339a,)h(and)g Fl(Semit)g Fp(81.)-29
1142 y(342c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f
Fp(339b)p Fo(i)o Fv(+)p Fo(\021)564 b Fp(\(339a\))22
b Fm(/)5 b Fp(342b)23 b(342d)t Fm(.)171 1192 y Fr("Efitsu")64
b(:)21 b("Word.LT\(${$t$c")e(||)i(prettyM3\(e.x\))e(||)j(",)f($c")g(||)
h(\(2^e.n\))e(||)h("$b$}\)")171 1241 y("Efitss")64 b(:)21
b("Word.LT\(${$t$c")e(||)i(prettyM3\(addconst\()o(e.x,)d
(2^\(e.n-1\)\)\))i(||)h(",)h($c")f(||)1675 1291 y(\(2^e.n\))f(||)h
("$b$}\)")129 1343 y Fp(Uses)12 b Fl(addconst)d Fp(114a,)h
Fl(Efitss)g Fp(81,)h Fl(Efitsu)e Fp(81,)i(and)g Fl(prettyM3)e
Fp(339a.)-33 1434 y(342d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(339a\))22
b Fm(/)5 b Fp(342c)22 b(342e)5 b Fm(.)171 1484 y Fr("Eforce")20
b(|)i("Eforceable")41 b(:)21 b({)498 1534 y(z)g(:=)h(if)f(type\(e\))g
(==)g("Eforceable")e(then)i("_known")f(else)h("")498
1584 y(case)g(s)g(:=)h(prettyM3\(e.x\))d(of)i({)541 1634
y("$$pc")86 b(:)22 b("RBlocks.cur_pc")c(||)k(z)f(||)h("\(\)")541
1684 y("_c->loc")e(:)i("RBlocks.pc_locat)o(ion")c(||)k(z)f(||)h
("\(_c.loc\)")541 1733 y(default)64 b(:)22 b("RBlocks.location)o(")d
(||)i(z)h(||)f("$t${\(")g(||)g(s)h(||)f("\)$}$b")498
1783 y(})454 1833 y(})129 1885 y Fp(Uses)c Fl(cur_pc)d
Fp(403c,)h Fl(Eforce)f Fp(81,)h Fl(Eforceable)e Fp(81,)j
Fl(location)p Fp(,)d Fl(pc_locatio)o(n)g Fp(403c,)171
1924 y(and)e Fl(prettyM3)d Fp(339a.)-29 2016 y(342e)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f Fp(339b)p
Fo(i)o Fv(+)p Fo(\021)573 b Fp(\(339a\))22 b Fm(/)5 b
Fp(342d)22 b(342f)5 b Fm(.)171 2065 y Fr("Enot")129 b(:)22
b({)g(s)f(:=)h("NOT)f(")g(||)h(prettyM3\(e.x,)d(M3prec["NOT"]\))520
2115 y(M3bracket\(s,)g("NOT",)i(precedence\))476 2165
y(})129 2217 y Fp(Uses)12 b Fl(Enot)e Fp(81,)h Fl(M3bracket)e
Fp(346d,)h Fl(M3prec)g Fp(346d,)g(and)g Fl(prettyM3)f
Fp(339a.)-24 2308 y(342f)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)570 b Fp(\(339a\))22
b Fm(/)5 b Fp(342e)22 b(343a)5 b Fm(.)171 2358 y Fr("Enosimp")63
b(:)22 b(prettyM3\(e.x,)d(precedence,)h(associativity\))129
2410 y Fp(Uses)12 b Fl(Enosimp)d Fp(81)i(and)g Fl(prettyM3)e
Fp(339a.)p eop
%%Page: 343 343
343 342 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(M3exp.nw)81 b Fv(343)-15 258 y Fp(343a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o
Fv(+)p Fo(\021)573 b Fp(\(339a\))22 b Fm(/)5 b Fp(342f)22
b(343b)5 b Fm(.)187 307 y Fr("Sstmts")85 b(:)22 b("${")f(||)g
(commaseparate\(mapli)o(st2\()o(prett)o(yM3,)d(e.x\),)j(")h($c"\))f(||)
g("$}")145 359 y Fp(Uses)12 b Fl(prettyM3)d Fp(339a)h(and)h
Fl(Sstmts)e Fp(81.)-17 451 y(343b)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)570
b Fp(\(339a\))22 b Fm(/)5 b Fp(343a)22 b(343c)5 b Fm(.)187
500 y Fr("Gcall")20 b(:)i({)f(l)h(:=)f([];)g(every)g(put\(l,)g
(prettyM3\(!e.args)o(\)\))448 550 y(M3noreserve\(e.name\))d(||)k("\(")f
(||)g(commaseparate\(l\))e(||)i("\)")383 600 y(})187
650 y("Einstance_input)o(")e(:)j({)514 700 y(s)f(:=)h("NARROW\(")e(||)h
(prettyM3\(e.x\))e(||)623 750 y(",)i(Encode.")f(||)i(e.cons.name)d(||)i
("Instance\).")f(||)h(e.name)514 799 y(M3bracket\(s,)e(".",)i
(precedence\))470 849 y(})187 899 y("Einstance_tagge)o(d")e(:)i({)514
949 y(s)g(:=)h("ISTYPE\(")e(||)h(prettyM3\(e.x\))e(||)623
999 y(",)i(Encode.")f(||)i(e.cons.name)d(||)i("Instance\)")514
1048 y(M3bracket\(s,)e("app",)i(precedence\))470 1098
y(})145 1150 y Fp(Uses)15 b Fl(Einstance_i)o(npu)o(t)d
Fp(81,)i Fl(Einstance_)o(tag)o(ged)d Fp(81,)j Fl(Gcall)f
Fp(293a,)h Fl(Instance)e Fp(405)i(405,)187 1190 y Fl(M3bracket)8
b Fp(346d,)i Fl(M3noreserve)e Fp(347c,)i(and)h Fl(prettyM3)e
Fp(339a.)208 1260 y Fv(I)14 b(assume)g(the)h(if)f(statemen)o(t)g(has)h
(b)q(een)h(simpli\014ed,)c(so)j(there)g(are)g(no)g(arms)e(b)q(ey)o(ond)
145 1310 y(an)o(y)h Fr(else)f Fv(arm)-13 1372 y Fp(343c)88
b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f Fp(339b)p
Fo(i)o Fv(+)p Fo(\021)564 b Fp(\(339a\))22 b Fm(/)5 b
Fp(343b)22 b(343d)5 b Fm(.)187 1422 y Fr("Sif")130 b(:)21
b({)h(ifword)e(:=)i("IF)f(")514 1472 y(s)g(:=)h("")514
1522 y(every)e(a)i(:=)f(!e.arms)g(do)g({)557 1571 y(s)h(||:=)f(ifword)f
(||)i(M3test\(a.guard\))c(||)k("$t$c")e(||)i(prettyM3\(a.x\))d(||)i
("$b")557 1621 y(ifword)g(:=)g("$cELSIF)f(")514 1671
y(})514 1721 y("${")h(||)g(s)h(||)f(")h($cEND;$}")470
1771 y(})145 1823 y Fp(Uses)12 b Fl(M3test)e Fp(343e,)g
Fl(prettyM3)f Fp(339a,)h(and)g Fl(Sif)h Fp(81.)-17 1906
y(343d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f
Fp(339b)p Fo(i)o Fv(+)p Fo(\021)570 b Fp(\(339a\))22
b Fm(/)5 b Fp(343c)22 b(344a)5 b Fm(.)187 1955 y Fr("Efail")20
b(:)i(error\("Generate-)o(time)c(operation)i(failed:)h(",)g(e.msg\))145
2007 y Fp(Uses)12 b Fl(Efail)e Fp(81.)-13 2099 y(343e)88
b Fo(h)p Fn(*)15 b Fp(339a)p Fo(i)o Fv(+)p Fo(\021)1016
b Fm(/)5 b Fp(339a)22 b(346d)5 b Fm(.)187 2148 y Fr(procedure)20
b(M3test\(guard\))230 2198 y(return)h(if)g(guard_always_satisf)o
(ied\(g)o(uard\))d(then)j("TRUE)g(THEN)g(")383 2248 y(else)g("$t${")f
(||)i(prettyM3\(guard\))d(||)i("$}$b)g(THEN)g(")187 2298
y(end)145 2350 y Fp(De\014nes:)187 2389 y Fl(M3test)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(343c.)145 2429 y(Uses)i
Fl(guard_alwa)o(ys_)o(sat)o(isf)o(ie)o(d)d Fp(96b)i(and)f
Fl(prettyM3)f Fp(339a.)p eop
%%Page: 344 344
344 343 bop 129 141 a Fv(344)83 b Fr(M3exp.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(344a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)564
b Fp(\(339a\))22 b Fm(/)5 b Fp(343d)23 b(344b)t Fm(.)171
307 y Fr("Stagcase")d(:)h({)h(s)f(:=)h("TYPECASE)e(")h(||)h
(prettyM3\(e.x\))d(||)i(")h(OF$t${")476 357 y(every)f(c)g(:=)h
(kept_constructor)o(s\(e.t)o(ype\))c(do)520 407 y(s)j(||:=)g("$n|)g
(Encode.")f(||)i(c.name)e(||)i("Instance)e(=>)h($o$t${")f(||)738
457 y(prettyM3\(e.arms)o([c]\))e(||)k("$}$b")476 507
y(s)g(||)f("$nELSE)f(<*)i(ASSERT)e(FALSE)h(*>$}$b$nEND;)e(\(*)j(")f(||)
h(prettyM3\(e.x\))d(||)i("*\)")432 557 y(})129 608 y
Fp(Uses)12 b Fl(Instance)d Fp(405)i(405,)f Fl(kept_constr)o(uct)o(ors)e
Fp(33d,)i Fl(prettyM3)f Fp(339a,)h(and)h Fl(Stagcase)e
Fp(183a.)-33 700 y(344b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)570 b Fp(\(339a\))22
b Fm(/)5 b Fp(344a)22 b(344c)5 b Fm(.)171 750 y Fr("Sfail")86
b(:)21 b({)h(s)f(:=)h("fail\($t${")d(||)j(image\(escape_dol)o(lars\()o
(e.fmt)o(\)\))498 799 y(every)f(a)g(:=)h(e.a1)f(|)g(e.a2)g(|)h(e.a3)f
(do)541 849 y(s)h(||:=)f(",)g($o")h(||)f(prettyM3\(\\a,)e
(M3prec[","]\))498 899 y(s)i(||:=)g("$}$b\);")498 949
y(M3bracket\(s,)e("app",)i(precedence\))454 999 y(})171
1048 y("Sepsilon")f(:)h("\(*)g(skip)g(*\)")129 1100 y
Fp(Uses)14 b Fl(escape_doll)o(ars)c Fp(112b,)i Fl(fail)h
Fp(410,)g Fl(M3bracket)d Fp(346d,)j Fl(M3prec)e Fp(346d,)i
Fl(prettyM3)e Fp(339a,)171 1140 y Fl(Sepsilon)e Fp(81,)i(and)f
Fl(Sfail)g Fp(188c.)-29 1231 y(344c)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)564
b Fp(\(339a\))22 b Fm(/)5 b Fp(344b)23 b(344d)t Fm(.)171
1281 y Fr("Sclosure")d(:)h(prettyM3\(\\e.creatio)o(n\))e(|)i
(impossible\("creatin)o(g)e(closure"\))129 1333 y Fp(Uses)12
b Fl(prettyM3)d Fp(339a)h(and)h Fl(Sclosure)e Fp(193f.)-33
1424 y(344d)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f
Fp(339b)p Fo(i)o Fv(+)p Fo(\021)572 b Fp(\(339a\))22
b Fm(/)5 b Fp(344c)22 b(344e)5 b Fm(.)171 1474 y Fr("Glines")85
b(:)22 b({)g(s)f(:=)h("";)f(every)g(s)g(||:=)g(prettyM3\(!e.x\))e(||)i
("\\n";)g(s)h(})171 1524 y("Gresynch")41 b(:)22 b("<*)f(LINE)g(")h(||)f
(e.line)43 b(||)21 b(")g(")h(||)f(image\(\\e.file)f(|)h
("generated-code"\))d(||)k("*>")129 1576 y Fp(Uses)12
b Fl(file)e Fp(359a,)h Fl(Glines)e Fp(293a,)h Fl(Gresynch)f
Fp(293a,)h Fl(line)h Fp(359a,)f(and)g Fl(prettyM3)f Fp(339a.)-29
1667 y(344e)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f
Fp(339b)p Fo(i)o Fv(+)p Fo(\021)566 b Fp(\(339a\))22
b Fm(/)5 b Fp(344d)22 b(345a)5 b Fm(.)171 1717 y Fr("Gblock")85
b(:)22 b({)g(s)f(:=)h("${")520 1767 y(every)e(s)i(||:=)f
(prettyM3\(!e.decls)o(\))e(||)i(";$n")520 1816 y(if)g(*e.decls)f(>)i(0)
f(then)563 1866 y(s)h(||:=)f("BEGIN)f(${$t$c")520 1916
y(s)h(||:=)g(commaseparate\(mapl)o(ist\(p)o(retty)o(M3,)e(e.stmts\),)h
("$c"\))520 1966 y(if)h(*e.decls)f(>)i(0)f(then)563 2016
y(s)h(||:=)f("$b$cEND$}")520 2065 y(s)g(||)h("$}")476
2115 y(})171 2165 y("Gdecl")107 b(:)22 b({)g(s)f(:=)h("VAR)f(${")g(||)g
(e.name)520 2215 y(s)g(||:=)g(")h(:)f(")h(||)f(prettyM3\(\\e.type\))520
2265 y(s)g(||:=)g(")h(:=)f($t$c")g(||)g(prettyM3\(\\e.init\))e(||)i
("$b")520 2315 y(s)g(||)h("$}")476 2364 y(})129 2416
y Fp(Uses)12 b Fl(Gblock)e Fp(293a,)g Fl(Gdecl)g Fp(293a,)g(and)h
Fl(prettyM3)e Fp(339a.)p eop
%%Page: 345 345
345 344 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(M3exp.nw)81 b Fv(345)-15 258 y Fp(345a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o
Fv(+)p Fo(\021)572 b Fp(\(339a\))22 b Fm(/)5 b Fp(344e)22
b(345c)5 b Fm(.)187 307 y Fr("Gdeclnamearray")18 b(:)k({)230
357 y(/na_count)e(:=)i(0)230 407 y(/e.na.codename)d(:=)j("MATCH_name_")
d(||)i(e.na.field.field.n)o(ame)e(||)i("_")g(||)h(\(na_count)d(+:=)j
(1\))230 457 y(s)g(:=)f("CONST)g(${")g(||)g(e.na.codename)f(||)h(")h(=)
f(ARRAY)g([0..")g(||)g(\(e.na.hi)f(-)i(1\))f(||)g("])h(OF)f(TEXT)g({")
230 507 y(s)h(||:=)f("${$t")230 557 y(every)g(i)h(:=)f(0)h(to)f
(e.na.hi)f(-)i(1)g(do)f({)274 606 y(s)h(||:=)f(")g($c")g(||)h
(\(image\(\\e.na.tbl)o([i]\)|)o("NIL)o("\))274 656 y(if)f(i)h(<)g
(e.na.hi)e(-)h(1)h(then)f(s)h(||:=)f(",")230 706 y(})230
756 y(s)h(||)f("$b$c$}}")187 806 y(})145 857 y Fp(Uses)12
b Fl(field)e Fp(55)h(and)g Fl(Gdeclname)o(arr)o(ay)d
Fp(293b.)-17 949 y(345b)88 b Fo(h)p Fn(lo)n(c)n(al)15
b(de)n(clar)n(ations)f(for)h Fr(prettyM3)e Fp(341b)p
Fo(i)o Fv(+)p Fo(\021)468 b Fp(\(339a\))21 b Fm(/)6 b
Fp(341b)187 999 y Fr(static)20 b(na_count)-13 1090 y
Fp(345c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e Fr(prettyM3)f
Fp(339b)p Fo(i)o Fv(+)p Fo(\021)568 b Fp(\(339a\))22
b Fm(/)5 b Fp(345a)22 b(346a)5 b Fm(.)187 1140 y Fr("Gcase")107
b(:)22 b({)f(s)h(:=)f("CASE)g(${")g(||)h(prettyM3\(e.x\))d(||)i("$})g
(OF)h(")535 1190 y(every)f(s)h(||:=)f(prettyM3\(!e.arms)o(\))535
1239 y("${")g(||)h(s)f(||)h("$nEND;)e(\(*)i(CASE)e(${")i(||)f
(prettyM3\(e.x\))e(||)j("$})f(*\)$}")514 1289 y(})187
1339 y("Gcasearm")41 b(:)22 b({)f(s)h(:=)f("$n|)g($t")535
1389 y(every)g(i)h(:=)f(1)h(to)f(*e.tags)g(by)g(2)g(do)h({)579
1439 y(if)f(i)h(>)g(1)f(then)g(s)h(||:=)f(",)g($o")579
1488 y(s)h(||:=)f(if)g(e.tags[i])f(+)i(1)f(=)h(e.tags[i+1])d(then)i
(e.tags[i])732 1538 y(else)g(e.tags[i])f(||)h("..")g(||)g
(\(e.tags[i+1]-1\))535 1588 y(})535 1638 y(s)h(||:=)f(")h(=>)f(")43
b(||)22 b("$t$c")e(||)i(prettyM3\(e.x\))535 1688 y("${")f(||)h(s)f(||)h
("$b$b$}")492 1738 y(})145 1789 y Fp(Uses)12 b Fl(Gcase)e
Fp(294a,)g Fl(Gcasearm)f Fp(294a,)h(and)h Fl(prettyM3)e
Fp(339a.)p eop
%%Page: 346 346
346 345 bop 129 141 a Fv(346)83 b Fr(M3exp.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(346a)88 b Fo(h)p Fn(c)n(ases)16
b(for)e Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)568
b Fp(\(339a\))22 b Fm(/)5 b Fp(345c)23 b(346b)t Fm(.)171
307 y Fr("Ginrange")41 b(:)22 b({)g(x)f(:=)h(prettyM3\(e.x,)d
(M3prec["<"]\))520 357 y(if)i(e.lo)g(+)h(1)f(=)h(e.hi)f(then)g({)563
407 y(M3bracket\(x)f(||)h(")h(=)f(")h(||)f(e.lo,)g("=",)g
(M3prec["AND"]\))520 457 y(})g(else)g({)563 507 y(c1)h(:=)f
(M3bracket\(e.lo)e(||)i(")h(<=)f(")h(||)f(x,)h("<=",)e(M3prec["AND"]\))
563 557 y(c2)i(:=)f(M3bracket\(x)f(||)h(")g(<)h(")g(||)f(e.hi,)g("<",)g
(M3prec["AND"]\))563 606 y(M3bracket\(c1)f(||)h(")h(AND)f(")g(||)h(c2,)
f("AND",)f(precedence\))520 656 y(})476 706 y(})171 756
y("Gsetname")41 b(:)22 b("${VAR)f(")g(||)h(e.lhs)e(||)i(")f(:=)h($t$o")
e(||)i(case)f(type\(e.name\))e(of)i({)585 806 y("string")86
b(:)21 b(image\(e.name\))585 855 y("namearray")f(:)h(e.name.codename)e
(||)i("[")g(||)h(prettyM3\(e.name.)o(field)o(\))d(||)i("]")585
905 y(default)108 b(:)21 b(impossible\("type)e(of)i(node)g(name)g
(field"\))476 955 y(})h(||)f("$b$}")171 1005 y("Gasgn")42
b(:)22 b("${")f(||)g(e.lhs)g(||)g(")h(:=)f($t$o")g(||)g(prettyM3\(e.x,)
e(M3prec["="]\))h(||)h(";$b$}")171 1055 y("Gcomment")41
b(:)22 b("\(*)f(")h(||)f(e.s)g(||)h(")f(*\)")171 1104
y("Gcommented")e(:)215 1154 y(prettyM3\(e.e,)g(precedence,)g
(associativity,)g(nohex\))i(||)g(")h(\(*)f(")h(||)f(e.comment)f(||)h(")
h(*\)")129 1206 y Fp(Uses)13 b Fl(field)d Fp(55,)i Fl(Gasgn)e
Fp(294a,)h Fl(Gcomment)e Fp(20,)j Fl(Gcommente)o(d)d
Fp(299a,)i Fl(Ginrange)e Fp(294a,)i Fl(Gsetname)e Fp(294a,)171
1246 y Fl(M3bracket)g Fp(346d,)h Fl(M3prec)f Fp(346d,)h
Fl(namearray)f Fp(291a,)h Fl(node)g Fp(272,)h(and)f Fl(prettyM3)f
Fp(339a.)-33 1337 y(346b)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)570 b Fp(\(339a\))22
b Fm(/)5 b Fp(346a)22 b(346c)5 b Fm(.)171 1387 y Fr("Gnomatch")41
b(:)22 b("<*)f(ASSERT)g(FALSE)g(*>)g(\(*)g(no)h(match)e(*\)")171
1437 y("Tunsigned")f(:)j(if)f(\\e.width)g(<)g(wordsize)f(then)541
1486 y("[0..")h(||)g(\(2^e.width-1\))e(||)j("]")476 1536
y(else)541 1586 y("Word.T")129 1638 y Fp(Uses)12 b Fl(Gnomatch)d
Fp(294a,)h Fl(Tunsigned)f Fp(294a,)h(and)g Fl(wordsize)f
Fp(38c.)-29 1729 y(346c)88 b Fo(h)p Fn(c)n(ases)16 b(for)e
Fr(prettyM3)f Fp(339b)p Fo(i)o Fv(+)p Fo(\021)684 b Fp(\(339a\))22
b Fm(/)5 b Fp(346b)171 1779 y Fr("absolute_field")18
b(:)258 1829 y(prettyM3\(super_sim)o(plify)o(\(afie)o(ldexp)o(\(e\)\))o
(,)h(precedence,)h(associativity,)e(nohex\))129 1881
y Fp(Uses)12 b Fl(absolute_fi)o(eld)c Fp(268,)i Fl(afieldexp)f
Fp(299a,)h Fl(prettyM3)f Fp(339a,)h(and)h Fl(super_simp)o(li)o(fy)d
Fp(92c.)-33 1972 y(346d)88 b Fo(h)p Fn(*)16 b Fp(339a)p
Fo(i)n Fv(+)q Fo(\021)1017 b Fm(/)5 b Fp(343e)23 b(347b)t
Fm(.)171 2022 y Fr(global)e(M3prec,)f(M3assoc)171 2072
y(procedure)g(M3bracket\(s,)f(op,)i(p,)h(a\))215 2121
y(/a)f(:=)g("L")215 2171 y(return)f("${")h(||)g(\(if)h(M3prec[op])d(>)j
(p)g(|)f(\(M3prec[op])f(=)h(p)h(&)f(M3assoc[p])f(==)h(a\))h(then)f(s)
585 2221 y(else)g("\(")g(||)h(s)f(||)h("\)"\))e(||)i("$}")171
2271 y(end)129 2323 y Fp(De\014nes:)171 2362 y Fl(M3assoc)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(347a.)171 2402 y Fl(M3bracket)p
Fp(,)e(used)j(in)g(c)o(h)o(unks)f(340{44)f(and)i(346a.)171
2441 y Fl(M3prec)p Fp(,)e(used)i(in)g(c)o(h)o(unks)f(340{42,)f(344b,)h
(346a,)h(and)f(347a.)p eop
%%Page: 347 347
347 346 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(M3exp.nw)81 b Fv(347)-15 258 y Fp(347a)88 b Fo(h)p
Fn(initialize)14 b Fr(M3prec)g Fn(and)h Fr(M3assoc)f
Fp(347a)p Fo(i)o(\021)634 b Fp(\(339a\))187 307 y Fr(ops)21
b(:=)g(["N",)g(["low"],)361 357 y("L",)g([";"],)361 407
y("L",)g([","],)361 457 y("L",)g(["OR"],)361 507 y("L",)g(["AND"],)361
557 y("L",)g(["NOT"],)361 606 y("L",)g(["<=",)g("<",)g(">=",)f(">",)h
("=",)g("#",)g("IN"],)361 656 y("L",)g(["+",)g("-",)g("&"],)361
706 y("L",)g(["MOD",)f("DIV",)h("*",)g("/"],)361 756
y("L",)g(["^"],)361 806 y("L",)g(["app"],)361 855 y("L",)g(["."],)361
905 y("N",)g(["high"])339 955 y(])187 1005 y(M3prec)f(:=)i(table\([]\))
41 b(#)22 b(missed)f(lookups)f(break)h(arithmetic)e(comparisons)187
1055 y(M3assoc)h(:=)i(table\(\))187 1104 y(every)f(i)g(:=)h(1)f(to)g
(*ops)g(by)h(2)f(do)h({)230 1154 y(every)f(M3prec[!ops[i+1]])d(:=)k(i)
230 1204 y(M3assoc[i])e(:=)h(ops[i])187 1254 y(})145
1306 y Fp(Uses)12 b Fl(M3assoc)d Fp(346d)i(and)f Fl(M3prec)g
Fp(346d.)-17 1397 y(347b)88 b Fo(h)p Fn(*)15 b Fp(339a)p
Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5 b Fp(346d)22 b(347c)5
b Fm(.)187 1447 y Fr(procedure)20 b(M3op\(op\))230 1497
y(return)h(if)g(op)h(==)f("!=")g(then)g("#")g(else)g(op)187
1547 y(end)145 1598 y Fp(De\014nes:)187 1638 y Fl(M3op)p
Fp(,)10 b(used)g(in)i(c)o(h)o(unk)e(340a.)-13 1729 y(347c)88
b Fo(h)p Fn(*)15 b Fp(339a)p Fo(i)o Fv(+)p Fo(\021)1033
b Fm(/)6 b Fp(347b)22 b(348)5 b Fm(.)187 1779 y Fr(procedure)20
b(M3noreserve\(word)o(\))230 1829 y(static)h(reserved)230
1879 y(initial)g(reserved)f(:=)h(set\([)339 1928 y("AND",)g("ANY",)f
("ARRAY",)h("AS",)f("BEGIN",)g("BITS",)h("BRANDED",)f("BY",)g("CASE",)
339 1978 y("CONST",)g("DIV",)h("DO",)g("ELSE",)f("ELSIF",)g("END",)h
("EVAL",)f("EXCEPT",)339 2028 y("EXCEPTION",)g("EXIT",)g("EXPORTS",)g
("FINALLY",)f("FOR",)i("FROM",)f("GENERIC",)339 2078
y("IF",)h("IMPORT",)f("IN",)h("INTERFACE",)e("LOCK",)h("LOOP",)h
("METHODS",)f("MOD",)339 2128 y("MODULE",)g("NOT",)h("OBJECT",)f("OF",)
h("OR",)f("OVERRIDES",)g("PROCEDURE",)339 2178 y("RAISE",)g("RAISES",)g
("READONLY",)g("RECORD",)g("REF",)g("REPEAT",)g("RETURN",)339
2227 y("REVEAL",)g("ROOT",)h("SET",)f("THEN",)h("TO",)f("TRY",)h
("TYPE",)f("TYPECASE",)339 2277 y("UNSAFE",)g("UNTIL",)g("UNTRACED",)g
("VALUE",)g("VAR",)h("WHILE",)f("WITH"]\))230 2327 y(return)h(if)g
(member\(reserved,)e(word\))i(then)g(M3noreserve\(wor)o(d||"_)o("\))e
(else)i(word)187 2377 y(end)145 2429 y Fp(De\014nes:)187
2468 y Fl(M3noreserv)o(e)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(343b.)p
eop
%%Page: 348 348
348 347 bop 129 141 a Fv(348)83 b Fr(M3exp.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)129 258 y Fj(18.1)66 b(Supp)r(ort)24
b(for)e(deco)r(ding)h(co)r(de)f(in)h(Mo)r(dula-3)-13
349 y Fp(348)88 b Fo(h)p Fn(*)16 b Fp(339a)p Fo(i)n Fv(+)q
Fo(\021)1136 b Fm(/)6 b Fp(347c)171 398 y Fr(procedure)20
b(Generate_M3\(\))215 448 y(eqntoC)g(:=)h(eqntoM3)215
498 y(pretty)f(:=)h(prettyM3)215 548 y(gen_outer_decls)d(:=)k
([literal\()324 598 y("CONST)e(MATCH_bits)g(=)h(ARRAY)g([0..1])g(OF)g
(Word.T)g({0,)g(Word.Not\(0\)}"\)])215 647 y(gen_file_header)d(:=)k("")
215 697 y(fetchtab["type")o(])d(:=)i("ADDRESS")215 747
y(fetchtab["add"])d(:=)k("LOOPHOLE\(\045a+\045o,)c(Word.T\)")215
797 y(fetchtab["pc"])g(:=)44 b("\045a")171 847 y(#)f(fetchtab[8])f(:=)
21 b("LOOPHOLE\(\045a+\(\045o/A)o(DRSI)o(ZE\(CH)o(AR\)\),)d(UNTRACED)i
(REF)i([0..255]\)^")171 897 y(#)43 b(fetchtab[16])20
b(:=)h("LOOPHOLE\(\045a+\(\045o/A)o(DRSI)o(ZE\(CH)o(AR\)\),)d(UNTRACED)
i(REF)i([0..65535]\)^")171 946 y(#)43 b(fetchtab[32])20
b(:=)h("LOOPHOLE\(\045a+\(\045o/A)o(DRSI)o(ZE\(CH)o(AR\)\),)d(UNTRACED)
i(REF)i(INTEGER\)^")171 996 y(end)129 1148 y Fp(De\014nes:)171
1187 y Fl(Generate_M)o(3)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(15f.)129
1227 y(Uses)15 b Fl(fetchtab)d Fp(295a,)h Fl(gen_file_h)o(ea)o(der)e
Fp(294d,)i Fl(gen_outer_)o(dec)o(ls)e Fp(294d,)i Fl(literal)f
Fp(45e,)171 1266 y Fl(pretty)e Fp(18a,)g(and)h Fl(prettyM3)e
Fp(339a.)p eop
%%Page: 349 349
349 348 bop 145 569 a Fq(Chapter)32 b(19)145 777 y Fu(Miscellaneous)145
901 y(co)s(de-generation)39 b(pro)s(cedures)208 1117
y Fv(V)m(alue)17 b(computation)f(and)i(shifting)e(is)i(straigh)o(tforw)
o(ard;)h(the)f(only)f(detail)h(is)f(that)145 1167 y(signed)d(v)n(alues)
g(ha)o(v)o(e)g(to)f(b)q(e)i(mask)o(ed)e(to)g(remo)o(v)o(e)g(the)i
(high-order)f(\(sign\))g(bits.)-15 1229 y Fp(349a)88
b Fo(h)p Fn(*)15 b Fp(349a)p Fo(i)o(\021)1165 b Fp(349b)5
b Fm(.)187 1279 y Fr(procedure)20 b(unsignedval\(f,)f(val\))230
1329 y(constant\(val\))g(=)j(0)g(|)f(return)g(Cshift\(val,)e("left",)i
(f.lo\))187 1378 y(end)187 1428 y(procedure)f(signedval\(f,)f(val\))230
1478 y(constant\(val\))g(=)j(0)g(|)230 1528 y(return)f
(Cshift\(Cmask\(val,)d(fwidth\(f\)\),)i("left",)g(f.lo\))187
1578 y(end)145 1630 y Fp(De\014nes:)187 1669 y Fl(signedval)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(349c.)187 1708 y Fl(unsignedva)o(l)p
Fp(,)e(used)j(in)g(c)o(h)o(unk)f(349c.)145 1748 y(Uses)i
Fl(constant)d Fp(114b)h(and)h Fl(fwidth)e Fp(115d.)145
1810 y Fv(Signed)14 b(and)g(unsigned)g(v)n(alues)g(are)g(stored)h(in)e
Fr(fieldval)-17 1872 y Fp(349b)88 b Fo(h)p Fn(*)15 b
Fp(349a)p Fo(i)o Fv(+)p Fo(\021)1035 b Fm(/)6 b Fp(349a)22
b(350)5 b Fm(.)187 1922 y Fr(procedure)20 b(init_tests\(\))230
1972 y Fo(h)p Fn(init)15 b Fp(349c)p Fo(i)230 2022 y
Fr(return)187 2072 y(end)187 2121 y(global)20 b(fieldval)145
2173 y Fp(De\014nes:)187 2213 y Fl(init_tests)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)d(20.)-13 2296 y(349c)88 b
Fo(h)p Fn(init)15 b Fp(349c)p Fo(i)o(\021)1006 b Fp(\(349b\))21
b(351c)5 b Fm(.)187 2346 y Fr(fieldvals)20 b(:=)h(table\(\))187
2395 y(fieldvals["field)o("])e(:=)i(unsignedval;)f(fieldvals["exte)o
(nded")o(])f(:=)i(signedval)145 2447 y Fp(Uses)12 b Fl(field)e
Fp(55,)h Fl(signedval)d Fp(349a,)i(and)h Fl(unsignedval)d
Fp(349a.)830 2604 y Fv(349)p eop
%%Page: 350 350
350 349 bop 129 141 a Fv(350)83 b Fr(code.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(Size)j(testing)g(is)f(straigh)o(tforw)o
(ard)g(but)h(tedious.)23 b(Constan)o(ts,)16 b(whic)o(h)g(usually)e
(come)129 307 y(from)i(constrain)o(ts)i(in)f(disjuncts,)h(are)f(tested)
i(at)e(generation)h(time.)26 b(Unsigned)18 b(v)n(alues)129
357 y(require)d(a)f(single)f(test;)i(signed)f(v)n(alues)f(require)i(t)o
(w)o(o)f(\(i.e.)f(a)g(range)h(test\).)-13 420 y Fp(350)88
b Fo(h)p Fn(*)16 b Fp(349a)p Fo(i)n Fv(+)q Fo(\021)1015
b Fm(/)5 b Fp(349b)22 b(351a)5 b Fm(.)171 469 y Fr(procedure)20
b(unsignedtest\(outf)o(ile,)e(f,)k(value,)e(inputs\))215
519 y(bits)h(:=)g(fwidth\(f\))215 569 y(bits)g(>=)g(f.class.size)e(|)
215 619 y(if)i(v)h(:=)f(constant\(value\))e(then)258
669 y(v)j(<)f(2^bits)g(|)258 718 y(error\("spec)f(forces)g(",)i
(f.name,)e(")i(=)f(",)g(v,)h(",)f(which)g(won't)g(fit)g(in)g(",)h
(bits,)e(")i(bits"\))215 768 y(else)f({)258 818 y(value)g(:=)g
(eqntoC\(value,)e(inputs,)i(1\))258 868 y(write\(outfile,)e
(indent\(\),)h("if)h(\(\(unsigned\)\(",)e(value,)i("\))g(>)h(",)f
(mask\(bits\),)e("\)\\n",)302 918 y(indent\(2\),)g("\(*fail\)\(",)302
967 y(image\(f.name)g(||)i(")h(=)g(\045d)f(won't)g(fit)g(in)g(")h(||)f
(bits)g(||)h(")f(bits"\),)302 1017 y(",)g(",)g(value,)g("\);"\))215
1067 y(})215 1117 y(return)171 1167 y(end)171 1217 y(procedure)f
(unsignedcond\(f,)f(value,)h(inputs\))215 1266 y(bits)h(:=)g
(fwidth\(f\))215 1316 y(value)f(:=)i(eqntoC\(value,)d(inputs,)h(1\))215
1366 y(return)g("\(\(unsigned\)\(")f(||)i(value)g(||)h("\))f(<=)g(")h
(||)f(mask\(bits\))f(||)h("\)")171 1416 y(end)129 1468
y Fp(De\014nes:)171 1507 y Fl(unsignedco)o(nd)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(351c.)171 1547 y Fl(unsignedte)o(st)p
Fp(,)e(used)j(in)g(c)o(h)o(unk)f(351c.)129 1586 y(Uses)i
Fl(constant)d Fp(114b,)h Fl(fail)g Fp(410,)h Fl(fwidth)f
Fp(115d,)g Fl(indent)f Fp(352b,)h Fl(mask)h Fp(352a,)f(and)g
Fl(value)g Fp(136a.)p eop
%%Page: 351 351
351 350 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)788
b Fr(code.nw)81 b Fv(351)-15 258 y Fp(351a)88 b Fo(h)p
Fn(*)15 b Fp(349a)p Fo(i)o Fv(+)p Fo(\021)1033 b Fm(/)6
b Fp(350)22 b(351b)5 b Fm(.)187 307 y Fr(procedure)20
b(signedtest\(outfi)o(le,)f(f,)i(value,)g(inputs\))230
357 y(bits)g(:=)h(fwidth\(f\))230 407 y(bits)f(>=)h(f.class.size)d(|)
230 457 y(if)j(v)f(:=)h(constant\(value\))c(then)274
507 y(-\(2^\(bits-1\)\))h(<=)i(v)h(<)g(2^\(bits-1\))d(|)274
557 y(error\("spec)g(forces)i(",)g(f.name,)g(")g(=)h(",)f(v,)h(",)f
(which)g(won't)g(fit)g(in)g(",)h(bits,)e(")i(signed)e(bits"\))230
606 y(else)h({)274 656 y(value)g(:=)g(eqntoC\(value,)e(inputs,)i(1\))
274 706 y(write\(outfile,)e(indent\(\),)h("if)h(\(\(int\)\(",)f(value,)
g("\))i(<)f(-",)h(tworaised\(bits-)o(1\),)d(")i(||\\n",)318
756 y(indent\(2\),)e("\(int\)\(",)h(value,)h("\))g(>=)h(",)f
(tworaised\(bits-1\))o(,)e("\)\\n",)318 806 y(indent\(2\),)g
("\(*fail\)\(",)318 855 y(image\(f.name)g(||)i(")h(=)f(\045d)h(won't)f
(fit)g(in)g("||)g(bits)g(||)h(")f(signed)g(bits"\),)318
905 y(",)g(",)g(value,)g("\);"\))230 955 y(})230 1005
y(return)187 1055 y(end)187 1104 y(procedure)f(signedcond\(f,)f(value,)
h(inputs\))230 1154 y(bits)h(:=)h(fwidth\(f\))230 1204
y(value)f(:=)h(eqntoC\(value,)d(inputs,)h(1\))230 1254
y(return)h("\(\(int\)\(")f(||)h(value)g(||)g("\))h(>=)f(-")h(||)f
(tworaised\(bits-1\))d(||)k(")f(&&)h(\\n")f(||)405 1304
y("\(int\)\(")f(||)h(value)g(||)g("\))h(<)f(")h(||)f
(tworaised\(bits-1\))e(||)i("\)")187 1354 y(end)145 1401
y Fp(De\014nes:)187 1441 y Fl(signedcond)o Fp(,)9 b(used)h(in)i(c)o(h)o
(unk)d(351c.)187 1480 y Fl(signedtest)o Fp(,)g(used)h(in)i(c)o(h)o(unk)
d(351c.)145 1520 y(Uses)j Fl(constant)d Fp(114b,)h Fl(fail)g
Fp(410,)h Fl(fwidth)e Fp(115d,)i Fl(indent)e Fp(352b,)h
Fl(tworaised)f Fp(352a,)h(and)h Fl(value)e Fp(136a.)-17
1594 y(351b)88 b Fo(h)p Fn(*)15 b Fp(349a)p Fo(i)o Fv(+)p
Fo(\021)1016 b Fm(/)5 b Fp(351a)22 b(351d)5 b Fm(.)187
1644 y Fr(global)20 b(fieldconds,)g(fieldtests)145 1692
y Fp(De\014nes:)187 1731 y Fl(fieldconds)o Fp(,)9 b(used)h(in)i(c)o(h)o
(unk)d(351c.)187 1771 y Fl(fieldtests)o Fp(,)g(used)h(in)i(c)o(h)o(unk)
d(351c.)-13 1845 y(351c)88 b Fo(h)p Fn(init)15 b Fp(349c)p
Fo(i)o Fv(+)p Fo(\021)974 b Fp(\(349b\))21 b Fm(/)6 b
Fp(349c)187 1895 y Fr(every)21 b(fieldconds)e(|)j(fieldtests)e(:=)h
(table\(\))187 1945 y(fieldconds["fiel)o(d"])e(:=)i(unsignedcond;)e
(fieldconds["extend)o(ed"])f(:=)k(signedcond)187 1995
y(fieldtests["fiel)o(d"])d(:=)i(unsignedtest;)e(fieldtests["extend)o
(ed"])f(:=)k(signedtest)145 2043 y Fp(Uses)13 b Fl(field)f
Fp(55,)g Fl(fieldconds)d Fp(351b,)j Fl(fieldtest)o(s)e
Fp(351b,)i Fl(signedcon)o(d)e Fp(351a,)i Fl(signedtes)o(t)e
Fp(351a,)187 2082 y Fl(unsignedco)o(nd)e Fp(350,)j(and)f
Fl(unsignedtes)o(t)f Fp(350.)208 2144 y Fr(testcondition)j
Fv(generates)17 b(co)q(de)f(to)g(test)g(an)f(arbitrary)g(condition)g
(generated)i(b)o(y)145 2194 y(the)e(solv)o(er.)-17 2252
y Fp(351d)88 b Fo(h)p Fn(*)15 b Fp(349a)p Fo(i)o Fv(+)p
Fo(\021)1016 b Fm(/)5 b Fp(351b)22 b(352a)5 b Fm(.)187
2302 y Fr(procedure)20 b(testcondition\(ou)o(tfile)o(,)f(cond,)i
(inputs\))274 2352 y(write\(outfile,)e(indent\(\),)h("if)h(\(!\(",)g
(eqntoC\(cond,)e(inputs,)h(1\),)i("\)\)\\n",)405 2402
y(indent\(2\),)d("\(*fail\)\(\\"Condition)f(",)j(expimage\(cond\),)e(")
j(not)f(satisified.\\"\);"\))187 2452 y(end)145 2499
y Fp(Uses)12 b Fl(expimage)d Fp(101a,)h Fl(fail)g Fp(410,)h(and)f
Fl(indent)g Fp(352b.)p eop
%%Page: 352 352
352 351 bop 129 141 a Fv(352)83 b Fr(code.nw)787 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(These)i(functions)f(compute)f(the)i
(constan)o(ts)f(against)g(whic)o(h)f(v)n(alues)h(are)g(tested.)-31
320 y Fp(352a)88 b Fo(h)p Fn(*)16 b Fp(349a)p Fo(i)n
Fv(+)q Fo(\021)1013 b Fm(/)5 b Fp(351d)23 b(352b)t Fm(.)171
370 y Fr(global)e(hex_prefix)171 420 y(procedure)f(mask\(bits\))215
469 y(return)g(hex_prefix)g(||)h(\(\(0)g(~=)h(\(2^\(bits)e(\045)h(4\))h
(-)f(1\)\))h(|)f(""\))g(||)h(repl\("f",)e(bits)h(/)g(4\))171
519 y(end)171 569 y(procedure)f(tworaised\(bits\))215
619 y(return)g(hex_prefix)g(||)h(\(2^\(bits)f(\045)i(4\)\))f(||)g
(repl\("0",)f(bits)h(/)h(4\))171 669 y(end)129 720 y
Fp(De\014nes:)171 760 y Fl(hex_prefix)o Fp(,)9 b(used)i(in)g(c)o(h)o
(unk)f(338a.)171 799 y Fl(mask)p Fp(,)g(used)h(in)g(c)o(h)o(unks)f
(318b,)g(327d,)g(and)g(350.)171 839 y Fl(tworaised)p
Fp(,)e(used)j(in)g(c)o(h)o(unks)f(329g)g(and)h(351a.)-33
922 y(352b)88 b Fo(h)p Fn(*)16 b Fp(349a)p Fo(i)n Fv(+)q
Fo(\021)1134 b Fm(/)6 b Fp(352a)171 972 y Fr(procedure)20
b(indent\(n\))258 1021 y(initial)g(/sindent)h(:=)g(2)258
1071 y(return)g(repl\(")f(",)i(sindent)e(+)i(\(\\n)f(|)g(0\)\))171
1121 y(end)129 1173 y Fp(De\014nes:)171 1212 y Fl(indent)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(350)h(and)f(351.)p
eop
%%Page: 353 353
353 352 bop 145 569 a Fq(Chapter)32 b(20)145 777 y Fu(Field-dep)s
(enden)m(t)145 901 y(information)145 1142 y Fj(20.1)66
b(Field)24 b(categories)145 1233 y Fv(There)18 b(are)f(a)f(n)o(um)o(b)q
(er)f(of)h(things)g(one)h(w)o(an)o(ts)f(to)g(kno)o(w)g(ab)q(out)g(eac)o
(h)h(\014eld,)g(dep)q(ending)145 1283 y(on)g(whether)h(one)f(is)g(to)g
(assem)o(ble,)g(disassem)o(ble,)f(or)h(generate)h(C)f(co)q(de)h(for)e
(assem)o(bly)m(.)145 1332 y(Here's)f(a)f(ten)o(tativ)o(e)g
(classi\014cation:)208 1415 y Fo(\017)20 b Fv(Ho)o(w)14
b(to)f(disassem)o(ble)296 1498 y Fs({)20 b Fv(arra)o(y)14
b(of)f(names)296 1565 y Fs({)20 b Fv(en)o(umeration)13
b(\(for)h(sparsely)g(p)q(opulated)g(\014elds\))296 1631
y Fs({)20 b Fr(printf)13 b Fv(format)f(string)i(\(e.g.)k(for)13
b(MIPS)i Fr(spec03)p Fv(\)?)208 1714 y Fo(\017)20 b Fv(T)o(yp)q(e)12
b(of)f(argumen)o(t)f(to)i(pass)g(to)f(C)g(or)h(Mo)q(dula-3)e(pro)q
(cedure)k(\(could)d(b)q(e)h(en)o(umera-)249 1764 y(tion)g(or)h
(subrange)h(t)o(yp)q(e,)f(for)g(example\).)j(Di\013eren)o(t)e(t)o(yp)q
(es)g(ma)o(y)d(require)i(di\013eren)o(t)249 1814 y(v)n(alue)g(c)o(hec)o
(king)i(within)e(the)h(pro)q(cedure.)208 1897 y Fo(\017)20
b Fv(Literals)296 1980 y Fs({)g Fv(C)14 b Fr(enum)p Fv(s)g(or)f
(constan)o(ts)296 2046 y Fs({)20 b Fv(use)15 b(in)f(assem)o(bly)e(co)q
(de)j(\(syn)o(tactic)g(category?\))208 2129 y(If)h(\014eld)i(names)e
(are)h(sp)q(eci\014ed,)i(they)f(are)g(k)o(ept)f(in)g(a)g(name-to-v)n
(alue)e(table.)27 b(That)145 2179 y(table)10 b(is)g(asso)q(ciated)h
(with)f(the)h(\014eld)f(in)g(the)h(global)d(table)i Fr(fnt)g
Fv(\(standing)g(for)g(\\\014eld-name)145 2229 y(table"\).)2
2291 y Fp(353)89 b Fo(h)p Fn(*)15 b Fp(353)p Fo(i\021)1184
b Fp(354a)5 b Fm(.)187 2341 y Fr(global)20 b(fnt)305
b(#)21 b(field)g(->)h(name)f(->)g(value)145 2393 y Fp(De\014nes:)187
2432 y Fl(fnt)p Fp(,)10 b(used)h(in)g(c)o(h)o(unks)f(354a)g(and)h
(356a.)145 2472 y(Uses)h Fl(field)e Fp(55)h(and)g Fl(value)f
Fp(136a.)830 2604 y Fv(353)p eop
%%Page: 354 354
354 353 bop 129 141 a Fv(354)83 b Fr(fieldinfo.nw)677
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(354a)88
b Fo(h)p Fn(*)16 b Fp(353)p Fo(i)o Fv(+)p Fo(\021)1059
b Fm(/)6 b Fp(353)22 b(354f)5 b Fm(.)171 307 y Fr(procedure)20
b(fieldinfo\(f,)f(info\))258 357 y(initial)h({)i(/fnt)f(:=)g
(table\(\);)g(/fieldasm)e(:=)j(table\(\))e(})258 407
y(case)h(type\(info\))f(of)h({)345 457 y("string")f(:)44
b(case)21 b(info)g(of)g({)h("checked")85 b(:)22 b({)f
Fo(h)p Fn(make)16 b Fr(f)e Fn(che)n(cke)n(d)i Fp(354b)p
Fo(i)k Fr(})934 507 y("unchecked")41 b(:)22 b({)f Fo(h)p
Fn(make)16 b Fr(f)e Fn(unche)n(cke)n(d)i Fp(354c)p Fo(i)21
b Fr(})934 557 y("guaranteed")e(:)j({)f Fo(h)p Fn(make)16
b Fr(f)e Fn(guar)n(ante)n(e)n(d)i Fp(354d)p Fo(i)k Fr(})934
606 y(default)g(:)i({)f Fo(h)p Fn(c)n(omplain)15 b(ab)n(out)h
(\014eldsp)n(e)n(c)f Fr(info)f Fp(354e)p Fo(i)21 b Fr(})890
656 y(})345 706 y("namespec")42 b(:)21 b(\(/fnt[f])g(:=)g
(check_namespec\(in)o(fo,)e(f\)\))i(|)716 756 y(error\("Field)e(names)i
(for)g(field)g(",)g(f.name,)g(")g(already)f(specified"\))345
806 y(default)108 b(:)21 b(fail)258 855 y(})258 905 y(return)171
955 y(end)129 1007 y Fp(De\014nes:)171 1046 y Fl(fieldinfo)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(37c.)129 1086 y(Uses)i
Fl(check_names)o(pec)c Fp(355d,)i Fl(fail)g Fp(410,)h
Fl(field)f Fp(55,)h Fl(fnt)f Fp(353,)h(and)f Fl(namespec)f
Fp(355a.)-33 1177 y(354b)88 b Fo(h)p Fn(make)16 b Fr(f)e
Fn(che)n(cke)n(d)i Fp(354b)p Fo(i)o(\021)904 b Fp(\(354a\))171
1227 y Fr(every)21 b(delete\(guarantee)o(d_fie)o(lds)e(|)i
(unchecked_fields,)d(f\))129 1279 y Fp(Uses)12 b Fl(guaranteed_)o(fie)o
(ld)o(s)d Fp(354f)h(and)h Fl(unchecked_)o(fie)o(lds)d
Fp(354f.)-29 1370 y(354c)88 b Fo(h)p Fn(make)16 b Fr(f)e
Fn(unche)n(cke)n(d)j Fp(354c)p Fo(i)n(\021)863 b Fp(\(354a\))171
1420 y Fr(insert\(unchecked_)o(field)o(s,)19 b(f\))171
1470 y(delete\(guaranteed)o(_fiel)o(ds,)g(f\))129 1522
y Fp(Uses)12 b Fl(guaranteed_)o(fie)o(ld)o(s)d Fp(354f)h(and)h
Fl(unchecked_)o(fie)o(lds)d Fp(354f.)-33 1613 y(354d)88
b Fo(h)p Fn(make)16 b Fr(f)e Fn(guar)n(ante)n(e)n(d)i
Fp(354d)p Fo(i)n(\021)847 b Fp(\(354a\))171 1663 y Fr(every)21
b(insert\(guarantee)o(d_fie)o(lds)e(|)i(unchecked_fields,)d(f\))129
1715 y Fp(Uses)12 b Fl(guaranteed_)o(fie)o(ld)o(s)d Fp(354f)h(and)h
Fl(unchecked_)o(fie)o(lds)d Fp(354f.)-29 1806 y(354e)88
b Fo(h)p Fn(c)n(omplain)16 b(ab)n(out)f(\014eldsp)n(e)n(c)g
Fr(info)f Fp(354e)p Fo(i)o(\021)652 b Fp(\(354a\))171
1856 y Fr(error\("Unknown)19 b(field)i(info)g(specifier)f(`",)h(info,)f
("'"\))129 1908 y Fp(Uses)12 b Fl(field)e Fp(55.)192
1978 y Fv(Fields)k(can)g(b)q(e)g(c)o(hec)o(k)o(ed)h(or)f(unc)o(hec)o(k)
o(ed)i(at)d(assem)o(bly)g(time.)-24 2041 y Fp(354f)88
b Fo(h)p Fn(*)16 b Fp(353)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(354a)22 b(355a)5 b Fm(.)171 2090 y Fr(global)21
b(unchecked_field)o(s,)e(guaranteed_field)o(s)129 2142
y Fp(De\014nes:)171 2182 y Fl(guaranteed)o(_fi)o(eld)o(s)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(32b,)g(195,)h(and)g(354.)171
2221 y Fl(unchecked_)o(fie)o(lds)o Fp(,)e(used)h(in)i(c)o(h)o(unks)d
(32b,)i(188b,)f(195,)g(199a,)h(212d,)f(and)g(354.)p eop
%%Page: 355 355
355 354 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)679
b Fr(fieldinfo.nw)80 b Fv(355)208 258 y(Field)14 b(v)n(alues)g(ma)o(y)e
(b)q(e)j(assigned)g(pneumonic)e(names)h(that)g(are)h(used)g(during)f
(disas-)145 307 y(sem)o(bly)e(of)g(instructions.)18 b(The)13
b(names)f(b)q(ound)h(to)f(\014eld)h(v)n(alues)f(within)g(an)g(en)o
(umeration)145 357 y(are)j(used)f(to)g(syn)o(thesize)i(the)e(sames)f
(of)h(op)q(co)q(des.)-15 420 y Fp(355a)88 b Fo(h)p Fn(*)15
b Fp(353)p Fo(i)p Fv(+)p Fo(\021)1040 b Fm(/)5 b Fp(354f)22
b(355b)5 b Fm(.)187 469 y Fr(record)20 b(namespec\(nametable,)e(full\))
187 519 y(procedure)i(sparse_name_tabl)o(e\(bin)o(dlist)o(\))230
569 y(t)i(:=)f(table\(\))230 619 y(every)g(b)h(:=)f(!bindlist)f(do)274
669 y(\(/t[b.name])f(:=)j(b.val\))e(|)i(error\("duplicate)c(field)j
(names"\))230 718 y(return)g(namespec\(t\))187 768 y(end)145
820 y Fp(De\014nes:)187 860 y Fl(namespec)p Fp(,)9 b(used)h(in)h(c)o(h)
o(unks)f(242a,)g(354a,)g(and)h(355c.)187 899 y Fl(sparse_nam)o(e_t)o
(ab)o(le)p Fp(,)d(used)j(in)g(c)o(h)o(unks)f(37c)h(and)f(38a.)145
938 y(Uses)i Fl(field)e Fp(55.)-17 1021 y(355b)88 b Fo(h)p
Fn(*)15 b Fp(353)p Fo(i)p Fv(+)p Fo(\021)1037 b Fm(/)5
b Fp(355a)22 b(355c)5 b Fm(.)187 1071 y Fr(record)20
b(enumbinding\(name,)f(val\))145 1123 y Fp(De\014nes:)187
1163 y Fl(enumbindin)o(g)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(37c)h
(and)f(38a.)-13 1254 y(355c)88 b Fo(h)p Fn(*)15 b Fp(353)p
Fo(i)p Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(355b)22 b(355d)5
b Fm(.)187 1304 y Fr(procedure)20 b(full_name_table\()o(namel)o(ist,)e
(f\))230 1354 y(t)k(:=)f(table\(\))230 1403 y(every)g(i)h(:=)f(1)h(to)f
(*namelist)f(do)274 1453 y(\(/t[namelist[i]])e(:=)k(i)f(-)h(1\))f(|)h
(error\("duplicate)c(field)j(names"\))230 1503 y(return)g(namespec\(t,)
e(1\))187 1553 y(end)145 1605 y Fp(De\014nes:)187 1644
y Fl(full_name_)o(tab)o(le)o Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(37c)g
(and)h(38a.)145 1684 y(Uses)h Fl(field)e Fp(55)h(and)g
Fl(namespec)e Fp(355a.)-17 1775 y(355d)88 b Fo(h)p Fn(*)15
b Fp(353)p Fo(i)p Fv(+)p Fo(\021)1037 b Fm(/)5 b Fp(355c)22
b(356a)5 b Fm(.)187 1825 y Fr(procedure)20 b(check_namespec\(s)o(pec,)e
(f\))230 1875 y(if)k(\\spec.full)d(then)274 1924 y(*spec.nametable)g(=)
i(2^fwidth\(f\))f(|)339 1974 y(error\("Field)g(",)h(f.name,)f(")i(has)f
(",)h(2^fwidth\(f\),)d(")i(values,)g(not)g(",)g(*spec.nametable\))230
2024 y(if)h(x)f(:=)h(spec.nametable[n)c(:=)k(key\(spec.nameta)o(ble\)])
c(&)k(\(x)f(<)h(0)f(|)h(x)g(>=)f(2^fwidth\(f\)\))e(then)274
2074 y(error\("name)g(",)j(image\(n\),)e(")h(=)h(",)f(x,)405
2124 y(")g(falls)g(outside)f(the)i(value)e(range)h(of)g(field)g(",)h
(f.name\))230 2173 y(return)f(spec.nametable)187 2223
y(end)145 2275 y Fp(De\014nes:)187 2315 y Fl(check_name)o(spe)o(c)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(242a)g(and)h(354a.)145
2354 y(Uses)h Fl(field)e Fp(55,)h Fl(fwidth)e Fp(115d,)i(and)f
Fl(value)g Fp(136a.)p eop
%%Page: 356 356
356 355 bop 129 141 a Fv(356)83 b Fr(fieldinfo.nw)677
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(356a)88
b Fo(h)p Fn(*)16 b Fp(353)p Fo(i)o Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(355d)23 b(356b)t Fm(.)171 307 y Fr(procedure)d
(fieldname_table\(f)o(\))215 357 y(initial)g(/fnt)h(:=)g(table\(\))215
407 y(return)f(fnt[f])171 457 y(end)129 509 y Fp(De\014nes:)171
548 y Fl(fieldname_)o(tab)o(le)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f
(162b,)g(163b,)g(242,)g(257,)h(316c,)f(356b,)g(and)h(357b.)129
588 y(Uses)h Fl(fnt)f Fp(353.)-33 679 y(356b)88 b Fo(h)p
Fn(*)16 b Fp(353)p Fo(i)o Fv(+)p Fo(\021)1037 b Fm(/)5
b Fp(356a)22 b(356c)5 b Fm(.)171 729 y Fr(procedure)20
b(fieldname_env_for)o(\(f\))215 779 y(return)g([\\fieldname_table\()o
(f\)])f(|)i([])171 828 y(end)171 928 y(procedure)f(fieldname_env_for)o
(_ipt\()o(ipt\))215 978 y(return)g(\(type\(ipt.meaning\))e(==)k
("field",)e(fieldname_env_fo)o(r\(ipt)o(.mean)o(ing\))o(\))f(|)j([])171
1028 y(end)129 1080 y Fp(De\014nes:)171 1119 y Fl(fieldname_)o(env)o
(_fo)o(r)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(77a.)171
1158 y Fl(fieldname_)o(env)o(_fo)o(r_i)o(pt)o Fp(,)f(used)i(in)g(c)o(h)
o(unk)f(175a.)129 1198 y(Uses)i Fl(field)e Fp(55)h(and)g
Fl(fieldname_)o(ta)o(ble)d Fp(356a.)129 1356 y Fj(20.2)66
b(Emitting)24 b(\014eld)g(names)129 1447 y Fv(W)m(e)14
b(conco)q(ct)h(a)f Fr(namearray)e Fv(and)h(pass)i(it)e(to)h
Fr(pretty)p Fv(.)-29 1509 y Fp(356c)88 b Fo(h)p Fn(*)16
b Fp(353)p Fo(i)o Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(356b)23
b(357b)t Fm(.)171 1559 y Fr(procedure)d(emit_fieldnames\(b)o(ase\))215
1609 y(local)g(header,)h(data,)f(fields)215 1659 y(data)h(:=)g
(open\(base)f(||)h(implementation_ext)o(ensio)o(n,)e("w"\))215
1708 y(header)h(:=)h(open\(base)f(||)i(interface_extens)o(ion,)c
("w"\);)215 1758 y(if)j(interface_extensi)o(on)e(==)i(".h")g(then)258
1808 y(write\(data,)f("#include)g(\\"",)h(base,)f(interface_extension)o
(,)f("\\""\))215 1858 y(pp)i(:=)g(PPnew\(data\);)215
1908 y Fo(h)p Fn(make)15 b Fr(fields)f Fn(an)h(arr)n(ay)f(of)h(al)r(l)f
(\014elds)i(sorte)n(d)e(by)h(name)h Fp(357a)p Fo(i)215
1957 y Fr(every)k(PPxwrite\(pp,)g(pretty\(Gdeclname)o(arra)o(y\(fie)o
(ldnam)o(earra)o(y\(!fi)o(elds\))o(\)\),)e(";"\))215
2007 y(every)i(write\(header,)f("extern)i(char)g(*",)g
(\(!fields\).name,)e("_names[];"\))215 2057 y(every)h(close\(data)g(|)i
(header\))215 2107 y(return)171 2157 y(end)129 2209 y
Fp(De\014nes:)171 2248 y Fl(emit_field)o(nam)o(es)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(20.)129 2287 y(Uses)15 b
Fl(fieldnamea)o(rr)o(ay)c Fp(357b,)i Fl(Gdeclnamea)o(rr)o(ay)e
Fp(293b,)i Fl(implementa)o(ti)o(on_)o(ext)o(ens)o(ion)d
Fp(18a,)171 2327 y Fl(interface_)o(ext)o(ens)o(ion)e
Fp(18a,)i(and)h Fl(pretty)f Fp(18a.)p eop
%%Page: 357 357
357 356 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)679
b Fr(fieldinfo.nw)80 b Fv(357)-15 258 y Fp(357a)88 b
Fo(h)p Fn(make)16 b Fr(fields)d Fn(an)j(arr)n(ay)e(of)h(al)r(l)f
(\014elds)h(sorte)n(d)g(by)g(name)g Fp(357a)p Fo(i)o(\021)274
b Fp(\(356c\))187 307 y Fr(t)21 b(:=)h(table\(\))187
357 y(fields)e(:=)i([])187 407 y(every)f(f)g(:=)h(!symtab)e(&)h
(type\(f\))g(==)g("field")g(do)g(t[f.name])f(:=)h(f)187
457 y(every)g(put\(fields,)e(\(!sort\(t\)\)[2]\))145
509 y Fp(Uses)12 b Fl(field)e Fp(55)h(and)g Fl(symtab)e
Fp(32a)i(367.)208 579 y Fv(T)m(o)h(build)h(a)g(name)f(arra)o(y)m(,)g(w)
o(e)i(\014rst)g(create)h(a)e(table)h(of)e(all)h(in)o(v)n(alid)e
(\014eld)i(v)n(alues.)18 b(The)145 629 y(v)n(alid)13
b(ones)h(are)g(then)h(o)o(v)o(erwritten)f(using)g(names)f(from)f
Fr(fieldname_table\(f\))p Fv(.)-17 700 y Fp(357b)88 b
Fo(h)p Fn(*)15 b Fp(353)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(356c)22 b(358a)5 b Fm(.)187 750 y Fr(procedure)20
b(fieldnamearray\(f)o(\))230 799 y(return)h(name_array_from_t)o(able\()
o(\\fiel)o(dname)o(_tab)o(le\(f\))o(,)e(2^fwidth\(f\),)g(f.name\))187
849 y(end)187 899 y(procedure)h(name_array_from_)o(table)o(\(t,)f
(limit,)h(fieldname\))230 949 y(local)h(name)230 999
y(limit)g(<=)h(1024)e(|)274 1048 y(error\("Tried)f(to)j(enumerate)e(",)
h(limit,)g(")g(names)g(for)g(field)g(or)g(operand)g(",)g(fieldname\))
230 1098 y(na)h(:=)f(namearray\(field,)e(table\(\),)h(limit,)g
(fieldname)g(||)i("_names",)e(""\))230 1148 y(every)h(i)h(:=)f(0)h(to)f
(na.hi)g(-)g(1)h(do)274 1198 y(na.tbl[i])e(:=)h(bad_operand_name\(fi)o
(eldna)o(me,)d(i\))230 1248 y(every)j(name)g(:=)g(key\(t\))g(do)274
1297 y(na.tbl[t[name]])e(:=)i(name)230 1347 y(return)g(na)187
1397 y(end)187 1447 y(procedure)f(bad_operand_name)o(\(name)o(,)f
(value\))230 1497 y(return)i("??")g(||)g(name)g(||)h("=")f(||)g(value)g
(||)g("?!")187 1547 y(end)145 1598 y Fp(De\014nes:)187
1638 y Fl(bad_operan)o(d_n)o(am)o(e)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)
f(248.)187 1677 y Fl(fieldnamea)o(rra)o(y)p Fp(,)e(used)j(in)g(c)o(h)o
(unk)f(356c.)187 1717 y Fl(name_array)o(_fr)o(om)o(_ta)o(ble)o
Fp(,)f(used)h(in)i(c)o(h)o(unk)e(248.)145 1756 y(Uses)i
Fl(field)e Fp(55,)h Fl(fieldname_)o(tab)o(le)d Fp(356a,)i
Fl(fwidth)g Fp(115d,)g Fl(namearray)f Fp(291a,)h(and)g
Fl(value)g Fp(136a.)p eop
%%Page: 358 358
358 357 bop 129 141 a Fv(358)83 b Fr(fieldinfo.nw)677
b Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)192 258 y(F)m(or)f(use)i(in)f
(iden)o(tifying)f(\014elds)h(with)g(iden)o(tical)g(naming)e(patterns,)j
(w)o(e)f(ha)o(v)o(e)g(to)g(turn)129 307 y(a)h(name)f(table)h(in)o(to)f
(a)g(suitable)h(string.)k(This)c(means)f(co)o(v)o(ering)h(the)g(k)o
(eys)g(in)g(order.)-31 370 y Fp(358a)88 b Fo(h)p Fn(*)16
b Fp(353)p Fo(i)o Fv(+)p Fo(\021)1151 b Fm(/)5 b Fp(357b)171
420 y Fr(procedure)20 b(nametablekey\(name)o(tab\))215
469 y(local)g(min,)h(max)215 519 y(static)f(cache)215
569 y(initial)g(cache)h(:=)g(table\(\))215 619 y(if)g(\\cache[nametab])
e(then)i(return)f(cache[nametab])215 669 y(if)h(/nametab)f(then)h
(return)g(cache[f])f(:=)h("\(no)g(name)g(table\)")215
718 y(u)g(:=)h(table\(\))215 768 y(every)e(k)i(:=)f(key\(nametab\))f
(do)h(u[nametab[k]])e(:=)i(k)215 818 y Fo(h)p Fn(make)15
b Fr(min)f Fn(and)i Fr(max)e Fn(smal)r(lest)g(and)i(lar)n(gest)e
(values)h(in)g Fr(nametab)e Fp(358b)p Fo(i)215 868 y
Fr(s)21 b(:=)h("")215 918 y(every)e(i)i(:=)f(min)g(to)h(max)f(do)258
967 y(s)h(||:=)f(\\u[i])f(||)i("@")f(||)g(i)h(||)f("\\0")215
1017 y(return)f(cache[f])g(:=)i(s)171 1067 y(end)129
1119 y Fp(De\014nes:)171 1158 y Fl(nametablek)o(ey)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(249d.)129 1198 y(Uses)i
Fl(max)f Fp(410)g(and)f Fl(min)h Fp(410.)-33 1281 y(358b)88
b Fo(h)p Fn(make)16 b Fr(min)e Fn(and)i Fr(max)e Fn(smal)r(lest)g(and)i
(lar)n(gest)e(values)h(in)g Fr(nametab)e Fp(358b)p Fo(i)o(\021)134
b Fp(\(358a\))171 1331 y Fr(min)21 b(:=)h(max)f(:=)g(!nametab)f(|)i(0)
171 1381 y(every)f(min)g(>:=)g(!nametab)171 1430 y(every)g(max)g(<:=)g
(!nametab)129 1482 y Fp(Uses)12 b Fl(max)f Fp(410)g(and)f
Fl(min)h Fp(410.)p eop
%%Page: 359 359
359 358 bop 145 569 a Fq(Chapter)32 b(21)145 777 y Fu(Lexical)40
b(analysis)145 992 y Fr(token)18 b Fv(describ)q(es)j(the)f(category)f
(of)f(the)i(tok)o(en,)f(and)g Fr(tval)f Fv(is)h(its)g(v)n(alue.)32
b Fr(token)21 b(==)145 1042 y(tval)13 b Fv(except)j(for)d(in)o(tegers)i
(and)f(iden)o(ti\014ers.)19 b Fr(file)13 b Fv(and)h Fr(line)f
Fv(describ)q(e)j(the)e(source)h(\014le)145 1092 y(and)f(line)f(n)o(um)o
(b)q(er)h(from)e(whic)o(h)h(the)i(tok)o(en)f(came.)-15
1154 y Fp(359a)88 b Fo(h)p Fn(*)15 b Fp(359a)p Fo(i)o(\021)1165
b Fp(359b)5 b Fm(.)187 1204 y Fr(global)20 b(token,)h(tval,)g(file,)f
(line)145 1256 y Fp(De\014nes:)187 1295 y Fl(file)p Fp(,)10
b(used)i(in)f(c)o(h)o(unks)g(9{14,)f(23,)i(24,)f(102a,)g(109d,)f(230a,)
h(263a,)g(271b,)f(275c,)h(276a,)g(284a,)f(285a,)228 1335
y(293a,)g(294d,)h(302a,)f(306,)g(332d,)g(344d,)g(360a,)g(367{69,)g(and)
h(372{74.)187 1374 y Fl(line)p Fp(,)g(used)g(in)h(c)o(h)o(unks)e(17f,)h
(20,)h(23a,)f(102a,)g(109d,)f(165b,)h(205c,)g(206a,)g(263a,)f(271b,)h
(275c,)g(276a,)228 1414 y(284a,)f(285a,)h(293a,)f(294d,)g(302a,)g(309,)
g(332d,)h(344d,)f(360a,)g(372a,)g(and)g(374.)187 1453
y Fl(token)p Fp(,)g(used)g(in)h(c)o(h)o(unks)f(16,)h(21d,)f(81,)h
(196b,)f(and)h(361{63.)187 1493 y Fl(tval)p Fp(,)f(used)g(in)i(c)o(h)o
(unks)d(21d,)i(361,)f(and)h(363.)208 1555 y Fv(There)k(are)f(three)h
(sp)q(ecial)f(tok)o(ens.)-17 1617 y Fp(359b)88 b Fo(h)p
Fn(*)15 b Fp(359a)p Fo(i)o Fv(+)p Fo(\021)1016 b Fm(/)5
b Fp(359a)22 b(360b)5 b Fm(.)187 1667 y Fr(global)20
b(EOF,)h(IDENT,)g(INT,)g(CODELINE,)f(CASELINE,)g(NEWLINE,)g
(WHITESPACE,)f(lexstate)145 1719 y Fp(De\014nes:)187
1758 y Fl(CASELINE)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(51a,)h(360a,)f
(and)g(361a.)187 1798 y Fl(CODELINE)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f
(51a,)h(360,)f(and)h(361.)187 1837 y Fl(EOF)p Fp(,)f(used)h(in)g(c)o(h)
o(unks)f(21d)h(and)f(360a.)187 1877 y Fl(IDENT)p Fp(,)g(used)g(in)h(c)o
(h)o(unks)f(49c,)h(54c,)f(360a,)g(362a,)g(and)h(363a.)187
1916 y Fl(INT)p Fp(,)f(used)h(in)g(c)o(h)o(unks)f(34{36,)g(38b,)g(41c,)
h(49c,)f(51b,)h(54c,)f(360a,)g(and)h(363a.)187 1955 y
Fl(lexstate)p Fp(,)e(used)h(in)h(c)o(h)o(unks)f(360,)h(361,)f(363b,)g
(and)h(365a.)187 1995 y Fl(NEWLINE)p Fp(,)e(used)h(in)i(c)o(h)o(unks)d
(45a,)i(52e,)f(360a,)h(and)f(362a.)187 2034 y Fl(WHITESPACE)o
Fp(,)f(used)h(in)i(c)o(h)o(unks)d(54c,)i(360a,)f(and)h(362b.)830
2604 y Fv(359)p eop
%%Page: 360 360
360 359 bop 129 141 a Fv(360)83 b Fr(lex.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(360a)88 b Fo(h)p Fn(initialize)14
b Fr(tokens)g Fp(360a)p Fo(i)o(\021)881 b Fp(\(360b\))171
307 y Fr(CASELINE)64 b(:=)21 b(")h(case)f(...)g(of)g(")171
357 y(CODELINE)64 b(:=)21 b(")h(code)f(line)g(")171 407
y(EOF)174 b(:=)21 b(")h(end)f(of)g(file)g(")171 457 y(IDENT)130
b(:=)21 b(")h(identifier)d(")171 507 y(INT)174 b(:=)21
b(")h(integer)e(")171 557 y(NEWLINE)86 b(:=)21 b(")h(newline)e(")171
606 y(WHITESPACE)g(:=)h(")h(white)e(space)h(")129 658
y Fp(Uses)13 b Fl(CASELINE)d Fp(54b)h(359b,)g Fl(CODELINE)f
Fp(54b)i(359b,)f Fl(EOF)g Fp(359b,)g Fl(file)g Fp(359a,)g
Fl(IDENT)g Fp(54b)h(359b)f(360b,)171 698 y Fl(INT)g Fp(54b)f(359b,)g
Fl(line)h Fp(359a,)f Fl(NEWLINE)f Fp(54b)i(359b,)f Fl(white)g
Fp(364a,)g(and)h Fl(WHITESPAC)o(E)e Fp(54b)h(359b.)-33
789 y(360b)88 b Fo(h)p Fn(*)16 b Fp(359a)p Fo(i)n Fv(+)q
Fo(\021)1015 b Fm(/)5 b Fp(359b)22 b(362a)5 b Fm(.)171
839 y Fr(global)21 b(SEMANTICS,)e(IDENT,)i(STARTSEM,)f(ENDSEM,)g
(succptr)171 889 y(procedure)g(scantokens\(eol\))215
938 y(static)g(alpha,)h(alphanum,)f(multichar)215 988
y(initial)g({)258 1038 y(alpha)130 b(:=)21 b(&letters)f(++)i('_.')258
1088 y(alphanum)64 b(:=)21 b(alpha)g(++)g(&digits)258
1138 y(multichar)42 b(:=)21 b(set\(["<=",)f(">=",)h("!=",)f(">>",)h
("<<",)g("=>",)g("..."]\))258 1187 y(/lexstate)42 b(:=)21
b("INITIAL")258 1237 y Fo(h)p Fn(initialize)14 b Fr(tokens)g
Fp(360a)p Fo(i)215 1287 y Fr(})215 1337 y(if)21 b(\\eol)g(then)g
(return)f(possible_newline\(\))215 1387 y(case)h(lexstate)f(of)h({)258
1437 y("INITIAL")f(|)i("CASEPAT")e(:)h({)p Fo(h)p Fn(lexer)15
b(for)f(INITIAL)g(and)i(CASEP)m(A)m(T)e Fp(363a)p Fo(i)o
Fr(})258 1486 y Fo(h)p Fn(c)n(ases)h(for)g(other)f(lexic)n(al)h(states)
f Fp(361a)p Fo(i)215 1536 y Fr(})171 1586 y(end)129 1638
y Fp(De\014nes:)171 1677 y Fl(IDENT)p Fp(,)c(used)g(in)h(c)o(h)o(unks)f
(49c,)h(54c,)f(360a,)g(362a,)h(and)f(363a.)171 1717 y
Fl(succptr)p Fp(,)f(used)i(in)g(c)o(h)o(unks)f(51a,)g(259,)h(260,)f
(263a,)g(271b,)g(301a,)g(and)h(361a.)129 1756 y(Uses)h
Fl(lexstate)d Fp(359b)h(and)h Fl(possible_n)o(ewl)o(ine)d
Fp(362a.)p eop
%%Page: 361 361
361 360 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(lex.nw)82 b Fv(361)-15 258 y Fp(361a)88 b Fo(h)p
Fn(c)n(ases)16 b(for)e(other)g(lexic)n(al)h(states)g
Fp(361a)p Fo(i)n(\021)556 b Fp(\(360b\))21 b(361b)5 b
Fm(.)187 307 y Fr("CODE":)20 b({)230 357 y(if)i(\(optwhite\(\),)d
(="match)h(",)i(optwhite\(\),)470 407 y(\(="[",)f(optwhite\(\),)e
(any\(&letters\),)557 457 y(succptr)i(:=)g(tab\(many\(alphanum)o(\)\),)
e(optwhite\(\),)g(="]",)i(optwhite\(\)\))e(|)383 507
y(\(succptr)h(:=)h(&null\),)318 557 y(tval)g(:=)g(tab\(find\(")f
(to"\)\),)g(=")i(to",)f(optwhite\(\),)e(pos\(0\)\))h(then)h({)274
606 y(lexstate)f(:=)h("CASEPAT")274 656 y(return)g(CASELINE)230
706 y(})h(else)f(if)g(optwhite\(\))f(&)i(="match)e(")i(&)f(tval)g(:=)g
(tab\(find\(")f(to"\)\))h(&)h(=")f(to")g(&)1189 756 y(optwhite\(\))f(&)
i(pos\(0\))e(then)h({)274 806 y(impossible\("bogus)d(code)j(in)h
(lex"\))274 855 y(lexstate)e(:=)h("CASEPAT")274 905 y(return)g
(CASELINE)230 955 y(})h(else)f({)87 b(#)21 b(warning)g(message)f(for)h
(ill-formed)f(case?)274 1005 y(tval)h(:=)g(tab\(0\))274
1055 y(return)g(CODELINE)230 1104 y(})187 1154 y(})145
1206 y Fp(Uses)13 b Fl(bogus)e Fp(116b,)f Fl(CASELINE)g
Fp(54b)h(359b,)g Fl(CODELINE)f Fp(54b)h(359b,)g Fl(lexstate)f
Fp(359b,)h Fl(optwhite)f Fp(364a,)187 1246 y Fl(succptr)f
Fp(360b,)h(and)h Fl(tval)f Fp(359a.)-17 1337 y(361b)88
b Fo(h)p Fn(c)n(ases)16 b(for)e(other)g(lexic)n(al)h(states)g
Fp(361a)p Fo(i)n Fv(+)q Fo(\021)525 b Fp(\(360b\))21
b Fm(/)6 b Fp(361a)187 1387 y Fr("CASEARM":)20 b({)230
1437 y(if)i(optwhite\(\))d(&)j(tval)f(:=)g(\(="|")g(|)h(1\(=\("else")d
(|)j("endmatch"\),)d(white\(\))i(|)g(pos\(0\)\)\))f(then)h({)274
1486 y(lexstate)f(:=)361 1536 y(case)h(tval)g(of)g({)h("|")f(:)h
("CASEPAT")e(;)h("else")g(:)g("CASEARM")f(;)i("endmatch")e(:)h("CODE")g
(})274 1586 y(return)g(token)f(:=)i(tval)230 1636 y(})g(else)f({)274
1686 y(tval)g(:=)g(tab\(0\))274 1735 y(return)g(CODELINE)230
1785 y(})187 1835 y(})145 1887 y Fp(Uses)15 b Fl(CODELINE)d
Fp(54b)i(359b,)f Fl(lexstate)f Fp(359b,)h Fl(optwhite)f
Fp(364a,)h Fl(token)g Fp(359a,)g Fl(tval)h Fp(359a,)187
1926 y(and)c Fl(white)g Fp(364a.)p eop
%%Page: 362 362
362 361 bop 129 141 a Fv(362)83 b Fr(lex.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)192 258 y(There's)18 b(a)g(ghastly)f(hac)o(k)g
(that)h(mak)o(es)e(exactly)i(one)g(newline)f(visible)g(after)h(ev)o
(ery)129 307 y(op)q(co)q(de)c(of)d(a)h(constructor)i(sp)q(ec.)19
b(What)12 b(w)o(e)g(do)h(is,)f(b)q(efore)h(parsing)f(a)g(constructor)i
(sp)q(ec,)129 357 y(w)o(e)j(turn)f(\\newline-vision")e(on)i(if)f(the)i
(next)f(tok)o(en)g(is)g(an)g(iden)o(ti\014er.)24 b(Encoun)o(tering)17
b(a)129 407 y(newline)d(or)g(reserv)o(ed)i(w)o(ord)e(or)g
Fr({)f Fv(or)h(other)h(stu\013)f(turns)h(it)f(o\013)f(again.)-31
469 y Fp(362a)88 b Fo(h)p Fn(*)16 b Fp(359a)p Fo(i)n
Fv(+)q Fo(\021)1013 b Fm(/)5 b Fp(360b)23 b(362b)t Fm(.)171
519 y Fr(global)e(NEWLINEVISION)171 569 y(procedure)f(see_newline\(\))
215 619 y(if)h(token)g(==)g(IDENT)g(then)g(NEWLINEVISION)e(:=)i(1)215
669 y(return)f(NEWLINEVISION)171 718 y(end)171 768 y(procedure)g
(ignore_newlines\(\))215 818 y(return)g(NEWLINEVISION)f(:=)j(&null)171
868 y(end)171 918 y(procedure)e(possible_newline\()o(\))215
967 y(if)h(\\NEWLINEVISION)e(then)i({)258 1017 y(NEWLINEVISION)e(:=)j
(&null)258 1067 y(return)f(NEWLINE)215 1117 y(})215 1167
y(return)f(possible_whitespac)o(e\(\))171 1217 y(end)129
1268 y Fp(De\014nes:)171 1308 y Fl(ignore_new)o(lin)o(es)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(363a.)171 1347 y Fl(possible_n)o
(ewl)o(ine)o Fp(,)f(used)h(in)i(c)o(h)o(unks)d(360b)i(and)f(363a.)171
1387 y Fl(see_newlin)o(e)p Fp(,)f(used)h(in)h(c)o(h)o(unks)f(44a)h(and)
f(52c.)129 1426 y(Uses)i Fl(IDENT)e Fp(54b)h(359b)f(360b,)g
Fl(NEWLINE)f Fp(54b)i(359b,)f Fl(possible_wh)o(ite)o(sp)o(ace)e
Fp(362b,)i(and)h Fl(token)f Fp(359a.)192 1488 y Fv(There's)15
b(an)f(equally)f(ghastly)h(hac)o(k)g(that)h(mak)o(es)e(one)h(unit)g(of)
g(white)g(space)i(visible.)129 1538 y(Note)f(that)f(w)o(e)g(don't)f
(require)i(an)f(iden)o(ti\014er.)-33 1601 y Fp(362b)88
b Fo(h)p Fn(*)16 b Fp(359a)p Fo(i)n Fv(+)q Fo(\021)1017
b Fm(/)5 b Fp(362a)22 b(364a)5 b Fm(.)171 1650 y Fr(global)21
b(WHITESPACEVISIO)o(N)171 1700 y(procedure)f(see_whitespace\(\))215
1750 y(WHITESPACEVISIO)o(N)f(:=)i(1)215 1800 y(return)f
(WHITESPACEVISION)171 1850 y(end)171 1899 y(procedure)g
(ignore_whitespace)o(\(\))215 1949 y(return)g(WHITESPACEVISION)f(:=)i
(&null)171 1999 y(end)171 2049 y(procedure)f(possible_whitespa)o
(ce\(\))215 2099 y(if)h(\\WHITESPACEVISION)d(then)j({)258
2148 y(return)g(WHITESPACE)215 2198 y(})171 2248 y(end)129
2300 y Fp(De\014nes:)171 2339 y Fl(ignore_whi)o(tes)o(pac)o(e)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(54c.)171 2379 y Fl(possible_w)o(hit)
o(esp)o(ace)o Fp(,)f(used)h(in)h(c)o(h)o(unks)f(362a)h(and)f(363a.)171
2418 y Fl(see_whites)o(pac)o(e)p Fp(,)f(used)h(in)h(c)o(h)o(unk)f(54c.)
129 2458 y(Uses)i Fl(WHITESPACE)c Fp(54b)j(359b.)p eop
%%Page: 363 363
363 362 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(lex.nw)82 b Fv(363)-15 258 y Fp(363a)88 b Fo(h)p
Fn(lexer)15 b(for)f(INITIAL)g(and)i(CASEP)m(A)m(T)e Fp(363a)p
Fo(i)o(\021)560 b Fp(\(360b\))187 307 y Fr(if)21 b(tval)g(:=)h
(white\(\))e(then)43 b(#)21 b(don't)g(backtrack)f(past)h(white\(\))230
357 y(if)h(token)f(:=)g(possible_whitespa)o(ce\(\))d(then)274
407 y(return)j(token)187 457 y(if)g({not)g(pos\(0\)})f(then)h({)230
507 y(thispos)g(:=)g(&pos)230 557 y(if)h(="#")f(then)g({)274
606 y(tab\(0\))g(&)g(\(token)g(:=)g(possible_newline\(\))d(|)k(fail\))
230 656 y(})g(else)f(if)g(tval)g(:=)h(\(hexint\(\))e(|)h(octalint\(\))f
(|)h(binaryint\(\))f(|)i(decimalint\(\)\))d(then)i({)274
706 y(token)g(:=)g(INT)230 756 y(})h(else)f(if)g(tval)g(:=)h
(\(any\(alpha\),)d(tab\(many\(alphanum)o(\)\)\))g(then)i({)274
806 y(token)g(:=)g(1\(reserved\(tval\),)d(ignore_newlines\(\)\))g(|)k
(IDENT)230 855 y(})g(else)f(if)g(tval)g(:=)h(=!multichar)d(then)i({)274
905 y(token)g(:=)g(tval)274 955 y Fo(h)p Fn(change)16
b(lexer)e(state)h(fr)n(om)f Fr(CASEPAT)g Fn(to)h Fr(CASEARM)e
Fn(if)h Fr(tval)g Fn(is)h Fr("=>")f Fp(363b)p Fo(i)230
1005 y Fr(})22 b(else)f(if)g(token)g(:=)g(="\\"")g(then)g({)274
1055 y(delim)g(:=)g(move\(-1\))f(#)i(recover)e(quote)274
1104 y(tval)h(:=)g("")274 1154 y(while)g(=delim)f(do)i({)43
b(#)22 b(turn)f('don''t)f(into)h("don't")318 1204 y(tval)g(||:=)f
(tab\(upto\(delim\))f(|)j(0\))318 1254 y(=delim)e(|)i(error\("unclosed)
c(",)k(delim\))274 1304 y(})230 1354 y(})g(else)f(if)g(token)g(:=)g
(="'")g(then)g({)h(#)g(character)d(constant)318 1403
y(tval)i(:=)g(charconst\(\))318 1453 y(="'")g(|)g(error\("character)e
(constant)h(too)h(large)g(\(or)g(unclosed)f(single)h(quote\)"\))230
1503 y(})h(else)f({)274 1553 y(token)g(:=)g(tval)g(:=)g(move\(1\))274
1603 y(if)g(token)g(==)g(\("{"|"."\))f(then)h(ignore_newlines\(\))230
1652 y(})230 1702 y(return)g(token)187 1752 y(})187 1802
y(return)f(possible_newline\(\))145 1854 y Fp(Uses)14
b Fl(binaryint)d Fp(364d,)i Fl(charconst)e Fp(365b,)i
Fl(constant)e Fp(114b,)i Fl(decimalin)o(t)e Fp(364e,)i
Fl(fail)g Fp(410,)187 1893 y Fl(hexint)d Fp(364b,)g Fl(IDENT)g
Fp(54b)h(359b)f(360b,)g Fl(ignore_newl)o(ine)o(s)f Fp(362a,)h
Fl(INT)h Fp(54b)g(359b,)f Fl(octalint)f Fp(364c,)187
1933 y Fl(possible_n)o(ewl)o(in)o(e)j Fp(362a,)i Fl(possible_wh)o(ite)o
(sp)o(ace)e Fp(362b,)h Fl(token)h Fp(359a,)g Fl(tval)g
Fp(359a,)187 1972 y(and)c Fl(white)g Fp(364a.)-17 2063
y(363b)88 b Fo(h)p Fn(change)16 b(lexer)f(state)f(fr)n(om)h
Fr(CASEPAT)e Fn(to)i Fr(CASEARM)e Fn(if)i Fr(tval)f Fn(is)g
Fr("=>")g Fp(363b)p Fo(i)o(\021)89 b Fp(\(363a\))187
2113 y Fr(case)21 b(tval)g(of)g({)230 2163 y("=>")g(:)h(if)f(lexstate)f
(==)i("CASEPAT")e(then)h(lexstate)f(:=)h("CASEARM")187
2213 y(})145 2265 y Fp(Uses)12 b Fl(lexstate)d Fp(359b)h(and)h
Fl(tval)f Fp(359a.)p eop
%%Page: 364 364
364 363 bop 129 141 a Fv(364)83 b Fr(lex.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(364a)88 b Fo(h)p Fn(*)16
b Fp(359a)p Fo(i)n Fv(+)q Fo(\021)1013 b Fm(/)5 b Fp(362b)23
b(364b)t Fm(.)171 307 y Fr(procedure)d(optwhite\(\))215
357 y(suspend)g(white\(\))g(|)i("")171 407 y(end)171
507 y(procedure)e(white\(\))215 557 y(suspend)g(tab\(many\(')g
(\\t'\)\))171 606 y(end)129 658 y Fp(De\014nes:)171 698
y Fl(optwhite)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(255)h(and)g(361.)
171 737 y Fl(white)p Fp(,)f(used)g(in)h(c)o(h)o(unks)f(44b,)h(360a,)f
(361b,)g(and)h(363a.)-418 764 y Fk(\031Change)i(#26)-33
828 y Fp(364b)88 b Fo(h)p Fn(*)16 b Fp(359a)p Fo(i)n
Fv(+)q Fo(\021)1019 b Fm(/)5 b Fp(364a)22 b(364c)5 b
Fm(.)171 878 y Fr(procedure)20 b(hexint\(\))215 928 y(static)g
(hexdigits)215 978 y(initial)g(hexdigits)42 b(:=)21 b(&digits)f(++)i
('abcdefABCDEF')215 1028 y(suspend)e(="0x")h(&)g(integer\("16r")e(||)j
(tab\(many\(hexdigi)o(ts\)\)\))171 1077 y(end)129 1129
y Fp(De\014nes:)171 1169 y Fl(hexint)p Fp(,)9 b(used)i(in)g(c)o(h)o
(unk)f(363a.)-29 1260 y(364c)88 b Fo(h)p Fn(*)16 b Fp(359a)p
Fo(i)n Fv(+)q Fo(\021)1013 b Fm(/)5 b Fp(364b)23 b(364d)t
Fm(.)171 1310 y Fr(procedure)d(octalint\(\))215 1360
y(static)g(octaldigits)215 1410 y(initial)g(octaldigits)41
b(:=)22 b('01234567')215 1459 y(suspend)e(="0")h(&)g(integer\("8r")f
(||)h(tab\(many\(octaldigi)o(ts\)\)\))171 1509 y(end)129
1561 y Fp(De\014nes:)171 1601 y Fl(octalint)p Fp(,)9
b(used)h(in)h(c)o(h)o(unk)f(363a.)-33 1692 y(364d)88
b Fo(h)p Fn(*)16 b Fp(359a)p Fo(i)n Fv(+)q Fo(\021)1021
b Fm(/)5 b Fp(364c)22 b(364e)5 b Fm(.)171 1742 y Fr(procedure)20
b(binaryint\(\))215 1791 y(static)g(binarydigits)215
1841 y(initial)g(binarydigits)41 b(:=)21 b('01')215 1891
y(suspend)f(="0b")h(&)g(integer\("2r")f(||)h(tab\(many\(binarydi)o
(gits\))o(\)\))171 1941 y(end)129 1993 y Fp(De\014nes:)171
2032 y Fl(binaryint)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(363a.)-29
2124 y(364e)88 b Fo(h)p Fn(*)16 b Fp(359a)p Fo(i)n Fv(+)q
Fo(\021)1015 b Fm(/)5 b Fp(364d)22 b(365a)5 b Fm(.)171
2173 y Fr(procedure)20 b(decimalint\(\))215 2223 y(static)g
(decimaldigits)215 2273 y(initial)g(decimaldigits)41
b(:=)21 b(&digits)215 2323 y(suspend)f(integer\(tab\(many\()o(&digi)o
(ts\)\)\))171 2373 y(end)129 2425 y Fp(De\014nes:)171
2464 y Fl(decimalint)o Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(363a.)p
eop
%%Page: 365 365
365 364 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)809
b Fr(lex.nw)82 b Fv(365)-15 258 y Fp(365a)88 b Fo(h)p
Fn(*)15 b Fp(359a)p Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5
b Fp(364e)22 b(365b)5 b Fm(.)187 307 y Fr(procedure)20
b(codelex\(in\))230 357 y(lexstate)h(:=)g("CODE")230
407 y(return)g(lex\(in\))187 457 y(end)145 509 y Fp(De\014nes:)187
548 y Fl(codelex)p Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(21a.)145
588 y(Uses)i Fl(lexstate)d Fp(359b.)145 746 y Fj(21.1)66
b(Supp)r(ort)24 b(for)e(c)n(haracter)h(constan)n(ts)-17
837 y Fp(365b)88 b Fo(h)p Fn(*)15 b Fp(359a)p Fo(i)o
Fv(+)p Fo(\021)1018 b Fm(/)5 b Fp(365a)22 b(366a)5 b
Fm(.)187 886 y Fr(procedure)20 b(charconst\(\))252 936
y(local)h(ns,)g(c)252 1036 y(return)g(if)g(="\\\\")g(then)g({)p
Fo(h)p Fn(b)n(ackslash)15 b(esc)n(ap)n(e)g Fp(365c)p
Fo(i)o Fr(})22 b(else)f(move\(1\))187 1086 y(end)145
1138 y Fp(De\014nes:)187 1177 y Fl(charconst)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(363a.)-13 1268 y(365c)88
b Fo(h)p Fn(b)n(ackslash)16 b(esc)n(ap)n(e)f Fp(365c)p
Fo(i)o(\021)893 b Fp(\(365b\))187 1318 y Fr(c)21 b(:=)h
(map\(move\(1\)\))d(|)j(fail)f(#)g(backslash)f(newline)g(fails)187
1368 y(case)h(c)g(of)h({)252 1418 y("b":)43 b("\\b")252
1468 y("d":)g("\\d")252 1517 y("e":)g("\\e")252 1567
y("f":)g("\\f")252 1617 y("l":)g("\\n")252 1667 y("n":)g("\\n")252
1717 y("r":)g("\\r")252 1766 y("t":)g("\\t")252 1816
y("v":)g("\\v")252 1866 y("'":)g("'")252 1916 y("\\"":)g("\\"")252
1966 y("\\\\")21 b(:)h("\\\\")252 2016 y("x":)43 b(hexchar\(\))252
2065 y(!"01234567":)e(octcode\(\))252 2115 y(default:)h(error\("bad)20
b(backslash)g(escape)g(\\\\",)h(c,)h(tab\(0\)\))187 2165
y(})145 2217 y Fp(Uses)12 b Fl(fail)e Fp(410)h(and)g
Fl(octcode)e Fp(366b.)p eop
%%Page: 366 366
366 365 bop 129 141 a Fv(366)83 b Fr(lex.nw)809 b Fv(No)o(v)o(em)o(b)q
(er)13 b(15,)g(1996)-31 258 y Fp(366a)88 b Fo(h)p Fn(*)16
b Fp(359a)p Fo(i)n Fv(+)q Fo(\021)1013 b Fm(/)5 b Fp(365b)23
b(366b)t Fm(.)171 307 y Fr(procedure)d(hexcode\(\))236
357 y(local)h(i,)g(s)236 407 y(static)g(hdigits)236 457
y(initial)g(hdigits)f(:=)h(~'0123456789ABCDEFa)o(bcdef)o(')236
557 y(move\(i)g(:=)g(2)h(|)f(1\))h(?)f(s)h(:=)f(tab\(upto\(hdigits\))e
(|)i(0\))236 606 y(move\(*s)g(-)g(i\))236 656 y(return)g(char\("16r")f
(||)h(s\))171 706 y(end)-33 797 y Fp(366b)88 b Fo(h)p
Fn(*)16 b Fp(359a)p Fo(i)n Fv(+)q Fo(\021)1134 b Fm(/)6
b Fp(366a)171 847 y Fr(procedure)20 b(octcode\(\))236
897 y(local)h(i,)g(s)236 947 y(static)g(odigits)236 997
y(initial)g(odigits)f(:=)h(~'01234567')236 1096 y(move\(-1\))236
1146 y(move\(i)g(:=)g(3)h(|)f(2)h(|)g(1\))f(?)h(s)f(:=)h
(tab\(upto\(odigit)o(s\))d(|)i(0\))236 1196 y(move\(*s)g(-)g(i\))236
1246 y(if)h(s)f(>)h(377)f(then)g({)87 b(#)22 b(back)f(off)g(if)g(too)g
(large)302 1295 y(s)g(:=)h(s[1:3])302 1345 y(move\(-1\))302
1395 y(})236 1445 y(return)f(char\("8r")f(||)h(s\))171
1495 y(end)129 1547 y Fp(De\014nes:)171 1586 y Fl(octcode)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(365c.)p eop
%%Page: 367 367
367 366 bop 145 569 a Fq(Chapter)32 b(22)145 777 y Fu(Output)145
992 y Fv(Routines)15 b(for)f(pro)q(ducing)g(ASCI)q(I)h(and)f("dag")f
(represen)o(tations)k(of)c(patterns)j(and)e(deci-)145
1042 y(sion)g(trees.)2 1104 y Fp(367)89 b Fo(h)p Fn(*)15
b Fp(367)p Fo(i\021)1184 b Fp(368a)5 b Fm(.)187 1154
y Fr(global)20 b(equivclasses,)f(symtab)187 1254 y(procedure)h
(outspec\(file\))274 1304 y(every)h(c)g(:=)h(!equivclasses)d(do)i({)361
1354 y(writes\(file,)e("fields\(",)h(c.size,)h("\))g("\))361
1403 y(every)g(f)g(:=)h(!c.fields)e(do)h(writes\(file,)e
(fieldimage\(f\)\))361 1453 y(write\(file\))274 1503
y(})274 1553 y(outpatterndefs\(fi)o(le,)g(w)i(:=)h(set\(\)\))274
1603 y(every)f(c)g(:=)h(kept_constructor)o(s\(\))d(do)318
1652 y(write\(file,)g("constructor)g(",)j(c.name,)e(")i(",)f
(outinputs\(c\),)448 1702 y(")h(:)f(")h(||)f(\(instructionctype)e(~===)
i(c.type\).name)e(|)j(""\))274 1752 y(write\(file,)d("\045\045"\))187
1802 y(end)145 1854 y Fp(De\014nes:)187 1893 y Fl(equivclass)o(es)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(32b)g(and)h(35a.)187
1933 y Fl(outspec)p Fp(,)e(used)h(in)i(c)o(h)o(unk)e(20.)187
1972 y Fl(symtab)p Fp(,)g(used)h(in)h(c)o(h)o(unks)e(32b,)h(35,)h(39b,)
f(45{47,)f(50b,)i(115,)f(170b,)f(172b,)h(188b,)g(242,)g(247,)g(262a,)
228 2011 y(357a,)f(368c,)h(and)f(369c.)145 2051 y(Uses)15
b Fl(constructo)o(r)d Fp(159,)h Fl(fieldimage)e Fp(368b)i(368b,)g
Fl(file)g Fp(359a,)g Fl(instruction)o(cty)o(pe)e Fp(32a,)187
2090 y Fl(kept_const)o(ruc)o(to)o(rs)d Fp(33d,)j Fl(outinputs)d
Fp(368a,)j(and)f Fl(outpatternd)o(efs)e Fp(368c)i(368c.)830
2604 y Fv(367)p eop
%%Page: 368 368
368 367 bop 129 141 a Fv(368)83 b Fr(output.nw)743 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(368a)88
b Fo(h)p Fn(*)16 b Fp(367)p Fo(i)o Fv(+)p Fo(\021)1051
b Fm(/)5 b Fp(367)23 b(368b)t Fm(.)171 307 y Fr(procedure)d
(outinputs\(cons\))215 357 y(s)h(:=)h("\(")215 407 y(p)f(:=)h("")215
457 y(every)e(i)i(:=)f(inputs_of\(cons\))e(do)i({)258
507 y(s)h(||:=)f(p)g(||)h(i.name)258 557 y(p)g(:=)f(",)g(")215
606 y(})215 656 y(return)f(s)i(||)f("\)")171 706 y(end)129
758 y Fp(De\014nes:)171 797 y Fl(outinputs)p Fp(,)8 b(used)j(in)g(c)o
(h)o(unk)f(367.)129 837 y(Uses)i Fl(inputs_of)d Fp(166a.)-33
928 y(368b)88 b Fo(h)p Fn(*)16 b Fp(367)p Fo(i)o Fv(+)p
Fo(\021)1037 b Fm(/)5 b Fp(368a)22 b(368c)5 b Fm(.)171
978 y Fr(procedure)20 b(fieldimage\(f\))258 1028 y(return)h(f.name)f
(||)i(")f(")h(||)f(f.lo)g(||)h(":")f(||)g(f.hi)g(||)g(")h(")171
1077 y(end)129 1129 y Fp(De\014nes:)171 1169 y Fl(fieldimage)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(27c)g(and)h(367.)-29
1260 y(368c)88 b Fo(h)p Fn(*)16 b Fp(367)p Fo(i)o Fv(+)p
Fo(\021)1033 b Fm(/)5 b Fp(368b)22 b(369a)5 b Fm(.)171
1310 y Fr(procedure)20 b(outpatterndefs\(fi)o(le,)f(written\))258
1360 y(/written)h(:=)i(patnames\(\))258 1410 y(pats)f(:=)g
(sort\(symtab\))258 1459 y(#)h(first)e(do)i(patterns)e(that)h(don't)g
(depend)f(on)i(other)e(patterns,)g(then)h(catch)g(as)g(catch)g(can)258
1509 y(every)g(pair)g(:=)g(!pats)g(&)h(name)f(:=)g(pair[1])f(&)i(p)f
(:=)h(pair[2])e(&)i(type\(p\))e(==)h("pattern")f(do)i({)345
1559 y(if)g(not)f(\(\(!p.disjuncts\).n)o(ame)e(~==)i(name\))f(then)h(#)
h(doesn't)e(depend)h(on)g(others)432 1609 y(outpatterndef\(file,)d
(name,)j(p,)g(written\))258 1659 y(})258 1708 y(every)g(pair)g(:=)g
(!pats)g(&)h(type\(pair[2]\))d(==)i("pattern")f(do)345
1758 y(outpatterndef\(file,)e(pair[1],)i(pair[2],)g(written\))258
1808 y(return)171 1858 y(end)129 1910 y Fp(De\014nes:)171
1949 y Fl(outpattern)o(def)o(s)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f
(367.)129 1989 y(Uses)i Fl(file)e Fp(359a,)h Fl(outpatter)o(nde)o(f)e
Fp(369a)h(369a,)g Fl(patnames)f Fp(369c,)h Fl(pattern)g
Fp(55,)g(and)h Fl(symtab)f Fp(32a)g(367.)p eop
%%Page: 369 369
369 368 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)744
b Fr(output.nw)81 b Fv(369)-15 258 y Fp(369a)88 b Fo(h)p
Fn(*)15 b Fp(367)p Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5
b Fp(368c)22 b(369b)5 b Fm(.)187 307 y Fr(procedure)20
b(outpatterndef\(fi)o(le,)f(name,)h(p,)i(written\))274
357 y(if)f(not)h(member\(written,)c(name\))j(then)g({)361
407 y(every)g(d)g(:=)h(!p.disjuncts)d(&)j(name)f(~==)g(\\d.name)f(do)
448 457 y(outpatterndef\(file,)e(d.name,)j(lookup\(d.name\),)d
(written\))361 507 y(writes\(file,)h("pattern)i(",)g(name,)g(")g(:)h
("\))361 557 y(write\(file,)e(patternimage\(p,)e(written\)\))361
606 y(insert\(written,)h(name\))274 656 y(})274 706 y(return)187
756 y(end)145 808 y Fp(De\014nes:)187 847 y Fl(outpattern)o(def)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(368c.)145 887 y(Uses)i
Fl(file)e Fp(359a,)g Fl(lookup)g Fp(25a,)h Fl(pattern)e
Fp(55,)i(and)f Fl(patternimag)o(e)f Fp(369d.)-17 978
y(369b)88 b Fo(h)p Fn(*)15 b Fp(367)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(369a)22 b(369c)5 b Fm(.)187 1028 y Fr(procedure)20
b(outpattern\(file,)e(p,)k(written\))274 1077 y(/written)e(:=)h
(patnames\(\))274 1127 y(return)g(writes\(file,)e(patternimage\(p,)g
(written\)\))187 1177 y(end)145 1229 y Fp(De\014nes:)187
1268 y Fl(outpattern)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(277b,)h
(279b,)h(and)f(374.)145 1308 y(Uses)i Fl(file)e Fp(359a,)g
Fl(patnames)f Fp(369c,)i(and)f Fl(patternimag)o(e)f Fp(369d.)-13
1399 y(369c)88 b Fo(h)p Fn(*)15 b Fp(367)p Fo(i)p Fv(+)p
Fo(\021)1031 b Fm(/)5 b Fp(369b)22 b(369d)5 b Fm(.)187
1449 y Fr(procedure)20 b(patnames\(\))230 1499 y(static)h(s)230
1549 y(initial)g({)g(s)h(:=)f(set\(\);)g(every)g(insert\(s,)f
(key\(symtab\)\))f(})i(#)h(cheat)230 1598 y(return)f(s)187
1648 y(end)145 1700 y Fp(De\014nes:)187 1740 y Fl(patnames)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(368c)g(and)h(369b.)145
1779 y(Uses)h Fl(symtab)e Fp(32a)g(367.)-17 1870 y(369d)88
b Fo(h)p Fn(*)15 b Fp(367)p Fo(i)p Fv(+)p Fo(\021)1037
b Fm(/)5 b Fp(369c)22 b(370a)5 b Fm(.)187 1920 y Fr(procedure)20
b(patternimage\(p,)e(written\))274 1970 y(/written)i(:=)h(emptyset)274
2020 y(return)g(if)g(member\(written,)e(p.name\))h(then)h(#)g
(temporary)f(hack)361 2070 y(p.name)274 2119 y(else)h({)361
2169 y(l)h(:=)f([];)g(every)g(put\(l,)g(disjunctimage\(!)o(p.dis)o
(junct)o(s,)e(p.name\)\))361 2219 y(if)j(*l)f(>)g(0)h(then)f
(commaseparate\(l,)e(")i(|)h("\))f(else)g("<NOMATCH>")274
2269 y(})187 2319 y(end)145 2371 y Fp(De\014nes:)187
2410 y Fl(patternima)o(ge)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(27c,)g
(369,)h(and)f(377a.)145 2449 y(Uses)i Fl(disjunctim)o(age)c
Fp(370b)i(and)h Fl(emptyset)e Fp(18a.)p eop
%%Page: 370 370
370 369 bop 129 141 a Fv(370)83 b Fr(output.nw)743 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(370a)88
b Fo(h)p Fn(*)16 b Fp(367)p Fo(i)o Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(369d)23 b(370b)t Fm(.)171 307 y Fr(link)e(commafy)-33
399 y Fp(370b)88 b Fo(h)p Fn(*)16 b Fp(367)p Fo(i)o Fv(+)p
Fo(\021)1037 b Fm(/)5 b Fp(370a)22 b(370c)5 b Fm(.)171
449 y Fr(procedure)20 b(disjunctimage\(d,)e(name\))258
498 y(return)j(if)g(\\name)g(==)g(\\d.name)g(|)g(/d.name)f(then)345
548 y(case)h(type\(d\))g(of)g({)432 598 y("disjunct")f(:)i
(sequenceimage\(d.)o(seque)o(nts\))432 648 y("adisjunct")e(:)498
698 y(if)h(adalwaysmatches\(d\))d(then)j("<ELSE>")498
747 y(else)g(commaseparate\(map)o(list)o(\(cons)o(train)o(timag)o(e,)e
(d.aconstraints\),)f(")k(&)f("\))432 797 y(default)g(:)g
(impossible\("disjunc)o(t)e(type"\))345 847 y(})258 897
y(else)345 947 y(d.name)171 997 y(end)129 1048 y Fp(De\014nes:)171
1088 y Fl(disjunctim)o(age)o Fp(,)9 b(used)h(in)i(c)o(h)o(unk)e(369d.)
129 1127 y(Uses)k Fl(adalwaysm)o(atc)o(hes)9 b Fp(273b,)j
Fl(adisjunct)e Fp(268,)i Fl(constraint)o(ima)o(ge)e Fp(371a)h(371a,)h
Fl(disjunct)e Fp(55,)171 1167 y(and)h Fl(sequencei)o(mag)o(e)e
Fp(370c.)-29 1258 y(370c)88 b Fo(h)p Fn(*)16 b Fp(367)p
Fo(i)o Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(370b)23 b(370d)t
Fm(.)171 1308 y Fr(procedure)d(sequenceimage\(l\))215
1358 y(return)g(if)h(*l)h(=)f(0)h(then)f("<EPSILON>")367
1408 y(else)g(if)g(l[1])g(===)h(dots)f(then)g("...)f(")i(||)f
(sequenceimage\(l[2:0])o(\))367 1457 y(else)g(if)g(l[-1])g(===)g(dots)g
(then)g(sequenceimage\(l[1:-)o(1]\))e(||)i(")h(...")367
1507 y(else)f(commaseparate\(mapl)o(ist\(s)o(eque)o(ntima)o(ge,)e(l\),)
i(";)g("\))171 1557 y(end)129 1609 y Fp(De\014nes:)171
1648 y Fl(sequenceim)o(age)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(68)i
(and)g(370b.)129 1688 y(Uses)h Fl(dots)e Fp(62c)h(and)g
Fl(sequentima)o(ge)d Fp(370d.)-33 1779 y(370d)88 b Fo(h)p
Fn(*)16 b Fp(367)p Fo(i)o Fv(+)p Fo(\021)1037 b Fm(/)5
b Fp(370c)22 b(371a)5 b Fm(.)171 1829 y Fr(procedure)20
b(sequentimage\(s\))215 1879 y(return)g(if)h(s)h(===)f(dots)g(then)g
(impossible\("image)d(of)k(dots"\))367 1928 y(else)f(if)g(type\(s\))g
(==)g(\("patlabel")f(|)h("latent_patlabel"\))d(then)j(expimage\(s\))367
1978 y(else)g(if)g(*s.constraints)e(=)j(0)g(then)e("<Impossible)g
(ELSE?>")367 2028 y(else)h(commaseparate\(mapl)o(ist\(c)o(onst)o(raint)
o(image)o(,)e(s.constraints\),)g(")i(&)h("\))171 2078
y(end)129 2130 y Fp(De\014nes:)171 2169 y Fl(sequentima)o(ge)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(370c.)129 2209 y(Uses)16
b Fl(constrain)o(tim)o(age)c Fp(371a)i(371a,)f Fl(constraints)f
Fp(136a,)h Fl(dots)h Fp(62c,)g Fl(expimage)f Fp(101a,)171
2248 y Fl(latent_pat)o(lab)o(el)8 b Fp(55,)j(and)g Fl(patlabel)e
Fp(55.)p eop
%%Page: 371 371
371 370 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)744
b Fr(output.nw)81 b Fv(371)-15 258 y Fp(371a)88 b Fo(h)p
Fn(*)15 b Fp(367)p Fo(i)p Fv(+)p Fo(\021)1031 b Fm(/)5
b Fp(370d)22 b(371b)5 b Fm(.)187 307 y Fr(procedure)20
b(constraintimage\()o(c\))274 357 y(local)h(bitcount)274
407 y(s)h(:=)f("")274 457 y(case)g(type\(c\))f(of)i({)274
507 y("constraint":)d({)361 557 y(bitcount)h(:=)i(fieldbitcount\(c.)o
(field)o(\))361 606 y(if)g(c.lo)e(+)i(1)g(=)f(c.hi)g(then)448
656 y(s)h(||:=)f(patimage\(c.field\))d(||)k(")f(==)g(")h(||)f(c.lo)361
706 y(else)g(if)g(c.lo)g(=)h(0)g(&)f(c.hi)g(=)h(2^bitcount)d(then)448
756 y(s)j(||:=)f("<ANY)g(")g(||)h(bitcount)e(||)h("-bit)g(")g(||)h
(patimage\(c.field\))o(||)d(">")361 806 y(else)i(if)g(c.lo)g(>=)h(c.hi)
f(then)448 855 y(s)h(||:=)f("<IMPOSSIBLE)e(")j(||)f
(patimage\(c.field\))d(||)k(">")361 905 y(else)f({)448
955 y(if)h(c.lo)f(>)g(0)h(then)f(s)g(||:=)g(patimage\(c.field\))e(||)i
(")h(>=)f(")h(||)f(c.lo)448 1005 y(if)h(c.lo)f(>)g(0)h(&)f(c.hi)g(<)h
(2^bitcount)e(then)h(s)g(||:=)g(")h(&)f(")448 1055 y(if)261
b(c.hi)21 b(<)h(2^bitcount)e(then)710 1104 y(s)h(||:=)43
b(patimage\(c.field\))18 b(||)k(")f(<)h(")g(||)f(c.hi)361
1154 y(})274 1204 y(})274 1254 y("fieldbinding")e(:)i(s)h(||:=)f
(patimage\(c.field\))d(||)k(")f(=)h(")f(||)h(image\(c.code\))274
1304 y(default)e(:)i(impossible\("const)o(raint)c(type"\))274
1354 y(})274 1403 y(return)j(s)187 1453 y(end)145 1505
y Fp(De\014nes:)187 1544 y Fl(constraint)o(ima)o(ge)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(69a,)g(195,)h(and)f(370.)145
1584 y(Uses)i Fl(constraint)c Fp(55,)j Fl(field)f Fp(55,)h
Fl(fieldbindi)o(ng)d Fp(55,)j Fl(fieldbitcou)o(nt)d Fp(371b,)i(and)h
Fl(patimage)e Fp(372a.)-17 1675 y(371b)88 b Fo(h)p Fn(*)15
b Fp(367)p Fo(i)p Fv(+)p Fo(\021)1035 b Fm(/)5 b Fp(371a)22
b(372a)5 b Fm(.)187 1725 y Fr(procedure)20 b(fieldbitcount\(f\))252
1775 y(return)h(case)g(type\(f\))f(of)h({)296 1825 y("absolute_field")d
(:)k(fieldbitcount\(f.f)o(ield)o(\))296 1875 y("field")e(:)i
(fwidth\(f\))296 1924 y(default)e(:)i(impossible\("fiel)o(d)d(type"\))
252 1974 y(})187 2024 y(end)145 2076 y Fp(De\014nes:)187
2115 y Fl(fieldbitco)o(unt)o Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(371a.)
145 2155 y(Uses)i Fl(absolute_f)o(iel)o(d)d Fp(268,)h
Fl(field)g Fp(55,)h(and)g Fl(fwidth)e Fp(115d.)p eop
%%Page: 372 372
372 371 bop 129 141 a Fv(372)83 b Fr(output.nw)743 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)-31 258 y Fp(372a)88
b Fo(h)p Fn(*)16 b Fp(367)p Fo(i)o Fv(+)p Fo(\021)1031
b Fm(/)5 b Fp(371b)23 b(372b)t Fm(.)171 307 y Fr(procedure)d
(patimage\(v\))258 357 y(return)h(case)g(type\(v\))f(of)h({)345
407 y("list")g(|)g("set")g(:)44 b("[")21 b(||)g(commaseparate\(mapl)o
(ist\(p)o(atima)o(ge,)e(v\)\))i(||)g("]")345 457 y("matching_stmt")e(:)
j("MATCH)e(")i(||)f(patimage\(v.arms\))e(||)i("ENDMATCH")345
507 y("arm")g(:)h(image\(v.file\))d(||)i(",)h(line)e(")i(||)f
(string\(v.line\))e(||)j(":)f(")h(||)672 557 y(patimage\(v.pattern)o
(\))d(||)i(")h(=>)f(")h(||)f(v.code)345 606 y("pattern")f(:)i
(commaseparate\(map)o(list)o(\(pati)o(mage,)c(v.disjuncts\),)h(")j(|)f
("\))345 656 y("disjunct")f(:)i(if)f(*v.sequents)f(=)h(0)h(then)f
("epsilon")629 706 y(else)g(commaseparate\(m)o(aplis)o(t\(pat)o(image)o
(,)e(v.sequents\),)g(";)j("\))345 756 y("adisjunct":)e(if)h
(*v.aconstraints)e(=)i(0)h(then)f("<MATCH>")629 806 y(else)g
(commaseparate\(m)o(aplis)o(t\(pat)o(image)o(,)e(v.aconstraints\),)f(")
k(&)g("\))345 855 y("sequent")e(:)i(if)f(*v.constraints)e(=)j(0)f(then)
g("some)g(")h(||)f(v.class.name)607 905 y(else)g(commaseparate\(ma)o
(plist)o(\(pati)o(mage,)d(v.constraints\),)h(")i(&)h("\))345
955 y("constraint")e(:)h(stringininterval\(p)o(atima)o(ge\(v.)o(field)o
(\),)e(v.lo,)i(v.hi\))345 1005 y("fieldbinding")e(:)j
(patimage\(v.field)o(\))d(||)i(")h(=)g(")f(||)h(image\(v.code\))345
1055 y("field")f(:)g(v.name)345 1104 y("absolute_field")e(:)i("{")h(||)
f(patimage\(v.field\))d(||)k(")f(at)h(")f(||)h(v.offset)e(||)h("}")345
1154 y(default)g(:)g(image\(v\))258 1204 y(})171 1254
y(end)129 1306 y Fp(De\014nes:)171 1345 y Fl(patimage)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(37b,)h(72c,)f(73b,)h(276a,)f(278,)g
(280a,)g(290a,)h(371a,)f(and)g(373b.)129 1385 y(Uses)k
Fl(absolute_)o(fie)o(ld)c Fp(268,)h Fl(adisjunct)f Fp(268,)i
Fl(arm)g Fp(271b,)g Fl(constrain)o(t)e Fp(55,)i Fl(constraints)e
Fp(136a,)171 1424 y Fl(disjunct)i Fp(55,)i Fl(epsilon)e
Fp(62b,)i Fl(field)f Fp(55,)h Fl(fieldbindin)o(g)e Fp(55,)i
Fl(file)f Fp(359a,)g Fl(line)h Fp(359a,)171 1464 y Fl(matching_s)o(tmt)
8 b Fp(271b,)i Fl(pattern)f Fp(55,)i Fl(sequent)f Fp(55,)g(and)h
Fl(stringinin)o(ter)o(val)d Fp(372b.)-33 1555 y(372b)88
b Fo(h)p Fn(*)16 b Fp(367)p Fo(i)o Fv(+)p Fo(\021)1035
b Fm(/)5 b Fp(372a)22 b(373a)5 b Fm(.)171 1605 y Fr(procedure)20
b(stringininterval\()o(name,)e(lo,)j(hi\))258 1654 y(local)g(r,)g
(result)258 1704 y(if)h(type\(lo\))e(==)h("set")g(then)g({)345
1754 y(r)h(:=)f(sort\(lo)g(++)g(hi\))345 1804 y(if)h(*r)f(=)h(0)f(then)
g(return)g("<EMPTY)f(RANGE??>")345 1854 y(result)h(:=)g("\()h(")f(;)h
(result)e(||:=)h(stringininterval\(na)o(me,)e(get\(r\),)h(get\(r\)\))
345 1904 y(while)h(result)g(||:=)g(")g(|)h(")f(||)h(stringininterval)o
(\(name)o(,)d(get\(r\),)h(get\(r\)\))345 1953 y(return)h(result)f(||)i
(")f(\)")258 2003 y(})h(else)f(if)g(lo)g(+)h(1)g(=)f(hi)h(then)f
(return)f(name)h(||)g(")h(==)f(")h(||)f(fnum\(lo\))258
2053 y(else)g(return)g(fnum\(lo\))f(||)h(")h(<=)f(")h(||)f(name)g(||)g
(")44 b(<)21 b(")h(||)f(fnum\(hi\))171 2103 y(end)129
2155 y Fp(De\014nes:)171 2194 y Fl(stringinin)o(ter)o(val)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(104a,)h(278,)h(372a,)f(and)h(373b.)
129 2234 y(Uses)h Fl(fnum)e Fp(373a.)p eop
%%Page: 373 373
373 372 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)744
b Fr(output.nw)81 b Fv(373)-15 258 y Fp(373a)88 b Fo(h)p
Fn(*)15 b Fp(367)p Fo(i)p Fv(+)p Fo(\021)1031 b Fm(/)5
b Fp(372b)22 b(373b)5 b Fm(.)187 307 y Fr(procedure)20
b(fnum\(n\))274 357 y(n)i(:=)f(string\(n\))f(|)h
(impossible\("format"\))274 407 y(if)g(*n)h(<)f(2)h(then)f(n)g(:=)h
(right\(n,)e(2\))274 457 y(return)h(n)187 507 y(end)145
559 y Fp(De\014nes:)187 598 y Fl(fnum)p Fp(,)10 b(used)g(in)i(c)o(h)o
(unk)e(372b.)145 756 y Fj(22.1)66 b(W)-6 b(riting)25
b(trees)d(in)i(ascii)f(format)-17 847 y Fp(373b)88 b
Fo(h)p Fn(*)15 b Fp(367)p Fo(i)p Fv(+)p Fo(\021)1052
b Fm(/)6 b Fp(373a)22 b(374)5 b Fm(.)187 897 y Fr(procedure)20
b(outtree\(file,)f(n,)i(prefix,)g(shownode\))230 947
y(if)h(/prefix)e(then)h(write\(file,)f("TREE)g(",)i(image\(n.name\)\))
230 996 y(else)f(write\(image\(n.name\))o(\))230 1046
y(if)h(*n.children)d(>)j(0)f(then)g({)274 1096 y(span)g(:=)g
(*patimage\(n.field\))d(+)k(14)274 1146 y(every)f(e)g(:=)h(!n.children)
d(do)318 1196 y(outtree\(file,)g(e.node,)h(\(\\prefix)g(||)i(")f(&)h(")
f(|)h(")43 b("\))22 b(\\)f(1)h(||)361 1245 y(right\(stringininte)o
(rval\()o(patim)o(age\(n)o(.fie)o(ld\),)c(e.lo,)j(e.hi\),span\),)f
(shownode\))230 1295 y(})i(else)f({)274 1345 y(if)g(*n.cs.arms)f(=)i(0)
f(then)g(write\(file,)f(\\prefix)g(|)i(")43 b(",)21 b(")h(:)g(NO)f
(MATCH"\))274 1395 y(else)318 1445 y(every)f(write\(file,)g(\(\\prefix)
g(|)i(")43 b(ANY?)g("\)\\1,)20 b(")i(:)g(",)f(expimage\(!n.cs.ar)o
(ms\)\))230 1495 y(})230 1544 y(if)h(/prefix)e(then)h(write\(file,)f
("END)h(TREE\\n"\))230 1594 y(return)187 1644 y(end)145
1696 y Fp(De\014nes:)187 1735 y Fl(outtree)p Fp(,)9 b(used)h(in)i(c)o
(h)o(unks)d(22b,)i(290b,)f(and)h(295b.)145 1775 y(Uses)18
b Fl(expimage)d Fp(101a,)i Fl(field)f Fp(55,)h Fl(file)g
Fp(359a,)f Fl(node)h Fp(272,)g Fl(patimage)e Fp(372a,)187
1814 y(and)10 b Fl(stringinint)o(erv)o(al)e Fp(372b.)p
eop
%%Page: 374 374
374 373 bop 129 141 a Fv(374)83 b Fr(output.nw)743 b
Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)129 258 y Fj(22.2)66
b(W)-6 b(riting)25 b(trees)d(and)h(dags)f(in)h Fb(dot\(1\))e
Fj(format)-13 349 y Fp(374)88 b Fo(h)p Fn(*)16 b Fp(367)p
Fo(i)o Fv(+)p Fo(\021)1031 b Fm(/)5 b Fp(373b)23 b(375b)t
Fm(.)171 398 y Fr(global)e(pagesize)171 448 y(procedure)f
(dotouttree\(file,)e(root\))258 498 y(write\(file,)i("digraph)g
(decisions)g({"\))258 548 y(write\(file,)g(")43 b(page=",)20
b(image\(pagesize\),)f(";"\))258 598 y(write\(file,)h(")43
b(ratio=compress;"\))258 647 y(dotoutnode\(file,)19 b(root,)h
(table\(\),)h(create\(seq\(\)\)\))258 697 y(write\(file,)f("}"\))171
747 y(end)171 847 y(procedure)g(dotoutnode\(file,)e(n,)k(known,)e
(number\))258 897 y(if)i(/known[n])d(then)i({)345 946
y(if)h(*n.children)d(>)j(0)f(then)g({)432 996 y(if)h(alt)f(:=)g
(alternates\(n\))f(then)g({)520 1046 y(writes\(file,)f("N",)i(known[n])
f(:=)h(@number,)g(")g([label=\\""\))520 1096 y(every)f(i)i(:=)f(1)h(to)
f(*alt.constraints)e(do)i({)585 1146 y(if)g(i)h(>)g(1)f(then)g
(writes\(file,)e(","\))585 1195 y(writes\(file,)g(alt.constraints[i].)o
(field)o(.fiel)o(d.nam)o(e\))585 1245 y(writes\(file,)g("@",)i(0)h(<)f
(alt.constraints[i].f)o(ield.)o(offs)o(et\))520 1295
y(})520 1345 y(write\(file,)e("\\"];"\))520 1395 y(every)h
(dotoutnode\(file,)f(alt.thennode)g(|)j(alt.elsenode,)d(known,)h
(number\))520 1444 y Fo(h)p Fn(make)15 b Fr(s)g Fn(a)g(lab)n(el)f
(string)g(for)h Fr(alt.constraints)c Fp(375a)p Fo(i)520
1494 y Fr(write\(file,)19 b("N",)i(known[n],)f(")i(->)f(N",)g
(known[alt.thennode)o(],)e(")i([label=",)803 1544 y(image\(s\),)f
("];"\))520 1594 y(write\(file,)f("N",)i(known[n],)f(")i(->)f(N",)g
(known[alt.elsenode)o(],)781 1644 y(")h([label=\\"else\\"])o(;"\))432
1694 y(})g(else)f({)520 1743 y(write\(file,)e("N",)i(known[n])f(:=)i
(@number,)781 1793 y(")g([label=\\"",)d(n.field.field.name,)781
1843 y("@")i(||)h(\(0)f(<)h(n.field.offset\))c(|)k("",)f("\\"];"\))520
1893 y(every)f(e)i(:=)f(!n.children)f(do)h({)607 1943
y(dotoutnode\(file,)d(e.node,)j(known,)f(number\))607
1992 y(r)h(:=)h(sort\(e.lo)e(++)h(e.hi\))607 2042 y(lo)g(:=)h(get\(r\))
e(&)i(hi)f(:=)g(get\(r\))607 2092 y(s)g(:=)h("")607 2142
y(s)f(||:=)g(if)h(lo+1)f(=)g(hi)h(then)f(lo)g(else)g(lo)g(||)h("-")f
(||)g(\(hi)g(-)h(1\))607 2192 y(while)f(lo)g(:=)g(get\(r\))g(&)g(hi)h
(:=)f(get\(r\))g(do)650 2241 y(s)h(||:=)f(",)g(")h(||)f(if)h(lo+1)f(=)g
(hi)h(then)f(lo)g(else)g(lo)g(||)h("-")f(||)g(\(hi)g(-)h(1\))607
2291 y(write\(file,)d("N",)i(known[n],)f(")i(->)f(N",)g(known[e.node],)
e(")j([label=",)738 2341 y(image\(commasepa)o(rate\()o(split)o(10\(s\))
o(,)d("\\n"\)\),)h("];"\))520 2391 y(})432 2441 y(})345
2491 y(})i(else)f(if)g(*n.cs.arms)f(=)i(0)f(then)p eop
%%Page: 375 375
375 374 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)744
b Fr(output.nw)81 b Fv(375)448 258 y Fr(write\(file,)20
b("N",)h(known[n])f(:=)h(@number,)f(")i([label=",)e(image\("NO)g
(MATCH"\),)g("];"\))361 307 y(else)h({)448 357 y(writes\(file,)f("N",)h
(known[n])f(:=)h(@number,)f(")i([label=\\""\))187 407
y(#)239 b(outpattern\(file,)19 b(n.cs.arms[1].ori)o(ginal)o(.patt)o
(ern\))448 457 y(writes\(file,)h(\\n.cs.arms[1].or)o(igin)o(al.pa)o
(ttern)o(.name)e(|)710 507 y("[")j(||)g(n.cs.arms[1].origin)o(al.li)o
(ne)e(||)i("]"\))448 557 y(write\(file,)f("\\"];"\))361
606 y(})274 656 y(})274 706 y(return)187 756 y(end)145
808 y Fp(De\014nes:)187 847 y Fl(dotouttree)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)d(22b.)187 887 y Fl(pagesize)p
Fp(,)g(used)h(in)h(c)o(h)o(unks)f(14k)h(and)f(19a.)145
926 y(Uses)k Fl(alternate)o(s)d Fp(22c,)h Fl(constraint)o(s)e
Fp(136a,)i Fl(field)g Fp(55,)g Fl(file)g Fp(359a,)g Fl(label)g
Fp(383a,)g Fl(line)g Fp(359a,)187 965 y Fl(node)e Fp(272,)h
Fl(outpatter)o(n)e Fp(369b,)h Fl(pattern)f Fp(55,)i(and)g
Fl(split10)e Fp(375b.)-15 1057 y(375a)88 b Fo(h)p Fn(make)16
b Fr(s)e Fn(a)h(lab)n(el)g(string)f(for)g Fr(alt.constraints)e
Fp(375a)p Fo(i)o(\021)416 b Fp(\(374\))187 1107 y Fr(s)21
b(:=)h("")187 1156 y(every)f(i)g(:=)h(1)f(to)g(*alt.constraints)e(do)i
({)252 1206 y(if)h(i)f(>)h(1)f(then)g(s)h(||:=)f(",")252
1256 y(c)h(:=)f(alt.constraints[i])252 1306 y(if)h(*c.lo)e(>)i(1)f
(then)g(s)h(||:=)f("...")252 1356 y(else)g(if)h(?c.lo)e(+)i(1)f(=)h
(?c.hi)f(then)g(s)g(||:=)g(?c.lo)252 1405 y(else)g(s)h(||:=)f(?c.lo)f
(||)i("-")f(||)g(\(?c.hi)g(-)h(1\))187 1455 y(})187 1505
y(s)f(:=)h(split10\(s\))145 1557 y Fp(Uses)12 b Fl(constraint)o(s)d
Fp(136a)h(and)h Fl(split10)e Fp(375b.)-17 1648 y(375b)88
b Fo(h)p Fn(*)15 b Fp(367)p Fo(i)p Fv(+)p Fo(\021)1170
b Fm(/)5 b Fp(374)187 1698 y Fr(procedure)20 b(split10\(s\))230
1748 y(static)h(N)230 1798 y(local)g(k)230 1848 y(initial)g(N)g(:=)h
(18)230 1897 y(if)g(*s)f(>)h(N)f(&)h(find\(",)e(",)i(s\))f(<=)g(N)h
(then)f({)296 1947 y(every)g(k)g(:=)g(N)h(>=)f(find\(",)g(",)g(s\))296
1997 y(return)f(s[1:k+1])g(||)i("\\n")f(||)g(split10\(s[k+2:0]\))d(#)k
(keep)f(comma,)g(drop)g(space)230 2047 y(})h(else)f({)274
2097 y(return)g(s)230 2146 y(})187 2196 y(end)145 2248
y Fp(De\014nes:)187 2288 y Fl(split10)p Fp(,)9 b(used)h(in)i(c)o(h)o
(unks)d(374)i(and)g(375a.)p eop
%%Page: 376 376
376 375 bop 129 141 a Fv(376)83 b Fr(debug.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(376a)88 b Fo(h)p Fn(*)16
b Fp(376a)p Fo(i)n(\021)1167 b Fp(377a)5 b Fm(.)171 307
y Fr(global)21 b(debug,)f(debugs,)g(debugstack)171 357
y(procedure)g(wrerr\(L[]\))258 407 y(write)h(!)g(\([&errout])f(|||)h
(L\))171 457 y(end)171 507 y(procedure)f(wrerrs\(L[]\))258
557 y(writes)h(!)g(\([&errout])f(|||)h(L\))171 606 y(end)171
656 y(procedure)f(nop\(\))171 706 y(end)171 806 y(procedure)g
(debug_on\(\))215 855 y(/debugstack)f(:=)i([])215 905
y(every)f(push\(debugstack,)f(debug)i(|)g(debugs\))215
955 y(debug)f(:=)i(wrerr)215 1005 y(debugs)e(:=)h(wrerrs)215
1055 y(return)171 1104 y(end)171 1204 y(procedure)f(debug_off\(\))215
1254 y(/debugstack)f(:=)i([])215 1304 y(every)f(push\(debugstack,)f
(debug)i(|)g(debugs\))215 1354 y(debug)f(:=)i(debugs)e(:=)i(nop)215
1403 y(return)171 1453 y(end)171 1553 y(procedure)e(debug_pop\(\))215
1603 y(every)g(debugs)h(|)g(debug)g(:=)h(pop\(debugstack\))215
1652 y(return)171 1702 y(end)129 1804 y Fp(De\014nes:)171
1843 y Fl(debug)p Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(11,)h(12a,)g
(19a,)f(136{40,)g(142{45,)f(148b,)h(150a,)g(152,)h(154,)f(and)h(157.)
171 1883 y Fl(debug_on)p Fp(,)e(used)h(in)h(c)o(h)o(unk)f(11k.)171
1922 y Fl(debugs)p Fp(,)f(used)i(in)g(c)o(h)o(unks)f(19a,)g(136a,)h
(and)f(145e.)171 1962 y Fl(nop)p Fp(,)g(used)h(in)g(c)o(h)o(unk)f(19a.)
-33 2045 y(376b)88 b Fo(h)p Fn(inte)n(ger-input)15 b(err)n(or)f
Fp(376b)p Fo(i)n(\021)171 2095 y Fr(#)22 b(error\("unknown)c(integer)j
(input)g(`",)g(image\(i\),"')e(of)j(type)f(`",)g(type\(i\),)f("'"\))129
2146 y Fp(Uses)12 b Fl(input)e Fp(46a.)p eop
%%Page: 377 377
377 376 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(debug.nw)81 b Fv(377)208 258 y(Note)14 b(this)g(pro)q(cedure)i(do)
q(esn't)e(paren)o(thesize)i(prop)q(erly)m(.)-15 320 y
Fp(377a)88 b Fo(h)p Fn(*)15 b Fp(376a)p Fo(i)o Fv(+)p
Fo(\021)1020 b Fm(/)5 b Fp(376a)22 b(377c)5 b Fm(.)187
370 y Fr(procedure)20 b(astimage\(n\))274 420 y(return)h(case)f
(type\(n\))h(of)g({)361 469 y("pattern")42 b(:)21 b("<pattern>)f(")i
(||)f(patternimage\(n\))361 519 y("Pident")64 b(:)21
b(n.name)361 569 y("Pcon")108 b(:)21 b(n.name)g(||)g(")h(")g(||)f
(n.relop)f(||)i(")f(")h(||)f(astimage\(n.value\))361
619 y("Pand")108 b(:)21 b(commaseparate\(astima)o(ge\(n)o(.patt)o
(erns\))o(,)e(")j(&)f("\))361 669 y("Por")130 b(:)21
b(commaseparate\(astima)o(ge\(n)o(.patt)o(erns\))o(,)e(")j(|)f("\))361
718 y("Pseq")108 b(:)21 b Fo(h)p Fn(image)16 b(of)e Fr(Pseq)g
Fn(\(p)n(ossibly)h(with)f(dots\))h Fp(377b)p Fo(i)361
768 y Fr("Papp")108 b(:)21 b(astimage\(n.cons\))e(||)i("\(")g(||)h
(commaseparate\(ast)o(image)o(\(n.a)o(rgs\)\))c(||)k("\)")361
818 y("integer")42 b(:)21 b(n)361 868 y("string")64 b(:)21
b(n)361 918 y("Glist")86 b(:)21 b(astimage\(n.values\))361
967 y("list")108 b(:)21 b(maplist\(astimage,)e(n\))361
1017 y(default)86 b(:)21 b(image\(n\))274 1067 y(})187
1117 y(end)145 1169 y Fp(De\014nes:)187 1208 y Fl(astimage)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(377b.)145 1248 y(Uses)i
Fl(Glist)e Fp(42b,)h Fl(Pand)g Fp(41a,)f Fl(Papp)h Fp(41a,)g
Fl(pattern)e Fp(55,)i Fl(patternima)o(ge)e Fp(369d,)h
Fl(Pcon)h Fp(41a,)f Fl(Pident)g Fp(41a,)187 1287 y Fl(Por)g
Fp(41a,)h Fl(Pseq)f Fp(41a,)h(and)f Fl(value)g Fp(136a.)-17
1370 y(377b)88 b Fo(h)p Fn(image)15 b(of)g Fr(Pseq)f
Fn(\(p)n(ossibly)h(with)f(dots\))h Fp(377b)p Fo(i)o(\021)561
b Fp(\(377a\))187 1420 y Fr(if)21 b(*n.patterns)f(=)h(2)h(&)f
(n.patterns[1])f(===)h(dots_pattern\(\))e(then)230 1470
y("...)i(")h(||)f(astimage\(n.patterns)o([2]\))187 1520
y(else)g(if)g(*n.patterns)f(=)h(2)h(&)f(n.patterns[2])f(===)h
(dots_pattern\(\))e(then)230 1569 y(astimage\(n.patterns)o([1]\))f(||)k
(")f(...")187 1619 y(else)230 1669 y(commaseparate\(astim)o(age\(n)o
(.patt)o(erns\))o(,)e(";)i("\))145 1721 y Fp(Uses)12
b Fl(astimage)d Fp(377a)h(and)h Fl(dots_patte)o(rn)d
Fp(62c.)-13 1812 y(377c)88 b Fo(h)p Fn(*)15 b Fp(376a)p
Fo(i)o Fv(+)p Fo(\021)1018 b Fm(/)5 b Fp(377a)22 b(378a)5
b Fm(.)187 1862 y Fr(procedure)20 b(solnimage\(soln\))230
1912 y(s)i(:=)f(envimage\(soln.answe)o(rs,)e("answers"\))g(||)j("\\n")
230 1962 y(s)g(||:=)f("Uses)g(")g(||)h(commafy\(maplist\()o(expim)o
(age,)c(sort\(\\soln.used\)\)\))g(||)k("\\n")230 2011
y(s)g(||:=)f("Defines)f(")i(||)f(commafy\(maplist\(ex)o(pima)o(ge,)e
(sort\(\\soln.defin)o(ed\)\)\))f(||)j("\\n")230 2061
y(s)h(||:=)f("\(constraints:)e(")i(||)h(commafy\(maplist\()o(expim)o
(age,)c(\\soln.constraints\)\))g(||)k(")f(\)")230 2111
y(return)g(s)187 2161 y(end)145 2213 y Fp(De\014nes:)187
2252 y Fl(solnimage)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(263b.)145
2292 y(Uses)i Fl(constraint)o(s)d Fp(136a,)h Fl(defined)f
Fp(136a,)h Fl(envimage)f Fp(27a,)i Fl(expimage)e Fp(101a,)h(and)g
Fl(used)h Fp(136a.)p eop
%%Page: 378 378
378 377 bop 129 141 a Fv(378)83 b Fr(debug.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(378a)88 b Fo(h)p Fn(*)16
b Fp(376a)p Fo(i)n Fv(+)q Fo(\021)1017 b Fm(/)5 b Fp(377c)23
b(378b)t Fm(.)171 307 y Fr(procedure)d(injectimage\(i\))215
357 y(return)g("\\tas)h(pattern:)f(")i(||)f(expimage\(i.patter)o(n\))e
(||)i("\\n")g(||)367 407 y("\\tas)g(integer:)f(")i(||)f
(expimage\(i.intege)o(r\))e(||)i("\\n")g(||)367 457 y("\\tas)g(consop:)
f(")i(||)f(expimage\(i.consop\))d(||)k("\\n")171 507
y(end)129 559 y Fp(Uses)12 b Fl(expimage)d Fp(101a)h(and)h
Fl(pattern)e Fp(55.)129 629 y Fv(Sho)o(w)14 b(with)g(p)q(ositiv)o(e)f
(co)q(e\016cien)o(ts.)-33 691 y Fp(378b)88 b Fo(h)p Fn(*)16
b Fp(376a)p Fo(i)n Fv(+)q Fo(\021)1134 b Fm(/)6 b Fp(378a)171
741 y Fr(procedure)20 b(zeroimage\(z\))215 791 y(e)h(:=)h
(eqn\(table\(0\),)d("=",)i(table\(0\)\))215 841 y(every)f(k)i(:=)f
(key\(z\))g(do)258 891 y(if)h(z[k])e(>)i(0)g(then)f(e.left[k])f(:=)h
(z[k])g(else)g(e.right[k])f(:=)h(-z[k])215 941 y(return)f
(expimage\(e\))171 990 y(end)129 1042 y Fp(Uses)12 b
Fl(eqn)f Fp(83c)g(and)f Fl(expimage)f Fp(101a.)p eop
%%Page: 379 379
379 378 bop 714 998 a Fq(P)m(art)32 b(I)s(I)537 1206
y Fu(Library)40 b(co)s(de)830 2604 y Fv(379)p eop
%%Page: 380 380
380 379 bop eop
%%Page: 381 381
381 380 bop 145 569 a Fq(Chapter)32 b(23)145 777 y Fu(The)38
b(library)145 992 y Fv(This)10 b(\014le)g(implemen)o(ts)e(the)j(to)q
(olkit)e(library)m(.)15 b(The)c(declarations)f(of)g(exp)q(orted)h(pro)q
(cedures)145 1042 y(and)h(t)o(yp)q(es)h(app)q(ear)f(in)f
Fr(library.nw)p Fv(.)16 b(Some)10 b(pro)q(cedures)k(and)e(t)o(yp)q(es)h
(are)f(exp)q(orted)h(here)145 1092 y(to)20 b(help)g(supp)q(ort)h(exp)q
(orted)g(macros,)f(but)g(users)i(aren't)e(supp)q(osed)h(to)f(kno)o(w)f
(ab)q(out)145 1142 y(them.)208 1192 y(Our)9 b(goal)f(in)h(this)h
(implem)o(en)o(tation)c(is)k(to)f(mak)o(e)f(sequen)o(tial)h(emission)f
(of)h(instructions)145 1241 y(v)o(ery)14 b(fast.)145
1379 y Fj(23.1)66 b(Relo)r(catable)23 b(Blo)r(c)n(ks)145
1470 y Fv(Figure)18 b(23.1)f(sho)o(ws)h(the)g(parts)g(of)g(a)f(relo)q
(catable)h(blo)q(c)o(k)f(that)h(handle)g(its)g Fr(contents)p
Fv(.)145 1519 y(The)f(blo)q(c)o(k)e(uses)i(a)f(link)o(ed)f(list)g(of)g
(bu\013ers.)26 b(Eac)o(h)16 b(bu\013er)h(is)e(sho)o(wn)h(as)g(a)g
(dashed)g(b)q(o)o(x.)145 1569 y(Within)11 b(the)i(bu\013er,)g
Fr(data)e Fv(p)q(oin)o(ts)h(to)f(the)i(\014rst)g(b)o(yte)f(of)f(the)i
(data)e(area)i(\(solid)e(b)q(o)o(x\),)h(and)145 1619
y Fr(limit)h Fv(p)q(oin)o(ts)h(just)g(b)q(ey)o(ond)g(the)h(last)e(b)o
(yte.)2 1681 y Fp(381)89 b Fo(h)p Fn(exp)n(orte)n(d)15
b(data)h(de)n(clar)n(ations)e Fp(381)p Fo(i)o(\021)614
b Fp(\(409b\))21 b(382a)5 b Fm(.)187 1731 y Fr(typedef)20
b(struct)h(rblock_buffer)e({)230 1781 y(unsigned)i(char)f(*data,)h
(*limit;)230 1831 y(struct)g(rblock_buffer)e(*next;)230
1881 y(unsigned)i(datalc;)p 216 2255 205 4 v 216 2354
4 100 v 418 2354 V 216 2357 205 4 v 563 2255 V 563 2354
4 100 v 764 2354 V 563 2357 205 4 v 910 2255 V 910 2354
4 100 v 1111 2354 V 910 2357 205 4 v 1256 2255 V 1256
2354 4 100 v 1458 2354 V 1256 2357 205 4 v 418 2306 137
4 v 512 2304 a Fa(-)p 764 2306 V 305 w(-)p 1111 2306
V 305 w(-)p 1035 2255 4 236 v 1037 2255 a(?)p 230 2255
4 100 v -847 w(?)p 428 2255 V 156 w(?)p 911 2094 4 87
v 913 2094 a(?)p 145 2381 10 4 v 165 2381 V 185 2381
V 205 2381 V 225 2381 V 244 2381 V 264 2381 V 284 2381
V 304 2381 V 324 2381 V 343 2381 V 363 2381 V 383 2381
V 403 2381 V 423 2381 V 442 2381 V 462 2381 V 482 2381
V 502 2381 V 145 2096 V 165 2096 V 185 2096 V 205 2096
V 225 2096 V 244 2096 V 264 2096 V 284 2096 V 304 2096
V 324 2096 V 343 2096 V 363 2096 V 383 2096 V 403 2096
V 423 2096 V 442 2096 V 462 2096 V 482 2096 V 502 2096
V 144 2379 4 5 v 515 2379 V 144 2099 V 515 2099 V 144
2126 4 10 v 144 2146 V 144 2166 V 144 2186 V 144 2206
V 144 2225 V 144 2245 V 144 2265 V 144 2285 V 144 2305
V 144 2325 V 144 2344 V 144 2364 V 515 2126 V 515 2146
V 515 2166 V 515 2186 V 515 2206 V 515 2225 V 515 2245
V 515 2265 V 515 2285 V 515 2305 V 515 2325 V 515 2344
V 515 2364 V 554 2381 10 4 v 574 2381 V 594 2381 V 613
2381 V 633 2381 V 653 2381 V 673 2381 V 693 2381 V 712
2381 V 732 2381 V 752 2381 V 772 2381 V 792 2381 V 811
2381 V 831 2381 V 851 2381 V 554 2096 V 574 2096 V 594
2096 V 613 2096 V 633 2096 V 653 2096 V 673 2096 V 693
2096 V 712 2096 V 732 2096 V 752 2096 V 772 2096 V 792
2096 V 811 2096 V 831 2096 V 851 2096 V 552 2379 4 5
v 862 2379 V 552 2099 V 862 2099 V 552 2126 4 10 v 552
2146 V 552 2166 V 552 2186 V 552 2206 V 552 2225 V 552
2245 V 552 2265 V 552 2285 V 552 2305 V 552 2325 V 552
2344 V 552 2364 V 862 2126 V 862 2146 V 862 2166 V 862
2186 V 862 2206 V 862 2225 V 862 2245 V 862 2265 V 862
2285 V 862 2305 V 862 2325 V 862 2344 V 862 2364 V 901
2381 10 4 v 920 2381 V 940 2381 V 960 2381 V 980 2381
V 1000 2381 V 1019 2381 V 1039 2381 V 1059 2381 V 1079
2381 V 1099 2381 V 1119 2381 V 1138 2381 V 1158 2381
V 1178 2381 V 1198 2381 V 901 2096 V 920 2096 V 940 2096
V 960 2096 V 980 2096 V 1000 2096 V 1019 2096 V 1039
2096 V 1059 2096 V 1079 2096 V 1099 2096 V 1119 2096
V 1138 2096 V 1158 2096 V 1178 2096 V 1198 2096 V 899
2379 4 5 v 1209 2379 V 899 2099 V 1209 2099 V 899 2126
4 10 v 899 2146 V 899 2166 V 899 2186 V 899 2206 V 899
2225 V 899 2245 V 899 2265 V 899 2285 V 899 2305 V 899
2325 V 899 2344 V 899 2364 V 1209 2126 V 1209 2146 V
1209 2166 V 1209 2186 V 1209 2206 V 1209 2225 V 1209
2245 V 1209 2265 V 1209 2285 V 1209 2305 V 1209 2325
V 1209 2344 V 1209 2364 V 1247 2381 5 4 v 1247 2096 V
1465 2381 V 1465 2096 V 1262 2381 10 4 v 1282 2381 V
1302 2381 V 1322 2381 V 1341 2381 V 1361 2381 V 1381
2381 V 1401 2381 V 1421 2381 V 1440 2381 V 1262 2096
V 1282 2096 V 1302 2096 V 1322 2096 V 1341 2096 V 1361
2096 V 1381 2096 V 1401 2096 V 1421 2096 V 1440 2096
V 1246 2379 4 5 v 1469 2379 V 1246 2099 V 1469 2099 V
1246 2126 4 10 v 1246 2146 V 1246 2166 V 1246 2186 V
1246 2206 V 1246 2225 V 1246 2245 V 1246 2265 V 1246
2285 V 1246 2305 V 1246 2325 V 1246 2344 V 1246 2364
V 1469 2126 V 1469 2146 V 1469 2166 V 1469 2186 V 1469
2206 V 1469 2225 V 1469 2245 V 1469 2265 V 1469 2285
V 1469 2305 V 1469 2325 V 1469 2344 V 1469 2364 V 188
2144 a Fr(data)100 b(limit)1026 2008 y(p)424 2292 y(next)170
2069 y(firstbuf)848 1995 y(curbuf)451 2470 y Fv(Figure)14
b(23.1:)j(Relo)q(catable)c(blo)q(c)o(k)h(with)f(4)h(bu\013ers)830
2604 y(381)p eop
%%Page: 382 382
382 381 bop 129 141 a Fv(382)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)171 258 y Fr(})22 b(*Buffer;)129
310 y Fp(De\014nes:)171 349 y Fl(Buffer)p Fp(,)9 b(used)i(in)g(c)o(h)o
(unks)f(382b,)g(391a,)g(400,)h(and)f(401.)129 388 y(Uses)i
Fl(next)e Fp(399c.)129 451 y Fr(datalc)k Fv(cac)o(hes)j(the)e(v)n(alue)
g(of)f(the)i(lo)q(cation)e(coun)o(ter)i Fr(lc)f Fv(that)g(is)g(asso)q
(ciated)h(with)f(the)129 500 y(b)q(eginning)j(of)g(the)h(bu\013er,)h
(so)f(that)f(it)g(do)q(esn't)h(alw)o(a)o(ys)f(ha)o(v)o(e)g(to)g(b)q(e)h
(recomputed)g(b)o(y)129 550 y(w)o(alking)13 b(along)f(the)j(list.)192
600 y(Although)d(a)h(relo)q(catable)g(blo)q(c)o(k)f(has)h(a)g(lo)q
(cation)f(coun)o(ter,)h(w)o(e)g(don't)g(actually)f(store)129
650 y(it.)18 b(Instead,)12 b(w)o(e)h(store)g Fr(p)p Fv(,)e(whic)o(h)h
(is)g(a)g(p)q(oin)o(ter)h(in)o(to)e(the)i(curren)o(t)g(bu\013er,)g
(called)f Fr(curbuf)p Fv(;)129 700 y(from)f(that)i(w)o(e)g(can)g
(compute)f(an)g(in)o(teger)i(lo)q(cation)d(coun)o(ter)j(if)e(w)o(e)h
(ha)o(v)o(e)f(to.)1354 685 y Ff(1)1390 700 y Fv(But)i(what)129
750 y(happ)q(ens)20 b(initially)m(,)c(b)q(efore)j(there's)h(an)o(y)d
(data?)32 b(W)m(e)18 b(w)o(an)o(t)g(to)g(b)q(e)h(able)f(to)g(mo)o(v)o
(e)f(the)129 799 y(lo)q(cation)f(coun)o(ter)h(around)f(without)g(allo)q
(cating)f(an)o(y)h(bu\013er)h(space,)g(so)g(w)o(e)f(giv)o(e)g(ev)o(ery)
129 849 y(relo)q(catable)g(blo)q(c)o(k)f(an)g(initial,)e(empt)o(y)i
(bu\013er)h(called)f Fr(firstbuf)p Fv(.)21 b(W)m(e)15
b(can)g(then)h(mo)o(v)o(e)129 899 y(the)g(lo)q(cation)d(coun)o(ter)j
(around)e(b)o(y)g(c)o(hanging)g Fr(firstbuf.datalc)p
Fv(.)j(Moreo)o(v)o(er,)e(w)o(e)f(can)129 949 y(tell)j(when)g(the)g(lo)o
(w)e(w)o(ater)i(mark)e(has)i(b)q(een)g(set)h(b)o(y)e(seeing)h(when)g
Fr(firstbuf.next)d Fv(is)129 999 y(non-n)o(ull,)f(in)g(whic)o(h)h(case)
h Fr(firstbuf.datalc)10 b Fv(is)k(the)h(lo)o(w)e(w)o(ater)h(mark:)-31
1061 y Fp(382a)88 b Fo(h)p Fn(exp)n(orte)n(d)16 b(data)f(de)n(clar)n
(ations)f Fp(381)p Fo(i)p Fv(+)p Fo(\021)481 b Fp(\(409b\))22
b Fm(/)5 b Fp(381)22 b(384a)5 b Fm(.)171 1111 y Fr(struct)21
b(reloc_block)e({)215 1161 y(struct)h(rblock_buffer)f(firstbuf,)h
(*curbuf;)215 1210 y(unsigned)g(char)h(*p;)108 b(/*)21
b(points)g(to)g(current)g(lc)g(--)g(dirty)g(*/)215 1260
y(unsigned)f(size;)173 b(/*)21 b(highest)g(lc)g(ever)g(--)g(dirty)g(*/)
215 1310 y Fo(h)p Fn(other)14 b(\014elds)h(of)g(a)g(r)n(elo)n(c)n
(atable)f(blo)n(ck)h Fp(383a)p Fo(i)171 1360 y Fr(};)129
1412 y Fp(Uses)d Fl(lc)f Fp(396b.)129 1474 y Fv(A)16
b Fn(dirty)f Fv(\014eld)h(is)f(one)h(that)g(is)f(in)o(v)n(alid)f(in)h
(the)h(presence)i(of)d(certain)i(optimizations;)c(w)o(e)129
1524 y(giv)o(e)h(more)f(dirt)g(b)q(elo)o(w.)-33 1586
y Fp(382b)88 b Fo(h)p Fn(initialize)14 b(a)h(new)g(r)n(elo)n(c)n
(atable)f(blo)n(ck)h Fr(rb)g Fp(382b)p Fo(i)n(\021)423
b Fp(\(398d\))22 b(383b)t Fm(.)171 1636 y Fr(rb->curbuf)e(=)h
(&rb->firstbuf;)171 1686 y Fo(h)p Fn(set)15 b Fr(data)f
Fn(and)h Fr(limit)f Fn(in)h(a)g(new)g Fr(rb->firstbuf)d
Fp(385d)p Fo(i)171 1735 y Fr(rb->p)21 b(=)g(rb->firstbuf.data;)171
1785 y(rb->firstbuf.next)d(=)k(\(Buffer\)0;)171 1835
y(rb->firstbuf.data)o(lc)d(=)i(0;)174 b(/*)22 b(lc)f(is)g(initially)f
(0)i(*/)129 1887 y Fp(Uses)12 b Fl(Buffer)e Fp(381,)g
Fl(lc)h Fp(396b,)f(and)h Fl(next)f Fp(399c.)129 1949
y Fv(Again)i(b)q(ecause)i(of)e(sneaky)h(optimizations,)d(w)o(e)i(w)o
(on't)g(tell)g(y)o(ou)g(just)h(ho)o(w)f(w)o(e're)h(initial-)129
1999 y(izing)g Fr(data)f Fv(and)h Fr(limit)e Fv(in)i(a)g(new)g(blo)q(c)
o(k,)f(except)j(to)e(sa)o(y)f(they're)i(equal)f(\(th)o(us)g(the)h
(\014rst)129 2049 y(blo)q(c)o(k)g(is)g(empt)o(y\).)p
129 2421 573 2 v 176 2448 a Fc(1)193 2460 y Fp(Actually)m(,)f(as)g(w)o
(e)h(sho)o(w)g(b)q(elo)o(w,)g Fl(p)f Fp(needn't)f(p)q(oin)o(t)g(in)o
(to)h(the)g(curren)o(t)f(bu\013er,)g(but)h(its)h(meaning)d(is)129
2499 y(still)g(relativ)o(e)f(to)h(the)g(start)f(of)h(the)g(curren)o(t)f
(bu\013er.)p eop
%%Page: 383 383
383 382 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(383)208 258 y(A)19 b(relo)q(catable)h(blo)q(c)o
(k)g(has)g(three)h(other)f(prop)q(erties:)31 b(an)20
b(address,)i(a)d(lab)q(el,)i(and)145 307 y(asso)q(ciated)13
b(register)g(information.)h(Some)d(of)g(this)h(prop)q(erties)h(can)f(b)
q(e)g(n)o(ull,)f(so)h(I)f(include)145 357 y(some)h(\015ags)g(that)g
(indicate)h(when)g(v)n(alues)f(are)g(n)o(ull.)17 b(These)d(\015ags)e
(are)h(put)f(in)g(a)g(structure)145 407 y(called)j Fr(known)p
Fv(,)e(so)h(that)h(they)g(ha)o(v)o(e)f(the)i(correct)g(v)n(alues)e
(\(not)h(kno)o(wn\))f(if)g(a)g(relo)q(catable)145 457
y(blo)q(c)o(k)j(is)f(initialized)g(to)g(all)g(zero)q(es.)28
b(This)17 b(prop)q(ert)o(y)h(mak)o(es)d(an)i(all-zero)q(es)g
(unde\014ned)145 507 y(relo)q(catable)i(blo)q(c)o(k)g(v)n(alid|the)f
(unde\014ned)i(blo)q(c)o(k)e(m)o(ustn't)g(ha)o(v)o(e)h(a)f(kno)o(wn)h
Fr(address)145 557 y Fv(b)q(ecause)f(that)d(mak)o(es)g(it)g(p)q
(ossible)h(to)g(see)g(whether)h(a)f(lab)q(el)f(is)g(de\014ned)i(with)f
(a)f(simple)145 606 y(c)o(hec)o(k)i(to)f(see)h(if)f(the)g(address)h(of)
f(the)h(lab)q(el's)e(blo)q(c)o(k)h(is)f(kno)o(wn.)24
b(Otherwise)18 b(w)o(e)e(w)o(ould)145 656 y(need)f(an)f(extra)g(c)o
(hec)o(k)h(to)f(mak)o(e)e(sure)j(the)g(blo)q(c)o(k)e(w)o(asn't)h(the)g
(unde\014ned)h(blo)q(c)o(k.)-15 718 y Fp(383a)88 b Fo(h)p
Fn(other)15 b(\014elds)g(of)g(a)g(r)n(elo)n(c)n(atable)f(blo)n(ck)h
Fp(383a)p Fo(i)o(\021)478 b Fp(\(382a\))21 b(390d)5 b
Fm(.)187 768 y Fr(struct)20 b({)i(unsigned)e(address:1,)g(reg:1;)g(})i
(known;)187 818 y(unsigned)e(address;)151 b(/*)21 b(absolute)f(address)
h(of)g(block)g(in)g(memory)g(*/)187 868 y(unsigned)f(reg;)239
b(/*)21 b(number)g(of)g(register)f(pointing)g(into)h(this)g(block)g(*/)
187 918 y(unsigned)f(reglc;)195 b(/*)21 b(when)g(reg)g(non-null,)f
(location)g(to)i(which)f(it)g(points)f(*/)187 967 y(struct)g(label)h
(*label;)86 b(/*)21 b(\(anonymous\))f(label)g(associated)g(with)h(this)
g(block)g(*/)145 1019 y Fp(De\014nes:)187 1059 y Fl(address)p
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(47a,)i(51b,)f(81,)h(190,)g(192,)f
(193d,)g(302,)h(303,)f(383b,)g(399,)h(and)f(403c.)187
1098 y Fl(label)p Fp(,)g(used)i(in)f(c)o(h)o(unks)g(41a,)g(73b,)g(79a,)
g(162a,)g(172a,)g(180,)g(295b,)g(322,)g(374,)h(383b,)e(399a,)h(403b,)
228 1138 y(407,)g(408,)f(and)h(412b.)187 1177 y Fl(reg)p
Fp(,)f(used)h(in)g(c)o(h)o(unks)f(383b)g(and)h(398a.)187
1217 y Fl(reglc)p Fp(,)f(used)g(in)h(c)o(h)o(unk)f(398a.)145
1256 y(Uses)i Fl(location)p Fp(.)-17 1339 y(383b)88 b
Fo(h)p Fn(initialize)14 b(a)h(new)g(r)n(elo)n(c)n(atable)f(blo)n(ck)h
Fr(rb)f Fp(382b)p Fo(i)o Fv(+)p Fo(\021)275 b Fp(\(398d\))22
b Fm(/)5 b Fp(382b)22 b(390e)5 b Fm(.)187 1389 y Fr(rb->known.addres)o
(s)19 b(=)j(rb->known.reg)d(=)i(0;)187 1439 y(rb->label)f(=)h
(label_new\("unnamed")o(\);)187 1488 y(rb->label->block)d(=)k(rb;)187
1538 y(rb->label->offse)o(t)d(=)j(0;)145 1590 y Fp(Uses)12
b Fl(address)d Fp(383a,)h Fl(label)g Fp(383a,)g Fl(label_new)f
Fp(404b,)h(and)h Fl(reg)f Fp(383a.)p eop
%%Page: 384 384
384 383 bop 129 141 a Fv(384)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)129 258 y Ft(23.1.1)56 b(Optimizing)16
b(sequen)n(tial)h(emission)129 334 y Fv(Giv)o(en)e(the)i(represen)o
(tation)g(ab)q(o)o(v)o(e,)e(emitting)f(an)h(instruction)h(b)q(ecomes)g
(an)f(elab)q(orate)129 384 y(business.)k(W)m(e)10 b(ha)o(v)o(e)h(to)f
(fetc)o(h)i(the)f(p)q(oin)o(ter)g Fr(rb->p)p Fv(,)f(add)h(a)f(size,)i
(and)e(compare)g(the)i(result)129 434 y(against)f Fr(rb->curbuf->limit)
d Fv(b)q(efore)k(w)o(e)g(can)g(store)g(the)g(b)o(ytes)g(and)f(incremen)
o(t)h Fr(p)p Fv(,)f(and)129 484 y(afterw)o(ard)16 b(w)o(e)f(ha)o(v)o(e)
h(to)f(compute)g(the)h(lo)q(cation)e(coun)o(ter)i(and)f(see)i(if)e
Fr(rb->size)e Fv(needs)129 534 y(to)k(b)q(e)h(up)q(dated.)27
b(This)17 b(is)g(all)f(far)g(to)q(o)h(exp)q(ensiv)o(e,)h(but)f(w)o(e)g
(can)h(mak)o(e)d(it)i(c)o(heap)q(er)h(for)129 583 y(the)c(common)c
(case)k(of)f(sequen)o(tial)g(emission)f(to)h(the)g(curren)o(t)i(relo)q
(catable)e(blo)q(c)o(k)g Fr(currb)p Fv(.)129 633 y(In)j(this)f(sp)q
(ecial)h(case,)g(w)o(e)f(store)i Fr(p)e Fv(and)g Fr(limit)f
Fv(p)q(oin)o(ters)i(in)f(global)f(v)n(ariables,)g(and)h(w)o(e)129
683 y(don't)g(b)q(other)h(to)f(up)q(date)h Fr(rb->size)p
Fv(.)k Fr(rb->p)14 b Fv(and)h Fr(rb->size)f Fv(are)h
Fn(dirty)g Fv(in)g(that)g(they)129 733 y(don't)f(re\015ect)h(the)g
(truth;)f(the)h(truth)f(is)g(in)f(global)f(v)n(ariables.)1117
718 y Ff(2)-31 795 y Fp(384a)88 b Fo(h)p Fn(exp)n(orte)n(d)16
b(data)f(de)n(clar)n(ations)f Fp(381)p Fo(i)p Fv(+)p
Fo(\021)461 b Fp(\(409b\))22 b Fm(/)5 b Fp(382a)23 b(399d)t
Fm(.)171 845 y Fr(#define)d(crb\(\))h(currb)171 895 y(extern)g(RBlock)f
(currb;)304 b(/*)21 b(the)g(current)g(relocatable)e(block)i(*/)171
944 y(extern)g(unsigned)f(char)h(*currb_p;)85 b(/*)21
b(the)g(true)g(version)g(of)g(currb->p)f(*/)171 994 y(extern)h
(unsigned)f(char)h(*currb_safe;)476 1044 y(/*)g(the)h(true)f(version)f
(of)h(currb->curbuf->limi)o(t)e(-)j(MARGIN)e(*/)129 1096
y Fp(De\014nes:)171 1135 y Fl(crb)p Fp(,)10 b(used)h(in)g(c)o(h)o(unk)f
(408a.)129 1175 y(Uses)j Fl(currb)e Fp(385e,)g Fl(currb_p)f
Fp(385e,)h Fl(currb_saf)o(e)f Fp(385e,)h Fl(MARGIN)f
Fp(384b,)h Fl(RBlock)p Fp(,)f Fl(relocatable)f Fp(47a,)171
1214 y(and)i Fl(version)e Fp(18a.)129 1277 y Fv(These)16
b(v)n(ariables)d(m)o(ust)g(satisfy)g(the)i(t)o(w)o(o)e(in)o(v)n(arian)o
(ts:)297 1368 y Fr(lc)41 b Fv(=)h Fr(currb)p 568 1368
13 2 v 14 w(p)9 b Fo(\000)g Fr(currb->curbuf->data)d
Fv(+)j Fr(currb->curbuf->dat)o(alc)129 1430 y(currb)p
241 1430 V 14 w(safe)41 b Fv(=)h Fr(currb->curbuf->li)o(mit)6
b Fo(\000)j Fr(MARGIN)129 1584 y Fv(They)15 b(m)o(ust)e(b)q(e)h(up)q
(dated)h(whenev)o(er)g Fr(currb)e Fv(or)h Fr(currb->curbuf)d
Fv(c)o(hanges.)192 1634 y(Using)h(a)g(di\013erence)i(of)e
Fr(MARGIN)f Fv(is)h(a)g(tric)o(k)g(that,)g(in)g(most)f(cases,)j(means)d
(w)o(e)i(needn't)129 1683 y(add)g(an)o(ything)f(to)g
Fr(p)g Fv(b)q(efore)i(comparing)d(it.)17 b Fr(MARGIN)11
b Fv(m)o(ust)h(b)q(e)h(big)f(enough)h(to)f(hold)g(an)o(y)129
1733 y(in)o(tegral)f(v)n(alue,)g(and)g(it)h(m)o(ust)e(matc)o(h)g(the)i
(largest)g Fr(n)f Fv(accepted)j(in)d(the)h Fr(emitl)e
Fv(and)i Fr(emitb)129 1783 y Fv(pro)q(cedures)17 b(de\014ned)e(b)q(elo)
o(w.)-33 1845 y Fp(384b)88 b Fo(h)p Fn(exp)n(orte)n(d)16
b(macr)n(o)e(de\014nitions)i Fp(384b)p Fo(i)o(\021)584
b Fp(\(409b\))22 b(391b)t Fm(.)171 1895 y Fr(#define)e(MARGIN)h(8)129
1947 y Fp(De\014nes:)171 1986 y Fl(MARGIN)p Fp(,)9 b(used)i(in)g(c)o(h)
o(unks)f(384,)g(385,)h(388c,)f(and)h(396c.)129 2049 y
Fv(W)m(e'v)o(e)i(made)f Fr(MARGIN)g Fv(8)h(instead)h(of)e(4)h(so)h(w)o
(e)f(w)o(on't)g(ha)o(v)o(e)g(to)g(mak)o(e)f(c)o(hanges)i(for)e(64-bit)
129 2098 y(mac)o(hines.)p 129 2461 573 2 v 176 2487 a
Fc(2)193 2499 y Fp(W)m(e)g(ha)o(v)o(e)e(to)h(exp)q(ort)f(these)g(v)n
(ariables)g(b)q(ecause)f(they're)h(used)g(in)h(exp)q(orted)f(macros.)p
eop
%%Page: 385 385
385 384 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(385)208 258 y(When)16 b(w)o(e)h(w)o(an)o(t)e(the)
i(v)n(alues)f(in)g Fr(currb)f Fv(to)h(tell)g(the)h(truth,)g(suc)o(h)g
(as)g(when)f(w)o(e)h(are)145 307 y(ab)q(out)d(to)g(c)o(hange)g(blo)q(c)
o(ks,)f(w)o(e)i Fr(make_clean)p Fv(.)-15 369 y Fp(385a)88
b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p Fo(i)o(\021)894
b Fp(\(410\))22 b(385b)5 b Fm(.)187 419 y Fr(void)21
b(make_clean\(\))e({)230 469 y(if)j(\(currb\))e({)274
519 y(unsigned)g(curlc)h(=)g(lc\(\);)274 569 y(currb->p)f(=)i(currb_p;)
274 618 y(if)f(\(currb->size)f(<)h(curlc\))g(currb->size)e(=)j(curlc;)
230 668 y(})187 718 y(})145 770 y Fp(De\014nes:)187 809
y Fl(make_clean)o Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(385b,)h(386a,)h
(397a,)f(and)g(400a.)145 848 y(Uses)i Fl(currb)e Fp(385e,)g
Fl(currb_p)f Fp(385e,)i(and)f Fl(lc)h Fp(396b.)208 910
y Fv(The)g(other)h(op)q(eration)e(that)h(has)g(to)g(mak)o(e)f(sure)i
(the)f(global)f(v)n(ariables)g(are)h(consisten)o(t)145
960 y(is)j(c)o(hanging)f(the)i(curren)o(t)g(blo)q(c)o(k.)-17
1022 y Fp(385b)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)749 b Fp(\(410\))22 b Fm(/)5 b
Fp(385a)22 b(385e)5 b Fm(.)187 1072 y Fr(void)21 b(set_block\(rb\))e
(RBlock)h(rb;)i({)230 1122 y(make_clean\(\);)230 1171
y(currb)f(=)h(rb;)230 1221 y(currb_p)f(=)g(currb->p;)230
1271 y(currb_safe)f(=)i(currb->curbuf->l)o(imit)c(-)k(MARGIN;)187
1321 y(})145 1372 y Fp(De\014nes:)187 1412 y Fl(set_block)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(322.)145 1451 y(Uses)g
Fl(currb)f Fp(385e,)f Fl(currb_p)g Fp(385e,)g Fl(currb_safe)f
Fp(385e,)h Fl(make_clean)f Fp(385a,)h Fl(MARGIN)g Fp(384b,)h(and)g
Fl(RBlock)p Fp(.)145 1513 y Fv(This)18 b(tric)o(ky)g(subtraction)h(of)e
Fr(MARGIN)p Fv(,)g(whic)o(h)g(will)g(sa)o(v)o(e)h(us)h(a)e(comparison)g
(later)h(on,)145 1563 y(mak)o(es)11 b(initializing)f(a)i
Fr(firstbuf)e Fv(a)i(n)o(uisance|w)o(e)h(can't)f(set)h
Fr(data)e Fv(and)h Fr(limit)f Fv(to)h(zero,)145 1613
y(b)q(ecause)22 b(then)e(the)g(subtraction)g(w)o(ould)f(mak)o(e)f(the)j
(p)q(oin)o(ter)e(wrap)h(around,)h(and)e(w)o(e)145 1663
y(w)o(ould)d(try)h(to)g(\014ll)f(our)h(whole)g(address)h(space)g(with)e
(garbage.)27 b(Instead)18 b(w)o(e)f(go)f(mega-)145 1712
y(compulsiv)o(e,)c(making)g(sure)j(it's)e(OK)h(b)o(y)g(ANSI)g(to)g
(subtract)h(MAR)o(GIN:)-13 1774 y Fp(385c)88 b Fo(h)p
Fn(lo)n(c)n(al)15 b(de)n(clar)n(ations)f Fp(385c)p Fo(i)o(\021)779
b Fp(\(410\))22 b(389a)5 b Fm(.)187 1824 y Fr(static)20
b(unsigned)g(char)h(bogus_buffer[MARGIN])o(;)145 1876
y Fp(Uses)12 b Fl(MARGIN)e Fp(384b.)-17 1957 y(385d)88
b Fo(h)p Fn(set)15 b Fr(data)f Fn(and)i Fr(limit)e Fn(in)h(a)g(new)f
Fr(rb->firstbuf)f Fp(385d)p Fo(i)o(\021)375 b Fp(\(382b\))187
2007 y Fr(rb->firstbuf.dat)o(a)19 b(=)j(rb->firstbuf.lim)o(it)d(=)i
(bogus_buffer)f(+)h(MARGIN;)145 2059 y Fp(Uses)12 b Fl(MARGIN)e
Fp(384b.)208 2128 y Fv(The)k(rest)h(of)e(this)h(section)h(is)f(b)q
(oilerplate.)-13 2190 y Fp(385e)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)743 b Fp(\(410\))22
b Fm(/)5 b Fp(385b)22 b(386b)5 b Fm(.)187 2240 y Fr(RBlock)20
b(currb)h(=)h(\(RBlock\))e(0;)187 2290 y(unsigned)g(char)h(*currb_p,)f
(*currb_safe;)145 2342 y Fp(De\014nes:)187 2381 y Fl(currb)p
Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(384{88,)g(391a,)g(396,)g(397,)h
(400a,)f(403c,)g(and)h(404a.)187 2420 y Fl(currb_p)p
Fp(,)e(used)h(in)i(c)o(h)o(unks)d(384{88)h(and)h(391{97.)187
2460 y Fl(currb_safe)o Fp(,)e(used)h(in)i(c)o(h)o(unks)d(384{88,)h
(392{94,)f(and)i(396c.)145 2499 y(Uses)h Fl(RBlock)p
Fp(.)p eop
%%Page: 386 386
386 385 bop 129 141 a Fv(386)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(386a)88 b Fo(h)p Fn(exp)n(orte)n(d)16
b(pr)n(o)n(c)n(e)n(dur)n(e)e(de)n(clar)n(ations)h Fp(386a)p
Fo(i)n(\021)504 b Fp(\(409b\))22 b(407d)t Fm(.)171 307
y Fr(void)f(make_clean\(void\);)129 359 y Fp(Uses)12
b Fl(make_clean)c Fp(385a.)129 496 y Ft(23.1.2)56 b(Emitting)16
b(data)j(in)n(to)f(relo)r(catable)f(blo)r(c)n(ks)129
573 y Fv(Ha)o(ving)i(sho)o(wn)i(y)o(ou)e(our)h(dirt,)i(it)d(seems)i
(only)e(fair)g(to)h(div)o(e)g(righ)o(t)g(in)o(to)f(the)i
Fn(r)n(aison)129 623 y(d')o(^)-20 b(etr)n(e)16 b Fv(for)h(that)f
(dirt|the)h(emission)e(optimization.)23 b(W)m(e)17 b(ha)o(v)o(e)f
(emission)f(pro)q(cedures)129 673 y(that)f(w)o(ork)g(under)g(an)o(y)g
(circumstances,)g(plus)g(some)f(emission)f(macros)h(that)h(w)o(ork)f
(only)129 722 y(when)18 b(the)f(alignmen)o(ts)e(are)j(just)f(righ)o(t.)
26 b(W)m(e)17 b(use)h(di\013eren)o(t)f(strategies)h(for)f(the)g(t)o(w)o
(o|)129 772 y(the)d(pro)q(cedures)i(use)e(a)f(particular)g(b)o(yte)h
(order,)f(while)g(the)h(macros)e(giv)o(e)h(y)o(ou)g(whatev)o(er)129
822 y(b)o(yte)g(order)h(y)o(ou)e(happ)q(en)h(to)f(ha)o(v)o(e)h(on)f(y)o
(our)h(mac)o(hine.)j(W)m(e)c(b)q(egin)h(with)f(the)h(pro)q(cedures)129
872 y(b)q(ecause)j(they're)f(sligh)o(tly)d(saner.)129
980 y Fs(Emission)i(pro)q(cedures)g(for)h(kno)o(wn)g(endianness)129
1056 y Fv(W)m(e)c(ha)o(v)o(e)f(an)h(emission)e(pro)q(cedure)j(for)f
(eac)o(h)g(endianness.)18 b(The)11 b(little-endian)f(pro)q(cedure)129
1106 y(is)i(the)g(sanest)g(b)q(ecause)h(the)f(p)q(ositions)f(of)g(the)h
(b)o(ytes)g(don't)f(dep)q(end)i(on)e(ho)o(w)g(man)o(y)e(there)129
1156 y(are.)28 b(This)17 b(fact)g(lets)g(us)g(pla)o(y)f(a)o(wful)g
(games)g(with)g(a)h(switc)o(h)g(statemen)o(t)g(and)g(macros.)129
1206 y(W)m(e)12 b(n)o(um)o(b)q(er)f(b)o(ytes,)h(with)g(b)o(yte)g(0)f(b)
q(eing)h(the)h(least)f(signi\014can)o(t,)f(and)g(w)o(e)h(de\014ne)h(a)f
(macro)129 1256 y Fr(BYTE\(N\))f Fv(that)h(emits)f(b)o(yte)h
Fr(N)g Fv(and)g(then)h(falls)e(through)h(to)g(emit)e(b)o(ytes)j
Fr(N)5 b Fo(\000)g Fv(1)13 b(do)o(wn)e(to)h(0.)-33 1318
y Fp(386b)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)749 b Fp(\(410\))22 b Fm(/)5 b
Fp(385e)22 b(387a)5 b Fm(.)171 1368 y Fr(void)21 b(emitl\(val,)f(n\))h
(unsigned)f(long)h(val;)g(unsigned)f(n;)i({)215 1417
y(if)f(\(currb_p)f(<=)h(currb_safe)f(||)i(currb_p)e(+)h(n)h(<=)f
(currb->curbuf->limit)o(\))e({)258 1467 y(register)h(unsigned)g(char)h
(*p)h(=)f(currb_p;)258 1517 y Fo(h)p Fn(emit)15 b Fr(n)f
Fn(bytes)h(of)g Fr(val)f Fn(at)h Fr(p)g Fn(\(little-endian\))f
Fp(386c)p Fo(i)258 1567 y Fr(currb_p)20 b(=)i(p)g(+)f(n;)215
1617 y(})g(else)g({)258 1667 y Fo(h)p Fn(slow)15 b(p)n(ath)g(for)f
(little-endian)g(emission)h Fp(388a)p Fo(i)215 1716 y
Fr(})171 1766 y(})129 1818 y Fp(De\014nes:)171 1857 y
Fl(emitl)p Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(388a)h(and)f(392a.)129
1897 y(Uses)i Fl(currb)e Fp(385e,)g Fl(currb_p)g Fp(385e,)g(and)g
Fl(currb_safe)f Fp(385e.)-29 1980 y(386c)88 b Fo(h)p
Fn(emit)15 b Fr(n)g Fn(bytes)g(of)f Fr(val)h Fn(at)f
Fr(p)h Fn(\(little-endian\))f Fp(386c)p Fo(i)o(\021)403
b Fp(\(386b)10 b(389c\))171 2030 y Fr(switch)21 b(\(n\))g({)215
2080 y(#define)f(BYTE\(N\))g(case)h(N+1:)g(p[N])g(=)h(val)f(>>)g(8*N;)g
(/*)h(fall)f(through)f(*/)215 2129 y(BYTE\(7\))g(BYTE\(6\))g(BYTE\(5\))
h(BYTE\(4\))f(BYTE\(3\))g(BYTE\(2\))h(BYTE\(1\))f(BYTE\(0\))215
2179 y(#undef)g(BYTE)215 2229 y(case)h(0:)g(/*)g(do)h(nothing)e(*/)258
2279 y(break;)215 2329 y(default:)g(assert\(\("unsigne)o(d)f(long)i
(bigger)f(than)h(8)h(bytes",)e(0\)\);)171 2378 y(})p
eop
%%Page: 387 387
387 386 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(387)208 258 y(Big-endian)16 b(mac)o(hines)h(suc)o
(k.)29 b(If)18 b(w)o(e)f(w)o(ere)i(willing)c(to)i(pa)o(y)g(the)h
(run-time)f(cost)h(of)145 307 y(computing)13 b Fr(n-N-1)p
Fv(,)h(whic)o(h)g(is)h(the)g(p)q(osition)f(of)g(b)o(yte)h
Fr(N)f Fv(on)h(a)f(big-endian)g(mac)o(hine,)f(w)o(e)145
357 y(could)18 b(use)h(the)g(exact)g(co)q(de)g(w)o(e'v)o(e)f(just)g
(sho)o(wn)g(y)o(ou,)h(with)e(just)i(a)f(sligh)o(tly)e(di\013eren)o(t)
145 407 y(de\014nition)i(of)f Fr(BYTE)p Fv(.)g(Unfortunately)m(,)g(w)o
(e're)i(trying)e(to)h(squeeze)i(ev)o(ery)e(cycle)h(w)o(e)f(can)145
457 y(out)f(of)f(these)i(pro)q(cedures,)h(so)e(w)o(e)g(insist)f(on)h
(doing)e(the)j(arithmetic)d(at)i(compile)e(time)145 507
y(\(once)d(for)e(eac)o(h)h(p)q(ossible)f(v)n(alue)g(of)g
Fr(n)p Fv(\).)17 b(W)m(e)10 b(use)h(a)g(macro)e Fr(S\(POS,)20
b(N\))10 b Fv(that)h(stores)h(b)o(yte)f Fr(N)145 557
y Fv(in)j(p)q(osition)f Fr(POS)p Fv(.)g(This)g(mak)o(es)g
Fr(emitb)g Fv(ugly)m(.)-15 619 y Fp(387a)88 b Fo(h)p
Fn(de\014nitions)16 b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)743
b Fp(\(410\))22 b Fm(/)5 b Fp(386b)22 b(389b)5 b Fm(.)187
669 y Fr(void)21 b(emitb\(val,)e(n\))j(unsigned)e(long)h(val;)g
(unsigned)f(n;)h({)230 718 y(if)h(\(currb_p)e(<=)h(currb_safe)f(||)h
(currb_p)g(+)g(n)h(<=)f(currb->curbuf->limi)o(t\))e({)274
768 y(register)h(unsigned)g(char)h(*p)h(=)f(currb_p;)274
818 y Fo(h)p Fn(emit)15 b Fr(n)f Fn(bytes)h(of)g Fr(val)f
Fn(at)h Fr(p)g Fn(\(big-endian\))g Fp(387b)p Fo(i)274
868 y Fr(currb_p)20 b(=)i(p)f(+)h(n;)230 918 y(})g(else)f({)274
967 y Fo(h)p Fn(slow)14 b(p)n(ath)i(for)e(big-endian)h(emission)g
Fp(388b)p Fo(i)230 1017 y Fr(})187 1067 y(})145 1119
y Fp(De\014nes:)187 1158 y Fl(emitb)p Fp(,)10 b(used)g(in)h(c)o(h)o
(unks)f(388b)g(and)h(392a.)145 1198 y(Uses)h Fl(currb)e
Fp(385e,)g Fl(currb_p)f Fp(385e,)i(and)f Fl(currb_safe)e
Fp(385e.)-17 1281 y(387b)88 b Fo(h)p Fn(emit)15 b Fr(n)f
Fn(bytes)h(of)g Fr(val)f Fn(at)h Fr(p)g Fn(\(big-endian\))g
Fp(387b)p Fo(i)o(\021)429 b Fp(\(387a)10 b(390a\))187
1331 y Fr(switch)20 b(\(n\))i({)230 1381 y(#define)f(S\(POS,)f(N\))i
(\(p[POS])e(=)i(val)f(>>)g(8*N\))230 1430 y(case)g(0:)h(break;)230
1480 y(case)f(1:)h(S\(0,0\);)e(break;)230 1530 y(case)h(2:)h(S\(0,1\);)
e(S\(1,0\);)g(break;)230 1580 y(case)h(3:)h(S\(0,2\);)e(S\(1,1\);)g
(S\(2,0\);)h(break;)230 1630 y(case)g(4:)h(S\(0,3\);)e(S\(1,2\);)g
(S\(2,1\);)h(S\(3,0\);)f(break;)230 1679 y(case)h(5:)h(S\(0,4\);)e
(S\(1,3\);)g(S\(2,2\);)h(S\(3,1\);)f(S\(4,0\);)g(break;)230
1729 y(case)h(6:)h(S\(0,5\);)e(S\(1,4\);)g(S\(2,3\);)h(S\(3,2\);)f
(S\(4,1\);)g(S\(5,0\);)h(break;)230 1779 y(case)g(7:)h(S\(0,6\);)e
(S\(1,5\);)g(S\(2,4\);)h(S\(3,3\);)f(S\(4,2\);)g(S\(5,1\);)h(S\(6,0\);)
f(break;)230 1829 y(case)h(8:)h(S\(0,7\);)e(S\(1,6\);)g(S\(2,5\);)h
(S\(3,4\);)f(S\(4,3\);)g(S\(5,2\);)h(S\(6,1\);)f(S\(7,0\);)g(break;)230
1879 y(default:)h(assert\(\("unsign)o(ed)e(long)i(bigger)f(than)h(8)h
(bytes",)e(0\)\);)187 1928 y(})p eop
%%Page: 388 388
388 387 bop 129 141 a Fv(388)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(OK,)e(what)g(ab)q(out)g(the)g(slo)o(w)g
(paths?)17 b(W)m(e)11 b(split)f(the)i(v)n(alue)e(in)o(to)h(t)o(w)o(o)f
(pieces:)18 b(one)11 b(that)129 307 y(will)j(\014t)h(in)f(the)h(curren)
o(t)h(bu\013er,)g(and)e(one)h(that)g(will)e(ha)o(v)o(e)i(to)f(go)g(in)o
(to)g(the)i(next)f(bu\013er.)129 357 y(Sometimes)c(the)h(next)h
(bu\013er)g(has)g(to)f(b)q(e)h(allo)q(cated.)k(When)12
b(computing)f Fr(roomhere)p Fv(,)f(the)129 407 y(size)16
b(of)e(the)h(co)q(de)h(that)e(will)f(\014t)i(in)f(the)i(curren)o(t)g
(bu\013er,)f(w)o(e)g(ha)o(v)o(e)g(to)f(b)q(e)h(careful)g(not)g(to)129
457 y(subtract)i(p)q(oin)o(ters)g(where)g(it)e(do)q(esn't)h(mak)o(e)f
(sense.)25 b(In)16 b(fact,)g(w)o(e're)g(pla)o(ying)e(fast)i(and)129
507 y(lo)q(ose)e(with)g(the)g(ANSI)h(rules)f(for)g(p)q(oin)o(ter)g
(comparison)e(and)i(arithmetic.)-31 569 y Fp(388a)88
b Fo(h)p Fn(slow)15 b(p)n(ath)g(for)f(little-endian)h(emission)f
Fp(388a)p Fo(i)o(\021)547 b Fp(\(386b\))171 619 y Fo(h)p
Fn(make)15 b(sur)n(e)g Fr(currb->curbuf->ne)o(xt)d Fn(is)i(non-nul)r
(l,)i(al)r(lo)n(c)n(ating)e(if)h(ne)n(c)n(essary)g Fp(391a)p
Fo(i)171 669 y Fr({)22 b(unsigned)e(roomhere)g(=)345
718 y(currb_p)h(<)g(currb->curbuf->limi)o(t)e(?)i(currb->curbuf->limit)
d(-)k(currb_p)e(:)i(0;)215 768 y(if)f(\(roomhere)f(>)h(0\))h
(emitl\(val,)e(roomhere\);)215 818 y Fo(h)p Fn(move)15
b Fr(currb->curbuf)d Fn(to)j(the)g(next)g(bu\013er,)g(up)n(dating)h
(glob)n(als)e Fp(388c)p Fo(i)215 868 y Fr(emitl\(val)19
b(>>)j(8*roomhere,)d(n)j(-)g(roomhere\);)171 918 y(})129
970 y Fp(Uses)12 b Fl(currb)e Fp(385e,)g Fl(currb_p)g
Fp(385e,)g(and)g Fl(emitl)g Fp(386b.)129 1032 y Fv(W)m(e)20
b(ma)o(y)e(follo)o(w)g(this)i(path)f(to)h(great)g(depth)h(if)e(w)o(e)h
(are)g(w)o(alking)e(along)h(a)h(c)o(hain)f(of)129 1082
y(bu\013ers,)261 1067 y Ff(3)295 1082 y Fv(so)14 b(it)f(ma)o(y)f(one)i
(da)o(y)g(b)q(e)g(w)o(orth)g(it)g(to)f(eliminate)f(the)j(tail)e
(recursion.)192 1131 y(The)g(only)f(di\013erence)j(for)d(big-endians)h
(is)f(that)h(is)g(is)g(the)g(high)f(bits)h(whic)o(h)g(go)g(in)f(the)129
1181 y(curren)o(t)k(bu\013er.)-33 1244 y Fp(388b)88 b
Fo(h)p Fn(slow)15 b(p)n(ath)g(for)f(big-endian)i(emission)f
Fp(388b)p Fo(i)n(\021)577 b Fp(\(387a\))171 1293 y Fo(h)p
Fn(make)15 b(sur)n(e)g Fr(currb->curbuf->ne)o(xt)d Fn(is)i(non-nul)r
(l,)i(al)r(lo)n(c)n(ating)e(if)h(ne)n(c)n(essary)g Fp(391a)p
Fo(i)171 1343 y Fr({)22 b(unsigned)e(roomhere)g(=)345
1393 y(currb_p)h(<)g(currb->curbuf->limi)o(t)e(?)i
(currb->curbuf->limit)d(-)k(currb_p)e(:)i(0;)215 1443
y(if)f(\(roomhere)f(>)h(0\))h(emitb\(val)e(>>)h(8*\(n-roomhere\),)e
(roomhere\);)215 1493 y Fo(h)p Fn(move)c Fr(currb->curbuf)d
Fn(to)j(the)g(next)g(bu\013er,)g(up)n(dating)h(glob)n(als)e
Fp(388c)p Fo(i)215 1542 y Fr(emitb\(val,)19 b(n)j(-)f(roomhere\);)171
1592 y(})129 1644 y Fp(Uses)12 b Fl(currb)e Fp(385e,)g
Fl(currb_p)g Fp(385e,)g(and)g Fl(emitb)g Fp(387a.)192
1706 y Fv(When)i(c)o(hanging)f Fr(curbuf)p Fv(,)g(w)o(e)h(m)o(ust)f
(main)o(tain)f(the)i(lo)q(cation-coun)o(ter)g(in)o(v)n(arian)o(t)f(on)
129 1756 y(page)j(384.)-29 1818 y Fp(388c)88 b Fo(h)p
Fn(move)16 b Fr(currb->curbuf)c Fn(to)j(the)g(next)g(bu\013er,)g(up)n
(dating)h(glob)n(als)e Fp(388c)p Fo(i)o(\021)173 b Fp(\(388\))171
1868 y Fr({)22 b(unsigned)e(templc)g(=)i(lc\(\);)215
1918 y(currb->curbuf)d(=)i(currb->curbuf->next)o(;)215
1968 y(currb_safe)e(=)j(currb->curbuf->li)o(mit)d(-)i(MARGIN;)215
2018 y(currb_p)f(=)h(templc)g(-)h(currb->curbuf->d)o(atal)o(c)d(+)j
(currb->curbuf->d)o(ata;)171 2068 y(})129 2119 y Fp(Uses)12
b Fl(currb)e Fp(385e,)g Fl(currb_p)g Fp(385e,)g Fl(currb_safe)e
Fp(385e,)i Fl(lc)h Fp(396b,)f Fl(MARGIN)g Fp(384b,)g(and)h
Fl(next)f Fp(399c.)p 129 2461 573 2 v 176 2487 a Fc(3)193
2499 y Fp(The)h(durn)g(co)q(de)f(ough)o(t)g(to)h(b)q(e)g(tested)f(to)i
(see)f(if)g(that)f(w)o(orks!)p eop
%%Page: 389 389
389 388 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(389)145 258 y(There's)14 b(no)e(need)h(to)f(mak)o
(e)f(the)i(blo)q(c)o(k)f Fn(cle)n(an)g Fv(just)h(b)q(ecause)h(w)o(e're)
e(c)o(hanging)g(the)h(bu\013er.)145 366 y Fs(Emission)h(pro)q(cedures)g
(for)h(closures)145 442 y Fv(Applications)f(ha)o(v)o(e)h(to)g(pro)o
(vide)f(emission)g(pro)q(cedures)j(for)d(closures,)i(but)f(most)f
(appli-)145 492 y(cation)k(writers)h(just)g(w)o(an)o(t)f(to)g(do)g(the)
h(standard)f(thing,)h(whic)o(h)f(is)g(to)g(emit)f(in)o(to)g(our)145
542 y(ordinary)d(relo)q(catable)g(blo)q(c)o(ks,)f(so)h(w)o(e)g(had)g(b)
q(etter)i(giv)o(e)d(them)g(pro)q(cedures)j(that)e(do)g(so.)208
592 y(The)d(ma)r(jor)e(di\013erence)k(in)e(implem)o(en)o(tation)d(is)j
(that)g(w)o(e're)g(not)g(using)g(the)g(\\curren)o(t")145
641 y(blo)q(c)o(k)16 b(or)g(lo)q(cation)g(coun)o(ter;)i(instead,)f(w)o
(e're)f(emitting)f(directly)h(in)o(to)g(a)g(kno)o(wn)g(blo)q(c)o(k)145
691 y(at)d(a)g(kno)o(wn)g(lo)q(cation.)k(Also,)c(since)h(w)o(e're)f
(guaran)o(teed)h(that)f(placeholder)h(tok)o(ens)g(ha)o(v)o(e)145
741 y(already)d(b)q(een)i(emitted)d(in)o(to)h(these)i(slots,)e(w)o(e)h
(don't)f(ha)o(v)o(e)g(to)g(w)o(orry)h(ab)q(out)f(main)o(taining)145
791 y(lo)o(w)e(or)h(high)g(w)o(ater)g(marks)f(or)h(ab)q(out)g(allo)q
(cating)e(bu\013ers.)18 b(The)11 b(co)q(de)g(that)f(actually)f(spits)
145 841 y(out)15 b(the)g(bits)f(\(but)h(not)f(the)h(slo)o(w)f(path\))h
(can)f(b)q(e)h(re-used)h(as)f(the)g(c)o(h)o(unk)f Fo(h)p
Fn(emit)h Fr(n)g Fn(bytes)145 890 y(of)g Fr(val)f Fn(at)h
Fr(p)p Fo(i)p Fv(.)-15 953 y Fp(389a)88 b Fo(h)p Fn(lo)n(c)n(al)15
b(de)n(clar)n(ations)f Fp(385c)p Fo(i)o Fv(+)p Fo(\021)634
b Fp(\(410\))22 b Fm(/)5 b Fp(385c)22 b(391c)5 b Fm(.)187
1003 y Fr(static)20 b(void)h(initial_cl_emitm\(RB)o(lock)d(rb,)k
(unsigned)e(lc,)h(unsigned)f(long)h(bits,)g(unsigned)f(size\);)145
1054 y Fp(Uses)12 b Fl(initial_cl)o(_em)o(itm)c Fp(389b)i(389b,)g
Fl(lc)h Fp(396b,)g(and)f Fl(RBlock)p Fp(.)-17 1137 y(389b)88
b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p Fo(i)o Fv(+)p
Fo(\021)749 b Fp(\(410\))22 b Fm(/)5 b Fp(387a)22 b(389c)5
b Fm(.)187 1187 y Fr(static)20 b(void)h(initial_cl_emitm\(rb)o(,)e(lc,)
i(bits,)g(size\))383 1237 y(RBlock)f(rb;)i(unsigned)e(lc;)h(unsigned)f
(long)h(bits;)g(unsigned)f(size;)187 1287 y({)230 1337
y(static)h(union)g({)g(unsigned)f(u;)i(unsigned)e(char)h
(c[sizeof\(unsigned)o(\)];)e(})i(u)h(=)f({)h(0xaabbccdd)e(};)230
1387 y(switch)h(\(u.c[0]\))f({)274 1436 y(case)h(0xaa:)g(cl_emitm)f(=)h
(&cl_emitb;)f(break;)274 1486 y(case)h(0xdd:)g(cl_emitm)f(=)h
(&cl_emitl;)f(break;)274 1536 y(default:)64 b(assert\(\("byte-or)o(der)
19 b(botch",)h(0\)\);)230 1586 y(})230 1636 y(\(*cl_emitm\)\(rb,)f(lc,)
i(bits,)g(size\);)187 1685 y(})187 1735 y(void)g(\(*cl_emitm\)\(RBlo)o
(ck)e(rb,)i(unsigned)f(lc,)h(unsigned)f(long,)h(unsigned\))f(=)i
(&initial_cl_emit)o(m;)145 1787 y Fp(De\014nes:)187 1827
y Fl(initial_cl)o(_em)o(it)o(m)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f
(389a.)145 1866 y(Uses)i Fl(cl_emitb)d Fp(390a,)h Fl(cl_emitl)f
Fp(389c,)h Fl(lc)h Fp(396b,)f(and)h Fl(RBlock)p Fp(.)-13
1957 y(389c)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)745 b Fp(\(410\))22 b Fm(/)5 b
Fp(389b)22 b(390a)5 b Fm(.)187 2007 y Fr(void)21 b(cl_emitl\(rb,)e(lc,)
i(val,)g(n\))h(RBlock)e(rb;)h(unsigned)f(lc;)i(unsigned)e(long)h(val;)g
(unsigned)f(n;)h({)230 2057 y(struct)g(rblock_buffer)e(*cb;)230
2107 y(register)i(unsigned)f(char)h(*p;)230 2157 y(for)h(\(cb)f(=)g
(&rb->firstbuf;)e(cb->next)h(&&)i(lc)f(>=)g(cb->next->datalc;)e(cb)i(=)
h(cb->next\);)230 2206 y(p)g(=)g(cb->data)e(+)h(\(lc)g(-)h
(cb->datalc\);)230 2256 y(if)g(\(p)f(+)h(n)f(<=)h(cb->limit\))d({)p
Fo(h)p Fn(emit)c Fr(n)f Fn(bytes)h(of)g Fr(val)f Fn(at)h
Fr(p)g Fn(\(little-endian\))f Fp(386c)p Fo(i)o Fr(})230
2306 y(else)21 b({)p Fo(h)p Fn(slow)15 b(p)n(ath)g(for)f(little-endian)
g(closur)n(e)h(emission)g Fp(390b)p Fo(i)n Fr(})187 2356
y(})145 2408 y Fp(De\014nes:)187 2447 y Fl(cl_emitl)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(389)h(and)f(390.)145
2487 y(Uses)i Fl(lc)f Fp(396b,)f Fl(next)g Fp(399c,)h(and)f
Fl(RBlock)p Fp(.)p eop
%%Page: 390 390
390 389 bop 129 141 a Fv(390)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(390a)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)749 b Fp(\(410\))22
b Fm(/)5 b Fp(389c)22 b(392a)5 b Fm(.)171 307 y Fr(void)21
b(cl_emitb\(rb,)e(lc,)i(val,)g(n\))h(RBlock)e(rb;)h(unsigned)g(lc;)g
(unsigned)f(long)h(val;)g(unsigned)f(n;)h({)215 357 y(struct)f
(rblock_buffer)f(*cb;)215 407 y(register)h(unsigned)g(char)h(*p;)215
457 y(for)g(\(cb)g(=)g(&rb->firstbuf;)e(cb->next)i(&&)g(lc)g(>=)h
(cb->next->datalc)o(;)d(cb)i(=)h(cb->next\);)215 507
y(p)f(=)h(cb->data)e(+)h(\(lc)h(-)f(cb->datalc\);)215
557 y(if)g(\(p)g(+)h(n)f(<=)h(cb->limit\))e({)p Fo(h)p
Fn(emit)14 b Fr(n)h Fn(bytes)g(of)f Fr(val)h Fn(at)f
Fr(p)h Fn(\(big-endian\))h Fp(387b)p Fo(i)n Fr(})215
606 y(else)21 b({)p Fo(h)p Fn(slow)14 b(p)n(ath)h(for)f(big-endian)i
(closur)n(e)e(emission)h Fp(390c)p Fo(i)o Fr(})171 656
y(})129 708 y Fp(De\014nes:)171 747 y Fl(cl_emitb)p Fp(,)9
b(used)h(in)h(c)o(h)o(unk)f(389b.)129 787 y(Uses)i Fl(lc)f
Fp(396b,)f Fl(next)h Fp(399c,)f(and)g Fl(RBlock)p Fp(.)-33
878 y(390b)88 b Fo(h)p Fn(slow)15 b(p)n(ath)g(for)f(little-endian)h
(closur)n(e)f(emission)h Fp(390b)p Fo(i)o(\021)409 b
Fp(\(389c\))171 928 y Fr({)22 b(unsigned)e(roomhere)g(=)h(cb->limit)f
(-)i(p;)215 978 y(assert\(roomhere)c(>)k(0)f(&&)h(roomhere)e(<)i(n\);)
215 1028 y(cl_emitl\(rb,)d(lc,)i(val,)g(roomhere\);)215
1077 y(cl_emitl\(rb,)e(lc+roomhere,)g(val)i(>>)h(8*roomhere,)d(n)j(-)f
(roomhere\);)171 1127 y(})129 1179 y Fp(Uses)12 b Fl(cl_emitl)d
Fp(389c)h(and)h Fl(lc)g Fp(396b.)-29 1271 y(390c)88 b
Fo(h)p Fn(slow)15 b(p)n(ath)g(for)f(big-endian)i(closur)n(e)e(emission)
h Fp(390c)p Fo(i)o(\021)441 b Fp(\(390a\))171 1320 y
Fr({)22 b(unsigned)e(roomhere)g(=)h(cb->limit)f(-)i(p;)215
1370 y(assert\(roomhere)c(>)k(0)f(&&)h(roomhere)e(<)i(n\);)215
1420 y(cl_emitl\(rb,)d(lc,)i(val)g(>>)h(8*roomhere,)d(roomhere\);)215
1470 y(cl_emitl\(rb,)g(lc+roomhere,)g(val,)i(n)h(-)f(roomhere\);)171
1520 y(})129 1571 y Fp(Uses)12 b Fl(cl_emitl)d Fp(389c)h(and)h
Fl(lc)g Fp(396b.)129 1700 y Fs(Allo)q(cating)j(new)i(bu\013ers)129
1777 y Fv(The)g(only)e(real)g(question)h(here)h(is)f(ho)o(w)f(big)g(a)h
(bu\013er)h(to)e(allo)q(cate.)20 b(W)m(e)15 b(ma)o(y)e(use)i(a)g(size)
129 1827 y(hin)o(t)g(from)e(the)i(application,)e(but)i(w)o(e)g(insist)f
(alw)o(a)o(ys)g(on)g(b)q(eing)h(able)f(to)h(get)g(to)f
Fr(lc)h Fv(plus)129 1876 y(32.)183 1861 y Ff(4)220 1876
y Fv(The)f(size)h(hin)o(t,)e(once)h(used)h(\(or)f(if)f(nev)o(er)i
(set\),)f(b)q(ecomes)g Fr(BUFSZ)p Fv(.)-33 1939 y Fp(390d)88
b Fo(h)p Fn(other)15 b(\014elds)g(of)g(a)g(r)n(elo)n(c)n(atable)f(blo)n
(ck)h Fp(383a)p Fo(i)o Fv(+)p Fo(\021)332 b Fp(\(382a\))22
b Fm(/)5 b Fp(383a)22 b(399c)5 b Fm(.)171 1988 y Fr(int)21
b(size_hint;)129 2040 y Fp(De\014nes:)171 2080 y Fl(size_hint)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(390e,)g(391a,)g(and)h(398d.)-29
2163 y(390e)88 b Fo(h)p Fn(initialize)14 b(a)h(new)g(r)n(elo)n(c)n
(atable)f(blo)n(ck)h Fr(rb)g Fp(382b)p Fo(i)n Fv(+)q
Fo(\021)390 b Fp(\(398d\))22 b Fm(/)5 b Fp(383b)171 2213
y Fr(rb->size_hint)19 b(=)j(BUFSZ;)129 2265 y Fp(Uses)12
b Fl(BUFSZ)e Fp(410)h(and)f Fl(size_hint)f Fp(390d.)p
129 2294 573 2 v 176 2321 a Fc(4)193 2333 y Fp(Wh)o(y)j(32?)17
b(I)c(ha)o(v)o(e)e(no)h(idea.)k(I'm)c(just)f(guessing.)16
b(It)c(only)g(matters)e(when)i(this)g(allo)q(cation)d(results)129
2372 y(from)i(a)g(big)g Fl(set_lc)p Fp(.)p eop
%%Page: 391 391
391 390 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(391)-15 258 y Fp(391a)88 b Fo(h)p
Fn(make)16 b(sur)n(e)e Fr(currb->curbuf->nex)o(t)e Fn(is)j(non-nul)r
(l,)g(al)r(lo)n(c)n(ating)g(if)f(ne)n(c)n(essary)h Fp(391a)p
Fo(i)o(\021)87 b Fp(\(388\))187 307 y Fr(if)21 b(\(!currb->curbuf->n)o
(ext\))d({)230 357 y(int)k(curbufsize)d(=)j(\(currb->curbuf->l)o(imit)c
(-)k(currb->curbuf->da)o(ta\);)230 407 y(int)g(minsize)e(=)h(32)h(+)f
(\(currb_p)g(-)g(currb->curbuf->dat)o(a\))e(-)i(curbufsize;)230
457 y(int)h(size)f(=)g(roundup\(max\(minsiz)o(e,)e(currb->size_hint)o
(\),)g(8\);)230 507 y(Buffer)i(b)h(=)f(\(Buffer\))f
(mc_alloc\(roundup\(si)o(zeof)o(\(*b\),)e(8\))k(+)f(size,)g
(RBlock_data_pool\))o(;)230 606 y(b->data)g(=)g(\(unsigned)f(char)h
(*\)\(b\))g(+)h(roundup\(sizeof\()o(*b\),)c(8\);)230
656 y(b->limit)j(=)g(b->data)f(+)i(size;)230 706 y(b->next)f(=)g
(\(Buffer\)0;)230 756 y(b->datalc)f(=)i(currb->curbuf->da)o(talc)c(+)k
(curbufsize;)230 806 y(currb->curbuf->next)c(=)k(b;)230
855 y(currb->size_hint)d(=)i(BUFSZ;)187 905 y(})145 957
y Fp(Uses)13 b Fl(Buffer)d Fp(381,)i Fl(BUFSZ)f Fp(410,)g
Fl(currb)g Fp(385e,)g Fl(currb_p)f Fp(385e,)h Fl(max)h
Fp(410,)f Fl(next)g Fp(399c,)h Fl(roundup)e Fp(410,)187
997 y(and)g Fl(size_hint)f Fp(390d.)145 1067 y Fv(Calculating)14
b Fr(curbufsize)g Fv(separately)i(is)f(con)o(v)o(en)o(tien)o(t,)h(and)g
(it)f(mak)o(es)f(sure)j(w)o(e)f(don't)145 1117 y(subtract)j
Fr(limit)e Fv(from)f Fr(p)i Fv(when)g Fr(p)g Fv(is)f(to)q(o)h(small.)28
b(F)m(or)17 b(e\016ciency)m(,)i(w)o(e)f(allo)q(cate)f(once,)145
1167 y(and)c(w)o(e)g(use)h(the)g(resulting)f(memory)d(to)j(hold)f(b)q
(oth)h(the)h(bu\013er)g(structure)h(and)e(its)g(data)145
1217 y(area.)26 b(Also,)16 b(w)o(e)g(round)h(ev)o(erything)g(in)e(sigh)
o(t)h(to)g(a)g(m)o(ultiple)e(of)i(8)g(just)h(to)f(k)o(eep)h(go)q(o)q(d)
145 1266 y(alignmen)o(t.)208 1316 y(The)h(lo)o(w)e(w)o(ater)i(mark)f
(is)g(\\automagically)o(")e(set)j(b)o(y)g(this)g(co)q(de;)i(if)c(w)o
(e're)j(allo)q(cat-)145 1366 y(ing)14 b(the)h(\014rst)g(bu\013er,)g
Fr(currb->firstbuf.da)o(talc)c Fv(b)q(ecomes)k(the)g(lo)o(w)e(w)o(ater)
i(mark)e(b)o(y)145 1416 y(virtue)h(of)g Fr(currb->firstbuf.)o(next)c
Fv(b)q(ecoming)j(non-n)o(ull.)145 1524 y Fs(Emission)h(using)g(the)h(b)
o(yte)f(order)h(of)g(the)g(mac)o(hine)145 1600 y Fv(T)m(o)10
b(emit)g(data)g(using)h(the)g(b)o(yte)g(order)h(of)e(the)i(mac)o(hine,)
d(clien)o(ts)i(should)g(call)f(through)h(the)145 1650
y(function)i(p)q(oin)o(ter)g Fr(emitm)p Fv(.)j(Clien)o(ts)d(m)o(ust)f
(exercise)i(care)g(when)f(cop)o(ying)f(or)h(passing)g(the)145
1700 y(v)n(alue)i(of)f Fr(emitm)p Fv(,)g(b)q(ecause)j
Fr(emitm)d Fv(w)o(orks)i(b)o(y)f(a)f(hac)o(k:)21 b(it's)15
b(initialized)f(to)h(a)f(pro)q(cedure)145 1750 y(that)i(dynamically)d
(determines)i(the)i(b)o(yte)f(order,)g(then)g(resets)i
Fr(emitm)c Fv(to)h(p)q(oin)o(t)h(either)145 1800 y(to)e
Fr(emitl)f Fv(or)h Fr(emitb)p Fv(.)j(I)c(b)q(eliev)o(e)i(in)e(a)o(v)o
(oiding)f Fr(#ifdef)p Fv(;)g(it's)i(to)q(o)f(easy)h(to)g(get)g(wrong.)
208 1849 y(This)f(section)i(also)e(de\014nes)i(some)e(shortcuts)j(for)d
(emitting)g(data)g(of)g(kno)o(wn)h(size.)-17 1912 y Fp(391b)88
b Fo(h)p Fn(exp)n(orte)n(d)15 b(macr)n(o)g(de\014nitions)h
Fp(384b)p Fo(i)n Fv(+)q Fo(\021)432 b Fp(\(409b\))22
b Fm(/)5 b Fp(384b)22 b(392b)5 b Fm(.)187 1961 y Fr(#define)20
b(emitul\(BITS\))f(emitm\(\(BITS\),)h(sizeof\(unsigned)e(long\)\))187
2011 y(#define)i(emitu\(BITS\))41 b(emitm\(\(BITS\),)20
b(sizeof\(unsigned)o(\)\))187 2061 y(#define)g(emitus\(BITS\))f
(emitm\(\(BITS\),)h(sizeof\(unsigned)e(short\)\))187
2111 y(#define)i(emituc\(BITS\))f(emitm\(\(BITS\),)h(sizeof\(unsigned)e
(char\)\))145 2163 y Fp(Uses)12 b Fl(emitm)e Fp(392a.)-13
2246 y(391c)88 b Fo(h)p Fn(lo)n(c)n(al)15 b(de)n(clar)n(ations)f
Fp(385c)p Fo(i)o Fv(+)p Fo(\021)632 b Fp(\(410\))22 b
Fm(/)5 b Fp(389a)22 b(398c)5 b Fm(.)187 2296 y Fr(static)20
b(void)h(initial_emitm\(unsig)o(ned)e(long)i(bits,)f(unsigned)g
(size\);)p eop
%%Page: 392 392
392 391 bop 129 141 a Fv(392)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(392a)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)749 b Fp(\(410\))22
b Fm(/)5 b Fp(390a)22 b(396c)5 b Fm(.)171 307 y Fr(static)21
b(void)f(initial_emitm\(bits,)e(size\))j(unsigned)f(long)h(bits;)g
(unsigned)f(size;)h({)215 357 y(static)f(union)h({)g(unsigned)g(u;)g
(unsigned)f(char)h(c[sizeof\(unsigned\))o(];)e(})i(u)h(=)f({)h
(0xaabbccdd)e(};)215 407 y(switch)g(\(u.c[0]\))g({)258
457 y(case)h(0xaa:)g(emitm)g(=)g(&emitb;)g(break;)258
507 y(case)g(0xdd:)g(emitm)g(=)g(&emitl;)g(break;)258
557 y(default:)64 b(assert\(\("byte-ord)o(er)19 b(botch",)h(0\)\);)215
606 y(})215 656 y(\(*emitm\)\(bits,)e(size\);)171 706
y(})171 756 y(void)j(\(*emitm\)\(unsigned)d(long,)j(unsigned\))f(=)h
(&initial_emitm;)129 808 y Fp(De\014nes:)171 847 y Fl(emitm)p
Fp(,)10 b(used)g(in)h(c)o(h)o(unks)f(19a)h(and)g(391{95.)129
887 y(Uses)h Fl(emitb)e Fp(387a)g(and)h Fl(emitl)f Fp(386b.)129
1015 y Fs(Macros)16 b(for)f(sup)q(er-fast)f(emission)129
1092 y Fr(emitfastul)p Fv(,)c Fr(emitfastu)p Fv(,)g Fr(emitfastus)p
Fv(,)g(and)i Fr(emitfastuc)e Fv(are)j(all)e(macros)g(for)h(emit-)129
1142 y(ting)g(unsigned)g(longs,)f(w)o(ords,)h(shorts,)g(and)g(c)o
(haracters,)h(resp)q(ectiv)o(ely)m(,)g(in)o(to)e(the)h(curren)o(t)129
1191 y(bu\013er.)39 b Fr(emitfast)18 b Fv(calls)i(one)h(of)f(these)h
(macros)f(or)g Fr(emitm)p Fv(,)g(as)h(appropriate.)37
b(The)129 1241 y(macros)14 b(themselv)o(es)g(call)g Fr(emitm)f
Fv(if)g(they)i(can't)f(guaran)o(tee)h(su\016cien)o(t)f(space.)20
b(Applica-)129 1291 y(tions)13 b(calling)e(these)k(macros)c
Fn(must)i Fv(guaran)o(tee)g(that)g(the)h(curren)o(t)g(lo)q(cation)e
(coun)o(ter)h(has)129 1341 y(the)i(prop)q(er)g(alignmen)o(t.)192
1391 y(The)i(macros)f(di\013er)i(only)e(in)g(the)i(t)o(yp)q(e)g(of)e
(the)i(datum)d(they)j(emit)d(quic)o(kly)m(,)h(so)h(w)o(e)129
1441 y(mak)o(e)c(that)h(a)f(parameter:)-33 1503 y Fp(392b)88
b Fo(h)p Fn(exp)n(orte)n(d)16 b(macr)n(o)e(de\014nitions)i
Fp(384b)p Fo(i)o Fv(+)p Fo(\021)434 b Fp(\(409b\))22
b Fm(/)5 b Fp(391b)22 b(393a)5 b Fm(.)171 1553 y Fr(#define)20
b(emitfastT0\(BITS,)f(TYPE\))i(do)g({)h(\\)215 1602 y(if)f(\(currb_p)f
(<)i(currb_safe\))d({)j(\\)280 1652 y(*\(\(TYPE*\)currb_p\))c(=)k
(\(TYPE\))e(\(BITS\);)h(\\)302 1702 y(currb_p)f(+=)h(sizeof\(TYPE\);)f
(\\)215 1752 y(})h(else)g(\(*emitm\)\(\(BITS\),)e(sizeof\(TYPE\)\);)f
(\\)171 1802 y(})k(while)e(\(0\))171 1851 y(#define)g
(emitfastul0\(BITS\))f(emitfastT0\(\(BIT)o(S\),)g(unsigned)h(long\))171
1901 y(#define)g(emitfastu0\(BITS\))41 b(emitfastT0\(\(BIT)o(S\),)19
b(unsigned\))171 1951 y(#define)h(emitfastus0\(BITS\))f
(emitfastT0\(\(BIT)o(S\),)g(unsigned)h(short\))171 2001
y(#define)g(emitfastuc0\(BITS\))f(emitfastT0\(\(BIT)o(S\),)g(unsigned)h
(char\))129 2053 y Fp(De\014nes:)171 2092 y Fl(emitfastu0)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(393a.)171 2132 y Fl(emitfastuc)o(0)p
Fp(,)f(used)h(in)h(c)o(h)o(unk)f(393.)171 2171 y Fl(emitfastul)o(0)p
Fp(,)f(used)h(in)h(c)o(h)o(unk)f(393a.)171 2211 y Fl(emitfastus)o(0)p
Fp(,)f(used)h(in)h(c)o(h)o(unk)f(393a.)129 2250 y(Uses)i
Fl(currb_p)d Fp(385e,)i Fl(currb_saf)o(e)e Fp(385e,)h(and)h
Fl(emitm)f Fp(392a.)146 2312 y Fv(W)m(e)15 b(ha)o(v)o(e)h(sev)o(eral)h
(v)o(ersions)g(of)e(these)j(macros;)e(the)h(trailing)e
Fr(0)g Fv(indicates)i(this)f(is)g(v)o(er-)129 2362 y(sion)e(0.)p
eop
%%Page: 393 393
393 392 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(393)208 258 y Fr(emitfast)11 b
Fv(c)o(ho)q(oses)k(the)f(righ)o(t)f(macro.)k(W)m(e)c(use)h(nested)h
Fr(if-then-else)c Fv(instead)j(of)145 307 y(a)g Fr(switch)e
Fv(b)q(ecause)k(w)o(e)e(think)f(more)g(compilers)g(will)f(eliminate)g
(the)i(unreac)o(hable)h(co)q(de)145 357 y(at)f(compile)e(time.)-15
420 y Fp(393a)88 b Fo(h)p Fn(exp)n(orte)n(d)15 b(macr)n(o)g
(de\014nitions)h Fp(384b)p Fo(i)n Fv(+)q Fo(\021)432
b Fp(\(409b\))22 b Fm(/)5 b Fp(392b)22 b(393b)5 b Fm(.)187
469 y Fr(#define)20 b(emitfast0\(BITS,)f(SIZE\))i(do)g({)h(\\)230
519 y(if)131 b(\(\(SIZE\))20 b(==)h(sizeof\(unsigned)e(long\)\))42
b(emitfastul0\(\(BITS\)\);)18 b(\\)230 569 y(else)j(if)h(\(\(SIZE\))e
(==)h(sizeof\(unsigned\)\))149 b(emitfastu0\(\(BITS\)\);)18
b(\\)230 619 y(else)j(if)h(\(\(SIZE\))e(==)h(sizeof\(unsigned)e
(short\)\))h(emitfastus0\(\(BITS\)\);)e(\\)230 669 y(else)j(if)h
(\(\(SIZE\))e(==)h(sizeof\(unsigned)e(char\)\))42 b
(emitfastuc0\(\(BITS\)\);)18 b(\\)230 718 y(else)j(emitm\(\(BITS\),)e
(\(SIZE\)\);)i(\\)187 768 y(})g(while\(0\))145 820 y
Fp(Uses)15 b Fl(emitfastu0)c Fp(392b,)i Fl(emitfastuc0)e
Fp(392b,)i Fl(emitfastul0)e Fp(392b,)i Fl(emitfastus0)e
Fp(392b,)187 860 y(and)f Fl(emitm)g Fp(392a.)208 922
y Fv(W)m(e)16 b(can't)h(pro)o(vide)f(m)o(uc)o(h)g(help)h(to)g(the)g(p)q
(o)q(or)g(CISC)g(p)q(eople,)h(b)q(ecause)g(they)f(can't)145
972 y(guaran)o(tee)i(prop)q(er)f(alignmen)o(t,)f(but)h(w)o(e)g(can)g
(at)g(least)g(giv)o(e)f(them)g(a)h(fast)f(path)h(for)g(a)145
1021 y(single)c(b)o(yte:)-17 1084 y Fp(393b)88 b Fo(h)p
Fn(exp)n(orte)n(d)15 b(macr)n(o)g(de\014nitions)h Fp(384b)p
Fo(i)n Fv(+)q Fo(\021)438 b Fp(\(409b\))22 b Fm(/)5 b
Fp(393a)22 b(393c)5 b Fm(.)187 1134 y Fr(#define)20 b
(emitfastbyte0\(BITS)o(,)f(SIZE\))i(do)g({)h(\\)230 1183
y(if)g(\(\(SIZE\))e(==)h(sizeof\(unsigned)e(char\)\))i(\\)274
1233 y(emitfastuc0\(\(BITS)o(\)\);)e(\\)230 1283 y(else)i(\\)274
1333 y(emitm\(\(BITS\),)e(\(SIZE\)\);)h(\\)187 1383 y(})h(while\(0\))
145 1434 y Fp(Uses)12 b Fl(emitfastuc)o(0)d Fp(392b)h(and)h
Fl(emitm)f Fp(392a.)145 1555 y Fs(V)l(ersion)19 b(1)42
b Fv(T)m(o)17 b(sp)q(eed)j(things)e(up)g(a)g(bit,)g(w)o(e)h(use)g(a)f
(temp)q(orary)f(to)h(hold)g Fr(currb_p)145 1605 y Fv(while)c(w)o(e're)g
(using)g(it.)-13 1667 y Fp(393c)88 b Fo(h)p Fn(exp)n(orte)n(d)15
b(macr)n(o)g(de\014nitions)h Fp(384b)p Fo(i)n Fv(+)q
Fo(\021)434 b Fp(\(409b\))22 b Fm(/)5 b Fp(393b)22 b(394a)5
b Fm(.)187 1717 y Fr(#define)20 b(emitfastT1\(BITS,)f(TYPE\))h(do)i({)f
(\\)230 1767 y(register)g(unsigned)f(char)h(*p)g(=)h(currb_p;)e(\\)230
1816 y(if)i(\(p)f(<)h(currb_safe\))d({)j(\\)296 1866
y(*\(\(TYPE*\)p\))d(=)j(\(TYPE\))e(\(BITS\);)h(\\)318
1916 y(currb_p)f(=)h(p)h(+)g(sizeof\(TYPE\);)d(\\)230
1966 y(})j(else)f(\(*emitm\)\(\(BITS\),)d(sizeof\(TYPE\)\);)h(\\)187
2016 y(})i(while)g(\(0\))187 2065 y(#define)f(emitfastul1\(BITS\))e
(emitfastT1\(\(BITS\),)g(unsigned)j(long\))187 2115 y(#define)f
(emitfastu1\(BITS\))40 b(emitfastT1\(\(BITS\),)18 b(unsigned\))187
2165 y(#define)i(emitfastus1\(BITS\))e(emitfastT1\(\(BITS\),)g
(unsigned)j(short\))187 2215 y(#define)f(emitfastuc1\(BITS\))e
(emitfastT1\(\(BITS\),)g(unsigned)j(char\))145 2267 y
Fp(De\014nes:)187 2306 y Fl(emitfastu1)o Fp(,)9 b(used)h(in)i(c)o(h)o
(unk)d(394a.)187 2346 y Fl(emitfastuc)o(1)p Fp(,)f(used)j(in)g(c)o(h)o
(unk)f(394.)187 2385 y Fl(emitfastul)o(1)p Fp(,)e(used)j(in)g(c)o(h)o
(unk)f(394a.)187 2424 y Fl(emitfastus)o(1)p Fp(,)e(used)j(in)g(c)o(h)o
(unk)f(394a.)145 2464 y(Uses)i Fl(currb_p)d Fp(385e,)h
Fl(currb_safe)f Fp(385e,)h(and)g Fl(emitm)g Fp(392a.)p
eop
%%Page: 394 394
394 393 bop 129 141 a Fv(394)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(394a)88 b Fo(h)p Fn(exp)n(orte)n(d)16
b(macr)n(o)e(de\014nitions)i Fp(384b)p Fo(i)o Fv(+)p
Fo(\021)436 b Fp(\(409b\))22 b Fm(/)5 b Fp(393c)23 b(394b)t
Fm(.)171 307 y Fr(#define)d(emitfast1\(BITS,)f(SIZE\))i(do)g({)h(\\)215
357 y(if)130 b(\(\(SIZE\))20 b(==)i(sizeof\(unsigned)c(long\)\))43
b(emitfastul1\(\(BIT)o(S\)\);)18 b(\\)215 407 y(else)j(if)g(\(\(SIZE\))
f(==)i(sizeof\(unsigned\))o(\))150 b(emitfastu1\(\(BITS)o(\)\);)19
b(\\)215 457 y(else)i(if)g(\(\(SIZE\))f(==)i(sizeof\(unsigned)c
(short\)\))j(emitfastus1\(\(BIT)o(S\)\);)d(\\)215 507
y(else)j(if)g(\(\(SIZE\))f(==)i(sizeof\(unsigned)c(char\)\))43
b(emitfastuc1\(\(BIT)o(S\)\);)18 b(\\)215 557 y(else)j
(emitm\(\(BITS\),)e(\(SIZE\)\);)h(\\)171 606 y(})i(while\(0\))129
658 y Fp(Uses)15 b Fl(emitfastu1)d Fp(393c,)h Fl(emitfastuc1)f
Fp(393c,)h Fl(emitfastul1)e Fp(393c,)j Fl(emitfastus)o(1)e
Fp(393c,)171 698 y(and)f Fl(emitm)f Fp(392a.)-33 789
y(394b)88 b Fo(h)p Fn(exp)n(orte)n(d)16 b(macr)n(o)e(de\014nitions)i
Fp(384b)p Fo(i)o Fv(+)p Fo(\021)438 b Fp(\(409b\))22
b Fm(/)5 b Fp(394a)22 b(394c)5 b Fm(.)171 839 y Fr(#define)20
b(emitfastbyte1\(BITS,)e(SIZE\))j(do)g({)h(\\)215 889
y(if)f(\(\(SIZE\))f(==)i(sizeof\(unsigned)c(char\)\))j(\\)258
938 y(emitfastuc1\(\(BITS\))o(\);)e(\\)215 988 y(else)i(\\)258
1038 y(emitm\(\(BITS\),)e(\(SIZE\)\);)h(\\)171 1088 y(})i(while\(0\))
129 1140 y Fp(Uses)12 b Fl(emitfastuc1)c Fp(393c)i(and)h
Fl(emitm)f Fp(392a.)129 1268 y Fs(V)l(ersion)g(2)41 b
Fv(V)m(ersion)11 b(2)e(w)o(orks)h(around)g(a)g(problem)f(that)h(crops)h
(up)f(with)g Fr(lcc)f Fv(and)h(other)129 1318 y(compilers;)g(the)h(man)
o(y)d Fr(if)i Fv(statemen)o(ts)g(generate)i(lots)e(of)f(unreac)o(hable)
i(co)q(de,)g(killing)d(VM)129 1368 y(p)q(erformances.)18
b Fr(gcc)k(-O)12 b Fv(w)o(orks)h(around)g(this,)f(but)h(b)q(oth)g
Fr(gcc)g Fv(and)f Fr(lcc)h Fv(generate)h(m)o(uc)o(h)129
1418 y(b)q(etter)i(co)q(de)f(if)d(w)o(e)j(use)f(conditional)f
(expressions)i(instead)f(of)f(conditional)g(statemen)o(ts.)192
1468 y(W)m(e)i(need)i(one)e(tric)o(k;)i(w)o(e)e(declare)i(the)f(p)q
(oin)o(ter)g(in)f(the)i(outermost)e(macro.)22 b(That's)129
1517 y(b)q(ecause)16 b(the)f(inner)g(macros)e(ha)o(v)o(e)i(to)f(b)q(e)h
(expressions,)g(b)q(ecause)h(C)e(compilers)g(lik)o(e)f
Fr(lcc)129 1567 y Fv(and)20 b Fr(gcc)f Fv(will)f(optimize)g(a)o(w)o(a)o
(y)h(unnecessary)j(branc)o(hes)f(and)e(lab)q(els)h(for)f(conditional)
129 1617 y(expressions)d(but)e(not)g(for)f(conditional)g(statemen)o
(ts.)-29 1679 y Fp(394c)88 b Fo(h)p Fn(exp)n(orte)n(d)16
b(macr)n(o)e(de\014nitions)i Fp(384b)p Fo(i)o Fv(+)p
Fo(\021)434 b Fp(\(409b\))22 b Fm(/)5 b Fp(394b)22 b(395a)5
b Fm(.)171 1729 y Fr(#define)20 b(emitfastT2\(BITS,)f(TYPE\))i(\()g(\\)
215 1779 y(\(EMITFAST_p)e(<)j(currb_safe\))d(\\)258 1829
y(?)j(\(*\(\(TYPE*\)EMITFA)o(ST_p\))c(=)k(\(TYPE\))e(\(BITS\),)h(\\)324
1879 y(currb_p)f(=)h(EMITFAST_p)f(+)i(sizeof\(TYPE\),)d(\\)324
1928 y(\(void\)0\))h(\\)258 1978 y(:)i(\(*emitm\)\(\(BITS\),)c
(sizeof\(TYPE\)\))h(\\)215 2028 y(\))171 2078 y(#define)h
(Xemitfastul2\(BITS\))e(emitfastT2\(\(BITS\),)g(unsigned)j(long\))171
2128 y(#define)f(Xemitfastu2\(BITS\))40 b(emitfastT2\(\(BITS\),)18
b(unsigned\))171 2178 y(#define)i(Xemitfastus2\(BITS\))e
(emitfastT2\(\(BITS\),)g(unsigned)j(short\))171 2227
y(#define)f(Xemitfastuc2\(BITS\))e(emitfastT2\(\(BITS\),)g(unsigned)j
(char\))129 2279 y Fp(De\014nes:)171 2319 y Fl(Xemitfastu)o(2)p
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(395.)171 2358 y Fl(Xemitfastu)o(c2)p
Fp(,)e(used)j(in)g(c)o(h)o(unk)f(395.)171 2398 y Fl(Xemitfastu)o(l2)p
Fp(,)e(used)j(in)g(c)o(h)o(unk)f(395.)171 2437 y Fl(Xemitfastu)o(s2)p
Fp(,)e(used)j(in)g(c)o(h)o(unk)f(395.)129 2476 y(Uses)i
Fl(currb_p)d Fp(385e,)i Fl(currb_saf)o(e)e Fp(385e,)h(and)h
Fl(emitm)f Fp(392a.)p eop
%%Page: 395 395
395 394 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(395)-15 258 y Fp(395a)88 b Fo(h)p
Fn(exp)n(orte)n(d)15 b(macr)n(o)g(de\014nitions)h Fp(384b)p
Fo(i)n Fv(+)q Fo(\021)436 b Fp(\(409b\))22 b Fm(/)5 b
Fp(394c)22 b(395b)5 b Fm(.)187 307 y Fr(#define)20 b(emitfast2\(BITS,)f
(SIZE\))i(do)g({)h(\\)230 357 y(register)f(unsigned)f(char)h
(*EMITFAST_p)e(=)j(currb_p;)e(\\)230 407 y(\(\(SIZE\))h(==)g
(sizeof\(unsigned)e(long\)\))42 b(?)22 b(Xemitfastul2\(\(BI)o(TS\)\))c
(:)k(\\)230 457 y(\(\(SIZE\))f(==)g(sizeof\(unsigned\)\))149
b(?)22 b(Xemitfastu2\(\(BIT)o(S\)\))40 b(:)22 b(\\)230
507 y(\(\(SIZE\))f(==)g(sizeof\(unsigned)e(short\)\))h(?)i
(Xemitfastus2\(\(BI)o(TS\)\))c(:)k(\\)230 557 y(\(\(SIZE\))f(==)g
(sizeof\(unsigned)e(char\)\))42 b(?)22 b(Xemitfastuc2\(\(BI)o(TS\)\))c
(:)k(\\)230 606 y(emitm\(\(BITS\),)d(\(SIZE\)\);)i(\\)187
656 y(})g(while\(0\))145 708 y Fp(De\014nes:)187 747
y Fl(emitfast2)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(396a.)145
787 y(Uses)i Fl(currb_p)e Fp(385e,)g Fl(emitm)h Fp(392a,)f
Fl(Xemitfastu2)e Fp(394c,)j Fl(Xemitfastu)o(c2)e Fp(394c,)h
Fl(Xemitfastul)o(2)f Fp(394c,)187 826 y(and)h Fl(Xemitfastus)o(2)f
Fp(394c.)-17 918 y(395b)88 b Fo(h)p Fn(exp)n(orte)n(d)15
b(macr)n(o)g(de\014nitions)h Fp(384b)p Fo(i)n Fv(+)q
Fo(\021)438 b Fp(\(409b\))22 b Fm(/)5 b Fp(395a)22 b(395c)5
b Fm(.)187 967 y Fr(#define)20 b(emitfastbyte2\(BITS)o(,)f(SIZE\))i(do)
g({)h(\\)230 1017 y(register)f(unsigned)f(char)h(*EMITFAST_p)e(=)j
(currb_p;)e(\\)230 1067 y(\(\(SIZE\))h(==)g(sizeof\(unsigned)e
(char\)\))h(?)i(emitfastuc2\(\(BITS)o(\)\))d(:)i(\\)230
1117 y(emitm\(\(BITS\),)e(\(SIZE\)\);)i(\\)187 1167 y(})g(while\(0\))
145 1219 y Fp(De\014nes:)187 1258 y Fl(emitfastby)o(te2)o
Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f(396a.)145 1297 y(Uses)i
Fl(currb_p)d Fp(385e,)h Fl(emitfastuc2)e Fp(395c,)i(and)h
Fl(emitm)f Fp(392a.)-13 1389 y(395c)88 b Fo(h)p Fn(exp)n(orte)n(d)15
b(macr)n(o)g(de\014nitions)h Fp(384b)p Fo(i)n Fv(+)q
Fo(\021)434 b Fp(\(409b\))22 b Fm(/)5 b Fp(395b)22 b(396a)5
b Fm(.)187 1439 y Fr(#define)20 b(emitfastul2\(BITS\))e(do)k({)f(\\)230
1488 y(register)g(unsigned)f(char)h(*EMITFAST_p)e(=)j(currb_p;)e
(Xemitfastul2\(\(BIT)o(S\)\);)e(\\)187 1538 y(})j(while\(0\))187
1588 y(#define)f(emitfastu2\(BITS\))f(do)i({)h(\\)230
1638 y(register)f(unsigned)f(char)h(*EMITFAST_p)e(=)j(currb_p;)e
(Xemitfastu2\(\(BITS)o(\)\);)f(\\)187 1688 y(})i(while\(0\))187
1738 y(#define)f(emitfastus2\(BITS\))e(do)k({)f(\\)230
1787 y(register)g(unsigned)f(char)h(*EMITFAST_p)e(=)j(currb_p;)e
(Xemitfastus2\(\(BIT)o(S\)\);)e(\\)187 1837 y(})j(while\(0\))187
1887 y(#define)f(emitfastuc2\(BITS\))e(do)k({)f(\\)230
1937 y(register)g(unsigned)f(char)h(*EMITFAST_p)e(=)j(currb_p;)e
(Xemitfastuc2\(\(BIT)o(S\)\);)e(\\)187 1987 y(})j(while\(0\))145
2038 y Fp(De\014nes:)187 2078 y Fl(emitfastu2)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)d(396a.)187 2117 y Fl(emitfastuc)o(2)p
Fp(,)f(used)j(in)g(c)o(h)o(unks)f(395b)g(and)h(396a.)187
2157 y Fl(emitfastul)o(2)p Fp(,)d(used)j(in)g(c)o(h)o(unk)f(396a.)187
2196 y Fl(emitfastus)o(2)p Fp(,)e(used)j(in)g(c)o(h)o(unk)f(396a.)145
2236 y(Uses)16 b Fl(currb_p)c Fp(385e,)i Fl(Xemitfastu2)e
Fp(394c,)i Fl(Xemitfast)o(uc2)e Fp(394c,)h Fl(Xemitfastul)o(2)f
Fp(394c,)187 2275 y(and)e Fl(Xemitfastus)o(2)f Fp(394c.)p
eop
%%Page: 396 396
396 395 bop 129 141 a Fv(396)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(W)m(e)g(use)i(v)o(ersion)f(2.)-31
320 y Fp(396a)88 b Fo(h)p Fn(exp)n(orte)n(d)16 b(macr)n(o)e
(de\014nitions)i Fp(384b)p Fo(i)o Fv(+)p Fo(\021)436
b Fp(\(409b\))22 b Fm(/)5 b Fp(395c)23 b(396b)t Fm(.)171
370 y Fr(#define)d(emitfast)173 b(emitfast2)171 420 y(#define)20
b(emitfastbyte)85 b(emitfastbyte2)171 469 y(#define)20
b(emitfastul)129 b(emitfastul2)171 519 y(#define)20 b(emitfastu)151
b(emitfastu2)171 569 y(#define)20 b(emitfastus)129 b(emitfastus2)171
619 y(#define)20 b(emitfastuc)129 b(emitfastuc2)129 671
y Fp(Uses)15 b Fl(emitfast2)d Fp(395a,)h Fl(emitfastbyte)o(2)f
Fp(395b,)h Fl(emitfastu2)f Fp(395c,)h Fl(emitfastuc)o(2)f
Fp(395c,)171 710 y Fl(emitfastul)o(2)d Fp(395c,)h(and)h
Fl(emitfastu)o(s2)d Fp(395c.)129 839 y Ft(23.1.3)56 b(Lo)r(cation-coun)
n(ter)17 b(manipulations)129 915 y Fv(W)m(e)f(exp)q(ort)h(the)g(follo)o
(wing)c(macros)j(and)g(pro)q(cedures.)27 b(Note)17 b(that)f(w)o(e)g
(use)h(the)g(global)129 965 y(v)n(ariables,)c(not)h(the)g(dirt)o(y)g
(\014elds)g(in)g Fr(currb)p Fv(.)-33 1027 y Fp(396b)88
b Fo(h)p Fn(exp)n(orte)n(d)16 b(macr)n(o)e(de\014nitions)i
Fp(384b)p Fo(i)o Fv(+)p Fo(\021)436 b Fp(\(409b\))22
b Fm(/)5 b Fp(396a)22 b(397a)5 b Fm(.)171 1077 y Fr(#define)20
b(lc\(\))h(\(currb_p)f(-)i(currb->curbuf->da)o(ta)d(+)i
(currb->curbuf->datal)o(c\))171 1127 y(#define)f(org\(LOC\))173
b(set_lc\(currb,\(LOC)o(\)\))171 1177 y(#define)20 b(addlc\(N\))g
(\(\(void\)\(currb_p)f(+=)j(\(N\)\)\))129 1229 y Fp(De\014nes:)171
1268 y Fl(addlc)p Fp(,)10 b(used)g(in)h(c)o(h)o(unk)f(397.)171
1308 y Fl(lc)p Fp(,)h(used)f(in)i(c)o(h)o(unks)d(14,)i(382,)g(385a,)f
(388{90,)f(397c,)h(401{4,)g(408a,)g(and)h(412c.)129 1347
y(Uses)h Fl(currb)e Fp(385e,)g Fl(currb_p)g Fp(385e,)g(and)g
Fl(set_lc)g Fp(396c.)192 1409 y Fv(When)18 b(the)i(lo)q(cation)d(coun)o
(ter)j(c)o(hanges,)g(w)o(e)e(alw)o(a)o(ys)g(main)o(tain)e(the)j(in)o(v)
n(arian)o(t)e(on)129 1459 y(page)h(384.)28 b(The)19 b(in)o(v)n(arian)o
(t)c(do)q(esn't)k(require)f(that)g Fr(currb_p)e Fv(p)q(oin)o(t)h(in)o
(to)g(the)h(curren)o(t)129 1509 y(bu\013er,)c(so)f(w)o(e)g(ha)o(v)o(e)g
(to)g(up)q(date)h Fr(currb->curbuf)c Fv(only)i(if)g(the)i(lo)q(cation)e
(coun)o(ter)i(mo)o(v)o(es)129 1559 y(bac)o(k)j(to)f(precede)i(the)f(b)q
(eginning)f(of)g(the)h(bu\013er.)26 b(If)16 b(it)g(mo)o(v)o(es)f(forw)o
(ards,)h(w)o(e)h(needn't)129 1609 y(touc)o(h)d(an)o(ything,)d(b)q
(ecause)k(w)o(e)e(will)e(lazily)h(w)o(alk)f(to)i(the)h(prop)q(er)f
(bu\013er)h(when)g(w)o(e)f(try)g(to)129 1658 y(emit.)-29
1721 y Fp(396c)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)749 b Fp(\(410\))22 b Fm(/)5 b
Fp(392a)22 b(397c)5 b Fm(.)171 1771 y Fr(void)21 b(set_lc\(rb,)f
(newlc\))g(RBlock)h(rb;)g(unsigned)f(newlc;)h({)258 1820
y Fo(h)p Fn(if)15 b(low)f(water)g(mark)g(not)i(set,)e(up)n(date)i
(\014rst)e Fr(datalc)g Fn(and)h(r)n(eturn)g Fp(397b)p
Fo(i)258 1870 y Fr(if)22 b(\(newlc)e(<)i(currb->curbuf->d)o(atalc)o(\))
d({)302 1920 y(currb->curbuf)g(=)i(&currb->firstbuf;)302
1970 y(currb_safe)e(=)j(currb->curbuf->lim)o(it)d(-)i(MARGIN;)258
2020 y(})258 2069 y(assert\(\("above)e(low)i(water",)g(newlc)f(>=)i
(currb->curbuf->d)o(atalc)o(\)\);)258 2119 y(currb_p)e(=)i(newlc)f(-)g
(currb->curbuf->data)o(lc)e(+)i(currb->curbuf->data;)171
2169 y(})129 2221 y Fp(De\014nes:)171 2260 y Fl(set_lc)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unk)f(396b.)129 2300 y(Uses)i
Fl(currb)e Fp(385e,)g Fl(currb_p)g Fp(385e,)g Fl(currb_safe)e
Fp(385e,)i Fl(MARGIN)g Fp(384b,)g(and)g Fl(RBlock)p Fp(.)p
eop
%%Page: 397 397
397 396 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(397)145 258 y(W)m(e)16 b(ha)o(v)o(e)h(to)f(pro)o
(vide)g(access)i(to)f Fn(al)r(l)f Fv(the)h(\014elds)f(of)g(an)o(y)g
(relo)q(catable)h(blo)q(c)o(k,)f(ev)o(en)h(if)f(it)145
307 y(isn't)g(the)h Fr(crb)p Fv(.)25 b Fr(block_lc)15
b Fv(and)h Fr(block_low)f Fv(return)i(the)g(lo)q(cation)f(coun)o(ter)h
(and)f(lo)o(w-)145 357 y(w)o(ater)i(mark)e(of)h Fr(rb)p
Fv(.)27 b(If)17 b Fr(rb)g Fv(is)g Fr(crb)p Fv(,)g Fr(make_clean)f
Fv(is)h(called)g(so)g(w)o(e)h(don't)f(access)i(an)o(y)145
407 y(dirt)o(y)14 b(\014elds.)-15 469 y Fp(397a)88 b
Fo(h)p Fn(exp)n(orte)n(d)15 b(macr)n(o)g(de\014nitions)h
Fp(384b)p Fo(i)n Fv(+)q Fo(\021)432 b Fp(\(409b\))22
b Fm(/)5 b Fp(396b)22 b(398b)5 b Fm(.)187 519 y Fr(#define)20
b(block_lc\(rb\))f(\\)230 569 y(\(\(rb\))i(==)h(currb)e(\\)318
619 y(?)h(\(make_clean\(\),\(\(rb)o(\)->p)d(-)k(\(rb\)->curbuf->dat)o
(a)d(+)j(\(rb\)->curbuf->da)o(talc)o(\)\))d(\\)318 669
y(:)326 b(\(\(rb\)->p)20 b(-)i(\(rb\)->curbuf->dat)o(a)d(+)j
(\(rb\)->curbuf->da)o(talc)o(\)\))187 718 y(#define)e(block_low\(rb\))f
(\\)230 768 y(\(\(rb\))i(==)h(currb)e(\\)318 818 y(?)h
(\(make_clean\(\),)e(\(rb\)->firstbuf.dat)o(alc\))f(\\)318
868 y(:)348 b(\(rb\)->firstbuf.dat)o(alc\))145 920 y
Fp(Uses)12 b Fl(currb)e Fp(385e)g(and)h Fl(make_clean)d
Fp(385a.)208 982 y Fv(If)j(the)i(lo)o(w)f(w)o(ater)g(mark)f(isn't)h
(set,)h(then)g(w)o(e)f(can)h(c)o(hange)f(the)h(lo)q(cation)e(coun)o
(ter)j(and)145 1032 y(pin)g Fr(currb_p)e Fv(to)i(the)g(b)q(eginning)g
(of)f(the)h(sen)o(tinel)h(bu\013er.)-17 1094 y Fp(397b)88
b Fo(h)p Fn(if)15 b(low)f(water)g(mark)h(not)g(set,)f(up)n(date)i
(\014rst)e Fr(datalc)g Fn(and)i(r)n(eturn)e Fp(397b)p
Fo(i)n(\021)143 b Fp(\(396c\))187 1144 y Fr(if)21 b
(\(!currb->firstbuf.)o(next\))d({)230 1194 y(assert\(currb->curbu)o(f)h
(==)i(&currb->firstbuf\);)230 1244 y(currb->firstbuf.dat)o(alc)e(=)i
(newlc;)230 1293 y(currb_p)g(=)g(currb->curbuf->data)o(;)e(/*)i(might)g
(have)g(been)g(advanced)f(by)i(addlc)e(*/)230 1343 y(return;)187
1393 y(})145 1445 y Fp(Uses)12 b Fl(addlc)e Fp(396b,)g
Fl(currb)g Fp(385e,)g Fl(currb_p)f Fp(385e,)i(and)f Fl(next)h
Fp(399c.)208 1507 y Fv(Aligning)k(alw)o(a)o(ys)i(increases)i(the)f(lo)q
(cation)f(coun)o(ter,)i(so)e(w)o(e)h(use)g Fr(addlc)p
Fv(,)f(whic)o(h)h(is)145 1557 y(fast.)-13 1619 y Fp(397c)88
b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p Fo(i)o Fv(+)p
Fo(\021)749 b Fp(\(410\))22 b Fm(/)5 b Fp(396c)22 b(398a)5
b Fm(.)187 1669 y Fr(void)21 b(align\(n\))f(unsigned)g(n;)h({)274
1719 y(unsigned)f(oldlc)h(=)g(lc\(\);)274 1769 y(unsigned)f(newlc;)274
1818 y(newlc)h(=)g(\(oldlc)g(+)g(n)h(-)g(1\);)274 1868
y(newlc)f(-=)g(newlc)g(\045)g(n;)274 1918 y(addlc\(newlc-oldlc)o(\);)
187 1968 y(})145 2020 y Fp(Uses)12 b Fl(addlc)e Fp(396b)g(and)h
Fl(lc)g Fp(396b.)145 2148 y Ft(23.1.4)56 b(P)n(oin)n(ting)19
b(registers)e(in)n(to)h(relo)r(catable)f(blo)r(c)n(ks)145
2225 y Fv(Wherein)e(w)o(e)f(de\014ne)h(the)f(follo)o(wing)d(exp)q
(orted)k(functions:)p eop
%%Page: 398 398
398 397 bop 129 141 a Fv(398)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y Fr(bind_register\(rb)o(,)19
b(reg,)i(rlc\))13 b Fv(binds)h(register)h Fr(reg)e Fv(to)h(the)h(relo)q
(catable)f(blo)q(c)o(k)129 307 y Fr(rb)g Fv(at)g(lo)q(cation)f(coun)o
(ter)h Fr(rlc)p Fv(.)k(Registers)d(can't)e(b)q(e)i(reb)q(ound.)-31
366 y Fp(398a)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)747 b Fp(\(410\))22 b Fm(/)5 b
Fp(397c)23 b(398d)t Fm(.)171 416 y Fr(void)e(set_register\(rb,)d(reg,)j
(rlc\))g(RBlock)g(rb;)g(unsigned)f(reg,)h(rlc;)g({)258
465 y(assert\(!rb->known.)o(reg\);)258 515 y(rb->reg)f(=)i(reg;)258
565 y(rb->reglc)e(=)i(rlc;)258 615 y(rb->known.reg)d(=)j(1;)171
665 y(})129 763 y Fp(Uses)12 b Fl(RBlock)p Fp(,)e Fl(reg)g
Fp(383a,)g(and)h Fl(reglc)f Fp(383a.)129 884 y Ft(23.1.5)56
b(Other)18 b(op)r(erations)g(on)g(relo)r(catable)f(blo)r(c)n(ks)129
961 y Fv(Here's)e(the)g(rest)g(of)e('em:)192 1010 y(A)h(blo)q(c)o(k)f
(is)h(de\014ned)h(if)e(it's)g(non-n)o(ull)g(and)h(it's)f(not)h(the)g
(unde\014ned)i(blo)q(c)o(k.)-33 1069 y Fp(398b)88 b Fo(h)p
Fn(exp)n(orte)n(d)16 b(macr)n(o)e(de\014nitions)i Fp(384b)p
Fo(i)o Fv(+)p Fo(\021)436 b Fp(\(409b\))22 b Fm(/)5 b
Fp(397a)22 b(399a)5 b Fm(.)171 1119 y Fr(extern)21 b(struct)f
(reloc_block)g(undefrblock;)171 1168 y(#define)g(block_defined\(rb\))f
(\(\(rb\))h(&&)i(\(rb\))f(!=)g(&undefrblock\))129 1216
y Fp(De\014nes:)171 1256 y Fl(block_defi)o(ned)o Fp(,)9
b(used)h(in)i(c)o(h)o(unk)e(404a.)129 1295 y(Uses)i Fl(undefrblock)c
Fp(398c.)-29 1367 y(398c)88 b Fo(h)p Fn(lo)n(c)n(al)15
b(de)n(clar)n(ations)g Fp(385c)p Fo(i)n Fv(+)q Fo(\021)629
b Fp(\(410\))22 b Fm(/)5 b Fp(391c)23 b(401b)t Fm(.)171
1417 y Fr(struct)e(reloc_block)e(undefrblock;)129 1465
y Fp(De\014nes:)171 1504 y Fl(undefrbloc)o(k)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(398b)g(and)h(404b.)129 1567
y Fv(Note)j(that)g(in)f(initializing)e(the)j(unde\014ned)g(blo)q(c)o(k)
f(w)o(e)h(rely)f(on)h(the)g(fact)f(that)h(the)g Fr(known)129
1617 y Fv(\015ags)g(default)g(to)f(0,)h(since)g(they're)h(used)g(in)e
(the)i Fr(location_known)c Fv(tests.)192 1666 y Fr(block_new)16
b Fv(creates)k(a)d(new)i(relo)q(catable)f(blo)q(c)o(k.)30
b Fr(size)17 b Fv(is)h(a)f(hin)o(t)h(to)g(the)g(library)129
1716 y(as)e(to)f(the)h(maxim)n(um)11 b(size)16 b(of)f(the)h(blo)q(c)o
(k's)f(con)o(ten)o(ts.)23 b(Rather)15 b(than)h(allo)q(cate)f(a)g
(bu\013er)129 1766 y(immediately)m(,)e(ho)o(w)o(ev)o(er,)k(w)o(e)f
(just)h(sa)o(v)o(e)f(a)o(w)o(a)o(y)g(the)h(size)g(hin)o(t.)25
b(A)o(t)16 b(the)h(cost)g(of)f(a)g(w)o(ord)129 1816 y(p)q(er)e(blo)q(c)
o(k,)d(this)h(mak)o(es)g(it)f(c)o(heap)i(to)f(create)i(blo)q(c)o(ks)e
(that)g(are)h(nev)o(er)g(used.)18 b(W)m(e're)12 b(doing)129
1866 y(it)i(b)q(ecause)i(someda)o(y)c(someb)q(o)q(dy)h(migh)o(t)f(w)o
(an)o(t)h(to)h(create)i Fn(lots)d Fv(of)g(them.)-33 1924
y Fp(398d)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)749 b Fp(\(410\))22 b Fm(/)5 b
Fp(398a)22 b(399e)5 b Fm(.)171 1974 y Fr(RBlock)21 b(block_new\(size\))
d(unsigned)i(size;)h({)258 2024 y(RBlock)g(rb,)g(tmprb;)258
2123 y(rb)h(=)f(\(RBlock\))f(mc_alloc\(sizeof\(*rb)o(\),)f
(RBlock_pool\);)258 2173 y Fo(h)p Fn(initialize)14 b(a)h(new)g(r)n(elo)
n(c)n(atable)f(blo)n(ck)h Fr(rb)f Fp(382b)p Fo(i)258
2223 y Fr(rb->size_hint)19 b(=)j(size)f(>)g(0)h(?)g(size)f(:)g(BUFSZ;)
258 2273 y Fo(h)p Fn(c)n(ount)16 b(the)f(new)g(blo)n(ck)f
Fr(rb)h Fn(and)g(string)g(it)f(on)i(a)f(list)f Fp(399b)p
Fo(i)258 2323 y Fr(return)21 b(rb;)171 2372 y(})129 2420
y Fp(De\014nes:)171 2460 y Fl(block_new)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(322.)129 2499 y(Uses)i Fl(BUFSZ)e Fp(410,)h Fl(RBlock)p
Fp(,)e(and)i Fl(size_hint)d Fp(390d.)p eop
%%Page: 399 399
399 398 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(399)-15 258 y Fp(399a)88 b Fo(h)p
Fn(exp)n(orte)n(d)15 b(macr)n(o)g(de\014nitions)h Fp(384b)p
Fo(i)n Fv(+)q Fo(\021)441 b Fp(\(409b\))22 b Fm(/)5 b
Fp(398b)22 b(399f)5 b Fm(.)187 307 y Fr(#define)20 b(block_label\(rb\))
f(\(\(rb\)->label\))145 359 y Fp(De\014nes:)187 399 y
Fl(block_labe)o(l)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(322.)145
438 y(Uses)i Fl(label)e Fp(383a.)208 509 y Fv(F)m(or)g(some)g(reason,)i
(w)o(e)f(ha)o(v)o(e)f(a)h(bunc)o(h)g(of)f(instrumen)o(tation)g(attac)o
(hed)h(to)g(relo)q(catable)145 559 y(blo)q(c)o(ks.)18
b(F)m(or)12 b(example,)e(w)o(e)j(k)o(eep)g(them)e(on)h(a)g(list)g
Fr(defined_rbs)e Fv(link)o(ed)h(b)o(y)h Fr(next)f Fv(\014elds.)145
608 y(The)k(next)f(few)g(c)o(h)o(unks)g(can)h(go)e(if)g(w)o(e)h(ditc)o
(h)g(the)g(instrumen)o(tation.)-17 671 y Fp(399b)88 b
Fo(h)p Fn(c)n(ount)16 b(the)f(new)g(blo)n(ck)g Fr(rb)f
Fn(and)i(string)e(it)g(on)i(a)f(list)f Fp(399b)p Fo(i)n(\021)364
b Fp(\(398d\))187 720 y Fr(nblocks++;)20 b(/*)h(do)g(we)h(really)e
(need)h(this)g(instrumentation?)e(*/)187 770 y(rb->next)h(=)i
(defined_rbs;)193 b(/*)22 b(instrumentation)c(*/)187
820 y(defined_rbs)h(=)j(rb;)326 b(/*)22 b(instrumentation)c(*/)145
872 y Fp(Uses)12 b Fl(defined_rb)o(s)d Fp(399e,)h Fl(nblocks)f
Fp(399e,)h(and)h Fl(next)f Fp(399c.)-13 955 y(399c)88
b Fo(h)p Fn(other)15 b(\014elds)g(of)g(a)g(r)n(elo)n(c)n(atable)f(blo)n
(ck)h Fp(383a)p Fo(i)o Fv(+)p Fo(\021)446 b Fp(\(382a\))21
b Fm(/)6 b Fp(390d)187 1005 y Fr(struct)20 b(reloc_block)g(*next;)151
b(/*)22 b(instrumentation)c(*/)145 1057 y Fp(De\014nes:)187
1096 y Fl(next)p Fp(,)10 b(used)g(in)i(c)o(h)o(unks)d(306,)i(381,)f
(382b,)h(388{91,)e(397b,)h(and)h(399{401.)-17 1187 y(399d)88
b Fo(h)p Fn(exp)n(orte)n(d)15 b(data)h(de)n(clar)n(ations)e
Fp(381)p Fo(i)o Fv(+)q Fo(\021)461 b Fp(\(409b\))22 b
Fm(/)5 b Fp(384a)22 b(403b)5 b Fm(.)187 1237 y Fr(extern)20
b(RBlock)h(defined_rbs;)128 b(/*)22 b(instrumentation)c(*/)187
1287 y(extern)i(int)i(nblocks;)281 b(/*)22 b(instrumentation)c(*/)145
1339 y Fp(Uses)12 b Fl(defined_rb)o(s)d Fp(399e,)h Fl(nblocks)f
Fp(399e,)h(and)h Fl(RBlock)p Fp(.)-13 1430 y(399e)88
b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p Fo(i)o Fv(+)p
Fo(\021)745 b Fp(\(410\))22 b Fm(/)5 b Fp(398d)22 b(399g)5
b Fm(.)187 1480 y Fr(RBlock)20 b(defined_rbs)g(=)h(\(RBlock\))g(0;/*)g
(instrumentation)d(*/)187 1530 y(int)j(nblocks)f(=)i(0;)348
b(/*)22 b(instrumentation)c(*/)145 1582 y Fp(De\014nes:)187
1621 y Fl(defined_rb)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(399.)187
1661 y Fl(nblocks)p Fp(,)f(used)h(in)i(c)o(h)o(unk)e(399.)145
1700 y(Uses)i Fl(RBlock)p Fp(.)208 1771 y Fv(Setting)i(and)f(reading)h
(an)g(address)h(is)f(straigh)o(tforw)o(ard.)-8 1833 y
Fp(399f)88 b Fo(h)p Fn(exp)n(orte)n(d)15 b(macr)n(o)g(de\014nitions)h
Fp(384b)p Fo(i)n Fv(+)q Fo(\021)436 b Fp(\(409b\))22
b Fm(/)5 b Fp(399a)22 b(400a)5 b Fm(.)187 1883 y Fr(#define)20
b(block_address_know)o(n\(rb\))e(\(\(rb\)->known.addre)o(ss\))187
1933 y(#define)i(block_address\(rb\))149 b(\(\(rb\)->address\))145
1985 y Fp(Uses)12 b Fl(address)d Fp(383a.)-15 2068 y(399g)88
b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p Fo(i)o Fv(+)p
Fo(\021)747 b Fp(\(410\))22 b Fm(/)5 b Fp(399e)22 b(400b)5
b Fm(.)187 2117 y Fr(void)21 b(set_address\(rb,)d(address\))j(RBlock)f
(rb;)h(unsigned)f(address;)h({)274 2167 y(assert\(rb\);)274
2217 y(rb->address)e(=)j(address;)274 2267 y(rb->known.address)c(=)k
(1;)187 2317 y(})145 2368 y Fp(De\014nes:)187 2408 y
Fl(set_addres)o(s)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(322.)145
2447 y(Uses)i Fl(address)d Fp(383a)i(and)f Fl(RBlock)p
Fp(.)p eop
%%Page: 400 400
400 399 bop 129 141 a Fv(400)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(Computing)8 b(the)j(blo)q(c)o(k)f(size)h
(is)g(a)f(pain)g(in)g(the)h(ass,)g(b)q(ecause)h(the)f(blo)q(c)o(k)f(w)o
(e're)h(lo)q(oking)129 307 y(at)j(just)g(migh)o(t)e(b)q(e)j(dirt)o(y)m
(.)-31 370 y Fp(400a)88 b Fo(h)p Fn(exp)n(orte)n(d)16
b(macr)n(o)e(de\014nitions)i Fp(384b)p Fo(i)o Fv(+)p
Fo(\021)445 b Fp(\(409b\))22 b Fm(/)5 b Fp(399f)22 b(403c)5
b Fm(.)171 420 y Fr(#define)20 b(block_size\(rb\))f(\(\(rb\))i(==)g
(currb)g(?)h(\(make_clean\(\),)d(\(rb\)->size\))g(:)j(\(rb\)->size\))
129 471 y Fp(Uses)12 b Fl(currb)e Fp(385e)h(and)f Fl(make_clean)e
Fp(385a.)129 600 y Ft(23.1.6)56 b(Accessing)18 b(con)n(ten)n(ts)h(of)g
(relo)r(catable)e(blo)r(c)n(ks)129 677 y Fr(block_copy)e
Fv(copies)j Fr(n)e Fv(b)o(ytes)i(of)e(relo)q(catable)h(blo)q(c)o(k)g
Fr(rb)f Fv(in)o(to)g Fr(dest)g Fv(b)q(eginning)h(at)f(lo-)129
727 y(cation)21 b Fr(start)p Fv(.)36 b Fr(block_write)18
b Fv(writes)k Fr(n)e Fv(b)o(ytes)h(of)f(relo)q(catable)h(blo)q(c)o(k)f
Fr(rb)g Fv(in)o(to)g(\014le)129 776 y(de\014ned)i(b)o(y)d(\014le)h
(descriptor)i Fr(fd)d Fv(b)q(eginning)h(at)g(lo)q(cation)f
Fr(start)p Fv(.)35 b(W)m(e)20 b(use)h(a)f(macro)129 826
y Fr(TRANSFER\(DEST,)f(SRC,)i(N\))14 b Fv(to)f(transfer)i(the)g(data,)e
(so)h(w)o(e)g(can)g(re-use)h(the)g(b)q(o)q(dy)m(.)-33
888 y Fp(400b)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)745 b Fp(\(410\))22 b Fm(/)5 b
Fp(399g)23 b(400d)t Fm(.)171 938 y Fr(void)e(block_copy\(dest,)d(rb,)k
(start,)e(n\))i(unsigned)e(char)h(*dest;)f(RBlock)h(rb;)g(unsigned)f
(start,)h(n;)g({)215 988 y(void)g(*memcpy\(void)e(*dest,)h(const)h
(void)g(*src,)g(size_t)f(n\);)215 1038 y(#define)g(TRANSFER\(SRC,)f
(N\))i(\(memcpy\(dest,)e(\(SRC\),)i(\(N\)\),)g(dest)g(+=)g(\(N\)\))215
1088 y Fo(h)p Fn(tr)n(ansfer)14 b Fr(n)g Fn(bytes)h(fr)n(om)f
Fr(start)g Fp(400c)p Fo(i)215 1137 y Fr(#undef)20 b(TRANSFER)171
1187 y(})129 1239 y Fp(De\014nes:)171 1279 y Fl(block_copy)o
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(401c)g(and)g(402a.)129
1318 y(Uses)i Fl(RBlock)p Fp(.)-29 1401 y(400c)88 b Fo(h)p
Fn(tr)n(ansfer)14 b Fr(n)h Fn(bytes)g(fr)n(om)f Fr(start)g
Fp(400c)p Fo(i)o(\021)701 b Fp(\(400\))171 1451 y Fr({)22
b(Buffer)e(buf;)215 1501 y(unsigned)g(char)h(*p;)215
1551 y(for)g(\(buf)g(=)g(buffer_at_lc\(rb,)e(start\),)h(p)i(=)f
(buf->data)f(+)i(\(start)e(-)i(buf->datalc\);)324 1600
y(buf)f(&&)g(\(n)g(>)h(0\);)324 1650 y(buf)f(=)g(buf->next,)f(p)i(=)f
(buf)g(?)h(buf->data)e(:)h(p)302 1700 y(\))g({)258 1750
y(unsigned)f(blk_size)g(=)i(min\(buf->limit)d(-)i(p,)h(n\);)258
1800 y(TRANSFER\(p,)e(blk_size\);)258 1849 y(n)i(-=)f(blk_size;)215
1899 y(})215 1949 y(assert\(n)f(==)h(0\);)171 1999 y(})129
2051 y Fp(Uses)12 b Fl(Buffer)e Fp(381,)g Fl(min)h Fp(410,)f(and)h
Fl(next)f Fp(399c.)-33 2142 y(400d)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)745 b Fp(\(410\))22
b Fm(/)5 b Fp(400b)22 b(401a)5 b Fm(.)171 2192 y Fr(void)21
b(block_write\(fd,)e(rb,)i(start,)f(n\))i(RBlock)e(rb;)h(unsigned)g
(start,)f(n;)i({)215 2242 y(#define)e(TRANSFER\(SRC,)f(N\))i
(\(write\(fd,)f(SRC,)h(N\)\))215 2291 y Fo(h)p Fn(tr)n(ansfer)14
b Fr(n)g Fn(bytes)h(fr)n(om)f Fr(start)g Fp(400c)p Fo(i)215
2341 y Fr(#undef)20 b(TRANSFER)171 2391 y(})129 2443
y Fp(Uses)12 b Fl(RBlock)p Fp(.)p eop
%%Page: 401 401
401 400 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(401)208 258 y(Searc)o(hing)12 b(for)f(a)g
(bu\013er)i(is)f(easy)m(.)17 b(W)m(e)12 b(lo)q(ok)e(either)j(from)d
(the)i(curren)o(t)i(bu\013er)e(or)g(from)145 307 y(the)g(\014rst)h
(bu\013er,)f(dep)q(ending)g(on)g(whether)g(w)o(e'v)o(e)g(already)f(o)o
(v)o(ershot.)18 b(If)11 b(the)h(p)q(oin)o(t)f(w)o(e're)145
357 y(lo)q(oking)j(for)h(is)g(on)g(the)h(b)q(oundary)f(b)q(et)o(w)o
(een)i(t)o(w)o(o)e(bu\013ers,)h(w)o(e)g(return)g(the)g(\014rst)g
(bu\013er,)145 407 y(b)q(ecause)j(if)d(this)h(p)q(oin)o(t)f(is)h(at)f
(the)i(v)o(ery)f(end)g(of)f(the)i(con)o(ten)o(ts,)g(there)g(migh)o(t)d
(not)h(b)q(e)i(a)145 457 y(second)d(bu\013er.)1211 b
Fk(\031Change)14 b(#6)-15 519 y Fp(401a)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)747 b Fp(\(410\))22
b Fm(/)5 b Fp(400d)22 b(401c)5 b Fm(.)187 569 y Fr(static)20
b(Buffer)h(buffer_at_lc\(rb,)d(start\))j(RBlock)f(rb;)i(unsigned)e
(start;)g({)230 619 y(Buffer)h(b)h(=)f(rb->curbuf;)230
669 y(if)h(\(start)e(<)i(b->datalc\))274 718 y(b)g(=)f(&rb->firstbuf;)
230 768 y(assert\(start)f(>=)h(b->datalc\);)230 818 y(while)g(\(b)h(&&)
f(start)g(>)g(b->datalc)f(+)i(\(b->limit)e(-)h(b->data\)\))274
868 y(b)h(=)f(b->next;)230 918 y(assert\(b\);)230 967
y(return)g(b;)187 1017 y(})145 1069 y Fp(Uses)12 b Fl(Buffer)e
Fp(381,)g Fl(next)g Fp(399c,)h(and)f Fl(RBlock)p Fp(.)-17
1152 y(401b)88 b Fo(h)p Fn(lo)n(c)n(al)15 b(de)n(clar)n(ations)f
Fp(385c)p Fo(i)o Fv(+)p Fo(\021)630 b Fp(\(410\))22 b
Fm(/)5 b Fp(398c)22 b(402d)5 b Fm(.)187 1202 y Fr(static)20
b(Buffer)h(buffer_at_lc\(RBlo)o(ck)e(rb,)i(unsigned)f(start\);)145
1254 y Fp(Uses)12 b Fl(Buffer)e Fp(381)g(and)h Fl(RBlock)p
Fp(.)208 1324 y Fv(I)i(assume)g(an)g(e\016cien)o(t)h(fetc)o(h)h(isn't)e
(needed,)h(since)h(the)f(only)f(thing)g(I'm)e(using)j(it)f(for)145
1374 y(so)18 b(far)g(is)f(to)h(sim)o(ulate)e(relo)q(cation)i(in)f(the)i
(st)o(yle)f(of)f(GNU)h(BFD.)f(F)m(or)h(that)f(reason,)i(I)145
1424 y(implemen)o(t)11 b(fetc)o(h)k(using)e Fr(block_copy)p
Fv(.)-13 1486 y Fp(401c)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)747 b Fp(\(410\))22
b Fm(/)5 b Fp(401a)22 b(402a)5 b Fm(.)187 1536 y Fr(unsigned)20
b(long)h(block_fetchl\(rb,)d(lc,)k(n\))274 1586 y(RBlock)f(rb;)g
(unsigned)f(lc;)h(unsigned)f(n;)187 1636 y({)230 1686
y(unsigned)h(char)f(bytes[8];)230 1735 y(unsigned)h(long)f(val)i(=)f
(0;)230 1785 y(assert\(n)g(<=)g(sizeof\(bytes\)\);)230
1835 y(block_copy\(bytes,)e(rb,)i(lc,)g(n\);)230 1885
y Fo(h)p Fn(c)n(onvert)15 b Fr(n)g Fn(bytes)g(of)g Fr(bytes)f
Fn(into)h Fr(val)f Fn(\(little-endian\))g Fp(402b)p Fo(i)230
1935 y Fr(return)21 b(val;)187 1985 y(})145 2036 y Fp(De\014nes:)187
2076 y Fl(block_fetc)o(hl)p Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(403a.)
145 2115 y(Uses)i Fl(block_copy)c Fp(400b,)i Fl(lc)h
Fp(396b,)f(and)h Fl(RBlock)p Fp(.)p eop
%%Page: 402 402
402 401 bop 129 141 a Fv(402)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(402a)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)749 b Fp(\(410\))22
b Fm(/)5 b Fp(401c)22 b(403a)5 b Fm(.)171 307 y Fr(unsigned)20
b(long)h(block_fetchb\(rb,)e(lc,)i(n\))258 357 y(RBlock)g(rb;)g
(unsigned)f(lc;)h(unsigned)f(n;)171 407 y({)215 457 y(unsigned)g(char)h
(bytes[8];)215 507 y(unsigned)f(long)h(val;)215 557 y(assert\(n)f(<=)h
(sizeof\(bytes\)\);)215 606 y(block_copy\(byte)o(s,)e(rb,)i(lc,)g(n\);)
215 656 y Fo(h)p Fn(c)n(onvert)15 b Fr(n)f Fn(bytes)h(of)g
Fr(bytes)f Fn(into)h Fr(val)f Fn(\(big-endian\))h Fp(402c)p
Fo(i)215 706 y Fr(return)20 b(val;)171 756 y(})129 808
y Fp(De\014nes:)171 847 y Fl(block_fetc)o(hb)p Fp(,)8
b(used)j(in)g(c)o(h)o(unk)f(403a.)129 887 y(Uses)i Fl(block_copy)c
Fp(400b,)i Fl(lc)h Fp(396b,)g(and)f Fl(RBlock)p Fp(.)-33
978 y(402b)88 b Fo(h)p Fn(c)n(onvert)15 b Fr(n)g Fn(bytes)g(of)g
Fr(bytes)f Fn(into)h Fr(val)f Fn(\(little-endian\))g
Fp(402b)p Fo(i)o(\021)309 b Fp(\(401c\))171 1028 y Fr(val)21
b(=)h(0;)171 1077 y(switch)f(\(n\))g({)215 1127 y(#define)f(BYTE\(N\))g
(case)h(N+1:)g(val)g(|=)h(bytes[N])e(<<)h(8*N;)g(/*)h(fall)f(through)f
(*/)215 1177 y(BYTE\(7\))g(BYTE\(6\))g(BYTE\(5\))h(BYTE\(4\))f
(BYTE\(3\))g(BYTE\(2\))h(BYTE\(1\))f(BYTE\(0\))215 1227
y(#undef)g(BYTE)215 1277 y(case)h(0:)g(/*)g(do)h(nothing)e(*/)258
1327 y(break;)215 1376 y(default:)g(assert\(\("unsigne)o(d)f(long)i
(bigger)f(than)h(8)h(bytes",)e(0\)\);)171 1426 y(})-29
1518 y Fp(402c)88 b Fo(h)p Fn(c)n(onvert)15 b Fr(n)g
Fn(bytes)g(of)g Fr(bytes)f Fn(into)h Fr(val)f Fn(\(big-endian\))h
Fp(402c)p Fo(i)o(\021)341 b Fp(\(402a\))171 1567 y Fr(switch)21
b(\(n\))g({)215 1617 y(#define)f(B\(POS,)g(N\))i(\(bytes[POS])d(<<)j
(8*N\))215 1667 y(case)f(0:)g(break;)215 1717 y(case)g(1:)g(val)g(=)h
(B\(0,0\);)e(break;)215 1767 y(case)h(2:)g(val)g(=)h(B\(0,1\))e(|)i
(B\(1,0\);)e(break;)215 1816 y(case)h(3:)g(val)g(=)h(B\(0,2\))e(|)i
(B\(1,1\))e(|)i(B\(2,0\);)e(break;)215 1866 y(case)h(4:)g(val)g(=)h
(B\(0,3\))e(|)i(B\(1,2\))e(|)i(B\(2,1\))e(|)i(B\(3,0\);)e(break;)215
1916 y(case)h(5:)g(val)g(=)h(B\(0,4\))e(|)i(B\(1,3\))e(|)i(B\(2,2\))e
(|)i(B\(3,1\))f(|)g(B\(4,0\);)g(break;)215 1966 y(case)g(6:)g(val)g(=)h
(B\(0,5\))e(|)i(B\(1,4\))e(|)i(B\(2,3\))e(|)i(B\(3,2\))f(|)g(B\(4,1\))g
(|)g(B\(5,0\);)g(break;)215 2016 y(case)g(7:)g(val)g(=)h(B\(0,6\))e(|)i
(B\(1,5\))e(|)i(B\(2,4\))e(|)i(B\(3,3\))f(|)g(B\(4,2\))g(|)g(B\(5,1\))g
(|)g(B\(6,0\);)g(break;)215 2065 y(case)g(8:)g(val)g(=)h(B\(0,7\))e(|)i
(B\(1,6\))e(|)i(B\(2,5\))e(|)i(B\(3,4\))f(|)g(B\(4,3\))g(|)g(B\(5,2\))g
(|)g(B\(6,1\))g(|)h(B\(7,0\);)389 2115 y(break;)215 2165
y(default:)e(assert\(\("unsigne)o(d)f(long)i(bigger)f(than)h(8)h
(bytes",)e(0\)\);)215 2215 y(#undef)g(B)171 2265 y(})-33
2356 y Fp(402d)88 b Fo(h)p Fn(lo)n(c)n(al)15 b(de)n(clar)n(ations)g
Fp(385c)p Fo(i)n Fv(+)q Fo(\021)629 b Fp(\(410\))22 b
Fm(/)5 b Fp(401b)22 b(406c)5 b Fm(.)171 2406 y Fr(static)21
b(unsigned)f(long)h(initial_block_fe)o(tchm)o(\(RBlo)o(ck)e(rb,)i
(unsigned)f(lc,)h(unsigned)f(size\);)129 2458 y Fp(Uses)12
b Fl(initial_blo)o(ck_)o(fe)o(tch)o(m)d Fp(403a)h(403a,)g
Fl(lc)h Fp(396b,)f(and)h Fl(RBlock)p Fp(.)p eop
%%Page: 403 403
403 402 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(403)-15 258 y Fp(403a)88 b Fo(h)p
Fn(de\014nitions)16 b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)747
b Fp(\(410\))22 b Fm(/)5 b Fp(402a)22 b(404a)5 b Fm(.)187
307 y Fr(static)20 b(unsigned)g(long)h(initial_block_fetchm)o(\(rb,)d
(lc,)j(size\))383 357 y(RBlock)f(rb;)i(unsigned)e(lc;)h(unsigned)f
(size;)187 407 y({)230 457 y(static)h(union)g({)g(unsigned)f(u;)i
(unsigned)e(char)h(c[sizeof\(unsigned)o(\)];)e(})i(u)h(=)f({)h
(0xaabbccdd)e(};)230 507 y(switch)h(\(u.c[0]\))f({)274
557 y(case)h(0xaa:)g(block_fetchm)e(=)j(&block_fetchb;)c(break;)274
606 y(case)j(0xdd:)g(block_fetchm)e(=)j(&block_fetchl;)c(break;)274
656 y(default:)64 b(assert\(\("byte-or)o(der)19 b(botch",)h(0\)\);)230
706 y(})230 756 y(return)h(\(*block_fetchm\)\(r)o(b,)e(lc,)i(size\);)
187 806 y(})187 855 y(unsigned)f(long)h(\(*block_fetchm\)\(R)o(Block)d
(rb,)j(unsigned)f(lc,)i(unsigned\))e(=)h(&initial_block_fet)o(chm;)145
907 y Fp(De\014nes:)187 947 y Fl(initial_bl)o(ock)o(_f)o(etc)o(hm)p
Fp(,)8 b(used)j(in)g(c)o(h)o(unk)f(402d.)145 986 y(Uses)i
Fl(block_fetc)o(hb)c Fp(402a,)j Fl(block_fet)o(chl)d
Fp(401c,)i Fl(lc)h Fp(396b,)f(and)h Fl(RBlock)p Fp(.)145
1144 y Fj(23.2)66 b(Lab)r(els)-17 1235 y Fp(403b)88 b
Fo(h)p Fn(exp)n(orte)n(d)15 b(data)h(de)n(clar)n(ations)e
Fp(381)p Fo(i)o Fv(+)q Fo(\021)461 b Fp(\(409b\))22 b
Fm(/)5 b Fp(399d)22 b(406a)5 b Fm(.)187 1285 y Fr(struct)20
b(label)h({)274 1335 y(RBlock)g(block;)274 1385 y(unsigned)f(offset;)
274 1434 y(char)h(*name;)187 1484 y(};)145 1536 y Fp(Uses)12
b Fl(label)e Fp(383a)g(and)h Fl(RBlock)p Fp(.)208 1607
y Fr(label_location_)o(known)g Fv(is)j(true)h(if)f(the)h(giv)o(en)f
(lab)q(el)g(is)g(lo)q(cated)h(in)f(a)g(relo)q(catable)145
1656 y(blo)q(c)o(k)20 b(with)f(a)h(kno)o(wn)f(address.)37
b Fr(label_location)17 b Fv(returns)22 b(the)e(absolute)g(address)145
1706 y(of)g(the)g(lab)q(el,)h(if)e(it)g(is)h(kno)o(wn.)36
b(If)19 b(the)i(address)g(is)f(unkno)o(wn,)h Fr(label_location)c
Fv(is)145 1756 y(unde\014ned.)36 b Fr(cur_pc_known)16
b Fv(and)j Fr(cur_pc)f Fv(are)i(analogous)e(macros)g(for)h(the)h
(curren)o(t)145 1806 y(program)12 b(coun)o(ter)i Fr(pc)p
Fv(;)e Fr(pc_location_known)d Fv(and)k Fr(pc_location)e
Fv(are)i(simliar)e(but)i(are)145 1856 y(applied)h(to)f(the)i(lo)q
(cation)e(of)g(a)h(closure.)-13 1918 y Fp(403c)88 b Fo(h)p
Fn(exp)n(orte)n(d)15 b(macr)n(o)g(de\014nitions)h Fp(384b)p
Fo(i)n Fv(+)q Fo(\021)554 b Fp(\(409b\))21 b Fm(/)6 b
Fp(400a)187 1968 y Fr(#define)20 b(label_location_kno)o(wn\(lb)o(l\))41
b(\(\(\(lbl\))20 b(&&)h(\(lbl\)->block->known)o(.addr)o(ess\))o(\))187
2018 y(#define)f(label_location\(lbl)o(\))172 b(\(\(lbl\)->block->)o
(addre)o(ss)19 b(+)i(\(lbl\)->offset\))187 2067 y(#define)f
(pc_location_known\()o(loc\))106 b(\(\(loc\).dest_blo)o(ck->k)o(nown.)o
(addre)o(ss\))187 2117 y(#define)20 b(pc_location\(loc\))237
b(\(\(loc\).dest_blo)o(ck->a)o(ddres)o(s)19 b(+)j(\(loc\).dest_lc\))187
2167 y(#define)e(cur_pc_known\(\))281 b(\(currb->known.a)o(ddres)o(s\))
187 2217 y(#define)20 b(cur_pc\(\))413 b(\(currb->address)18
b(+)k(lc\(\)\))145 2269 y Fp(De\014nes:)187 2308 y Fl(cur_pc)p
Fp(,)9 b(used)i(in)g(c)o(h)o(unks)f(329,)g(342d,)g(and)h(412a.)187
2348 y Fl(cur_pc_kno)o(wn)p Fp(,)d(used)j(in)g(c)o(h)o(unks)f(329d)g
(and)h(412a.)187 2387 y Fl(pc_locatio)o(n)p Fp(,)d(used)j(in)g(c)o(h)o
(unk)f(342d.)145 2426 y(Uses)i Fl(address)d Fp(383a,)h
Fl(currb)g Fp(385e,)h(and)f Fl(lc)h Fp(396b.)p eop
%%Page: 404 404
404 403 bop 129 141 a Fv(404)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y Fr(label_define)d Fv(de\014nes)k(lab)q
(el)e Fr(lbl)g Fv(at)g(the)h(curren)o(t)h(lo)q(cation)e(coun)o(ter)h
(plus)g Fr(offset)129 307 y Fv(in)f(the)h(curren)o(t)g(relo)q(catable)g
(blo)q(c)o(k.)k Fr(label_define_at)9 b Fv(is)j(a)g(more)f(general)h(op)
q(eration.)-31 370 y Fp(404a)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)745 b Fp(\(410\))22
b Fm(/)5 b Fp(403a)23 b(404b)t Fm(.)171 420 y Fr(void)e
(label_define\(lbl,)d(offset\))j(RLabel)f(lbl;)h(int)g(offset;)g({)258
469 y(label_define_at\(lb)o(l,)e(currb,)h(lc\(\))h(+)h(offset\);)171
519 y(})171 569 y(void)f(label_define_at\(l)o(bl,)e(block,)h(lc\))h
(RLabel)g(lbl;)g(RBlock)f(block;)h(unsigned)f(lc;)h({)258
619 y(assert\(lbl\);)258 669 y(assert\(!block_defi)o(ned\(l)o(bl->b)o
(lock\))o(\);)40 b(/*)22 b(fail)f(on)g(multiple)f(definition)g(*/)258
718 y(lbl->block)g(=)h(block;)258 768 y(lbl->offset)f(=)h(lc;)171
818 y(})129 870 y Fp(Uses)12 b Fl(block_defin)o(ed)c
Fp(398b,)i Fl(currb)g Fp(385e,)h Fl(fail)f Fp(410,)g
Fl(lc)h Fp(396b,)f Fl(RBlock)p Fp(,)g(and)g Fl(RLabel)p
Fp(.)192 932 y Fr(label_new)i Fv(returns)j(a)f(new)g(lab)q(el.)-33
994 y Fp(404b)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)747 b Fp(\(410\))22 b Fm(/)5 b
Fp(404a)22 b(407a)5 b Fm(.)171 1044 y Fr(RLabel)21 b(label_new\(name\))
d(char)j(*name;)g({)258 1094 y(RLabel)g(lbl;)258 1194
y(lbl)g(=)h(\(RLabel\))e(mc_alloc\(sizeof\(*l)o(bl\),)e(RLabel_pool\);)
258 1244 y(lbl->block)i(=)h(&undefrblock;)258 1293 y(lbl->name)f(=)i
(name;)258 1343 y(return)f(lbl;)171 1393 y(})129 1445
y Fp(De\014nes:)171 1484 y Fl(label_new)p Fp(,)8 b(used)j(in)g(c)o(h)o
(unk)f(383b.)129 1524 y(Uses)i Fl(RLabel)e Fp(and)g Fl(undefrblock)e
Fp(398c.)p eop
%%Page: 405 405
405 404 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(405)145 258 y Fj(23.3)66 b(Relo)r(cation)23
b(and)g(closures)145 349 y Fv(Closures)17 b(are)f(implem)o(en)o(ted)e
(in)h(a)g(t)o(w)o(o-lev)o(el)g(structure.)25 b Fr(ClosureHeader)13
b Fn(The)k(sp)n(e)n(ci-)145 398 y(\014c)n(ation)g(ne)n(e)n(ds)g(to)f(b)
n(e)g(r)n(evise)n(d.)22 b(Me)n(anwhile,)16 b(ther)n(e's)g(a)g
(two-level)f(structur)n(e.)22 b Fr(CHeader)145 448 y
Fn(shows)e(the)f(he)n(ader)h(of)f(a)g(c)n(onstructor,)h(which)f(r)n
(etains)g(a)h(tag)f(and)h(inputs)g(until)f(they)145 498
y(ar)n(e)d(to)g(b)n(e)f(use)n(d)i(in)f(an)g(instruction.)21
b Fr(RClosure)15 b Fn(is)g(the)h(r)n(elo)n(c)n(ation)f(closur)n(e,)h
(which)f(de-)145 548 y(lays)d(evaluation)h(until)f(lab)n(els)g
(\(including)h(those)f(neste)n(d)h(inside)f(c)n(onstructor)g(inputs\))h
(ar)n(e)145 598 y(known.)208 647 y(With)19 b(neste)n(d)h(c)n
(onstructors,)g(the)f(simple)g(arr)n(ay)g(scheme)h(won)l('t)f(work)g
(any)h(mor)n(e,)145 697 y(and)15 b(we)f(wil)r(l)f(ne)n(e)n(d)h(to)g
(emit)g(lab)n(el-lo)n(c)n(ating)f(functions)i(for)f(e)n(ach)g(c)n
(onstructor)g(typ)n(e)g(\(with)145 747 y(c)n(al)r(lb)n(acks\).)19
b(Similarly)14 b(for)g(PCs.)2 809 y Fp(405)89 b Fo(h)p
Fn(C)15 b(emitter)f(sp)n(e)n(c)h Fp(405)p Fo(i)o(\021)940
b Fp(\(406a\))187 859 y Fr(typedef)20 b(void)h(\(*RelocCallback\)\(v)o
(oid)e(*closure,)g(RAddr)i(reloc\);)187 909 y(typedef)f(void)h
(\(*RelocEnumerator\))o(\(stru)o(ct)e(rclosure)h(*cp,)h(RelocCallback)e
(f,)i(void)g(*closure\);)187 1009 y(typedef)f(struct)h(instance)f({)274
1058 y(int)h(tag;)195 b(/*)22 b(need)f(at)g(least)g(11)g(bits)g(for)g
(Intel)g(*/)274 1108 y(union)g({)g(struct)g({)g(void)g(*inputs[1];)f(})
i(consname;)d(})j(u;)187 1158 y(})f(Instance;)145 1210
y Fp(De\014nes:)187 1249 y Fl(Instance)p Fp(,)9 b(used)h(in)h(c)o(h)o
(unks)f(211d,)g(343b,)g(and)h(344a.)187 1289 y Fl(RelocCallb)o(ack)o
Fp(,)e(used)h(in)h(c)o(h)o(unk)f(211.)187 1328 y Fl(RelocEnume)o(rat)o
(or)o Fp(,)f(used)i(in)g(c)o(h)o(unk)f(406a.)145 1368
y(Uses)i Fl(RAddr)e Fp(411a.)p eop
%%Page: 406 406
406 405 bop 129 141 a Fv(406)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(406a)88 b Fo(h)p Fn(exp)n(orte)n(d)16
b(data)f(de)n(clar)n(ations)f Fp(381)p Fo(i)p Fv(+)p
Fo(\021)459 b Fp(\(409b\))22 b Fm(/)5 b Fp(403b)23 b(406b)t
Fm(.)171 307 y Fo(h)p Fn(C)15 b(emitter)e(sp)n(e)n(c)i
Fp(405)p Fo(i)171 357 y Fr(typedef)20 b(void)h(\(*ApplyMethod\)\(RClo)o
(sure)d(cl,)j(Emitter)g(emitter,)f(FailCont)g(fail\);)171
457 y(typedef)g(struct)h(closure_header)e({)258 507 y(ApplyMethod)h
(apply;)258 557 y(RelocEnumerator)f(relocfn;)258 606
y(int)i(uses_pc;)258 656 y(int)g(size_in_bytes;)171 706
y(})h(*ClosureHeader;)149 b(/*)21 b(always)g(allocated)f(statically)g
(*/)171 806 y(typedef)g(struct)h(closure_location)d({)258
855 y(RBlock)j(dest_block;)172 b(/*)21 b(block)g(written)f(*/)258
905 y(unsigned)g(dest_lc;)195 b(/*)21 b(location)f(within)h(block)g(to)
g(write)g(*/)171 955 y(})h(ClosureLocation)o(;)171 1055
y(struct)f(rclosure)f({)258 1104 y(ClosureHeader)f(h;)258
1154 y(ClosureLocation)g(loc;)258 1204 y(/*)j(fields)e(may)h(follow)g
(*/)171 1254 y(};)129 1306 y Fp(De\014nes:)171 1345 y
Fl(ApplyMetho)o(d)p Fp(,)9 b(used)h(in)h(c)o(h)o(unks)f(226)h(and)f
(406b.)171 1385 y Fl(ClosureHea)o(der)o Fp(,)f(used)h(in)i(c)o(h)o
(unks)d(208b,)i(407,)f(and)h(408.)171 1424 y Fl(ClosureLoc)o(ati)o(on)p
Fp(,)d(used)j(in)g(c)o(h)o(unk)f(208b.)129 1464 y(Uses)17
b Fl(apply)d Fp(278,)h Fl(Emitter)p Fp(,)f Fl(fail)h
Fp(410,)g Fl(FailCont)p Fp(,)e Fl(location)p Fp(,)g Fl(RBlock)p
Fp(,)h Fl(RClosure)p Fp(,)171 1503 y Fl(RelocEnume)o(rat)o(or)8
b Fp(405)j(405,)g(and)f Fl(uses_pc)f Fp(210b.)192 1574
y Fv(In)16 b(order)i(to)e(b)q(e)i(able)e(to)h(exp)q(ort)g(closures)h
(to)f(disk,)g(w)o(e)g(need)g(to)g(b)q(e)g(able)g(to)f(map)129
1623 y(the)e(closure)f(functions)g(in)o(to)f(some)g(other)h(represen)o
(tation.)20 b(F)m(or)12 b(the)h(momen)o(t,)d(w)o(e)j(use)h(a)129
1673 y(bastard)h(form)d(of)h(P)o(ostScript.)-33 1735
y Fp(406b)88 b Fo(h)p Fn(exp)n(orte)n(d)16 b(data)f(de)n(clar)n(ations)
f Fp(381)p Fo(i)p Fv(+)p Fo(\021)581 b Fp(\(409b\))21
b Fm(/)6 b Fp(406a)171 1785 y Fr(typedef)20 b(struct)h(closurepostfix)e
({)258 1835 y(ApplyMethod)h(apply;)258 1885 y(char)h(*postfix;)171
1935 y(})h(ClosurePostfix;)129 1987 y Fp(De\014nes:)171
2026 y Fl(ClosurePos)o(tfi)o(x)p Fp(,)9 b(used)h(in)h(c)o(h)o(unk)f
(226.)129 2065 y(Uses)i Fl(apply)e Fp(278,)h Fl(ApplyMeth)o(od)d
Fp(406a,)j(and)f Fl(postfix)f Fp(16f.)192 2128 y Fv(The)23
b(library)f(pro)o(vides)g(the)i(closure-indep)q(enden)o(t)g(pro)q
(cedure)h Fr(apply_closure)p Fv(.)129 2178 y Fr(apply_closure)9
b Fv(c)o(hec)o(ks)k(that)e(all)f(relo)q(catable)i(blo)q(c)o(ks)g(on)f
(whic)o(h)g(the)h(closure)g(is)g(dep)q(en-)129 2227 y(den)o(t)k(are)g
(kno)o(wn)f(b)q(efore)h(applying)e(the)i(closure-dep)q(enden)o(t)h
Fr(apply)d Fv(pro)q(cedure)k(whic)o(h)129 2277 y(p)q(erforms)c(the)g
(relo)q(cation.)-29 2348 y Fp(406c)88 b Fo(h)p Fn(lo)n(c)n(al)15
b(de)n(clar)n(ations)g Fp(385c)p Fo(i)n Fv(+)q Fo(\021)629
b Fp(\(410\))22 b Fm(/)5 b Fp(402d)22 b(408e)5 b Fm(.)171
2398 y Fr(static)21 b(void)f(fail_if_undef\(void)f(*,)i(RAddr\);)129
2449 y Fp(Uses)12 b Fl(RAddr)e Fp(411a.)p eop
%%Page: 407 407
407 406 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(407)-15 258 y Fp(407a)88 b Fo(h)p
Fn(de\014nitions)16 b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)743
b Fp(\(410\))22 b Fm(/)5 b Fp(404b)22 b(407b)5 b Fm(.)187
307 y Fr(static)20 b(void)h(fail_if_undef\(void)d(*closure,)i(RAddr)h
(a\))g({)274 357 y(if)g(\(!location_known\(a\))o(\))339
407 y(\(\(FailCont\)closure\))o(\("Lab)o(el)e(\045s)i(undefined)f(or)h
(unbound",)f(a->label->name\);)187 457 y(})145 559 y
Fp(Uses)12 b Fl(FailCont)p Fp(,)d Fl(label)h Fp(383a,)g
Fl(location_k)o(now)o(n)p Fp(,)e(and)j Fl(RAddr)f Fp(411a.)-17
650 y(407b)88 b Fo(h)p Fn(de\014nitions)16 b Fp(385a)p
Fo(i)o Fv(+)p Fo(\021)747 b Fp(\(410\))22 b Fm(/)5 b
Fp(407a)22 b(408a)5 b Fm(.)187 700 y Fr(void)21 b(apply_closure\(RC)o
(losur)o(e)e(cl,)i(Emitter)g(emitter,)f(FailCont)g(fail\))h({)274
750 y(\(*cl->h->relocfn\))o(\(cl,)d(&fail_if_undef,)h(\(void*\)fail\);)
274 799 y(\(*cl->h->apply\)\(c)o(l,)g(emitter,)h(fail\);)187
849 y(})145 901 y Fp(Uses)12 b Fl(apply)e Fp(278,)g Fl(Emitter)p
Fp(,)g Fl(fail)g Fp(410,)g Fl(FailCont)p Fp(,)f(and)i
Fl(RClosure)p Fp(.)-13 992 y(407c)88 b Fo(h)p Fn(old)15
b(de\014nitions)h Fp(407c)p Fo(i)o(\021)187 1042 y Fr(void)21
b(apply_closure\(RC)o(losur)o(e)e(cl,)i(Emitter)g(emitter,)f(FailCont)g
(fail\))h({)274 1092 y(int)g(n)h(=)f(cl->t.depends_count)o(;)274
1142 y(RLabel)g(*p)g(=)g(&cl->s.depends[0];)274 1241
y(if)g(\(cl->t.depends_on_d)o(est)e(&&)i(!location_known\(c)o(l->t.)o
(dest_)o(block)o(->lab)o(el\)\))361 1291 y(\(*fail\)\("Destinati)o(on)e
(\045s)i(undefined)f(or)h(unbound",)f(cl->t.dest_block->l)o(abel-)o
(>name)o(\);)274 1341 y(while)h(\(n--)g(>)g(0\))361 1391
y(if)h(\(location_known)o(\(*p\)\))448 1441 y(p++;)361
1491 y(else)448 1540 y(\(*fail\)\("Label)d(\045s)j(undefined)e(or)h
(unbound",\(*p\)->na)o(me\);)274 1590 y(\(*cl->t.apply\)\(cl)o(,)e
(emitter,)h(fail\);)187 1640 y(})145 1692 y Fp(Uses)14
b Fl(apply)d Fp(278,)h Fl(Emitter)p Fp(,)f Fl(fail)h
Fp(410,)g Fl(FailCont)p Fp(,)e Fl(label)i Fp(383a,)g
Fl(location_k)o(now)o(n)p Fp(,)e Fl(RClosure)p Fp(,)187
1731 y(and)g Fl(RLabel)p Fp(.)208 1802 y Fv(T)m(o)i(help)i(reduce)h(co)
q(de)f(bloat)f(in)g(generated)i(enco)q(ding)f(pro)q(cedures,)h(here)g
(is)e(a)g(func-)145 1852 y(tion)h(that)g(allo)q(cates)f(and)h
(initializes)f(a)g(closure:)-17 1914 y Fp(407d)88 b Fo(h)p
Fn(exp)n(orte)n(d)15 b(pr)n(o)n(c)n(e)n(dur)n(e)g(de)n(clar)n(ations)g
Fp(386a)p Fo(i)n Fv(+)q Fo(\021)353 b Fp(\(409b\))22
b Fm(/)5 b Fp(386a)22 b(408b)5 b Fm(.)187 1964 y Fr(extern)20
b(RClosure)g(mc_create_closure_at)o(_offs)o(et\(u)o(nsign)o(ed)f(size,)
i(ClosureHeader)e(h,)i(unsigned)f(offset\);)145 2016
y Fp(Uses)12 b Fl(ClosureHea)o(der)c Fp(406a,)i Fl(mc_create_c)o(los)o
(ure)o(_a)o(t_o)o(ffs)o(et)e Fp(408a,)i(and)h Fl(RClosure)p
Fp(.)p eop
%%Page: 408 408
408 407 bop 129 141 a Fv(408)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)-31 258 y Fp(408a)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)747 b Fp(\(410\))22
b Fm(/)5 b Fp(407b)22 b(408c)5 b Fm(.)171 307 y Fr(RClosure)20
b(mc_create_closure_)o(at_of)o(fset\()o(unsi)o(gned)e(size,)j
(ClosureHeader)e(h,)j(unsigned)e(offset\))g({)215 357
y(RBlock)64 b(this_block)19 b(=)j(crb\(\);)215 407 y(unsigned)e
(this_lc)85 b(=)22 b(lc\(\))f(+)h(offset;)215 457 y(RClosure)e(c)h(=)h
(\(RClosure\))e(mc_alloc_closur)o(e\(siz)o(e,)f(this_block,)g
(this_lc\);)215 507 y(c->h)i(=)g(h;)215 557 y(c->loc.dest_blo)o(ck)e(=)
i(this_block;)215 606 y(c->loc.dest_lc)84 b(=)21 b(this_lc;)215
656 y(return)f(c;)171 706 y(})129 758 y Fp(De\014nes:)171
797 y Fl(mc_create_)o(clo)o(sur)o(e_a)o(t_)o(off)o(set)o
Fp(,)9 b(used)h(in)i(c)o(h)o(unks)d(206a,)i(407d,)f(and)g(408c.)129
837 y(Uses)i Fl(ClosureHead)o(er)c Fp(406a,)i Fl(crb)h
Fp(384a,)f Fl(lc)h Fp(396b,)f Fl(mc_alloc_cl)o(osu)o(re)p
Fp(,)e Fl(RBlock)p Fp(,)i(and)g Fl(RClosure)p Fp(.)129
907 y Fv(T)m(o)k(sa)o(v)o(e)g(passing)f(a)h(parameter)f(in)h(the)g
(common)d(case,)k(here's)g(a)e(sp)q(ecialized)i(v)o(ersion:)-33
970 y Fp(408b)88 b Fo(h)p Fn(exp)n(orte)n(d)16 b(pr)n(o)n(c)n(e)n(dur)n
(e)e(de)n(clar)n(ations)h Fp(386a)p Fo(i)n Fv(+)q Fo(\021)471
b Fp(\(409b\))22 b Fm(/)5 b Fp(407d)171 1019 y Fr(extern)21
b(RClosure)f(mc_create_closur)o(e_her)o(e\(un)o(signe)o(d)f(size,)i
(ClosureHeader)e(h\);)129 1071 y Fp(Uses)12 b Fl(ClosureHead)o(er)c
Fp(406a,)i Fl(mc_create_c)o(los)o(ure)o(_he)o(re)e Fp(408c,)i(and)h
Fl(RClosure)p Fp(.)-29 1154 y(408c)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)745 b Fp(\(410\))22
b Fm(/)5 b Fp(408a)23 b(408d)t Fm(.)171 1204 y Fr(RClosure)d
(mc_create_closure_)o(here\()o(unsig)o(ned)e(size,)j(ClosureHeader)e
(h\))j({)215 1254 y(return)e(mc_create_closure_)o(at_of)o(fset\()o
(size)o(,)f(h,)i(0\);)171 1304 y(})129 1356 y Fp(De\014nes:)171
1395 y Fl(mc_create_)o(clo)o(sur)o(e_h)o(er)o(e)p Fp(,)9
b(used)h(in)h(c)o(h)o(unks)f(205c)h(and)f(408b.)129 1434
y(Uses)i Fl(ClosureHead)o(er)c Fp(406a,)i Fl(mc_create_c)o(los)o(ure)o
(_at)o(_of)o(fs)o(et)f Fp(408a,)h(and)g Fl(RClosure)p
Fp(.)129 1593 y Fj(23.4)66 b(Supp)r(ort)24 b(for)e(prin)n(ting)j(relo)r
(catable)e(addresses)-33 1683 y Fp(408d)88 b Fo(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)749 b Fp(\(410\))22
b Fm(/)5 b Fp(408c)22 b(409a)5 b Fm(.)171 1733 y Fr(static)21
b(void)f(label_print\(struct)f(label)h(*label\))h({)215
1783 y(asmprintf\(asmpr)o(intfd)o(,)e("\045s",)i(label->name)e(?)j
(label->name)d(:)j("???"\);)171 1833 y(})129 1885 y Fp(Uses)12
b Fl(asmprintf)d Fp(409a,)h Fl(asmprintfd)e Fp(409a,)i(and)h
Fl(label)f Fp(383a.)-29 1976 y(408e)88 b Fo(h)p Fn(lo)n(c)n(al)15
b(de)n(clar)n(ations)g Fp(385c)p Fo(i)n Fv(+)q Fo(\021)749
b Fp(\(410\))21 b Fm(/)6 b Fp(406c)171 2026 y Fr(static)21
b(void)f(label_print\(struct)f(label)h(*label\);)129
2078 y Fp(Uses)12 b Fl(label)e Fp(383a.)p eop
%%Page: 409 409
409 408 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)766
b Fr(mclib.nw)81 b Fv(409)-15 258 y Fp(409a)88 b Fo(h)p
Fn(de\014nitions)16 b Fp(385a)p Fo(i)o Fv(+)p Fo(\021)862
b Fp(\(410\))22 b Fm(/)6 b Fp(408d)187 307 y Fr(typedef)20
b(void)h(\(*asmprinter\)\(void)d(*closure,)i(const)h(char)g(*fmt,)g
(...\);)187 357 y(extern)f(int)i(fprintf\(FILE)d(*stream,)h(const)h
(char)g(*fmt,)f(...\);)h(/*)h(needed)e(at)i(Purdue)e(--)h(ugh)h(*/)187
407 y(void)f(\(*asmprintf\)\(voi)o(d)e(*closure,)h(const)h(char)g
(*fmt,)f(...\))h(=)h(\(asmprinter\))d(fprintf;)187 457
y(void)i(*asmprintfd)e(=)j(\(void)f(*\)stdout;)187 507
y(void)g(\(*asmprintreloc\))o(\(RAdd)o(r)e(reloc\))i(=)g(reloc_print;)e
(/*)j(calls)f(asmprintf)f(*/)145 559 y Fp(De\014nes:)187
598 y Fl(asmprintf)p Fp(,)8 b(used)j(in)g(c)o(h)o(unks)f(248,)g(322,)h
(and)f(408d.)187 637 y Fl(asmprintfd)o Fp(,)f(used)h(in)i(c)o(h)o(unks)
d(248,)i(251b,)f(322,)g(and)h(408d.)187 677 y Fl(asmprintre)o(loc)o
Fp(,)e(used)h(in)h(c)o(h)o(unks)f(247)h(and)g(322.)145
716 y(Uses)h Fl(RAddr)e Fp(411a.)145 874 y Fj(23.5)66
b(Boilerplate)-17 965 y Fp(409b)88 b Fo(h)p Fn(mclib.h)15
b Fp(409b)p Fo(i)n(\021)187 1015 y Fr(#ifndef)20 b(INCLUDE_MCLIBH)187
1065 y(#define)g(INCLUDE_MCLIBH)187 1165 y(#ifndef)g(assert)187
1214 y(#include)g(<assert.h>)187 1264 y(#endif)187 1364
y(/*)h(this)g(group)g(is)g(available)f(for)h(users)g(*/)187
1463 y Fo(h)p Fn(libr)n(ary)13 b(typ)n(es)i Fp(\(nev)o(er)10
b(de\014ned\))p Fo(i)187 1513 y(h)p Fn(libr)n(ary)j(pr)n(o)n(c)n(e)n
(dur)n(es)i Fp(\(nev)o(er)10 b(de\014ned\))p Fo(i)187
1563 y(h)p Fn(de)n(clar)n(ations)15 b(of)f(pr)n(o)n(c)n(e)n(dur)n(es)h
(pr)n(ovide)n(d)g(by)g(the)g(applic)n(ation)g Fp(\(nev)o(er)10
b(de\014ned\))p Fo(i)187 1663 y Fr(/*)21 b(this)g(group)g(either)f
(supports)h(macros)f(or)i(is)f(needed)f(by)i(emission)e(procedures)g
(*/)187 1762 y Fo(h)p Fn(exp)n(orte)n(d)15 b(data)g(de)n(clar)n(ations)
g Fp(381)p Fo(i)187 1812 y(h)p Fn(exp)n(orte)n(d)g(macr)n(o)g
(de\014nitions)g Fp(384b)p Fo(i)187 1862 y(h)p Fn(exp)n(orte)n(d)g(pr)n
(o)n(c)n(e)n(dur)n(e)f(de)n(clar)n(ations)h Fp(386a)p
Fo(i)187 1962 y Fr(#endif)p eop
%%Page: 410 410
410 409 bop 129 141 a Fv(410)83 b Fr(mclib.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(Note)h(the)h Fr(roundup)d
Fv(macro)h(is)g(go)q(o)q(d)h(only)f(for)g(p)q(o)o(w)o(ers)i(of)e(t)o(w)
o(o.)-13 320 y Fp(410)88 b Fo(h)p Fn(mclib.c)15 b Fp(410)p
Fo(i)o(\021)171 370 y Fr(#include)20 b(<mclib.h>)171
420 y(#include)g(<stdio.h>)171 519 y(#define)g(max\(X,Y\))g(\(\(X\))h
(>)h(\(Y\))f(?)h(\(X\))f(:)h(\(Y\)\))171 569 y(#define)e(min\(X,Y\))g
(\(\(X\))h(<)h(\(Y\))f(?)h(\(X\))f(:)h(\(Y\)\))171 619
y(#define)e(roundup\(X,N\))g(\(\(\(X\)+\(\(N\)-1\)\)&\()o(~\(\(N)o
(\)-1\)\))o(\))171 768 y(static)h(void)f(mcfail\(char)g(*fmt,)h(...\))g
({)215 818 y(assert\(\("applic)o(ation)d(didn't)j(set)g(fail",)f
(0\)\);)43 b(/*)22 b(apps)f(should)f(provide)g(their)h(own)g(*/)171
868 y(})171 918 y(void)g(\(*fail\)\(char)e(*fmt,)i(...\))g(=)h
(&mcfail;)171 1017 y(#define)e(BUFSZ)h(1024)171 1117
y Fo(h)p Fn(lo)n(c)n(al)14 b(de)n(clar)n(ations)h Fp(385c)p
Fo(i)171 1167 y(h)p Fn(de\014nitions)h Fp(385a)p Fo(i)129
1268 y Fp(De\014nes:)171 1308 y Fl(BUFSZ)p Fp(,)10 b(used)g(in)h(c)o(h)
o(unks)f(390e,)g(391a,)h(and)f(398d.)171 1347 y Fl(fail)p
Fp(,)h(used)g(in)h(c)o(h)o(unks)f(29,)h(71a,)f(77{79,)g(85,)h(86,)f
(94,)h(100c,)f(117{20,)f(127,)i(128a,)f(130{33,)f(139c,)212
1387 y(142b,)h(155a,)f(172a,)g(176,)h(177,)f(180,)h(181b,)f(185a,)g
(195,)h(197c,)f(203,)g(209,)h(212,)g(227b,)f(244a,)g(262b,)212
1426 y(263c,)h(266b,)f(273,)g(285b,)g(322,)h(332b,)f(344b,)g(350,)g
(351,)h(354a,)f(363a,)g(365c,)g(404a,)h(406,)f(and)h(407.)171
1466 y Fl(max)p Fp(,)f(used)h(in)g(c)o(h)o(unks)f(15,)h(61,)g(241b,)f
(280a,)g(358,)g(and)h(391a.)171 1505 y Fl(min)p Fp(,)f(used)h(in)g(c)o
(h)o(unks)f(358)h(and)f(400c.)171 1544 y Fl(roundup)p
Fp(,)f(used)i(in)g(c)o(h)o(unk)f(391a.)p eop
%%Page: 411 411
411 410 bop 145 569 a Fq(Chapter)32 b(24)145 777 y Fu(Relo)s(catable)40
b(Addresses)145 992 y Fv(Enco)q(ding)17 b(applications)f(often)h(w)o
(an)o(t)f(to)h(w)o(ork)f(with)h(addresses)h(whose)g(v)n(alues)e(aren't)
145 1042 y(kno)o(wn.)32 b(Common)16 b(examples)h(include)i(calls)g(to)f
(unkno)o(wn)g(pro)q(cedures,)k(or)d(forw)o(ard)145 1092
y(branc)o(hes)14 b(within)e(a)g(pro)q(cedures.)20 b(This)13
b(kind)f(of)g(w)o(ork)g(can)h(b)q(e)h(done)f(with)f(lab)q(els)g(alone,)
145 1142 y(but)20 b(it)e(is)h(more)g(con)o(v)o(enien)o(t)g(to)g(use)h
(a)f(more)f(general)i(abstraction:)28 b(the)20 b Fn(r)n(elo)n(c)n
(atable)145 1192 y(addr)n(ess)p Fv(.)f(In)14 b(its)g(most)f(general)i
(form,)d(a)i(relo)q(catable)g(address)i(is)e(an)f(expression)j(whose)
145 1241 y(v)n(alue)h(dep)q(ends)i(on)f(one)g(or)f(more)g(lab)q(els.)
839 1226 y Ff(1)886 1241 y Fv(Most)h(of)f(the)h(to)q(olkit)e(treats)j
(relo)q(catable)145 1291 y(addresses)d(simply)c(as)i(an)g(abstract)h
(data)e(t)o(yp)q(e:)-15 1354 y Fp(411a)88 b Fo(h)p Fn(libr)n(ary)14
b(typ)n(es)h Fp(411a)p Fo(i)o(\021)187 1403 y Fr(typedef)20
b(struct)h(relocatable_addr)o(ess)e(*RAddr;)145 1455
y Fp(De\014nes:)187 1495 y Fl(RAddr)p Fp(,)10 b(used)g(in)h(c)o(h)o
(unks)f(204a,)g(322,)h(405{7,)f(409a,)g(411,)g(and)h(412.)145
1557 y Fv(The)18 b(op)q(erations)f(a)o(v)n(ailable)e(on)h(a)h(relo)q
(catable)g(address)h(are)g(to)f(see)h(whether)g(it)f(has)g(a)145
1607 y(kno)o(wn)d(v)n(alue,)f(and)g(to)h(extract)h(that)f(v)n(alue:)-17
1669 y Fp(411b)88 b Fo(h)p Fn(faux)16 b(de)n(clar)n(ations)e(of)h(libr)
n(ary)f(macr)n(os)g Fp(411b)p Fo(i)o(\021)559 b Fp(412a)5
b Fm(.)187 1719 y Fr(extern)20 b(int)i(location_known\()o(RAddr)c
(addr\);)187 1769 y(extern)i(unsigned)g(location)h(\(RAddr)f(addr\);)
145 1821 y Fp(Uses)12 b Fl(location)p Fp(,)d Fl(location_)o(kno)o(wn)p
Fp(,)f(and)j Fl(RAddr)f Fp(411a.)145 1883 y Fr(location_known\(addr)o
(\))h Fv(will)h(b)q(e)j(true)f(whenev)o(er)h(all)e(the)h(lab)q(els)g
(on)g(whic)o(h)f Fr(addr)g Fv(de-)145 1933 y(p)q(ends)f(ha)o(v)o(e)f
(kno)o(wn)g(v)n(alues.)16 b(If)11 b(an)f(application)g(writer)h(w)o(an)
o(ts)g(to)g(c)o(hange)g(our)g(represen-)145 1982 y(tation)f(of)f(relo)q
(catable)h(addresses,)j(his)d(only)f(obligation)f(is)i(to)f(pro)o(vide)
h Fr(location_known)145 2032 y Fv(and)k Fr(location)p
Fv(.)p 145 2342 573 2 v 192 2369 a Fc(1)209 2381 y Fp(Note)g(that)g
(our)g(de\014nition)e(is)j(di\013eren)o(t)e(from)g(the)i(more)e
(traditional)f(de\014nition,)h(in)h(whic)o(h,)h(for)145
2420 y(example,)g(the)g(di\013erence)f(of)h(t)o(w)o(o)i(lab)q(els)d(is)
i(tak)o(en)f(to)h(b)q(e)f(an)h(absolute)e(address,)h(not)g(a)h(relo)q
(ctable)145 2460 y(address.)h(This)12 b(traditional)d(de\014nition)h(w)
o(orks)i(only)g(if)g(the)g(t)o(w)o(o)g(lab)q(els)f(are)h(in)g(the)g
(same)f(compilation)145 2499 y(unit.)830 2604 y Fv(411)p
eop
%%Page: 412 412
412 411 bop 129 141 a Fv(412)83 b Fr(reloc.nw)765 b Fv(No)o(v)o(em)o(b)
q(er)13 b(15,)g(1996)192 258 y(It)e(is)f(often)h(con)o(v)o(enien)o(t)h
(to)e(refer)i(to)f(the)g(\\program)e(coun)o(ter")j(\()p
Fr(pc)p Fv(\),)f(i.e.,)f(the)h(address)129 307 y(of)g(the)g(curren)o(t)
h(lo)q(cation)e(in)g(the)h(curren)o(t)i(relo)q(catable)e(blo)q(c)o(k,)f
(as)h(if)f(it)g(w)o(ere)i(a)e(relo)q(catable)129 357
y(address.)20 b(In)13 b(our)g(curren)o(t)h(sc)o(heme,)f(it)g(is)g(not)g
(represen)o(table)i(as)f(a)e(relo)q(catable)i(address,)129
407 y(but)h(w)o(e)f(pro)o(vide)f(a)h(similar)d(in)o(terface)k(through)f
(macros:)-31 469 y Fp(412a)88 b Fo(h)p Fn(faux)16 b(de)n(clar)n(ations)
f(of)f(libr)n(ary)g(macr)n(os)h Fp(411b)p Fo(i)n Fv(+)q
Fo(\021)525 b Fm(/)5 b Fp(411b)171 519 y Fr(extern)21
b(int)g(cur_pc_known\(voi)o(d\);)171 569 y(extern)g(unsigned)f
(cur_pc\(void\);)129 621 y Fp(Uses)12 b Fl(cur_pc)e Fp(403c)g(and)h
Fl(cur_pc_kno)o(wn)d Fp(403c.)129 683 y Fr(cur_pc)13
b Fv(returns)i Fr(pc)p Fv('s)f(v)n(alue)f(if)g Fr(cur_pc_known)e
Fv(is)j(true.)192 733 y(The)c(represen)o(tation)h(w)o(e)f(ha)o(v)o(e)g
(c)o(hosen)g(for)g(relo)q(catable)g(addresses)i(do)q(es)e(not)g(supp)q
(ort)129 783 y(the)i(fully)e(general)h(form)e(de\014ned)k(ab)q(o)o(v)o
(e,)d(b)q(ecause)j(w)o(e)e(w)o(ould)g(need)h(a)e(little)h(language)f
(for)129 833 y(represen)o(ting)k(and)d(in)o(terpreting)h(addressing)g
(expressions,)h(and)e(w)o(e)h(despair)g(of)f(devising)129
882 y(a)21 b(language)e(whose)i(de\014nition)f(and)g(implemen)o(tation)
d(w)o(ould)j(b)q(e)h(acceptable)g(to)g(all)129 932 y(application)16
b(writers.)29 b(Instead,)18 b(the)g(to)q(olkit)e(pro)o(vides)h(relo)q
(catable)g(addresses)i(of)e(the)129 982 y(form)12 b Fi(L)d
Fv(+)g Fi(n)p Fv(,)k(where)h Fi(L)g Fv(is)g(a)f(lab)q(el)g(and)g
Fi(n)g Fv(is)h(an)f(in)o(teger)h(o\013set.)19 b(A)13
b(relo)q(catable)h(address)129 1032 y Fr(ra)g Fv(therefore)h(has)f(t)o
(w)o(o)g(\014elds:)233 1098 y Fr(a.label)233 1148 y(ra.offset)129
1231 y Fv(and)g(one)g(can)g(b)q(e)h(created)g(b)o(y)f(calling)e(the)j
(follo)o(wing)c(pro)q(cedure:)-33 1293 y Fp(412b)88 b
Fo(h)p Fn(libr)n(ary)14 b(pr)n(o)n(c)n(e)n(dur)n(es)h
Fp(412b)p Fo(i)n(\021)872 b Fp(412c)5 b Fm(.)171 1343
y Fr(extern)21 b(RAddr)f(addr_new\(RLabel)f(label,)i(int)g(offset\);)
129 1395 y Fp(Uses)12 b Fl(addr_new)p Fp(,)d Fl(label)h
Fp(383a,)g Fl(RAddr)g Fp(411a,)g(and)h Fl(RLabel)p Fp(.)129
1457 y Fv(Y)m(ou)j(can)g(also)f(con)o(v)o(ert)i(an)e(unsigned)i(in)o
(teger)f(to)g(a)f(relo)q(catable)h(address:)-29 1520
y Fp(412c)88 b Fo(h)p Fn(libr)n(ary)14 b(pr)n(o)n(c)n(e)n(dur)n(es)h
Fp(412b)p Fo(i)n Fv(+)q Fo(\021)836 b Fm(/)5 b Fp(412b)171
1569 y Fr(extern)21 b(RAddr)f(unsigned_to_raddr\(u)o(nsign)o(ed)f
(lc\);)129 1621 y Fp(Uses)12 b Fl(lc)f Fp(396b,)f Fl(RAddr)g
Fp(411a,)g(and)h Fl(unsigned_t)o(o_r)o(add)o(r)p Fp(.)p
eop
%%Page: 413 413
413 412 bop 695 1005 a Fq(P)m(art)32 b(I)s(I)s(I)546
1212 y Fu(Bac)m(k)38 b(matter)830 2604 y Fv(413)p eop
%%Page: 414 414
414 413 bop eop
%%Page: 415 415
415 414 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(415)145 258 y Fj(24.1)66 b(List)23 b(of)f(c)n(h)n(unks)145
361 y Fo(h)p Fn(*)15 b Fp(9b)p Fo(i)145 411 y(h)p Fn(*)g
Fp(25a)p Fo(i)145 461 y(h)p Fn(*)g Fp(31)p Fo(i)145 510
y(h)p Fn(*)g Fp(55)p Fo(i)145 560 y(h)p Fn(*)g Fp(81)p
Fo(i)145 610 y(h)p Fn(*)g Fp(117a)p Fo(i)145 660 y(h)p
Fn(*)g Fp(128a)p Fo(i)145 710 y(h)p Fn(*)g Fp(136a)p
Fo(i)145 760 y(h)p Fn(*)g Fp(148a)p Fo(i)145 809 y(h)p
Fn(*)g Fp(159)p Fo(i)145 859 y(h)p Fn(*)g Fp(229)p Fo(i)145
909 y(h)p Fn(*)g Fp(235a)p Fo(i)145 959 y(h)p Fn(*)g
Fp(259)p Fo(i)145 1009 y(h)p Fn(*)g Fp(268)p Fo(i)145
1058 y(h)p Fn(*)g Fp(288a)p Fo(i)145 1108 y(h)p Fn(*)g
Fp(293a)p Fo(i)145 1158 y(h)p Fn(*)g Fp(308)p Fo(i)145
1208 y(h)p Fn(*)g Fp(325)p Fo(i)145 1258 y(h)p Fn(*)g
Fp(339a)p Fo(i)145 1307 y(h)p Fn(*)g Fp(349a)p Fo(i)145
1357 y(h)p Fn(*)g Fp(353)p Fo(i)145 1407 y(h)p Fn(*)g
Fp(359a)p Fo(i)145 1457 y(h)p Fn(*)g Fp(367)p Fo(i)145
1507 y(h)p Fn(*)g Fp(376a)p Fo(i)145 1557 y(h)p Fn(add)h(c)n(onstr)n
(aints)f(on)g(\014eld)g(inputs)g Fp(315b)p Fo(i)145 1606
y(h)p Fn(add)h(c)n(onstr)n(aints)f(on)g(unc)n(onstr)n(aine)n(d)h
(inputs)f Fp(315a)p Fo(i)145 1656 y(h)p Fn(add)h(ne)n(gative)f(terms)f
(to)h Fr(s)g Fp(105c)p Fo(i)145 1706 y(h)p Fn(add)h(ne)n(gative)f
(terms)f(to)h Fr(s)g Fp(326d)p Fo(i)145 1756 y(h)p Fn(add)h(ne)n
(gative)f(terms)f(to)h Fr(s)g Fp(340d)p Fo(i)145 1806
y(h)p Fn(add)h(new)f(b)n(alanc)n(e)g(to)g Fr(baln2w)f
Fp(153a)p Fo(i)145 1855 y(h)p Fn(add)i(p)n(ositive)f(terms)f(to)h
Fr(s)f Fp(105b)p Fo(i)145 1905 y(h)p Fn(add)i(p)n(ositive)f(terms)f(to)
h Fr(s)f Fp(326c)p Fo(i)145 1955 y(h)p Fn(add)i(p)n(ositive)f(terms)f
(to)h Fr(s)f Fp(340c)p Fo(i)145 2005 y(h)p Fn(after)n(che)n(cker.t)g
Fp(323b)p Fo(i)145 2055 y(h)p Fn(A)o(mbiguous)i(name)f(warning)g
Fp(275c)p Fo(i)145 2104 y(h)p Fn(apply-fun.t)g Fp(209b)p
Fo(i)145 2154 y(h)p Fn(ar)n(gument)g(descriptions)g Fp(83a)p
Fo(i)145 2204 y(h)p Fn(ar)n(gument)g(descriptions)g Fp(193g)p
Fo(i)145 2254 y(h)p Fn(ar)n(gument)g(descriptions)g Fp(294b)p
Fo(i)145 2304 y(h)p Fn(assembly-impl.t)f Fp(235b)p Fo(i)145
2354 y(h)p Fr(,)h Fn(aux)h(tables)e Fp(149c)p Fo(i)145
2403 y(h)p Fn(aux)i(tables)f Fr(|)f Fp(149b)p Fo(i)145
2453 y(h)p Fn(b)n(ackslash)i(esc)n(ap)n(e)f Fp(365c)p
Fo(i)p eop
%%Page: 416 416
416 415 bop 129 141 a Fv(416)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fo(h)p Fn(Band-A)o(id)j(that)f(onc)n(e)g(c)n
(over)n(e)n(d)g(latent)g(p)n(attern)g(lab)n(el)f(of)h(an)g(instanc)n(e)
g(input)h Fp(181b)p Fo(i)129 307 y(h)p Fn(b)n(asic)f(c)n(ases)h(for)e
(simpli\014c)n(ation)g Fp(93a)p Fo(i)129 357 y(h)p Fn(br)n(ain)h(dump)h
Fp(157)p Fo(i)129 407 y(h)p Fn(build)f(and)h(r)n(eturn)e(solution)h
Fp(137a)p Fo(i)129 457 y(h)p Fn(C)g(emitter)f(sp)n(e)n(c)h
Fp(405)p Fo(i)129 507 y(h)p Fn(c)n(ases)h(for)e(ar)n(guments)h
Fp(9d)p Fo(i)129 557 y(h)p Fn(c)n(ases)h(for)e Fr(do_expwalk)f
Fp(117b)p Fo(i)129 606 y(h)p Fn(c)n(ases)j(for)e Fr(do_gsubst)f
Fp(121a)p Fo(i)129 656 y(h)p Fn(c)n(ases)j(for)e Fr(expimage)f
Fp(102a)p Fo(i)129 706 y(h)p Fn(c)n(ases)j(for)e Fr(expps)g
Fp(128b)p Fo(i)129 756 y(h)p Fn(c)n(ases)i(for)e Fr(exps_eq)f
Fp(85a)p Fo(i)129 806 y(h)p Fn(c)n(ases)j(for)e(identifying)h(c)n
(andidates)g Fp(149d)p Fo(i)129 855 y(h)p Fn(c)n(ases)h(for)e(other)h
(lexic)n(al)f(states)h Fp(361a)p Fo(i)129 905 y(h)p Fn(c)n(ases)h(for)e
Fr(prettyC)f Fp(326a)p Fo(i)129 955 y(h)p Fn(c)n(ases)j(for)e
Fr(prettyM3)f Fp(339b)p Fo(i)129 1005 y(h)p Fn(c)n(ases)j(gener)n(ate)n
(d)f(fr)n(om)f(r)n(ewrite)f(rules)h Fp(92b)p Fo(i)129
1055 y(h)p Fn(c)n(ases)i(gener)n(ate)n(d)f(fr)n(om)f(sup)n(er)h(r)n
(ewrite)e(rules)h Fp(92d)p Fo(i)129 1104 y(h)p Fn(change)i(lexer)f
(state)g(fr)n(om)f Fr(CASEPAT)f Fn(to)i Fr(CASEARM)e
Fn(if)i Fr(tval)f Fn(is)g Fr("=>")g Fp(363b)p Fo(i)129
1154 y(h)p Fn(change)i(names)g(of)f(childr)n(en)f(fr)n(om)g(strings)h
(to)f(name)n(arr)n(ays)h(when)g(p)n(ossible)g Fp(292a)p
Fo(i)129 1204 y(h)p Fn(che)n(ck)h(c)n(onditions)f Fp(319b)p
Fo(i)129 1254 y(h)p Fn(che)n(ck)h(for)e(unuse)n(d)i(de\014nitions)g(in)
f Fr(cons)f Fp(165d)p Fo(i)129 1304 y(h)p Fn(che)n(ck)i(that)f(test)f
(values)h(exist)g(for)f(input)i Fp(311b)p Fo(i)129 1354
y(h)p Fn(che)n(ck)g(that)f Fr(t.type.ntags)d Fn(do)n(esn)l('t)j
(over\015ow)g(tag)g(bits)f Fp(165e)p Fo(i)129 1403 y(h)p
Fn(che)n(cker.t)h Fp(322)p Fo(i)129 1453 y(h)p Fn(chkr\014lter)g
Fp(306)p Fo(i)129 1503 y(h)p Fn(closur)n(e)g(c)n(al)r(l)f(to)h
Fr(emitter)f Fp(328d)p Fo(i)129 1553 y(h)p Fn(closur)n(e-he)n(ader.t)h
Fp(206d)p Fo(i)129 1603 y(h)p Fn(closur)n(e-typ)n(e.t)g
Fp(208b)p Fo(i)129 1652 y(h)p Fn(c)n(omplain)h(ab)n(out)f(class)g
(mismatch)f Fp(68d)p Fo(i)129 1702 y(h)p Fn(c)n(omplain)i(ab)n(out)f
(dots)g Fp(68c)p Fo(i)129 1752 y(h)p Fn(c)n(omplain)h(ab)n(out)f
(\014eldsp)n(e)n(c)g Fr(info)f Fp(354e)p Fo(i)129 1802
y(h)p Fn(c)n(omplain)i(if)e(some)h(class)g(in)g Fr(shape)f
Fn(has)h(no)g(plac)n(eholder)g Fp(72b)p Fo(i)129 1852
y(h)p Fn(c)n(omplain)h(no)f(names)h(sp)n(e)n(ci\014e)n(d)f
Fp(249c)p Fo(i)129 1901 y(h)p Fn(c)n(omplain)h(of)e(c)n(onstr)n(aint)h
(c)n(on\015ict)g Fp(69a)p Fo(i)129 1951 y(h)p Fn(c)n(omplain)h(of)e
(left)h(se)n(quenc)n(e)g(to)n(o)g(short)g Fp(68b)p Fo(i)129
2001 y(h)p Fn(c)n(omplain)h(of)e(right)h(se)n(quenc)n(e)g(to)n(o)g
(short)g Fp(68a)p Fo(i)129 2051 y(h)p Fn(c)n(ompute)h(and)g(c)n(ache)f
(p)n(attern)g(for)f Fr(cons)g Fp(169)p Fo(i)129 2101
y(h)p Fn(c)n(ompute)i(and)g(c)n(ache)f(p)n(attern)g(for)f
Fr(constype)f Fp(172a)p Fo(i)129 2151 y(h)p Fn(c)n(ons-c)n(al)r(l.t)i
Fp(211d)p Fo(i)129 2200 y(h)p Fn(c)n(onstr)n(aint)g(or)g(\014eld)g
(binding,)g(dep)n(ending)h(on)f(the)g(typ)n(e)g(of)g
Fr(p.value)f Fp(76a)p Fo(i)129 2250 y(h)p Fn(c)n(onstructor-lab)n
(els.t)g Fp(211b)p Fo(i)129 2300 y(h)p Fn(c)n(onstyp)n(e-print-he)n
(ader.t)h Fp(250c)p Fo(i)129 2350 y(h)p Fn(c)n(onvert)g(br)n(anch)h
Fr(b)e Fn(to)h(a)g(p)n(attern)g Fr(q)g Fp(170a)p Fo(i)129
2400 y(h)p Fn(c)n(onvert)e(\014eld)g(bindings)g(to)f(answers,)g(split)g
(arm)g(as)h(ne)n(e)n(de)n(d,)g(and)g(susp)n(end)g(r)n(esults)f
Fp(263a)p Fo(i)129 2449 y(h)p Fn(c)n(onvert)j Fr(n)g
Fn(bytes)g(of)g Fr(bytes)f Fn(into)h Fr(val)f Fn(\(big-endian\))h
Fp(402c)p Fo(i)129 2499 y(h)p Fn(c)n(onvert)g Fr(n)g
Fn(bytes)g(of)g Fr(bytes)f Fn(into)h Fr(val)f Fn(\(little-endian\))g
Fp(402b)p Fo(i)p eop
%%Page: 417 417
417 416 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(417)145 258 y Fo(h)p Fn(c)n(ount)16 b(the)f(new)g(blo)n(ck)g
Fr(rb)f Fn(and)i(string)e(it)g(on)i(a)f(list)f Fp(399b)p
Fo(i)145 307 y(h)p Fn(cr)n(e)n(ate)h(fr)n(esh)f(variables)g
Fr(x)p Fn(,)h Fr(q)21 b(=)h(x)g(div)f(m)p Fn(,)14 b Fr(r)22
b(=)f(x)h(mod)f(m)15 b Fp(139b)p Fo(i)145 357 y(h)p Fn(cr)n(e)n(ate)g
(initial)f(set)h(of)f Fr(test_values)f Fp(318c)p Fo(i)145
407 y(h)p Fn(cr)n(e)n(ate-closur)n(e-at.t)h Fp(206a)p
Fo(i)145 457 y(h)p Fn(cr)n(e)n(ate-closur)n(e.t)g Fp(205c)p
Fo(i)145 507 y(h)p Fn(cr)n(e)n(ate-instanc)n(e-b)n(o)n(dy.t)h
Fp(212a)p Fo(i)145 557 y(h)p Fn(debug)h(b)n(alancing)g(act)e
Fp(143a)p Fo(i)145 606 y(h)p Fn(de)n(clar)n(ations)h(of)g(pr)n(o)n(c)n
(e)n(dur)n(es)f(pr)n(ovide)n(d)h(by)g(the)g(applic)n(ation)g
Fp(\(nev)o(er)10 b(de\014ned\))p Fo(i)145 656 y(h)p Fn(de\014nitions)16
b Fp(385a)p Fo(i)145 706 y(h)p Fn(dir)n(e)n(ct)e(c)n(al)r(l)h(thr)n
(ough)g Fr(emittername)d Fp(328c)p Fo(i)145 756 y(h)p
Fn(dir)n(e)n(ct-pr)n(oto.t)i Fp(338c)p Fo(i)145 806 y(h)p
Fn(dump)i(def-use)f(info)g Fp(145e)p Fo(i)145 855 y(h)p
Fn(dump)h(image)f(of)g(c)n(ase)g(arm)f(after)g(simpli\014c)n(ation)h
Fp(261c)p Fo(i)145 905 y(h)p Fn(dump)h(image)f(of)g(c)n(ase)g(arm)f(b)n
(efor)n(e)h(simpli\014c)n(ation)f Fp(261b)p Fo(i)145
955 y(h)p Fn(dump)i Fr(value)e Fn(and)h Fr(constraints)e
Fp(145d)p Fo(i)145 1005 y(h)p Fn(e)n(arly-br)n(anch.s)i
Fp(185c)p Fo(i)145 1055 y(h)p Fn(eliminate)g Fr(Eforce)e
Fn(on)j(r)n(elo)n(c)n(atable)e(inputs)h Fp(314b)p Fo(i)145
1104 y(h)p Fn(emit)g(de)n(clar)n(ations)f(for)h(al)r(l)f(of)h(the)g
(kept)g(c)n(onstructors)f Fp(230c)p Fo(i)145 1154 y(h)p
Fn(emit)h(de)n(clar)n(ations)f(for)h(al)r(l)f(of)h(the)g(kept)g(c)n
(onstructors)f(\(se)n(gr)n(e)n(gate)n(d)h(version\))g
Fp(231d)p Fo(i)145 1204 y(h)p Fn(emit)g Fr(n)f Fn(bytes)h(of)g
Fr(val)f Fn(at)h Fr(p)g Fn(\(big-endian\))g Fp(387b)p
Fo(i)145 1254 y(h)p Fn(emit)g Fr(n)f Fn(bytes)h(of)g
Fr(val)f Fn(at)h Fr(p)g Fn(\(little-endian\))f Fp(386c)p
Fo(i)145 1304 y(h)p Fn(emit)h(new)g(closur)n(e)f(function)i(numb)n(er)n
(e)n(d)f Fr(count)e Fn(and)j(put)f(it)g(in)g(c)n(ache)g
Fp(227b)p Fo(i)145 1354 y(h)p Fn(emitter-b)n(o)n(dy.t)f
Fp(214b)p Fo(i)145 1403 y(h)p Fn(empty)h Fr(zeroes)f
Fp(138)p Fo(i)145 1453 y(h)p Fn(e)n(quality)h(c)n(ondition)h
Fp(316b)p Fo(i)145 1503 y(h)p Fn(e)n(quations)g Fr(e1)e
Fn(and)i Fr(e2)e Fn(ar)n(e)h(the)g(same)g Fp(87b)p Fo(i)145
1553 y(h)p Fn(err)n(or)f(if)g Fr(p)h Fn(has)g(no)h(disjuncts)f
Fp(193c)p Fo(i)145 1603 y(h)p Fn(example)h Fp(183c)p
Fo(i)145 1652 y(h)p Fn(exp)n(orte)n(d)f(data)h(de)n(clar)n(ations)e
Fp(381)p Fo(i)145 1702 y(h)p Fn(exp)n(orte)n(d)h(macr)n(o)g
(de\014nitions)h Fp(384b)p Fo(i)145 1752 y(h)p Fn(exp)n(orte)n(d)f(pr)n
(o)n(c)n(e)n(dur)n(e)g(de)n(clar)n(ations)g Fp(386a)p
Fo(i)145 1802 y(h)p Fn(extr)n(act)g Fr(d)p Fn('s)f(c)n(onditions)i
Fp(314a)p Fo(i)145 1852 y(h)p Fn(faux)g(de)n(clar)n(ations)e(of)h(libr)
n(ary)f(macr)n(os)g Fp(411b)p Fo(i)145 1901 y(h)p Fn(former)g(r)n
(ewrite)f(rules)i(now)g(implemente)n(d)f(by)i Fr(eliminate_insta)o
(nces)11 b Fp(100a)p Fo(i)145 1951 y(h)p Fn(gdb-asmoutput)16
b Fp(305b)p Fo(i)145 2001 y(h)p Fn(gdb-binoutput)g Fp(305a)p
Fo(i)145 2051 y(h)p Fn(gener)n(ate)f(input)h(values)f
Fp(317)p Fo(i)145 2101 y(h)p Fn(gener)n(ate)n(d)g(c)n(ases)h(for)e
(hoisting)h Fp(219a)p Fo(i)145 2151 y(h)p Fn(Get)g(name)h(fr)n(om)e(p)n
(attern)h Fr(arm)f Fp(275b)p Fo(i)145 2200 y(h)p Fn(glob)h(a)g(c)n(onc)
n(atenation)h Fp(240a)p Fo(i)145 2250 y(h)p Fn(gr)n(ammar)f
Fp(34a)p Fo(i)145 2300 y(h)p Fn(hand)r(le)h(matching)f(statements)g
Fp(21a)p Fo(i)145 2350 y(h)p Fn(if)g(a)g Fr(pending)e
Fn(e)n(quation)j(c)n(an)f(b)n(e)g(\014xe)n(d)h(with)e
Fr(div)g Fn(or)h Fr(mod)p Fn(,)f(dr)n(ain)g Fr(pending)g
Fp(139a)p Fo(i)145 2400 y(h)p Fn(if)h(debugging,)g(split)g(al)r(l)f
(and)i(r)n(ep)n(ort)d Fp(276c)p Fo(i)145 2449 y(h)p Fn(if)i(debugging,)
g(write)f(ab)n(out)h(r)n(esults)f(of)h Fr(pmatch)f Fp(279b)p
Fo(i)145 2499 y(h)p Fn(if)h(debugging,)g(write)f(ab)n(out)h(splitting)f
(this)h(no)n(de)h Fp(277b)p Fo(i)p eop
%%Page: 418 418
418 417 bop 129 141 a Fv(418)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fo(h)p Fn(if)e(dir)n(e)n(ct)e(style)i(and)g
(late)f(p)n(c,)i(add)f Fr(ENCODE_pc)e Fn(de)n(clar)n(ation)h(to)h
Fr(s)f Fn(and)i(set)e Fr(pc_override)e Fp(329a)p Fo(i)129
307 y(h)p Fn(if)15 b Fr(env)f Fn(is)h(a)g(list,)e(c)n(onvert)i(to)g(a)g
(table)g(and)h(cr)n(e)n(ate)e(string)g Fr(hidden)g Fp(27b)p
Fo(i)129 357 y(h)p Fn(if)h(\014rst)f(time)h(thru,)f(che)n(ck)h(for)g
(unuse)n(d)h(de\014nitions)f(in)g Fr(cons)f Fp(165c)p
Fo(i)129 407 y(h)p Fn(if)h(low)f(water)g(mark)h(not)g(set,)f(up)n(date)
i(\014rst)e Fr(datalc)g Fn(and)i(r)n(eturn)e Fp(397b)p
Fo(i)129 457 y(h)p Fn(if)h(ne)n(e)n(de)n(d,)g(\015ip)g(bit)g(numb)n
(ering)g(of)g(\014elds)g Fr(ii7)f Fn(using)h(size)g Fr(ii5)f
Fp(35c)p Fo(i)129 507 y(h)p Fn(if)h(ne)n(e)n(de)n(d,)g(\015ip)g
Fr(lo)g Fn(and)g Fr(hi)g Fp(115b)p Fo(i)129 557 y(h)p
Fn(if)g(no)g(\014eld)g(is)g(over)n(c)n(onstr)n(aine)n(d,)f
Fr(return)21 b(seq)14 b Fp(70b)p Fo(i)129 606 y(h)p Fn(if)g
Fr(other_child)p Fn('s)c(r)n(ange)k(has)g(one)g(element,)f(exchange)i
(it)e(with)g Fr(single_range)e Fp(297b)p Fo(i)129 656
y(h)p Fn(if)k(tokens)g(ar)n(e)g(left)f(over,)g(c)n(omplain)h
Fp(21d)p Fo(i)129 706 y(h)p Fn(if)g Fr(v)g Fn(c)n(ompletes)f(half)h(of)
g(a)g(b)n(alanc)n(e,)g(make)g(the)g(other)g(half)f(known)i
Fp(143b)p Fo(i)129 756 y(h)p Fn(image)g(of)e Fr(Pseq)g
Fn(\(p)n(ossibly)h(with)f(dots\))h Fp(377b)p Fo(i)129
806 y(h)p Fn(inche)n(cker.t)g Fp(323a)p Fo(i)129 855
y(h)p Fn(indir)n(e)n(ct-pr)n(oto.t)f Fp(338d)p Fo(i)129
905 y(h)p Fn(init)h Fp(128c)p Fo(i)129 955 y(h)p Fn(init)g
Fp(349c)p Fo(i)129 1005 y(h)p Fn(initialization)g Fp(38d)p
Fo(i)129 1055 y(h)p Fn(initialize)f(a)h(new)g(r)n(elo)n(c)n(atable)f
(blo)n(ck)h Fr(rb)g Fp(382b)p Fo(i)129 1104 y(h)p Fn(initialize)f(b)n
(alanc)n(e)i(machinery)f(and)g(b)n(alanc)n(e)h(out)f(inputs)g
Fp(142a)p Fo(i)129 1154 y(h)p Fn(initialize)f Fr(Cprec)g
Fn(and)i Fr(Cassoc)d Fp(336a)p Fo(i)129 1204 y(h)p Fn(initialize)h
(glob)n(als)h Fp(14a)p Fo(i)129 1254 y(h)p Fn(initialize)f
Fr(M3prec)g Fn(and)i Fr(M3assoc)d Fp(347a)p Fo(i)129
1304 y(h)p Fn(initialize)h(nopp)i Fp(101c)p Fo(i)129
1354 y(h)p Fn(initialize)e Fr(prec)g Fn(and)i Fr(assoc)e
Fp(112a)p Fo(i)129 1403 y(h)p Fn(initialize)g Fr(tokens)g
Fp(360a)p Fo(i)129 1453 y(h)p Fn(inje)n(ct)h Fr(idents)f
Fn(into)h Fr(rho)f Fp(262a)p Fo(i)129 1503 y(h)p Fn(input-test.t)h
Fp(212b)p Fo(i)129 1553 y(h)p Fn(insert)g(e)n(quality)g(c)n(onditions)g
(in)g Fr(test_values)d Fp(316a)p Fo(i)129 1603 y(h)p
Fn(insist)j(input)g(lengths)g(match)g Fp(177d)p Fo(i)129
1652 y(h)p Fn(insist)g(on)g(names)h(if)e Fr(\045s)h Fn(is)f(use)n(d)h
Fp(242c)p Fo(i)129 1702 y(h)p Fn(insist)g(on)g Fr(*\\t)22
b(>)f(0)15 b Fp(163a)p Fo(i)129 1752 y(h)p Fn(insist)g
Fr(p)g Fn(have)g(no)h(c)n(onditionals)f(nor)g(\014eld)g(bindings)g
Fp(43b)p Fo(i)129 1802 y(h)p Fn(insist)g(that)g Fr(name)f
Fn(not)h(r)n(efer)f(to)h(a)g(c)n(onstructor)f(typ)n(e)h(or)g(r)n(elo)n
(c)n(atable)f Fp(242b)p Fo(i)129 1852 y(h)p Fn(insist)h(that)g
Fr(operands)e Fn(and)j(op)n(er)n(ands)f(of)g Fr(cons)f
Fn(have)h(the)g(same)g(names)h Fp(243b)p Fo(i)129 1901
y(h)p Fn(insist)d(that)f Fr(operands)g Fn(and)h(op)n(er)n(ands)g(of)g
Fr(cons)f Fn(have)h(the)g(same)g(signe)n(d)g(op)n(er)n(ands)g
Fp(243c)p Fo(i)129 1951 y(h)p Fn(insist)i(ther)n(e)f(ar)n(e)h(no)g
(\014eld)g(bindings)h(in)f(arm)f Fr(a)h Fp(301b)p Fo(i)129
2001 y(h)p Fn(instanc)n(e-assignment.t)h Fp(212c)p Fo(i)129
2051 y(h)p Fn(instanc)n(e-typ)n(e.t)f Fp(202a)p Fo(i)129
2101 y(h)p Fn(inte)n(ger-input)g(err)n(or)f Fp(376b)p
Fo(i)129 2151 y(h)p Fn(int-print-he)n(ader.t)g Fp(249b)p
Fo(i)129 2200 y(h)p Fn(issue)h(err)n(or)f(message)h(ab)n(out)h
(overlapping)f(\014elds)g Fp(196b)p Fo(i)129 2250 y(h)p
Fn(issue)g(warnings)g(for)f(chars)h(in)g Fr(expected)e
Fn(not)j(in)f Fr(template)e Fp(52b)p Fo(i)129 2300 y(h)p
Fn(late-br)n(anch.s)i Fp(187b)p Fo(i)129 2350 y(h)p Fn(latent)g(p)n
(attern)g(lab)n(el)f(of)h(an)h(instanc)n(e)f(input)g
Fp(181a)p Fo(i)129 2400 y(h)p Fn(let)g Fr(call)f Fn(r)n(epr)n(esent)g
(a)h(c)n(al)r(l)g(to)f(the)h(assembly)g(pr)n(o)n(c)g(for)f
Fr(cons)g Fp(250b)p Fo(i)129 2449 y(h)p Fn(lexer)h(for)f(INITIAL)h(and)
g(CASEP)m(A)m(T)g Fp(363a)p Fo(i)129 2499 y(h)p Fn(libr)n(ary)f(pr)n(o)
n(c)n(e)n(dur)n(es)h Fp(\(nev)o(er)9 b(de\014ned\))p
Fo(i)p eop
%%Page: 419 419
419 418 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(419)145 258 y Fo(h)p Fn(libr)n(ary)14 b(pr)n(o)n(c)n(e)n(dur)n(es)g
Fp(412b)p Fo(i)145 307 y(h)p Fn(libr)n(ary)g(typ)n(es)h
Fp(\(nev)o(er)10 b(de\014ned\))p Fo(i)145 357 y(h)p Fn(libr)n(ary)k
(typ)n(es)h Fp(411a)p Fo(i)145 407 y(h)p Fn(lo)n(c)n(al)g(de)n(clar)n
(ations)f Fp(385c)p Fo(i)145 457 y(h)p Fn(lo)n(c)n(al)h(de)n(clar)n
(ations)f(for)h Fr(prettyC)e Fp(327b)p Fo(i)145 507 y(h)p
Fn(lo)n(c)n(al)i(de)n(clar)n(ations)f(for)h Fr(prettyM3)e
Fp(341b)p Fo(i)145 557 y(h)p Fn(make)j Fr(addresses)d
Fn(and)i Fr(values)f Fn(fr)n(e)n(e)g(vars)h(of)f(b)n(o)n(dy)i(\(in)f
(or)n(der)f(of)h(app)n(e)n(ar)n(anc)n(e\))g Fp(219c)p
Fo(i)145 606 y(h)p Fn(make)h Fr(args[i])d Fn(a)i(c)n(onstructor)g
(input)g Fp(176)p Fo(i)145 656 y(h)p Fn(make)h Fr(args[i])d
Fn(a)i(signe)n(d)g(inte)n(ger)g(input)g Fp(175b)p Fo(i)145
706 y(h)p Fn(make)h Fr(args[i])d Fn(an)i(unsigne)n(d)h(inte)n(ger)f
(input)g Fp(174b)p Fo(i)145 756 y(h)p Fn(make)h Fr(cl.creation)c
Fn(to)j(cr)n(e)n(ate)f(closur)n(e)h(and)h(emit)e(plac)n(eholder)h
Fp(205b)p Fo(i)145 806 y(h)p Fn(make)h Fr(cl.creation)c
Fn(to)j(cr)n(e)n(ate)f(optimize)n(d)h(closur)n(e)g Fr(clo)f
Fn(and)h(emit)g(plac)n(eholder)g Fp(216)p Fo(i)145 855
y(h)p Fn(make)h Fr(cloargs)d Fn(the)i(list)f(of)h(closur)n(e)f(ar)n
(gs,)g(using)i Fr(values)d Fn(and)j Fr(sigma)e Fp(220b)p
Fo(i)145 905 y(h)p Fn(make)i Fr(closubst)d Fn(change)j(addr)n(esses)f
(and)g(values)g(to)g(sele)n(ct)g(fr)n(om)f Fr(clo)g Fp(220a)p
Fo(i)145 955 y(h)p Fn(make)19 b Fr(condition_failure)o(_msg)c
Fn(c)n(omplain)j(of)g(unde)n(cide)n(d)h(br)n(anch)g(or)e(unsatis\014e)n
(d)187 1005 y(c)n(onditions)e Fp(193b)p Fo(i)145 1055
y(h)p Fn(make)h Fr(f)e Fn(che)n(cke)n(d)i Fp(354b)p Fo(i)145
1104 y(h)p Fn(make)g Fr(f)e Fn(guar)n(ante)n(e)n(d)i
Fp(354d)p Fo(i)145 1154 y(h)p Fn(make)g Fr(f)e Fn(unche)n(cke)n(d)i
Fp(354c)p Fo(i)145 1204 y(h)p Fn(make)g Fr(fields)d Fn(an)j(arr)n(ay)e
(of)h(al)r(l)f(\014elds)h(sorte)n(d)g(by)g(name)g Fp(357a)p
Fo(i)145 1254 y(h)p Fn(make)h Fr(first)d Fn(the)i(lar)n(gest)f(slic)n
(e)h(at)g Fr(lo)f Fn(\()p Fr(fail)g Fn(if)g(not)h(ther)n(e)g(and)h
(leftmost\))d Fp(155a)p Fo(i)145 1304 y(h)p Fn(make)j
Fr(inputs)d Fn(the)i(set)g(of)g(input)g(names,)g(b)n(ar\014ng)g(if)g
(duplic)n(ates)g(exist)f Fp(161c)p Fo(i)145 1354 y(h)p
Fn(make)22 b Fr(inputs_labs)d(inputs)h Fn(plus)h(lab)n(els)g(de\014ne)n
(d)h(in)g Fr(b[2])p Fn(,)f(b)n(ar\014ng)h(on)g(dupli-)187
1403 y(c)n(ates)15 b Fp(162a)p Fo(i)145 1453 y(h)p Fn(make)h
Fr(keepname)d Fn(name)i(of)g Fr(p1)g Fn(if)f Fr(p2)g
Fn(is)h(\014eld)g(binding,)g(nul)r(l)g(otherwise)f Fp(65c)p
Fo(i)145 1503 y(h)p Fn(make)i Fr(l)e Fn(a)h(list)f(of)h(assignments)g
(by)h(using)f(the)g(name)g(table)g Fr(nt)f Fp(206b)p
Fo(i)145 1553 y(h)p Fn(make)i Fr(l)e Fn(list)g(of)h Fr(idents)f
Fn(not)h(in)g Fr(soln.answers)d Fp(265b)p Fo(i)145 1603
y(h)p Fn(make)k Fr(min)e Fn(and)h Fr(max)g Fn(smal)r(lest)f(and)i(lar)n
(gest)e(values)h(in)g Fr(nametab)e Fp(358b)p Fo(i)145
1652 y(h)p Fn(make)j(new)f(c)n(onstr)n(aint)f(fr)n(om)g
Fr(value[vv])p Fv(=)p Fr(zz)f Fp(143c)p Fo(i)145 1702
y(h)p Fn(make)j(new)f(e)n(quation)g Fr(value[vv])p Fv(=)p
Fr(zz)p Fn(,)e(then)i(up)n(date)g Fr(value[vv])e Fp(143d)p
Fo(i)145 1752 y(h)p Fn(make)j Fr(s)e Fn(a)h(lab)n(el)g(string)f(for)g
Fr(alt.constraints)e Fp(375a)p Fo(i)145 1802 y(h)p Fn(make)k
Fr(s)e Fn(r)n(epr)n(esent)g(table)h Fr(e)g Fp(129a)p
Fo(i)145 1852 y(h)p Fn(make)h Fr(s)e Fn(r)n(epr)n(esent)g(table)h
Fr(e)p Fn(,)g(but)g(elide)f(additive)h(and)h(multiplic)n(ative)d(units)
i Fp(105a)p Fo(i)145 1901 y(h)p Fn(make)h Fr(s)e Fn(r)n(epr)n(esent)g
(table)h Fr(e)p Fn(,)g(but)g(elide)f(additive)h(and)h(multiplic)n
(ative)d(units)i Fp(326b)p Fo(i)145 1951 y(h)p Fn(make)h
Fr(s)e Fn(r)n(epr)n(esent)g(table)h Fr(e)p Fn(,)g(but)g(elide)f
(additive)h(and)h(multiplic)n(ative)d(units)i Fp(340b)p
Fo(i)145 2001 y(h)p Fn(make)i Fr(selections)p Fn(,)d
Fr(selected)p Fn(,)h Fr(free)g Fn(hold)i(sele)n(ctions,)f(things)g
(sele)n(cte)n(d)g(fr)n(om,)g(and)187 2051 y(fr)n(e)n(e)e(variables)g
Fp(206e)p Fo(i)145 2101 y(h)p Fn(make)i(sur)n(e)e(al)r(l)h(dep)n
(endent)h(variables)e(ar)n(e)h(known)g Fp(145c)p Fo(i)145
2151 y(h)p Fn(make)h(sur)n(e)e Fr(currb->curbuf->nex)o(t)e
Fn(is)j(non-nul)r(l,)g(al)r(lo)n(c)n(ating)g(if)f(ne)n(c)n(essary)h
Fp(391a)p Fo(i)145 2200 y(h)p Fn(make)h(sur)n(e)e(plac)n(eholder)h(of)g
Fr(class)f Fn(is)g(the)h(right)f(length)h Fp(37b)p Fo(i)145
2250 y(h)p Fn(make)h(sur)n(e)e(ther)n(e)h(ar)n(e)f(no)i
Fr(pending)d Fn(e)n(quations)i Fp(145f)s Fo(i)145 2300
y(h)p Fn(make)h(sur)n(e)e(ther)n(e's)g(an)i(answer)e(for)h(every)f
(non-lab)n(el)i(in)e Fr(idents)g Fp(265a)p Fo(i)145 2350
y(h)p Fn(make)i(sur)n(e)e Fr(z)h Fn(is)f(satis\014able)h
Fp(145b)p Fo(i)145 2400 y(h)p Fn(make)h Fr(v)e Fn(in)h
Fr(z)g Fn(a)g(new)g(dep)n(endent)h(variable)e Fp(140a)p
Fo(i)145 2449 y(h)p Fn(make)i Fr(vv)e Fn(a)h(new)g(dep)n(endent)h
(variable)f(with)f Fr(value[vv])p Fv(=)p Fr(zz)f Fp(144a)p
Fo(i)145 2499 y(h)p Fn(manipulate)j(de)n(cision)f(tr)n(e)n(e)f
Fr(t)h Fp(22b)p Fo(i)p eop
%%Page: 420 420
420 419 bop 129 141 a Fv(420)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fo(h)p Fn(mclib.c)i Fp(410)p Fo(i)129
307 y(h)p Fn(mclib.h)g Fp(409b)p Fo(i)129 357 y(h)p Fn(mer)n(ge)g
Fr(c1)f Fn(and)i Fr(c2)p Fn(,)e(inserting)h(r)n(esult)f(in)h
Fr(S2)f Fp(68f)s Fo(i)129 407 y(h)p Fn(move)i Fr(currb->curbuf)c
Fn(to)j(the)g(next)g(bu\013er,)g(up)n(dating)h(glob)n(als)e
Fp(388c)p Fo(i)129 457 y(h)p Fn(name)i(of)f Fr(rho)f
Fp(28c)p Fo(i)129 507 y(h)p Fn(new)h(p)n(attern)g(with)f(c)n(ontr)n
(adictions)h(eliminate)n(d)g Fp(71c)p Fo(i)129 557 y(h)p
Fn(no-lab)n(els.t)g Fp(211e)p Fo(i)129 606 y(h)p Fn(normalize)g
Fr(z)g Fn(by)g(dividing)g(out)g(the)g(gr)n(e)n(atest)f(c)n(ommon)i
(divisor)e Fp(146a)p Fo(i)129 656 y(h)p Fn(note)i(new)f(\014eld)g(name)
g Fr(ii1)g Fp(33a)p Fo(i)129 706 y(h)p Fn(note)h(new)f(op)n(er)n(and)g
(or)g(id)g Fr(ii1)f Fp(33b)p Fo(i)129 756 y(h)p Fn(old,)h(b)n(o)n(gus)g
(turn)g(p)n(attern)g Fr(p)g Fn(into)f(emitter)g(and)i(r)n(eturn)e(it)h
Fp(192)p Fo(i)129 806 y(h)p Fn(old)g(de\014nitions)h
Fp(407c)p Fo(i)129 855 y(h)p Fn(old)f(make)h Fr(s)e Fn(r)n(epr)n(esent)
h(table)f Fr(e)p Fn(,)h(but)g(elide)f(additive)h(and)h(multiplic)n
(ative)d(units)i Fp(105d)p Fo(i)129 905 y(h)p Fn(old)g(make)h
Fr(s)e Fn(r)n(epr)n(esent)h(table)f Fr(e)p Fn(,)h(but)g(elide)f
(additive)h(and)h(multiplic)n(ative)d(units)i Fp(327a)p
Fo(i)129 955 y(h)p Fn(old)g(make)h Fr(s)e Fn(r)n(epr)n(esent)h(table)f
Fr(e)p Fn(,)h(but)g(elide)f(additive)h(and)h(multiplic)n(ative)d(units)
i Fp(341a)p Fo(i)129 1005 y(h)p Fn(old)g(p)n(ossible)g(binding)h
(instanc)n(e)f Fr(x)f Fn(of)h(c)n(onstructor)g(typ)n(e)g
Fr(ipt.meaning)d Fp(177b)p Fo(i)129 1055 y(h)p Fn(old-e)n(arly-br)n
(anch.s)j Fp(186a)p Fo(i)129 1104 y(h)p Fn(omit)g(c)n(onstr)n(aints)g
(and)g(c)n(onditions)h(on)f(c)n(onstructor-typ)n(e)n(d)g(op)n(er)n
(ands)g Fp(315c)p Fo(i)129 1154 y(h)p Fr(operands)f Fn(matches)h
(existing)g(assembly)g(syntax)g(for)g Fr(cons)f Fp(244a)p
Fo(i)129 1204 y(h)p Fn(other)h(c)n(ases)g(for)g(hoisting)g
Fp(220c)p Fo(i)129 1254 y(h)p Fn(other)g(\014elds)g(of)g(a)g(r)n(elo)n
(c)n(atable)f(blo)n(ck)h Fp(383a)p Fo(i)129 1304 y(h)p
Fn(p)n(ossible)g(binding)h(instanc)n(e)f Fr(x)g Fn(of)f(c)n(onstructor)
h(typ)n(e)g Fr(ipt.meaning)d Fp(177a)p Fo(i)129 1354
y(h)p Fn(p)n(ossible)j(warnings)g(ar)n(ound)g(changes)h(in)f(bit)g
(numb)n(erings)g Fp(36c)p Fo(i)129 1403 y(h)p Fn(p)n(ossibly)g(warn)g
(ab)n(out)g(b)n(ad)g(enc)n(o)n(ding)h(for)e Fr(cons)g
Fp(193d)p Fo(i)129 1453 y(h)p Fn(print)h Fr(fits)f Fn(and)i
Fr(conds)d Fp(314d)p Fo(i)129 1503 y(h)p Fn(print)i Fr(test_values)e
Fp(314e)p Fo(i)129 1553 y(h)p Fn(pr)n(o)n(c-structur)n(e.t)h
Fp(231b)p Fo(i)129 1603 y(h)p Fn(pr)n(o)n(c-structur)n(e.t)g(\(se)n(gr)
n(e)n(gate)n(d)g(version\))h Fp(231c)p Fo(i)129 1652
y(h)p Fn(r)n(elo)n(c-c)n(al)r(l.t)f Fp(211c)p Fo(i)129
1702 y(h)p Fn(r)n(emove)h(fr)n(om)f Fr(freevars)g Fn(names)h(of)g(p)n
(attern)f(lab)n(els)h(in)g Fr(a.pattern)e Fp(261a)p Fo(i)129
1752 y(h)p Fn(r)n(estor)n(e)h Fr(pc_override)f Fp(329b)p
Fo(i)129 1802 y(h)p Fn(r)n(eturn)i(vacuous)h(solution)f
Fp(137b)p Fo(i)129 1852 y(h)p Fn(r)n(ewrite)f(rules)g
Fp(97a)p Fo(i)129 1901 y(h)p Fn(r)n(ewrite)g(rules)g
Fp(294c)p Fo(i)129 1951 y(h)p Fn(rules)h(to)g(build)g(che)n(ck)g(addr)n
(ess)g Fp(307)p Fo(i)129 2001 y(h)p Fn(set)g Fr(answer)f
Fn(to)h(single)f Fr(if)h Fn(statement)g Fp(297a)p Fo(i)129
2051 y(h)p Fn(set)g Fr(data)f Fn(and)i Fr(limit)e Fn(in)h(a)g(new)g
Fr(rb->firstbuf)d Fp(385d)p Fo(i)129 2101 y(h)p Fn(set)j
Fr(grab)p Fn(,)f Fr(add)g Fn(and)i Fr(first)e Fn(for)g(left-to-right)f
Fp(66b)p Fo(i)129 2151 y(h)p Fn(set)i Fr(grab)p Fn(,)f
Fr(add)g Fn(and)i Fr(first)e Fn(for)g(right-to-left)f
Fp(66a)p Fo(i)129 2200 y(h)p Fn(set)i Fr(limit)f Fn(b)n(ase)n(d)h(on)h
Fr(ipt)e Fn(and)i(the)f(name)g(table)g Fp(249a)p Fo(i)129
2250 y(h)p Fn(set)g Fr(name)f Fn(to)h(the)g(pr)n(op)n(er)f(name)i(of)f
(the)g(\014eld)g(for)f Fr(e)h Fp(207b)p Fo(i)129 2300
y(h)p Fn(set)g Fr(nametable)e Fn(to)i(the)g(name)h(table,)e(che)n
(cking)h(for)g(c)n(onsistency)g Fp(242a)p Fo(i)129 2350
y(h)p Fn(show)g(last)g(answers)f(and)i(c)n(onditions)f
Fp(263b)p Fo(i)129 2400 y(h)p Fn(simplify)g(adisjunct)g
Fp(94b)p Fo(i)129 2449 y(h)p Fn(simplify)g(c)n(onditions)g
Fp(319a)p Fo(i)129 2499 y(h)p Fn(simplify)g(disjunct)g
Fp(94a)p Fo(i)p eop
%%Page: 421 421
421 420 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(421)145 258 y Fo(h)p Fn(simplify)14 b(e)n(quation)i
Fp(95c)p Fo(i)145 307 y(h)p Fn(simplify)e(if)h(statement)g
Fp(95d)p Fo(i)145 357 y(h)p Fn(simplify)f(instanc)n(e's)h(ar)n(gument)g
(table)g Fp(94d)p Fo(i)145 407 y(h)p Fn(simplify)f(p)n(attern)h
Fp(93b)p Fo(i)145 457 y(h)p Fn(simplify)f(set)h(of)g(c)n(onditions)g
Fp(94c)p Fo(i)145 507 y(h)p Fn(simplify)f(table)h Fp(95b)p
Fo(i)145 557 y(h)p Fn(simplify)f(tag)h(c)n(ase's)g(arm)g(table)f
Fp(95a)p Fo(i)145 606 y(h)p Fn(slow)h(p)n(ath)g(for)f(big-endian)i
(closur)n(e)e(emission)h Fp(390c)p Fo(i)145 656 y(h)p
Fn(slow)g(p)n(ath)g(for)f(big-endian)i(emission)f Fp(388b)p
Fo(i)145 706 y(h)p Fn(slow)g(p)n(ath)g(for)f(little-endian)g(closur)n
(e)h(emission)g Fp(390b)p Fo(i)145 756 y(h)p Fn(slow)g(p)n(ath)g(for)f
(little-endian)g(emission)h Fp(388a)p Fo(i)145 806 y(h)p
Fn(sort)g(memb)n(ers)f(of)h(typ)n(e)g Fp(47f)s Fo(i)145
855 y(h)p Fn(sp)n(arsely)g(p)n(opulate)n(d)g Fp(316c)p
Fo(i)145 905 y(h)p Fn(split)g(childr)n(en)f(into)h Fr(if)g
Fn(and)g(c)n(ase)g(tests,)f(and)i(make)f(c)n(ombination)h
Fr(answer)d Fp(296b)p Fo(i)145 955 y(h)p Fn(split)i(no)n(de)g
Fr(n)g Fn(and)g(add)h(childr)n(en)f(to)f(work)h(queue)g
Fp(276a)p Fo(i)145 1005 y(h)p Fn(strip)f Fr(fknown)g
Fn(of)h(c)n(onditions)g(alr)n(e)n(ady)g(in)g Fr(cknown)e
Fp(198c)p Fo(i)145 1055 y(h)p Fn(suck)j(initial)e(lab)n(els)g(into)h
Fr(l)g Fp(67b)p Fo(i)145 1104 y(h)p Fn(su\016x)g(with)g(up)n(date)g
Fp(204c)p Fo(i)145 1154 y(h)p Fn(sup)n(er)g(r)n(ewrite)e(rules)i
Fp(97b)p Fo(i)145 1204 y(h)p Fn(terminal)g(symb)n(ols)f
Fp(54b)p Fo(i)145 1254 y(h)p Fn(to)h(avoid)h(cir)n(cularity,)d(make)i
(sur)n(e)g Fr(type)f Fn(has)h(never)g(b)n(e)n(en)g(use)n(d)g
Fp(165b)p Fo(i)145 1304 y(h)p Fn(toplevel)g Fp(32a)p
Fo(i)145 1354 y(h)p Fn(tr)n(ansfer)f Fr(n)h Fn(bytes)g(fr)n(om)f
Fr(start)g Fp(400c)p Fo(i)145 1403 y(h)p Fn(turn)h(p)n(attern)g
Fr(p)g Fn(into)f(emitter)g(and)i(r)n(eturn)e(it)g Fp(190)p
Fo(i)145 1453 y(h)p Fn(typ)n(e)h(of)g Fr(cons)f Fp(234b)p
Fo(i)145 1503 y(h)p Fn(up)n(date)i(def-use)f(info)g(for)f
Fr(v)h Fp(140b)p Fo(i)145 1553 y(h)p Fn(up)n(date)h(def-use)f(info)g
(for)f Fr(vv)h Fp(140c)p Fo(i)145 1603 y(h)p Fn(usage)h(lines)f
Fp(9e)p Fo(i)145 1652 y(h)p Fn(use)h(auxiliaries)e(to)h(add)g(to)g
Fr(balances)p Fn(,)e Fr(neweqns)p Fn(,)g(and)j Fr(balmap)d
Fp(150a)p Fo(i)145 1702 y(h)p Fn(use)j Fr(newlyknown)c
Fn(to)j(make)g(mor)n(e)g(variables)f(known)i Fp(142c)p
Fo(i)145 1752 y(h)p Fn(using)g Fr(sigma)p Fn(,)d(push)j(c)n(onstants)f
(b)n(ack)g(into)g Fr(body)f Fn(and)i(out)f(of)g Fr(values)f
Fp(219d)p Fo(i)145 1802 y(h)p Fn(value)i(of)e Fr(ident)g
Fn(in)h Fr(rho)f Fp(25b)p Fo(i)145 1852 y(h)p Fn(verb)n(osely)h
(announc)n(e)i(binding)e Fp(43c)p Fo(i)145 1901 y(h)p
Fn(version)g(string)g Fp(9a)p Fo(i)145 1951 y(h)p Fn(warn)g(ab)n(out)g
(clash)g(in)g Fr(ii1)f Fp(33c)p Fo(i)145 2001 y(h)p Fn(warn)h(if)f(no)i
Fr(bang)e Fp(46c)p Fo(i)145 2051 y(h)p Fn(warn)h(of)g(disc)n(ar)n(ding)
f Fr(i)h Fp(59a)p Fo(i)145 2101 y(h)p Fn(warn)g(of)g(r)n(e)n(dundant)g
(disjunct)g Fp(197b)p Fo(i)145 2151 y(h)p Fn(what)g(we)g(might)f(write)
g(if)g(we)h(wer)n(e)f(doing)h(this)g(with)f(r)n(ewrite)f(rules)h
Fp(178b)p Fo(i)145 2200 y(h)p Fn(write)g(de\014nitions)i(of)e(al)r(l)h
(instanc)n(e)g(typ)n(es)g Fp(230b)p Fo(i)145 2250 y(h)p
Fn(write)f(PostScript)h(for)f(le)n(dger)g(p)n(ap)n(er)h
Fp(22a)p Fo(i)145 2300 y(h)p Fn(write)f(tag)h(de\014nitions)h(for)e
(typ)n(e)n(d)h Fr(kept_constructors)c Fp(232b)p Fo(i)145
2350 y(h)p Fn(write)j(tag)h(de\014nitions)h(for)e(typ)n(e)n(d)h
Fr(kept_constructors)c Fp(236b)p Fo(i)p eop
%%Page: 422 422
422 421 bop 129 141 a Fv(422)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fj(24.2)66 b(Index)129 349 y Fr(aalwaysmatches)p
Fv(:)34 b(273b)p 483 356 86 2 v -1 w(,)14 b(278)129 399
y Fr(absolute_field)p Fv(:)40 b(85a,)14 b(93a,)h(104a,)171
449 y(117c,)f(122b,)g(268)p 390 456 63 2 v -1 w(,)g(271a,)f(298b,)h
(301a,)171 498 y(335b,)f(346c,)g(371b,)f(372a)129 548
y Fr(absolute_fields)p Fv(:)34 b(298b)p 505 555 86 2
v 129 598 a Fr(aconstraint)p Fv(:)h(269,)12 b(270b)p
505 605 V 129 648 a Fr(adalwaysmatches)p Fv(:)34 b(273a,)12
b(273b)p 613 655 V -1 w(,)i(370b)129 698 y Fr(addarms)p
Fv(:)35 b(296b,)13 b(299c)p 441 705 81 2 v 129 747 a
Fr(addconst)p Fv(:)35 b(114a)p 352 754 84 2 v -1 w(,)14
b(329g,)e(342c)129 797 y Fr(add_decls)p Fv(:)35 b(296a,)12
b(297c)p 482 804 81 2 v(,)h(301a)129 847 y Fr(add_fits_conditions_)o
(and_)o(sanit)o(ize)p Fv(:)171 897 y(190,)g(199b)p 259
904 86 2 v 129 947 a Fr(addinterval)p Fv(:)35 b(196a,)12
b(288a)p 526 954 84 2 v -1 w(,)h(291b)129 997 y Fr(addlc)p
Fv(:)36 b(396b)p 287 1004 86 2 v -1 w(,)14 b(397b,)e(397c)129
1046 y Fr(addnset)p Fv(:)35 b(149d,)13 b(149e)p 441 1053
81 2 v(,)g(151c)129 1096 y Fr(add_overlap_field)p Fv(:)33
b(195,)13 b(196a)p 636 1103 84 2 v 129 1146 a Fr(address)p
Fv(:)42 b(47a,)15 b(51b,)g(81,)g(190,)g(192,)171 1196
y(193d,)e(302c,)g(302d,)g(303a,)g(303b,)g(383a)p 719
1203 V -1 w(,)171 1246 y(383b,)g(399f,)f(399g,)g(403c)129
1295 y Fr(address_add)p Fv(:)35 b(297c,)13 b(301a,)f(302c)p
632 1302 81 2 v 129 1345 a Fr(address_to_integer)p Fv(:)37
b(296a,)14 b(296b,)171 1395 y(297a,)e(301a,)h(303a)p
388 1402 84 2 v 129 1445 a Fr(addr_new)p Fv(:)35 b(322,)13
b(412b)129 1495 y Fr(add_to_frame)p Fv(:)34 b(26a)p 439
1502 63 2 v(,)13 b(162b)129 1544 y Fr(add_to_rho)p Fv(:)35
b(26a)p 396 1551 V -1 w(,)13 b(56,)g(169,)g(262a)129
1594 y Fr(add_to_table)p Fv(:)34 b(95b,)13 b(126b,)g(126d)p
640 1601 86 2 v 129 1644 a Fr(adisjunct)p Fv(:)42 b(85a,)15
b(93a,)g(94b,)g(103a,)171 1694 y(117b,)f(122a,)g(268)p
393 1701 63 2 v -1 w(,)h(269,)f(279a,)g(370b,)171 1744
y(372a)129 1794 y Fr(afield)p Fv(:)36 b(270b,)12 b(271a)p
419 1801 84 2 v 129 1843 a Fr(afieldexp)p Fv(:)39 b(93a,)14
b(296b,)g(297a,)g(297c,)171 1893 y(299a)p 171 1900 V
-1 w(,)f(299c,)g(335b,)g(346c)129 1943 y Fr(afield_var)p
Fv(:)35 b(264,)12 b(265c)p 483 1950 81 2 v 129 1993 a
Fr(afield_vars)p Fv(:)35 b(264,)12 b(265c)p 505 2000
V 129 2043 a Fr(afield_vars_inverse)p Fv(:)33 b(264,)13
b(265c)p 680 2050 V 129 2092 a Fr(align)p Fv(:)36 b(397c)p
287 2099 V 129 2142 a Fr(all_disjuncts_ids)p Fv(:)d(58)p
548 2149 42 2 v(,)13 b(59b,)g(260)129 2192 y Fr(alternates)p
Fv(:)35 b(22c)p 396 2199 60 2 v(,)13 b(23a,)g(374)129
2242 y Fr(alternator)p Fv(:)35 b(22c)p 396 2249 V 129
2292 a Fr(always_fail)p Fv(:)g(260,)12 b(262b)p 505 2299
86 2 v 129 2342 a Fr(andp)p Fv(:)36 b(63a)p 265 2349
63 2 v -1 w(,)14 b(75)129 2391 y Fr(andpx)p Fv(:)36 b(63a,)12
b(65b)p 374 2398 65 2 v 129 2441 a Fr(anf)p Fv(:)36 b(260,)13
b(269)p 331 2448 63 2 v 129 2491 a Fr(anfd)p Fv(:)36
b(269)p 265 2498 V 866 349 a Fr(answers_eq)p Fv(:)f(266a,)12
b(266b)p 1241 356 86 2 v 866 399 a Fr(apply)p Fv(:)38
b(133d,)13 b(277a,)g(278)p 1246 406 63 2 v -1 w(,)h(406a,)f(406b,)908
449 y(407b,)f(407c)866 498 y Fr(apply_closure)p Fv(:)34
b(407b)p 1198 505 86 2 v -1 w(,)14 b(407c)p 1309 505
81 2 v 866 548 a Fr(apply_constructor)p Fv(:)33 b(75,)13
b(173a)p 1352 555 84 2 v 866 598 a Fr(ApplyMethod)p Fv(:)34
b(226,)13 b(406a)p 1242 605 V -1 w(,)g(406b)866 648 y
Fr(apply_subst)p Fv(:)37 b(215,)13 b(218,)g(219c,)h(219d,)908
698 y(220b,)e(225a)p 1018 705 V 866 747 a Fr(apply_subst_list)p
Fv(:)33 b(225a)p 1263 754 V 866 797 a Fr(app_to_instance)p
Fv(:)h(173b)p 1242 804 86 2 v -1 w(,)13 b(176)866 847
y Fr(arg_decls)p Fv(:)37 b(204a)p 1113 854 84 2 v -1
w(,)14 b(213a,)f(213b,)h(214a,)908 897 y(246)866 947
y Fr(argtable)p Fv(:)35 b(173a,)12 b(173b,)h(174a)p 1308
954 V 866 997 a Fr(arm)p Fv(:)36 b(51a,)13 b(96a,)g(102a,)f(181b,)h
(260,)g(261b,)908 1046 y(261c,)h(263a,)f(271b)p 1124
1053 86 2 v -1 w(,)i(273a,)e(274,)h(275a,)908 1096 y(275b,)e(275c,)i
(280b,)e(301a,)h(301b,)f(372a)866 1146 y Fr(arm_conditions_alwa)o
(ys_sa)o(tisf)o(ied)p Fv(:)908 1196 y(283a,)g(283b)p
1016 1203 V 866 1246 a Fr(armscode)p Fv(:)35 b(295b,)13
b(301a,)f(302a)p 1308 1253 84 2 v 866 1295 a Fr(arraycandidates)p
Fv(:)34 b(291b)p 1242 1302 86 2 v -1 w(,)13 b(292a)866
1345 y Fr(arrow)p Fv(:)36 b(217)p 1024 1352 63 2 v -1
w(,)13 b(219d,)g(220a,)f(225a,)h(225b)866 1395 y Fr(asmgrammarfilename)
p Fv(:)33 b(10e,)14 b(18a)p 1393 1402 V -1 w(,)g(18b,)908
1445 y(20)866 1495 y Fr(asmopcode)p Fv(:)35 b(52c,)13
b(239a)p 1196 1502 84 2 v 866 1544 a Fr(asmoperand)p
Fv(:)35 b(52c,)13 b(241b)p 1218 1551 86 2 v 866 1594
a Fr(asmoperands)p Fv(:)34 b(238a,)13 b(243a)p 1263 1601
84 2 v -1 w(,)g(246,)g(254)866 1644 y Fr(asmprinter)p
Fv(:)35 b(409a)p 1133 1651 V 866 1694 a Fr(asmprintf)p
Fv(:)g(248,)12 b(322,)h(408d,)g(409a)p 1397 1701 V 866
1744 a Fr(asmprintfd)p Fv(:)38 b(248,)14 b(251b,)g(322,)g(408d,)908
1794 y(409a)p 908 1801 V 866 1843 a Fr(asmprintreloc)p
Fv(:)34 b(247,)13 b(322,)f(409a)p 1373 1850 V 866 1893
a Fr(asmsyntax)p Fv(:)35 b(243a)p 1111 1900 V -1 w(,)13
b(244a)866 1943 y Fr(assembler_proc_clas)o(s)p Fv(:)34
b(245)p 1351 1950 63 2 v -1 w(,)13 b(246)866 1993 y Fr
(assembler_proc_name)o Fv(:)40 b(245)p 1335 2000 V -1
w(,)15 b(246,)908 2043 y(250b)866 2092 y Fr(assoc)p Fv(:)36
b(111b)p 1024 2099 86 2 v -1 w(,)13 b(112a)866 2142 y
Fr(astimage)p Fv(:)35 b(377a)p 1089 2149 84 2 v -1 w(,)13
b(377b)866 2192 y Fr(atomicid)p Fv(:)35 b(39b,)13 b(40b)p
1179 2199 65 2 v 866 2242 a Fr(badarg)p Fv(:)35 b(175a,)13
b(175c,)g(176,)g(177c)p 1348 2249 81 2 v 866 2292 a Fr
(bad_operand_name)p Fv(:)33 b(248,)13 b(357b)p 1351 2299
86 2 v 866 2342 a Fr(balance)p Fv(:)41 b(118c,)15 b(125a,)f(139b,)h
(141a)p 1404 2349 84 2 v -1 w(,)908 2391 y(143a,)d(150a,)h(152a,)f
(152b,)h(154)866 2441 y Fr(balance_completed)p Fv(:)33
b(142b)p 1285 2448 86 2 v(,)13 b(143b)866 2491 y Fr(balanced_eqns)p
Fv(:)34 b(148b)p 1198 2498 V eop
%%Page: 423 423
423 422 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(423)145 258 y Fr(balance_eqns)p Fv(:)34 b(148b)p 455
265 86 2 v(,)13 b(161a,)f(260,)h(264)145 307 y Fr(baldebug)p
Fv(:)35 b(11b,)13 b(11c)p 458 314 60 2 v(,)g(157)145
357 y Fr(balimage)p Fv(:)39 b(139b,)14 b(143a,)g(150a,)f(152a,)187
407 y(152b,)f(154,)h(156b)p 385 414 86 2 v 145 457 a
Fr(balitem)p Fv(:)41 b(118c,)15 b(125a,)f(139b,)h(141a)p
683 464 84 2 v -1 w(,)187 507 y(141b,)d(150a,)h(152a,)f(152b,)h(154)145
557 y Fr(balpass1)p Fv(:)35 b(148a)p 368 564 V -1 w(,)13
b(148b)145 606 y Fr(balsub_f)p Fv(:)35 b(148b,)13 b(149a)p
479 613 V 145 656 a Fr(barpm_d)p Fv(:)35 b(57)p 346 663
42 2 v 145 706 a Fr(bc_halt)p Fv(:)g(227a)145 756 y Fr
(binary_conjunction)p Fv(:)e(187a)p 586 763 84 2 v 145
806 a Fr(binaryint)p Fv(:)i(363a,)12 b(364d)p 498 813
86 2 v 145 855 a Fr(bind_and_remove_pat)o(label)o(_nam)o(es)p
Fv(:)187 905 y(57)p 187 912 42 2 v -1 w(,)i(170a)145
955 y Fr(bind_condition)p Fv(:)34 b(80a)p 499 962 63
2 v -1 w(,)13 b(170a,)g(172a)145 1005 y Fr(bind_condition_d)p
Fv(:)33 b(80a)p 542 1012 V 145 1055 a Fr(bindingimage)p
Fv(:)h(103a,)13 b(103b)p 564 1062 86 2 v 145 1104 a Fr
(binding_instance)p Fv(:)34 b(77b)p 543 1111 65 2 v -1
w(,)14 b(104b,)e(177a,)187 1154 y(177b)145 1204 y Fr
(binding_instance_in)o(put_n)o(ame)p Fv(:)187 1254 y(182a,)g(182b)p
295 1261 86 2 v 145 1304 a Fr(binding_instance_va)o(r)p
Fv(:)36 b(180,)14 b(181c)p 721 1311 81 2 v -1 w(,)187
1354 y(182a)145 1403 y Fr(binding_subst_f)p Fv(:)34 b(76b)p
521 1410 65 2 v -1 w(,)14 b(77a)145 1453 y Fr(Bindlist)p
Fv(:)35 b(37c)p 368 1460 60 2 v 145 1503 a Fr(bind_patlabel_names)o
Fv(:)f(57)p 608 1510 42 2 v -1 w(,)14 b(260)145 1553
y Fr(binop)p Fv(:)36 b(49c,)13 b(113a)p 388 1560 84 2
v -1 w(,)g(193a,)g(264,)f(270a)145 1603 y Fr(bit_numbering_set)p
Fv(:)33 b(36a,)13 b(36b)p 652 1610 65 2 v -1 w(,)h(36c)145
1652 y Fr(bit_numbering_used)p Fv(:)34 b(35c,)13 b(36b)p
672 1659 V(,)g(36c,)187 1702 y(115a)145 1752 y Fr(bitsizeof)p
Fv(:)35 b(115a,)12 b(115b,)h(115c)p 609 1759 81 2 v(,)g(153e)145
1802 y Fr(bits_to_pcunits)p Fv(:)34 b(59c,)13 b(64b)p
606 1809 65 2 v(,)g(269)145 1852 y Fr(bit_zero_is_lsb)p
Fv(:)39 b(32a)p 526 1859 63 2 v(,)15 b(32b,)f(35c,)187
1901 y(36a,)e(115b)145 1951 y Fr(block_address)p Fv(:)34
b(399f)p 477 1958 75 2 v 145 2001 a Fr(block_address_known)o
Fv(:)g(399f)p 608 2008 V 145 2051 a Fr(block_copy)p Fv(:)h(400b)p
412 2058 86 2 v -1 w(,)13 b(401c,)g(402a)145 2101 y Fr(block_defined)p
Fv(:)34 b(398b)p 477 2108 V -1 w(,)14 b(404a)145 2151
y Fr(block_fetchb)p Fv(:)34 b(402a)p 455 2158 84 2 v
-1 w(,)14 b(403a)145 2200 y Fr(block_fetchl)p Fv(:)34
b(401c)p 455 2207 81 2 v(,)13 b(403a)145 2250 y Fr(block_fetchm)p
Fv(:)34 b(403a)p 455 2257 84 2 v 145 2300 a Fr(block_label)p
Fv(:)g(322,)13 b(399a)p 521 2307 V 145 2350 a Fr(block_lc)p
Fv(:)35 b(397a)p 368 2357 V 145 2400 a Fr(block_low)p
Fv(:)g(397a)p 390 2407 V 145 2449 a Fr(block_new)p Fv(:)g(322,)12
b(398d)p 477 2456 86 2 v 145 2499 a Fr(block_size)p Fv(:)35
b(400a)p 412 2506 84 2 v 882 258 a Fr(block_write)p Fv(:)f(400d)p
1170 265 86 2 v 882 307 a Fr(bogus)p Fv(:)i(13f,)12 b(24,)h(26a,)g
(34a,)f(116b)p 1361 314 V(,)h(361a)882 357 y Fr(bogus_buffer)p
Fv(:)34 b(385c)p 1192 364 81 2 v 882 407 a Fr(bracket)p
Fv(:)41 b(102b,)14 b(102c,)h(103a,)g(104a,)924 457 y(104c,)e(105a,)g
(105d,)g(106a,)g(106b,)g(106c,)924 507 y(106d,)g(107a,)g(107b,)g(107d,)
g(107f,)f(108b,)924 557 y(108c,)h(109b,)f(110a,)h(110b,)f(111b)p
1359 564 86 2 v 882 606 a Fr(branch)p Fv(:)39 b(159)p
1065 613 63 2 v -1 w(,)15 b(161a,)e(165d,)h(190,)g(192,)924
656 y(193b)882 706 y Fr(branchfactor)p Fv(:)34 b(274,)13
b(281d)p 1280 713 86 2 v 882 756 a Fr(Buffer)p Fv(:)36
b(381)p 1062 763 63 2 v -1 w(,)14 b(382b,)f(391a,)f(400c,)i(401a,)924
806 y(401b)882 855 y Fr(buffer_at_lc)p Fv(:)34 b(401a)p
1192 862 84 2 v 882 905 a Fr(BUFSZ)p Fv(:)26 b(390e,)13
b(391a,)g(398d,)f(410)p 1355 912 63 2 v 882 955 a Fr(Carm)p
Fv(:)36 b(331a,)12 b(331d)p 1126 962 86 2 v 882 1005
a Fr(CASELINE)p Fv(:)26 b(51a,)12 b(54b)p 1183 1012 65
2 v(,)h(359b)p 1273 1012 86 2 v(,)g(360a,)f(361a)882
1055 y Fr(case_to_emitter)p Fv(:)33 b(188b,)13 b(189b)p
1368 1062 V 882 1104 a Fr(Cassoc)p Fv(:)35 b(335c)p 1061
1111 81 2 v(,)13 b(336a)882 1154 y Fr(cat_adjacent_strin)o(gs)p
Fv(:)37 b(53c,)15 b(53d,)924 1204 y(54a)p 924 1211 63
2 v 882 1254 a Fr(Cbracket)p Fv(:)39 b(326a,)14 b(326b,)g(327a,)f
(327c,)924 1304 y(327d,)g(328a,)f(328c,)i(328d,)f(329g,)f(330b,)924
1354 y(330f,)g(332b,)h(334b,)f(335c)p 1245 1361 81 2
v 882 1403 a Fr(cdebug)p Fv(:)41 b(11e,)15 b(18a)p 1154
1410 63 2 v -1 w(,)g(308,)f(310,)h(314d,)924 1453 y(314e,)e(315a,)f
(317)882 1503 y Fr(c_function_declara)o(tion)p Fv(:)39
b(213a,)924 1553 y(214a,)12 b(234a,)g(338b)p 1140 1560
86 2 v 882 1603 a Fr(charconst)p Fv(:)35 b(363a,)12 b(365b)p
1235 1610 V 882 1652 a Fr(check_namespec)p Fv(:)34 b(242a,)12
b(354a,)g(355d)p 1452 1659 V 882 1702 a Fr(checktree)p
Fv(:)35 b(22b,)13 b(284a)p 1217 1709 84 2 v 882 1752
a Fr(childarms)p Fv(:)35 b(274,)12 b(281a)p 1214 1759
V -1 w(,)i(281b)882 1802 y Fr(childdisjuncts)p Fv(:)34
b(274,)12 b(281c)p 1323 1809 81 2 v 882 1852 a Fr(chkr_input_tbl)p
Fv(:)34 b(308)p 1236 1859 63 2 v -1 w(,)13 b(309,)g(311a)882
1901 y Fr(cl_emitb)p Fv(:)35 b(389b,)13 b(390a)p 1216
1908 84 2 v 882 1951 a Fr(cl_emitl)p Fv(:)35 b(389b,)13
b(389c)p 1216 1958 81 2 v -1 w(,)h(390b,)e(390c)882 2001
y Fr(cl_emitm)p Fv(:)35 b(389b)p 1105 2008 86 2 v 882
2051 a Fr(closure_function)p Fv(:)e(218,)13 b(227a)p
1367 2058 84 2 v 882 2101 a Fr(closure_functions_)o(postf)o(ix)p
Fv(:)36 b(226)p 1478 2108 63 2 v -1 w(,)924 2151 y(227a)882
2200 y Fr(ClosureHeader)p Fv(:)i(208b,)14 b(406a)p 1330
2207 84 2 v -1 w(,)g(407d,)924 2250 y(408a,)e(408b,)h(408c)882
2300 y Fr(closure_header_typ)o(e)p Fv(:)34 b(218,)12
b(228)p 1432 2307 63 2 v 882 2350 a Fr(ClosureLocation)p
Fv(:)33 b(208b,)13 b(406a)p 1368 2357 84 2 v 882 2400
a Fr(closurenametab)p Fv(:)34 b(205a,)12 b(207a)p 1344
2407 V 882 2449 a Fr(ClosurePostfix)p Fv(:)34 b(226,)12
b(406b)p 1323 2456 86 2 v eop
%%Page: 424 424
424 423 bop 129 141 a Fv(424)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fr(closure_type)p Fv(:)34 b(218,)13
b(224a)p 527 265 84 2 v 129 307 a Fr(Cnoreserve)p Fv(:)35
b(213a,)13 b(213b,)g(214a,)f(231a,)171 357 y(246,)h(254,)f(330e,)h
(337a)p 452 364 V 129 407 a Fr(codeheader)p Fv(:)35 b(21a,)12
b(50c)p 483 414 60 2 v(,)i(51a)129 457 y Fr(codelex)p
Fv(:)35 b(21a,)13 b(365a)p 418 464 84 2 v 129 507 a Fr(CODELINE)p
Fv(:)30 b(51a,)15 b(54b)p 437 514 65 2 v(,)h(359b)p 530
514 86 2 v -1 w(,)g(360a,)171 557 y(361a,)c(361b)129
606 y Fr(codeline)p Fv(:)35 b(294d,)13 b(295a)p 463 613
84 2 v -1 w(,)g(295b,)g(302a)129 656 y Fr(CODELINE)p
Fv(:)30 b(51a,)15 b(54b)p 437 663 65 2 v(,)h(359b)p 530
663 86 2 v -1 w(,)g(360a,)171 706 y(361a,)c(361b)129
756 y Fr(colon_mark)p Fv(:)35 b(39b,)13 b(40a)p 486 763
63 2 v 129 806 a Fr(colons_to_labels)p Fv(:)34 b(39b,)13
b(40a)p 617 813 V 129 855 a Fr(combinechildren)p Fv(:)34
b(290b,)12 b(291b)p 615 862 86 2 v 129 905 a Fr(command_line)p
Fv(:)34 b(20)p 439 912 42 2 v 129 955 a Fr(compose)p
Fv(:)41 b(221b,)15 b(222a,)f(222b,)g(223c,)171 1005 y(224b)p
171 1012 86 2 v 129 1055 a Fr(computable)p Fv(:)37 b(138,)14
b(139c)p 487 1062 81 2 v -1 w(,)h(142b,)e(142c,)171 1104
y(143b,)g(145c)129 1154 y Fr(concat_sequences)p Fv(:)34
b(64a,)12 b(65a)p 614 1161 63 2 v 129 1204 a Fr(conditions_with_narr)o
(ows_)o(check)o Fv(:)171 1254 y(190,)h(192,)f(200a)p
346 1261 84 2 v 129 1304 a Fr(conjoin)p Fv(:)35 b(68a,)13
b(68b,)g(186b,)g(186c)p 619 1311 81 2 v 129 1354 a Fr
(conjoin_conditions)p Fv(:)33 b(64a,)13 b(64c)p 658 1361
60 2 v(,)g(65b)129 1403 y Fr(consinput_pattern)p Fv(:)32
b(169,)12 b(171a)p 634 1410 84 2 v -1 w(,)h(262a)129
1453 y Fr(conslist)p Fv(:)35 b(32a)p 352 1460 63 2 v
-1 w(,)14 b(32b,)f(33d,)g(160)129 1503 y Fr(consname2asm)p
Fv(:)34 b(238a)p 439 1510 84 2 v -1 w(,)14 b(246,)e(254)129
1553 y Fr(cons_named)p Fv(:)35 b(41b,)13 b(79b,)g(167a)p
576 1560 V -1 w(,)g(176)129 1603 y Fr(conspat)p Fv(:)35
b(61)p 330 1610 42 2 v(,)13 b(76a,)g(77a,)g(162b)129
1652 y Fr(constant)p Fv(:)41 b(77a,)14 b(105d,)g(113a,)g(114b)p
669 1659 86 2 v(,)171 1702 y(116a,)f(144b,)g(219d,)g(270b,)f(283a,)h
(327a,)171 1752 y(341a,)f(349a,)h(350,)f(351a,)h(363a)129
1802 y Fr(constemplate)p Fv(:)34 b(160,)13 b(161a)p 527
1809 84 2 v 129 1852 a Fr(constraint)p Fv(:)39 b(22c,)14
b(41a,)g(55)p 575 1859 42 2 v -1 w(,)h(61,)f(62a,)171
1901 y(68e,)f(68f,)f(69a,)g(70a,)h(71a,)f(71b,)h(71c,)g(75,)171
1951 y(77a,)g(85a,)g(93a,)g(94a,)g(94b,)g(104a,)g(117c,)171
2001 y(122b,)i(138,)f(143c,)h(195,)g(264,)f(270b,)171
2051 y(273b,)f(279a,)g(282a,)f(282b,)h(285b,)g(320a,)171
2101 y(371a,)f(372a)129 2151 y Fr(constraint_fields)p
Fv(:)33 b(296a,)13 b(298b)p 657 2158 86 2 v 129 2200
a Fr(constraintimage)p Fv(:)38 b(69a,)13 b(195,)h(370b,)171
2250 y(370d,)f(371a)p 282 2257 84 2 v -1 w(,)g(371a)p
390 2257 V 129 2300 a Fr(constraint_or_bindin)o(g)p Fv(:)34
b(76a,)12 b(77a)p 723 2307 63 2 v 129 2350 a Fr(constraints)p
Fv(:)35 b(22c,)14 b(23a,)f(55,)g(65c,)g(67a,)171 2400
y(70a,)h(70b,)g(71a,)g(71b,)g(71c,)h(73b,)f(93a,)171
2449 y(94a,)f(104a,)h(117b,)f(122a,)g(136a)p 589 2456
84 2 v -1 w(,)i(136b,)171 2499 y(137a,)e(138,)h(140a,)f(143b,)h(143c,)g
(145d,)908 258 y(170a,)h(195,)g(264,)g(266a,)g(268,)g(269,)908
307 y(273a,)f(278,)g(283a,)f(283b,)h(298b,)g(300,)908
357 y(314d,)e(370d,)h(372a,)g(374,)f(375a,)h(377c)866
407 y Fr(constraints2pattern)o Fv(:)34 b(61)p 1329 414
42 2 v(,)13 b(62a,)g(77a,)908 457 y(170b,)f(172b,)h(262a)866
507 y Fr(constructor)p Fv(:)40 b(14f,)15 b(17a,)f(32a,)h(32b,)908
557 y(41a,)f(46b,)g(49c,)h(81,)f(104b,)g(159)p 1355 564
63 2 v -1 w(,)h(160,)908 606 y(161a,)e(161b,)g(161c,)g(162a,)g(165d,)g
(166c,)908 656 y(166d,)g(167a,)g(167b,)h(171a,)f(176,)h(181b,)908
706 y(190,)g(192,)g(193c,)h(193d,)f(197b,)g(208c,)908
756 y(209a,)f(210b,)h(211a,)f(215,)g(224a,)h(232a,)908
806 y(243a,)e(243b,)h(243c,)g(367)866 855 y Fr(constructors)p
Fv(:)38 b(32a)p 1180 862 V -1 w(,)14 b(32b,)g(33d,)g(44a,)908
905 y(48b,)g(160,)g(165b,)g(165e,)h(167a,)e(167b,)908
955 y(183c,)g(190,)f(202a,)h(202b,)g(230b)866 1005 y
Fr(constructors_applie)o(d_in)p Fv(:)39 b(79b)p 1422
1012 65 2 v -1 w(,)908 1055 y(210b,)12 b(211a)866 1104
y Fr(ConstType)p Fv(:)35 b(44a,)12 b(45d)p 1198 1111
V 866 1154 a Fr(constype)p Fv(:)38 b(17a,)14 b(32b,)f(33d,)h(45d,)g
(46b,)908 1204 y(104b,)g(159)p 1020 1211 63 2 v -1 w(,)h(164a,)f(169,)g
(171a,)f(171b,)908 1254 y(172a,)g(174a,)g(189a,)h(203,)f(204a,)h(208a,)
908 1304 y(211a,)g(242b,)g(247,)g(250a,)g(256,)g(262a,)908
1354 y(311a,)e(317)866 1403 y Fr(constype_pattern)p Fv(:)41
b(171a,)15 b(171b)p 1382 1410 86 2 v -1 w(,)908 1453
y(233b)866 1503 y Fr(consume)p Fv(:)35 b(20,)13 b(21c)p
1134 1510 60 2 v 866 1553 a Fr(consume_globs)p Fv(:)34
b(239b,)13 b(239c)p 1309 1560 81 2 v -1 w(,)h(240a)866
1603 y Fr(Cop)p Fv(:)36 b(326a,)12 b(336b)p 1088 1610
86 2 v 866 1652 a Fr(counter_names)p Fv(:)34 b(231a,)12
b(234a)p 1306 1659 84 2 v 866 1702 a Fr(covers)p Fv(:)35
b(290b,)13 b(290c)p 1156 1709 81 2 v 866 1752 a Fr(Cprec)p
Fv(:)37 b(326a,)12 b(326c,)i(326d,)f(327a,)f(327c,)908
1802 y(327d,)h(328a,)g(328c,)h(328d,)f(330b,)g(330f,)908
1852 y(331e,)g(332b,)g(334b,)f(335c)p 1235 1859 V(,)h(336a)866
1901 y Fr(crb)p Fv(:)36 b(384a)p 980 1908 84 2 v -1 w(,)13
b(408a)866 1951 y Fr(create_constype_pri)o(nt_pr)o(oc)p
Fv(:)34 b(247,)908 2001 y(250a)p 908 2008 V 866 2051
a Fr(create_field_nonter)o(minal)o Fv(:)k(254,)908 2101
y(257)p 908 2108 63 2 v 866 2151 a Fr(create_input_print_)o(proc)p
Fv(:)h(246,)908 2200 y(247)p 908 2207 V 866 2250 a Fr
(create_integer_prin)o(t_pro)o(c)p Fv(:)d(247,)908 2300
y(248)p 908 2307 V 866 2350 a Fr(crhs)p Fv(:)41 b(160,)15
b(168)p 1097 2357 V -1 w(,)g(172a,)f(173a,)g(188b,)908
2400 y(233a,)e(308)866 2449 y Fr(Ctest)p Fv(:)36 b(331a,)12
b(331c)p 1132 2456 81 2 v eop
%%Page: 425 425
425 424 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(425)145 258 y Fr(Cuncomment)p Fv(:)37 b(17a,)14 b(331e,)f(332a)p
609 265 84 2 v -1 w(,)i(334a,)187 307 y(334c)145 357
y Fr(cur_pc)p Fv(:)35 b(329a,)12 b(329d,)g(342d,)g(403c)p
652 364 81 2 v(,)h(412a)145 407 y Fr(cur_pc_known)p Fv(:)34
b(329d,)13 b(403c)p 566 414 V(,)g(412a)145 457 y Fr(currb)p
Fv(:)36 b(384a,)13 b(385a,)f(385b,)h(385e)p 631 464 V(,)h(386b,)187
507 y(387a,)f(388a,)f(388b,)h(388c,)h(391a,)f(396b,)187
557 y(396c,)g(397a,)f(397b,)h(400a,)f(403c,)h(404a)145
606 y Fr(currb_p)p Fv(:)41 b(384a,)14 b(385a,)h(385b,)f(385e)p
685 613 V(,)187 656 y(386b,)f(387a,)g(388a,)f(388b,)h(388c,)h(391a,)187
706 y(392b,)f(393c,)h(394c,)f(395a,)g(395b,)g(395c,)187
756 y(396b,)f(396c,)i(397b)145 806 y Fr(currb_safe)p
Fv(:)35 b(384a,)13 b(385b,)g(385e)p 632 813 V -1 w(,)h(386b,)187
855 y(387a,)e(388c,)h(392b,)g(393c,)g(394c,)g(396c)145
905 y Fr(debug)p Fv(:)38 b(11a,)13 b(11b,)h(11d,)g(11e,)g(11f,)f(11g,)
187 955 y(11h,)i(11i,)f(11j,)g(11k,)h(11l,)f(12a,)h(19a,)187
1005 y(136a,)e(137a,)g(138,)h(139b,)f(140a,)h(142b,)187
1055 y(143a,)e(143b,)h(143c,)h(144b,)f(145b,)g(145d,)187
1104 y(145e,)h(148b,)f(150a,)h(152a,)f(152b,)h(154,)187
1154 y(157,)e(376a)p 274 1161 84 2 v 145 1204 a Fr(debug_off)p
Fv(:)35 b(376a)p 390 1211 V 145 1254 a Fr(debug_on)p
Fv(:)g(11k,)13 b(376a)p 457 1261 V 145 1304 a Fr(debug_pop)p
Fv(:)35 b(376a)p 390 1311 V 145 1354 a Fr(debugs)p Fv(:)g(19a,)13
b(136a,)g(145e,)g(376a)p 627 1361 V 145 1403 a Fr(debugstack)p
Fv(:)35 b(376a)p 412 1410 V 145 1453 a Fr(decimalint)p
Fv(:)g(363a,)12 b(364e)p 520 1460 81 2 v 145 1503 a Fr
(declare_counter_fun)o(s)p Fv(:)34 b(230a,)12 b(234a)p
738 1510 84 2 v 145 1553 a Fr(declare_counters)p Fv(:)33
b(232a,)13 b(234a)p 651 1560 V 145 1603 a Fr(declare_counter_typ)o(es)p
Fv(:)32 b(230a,)12 b(234a)p 758 1610 V 145 1652 a Fr(deferror)p
Fv(:)35 b(26a,)13 b(28a)p 456 1659 63 2 v -1 w(,)g(35a,)g(35b,)g(47d)
145 1702 y Fr(define_counter_funs)o Fv(:)34 b(232a,)12
b(234a)p 716 1709 84 2 v 145 1752 a Fr(defined)p Fv(:)39
b(28a,)14 b(32a,)f(37a,)h(72b,)g(136a)p 707 1759 V -1
w(,)187 1802 y(136b,)f(137a,)g(140b,)g(140c,)g(145e,)h(165d,)187
1852 y(312,)e(377c)145 1901 y Fr(defined_rbs)p Fv(:)34
b(399b,)13 b(399d,)g(399e)p 655 1908 81 2 v 145 1951
a Fr(deletematching)p Fv(:)34 b(284a,)12 b(284b)p 607
1958 86 2 v 145 2001 a Fr(destructive_subst)p Fv(:)33
b(90b,)13 b(91)p 654 2008 42 2 v 145 2051 a Fr(disassemblyfilename)o
Fv(:)40 b(12e,)15 b(18a)p 701 2058 63 2 v -1 w(,)187
2101 y(18b,)e(20)145 2151 y Fr(discard_cons_named)p Fv(:)33
b(48b,)13 b(167b)p 676 2158 86 2 v 145 2200 a Fr(disjunct)p
Fv(:)38 b(55)p 371 2207 42 2 v(,)14 b(56,)g(57,)g(60a,)f(60b,)h(61,)187
2250 y(62b,)g(62c,)h(64a,)f(65b,)g(85a,)g(93a,)g(94a,)187
2300 y(94b,)g(102c,)f(117b,)h(118b,)f(121a,)h(164b,)187
2350 y(193f,)f(193g,)g(205b,)g(206c,)h(206e,)g(209a,)187
2400 y(215,)h(216,)g(260,)g(265a,)g(279a,)g(317,)187
2449 y(370b,)d(372a)145 2499 y Fr(disjunctimage)p Fv(:)34
b(369d,)13 b(370b)p 588 2506 86 2 v 882 258 a Fr(disjunct_length)p
Fv(:)33 b(72c,)14 b(72d)p 1343 265 65 2 v 882 307 a Fr
(disjunct_to_emissi)o(on)p Fv(:)37 b(190,)14 b(192,)924
357 y(194b)p 924 364 86 2 v -1 w(,)f(205b,)g(209a,)f(215,)h(216)882
407 y Fr(do_conjoin)p Fv(:)34 b(186c,)14 b(187a)p 1255
414 84 2 v 882 457 a Fr(do_eliminate_insta)o(nces_)o(f)p
Fv(:)34 b(180)p 1454 464 63 2 v 882 507 a Fr(do_expwalk)p
Fv(:)j(84a,)13 b(117a)p 1239 514 84 2 v -1 w(,)h(117b,)g(117c,)924
557 y(117d,)f(118a,)f(118b,)h(118c,)h(119a,)e(119b,)924
606 y(119c)882 656 y Fr(do_gsubst)p Fv(:)37 b(88b,)13
b(89a,)g(89b,)h(89c,)g(90a,)924 706 y(120a)p 924 713
V -1 w(,)f(121a,)g(121b,)g(122a,)g(122b,)g(123a,)924
756 y(123b,)g(124a,)f(124b,)h(124c,)h(125a,)e(125b,)924
806 y(125c,)h(126a,)f(126b)882 855 y Fr(do_gsubst_children)o
Fv(:)34 b(120a)p 1323 862 V 882 905 a Fr(do_gsubst_conditio)o(ns)p
Fv(:)f(121a,)13 b(121b)p 1475 912 86 2 v 882 955 a Fr
(do_gsubst_sumprod_)o(table)o Fv(:)38 b(123a,)924 1005
y(126b)p 924 1012 V 882 1055 a Fr(do_gsubst_values_i)o(n_tab)o(le)p
Fv(:)e(90a)p 1478 1062 63 2 v -1 w(,)924 1104 y(122a)882
1154 y Fr(do_number_braces)p Fv(:)d(240b)p 1279 1161
86 2 v 882 1204 a Fr(do_pattern_to_case)o Fv(:)h(183b,)13
b(184a)p 1434 1211 84 2 v 882 1254 a Fr(do_slicetree)p
Fv(:)34 b(154)p 1192 1261 63 2 v 882 1304 a Fr(dotoutnode)p
Fv(:)g(374)p 1148 1311 V 882 1354 a Fr(dotouttree)p Fv(:)g(22b,)13
b(374)p 1238 1361 V 882 1403 a Fr(dots)p Fv(:)36 b(62c)p
1018 1410 60 2 v(,)13 b(65a,)g(67a,)f(68c,)i(370c,)f(370d)882
1453 y Fr(dots_pattern)p Fv(:)34 b(39b,)13 b(62c)p 1282
1460 V(,)g(377b)882 1503 y Fr(dots_sequent)p Fv(:)38
b(59c,)15 b(62c)p 1283 1510 V(,)f(85a,)g(93a,)924 1553
y(104a,)e(117b,)h(122b)882 1603 y Fr(dsubst)p Fv(:)35
b(90b)p 1061 1610 65 2 v(,)13 b(140a)882 1652 y Fr(dsubst_tab)p
Fv(:)34 b(90b)p 1148 1659 V(,)13 b(143b)882 1702 y Fr(dump_em)p
Fv(:)35 b(244a,)12 b(244c)p 1191 1709 81 2 v 882 1752
a Fr(Eand)p Fv(:)36 b(81)p 1018 1759 42 2 v(,)13 b(86a,)g(97a,)g(106a,)
f(112a,)h(118a,)924 1802 y(123b,)f(130a,)h(186b,)f(187a,)h(327c,)g
(341c)882 1852 y Fr(Eapp)p Fv(:)41 b(49b,)14 b(49c,)h(79b,)f(81)p
1292 1859 V(,)h(83b,)f(86e,)924 1901 y(110c,)f(118a,)g(124b,)g(133d,)g
(175a,)g(175c,)924 1951 y(176)882 2001 y Fr(early_branch)p
Fv(:)34 b(186b)p 1192 2008 86 2 v -1 w(,)14 b(190,)e(192)882
2051 y Fr(Ebinding_instance)p Fv(:)37 b(17a,)13 b(81)p
1393 2058 42 2 v(,)i(83b,)924 2101 y(86a,)e(108b,)h(118a,)f(124a,)h
(131e,)g(177a,)924 2151 y(177b,)e(178b,)h(178c,)g(180,)g(182a)882
2200 y Fr(Eclosure)p Fv(:)40 b(111a,)14 b(119c,)g(126a,)g(133f,)924
2250 y(218)p 924 2257 63 2 v 882 2300 a Fr(Eclosure_addr)p
Fv(:)36 b(81)p 1216 2307 42 2 v -1 w(,)14 b(83b,)g(87a,)f(111a,)924
2350 y(118a,)g(124b,)h(133e,)g(216,)f(220a,)h(227a,)924
2400 y(329e)882 2449 y Fr(Eclosure_loc)p Fv(:)38 b(81)p
1196 2456 V -1 w(,)15 b(83b,)f(87a,)g(111a,)p eop
%%Page: 426 426
426 425 bop 129 141 a Fv(426)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)171 258 y(118a,)g(124b,)g(133e,)h(209a,)e(227a,)h(329e,)
171 307 y(330a)129 357 y Fr(Eclosure_val)p Fv(:)38 b(81)p
443 364 42 2 v(,)14 b(83b,)g(87a,)g(111a,)171 407 y(118a,)e(124b,)h
(133e,)g(216,)g(220a,)f(329e)129 457 y Fr(edge)p Fv(:)36
b(272)p 265 464 63 2 v -1 w(,)14 b(274,)e(277a,)h(291b)129
507 y Fr(edgetostring)p Fv(:)34 b(289b,)13 b(290a)p 550
514 84 2 v 129 557 a Fr(Ediv)p Fv(:)39 b(81)p 268 564
42 2 v(,)14 b(83b,)g(86a,)g(98d,)g(98e,)g(106d,)171 606
y(112a,)f(118a,)f(123b,)h(130d,)g(139b,)g(149d,)171 656
y(150a,)f(328a,)h(342a)129 706 y Fr(Efail)p Fv(:)43 b(81)p
294 713 V(,)15 b(97c,)h(98a,)f(100a,)g(109c,)171 756
y(118b,)e(124c,)h(132d,)g(178b,)g(180,)f(182a,)171 806
y(331b,)g(343d)129 855 y Fr(Efitss)p Fv(:)42 b(81)p 315
862 V(,)15 b(86a,)g(95c,)h(99b,)f(107b,)171 905 y(118a,)e(123b,)g
(130f,)g(188b,)g(198a,)g(200a,)171 955 y(212d,)g(315b,)f(320a,)h(329g,)
f(342c)129 1005 y Fr(Efitsu)p Fv(:)41 b(81)p 314 1012
V -1 w(,)15 b(86a,)f(99b,)h(107b,)f(118a,)171 1055 y(123b,)f(130f,)g
(188b,)g(198a,)g(199a,)g(200a,)171 1104 y(212d,)g(315a,)f(315b,)h
(320a,)f(329g,)h(342c)129 1154 y Fr(Eforce)p Fv(:)42
b(81)p 315 1161 V(,)15 b(83a,)g(86a,)g(99b,)g(107d,)171
1204 y(118a,)e(123b,)g(130h,)g(172a,)f(189a,)h(198b,)171
1254 y(209a,)f(223b,)h(227a,)f(314c,)i(330a,)e(342d)129
1304 y Fr(Eforceable)p Fv(:)42 b(81)p 403 1311 V -1 w(,)16
b(86a,)e(99b,)i(107d,)171 1354 y(118a,)c(123b,)h(130h,)g(198b,)f(330a,)
h(342d)129 1403 y Fr(Einstance)p Fv(:)38 b(81)p 377 1410
V(,)14 b(83a,)g(83b,)g(86a,)g(93a,)171 1453 y(100a,)f(108b,)g(118a,)g
(124a,)f(131e,)i(173b,)171 1503 y(178b,)f(178d,)f(180,)h(182a)129
1553 y Fr(Einstance_input)p Fv(:)34 b(17a,)13 b(81)p
593 1560 V -1 w(,)h(83b,)e(86a,)171 1603 y(97b,)i(99b,)g(100a,)g(108b,)
g(118a,)g(124a,)171 1652 y(131e,)g(172a,)f(178b,)h(178c,)g(180,)g
(182a,)171 1702 y(201a,)f(206e,)g(207b,)g(219b,)g(250b,)g(315c,)171
1752 y(330f,)f(343b)129 1802 y Fr(Einstance_tagged)p
Fv(:)39 b(17a,)15 b(81)p 622 1809 V -1 w(,)g(86a,)171
1852 y(100a,)e(108b,)g(118a,)g(124a,)g(131e,)g(172a,)171
1901 y(178b,)h(180,)f(184a,)h(184b,)g(185a,)f(330f,)171
1951 y(343b)129 2001 y Fr(Elambda)p Fv(:)35 b(111a,)12
b(119c,)g(126a,)g(133f,)g(215,)171 2051 y(217)p 171 2058
63 2 v -1 w(,)i(218)129 2101 y Fr(eliminate_binding_in)o(stan)o(ce_va)o
(rs)p Fv(:)171 2151 y(180,)f(181c)p 259 2158 81 2 v 129
2200 a Fr(eliminate_binding_in)o(stan)o(ce_va)o(rs_f)p
Fv(:)171 2250 y(181c)p 171 2257 V 129 2300 a Fr(eliminate_contradict)o
(ions)o Fv(:)38 b(71b)p 705 2307 65 2 v(,)171 2350 y(169)129
2400 y Fr(eliminate_instances)p Fv(:)h(74,)15 b(124a,)171
2449 y(178a)p 171 2456 84 2 v 129 2499 a Fr(eliminate_instances_)o(f)p
Fv(:)34 b(17a,)13 b(178a,)908 258 y(180)p 908 265 63
2 v -1 w(,)g(181b)866 307 y Fr(emit_asm_grammar)p Fv(:)33
b(20,)13 b(253a)p 1330 314 84 2 v 866 357 a Fr(emit_asm_printf)p
Fv(:)34 b(246,)12 b(248,)h(251b)p 1417 364 86 2 v 866
407 a Fr(emit_assembler_body)o Fv(:)34 b(236a,)12 b(246)p
1437 414 63 2 v 866 457 a Fr(emit_assembly)p Fv(:)34
b(20,)13 b(235a)p 1265 464 84 2 v 866 507 a Fr(emit_assembly_imple)o
(menta)o(tion)o Fv(:)908 557 y(235a,)f(236a)p 1016 564
V 866 606 a Fr(emitb)p Fv(:)36 b(387a)p 1024 613 V -1
w(,)13 b(388b,)g(392a)866 656 y Fr(emit_checker)p Fv(:)34
b(20,)13 b(308)p 1243 663 63 2 v 866 706 a Fr(emit_closure_functi)o
(ons)p Fv(:)34 b(16c,)13 b(16h,)908 756 y(18a)p 908 763
V -1 w(,)g(19a,)g(214a)866 806 y Fr(emit_closure_functi)o(ons_p)o(ostf)
o(ix)p Fv(:)908 855 y(226)p 908 862 V -1 w(,)g(232a)866
905 y Fr(emit_closure_header)o(_def)p Fv(:)37 b(205a,)908
955 y(206c)p 908 962 81 2 v 866 1005 a Fr(emit_cons_productio)o(n)p
Fv(:)d(253a,)12 b(254)p 1459 1012 63 2 v 866 1055 a Fr
(emit_create_instanc)o(e_bod)o(y)p Fv(:)34 b(213b)p 1460
1062 86 2 v -1 w(,)908 1104 y(232a,)12 b(236a)866 1154
y Fr(emit_create_instanc)o(e_pro)o(to)p Fv(:)908 1204
y(212e,)h(213a)p 1014 1211 84 2 v 866 1254 a Fr(emit_disassembler)p
Fv(:)33 b(20)866 1304 y Fr(emit_emitter_body)p Fv(:)g(214a)p
1285 1311 V -1 w(,)14 b(232a)866 1354 y Fr(emit_emitter_proto)p
Fv(:)33 b(212e,)13 b(214a)p 1413 1361 V 866 1403 a Fr(emit_encoding)p
Fv(:)34 b(20,)13 b(229)p 1265 1410 63 2 v 866 1453 a
Fr(emit_encoding_imple)o(menta)o(tion)o Fv(:)908 1503
y(229,)f(232a)p 995 1510 84 2 v 866 1553 a Fr(emit_encoding_inter)o
(face)p Fv(:)39 b(229,)908 1603 y(230a)p 908 1610 V -1
w(,)13 b(235a)866 1652 y Fr(emitfast)p Fv(:)35 b(396a)p
1089 1659 V 866 1702 a Fr(emitfast0)p Fv(:)g(393a)p 1111
1709 V 866 1752 a Fr(emitfast1)p Fv(:)g(394a)p 1111 1759
V 866 1802 a Fr(emitfast2)p Fv(:)g(395a)p 1111 1809 V
-1 w(,)13 b(396a)866 1852 y Fr(emitfastbyte)p Fv(:)34
b(396a)p 1176 1859 V 866 1901 a Fr(emitfastbyte0)p Fv(:)g(393b)p
1198 1908 86 2 v 866 1951 a Fr(emitfastbyte1)p Fv(:)g(394b)p
1198 1958 V 866 2001 a Fr(emitfastbyte2)p Fv(:)g(395b)p
1198 2008 V -1 w(,)14 b(396a)866 2051 y Fr(emitfastT0)p
Fv(:)35 b(392b)p 1133 2058 V 866 2101 a Fr(emitfastT1)p
Fv(:)g(393c)p 1133 2108 81 2 v 866 2151 a Fr(emitfastT2)p
Fv(:)g(394c)p 1133 2158 V 866 2200 a Fr(emitfastu)p Fv(:)g(396a)p
1111 2207 84 2 v 866 2250 a Fr(emitfastu0)p Fv(:)g(392b)p
1133 2257 86 2 v -1 w(,)13 b(393a)866 2300 y Fr(emitfastu1)p
Fv(:)35 b(393c)p 1133 2307 81 2 v -1 w(,)14 b(394a)866
2350 y Fr(emitfastu2)p Fv(:)35 b(395c)p 1133 2357 V -1
w(,)14 b(396a)866 2400 y Fr(emitfastuc)p Fv(:)35 b(396a)p
1133 2407 84 2 v 866 2449 a Fr(emitfastuc0)p Fv(:)f(392b)p
1154 2456 86 2 v(,)13 b(393a,)g(393b)p eop
%%Page: 427 427
427 426 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(427)145 258 y Fr(emitfastuc1)p Fv(:)34 b(393c)p 433
265 81 2 v(,)14 b(394a,)e(394b)145 307 y Fr(emitfastuc2)p
Fv(:)34 b(395b,)13 b(395c)p 544 314 V(,)g(396a)145 357
y Fr(emitfastul)p Fv(:)35 b(396a)p 412 364 84 2 v 145
407 a Fr(emitfastul0)p Fv(:)f(392b)p 433 414 86 2 v(,)13
b(393a)145 457 y Fr(emitfastul1)p Fv(:)34 b(393c)p 433
464 81 2 v(,)14 b(394a)145 507 y Fr(emitfastul2)p Fv(:)34
b(395c)p 433 514 V(,)14 b(396a)145 557 y Fr(emitfastus)p
Fv(:)35 b(396a)p 412 564 84 2 v 145 606 a Fr(emitfastus0)p
Fv(:)f(392b)p 433 613 86 2 v(,)13 b(393a)145 656 y Fr(emitfastus1)p
Fv(:)34 b(393c)p 433 663 81 2 v(,)14 b(394a)145 706 y
Fr(emitfastus2)p Fv(:)34 b(395c)p 433 713 V(,)14 b(396a)145
756 y Fr(emit_fieldnames)p Fv(:)34 b(20,)12 b(356c)p
587 763 V 145 806 a Fr(emit_indirect_encod)o(er)p Fv(:)41
b(231a)p 659 813 84 2 v -1 w(,)187 855 y(232a,)12 b(236a)145
905 y Fr(emit_instance_type)p Fv(:)33 b(202b)p 586 912
86 2 v -1 w(,)14 b(230b)145 955 y Fr(emitl)p Fv(:)36
b(386b)p 303 962 V -1 w(,)13 b(388a,)g(392a)145 1005
y Fr(emit_literal_syntax)o Fv(:)40 b(254,)14 b(255)p
703 1012 63 2 v -1 w(,)187 1055 y(257)145 1104 y Fr(emitm)p
Fv(:)38 b(19a,)13 b(391b,)g(392a)p 504 1111 84 2 v -1
w(,)h(392b,)g(393a,)187 1154 y(393b,)f(393c,)g(394a,)g(394b,)g(394c,)h
(395a,)187 1204 y(395b)145 1254 y Fr(emit_operand_syntax)o
Fv(:)34 b(254,)12 b(256)p 695 1261 63 2 v 145 1304 a
Fr(emit_optimized_clos)o(ure_f)o(unct)o(ion)p Fv(:)187
1354 y(214c,)h(215)p 293 1361 V 145 1403 a Fr(emit_optimized_clos)o
(ure_f)o(unct)o(ions)p Fv(:)187 1453 y(19a,)f(214c)p
274 1460 81 2 v 145 1503 a Fr(emit_original_closu)o(re_fu)o(ncti)o(on)p
Fv(:)187 1553 y(204b,)g(205a)p 297 1560 84 2 v 145 1603
a Fr(emit_original_closu)o(re_fu)o(ncti)o(on_de)o(f)p
Fv(:)187 1652 y(205a,)g(209a)p 295 1659 V 145 1702 a
Fr(emit_original_closu)o(re_fu)o(ncti)o(ons)p Fv(:)187
1752 y(16c,)h(204b)p 272 1759 86 2 v 145 1802 a Fr(emit_original_closu)
o(re_re)o(locf)o(n)p Fv(:)187 1852 y(205a,)f(208c)p 295
1859 81 2 v 145 1901 a Fr(emit_original_closu)o(re_ty)o(pede)o(f)p
Fv(:)187 1951 y(205a,)g(208a)p 295 1958 84 2 v 145 2001
a Fr(emit_proc_declarati)o(on)p Fv(:)42 b(212e)p 660
2008 81 2 v -1 w(,)187 2051 y(230c,)13 b(231d)145 2101
y Fr(emitshift)p Fv(:)35 b(195,)12 b(196c)p 477 2108
V 145 2151 a Fr(Emitter)p Fv(:)41 b(209a,)14 b(209b,)g(227b,)h(406a,)
187 2200 y(407b,)d(407c)145 2250 y Fr(emitter_body)p
Fv(:)34 b(188b)p 455 2257 86 2 v(,)13 b(214a)145 2300
y Fr(emittername)p Fv(:)39 b(10g,)13 b(18a)p 526 2307
63 2 v(,)h(19a,)g(328c,)187 2350 y(342b)145 2400 y Fr(emitterstyle)p
Fv(:)35 b(19b)p 456 2407 65 2 v -1 w(,)14 b(19c,)f(209a,)g(227b,)187
2449 y(328b,)f(329a)145 2499 y Fr(emit_tokenized_clos)o(ure_f)o(unct)o
(ions)p Fv(:)924 258 y(16h)882 307 y Fr(emitu)p Fv(:)36
b(391b)p 1040 314 86 2 v 882 357 a Fr(emituc)p Fv(:)f(391b)p
1061 364 V 882 407 a Fr(emitul)p Fv(:)g(391b)p 1061 414
V 882 457 a Fr(emit_unit_bits)p Fv(:)f(12i,)12 b(18a)p
1314 464 63 2 v -1 w(,)i(19a,)e(195)882 507 y Fr(emitus)p
Fv(:)35 b(391b)p 1061 514 86 2 v 882 557 a Fr(Emod)p
Fv(:)40 b(81)p 1022 564 42 2 v -1 w(,)15 b(83b,)f(86a,)g(98f,)f(98g,)h
(106d,)924 606 y(112a,)e(118a,)h(123b,)g(130d,)g(139b,)g(149d,)924
656 y(150a,)f(315a,)g(328a,)h(342a)882 706 y Fr(emptyset)p
Fv(:)35 b(18a)p 1105 713 63 2 v -1 w(,)14 b(19a,)e(137b,)h(369d)882
756 y Fr(Enarrows)p Fv(:)40 b(81)p 1110 763 42 2 v -1
w(,)15 b(83b,)g(86a,)f(95c,)h(97b,)924 806 y(98a,)e(98b,)g(98c,)g(98d,)
g(99b,)h(106c,)f(112a,)924 855 y(118a,)f(123b,)i(130c,)f(151c,)h(152a,)
e(152b,)924 905 y(175b,)g(189a,)h(200a,)f(327e,)h(341e)882
955 y Fr(Enarrowu)p Fv(:)40 b(81)p 1110 962 V -1 w(,)15
b(83b,)g(86a,)f(97b,)h(97c,)924 1005 y(97d,)f(99b,)g(106c,)h(112a,)e
(118a,)h(123b,)924 1055 y(130c,)f(200a,)f(327e,)h(341e)882
1104 y Fr(ENDSEM)p Fv(:)26 b(360b)p 1052 1111 86 2 v
882 1154 a Fr(enforce_closure)p Fv(:)33 b(166d)p 1257
1161 V 882 1204 a Fr(enforce_instance)p Fv(:)g(166c)p
1279 1211 81 2 v(,)13 b(202b)882 1254 y Fr(Enosimp)p
Fv(:)40 b(81)p 1088 1261 42 2 v(,)15 b(83a,)f(86a,)h(93a,)f(107g,)924
1304 y(118a,)e(123b,)h(131c,)g(196c,)g(330c,)g(342f)882
1354 y Fr(Enot)p Fv(:)36 b(81)p 1018 1361 V(,)14 b(86a,)e(99b,)i(107f,)
e(118a,)h(123b,)924 1403 y(131b,)h(186b,)g(188b,)f(190,)h(192,)g(330b,)
924 1453 y(342e)882 1503 y Fr(enumbinding)p Fv(:)34 b(37c,)14
b(38a,)e(355b)p 1343 1510 86 2 v 882 1553 a Fr(envimage)p
Fv(:)37 b(27a)p 1107 1560 63 2 v -1 w(,)14 b(89a,)g(157,)f(260,)g
(265a,)924 1603 y(270a,)f(377c)882 1652 y Fr(EOF)p Fv(:)27
b(21d,)13 b(359b)p 1077 1659 86 2 v -1 w(,)g(360a)882
1702 y Fr(Eorb)p Fv(:)39 b(81)p 1021 1709 42 2 v(,)14
b(83a,)g(83b,)g(86a,)f(97a,)h(106a,)924 1752 y(112a,)f(118a,)g(123b,)h
(130a,)f(195,)h(221a,)924 1802 y(327c,)f(341c)882 1852
y Fr(Epatlabel)p Fv(:)37 b(57,)13 b(81)p 1196 1859 V(,)h(86a,)f(107c,)h
(118a,)924 1901 y(123b,)e(130g,)h(193a,)f(270a)882 1951
y Fr(Epatlabel_to_Epc)p Fv(:)36 b(190,)13 b(192,)g(193a)p
1458 1958 84 2 v -1 w(,)924 2001 y(270a,)f(314a)882 2051
y Fr(Epatlabel_to_Epc_b)o(y_tab)o(le)p Fv(:)36 b(269,)924
2101 y(270a)p 924 2108 V 882 2151 a Fr(Epc)p Fv(:)k(19e,)14
b(81)p 1086 2158 42 2 v(,)h(83a,)e(86a,)h(107e,)h(118a,)924
2200 y(123b,)e(131a,)g(198b,)h(205b,)f(206c,)h(216,)924
2250 y(218,)e(228,)h(313,)g(329d)882 2300 y Fr(Epc_known)p
Fv(:)35 b(81)p 1127 2307 V(,)13 b(83a,)g(86a,)g(107e,)g(118a,)924
2350 y(123b,)g(131a,)g(198b,)h(205b,)f(206c,)h(216,)924
2400 y(218,)e(228,)h(329d)882 2449 y Fr(epsilon)p Fv(:)40
b(17a,)15 b(42a,)f(51a,)g(62b)p 1356 2456 65 2 v(,)h(72a,)p
eop
%%Page: 428 428
428 427 bop 129 141 a Fv(428)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)171 258 y(102c,)g(328b,)g(372a)129 307 y
Fr(eqn)p Fv(:)37 b(48c,)13 b(70c,)h(83c)p 415 314 60
2 v(,)g(85b,)f(91,)g(93a,)g(94c,)171 357 y(95c,)h(104c,)g(117d,)g
(123a,)g(128b,)f(143c,)171 407 y(145a,)g(150a,)h(152a,)f(152b,)g(154,)h
(222a,)171 457 y(264,)f(315a,)h(316b,)f(318a,)g(319b,)h(326a,)171
507 y(340a,)e(378b)129 557 y Fr(equals_pc)p Fv(:)35 b(78a)p
374 564 63 2 v -1 w(,)14 b(329a)129 606 y Fr(equivclass)p
Fv(:)35 b(35a,)12 b(37a,)h(42a,)g(55)p 659 613 42 2 v
129 656 a Fr(equivclasses)p Fv(:)34 b(32a)p 439 663 63
2 v(,)13 b(32b,)g(35a,)g(367)p 705 663 V 129 706 a Fr(escape_dollars)p
Fv(:)36 b(109b,)13 b(112b)p 596 713 86 2 v -1 w(,)h(332b,)171
756 y(333b,)f(344b)129 806 y Fr(Eshift)p Fv(:)37 b(81)p
310 813 42 2 v(,)14 b(83b,)f(86a,)h(97b,)f(97c,)h(98e,)171
855 y(99b,)g(106b,)f(112a,)g(116a,)h(118a,)f(123b,)171
905 y(130b,)g(154,)f(196c,)h(327d,)g(341d)129 955 y Fr(Eslice)p
Fv(:)37 b(81)p 310 962 V(,)14 b(83b,)f(86a,)g(95c,)h(97a,)f(97b,)171
1005 y(97d,)i(98b,)g(98g,)g(99b,)h(106b,)f(112a,)171
1055 y(115a,)e(118a,)f(123b,)h(130b,)g(144b,)g(145c,)171
1104 y(153d,)h(154,)g(195,)g(297c,)h(299a,)f(318a,)171
1154 y(327d,)f(327e,)g(341d,)f(341e)129 1204 y Fr(Ewiden)p
Fv(:)37 b(50b,)13 b(81)p 400 1211 V(,)h(83b,)f(86a,)g(98a,)g(98b,)171
1254 y(98c,)i(99b,)f(106c,)h(112a,)f(118a,)f(123b,)171
1304 y(130c,)h(144b,)f(145c,)g(151c,)h(152a,)f(152b,)171
1354 y(327e,)g(333a,)f(341e)129 1403 y Fr(exactlog2)p
Fv(:)35 b(98e,)13 b(98g,)g(100c)p 547 1410 81 2 v 129
1453 a Fr(expbc)p Fv(:)36 b(227a)129 1503 y Fr(expimage)p
Fv(:)k(26a,)15 b(27c,)f(28b,)h(57,)f(68d,)171 1553 y(70a,)f(77a,)g
(77b,)g(97c,)h(98a,)f(100a,)f(101a)p 719 1560 84 2 v
-1 w(,)171 1603 y(101d,)h(102a,)g(102b,)g(102c,)g(103a,)g(103b,)171
1652 y(104a,)g(104b,)g(104c,)g(105b,)g(105c,)h(105d,)171
1702 y(106a,)f(106b,)g(106c,)g(106d,)g(107a,)g(107b,)171
1752 y(107c,)h(107d,)f(107f,)g(107g,)g(108a,)g(108b,)171
1802 y(108c,)g(109a,)g(109b,)g(109d,)g(110a,)g(110b,)171
1852 y(110c,)h(111a,)e(115a,)h(124a,)g(124c,)h(127b,)171
1901 y(136a,)f(137a,)g(138,)h(140a,)f(142b,)h(143b,)171
1951 y(143c,)g(144b,)f(145b,)g(145c,)h(145d,)f(145f,)171
2001 y(150a,)h(154,)g(156b,)g(157,)g(164a,)g(177a,)171
2051 y(177b,)f(177c,)g(178b,)h(181a,)e(182a,)h(184a,)171
2101 y(187a,)g(197b,)h(198a,)f(270a,)g(274,)h(275a,)171
2151 y(275c,)h(278,)g(301b,)f(308,)h(310,)f(314d,)171
2200 y(314e,)g(316a,)f(317,)h(319c,)g(320a,)g(320b,)171
2250 y(351d,)f(370d,)f(373b,)h(377c,)g(378a,)g(378b)129
2300 y Fr(explode)p Fv(:)35 b(160,)13 b(162b)p 418 2307
86 2 v 129 2350 a Fr(explode_apps)p Fv(:)34 b(41b)p 439
2357 65 2 v(,)13 b(75,)g(79b)129 2400 y Fr(explode_names)p
Fv(:)34 b(41b,)13 b(48b,)g(52e,)g(163b)p 726 2407 86
2 v 129 2449 a Fr(expps)p Fv(:)36 b(128a)p 287 2456 84
2 v -1 w(,)14 b(128b,)f(129a,)f(130a,)h(130b,)171 2499
y(130c,)h(130d,)f(130e,)h(130f,)e(130h,)i(131b,)908 258
y(131c,)g(131d,)f(131e,)h(131f,)f(132a,)g(132b,)908 307
y(132c,)g(133a,)f(133d,)h(133f,)f(227a)866 357 y Fr(exps_eq)p
Fv(:)41 b(84c)p 1073 364 60 2 v(,)15 b(85a,)f(85b,)h(85c,)g(85d,)908
407 y(86a,)e(86c,)g(87b,)h(95c,)f(96a,)g(126c,)h(144b,)908
457 y(156a,)f(184a,)g(185a,)f(187a,)h(198c,)h(207a,)908
507 y(260,)e(266a,)h(266b)866 557 y Fr(exptypes)p Fv(:)35
b(29,)13 b(83b)p 1156 564 65 2 v 866 606 a Fr(expwalk)p
Fv(:)35 b(49b,)13 b(84b,)g(117a)p 1247 613 84 2 v -1
w(,)h(148b,)e(329a)866 656 y Fr(extendscope)p Fv(:)34
b(26c)p 1154 663 60 2 v(,)14 b(162b)866 706 y Fr(fail)p
Fv(:)41 b(29,)14 b(71a,)g(77a,)g(78b,)h(79a,)f(79b,)908
756 y(85a,)g(85b,)g(85c,)h(85d,)f(86b,)g(86c,)h(86e,)908
806 y(94a,)f(94b,)g(100c,)h(117b,)f(117c,)h(118a,)908
855 y(118b,)e(119a,)g(120b,)g(127a,)f(127b,)h(127c,)908
905 y(128a,)g(130g,)f(131a,)h(131e,)h(132d,)f(133b,)908
955 y(133c,)h(133f,)f(139c,)g(142b,)h(155a,)f(172a,)908
1005 y(176,)h(177a,)g(177b,)g(180,)g(181b,)g(185a,)908
1055 y(195,)g(197c,)g(203,)g(209a,)g(209b,)g(212b,)908
1104 y(212d,)f(227b,)g(244a,)f(262b,)h(263c,)h(266b,)908
1154 y(273a,)f(273b,)g(285b,)h(322,)f(332b,)h(344b,)908
1204 y(350,)f(351a,)h(351d,)f(354a,)h(363a,)f(365c,)908
1254 y(404a,)f(406a,)h(407b,)f(407c,)h(410)p 1341 1261
63 2 v 866 1304 a Fr(FailCont)p Fv(:)39 b(209a,)13 b(209b,)h(227b,)g
(406a,)908 1354 y(407a,)e(407b,)h(407c)866 1403 y Fr(fail_if_undef)p
Fv(:)34 b(407a)p 1198 1410 84 2 v 866 1453 a Fr(fetchcode)p
Fv(:)h(297c,)13 b(302d)p 1217 1460 86 2 v 866 1503 a
Fr(fetchtab)p Fv(:)42 b(19a,)15 b(52a,)g(295a)p 1276
1510 84 2 v -1 w(,)h(295b,)908 1553 y(302c,)d(302d,)g(303a,)f(338a,)g
(348)866 1603 y Fr(field)p Fv(:)38 b(13a,)13 b(17b,)h(22c,)g(23b,)f
(27c,)h(33c,)908 1652 y(35b,)g(37c,)h(41a,)g(46b,)f(50b,)h(52d,)g(55)p
1451 1659 42 2 v -1 w(,)908 1702 y(61,)g(68e,)g(68f,)g(69a,)g(70a,)f
(70b,)h(70c,)908 1752 y(75,)e(78b,)h(85a,)f(93a,)h(97b,)f(104a,)g
(115a,)908 1802 y(115c,)g(116b,)g(117c,)h(122b,)f(162b,)g(163a,)908
1852 y(163b,)g(164a,)g(169,)h(170b,)f(172b,)h(174a,)908
1901 y(175a,)f(175c,)h(188b,)g(189a,)f(195,)h(199a,)908
1951 y(201b,)f(203,)h(204a,)f(208a,)g(212d,)h(242a,)908
2001 y(242b,)g(242d,)g(247,)g(249a,)g(249c,)g(254,)908
2051 y(256,)g(262a,)h(264,)f(265c,)i(268,)e(270b,)908
2101 y(272,)f(276a,)g(276b,)h(277b,)g(279a,)f(282a,)908
2151 y(282b,)g(285a,)f(285b,)h(289b,)g(290b,)g(291a,)908
2200 y(292a,)g(296a,)g(296b,)g(297a,)g(297c,)g(298c,)908
2250 y(298d,)g(299a,)g(301b,)h(311a,)f(315b,)h(317,)908
2300 y(320a,)e(333b,)h(333d,)g(334b,)g(345a,)g(346a,)908
2350 y(349c,)h(351c,)g(353,)g(354a,)g(354e,)g(355a,)908
2400 y(355c,)f(355d,)g(356b,)g(357a,)g(357b,)g(371a,)908
2449 y(371b,)f(372a,)h(373b,)g(374)p eop
%%Page: 429 429
429 428 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(429)145 258 y Fr(fieldbinding)p Fv(:)40 b(55)p 461
265 42 2 v -1 w(,)15 b(65c,)g(70a,)g(73b,)187 307 y(77a,)f(85a,)h(93a,)
g(104a,)f(117c,)h(122b,)187 357 y(170b,)f(172b,)g(195,)g(199a,)g(262a,)
f(264,)187 407 y(270b,)f(301b,)h(371a,)g(372a)145 457
y Fr(fieldbindings_to_so)o(ln)p Fv(:)33 b(263a,)13 b(264)p
760 464 63 2 v 145 507 a Fr(fieldbitcount)p Fv(:)34 b(371a,)12
b(371b)p 585 514 86 2 v 145 557 a Fr(fieldconds)p Fv(:)35
b(351b)p 412 564 V -1 w(,)13 b(351c)145 606 y Fr(fieldimage)p
Fv(:)35 b(27c,)13 b(367,)g(368b)p 585 613 V -1 w(,)g(368b)p
695 613 V 145 656 a Fr(fieldinfo)p Fv(:)35 b(37c,)13
b(354a)p 475 663 84 2 v 145 706 a Fr(Fieldinfo)p Fv(:)35
b(37c)p 390 713 60 2 v 145 756 a Fr(fieldinfo)p Fv(:)g(37c,)13
b(354a)p 475 763 84 2 v 145 806 a Fr(fieldinput_pattern)p
Fv(:)33 b(169,)13 b(172b)p 674 813 86 2 v 145 855 a Fr(Fielditem)p
Fv(:)35 b(37c)p 390 862 60 2 v 145 905 a Fr(FieldName)p
Fv(:)g(37c)p 390 912 V 145 955 a Fr(fieldnamearray)p
Fv(:)f(356c,)13 b(357b)p 605 962 86 2 v 145 1005 a Fr
(FieldNameBindings)p Fv(:)33 b(37c)p 564 1012 60 2 v
145 1055 a Fr(fieldname_env_for)p Fv(:)g(77a,)13 b(356b)p
652 1062 86 2 v 145 1104 a Fr(fieldname_env_for_i)o(pt)p
Fv(:)41 b(175a,)187 1154 y(356b)p 187 1161 V 145 1204
a Fr(FieldNameList)p Fv(:)34 b(37c)p 477 1211 60 2 v
145 1254 a Fr(fieldname_literals)p Fv(:)f(32a)p 586 1261
63 2 v(,)13 b(32b,)g(33a,)187 1304 y(33b)145 1354 y Fr(fieldnamesbase)p
Fv(:)34 b(13b,)13 b(18a)p 589 1361 V -1 w(,)g(20)145
1403 y Fr(fieldname_table)p Fv(:)34 b(162b,)13 b(163b,)g(242a,)187
1453 y(242d,)f(257,)h(316c,)g(356a)p 491 1460 84 2 v
-1 w(,)h(356b,)e(357b)145 1503 y Fr(field_nonterminal)p
Fv(:)33 b(256,)13 b(257)p 652 1510 63 2 v 145 1553 a
Fr(fieldsknown)p Fv(:)34 b(136a)p 433 1560 84 2 v 145
1603 a Fr(Fieldspec)p Fv(:)h(34b,)13 b(35a)p 480 1610
63 2 v -1 w(,)g(37c,)h(38b)145 1652 y Fr(fieldtests)p
Fv(:)35 b(351b)p 412 1659 86 2 v -1 w(,)13 b(351c)145
1702 y Fr(fieldval)p Fv(:)35 b(349b)p 368 1709 V 145
1752 a Fr(file)p Fv(:)j(9c,)14 b(9e,)h(9g,)e(10b,)h(10d,)f(10j,)h(11a,)
187 1802 y(11d,)g(11f,)h(11h,)f(11l,)h(12b,)f(12d,)h(12f,)187
1852 y(12j,)g(12l,)g(13a,)g(14l,)g(23a,)g(23b,)g(24,)187
1901 y(102a,)e(109d,)g(230a,)f(263a,)h(271b,)g(275c,)187
1951 y(276a,)g(284a,)f(285a,)h(293a,)g(294d,)g(302a,)187
2001 y(306,)h(332d,)g(344d,)g(359a)p 500 2008 84 2 v
-1 w(,)h(360a,)e(367,)187 2051 y(368c,)g(369a,)f(369b,)h(372a,)f(373b,)
h(374)145 2101 y Fr(find_covering_arms)p Fv(:)33 b(285a)p
586 2108 V 145 2151 a Fr(find_id)p Fv(:)i(283c)p 346
2158 81 2 v 145 2200 a Fr(find_input)p Fv(:)g(209c)p
412 2207 V -1 w(,)14 b(210a)145 2250 y Fr(findmaxima)p
Fv(:)35 b(276a,)12 b(276c,)h(280a)p 626 2257 84 2 v 145
2300 a Fr(find_or_invent_cons)o(train)o(t)p Fv(:)34 b(285a,)187
2350 y(285b)p 187 2357 86 2 v 145 2400 a Fr(fits_conditions_of)p
Fv(:)41 b(190,)15 b(192,)187 2449 y(199a)p 187 2456 84
2 v -1 w(,)e(199b)145 2499 y Fr(flatten)p Fv(:)35 b(116c)p
346 2506 81 2 v(,)13 b(130a,)g(221a)882 258 y Fr(fnt)p
Fv(:)36 b(353)p 996 265 63 2 v -1 w(,)14 b(354a,)e(356a)882
307 y Fr(fnum)p Fv(:)36 b(372b,)12 b(373a)p 1128 314
84 2 v 882 357 a Fr(free_variables)p Fv(:)34 b(57,)13
b(78b,)g(84b)p 1393 364 65 2 v -1 w(,)g(137a,)924 407
y(139c,)h(140b,)g(140c,)g(156a,)f(206e,)h(215,)924 457
y(219c,)f(262c)882 507 y Fr(free_variables_f)p Fv(:)33
b(84b)p 1279 514 V 882 557 a Fr(free_var_or_patlab)o(elbin)o(ding_)o
(name)o Fv(:)924 606 y(260,)12 b(262c)p 1011 613 81 2
v 882 656 a Fr(fresh_base)p Fv(:)34 b(155b,)13 b(155c)p
1259 663 V 882 706 a Fr(freshen_disjunct)p Fv(:)33 b(80b)p
1279 713 65 2 v 882 756 a Fr(freshen_disjuncts)p Fv(:)41
b(80b)p 1309 763 V -1 w(,)16 b(170a,)924 806 y(172a,)c(183b,)h(190)882
855 y Fr(freshen_patlabels)p Fv(:)33 b(59d)p 1301 862
V(,)13 b(64a,)g(173a)882 905 y Fr(fresh_variable)p Fv(:)38
b(49c,)14 b(139b,)g(155b)p 1438 912 86 2 v -1 w(,)924
955 y(156a,)e(182b,)h(217,)f(218,)h(265c)882 1005 y Fr(fresh_variables)
p Fv(:)35 b(19a,)14 b(155b)p 1348 1012 V -1 w(,)g(165d,)924
1055 y(302b)882 1104 y Fr(full_name_table)p Fv(:)33 b(37c,)14
b(38a,)e(355c)p 1430 1111 81 2 v 882 1154 a Fr(fwidth)p
Fv(:)37 b(46b,)13 b(50b,)h(61,)f(62a,)g(70c,)h(97b,)924
1204 y(115c,)g(115d)p 1031 1211 86 2 v -1 w(,)g(188b,)g(195,)f(199a,)g
(201b,)924 1254 y(203,)h(204a,)f(208a,)h(212d,)g(247,)g(249a,)924
1304 y(282a,)e(285b,)h(290b,)g(297c,)h(299a,)e(315b,)924
1354 y(349a,)g(350,)h(351a,)f(355d,)h(357b,)f(371b)882
1403 y Fr(Gasgn)p Fv(:)38 b(86c,)14 b(110b,)f(119a,)g(125b,)h(133c,)924
1453 y(216,)e(294a)p 1011 1460 84 2 v -1 w(,)i(301a,)e(334b,)h(346a)882
1503 y Fr(Gblock)p Fv(:)36 b(86c,)13 b(109d,)g(119a,)g(125b,)g(133a,)
924 1553 y(293a)p 924 1560 V -1 w(,)g(295b,)g(296a,)g(296b,)g(297a,)g
(301a,)924 1603 y(331d,)f(332e,)h(344e)882 1652 y Fr(Gcall)p
Fv(:)36 b(293a)p 1040 1659 V -1 w(,)13 b(309,)g(311a,)f(330e,)h(343b)
882 1702 y Fr(Gcase)p Fv(:)38 b(86c,)14 b(110a,)f(119a,)g(125b,)g
(133b,)924 1752 y(294a)p 924 1759 V -1 w(,)g(296b,)g(334a,)f(345c)882
1802 y Fr(Gcasearm)p Fv(:)41 b(86c,)15 b(110a,)f(119a,)g(125b,)924
1852 y(133b,)e(294a)p 1034 1859 V -1 w(,)i(299b,)e(334a,)h(345c)882
1901 y Fr(gcd)p Fv(:)36 b(146a,)12 b(146b)p 1104 1908
86 2 v 882 1951 a Fr(Gcomment)p Fv(:)37 b(20)p 1107 1958
42 2 v(,)14 b(86c,)g(93a,)f(110a,)g(119a,)924 2001 y(125b,)f(334c,)h
(346a)882 2051 y Fr(Gcommented)p Fv(:)39 b(86c,)14 b(93a,)g(110a,)g
(119a,)924 2101 y(125b,)e(299a)p 1034 2108 84 2 v -1
w(,)i(334c,)f(346a)882 2151 y Fr(Gdecl)p Fv(:)38 b(86c,)14
b(109d,)f(119a,)g(125b,)g(133a,)924 2200 y(293a)p 924
2207 V -1 w(,)g(295b,)g(297c,)g(301a,)f(332e,)h(344e)882
2250 y Fr(Gdeclnamearray)p Fv(:)37 b(248,)14 b(293b)p
1328 2257 86 2 v(,)g(295b,)924 2300 y(333b,)e(345a,)h(356c)882
2350 y Fr(genarm)p Fv(:)35 b(300,)13 b(301a)p 1149 2357
84 2 v 882 2400 a Fr(genarms)p Fv(:)35 b(296a,)12 b(300)p
1191 2407 63 2 v 882 2449 a Fr(gencase)p Fv(:)35 b(22b,)13
b(295b)p 1173 2456 86 2 v eop
%%Page: 430 430
430 429 bop 129 141 a Fv(430)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fr(genconstraint)p Fv(:)34 b(23a,)13
b(23b)p 549 265 65 2 v 129 307 a Fr(gen_counters)p Fv(:)35
b(10m,)12 b(18a)p 542 314 63 2 v -1 w(,)i(18b,)f(214a,)171
357 y(230a,)f(231a,)h(232a,)f(236a)129 407 y Fr(genedge)p
Fv(:)35 b(296b,)13 b(299b)p 441 414 86 2 v 129 457 a
Fr(Generate_C)p Fv(:)26 b(10i,)12 b(20,)h(338a)p 532
464 84 2 v 129 507 a Fr(generate_checker)p Fv(:)34 b(308,)12
b(309)p 614 514 63 2 v 129 557 a Fr(Generate_Icon)p Fv(:)34
b(13f)129 606 y Fr(generate_input_value)o(s)p Fv(:)g(308,)12
b(313)p 723 613 V 129 656 a Fr(Generate_M3)p Fv(:)35
b(15f,)12 b(348)p 497 663 V 129 706 a Fr(generate_tests)p
Fv(:)34 b(309,)13 b(310)p 571 713 V -1 w(,)g(311a)129
756 y Fr(gen_file_header)p Fv(:)34 b(294d)p 505 763 86
2 v -1 w(,)13 b(338a,)g(348)129 806 y Fr(genheader)p
Fv(:)35 b(21a,)13 b(294d)p 462 813 V 129 855 a Fr(gennode)p
Fv(:)41 b(295b,)14 b(296a)p 448 862 84 2 v -1 w(,)h(297a,)g(299b,)171
905 y(299c)129 955 y Fr(gen_outer_decls)p Fv(:)34 b(294d)p
505 962 86 2 v -1 w(,)14 b(295b,)f(338a,)171 1005 y(348)129
1055 y Fr(get_nodename)p Fv(:)34 b(274,)13 b(275a)p 527
1062 84 2 v 129 1104 a Fr(Gfor)p Fv(:)36 b(41c,)13 b(42b)p
350 1111 65 2 v 129 1154 a Fr(Ginrange)p Fv(:)41 b(86c,)15
b(110a,)f(119a,)g(125b,)171 1204 y(133b,)f(294a)p 282
1211 84 2 v -1 w(,)h(294c,)f(297a,)g(299c,)h(334b,)171
1254 y(346a)129 1304 y Fr(Glines)p Fv(:)36 b(86c,)14
b(109d,)e(119a,)h(125b,)g(133a,)171 1354 y(293a)p 171
1361 V -1 w(,)g(294d,)g(295b,)g(302a,)f(332d,)h(344d)129
1403 y Fr(Glist)p Fv(:)36 b(41c,)13 b(42b)p 372 1410
65 2 v(,)g(76a,)g(377a)129 1453 y Fr(globals)p Fv(:)41
b(25b,)14 b(28c,)h(32a)p 514 1460 63 2 v -1 w(,)g(32b,)g(37a,)171
1503 y(43a,)e(46b,)g(160,)f(260)129 1553 y Fr(glob_any)p
Fv(:)35 b(53a)p 352 1560 V -1 w(,)14 b(53c,)f(239c,)g(240b)129
1603 y Fr(glob_dollar)p Fv(:)35 b(53a)p 418 1610 V -1
w(,)13 b(53d,)g(240c,)g(241a)129 1652 y Fr(globmap)p
Fv(:)35 b(238b,)13 b(239b)p 441 1659 86 2 v 129 1702
a Fr(globpair)p Fv(:)35 b(239a)p 352 1709 84 2 v 129
1752 a Fr(glob_wildcard)p Fv(:)e(53a)p 460 1759 63 2
v -1 w(,)12 b(53b,)g(239c,)f(240b)129 1802 y Fr(Gnomatch)p
Fv(:)41 b(86c,)15 b(110b,)f(119a,)g(125b,)171 1852 y(133c,)f(294a)p
277 1859 84 2 v -1 w(,)g(300,)g(334c,)g(346b)129 1901
y Fr(Gresynch)p Fv(:)41 b(86c,)15 b(109d,)f(119a,)g(125b,)171
1951 y(133a,)f(293a)p 280 1958 V -1 w(,)g(294d,)g(295b,)g(302a,)g
(332d,)171 2001 y(344d)129 2051 y Fr(grhsimage)p Fv(:)35
b(240c,)13 b(241a)p 480 2058 V 129 2101 a Fr(Gsetname)p
Fv(:)41 b(86c,)15 b(110b,)f(119a,)g(125b,)171 2151 y(133c,)f(294a)p
277 2158 V -1 w(,)g(301a,)g(333d,)g(334b,)f(346a)129
2200 y Fr(gsubst)p Fv(:)36 b(77a,)13 b(120a)p 397 2207
V -1 w(,)g(148b,)g(149a,)f(174b,)171 2250 y(175b,)j(178a,)f(180,)h
(181c,)g(190,)f(192,)171 2300 y(260,)f(269,)f(314a)129
2350 y Fr(gsubst_conditions)p Fv(:)33 b(121b)p 548 2357
86 2 v 129 2400 a Fr(guaranteed_fields)p Fv(:)h(32b,)13
b(195,)f(354b,)171 2449 y(354c,)h(354d,)g(354f)p 388
2456 75 2 v 129 2499 a Fr(guard_always_satisfi)o(ed)p
Fv(:)34 b(95d,)13 b(96a,)908 258 y(96b)p 908 265 65 2
v -1 w(,)i(222b,)f(273a,)g(273b,)f(278,)h(283b,)908 307
y(331c,)f(343e)866 357 y Fr(has_app_or_literal)p Fv(:)33
b(49a,)13 b(49b)p 1395 364 V 866 407 a Fr(has_app_or_literal_)o(f)p
Fv(:)34 b(49b)p 1351 414 V 866 457 a Fr(hasnomatch)p
Fv(:)h(284a,)12 b(284c)p 1241 464 81 2 v 866 507 a Fr(hdebug)p
Fv(:)39 b(11g,)14 b(18a)p 1138 514 63 2 v -1 w(,)h(18b,)f(276a,)g
(276c,)908 557 y(280a)866 606 y Fr(header_lines)p Fv(:)34
b(20)p 1176 613 42 2 v(,)13 b(230a,)f(232a,)h(236a)866
656 y Fr(hexcode)p Fv(:)35 b(366a)p 1067 663 84 2 v 866
706 a Fr(hexint)p Fv(:)g(363a,)13 b(364b)p 1154 713 86
2 v 866 756 a Fr(hex_prefix)p Fv(:)35 b(338a,)12 b(352a)p
1241 763 84 2 v 866 806 a Fr(hexstring)p Fv(:)35 b(326a,)12
b(337b)p 1219 813 86 2 v 866 855 a Fr(hoist)p Fv(:)41
b(83a,)14 b(215,)h(218)p 1208 862 63 2 v -1 w(,)g(221b,)f(222a,)908
905 y(222b,)e(223a,)h(223b,)g(223c,)g(290b)866 955 y
Fr(hoisted)p Fv(:)36 b(217)p 1068 962 V -1 w(,)13 b(218,)g(221b,)g
(222b,)g(222c,)908 1005 y(223a,)f(223b,)h(223c)866 1055
y Fr(hoistlist)p Fv(:)35 b(218,)12 b(220c,)i(221a,)e(223c)p
1413 1062 81 2 v 866 1104 a Fr(IDENT)p Fv(:)30 b(49c,)15
b(54b)p 1105 1111 65 2 v(,)g(54c,)g(359b)p 1284 1111
86 2 v(,)g(360a,)908 1154 y(360b)p 908 1161 V -1 w(,)e(362a,)g(363a)866
1204 y Fr(Ident)p Fv(:)38 b(35a,)13 b(36a,)g(37a,)h(37c,)g(38a,)f(39a,)
908 1254 y(39b,)h(42a,)g(45b,)g(45c,)h(45d,)f(47c,)h(51a,)908
1304 y(51b,)e(52d,)g(53c,)g(53d,)g(54c)p 1263 1311 60
2 v 866 1354 a Fr(IDENT)p Fv(:)30 b(49c,)15 b(54b)p 1105
1361 65 2 v(,)g(54c,)g(359b)p 1284 1361 86 2 v(,)g(360a,)908
1403 y(360b)p 908 1410 V -1 w(,)e(362a,)g(363a)866 1453
y Fr(IdentBinding)p Fv(:)34 b(37c)p 1176 1460 60 2 v(,)14
b(52c)866 1503 y Fr(ignore_newlines)p Fv(:)34 b(362a)p
1242 1510 84 2 v -1 w(,)13 b(363a)866 1553 y Fr(ignore_whitespace)p
Fv(:)33 b(54c,)14 b(362b)p 1371 1560 86 2 v 866 1603
a Fr(implementation_exte)o(nsion)o Fv(:)39 b(10i,)908
1652 y(13f,)14 b(15f,)f(18a)p 1069 1659 63 2 v(,)h(19a,)g(229,)g(235a,)
g(308,)908 1702 y(356c)866 1752 y Fr(implicit_pattern)p
Fv(:)33 b(161a,)13 b(164a)p 1372 1759 84 2 v 866 1802
a Fr(iname)p Fv(:)36 b(100a,)12 b(161b,)h(163b,)g(164b)p
1354 1809 86 2 v -1 w(,)h(167a,)908 1852 y(167b)866 1901
y Fr(INCLUDE_MCLIBH)p Fv(:)25 b(409b)p 1211 1908 V 866
1951 a Fr(indent)p Fv(:)35 b(350,)13 b(351a,)f(351d,)h(352b)p
1352 1958 V 866 2001 a Fr(indirectname)p Fv(:)35 b(13j,)13
b(18a)p 1257 2008 63 2 v -1 w(,)h(213b,)f(214a,)908 2051
y(230a,)g(231a,)f(231b,)i(231c,)f(232a,)g(234a,)908 2101
y(236a,)f(245,)h(254,)f(308,)h(309,)g(338b)866 2151 y
Fr(indirecttype)p Fv(:)35 b(13j,)13 b(18a)p 1257 2158
V(,)g(230a,)g(231a,)908 2200 y(231b,)f(231c)866 2250
y Fr(infer_C_type)p Fv(:)34 b(332e,)13 b(333a)p 1282
2257 84 2 v 866 2300 a Fr(info_msg)p Fv(:)35 b(17e,)13
b(17f)p 1174 2307 55 2 v 866 2350 a Fr(initial_block_fetch)o(m)p
Fv(:)34 b(402d,)13 b(403a)p 1462 2357 84 2 v -1 w(,)908
2400 y(403a)p 908 2407 V 866 2449 a Fr(initial_cl_emitm)p
Fv(:)41 b(389a,)15 b(389b)p 1382 2456 86 2 v -1 w(,)p
eop
%%Page: 431 431
431 430 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(431)187 258 y(389b)p 187 265 86 2 v 145 307 a Fr(initial_emitm)p
Fv(:)34 b(392a)p 477 314 84 2 v 145 357 a Fr(init_parser)p
Fv(:)g(20,)13 b(32b)p 500 364 65 2 v 145 407 a Fr(init_tests)p
Fv(:)35 b(20,)13 b(349b)p 479 414 86 2 v 145 457 a Fr(inject)p
Fv(:)39 b(29)p 328 464 42 2 v(,)14 b(119b,)g(125c,)g(162b,)g(169,)187
507 y(170b,)e(260,)h(262a)145 557 y Fr(injectimage)p
Fv(:)34 b(378a)p 433 564 84 2 v 145 606 a Fr(inject_soln)p
Fv(:)g(161a,)13 b(170a,)f(170b)p 650 613 86 2 v 145 656
a Fr(input)p Fv(:)36 b(12l,)13 b(20,)g(21c,)h(24,)f(29,)g(46a)p
669 663 63 2 v -1 w(,)h(46b,)187 706 y(55,)f(81,)g(162a,)g(166a,)f
(169,)h(171a,)g(172b,)187 756 y(174a,)h(176,)g(189a,)g(203,)g(204a,)g
(208c,)187 806 y(211c,)f(211d,)g(212a,)g(212d,)g(213b,)g(224a,)187
855 y(233a,)h(244b,)g(244c,)g(246,)h(254,)f(262a,)187
905 y(311a,)e(311b,)h(376b)145 955 y Fr(input_fitss)p
Fv(:)34 b(99b,)13 b(200a,)g(201b)p 632 962 86 2 v 145
1005 a Fr(input_fitsu)p Fv(:)34 b(99b,)13 b(199a,)g(200a,)f(201b)p
740 1012 V 145 1055 a Fr(input_named)p Fv(:)34 b(166b)p
433 1062 V(,)13 b(209c,)g(219b)145 1104 y Fr(input_record_for)p
Fv(:)33 b(202b,)13 b(203)p 653 1111 63 2 v 145 1154 a
Fr(inputs_of)p Fv(:)39 b(97b,)14 b(108b,)f(131e,)i(165d,)187
1204 y(166a)p 187 1211 84 2 v -1 w(,)f(166b,)g(169,)f(172a,)g(173a,)h
(173b,)187 1254 y(188b,)f(189a,)h(201b,)f(203,)h(204a,)f(211a,)187
1304 y(212d,)h(213b,)g(215,)g(243b,)g(243c,)g(246,)187
1354 y(250b,)g(254,)g(315a,)g(315b,)g(317,)g(318c,)187
1403 y(368a)145 1453 y Fr(inputs_of_operands)p Fv(:)37
b(161c,)15 b(164a,)187 1503 y(166a)p 187 1510 V -1 w(,)e(243b,)g(243c)
145 1553 y Fr(input_width_tests)p Fv(:)33 b(212d)p 564
1560 86 2 v(,)13 b(213b)145 1603 y Fr(insert_condition)p
Fv(:)36 b(70c,)14 b(80a,)f(121b,)187 1652 y(122a,)g(126c)p
296 1659 81 2 v -1 w(,)h(197c,)f(198b,)h(199b,)f(200b,)187
1702 y(264,)f(300)145 1752 y Fr(insert_constraint_c)o(ondit)o(ions)o
Fv(:)187 1802 y(70a,)g(70c)p 274 1809 60 2 v 145 1852
a Fr(insert_glob_matches)o Fv(:)34 b(239b,)12 b(240c)p
718 1859 81 2 v 145 1901 a Fr(insert_width_condit)o(ion)p
Fv(:)39 b(199a,)187 1951 y(200a,)12 b(200b)p 295 1958
86 2 v 145 2001 a Fr(insist_global_patte)o(rn)p Fv(:)33
b(43b,)13 b(73b)p 741 2008 65 2 v 145 2051 a Fr(Instance)p
Fv(:)40 b(211d,)15 b(343b,)f(344a,)g(405)p 708 2058 63
2 v(,)187 2101 y(405)p 187 2108 V 145 2151 a Fr(instantiate_templat)o
(e)p Fv(:)34 b(161b)p 630 2158 86 2 v -1 w(,)13 b(162b)145
2200 y Fr(instructionctype)p Fv(:)37 b(32a)p 546 2207
63 2 v -1 w(,)15 b(32b,)f(44a,)187 2250 y(166c,)f(166d,)g(212e,)h
(230b,)f(231d,)g(232a,)187 2300 y(232b,)g(234b,)g(236a,)f(236b,)h
(238a,)g(238b,)187 2350 y(245,)f(246,)h(253b,)g(254,)f(309,)h(367)145
2400 y Fr(INT)p Fv(:)25 b(34c,)12 b(35a,)g(36a,)g(38b,)g(41c,)h(49c,)f
(51b,)187 2449 y(54b)p 187 2456 65 2 v -1 w(,)i(54c,)f(359b)p
362 2456 86 2 v -1 w(,)h(360a,)e(363a)145 2499 y Fr
(interface_extension)o Fv(:)35 b(10i,)12 b(13f,)h(15f,)924
258 y(18a)p 924 265 63 2 v -1 w(,)g(19a,)g(229,)g(235a,)f(308,)h(356c)
882 307 y Fr(interleave_slices)p Fv(:)33 b(317,)13 b(318b)p
1389 314 86 2 v 882 357 a Fr(interpret_fetchtab)o Fv(:)38
b(302c,)14 b(302d,)924 407 y(303a,)e(303b)p 1032 414
V 882 457 a Fr(intervals)p Fv(:)35 b(277a,)12 b(279a,)g(282a)p
1343 464 84 2 v 882 507 a Fr(intervals_intersec)o(t)p
Fv(:)34 b(285a,)12 b(285b)p 1453 514 86 2 v 882 557 a
Fr(is_address)p Fv(:)34 b(219b)p 1148 564 V(,)13 b(219c)882
606 y Fr(is_constructor)p Fv(:)34 b(48b,)13 b(52e,)g(167a)p
1411 613 84 2 v 882 656 a Fr(is_defined)p Fv(:)38 b(25a)p
1152 663 63 2 v(,)14 b(76b,)g(175a,)g(175c,)924 706 y(176)882
756 y Fr(islate)p Fv(:)35 b(217)p 1061 763 V(,)13 b(220c,)g(221a,)f
(222a)882 806 y Fr(is_wildcard)p Fv(:)34 b(301a,)13 b(302b)p
1279 813 86 2 v 882 855 a Fr(kbalance)p Fv(:)35 b(141b)p
1105 862 V -1 w(,)14 b(142b)882 905 y Fr(kept_constructors)p
Fv(:)35 b(20,)14 b(33d)p 1371 912 65 2 v -1 w(,)g(109a,)924
955 y(132b,)f(172a,)f(184a,)h(189b,)g(202b,)g(211a,)924
1005 y(230b,)g(230c,)g(231a,)g(231d,)g(232a,)f(232b,)924
1055 y(233b,)h(234a,)f(236a,)h(236b,)g(250a,)g(253a,)924
1104 y(308,)f(309,)h(311a,)f(313,)h(331e,)g(344a,)f(367)882
1154 y Fr(known_conditions)p Fv(:)33 b(190,)13 b(192,)f(198b)p
1454 1161 86 2 v 882 1204 a Fr(known_to_fit)p Fv(:)41
b(99b,)16 b(199a,)e(200a,)924 1254 y(201a)p 924 1261
84 2 v -1 w(,)f(210a)882 1304 y Fr(label)p Fv(:)41 b(41a,)14
b(73b,)h(79a,)f(162a,)g(172a,)924 1354 y(180,)g(295b,)h(322,)f(374,)h
(383a)p 1305 1361 V -1 w(,)g(383b,)924 1403 y(399a,)d(403b,)i(407a,)e
(407c,)i(408d,)f(408e,)924 1453 y(412b)882 1503 y Fr(label_define)p
Fv(:)34 b(404a)p 1192 1510 V 882 1553 a Fr(label_define_at)p
Fv(:)f(404a)p 1257 1560 V 882 1603 a Fr(label_location)p
Fv(:)h(403c)p 1236 1610 81 2 v 882 1652 a Fr(label_location_kno)o(wn)p
Fv(:)f(403c)p 1366 1659 V 882 1702 a Fr(label_new)p Fv(:)i(383b,)12
b(404b)p 1237 1709 86 2 v 882 1752 a Fr(label2pattern)p
Fv(:)34 b(60a)p 1214 1759 63 2 v -1 w(,)13 b(75,)g(262a)882
1802 y Fr(label_print)p Fv(:)34 b(408d)p 1170 1809 86
2 v 882 1852 a Fr(last_branch)p Fv(:)g(188a)p 1170 1859
84 2 v -1 w(,)14 b(190,)e(192)882 1901 y Fr(lateconst)p
Fv(:)35 b(13l,)12 b(14a,)h(14c,)g(18a)p 1378 1908 63
2 v -1 w(,)h(218)882 1951 y Fr(latent_label2patte)o(rn)p
Fv(:)33 b(60b)p 1366 1958 65 2 v(,)13 b(172a)882 2001
y Fr(latent_patlabel)p Fv(:)34 b(32b,)13 b(55)p 1348
2008 42 2 v -1 w(,)g(59c,)h(60b,)924 2051 y(67b,)g(85a,)g(100a,)g
(102c,)h(104a,)f(117c,)924 2101 y(122b,)e(178d,)h(180,)g(181b,)f(269,)h
(370d)882 2151 y Fr(latezero)p Fv(:)35 b(14c,)13 b(14e,)h(18a)p
1276 2158 63 2 v -1 w(,)f(222a)882 2200 y Fr(lc)p Fv(:)41
b(14f,)14 b(14g,)g(14h,)g(14i,)g(382a,)g(382b,)924 2250
y(385a,)f(388c,)g(389a,)g(389b,)g(389c,)h(390a,)924 2300
y(390b,)f(390c,)g(396b)p 1141 2307 86 2 v(,)h(397c,)f(401c,)h(402a,)924
2350 y(402d,)e(403a,)h(403c,)g(404a,)f(408a,)h(412c)882
2400 y Fr(lc_pat_names)p Fv(:)34 b(14i,)12 b(18a)p 1270
2407 63 2 v(,)h(18b,)g(274)882 2449 y Fr(leafarms)p Fv(:)35
b(274,)13 b(280b)p 1193 2456 86 2 v -1 w(,)g(281b)p eop
%%Page: 432 432
432 431 bop 129 141 a Fv(432)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)129 258 y Fr(lexstate)p Fv(:)39 b(359b)p
356 265 86 2 v -1 w(,)15 b(360b,)e(361a,)h(361b,)171
307 y(363b,)f(365a)129 357 y Fr(line)p Fv(:)37 b(17f,)13
b(20,)g(23a,)g(102a,)f(109d,)h(165b,)171 407 y(205c,)h(206a,)e(263a,)h
(271b,)g(275c,)h(276a,)171 457 y(284a,)f(285a,)h(293a,)f(294d,)g(302a,)
h(309,)171 507 y(332d,)f(344d,)f(359a)p 392 514 84 2
v -1 w(,)i(360a,)e(372a,)h(374)129 557 y Fr(lists_match)p
Fv(:)40 b(93a,)14 b(93b,)h(94a,)f(96a,)171 606 y(121a,)e(122a,)h(123a,)
f(127a)p 496 613 V 129 656 a Fr(literal)p Fv(:)41 b(33c,)15
b(44b,)g(45c,)g(45e)p 602 663 60 2 v(,)g(49a,)171 706
y(49b,)e(49c,)h(78b,)f(79a,)g(79b,)g(104c,)g(118b,)171
756 y(123a,)g(128d,)g(175a,)f(175c,)i(188b,)f(205b,)171
806 y(209a,)g(212d,)h(216,)f(233a,)h(244b,)f(244c,)171
855 y(246,)e(248,)h(250a,)f(254,)g(258,)g(294d,)h(297c,)171
905 y(299a,)g(310,)h(311a,)f(326a,)h(340a,)f(348)129
955 y Fr(location)p Fv(:)39 b(55,)14 b(81,)g(181b,)f(322,)h(330a,)171
1005 y(342d,)f(383a,)f(406a,)g(411b)129 1055 y Fr(location_known)p
Fv(:)38 b(322,)14 b(407a,)g(407c,)171 1104 y(411b)129
1154 y Fr(lookup)p Fv(:)41 b(25a)p 314 1161 63 2 v -1
w(,)15 b(75,)f(76b,)h(163b,)f(175a,)171 1204 y(175c,)f(176,)g(369a)129
1254 y Fr(lookup_printproc)p Fv(:)34 b(248,)12 b(249d)p
614 1261 86 2 v(,)h(250a)129 1304 y Fr(lookuptype)p Fv(:)35
b(25a)p 396 1311 63 2 v -1 w(,)14 b(37a,)f(37c,)g(42a,)g(45d,)171
1354 y(52d,)g(75,)g(311a)129 1403 y Fr(lowercons)p Fv(:)42
b(14g,)15 b(18a)p 471 1410 V -1 w(,)h(18b,)f(164b,)171
1453 y(238a)129 1503 y Fr(main)p Fv(:)36 b(20)p 265 1510
42 2 v(,)13 b(305a,)f(307,)h(322)129 1553 y Fr(make_clean)p
Fv(:)35 b(385a)p 396 1560 84 2 v -1 w(,)14 b(385b,)f(386a,)f(397a,)171
1603 y(400a)129 1652 y Fr(make_early)p Fv(:)39 b(217)p
400 1659 63 2 v -1 w(,)15 b(218,)f(220c,)g(221a,)171
1702 y(222a)129 1752 y Fr(make_late)p Fv(:)41 b(217)p
380 1759 V -1 w(,)15 b(218,)g(220c,)g(221a,)171 1802
y(222a)129 1852 y Fr(make_relocatable)p Fv(:)34 b(47c,)13
b(47d)p 612 1859 65 2 v 129 1901 a Fr(make_time)p Fv(:)35
b(217)p 374 1908 63 2 v -1 w(,)14 b(218)129 1951 y Fr(map_component)p
Fv(:)34 b(238a,)13 b(238b)p 570 1958 86 2 v 129 2001
a Fr(map_fullname)p Fv(:)34 b(238a,)13 b(238b)p 548 2008
V 129 2051 a Fr(maplistn)p Fv(:)35 b(120b)p 352 2058
V(,)13 b(121a,)f(122a,)h(123a)129 2101 y Fr(mapoutbadchars)p
Fv(:)34 b(164b,)13 b(165a)p 594 2108 84 2 v -1 w(,)g(226)129
2151 y Fr(MARGIN)p Fv(:)24 b(384a,)11 b(384b)p 404 2158
86 2 v -1 w(,)h(385b,)g(385c,)g(385d,)171 2200 y(388c,)h(396c)129
2250 y Fr(mark_ct_as_used)p Fv(:)34 b(46b,)13 b(47e)p
595 2257 60 2 v 129 2300 a Fr(mask)p Fv(:)36 b(318b,)13
b(327d,)f(350,)h(352a)p 574 2307 84 2 v 129 2350 a Fr(M3assoc)p
Fv(:)35 b(346d)p 330 2357 86 2 v(,)13 b(347a)129 2400
y Fr(matching_stmt)p Fv(:)34 b(51a,)13 b(271b)p 549 2407
V -1 w(,)h(372a)129 2449 y Fr(matching_stmts)p Fv(:)34
b(21a,)13 b(50c)p 571 2456 60 2 v(,)g(51a)129 2499 y
Fr(max)p Fv(:)38 b(15a,)13 b(15b,)h(61,)f(241b,)g(280a,)g(358a,)908
258 y(358b,)f(391a,)h(410)p 1127 265 63 2 v 866 307 a
Fr(max_decimal)p Fv(:)34 b(15b,)13 b(15c,)h(15d)p 1330
314 65 2 v -1 w(,)g(326a)866 357 y Fr(MAXRANGE)p Fv(:)26
b(291b,)13 b(292a,)f(299b)p 1299 364 86 2 v -1 w(,)i(299c)866
407 y Fr(M3bracket)p Fv(:)37 b(340a,)13 b(340b,)h(341a,)f(341c,)908
457 y(342a,)f(342b,)i(342e,)f(343b,)g(344b,)g(346a,)908
507 y(346d)p 908 514 V 866 557 a Fr(mc_alloc_closure)p
Fv(:)33 b(322,)13 b(408a)866 606 y Fr(Mc_alloc_pool)p
Fv(:)34 b(322)866 656 y Fr(mc_create_closure_a)o(t_off)o(set)p
Fv(:)908 706 y(206a,)12 b(407d,)h(408a)p 1127 713 84
2 v -1 w(,)g(408c)866 756 y Fr(mc_create_closure_h)o(ere)p
Fv(:)39 b(205c,)908 806 y(408b,)12 b(408c)p 1018 813
81 2 v 866 855 a Fr(mcfail)p Fv(:)35 b(410)p 1045 862
63 2 v 866 905 a Fr(mdebug)p Fv(:)42 b(11i,)14 b(18a)p
1132 912 V -1 w(,)h(168,)g(173a,)f(260,)908 955 y(263a,)e(263b,)h
(270a,)f(301a)866 1005 y Fr(meaningtab)p Fv(:)35 b(205a,)12
b(210a)p 1241 1012 84 2 v 866 1055 a Fr(mentions)p Fv(:)35
b(274,)13 b(276a,)f(279a,)g(282b)p 1393 1062 86 2 v 866
1104 a Fr(merge_chkr_tables)p Fv(:)33 b(312)p 1285 1111
63 2 v 866 1154 a Fr(merge_constraints)p Fv(:)g(67a,)13
b(68e)p 1373 1161 60 2 v 866 1204 a Fr(merge_sequences)p
Fv(:)34 b(65b,)13 b(67a)p 1332 1211 63 2 v 866 1254 a
Fr(min)p Fv(:)36 b(358a,)12 b(358b,)h(400c,)g(410)p 1305
1261 V 866 1304 a Fr(mix)p Fv(:)36 b(63a,)13 b(63b)p
1068 1311 65 2 v 866 1354 a Fr(mkfactor)p Fv(:)35 b(49c,)13
b(50b)p 1174 1361 V 866 1403 a Fr(mkshift)p Fv(:)35 b(116a)p
1067 1410 84 2 v 866 1453 a Fr(mkslice)p Fv(:)g(50b,)13
b(115a)p 1157 1460 V 866 1503 a Fr(M3noreserve)p Fv(:)34
b(343b,)13 b(347c)p 1265 1510 81 2 v 866 1553 a Fr(M3op)p
Fv(:)36 b(340a,)12 b(347b)p 1110 1560 86 2 v 866 1603
a Fr(M3prec)p Fv(:)43 b(340a,)15 b(340c,)g(340d,)g(341a,)908
1652 y(341c,)e(342a,)g(342b,)g(342e,)h(344b,)f(346a,)908
1702 y(346d)p 908 1709 V -1 w(,)g(347a)866 1752 y Fr(M3test)p
Fv(:)35 b(343c,)14 b(343e)p 1152 1759 81 2 v 866 1802
a Fr(namearray)p Fv(:)39 b(248,)14 b(291a)p 1204 1809
84 2 v -1 w(,)g(292a,)g(292b,)908 1852 y(293b,)e(294a,)h(333d,)g(334b,)
f(346a,)h(357b)866 1901 y Fr(name_array_from_tab)o(le)p
Fv(:)33 b(248,)13 b(357b)p 1460 1908 86 2 v 866 1951
a Fr(namespec)p Fv(:)35 b(242a,)12 b(354a,)h(355a)p 1306
1958 84 2 v -1 w(,)g(355c)866 2001 y Fr(namesused)p Fv(:)35
b(292b)p 1111 2008 86 2 v -1 w(,)14 b(295b)866 2051 y
Fr(nametablekey)p Fv(:)34 b(249d,)13 b(358a)p 1287 2058
84 2 v 866 2101 a Fr(name_to_input)p Fv(:)34 b(45c,)13
b(46b)p 1283 2108 65 2 v 866 2151 a Fr(narrows_ok_conditio)o(ns)p
Fv(:)32 b(199a,)12 b(200a)p 1479 2158 84 2 v 866 2200
a Fr(natable)p Fv(:)35 b(291a)p 1067 2207 V -1 w(,)14
b(291b,)e(292a)866 2250 y Fr(nblocks)p Fv(:)35 b(399b,)13
b(399d,)g(399e)p 1289 2257 81 2 v 866 2300 a Fr(needs_splitting)p
Fv(:)34 b(273a)p 1242 2307 84 2 v -1 w(,)13 b(274,)g(280b)866
2350 y Fr(new_binding_instanc)o(e)p Fv(:)37 b(76b,)14
b(77b)p 1445 2357 65 2 v(,)908 2400 y(175a,)e(175c)866
2449 y Fr(newfetch)p Fv(:)35 b(51b,)13 b(52a)p 1179 2456
63 2 v eop
%%Page: 433 433
433 432 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(433)145 258 y Fr(newfield)p Fv(:)35 b(35a,)13 b(35b)p
456 265 65 2 v 145 307 a Fr(NEWLINE)p Fv(:)27 b(45a,)14
b(52e,)g(54b)p 513 314 V(,)g(359b)p 604 314 86 2 v -1
w(,)h(360a,)187 357 y(362a)145 407 y Fr(NEWLINEVISION)p
Fv(:)25 b(362a)p 468 414 84 2 v 145 457 a Fr(new_matching_arms)p
Fv(:)33 b(259,)13 b(260)p 652 464 63 2 v 145 507 a Fr(newscope)p
Fv(:)35 b(26b)p 368 514 65 2 v(,)13 b(169,)g(260)145
557 y Fr(next)p Fv(:)42 b(306,)14 b(381,)h(382b,)f(388c,)h(389c,)187
606 y(390a,)e(391a,)f(397b,)i(399b,)f(399c)p 627 613
81 2 v -1 w(,)h(400c,)187 656 y(401a)145 706 y Fr(no_asm_ws)p
Fv(:)35 b(15h,)13 b(15i)p 480 713 54 2 v -1 w(,)g(15j)p
558 721 55 2 v -1 w(,)h(20)145 756 y Fr(node)p Fv(:)38
b(17b,)13 b(22c,)h(23a,)g(272)p 548 763 63 2 v -1 w(,)g(274,)f(276a,)
187 806 y(277a,)g(280b,)g(281a,)f(281b,)h(281c,)h(284b,)187
855 y(284c,)f(285a,)g(290a,)g(290b,)g(291b,)g(292a,)187
905 y(292b,)g(296a,)g(297a,)f(299b,)h(299c,)h(333d,)187
955 y(334b,)e(346a,)h(373b,)g(374)145 1005 y Fr(node_fields)p
Fv(:)34 b(296a,)13 b(298a)p 542 1012 84 2 v 145 1055
a Fr(nodetostring)p Fv(:)34 b(289b)p 455 1062 86 2 v(,)13
b(290a,)f(290b)145 1104 y Fr(nomatch)p Fv(:)35 b(274,)13
b(281b)p 434 1111 V 145 1154 a Fr(nonterminal_name)p
Fv(:)33 b(253b)p 542 1161 V(,)13 b(254)145 1204 y Fr(nop)p
Fv(:)36 b(19a,)13 b(376a)p 347 1211 84 2 v 145 1254 a
Fr(not_contradictory)p Fv(:)33 b(65b,)13 b(71a)p 654
1261 63 2 v 145 1304 a Fr(note_constructor)p Fv(:)33
b(44a,)13 b(160)p 630 1311 V 145 1354 a Fr(nowarn)p Fv(:)35
b(15k,)13 b(16a,)g(18a)p 501 1361 V 145 1403 a Fr(n_times_q_plus_r)p
Fv(:)41 b(139b,)15 b(150a,)187 1453 y(150b)p 187 1460
86 2 v 145 1503 a Fr(number_braces)p Fv(:)34 b(53c,)13
b(240b)p 562 1510 V 145 1553 a Fr(octalint)p Fv(:)35
b(363a,)12 b(364c)p 476 1560 81 2 v 145 1603 a Fr(octcode)p
Fv(:)35 b(365c,)13 b(366b)p 452 1610 86 2 v 145 1652
a Fr(old_early_branch)p Fv(:)33 b(186b)p 542 1659 V 145
1702 a Fr(opcode_component_na)o(me)p Fv(:)41 b(164b)p
659 1709 V(,)187 1752 y(238a)145 1802 y Fr(opcode_full)p
Fv(:)34 b(238b)p 433 1809 V(,)13 b(239a)145 1852 y Fr(opcode_globs)p
Fv(:)34 b(238b)p 455 1859 V(,)13 b(239a)145 1901 y Fr(openfile)p
Fv(:)35 b(9f,)12 b(10a,)h(11b,)g(11e,)g(11g,)f(11i,)187
1951 y(12a,)i(12c,)h(12g,)g(12m,)e(14m,)g(20,)i(24)p
728 1958 42 2 v -1 w(,)187 2001 y(235a,)d(253a,)h(308,)f(309)145
2051 y Fr(operand_input_synta)o(x_tab)o Fv(:)34 b(256)p
717 2058 63 2 v 145 2101 a Fr(operands_and_ids)p Fv(:)j(32a)p
546 2108 V -1 w(,)15 b(32b,)f(33a,)187 2151 y(33b)145
2200 y Fr(operands_match)p Fv(:)34 b(244a,)12 b(244b)p
607 2207 86 2 v 145 2250 a Fr(operand_syntax)p Fv(:)34
b(241b)p 499 2257 V -1 w(,)14 b(242d,)e(250a)145 2300
y Fr(operand_syntax_of)p Fv(:)33 b(242d)p 564 2307 V(,)13
b(247)145 2350 y Fr(operand_syntax_tab)p Fv(:)33 b(241b)p
586 2357 V -1 w(,)14 b(242d)145 2400 y Fr(opposite_op)p
Fv(:)34 b(87b,)13 b(87c)p 523 2407 60 2 v 145 2449 a
Fr(optwhite)p Fv(:)35 b(255,)13 b(361a,)f(361b,)h(364a)p
675 2456 84 2 v 145 2499 a Fr(ordinal)p Fv(:)35 b(165d,)13
b(167c)p 457 2506 81 2 v(,)g(177c)882 258 y Fr(org)p
Fv(:)36 b(396b)p 996 265 86 2 v 882 307 a Fr(orp)p Fv(:)g(63a)p
996 314 63 2 v -1 w(,)14 b(75,)e(169,)h(172a)882 357
y Fr(orpx)p Fv(:)36 b(61,)13 b(63a,)f(63c)p 1172 364
60 2 v 882 407 a Fr(outinputs)p Fv(:)35 b(367,)12 b(368a)p
1214 414 84 2 v 882 457 a Fr(outpattern)p Fv(:)34 b(277b,)13
b(279b,)g(369b)p 1370 464 86 2 v -1 w(,)h(374)882 507
y Fr(outpatterndef)p Fv(:)34 b(368c,)13 b(369a)p 1320
514 84 2 v -1 w(,)g(369a)p 1428 514 V 882 557 a Fr(outpatterndefs)p
Fv(:)34 b(367,)12 b(368c)p 1323 564 81 2 v(,)h(368c)p
1429 564 V 882 606 a Fr(outspec)p Fv(:)35 b(20,)13 b(367)p
1150 613 63 2 v 882 656 a Fr(outtree)p Fv(:)35 b(22b,)13
b(290b,)g(295b,)f(373b)p 1394 663 86 2 v 882 706 a Fr(overlap_check)p
Fv(:)34 b(196a)p 1214 713 84 2 v 882 756 a Fr(overlaps)p
Fv(:)h(196a,)12 b(288b)p 1213 763 86 2 v 882 806 a Fr(pagesize)p
Fv(:)35 b(14k,)13 b(19a,)f(374)p 1281 813 63 2 v 882
855 a Fr(pairimage)p Fv(:)35 b(27a,)12 b(27b,)h(27c)p
1304 862 60 2 v 882 905 a Fr(Pand)p Fv(:)40 b(39b,)15
b(40a,)f(41a)p 1203 912 63 2 v -1 w(,)h(75,)g(78b,)f(79a,)924
955 y(79b,)f(164a,)f(377a)882 1005 y Fr(Papp)p Fv(:)40
b(39b,)15 b(41a)p 1114 1012 V -1 w(,)g(41b,)f(75,)g(78b,)h(79a,)924
1055 y(79b,)e(176,)f(377a)882 1104 y Fr(parentchoices)p
Fv(:)34 b(276b)p 1214 1111 86 2 v 882 1154 a Fr(parmtab)p
Fv(:)h(188b,)13 b(189a)p 1194 1161 84 2 v -1 w(,)g(308)882
1204 y Fr(Parsers)p Fv(:)35 b(34a)p 1083 1211 63 2 v
882 1254 a Fr(patbind)p Fv(:)g(43a,)13 b(56)p 1171 1261
42 2 v 882 1304 a Fr(patbinding)p Fv(:)34 b(39a,)13 b(43a)p
1236 1311 63 2 v 882 1354 a Fr(patimage)p Fv(:)37 b(37b,)13
b(72c,)h(73b,)g(276a,)f(278,)924 1403 y(280a,)f(290a,)g(371a,)h(372a)p
1249 1410 84 2 v -1 w(,)g(373b)882 1453 y Fr(patlabel)p
Fv(:)35 b(55)p 1105 1460 42 2 v -1 w(,)14 b(57,)f(59b,)f(59c,)i(59d,)f
(60a,)924 1503 y(67b,)h(69b,)g(73b,)g(81,)g(85a,)g(93a,)g(100a,)924
1553 y(102c,)f(104a,)g(112a,)f(117b,)h(122b,)g(178d,)924
1603 y(180,)f(260,)h(269,)g(370d)882 1652 y Fr(patlabelbindings_m)o
(atch)p Fv(:)39 b(263a,)924 1702 y(263c)p 924 1709 81
2 v 882 1752 a Fr(patlabels_defined_)o(in)p Fv(:)33 b(59b)p
1366 1759 65 2 v 882 1802 a Fr(patlabels_defined_)o(in_al)o(l_dis)o
(junc)o(ts_of)o Fv(:)924 1852 y(59b)p 924 1859 V 882
1901 a Fr(patlhs)p Fv(:)i(38e)p 1061 1908 60 2 v(,)14
b(39a)882 1951 y Fr(patnames)p Fv(:)35 b(368c,)13 b(369b,)g(369c)p
1322 1958 81 2 v 882 2001 a Fr(pattern)p Fv(:)36 b(14h,)13
b(14l,)g(23a,)g(27c,)g(29,)h(41a,)924 2051 y(43a,)f(43b,)g(51a,)h(55)p
1191 2058 42 2 v -1 w(,)g(56,)f(57,)h(60a,)f(60b,)924
2101 y(61,)h(62a,)h(62b,)g(62c,)g(63b,)g(63c,)g(64a,)924
2151 y(64b,)f(65b,)h(71c,)g(72c,)g(75,)g(78b,)g(79a,)924
2200 y(79b,)f(80b,)g(81,)g(85a,)g(93a,)f(93b,)i(102a,)924
2250 y(102b,)e(112a,)f(117b,)h(119b,)g(121a,)g(125c,)924
2300 y(162b,)h(163b,)g(164a,)f(173a,)h(176,)g(180,)924
2350 y(184a,)f(189b,)h(193c,)g(195,)f(239c,)h(240b,)924
2400 y(260,)f(261a,)h(261b,)f(261c,)h(262a,)g(263a,)924
2449 y(269,)g(271b,)g(272,)g(273a,)f(275a,)h(275b,)p
eop
%%Page: 434 434
434 433 bop 129 141 a Fv(434)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)171 258 y(275c,)h(277a,)f(278,)h(279a,)g(281c,)g(282b,)171
307 y(285a,)f(301a,)h(301b,)f(313,)h(368c,)g(369a,)171
357 y(372a,)e(374,)h(377a,)f(378a)129 407 y Fr(pattern_free_variabl)o
(es)p Fv(:)41 b(78b)p 665 414 65 2 v(,)171 457 y(165d,)13
b(260)129 507 y Fr(patternimage)p Fv(:)42 b(27c,)16 b(369a,)e(369b,)171
557 y(369d)p 171 564 86 2 v -1 w(,)g(377a)129 606 y Fr
(pattern_label_names)p Fv(:)37 b(79a)p 596 613 63 2 v
-1 w(,)15 b(162a,)171 656 y(170a,)d(210b,)h(260)129 706
y Fr(pattern_length)p Fv(:)34 b(37b,)13 b(72c)p 573 713
60 2 v 129 756 a Fr(pattern_to_case)p Fv(:)34 b(183b)p
505 763 86 2 v -1 w(,)14 b(188b,)f(233a,)171 806 y(233b,)g(308)129
855 y Fr(pc_location)p Fv(:)35 b(342d,)12 b(403c)p 528
862 81 2 v 129 905 a Fr(pc_location_known)p Fv(:)33 b(403c)p
548 912 V 129 955 a Fr(Pcon)p Fv(:)41 b(39b,)14 b(41a)p
361 962 63 2 v -1 w(,)h(75,)f(78b,)h(79a,)f(79b,)171
1005 y(377a)129 1055 y Fr(pc_override)p Fv(:)35 b(329a,)12
b(329b,)h(329d,)f(329f)p 747 1062 75 2 v 129 1104 a Fr(pc_unit_bits)p
Fv(:)38 b(18a)p 443 1111 63 2 v -1 w(,)15 b(19a,)f(34c,)g(64b,)171
1154 y(302c)129 1204 y Fr(percent_split)p Fv(:)34 b(242c,)13
b(248,)g(251a)p 655 1211 84 2 v 129 1254 a Fr(Pident)p
Fv(:)37 b(39a,)13 b(39b,)h(40a,)f(41a)p 577 1261 63 2
v -1 w(,)h(75,)f(78b,)171 1304 y(79a,)g(79b,)g(164a,)f(377a)129
1354 y Fr(Plabel)p Fv(:)36 b(40a,)12 b(41a)p 396 1361
V(,)h(75,)g(78b,)g(79a,)f(79b)129 1403 y Fr(Placeholder)p
Fv(:)35 b(34b,)13 b(37a)p 508 1410 V 129 1453 a Fr(place_holder)p
Fv(:)34 b(72a)p 439 1460 V(,)13 b(205b,)g(216)129 1503
y Fr(Plist)p Fv(:)36 b(39b,)13 b(41a)p 377 1510 V -1
w(,)g(75)129 1553 y Fr(pmatch)p Fv(:)36 b(278,)12 b(279a)p
396 1560 84 2 v 129 1603 a Fr(pnf)p Fv(:)36 b(37a,)13
b(43a,)g(74)p 419 1610 42 2 v -1 w(,)g(170a,)g(260)129
1652 y Fr(pnf_recurse)p Fv(:)35 b(74,)12 b(75)p 484 1659
V(,)h(77c)129 1702 y Fr(pnfreduce)p Fv(:)35 b(75,)13
b(77c)p 441 1709 60 2 v 129 1752 a Fr(Por)p Fv(:)36 b(39a,)12
b(39b,)g(41a)p 419 1759 63 2 v -1 w(,)h(41b,)f(75,)h(78b,)f(79a,)171
1802 y(79b,)h(377a)129 1852 y Fr(possible_newline)p Fv(:)32
b(360b,)12 b(362a)p 635 1859 84 2 v -1 w(,)g(363a)129
1901 y Fr(possible_whitespace)p Fv(:)35 b(362a,)13 b(362b)p
703 1908 86 2 v(,)171 1951 y(363a)129 2001 y Fr(postfix)p
Fv(:)38 b(16d,)14 b(16e,)g(16f)p 510 2008 55 2 v -1 w(,)h(128a,)e
(238a,)171 2051 y(246,)g(406b)129 2101 y Fr(ppexpimage)p
Fv(:)35 b(17a,)13 b(75,)g(101d)p 551 2108 86 2 v -1 w(,)g(160,)g(168,)
171 2151 y(173a,)h(184a,)g(215,)g(218,)g(225b,)g(233a,)171
2200 y(260,)f(261b,)f(261c,)h(265a)129 2250 y Fr(ppspec)p
Fv(:)36 b(101b)p 309 2257 V -1 w(,)13 b(101c,)g(101d)129
2300 y Fr(prec)p Fv(:)39 b(102b,)13 b(102c,)h(103a,)f(104a,)g(104c,)171
2350 y(105b,)g(105c,)g(105d,)h(106a,)e(106b,)h(106c,)171
2400 y(106d,)g(107a,)g(107b,)g(107c,)h(107d,)f(107f,)171
2449 y(108b,)g(108c,)g(109b,)h(110a,)e(110b,)h(110c,)171
2499 y(111a,)f(111b)p 279 2506 V(,)h(112a)866 258 y Fr(pretty)p
Fv(:)41 b(18a)p 1051 265 63 2 v -1 w(,)15 b(19a,)f(21a,)g(22b,)h(206b,)
908 307 y(209a,)f(212d,)g(214a,)f(216,)h(227b,)g(229,)908
357 y(230a,)f(232a,)g(235a,)h(236a,)f(248,)h(250a,)908
407 y(250b,)e(309,)h(338a,)f(348,)h(356c)866 457 y Fr(prettyC)p
Fv(:)27 b(19a,)13 b(325)p 1147 464 V -1 w(,)h(326a,)f(326c,)g(326d,)908
507 y(327a,)g(327c,)g(327d,)g(327e,)h(328a,)f(328b,)908
557 y(328c,)g(328d,)g(329g,)g(330a,)g(330b,)g(330c,)908
606 y(330d,)g(330e,)h(330f,)f(331c,)h(331d,)f(331e,)908
656 y(332b,)g(332c,)g(332d,)g(332e,)h(333d,)f(334a,)908
706 y(334b,)f(334c,)i(335b,)e(338a)866 756 y Fr(prettyM3)p
Fv(:)39 b(339a)p 1093 763 84 2 v -1 w(,)15 b(340a,)f(340c,)g(340d,)908
806 y(341a,)f(341c,)g(341d,)g(341e,)h(342a,)f(342b,)908
855 y(342c,)h(342d,)f(342e,)h(342f,)f(343a,)g(343b,)908
905 y(343c,)g(343e,)h(344a,)f(344b,)g(344c,)h(344d,)908
955 y(344e,)f(345c,)g(346a,)f(346c,)h(348)866 1005 y
Fr(printalternates)p Fv(:)34 b(22b,)13 b(23a)p 1332 1012
63 2 v 866 1055 a Fr(print_conditions)p Fv(:)33 b(314d,)13
b(317,)g(319c)p 1462 1062 81 2 v 866 1104 a Fr(printproc_key)p
Fv(:)34 b(249d)p 1198 1111 86 2 v 866 1154 a Fr(printproctab)p
Fv(:)g(249d)p 1176 1161 V 866 1204 a Fr(process_operands)p
Fv(:)f(44a,)13 b(44b)p 1351 1211 65 2 v 866 1254 a Fr(project)p
Fv(:)34 b(29)p 1066 1261 42 2 v(,)12 b(75,)g(76b,)g(175a,)f(175c,)h
(176)866 1304 y Fr(psabs)p Fv(:)36 b(129a,)12 b(129b)p
1132 1311 86 2 v 866 1354 a Fr(Pseq)p Fv(:)40 b(39b,)15
b(41a)p 1098 1361 63 2 v -1 w(,)g(75,)f(78b,)h(79a,)f(79b,)908
1403 y(377a)866 1453 y Fr(psguard)p Fv(:)35 b(131f,)13
b(132a)p 1168 1460 84 2 v 866 1503 a Fr(psx)p Fv(:)36
b(129a,)12 b(129b)p 1088 1510 86 2 v 866 1553 a Fr(RAddr)p
Fv(:)40 b(204a,)13 b(322,)h(405,)g(406c,)h(407a,)908
1603 y(409a,)d(411a)p 1016 1610 84 2 v -1 w(,)i(411b,)e(412b,)h(412c)
866 1652 y Fr(random_nbit_value)p Fv(:)33 b(317,)13 b(320a)p
1373 1659 V 866 1702 a Fr(RBlock)p Fv(:)36 b(322,)13
b(384a,)g(385b,)f(385e,)i(389a,)908 1752 y(389b,)f(389c,)g(390a,)g
(396c,)h(398a,)f(398d,)908 1802 y(399d,)g(399e,)g(399g,)g(400b,)g
(400d,)g(401a,)908 1852 y(401b,)g(401c,)g(402a,)g(402d,)g(403a,)g
(403b,)908 1901 y(404a,)f(406a,)h(408a)866 1951 y Fr(RClosure)p
Fv(:)39 b(209a,)14 b(209b,)g(211b,)f(211e,)908 2001 y(227b,)g(322,)h
(406a,)f(407b,)h(407c,)f(407d,)908 2051 y(408a,)f(408b,)h(408c)866
2101 y Fr(reduceable)p Fv(:)35 b(319b,)12 b(321)p 1243
2108 63 2 v 866 2151 a Fr(reg)p Fv(:)36 b(383a)p 980
2158 84 2 v -1 w(,)13 b(383b,)g(398a)866 2200 y Fr(reglc)p
Fv(:)36 b(383a)p 1024 2207 V -1 w(,)13 b(398a)866 2250
y Fr(relocatable)p Fv(:)35 b(29,)12 b(46b,)h(47a)p 1311
2257 63 2 v(,)g(47b,)g(47c,)908 2300 y(81,)g(242b,)f(384a)866
2350 y Fr(RelocCallback)p Fv(:)33 b(211b,)12 b(211e,)g(405)p
1412 2357 V(,)g(405)p 1499 2357 V 866 2400 a Fr(RelocEnumerator)p
Fv(:)34 b(405)p 1242 2407 V -1 w(,)13 b(405)p 1329 2407
V -1 w(,)h(406a)866 2449 y Fr(reloc_print)p Fv(:)p eop
%%Page: 435 435
435 434 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(435)145 258 y Fr(remove_duplicate_co)o(nditi)o(ons)p
Fv(:)187 307 y(190,)12 b(192,)h(197a)p 362 314 84 2 v
-1 w(,)g(313)145 357 y Fr(resolve_case_patter)o(ns)p
Fv(:)33 b(21a,)13 b(259)p 739 364 63 2 v 145 407 a Fr(reversetrailing)p
Fv(:)34 b(46b,)13 b(48a)p 611 414 V 145 457 a Fr(RLabel)p
Fv(:)35 b(404a,)13 b(404b,)g(407c,)g(412b)145 507 y Fr(roundup)p
Fv(:)35 b(391a,)13 b(410)p 455 514 V 145 557 a Fr(same_conditions)p
Fv(:)34 b(197a,)12 b(197c)p 629 564 81 2 v 145 606 a
Fr(sanitize_for_output)o Fv(:)34 b(70a)p 608 613 63 2
v -1 w(,)13 b(194a)145 656 y Fr(sanitize_sequents)p Fv(:)34
b(190,)13 b(192,)f(194a)p 740 663 84 2 v -1 w(,)187 706
y(199b,)g(314a)145 756 y Fr(save_printproc)p Fv(:)34
b(248,)12 b(249d)p 586 763 86 2 v(,)h(250a)145 806 y
Fr(scantokens)p Fv(:)35 b(360b)p 412 813 V 145 855 a
Fr(Sclosure)p Fv(:)43 b(118b,)15 b(190,)g(192,)g(193f)p
669 862 75 2 v -1 w(,)187 905 y(204b,)d(214c,)i(332c,)f(344c)145
955 y Fr(sdebug)p Fv(:)41 b(12a,)14 b(18a)p 419 962 63
2 v -1 w(,)h(18b,)g(274,)f(275a,)187 1005 y(277a,)e(277b,)h(278,)g
(279b)145 1055 y Fr(see_newline)p Fv(:)34 b(44a,)13 b(52c,)g(362a)p
606 1062 84 2 v 145 1104 a Fr(see_whitespace)p Fv(:)34
b(54c,)13 b(362b)p 584 1111 86 2 v 145 1154 a Fr(SEMANTICS)p
Fv(:)26 b(360b)p 381 1161 V 145 1204 a Fr(Semit)p Fv(:)41
b(81)p 308 1211 42 2 v(,)15 b(86a,)f(107a,)g(118a,)g(123b,)187
1254 y(130e,)f(194b,)g(328b,)f(342b)145 1304 y Fr(Sepsilon)p
Fv(:)37 b(81)p 370 1311 V -1 w(,)14 b(83a,)f(95d,)h(100b,)f(109b,)187
1354 y(118b,)g(124c,)h(132c,)g(222b,)g(248,)f(332b,)187
1403 y(344b)145 1453 y Fr(seqp)p Fv(:)36 b(63a)p 281
1460 63 2 v -1 w(,)14 b(72a,)e(75)145 1503 y Fr(seqpx)p
Fv(:)36 b(63a,)12 b(64a)p 390 1510 V(,)h(172a,)f(262a)145
1553 y Fr(sequenceimage)p Fv(:)34 b(68a,)13 b(68b,)g(68c,)h(370b,)187
1603 y(370c)p 187 1610 81 2 v 145 1652 a Fr(sequent)p
Fv(:)38 b(55)p 349 1659 42 2 v -1 w(,)14 b(59c,)g(61,)g(62c,)g(65c,)g
(67a,)187 1702 y(68d,)g(70a,)g(70b,)g(71a,)g(71b,)g(71c,)g(72d,)187
1752 y(73a,)f(73b,)g(85a,)g(93a,)g(94a,)g(104a,)f(112a,)187
1802 y(117b,)g(122a,)h(194b,)g(269,)f(372a)145 1852 y
Fr(sequentimage)p Fv(:)34 b(370c,)13 b(370d)p 561 1859
86 2 v 145 1901 a Fr(sequent_to_Stoken)p Fv(:)33 b(194b,)13
b(195)p 675 1908 63 2 v 145 1951 a Fr(set_address)p Fv(:)34
b(322,)13 b(399g)p 521 1966 84 2 v 145 2001 a Fr(set_asmsyntax)p
Fv(:)34 b(52e,)13 b(243a)p 562 2008 V 145 2051 a Fr(set_block)p
Fv(:)35 b(322,)12 b(385b)p 477 2058 86 2 v 145 2101 a
Fr(set_lc)p Fv(:)35 b(396b,)13 b(396c)p 435 2108 81 2
v 145 2151 a Fr(set_patlabel_offset)o(s)p Fv(:)38 b(59c)p
634 2158 60 2 v(,)15 b(190,)187 2200 y(192,)d(260,)h(314a)145
2250 y Fr(set_register)p Fv(:)34 b(398a)p 455 2257 84
2 v 145 2300 a Fr(sets_match)p Fv(:)h(94c,)13 b(121b,)g(122a,)f(127b)p
716 2307 86 2 v 145 2350 a Fr(Sfail)p Fv(:)38 b(83a,)13
b(109b,)h(118b,)f(124c,)h(132c,)187 2400 y(188b,)g(188c)p
299 2407 81 2 v(,)h(190,)f(192,)g(198a,)g(209a,)187 2449
y(215,)e(222c,)i(332b,)e(344b)145 2499 y Fr(Sguarded)p
Fv(:)39 b(81)p 372 2506 42 2 v -1 w(,)15 b(83a,)f(86b,)g(96a,)f(108c,)
924 258 y(112a,)g(118b,)g(124c,)h(131f,)e(186b,)i(188a,)924
307 y(188b,)g(190,)h(192,)f(209a,)h(215,)f(222b,)924
357 y(248,)e(296b,)h(297a,)f(299c,)h(300)882 407 y Fr(shapeof)p
Fv(:)35 b(72a,)13 b(73a)p 1171 414 63 2 v 882 457 a Fr(showbitset)p
Fv(:)34 b(289a)p 1148 464 84 2 v 882 507 a Fr(show_constructor)p
Fv(:)f(232a,)13 b(233a)p 1388 514 V 882 557 a Fr(show_constype)p
Fv(:)34 b(233b)p 1214 564 86 2 v 882 606 a Fr(showpnf)p
Fv(:)h(21b)p 1083 613 65 2 v(,)13 b(75)882 656 y Fr(showsigma)p
Fv(:)35 b(218,)12 b(225b)p 1214 663 86 2 v 882 706 a
Fr(show_unmatched)p Fv(:)34 b(284a,)12 b(285a)p 1344
713 84 2 v 882 756 a Fr(Sif)p Fv(:)41 b(81)p 1001 763
42 2 v -1 w(,)15 b(83a,)g(86b,)f(93a,)g(95d,)h(108c,)924
806 y(118b,)e(124c,)g(131f,)g(186b,)h(188a,)e(188b,)924
855 y(190,)j(192,)g(209a,)g(215,)g(248,)g(296b,)924 905
y(297a,)d(300,)h(331a,)f(343c)882 955 y Fr(signed_arg_f)p
Fv(:)34 b(175b,)13 b(175c)p 1303 962 81 2 v 882 1005
a Fr(signedcond)p Fv(:)34 b(351a)p 1148 1012 84 2 v -1
w(,)14 b(351c)882 1055 y Fr(signedtest)p Fv(:)34 b(351a)p
1148 1062 V -1 w(,)14 b(351c)882 1104 y Fr(signed_type)p
Fv(:)34 b(247,)13 b(334c,)g(335a)p 1364 1111 V 882 1154
a Fr(signedval)p Fv(:)35 b(349a)p 1127 1161 V -1 w(,)13
b(349c)882 1204 y Fr(signed_width_comme)o(nt)p Fv(:)33
b(335a)p 1366 1211 V 882 1254 a Fr(sign_extend)p Fv(:)h(232a,)12
b(235b,)h(327e,)f(338a)882 1304 y Fr(simp_arms)p Fv(:)35
b(95d,)13 b(96a)p 1217 1311 63 2 v 882 1354 a Fr(simplify)p
Fv(:)35 b(83a,)13 b(92a)p 1193 1361 V -1 w(,)h(137a,)f(169,)f(172a,)924
1403 y(173a,)g(180,)h(184a,)f(260,)h(320b)882 1453 y
Fr(simplify_condition)o(s)p Fv(:)36 b(319a,)13 b(319b,)924
1503 y(320b)p 924 1510 86 2 v 882 1553 a Fr(simplify_emits)p
Fv(:)34 b(13d,)13 b(18a)p 1326 1560 63 2 v -1 w(,)g(196c)882
1603 y Fr(size_hint)p Fv(:)35 b(390d)p 1127 1610 86 2
v -1 w(,)13 b(390e,)g(391a,)g(398d)882 1652 y Fr(slices_of)p
Fv(:)35 b(317,)12 b(318a)p 1214 1659 84 2 v 882 1702
a Fr(slicetree)p Fv(:)35 b(153e,)13 b(154)p 1233 1709
63 2 v 882 1752 a Fr(solnimage)p Fv(:)35 b(263b,)12 b(377c)p
1237 1759 81 2 v 882 1802 a Fr(solution)p Fv(:)39 b(136b)p
1109 1809 86 2 v -1 w(,)15 b(137a,)e(137b,)h(145c,)924
1852 y(264)882 1901 y Fr(solve)p Fv(:)38 b(136a)p 1042
1908 84 2 v -1 w(,)15 b(145f,)e(161a,)g(169,)h(172a,)924
1951 y(260,)e(264,)h(265a)882 2001 y Fr(sparse_name_table)p
Fv(:)33 b(37c,)13 b(38a,)g(355a)p 1474 2008 V 882 2051
a Fr(Spec)p Fv(:)36 b(34a,)12 b(34b)p 1105 2058 65 2
v 882 2101 a Fr(split)p Fv(:)42 b(11l,)14 b(12a,)h(263a,)f(273a,)g
(274,)924 2151 y(276a,)e(277a)p 1032 2158 84 2 v 882
2200 a Fr(split10)p Fv(:)35 b(374,)13 b(375a,)f(375b)p
1279 2207 86 2 v 882 2250 a Fr(Sstms)p Fv(:)36 b(185b)p
1040 2257 V 882 2300 a Fr(Sstmts)p Fv(:)j(81)p 1065 2307
42 2 v -1 w(,)15 b(86a,)f(100b,)g(108a,)f(118a,)924 2350
y(123b,)g(131d,)g(205b,)h(216,)f(330d,)g(331d,)924 2400
y(343a)882 2449 y Fr(Stagcase)p Fv(:)35 b(83a,)13 b(86b,)g(93a,)f
(109a,)h(118b,)p eop
%%Page: 436 436
436 435 bop 129 141 a Fv(436)1024 b(No)o(v)o(em)o(b)q(er)13
b(15,)g(1996)171 258 y(124c,)g(132b,)g(183a)p 388 265
84 2 v(,)g(184a,)g(189b,)g(250a,)171 307 y(313,)g(331e,)g(344a)129
357 y Fr(start_overlap_check)p Fv(:)33 b(195,)13 b(196a)p
680 364 V 129 407 a Fr(STARTSEM)p Fv(:)26 b(360b)p 343
414 86 2 v 129 457 a Fr(Stoken)p Fv(:)41 b(81)p 314 464
42 2 v(,)15 b(83a,)f(86a,)g(107a,)g(118a,)171 507 y(123b,)f(130e,)g
(195,)f(223a,)h(328b)129 557 y Fr(String)p Fv(:)36 b(37c,)14
b(38a,)e(39b,)h(45b,)h(45c,)f(49c,)171 606 y(51b,)g(52d,)g(54c)p
351 613 60 2 v 129 656 a Fr(stringininterval)p Fv(:)34
b(104a,)13 b(278,)g(372a,)171 706 y(372b)p 171 713 86
2 v -1 w(,)h(373b)129 756 y Fr(strip_asm_whitespace)o
Fv(:)34 b(20,)13 b(258)p 681 763 63 2 v 129 806 a Fr
(strip_const_multiple)o(_N)p Fv(:)24 b(98g,)13 b(99a)p
736 813 V 129 855 a Fr(strip_patlabels)p Fv(:)34 b(69b)p
505 862 65 2 v 129 905 a Fr(strip_whitespace)p Fv(:)g(258)p
527 912 63 2 v 129 955 a Fr(subst)p Fv(:)43 b(88b)p 294
962 65 2 v -1 w(,)16 b(90b,)f(169,)f(171a,)h(215,)171
1005 y(225a,)d(260)129 1055 y Fr(subst_f)p Fv(:)35 b(88b)p
330 1062 V(,)13 b(90a)129 1104 y Fr(subst_for_pc)p Fv(:)42
b(89c)p 447 1111 60 2 v(,)16 b(296a,)e(296b,)171 1154
y(297a,)e(301a)129 1204 y Fr(subst_for_pc_f)p Fv(:)34
b(89c)p 483 1211 V 129 1254 a Fr(subst_tab)p Fv(:)j(57,)13
b(89a)p 443 1261 63 2 v -1 w(,)h(90b,)g(143b,)f(154,)171
1304 y(172a,)h(173a,)f(188b,)i(264,)f(298b,)g(300,)171
1354 y(308,)f(320b)129 1403 y Fr(subst_tab_f)p Fv(:)35
b(89a)p 418 1410 V -1 w(,)13 b(90a)129 1453 y Fr(subst_table_elements)o
Fv(:)37 b(59d,)15 b(89b)p 709 1460 65 2 v -1 w(,)171
1503 y(209a,)d(227a)129 1553 y Fr(subst_table_elements)o(_f)p
Fv(:)33 b(89b)p 657 1560 V 129 1603 a Fr(subst_tab_values_in_)o(tabl)o
(e)p Fv(:)h(90a)p 723 1610 63 2 v 129 1652 a Fr(subst_values_in_tabl)o
(e)p Fv(:)g(90a)p 636 1659 V 129 1702 a Fr(subterms_matching)p
Fv(:)g(59d,)13 b(84a)p 639 1709 V -1 w(,)g(198b,)171
1752 y(199a,)g(200a,)g(204b,)g(205b,)g(206c,)g(206e,)171
1802 y(214c,)g(216,)g(228,)f(298b,)h(301a,)f(315c)129
1852 y Fr(subterms_matching_f)p Fv(:)33 b(84a)p 592 1859
V 129 1901 a Fr(subtract)p Fv(:)41 b(87b,)14 b(136a,)g(139a,)g(143d,)
171 1951 y(144b,)f(144c)p 282 1958 81 2 v 129 2001 a
Fr(succptr)p Fv(:)37 b(51a,)14 b(259,)f(260,)g(263a,)g(271b,)171
2051 y(301a,)f(360b)p 279 2058 86 2 v(,)h(361a)129 2101
y Fr(super_simplify)p Fv(:)34 b(21a,)13 b(22b,)g(77a,)g(92c)p
749 2108 60 2 v(,)171 2151 y(93a,)h(95c,)h(174b,)f(175b,)g(187a,)g
(188b,)171 2200 y(196c,)g(198b,)h(200b,)f(209a,)g(215,)g(264,)171
2250 y(270b,)f(327d,)f(327e,)h(335b,)g(341e,)g(346c)129
2300 y Fr(symtab)p Fv(:)42 b(32a)p 315 2307 63 2 v -1
w(,)16 b(32b,)f(35a,)f(35b,)h(39b,)171 2350 y(45b,)e(45d,)g(46b,)g
(47d,)g(50b,)g(115a,)g(115c,)171 2400 y(170b,)g(172b,)g(188b,)f(242a,)h
(242b,)g(242d,)171 2449 y(247,)g(262a,)f(357a,)g(367)p
475 2456 V(,)h(368c,)g(369c)129 2499 y Fr(SyntaxRange)p
Fv(:)35 b(49c,)13 b(50a)p 503 2506 V 866 258 a Fr(tables_match)p
Fv(:)34 b(95b,)13 b(126b,)g(127c)p 1377 265 81 2 v 866
307 a Fr(tag_test_in_any_dis)o(junct)o Fv(:)36 b(184a,)908
357 y(184b)p 908 364 86 2 v 866 407 a Fr(tag_test_in_every_d)o(isjun)o
(ct)p Fv(:)908 457 y(184a,)12 b(185a)p 1016 464 84 2
v 866 507 a Fr(tag_test_not_in_dis)o(junct)o Fv(:)34
b(185a)p 1438 514 V 866 557 a Fr(tautology)p Fv(:)h(319b,)13
b(321)p 1222 564 63 2 v 866 606 a Fr(term2table)p Fv(:)38
b(91,)14 b(113a,)g(113b)p 1314 613 86 2 v -1 w(,)h(136a,)908
656 y(143b,)d(144c)866 706 y Fr(testcondition)p Fv(:)34
b(351d)p 1198 713 V 866 756 a Fr(TESTLIMIT)p Fv(:)26
b(308)p 1102 763 63 2 v -1 w(,)13 b(317)866 806 y Fr(tests_of)p
Fv(:)35 b(310,)13 b(311a)p 1177 813 84 2 v 866 855 a
Fr(the_global_pc)p Fv(:)36 b(19d)p 1200 862 65 2 v(,)14
b(19e,)g(78a,)f(89c,)908 905 y(193a,)f(209a,)h(227a,)f(264,)h(270a)866
955 y Fr(the_glob_wildcard)p Fv(:)33 b(53a)p 1285 962
63 2 v -1 w(,)14 b(53b,)f(53c)866 1005 y Fr(the_relocatable)p
Fv(:)34 b(47a)p 1242 1012 V -1 w(,)13 b(47b,)g(47d)866
1055 y Fr(token)p Fv(:)35 b(16g,)13 b(16h,)f(21d,)h(81,)g(196b,)f(359a)
p 1467 1062 84 2 v -1 w(,)908 1104 y(361b,)g(362a,)h(363a)866
1154 y Fr(tree)p Fv(:)36 b(9g,)13 b(10a,)f(11l,)h(21a,)f(274)p
1322 1161 63 2 v(,)h(295b)866 1204 y Fr(tree2dag)p Fv(:)35
b(22b,)13 b(290b)p 1179 1211 86 2 v -1 w(,)h(291b)866
1254 y Fr(trim_impossible_arm)o(s)p Fv(:)34 b(274,)12
b(283a)p 1438 1261 84 2 v 866 1304 a Fr(tryall)p Fv(:)35
b(17b,)13 b(17c,)h(18a)p 1221 1311 63 2 v -1 w(,)f(18b,)g(276c)866
1354 y Fr(Tsigned)p Fv(:)35 b(294a)p 1067 1361 84 2 v
-1 w(,)14 b(333a,)e(334c)866 1403 y Fr(Tunsigned)p Fv(:)39
b(86c,)14 b(110b,)g(119a,)g(125b,)908 1453 y(133c,)f(294a)p
1014 1460 V -1 w(,)g(297c,)g(333a,)g(334c,)g(346b)866
1503 y Fr(tval)p Fv(:)40 b(21d,)14 b(359a)p 1097 1510
V -1 w(,)g(361a,)g(361b,)f(363a,)908 1553 y(363b)866
1603 y Fr(tworaised)p Fv(:)35 b(329g,)12 b(351a,)h(352a)p
1328 1610 V 866 1652 a Fr(typeerror)p Fv(:)38 b(25a,)14
b(28b)p 1203 1659 65 2 v -1 w(,)g(46b,)g(75,)g(76b,)908
1702 y(311a)866 1752 y Fr(unchecked_fields)p Fv(:)35
b(32b,)14 b(188b,)f(195,)908 1802 y(199a,)f(212d,)h(354b,)g(354c,)g
(354d,)f(354f)p 1454 1809 75 2 v 866 1852 a Fr(undefrblock)p
Fv(:)34 b(398b,)13 b(398c)p 1265 1859 81 2 v(,)g(404b)866
1901 y Fr(undo_identifier_syn)o(tax)p Fv(:)33 b(40a)p
1394 1908 63 2 v 866 1951 a Fr(unflatten)p Fv(:)i(116d)p
1111 1958 86 2 v -1 w(,)14 b(221a)866 2001 y Fr(unforce)p
Fv(:)35 b(314b,)13 b(314c)p 1178 2008 81 2 v(,)g(318a)866
2051 y Fr(unique_soln)p Fv(:)34 b(264,)13 b(266a)p 1242
2058 84 2 v 866 2101 a Fr(unsigned_arg_f)p Fv(:)34 b(174b,)12
b(175a)p 1330 2108 V 866 2151 a Fr(unsignedcond)p Fv(:)34
b(350)p 1176 2158 63 2 v -1 w(,)14 b(351c)866 2200 y
Fr(unsignedtest)p Fv(:)34 b(350)p 1176 2207 V -1 w(,)14
b(351c)866 2250 y Fr(unsigned_to_raddr)p Fv(:)33 b(311a,)13
b(412c)866 2300 y Fr(unsigned_type)p Fv(:)40 b(204a,)14
b(247,)h(301a,)908 2350 y(334c,)e(335a)p 1014 2357 84
2 v 866 2400 a Fr(unsignedval)p Fv(:)34 b(349a)p 1154
2407 V -1 w(,)14 b(349c)866 2449 y Fr(unsigned_width_comm)o(ent)p
Fv(:)33 b(335a)p 1394 2456 V eop
%%Page: 437 437
437 436 bop 145 141 a Fv(No)o(v)o(em)o(b)q(er)13 b(15,)g(1996)1023
b(437)145 258 y Fr(untable)p Fv(:)34 b(114b,)12 b(114c)p
455 265 81 2 v(,)h(144b,)f(176,)g(222a)145 307 y Fr(untableexp)p
Fv(:)39 b(84c,)14 b(88a)p 502 314 63 2 v -1 w(,)h(156a,)f(316b,)187
357 y(318a,)e(321)145 407 y Fr(unwind_instance_inp)o(uts)p
Fv(:)41 b(180,)187 457 y(181b,)12 b(182a)p 297 464 84
2 v 145 507 a Fr(usage)p Fv(:)36 b(9c)p 303 514 40 2
v(,)13 b(20)145 557 y Fr(used)p Fv(:)36 b(9c,)14 b(33c,)g(36c,)f(47e,)g
(57,)g(73b,)h(77b,)187 606 y(81,)g(136a)p 255 613 84
2 v -1 w(,)h(136b,)f(137a,)g(140b,)g(140c,)187 656 y(143a,)f(143b,)h
(145e,)g(159,)f(161c,)h(165b,)187 706 y(165d,)f(172a,)g(177a,)f(177b,)h
(239b,)g(242c,)187 756 y(268,)h(270a,)g(271b,)g(272,)g(291a,)g(292a,)
187 806 y(377c)145 855 y Fr(uses_pc)p Fv(:)35 b(210b)p
346 862 86 2 v(,)13 b(211a,)f(213b,)h(406a)145 905 y
Fr(uses_reloc)p Fv(:)35 b(211a)p 412 912 84 2 v 145 955
a Fr(value)p Fv(:)41 b(15b,)14 b(41a,)g(51a,)g(53a,)g(55,)h(61,)187
1005 y(76a,)f(78b,)g(81,)g(88b,)g(90a,)g(90b,)g(118c,)187
1055 y(125a,)f(136a)p 296 1062 V -1 w(,)h(137a,)g(138,)f(140a,)g(140b,)
187 1104 y(140c,)g(141a,)g(142b,)g(142c,)h(143b,)f(143c,)187
1154 y(143d,)g(144a,)g(145c,)g(145d,)g(156b,)g(177a,)187
1204 y(195,)h(247,)g(271b,)g(293a,)g(294a,)g(333a,)187
1254 y(350,)e(351a,)h(353,)f(355d,)h(357b,)g(377a)145
1304 y Fr(values_known_equal)p Fv(:)39 b(138,)15 b(143c,)187
1354 y(144b)p 187 1361 86 2 v 145 1403 a Fr(vanishing_latent_pa)o
(tlabe)o(l)p Fv(:)36 b(32a)p 741 1410 63 2 v -1 w(,)187
1453 y(32b,)14 b(94a,)g(100a,)g(117c,)h(121a,)e(178d,)187
1503 y(180)145 1553 y Fr(var_for)p Fv(:)41 b(149d,)15
b(150a,)f(151c,)h(152a,)187 1603 y(152b,)d(153d,)h(154,)g(156a)p
496 1610 84 2 v 145 1652 a Fr(verbose)p Fv(:)36 b(17d,)13
b(17e,)g(18a)p 522 1659 63 2 v -1 w(,)h(19a,)f(20,)g(33c,)924
258 y(43c,)i(59a,)g(160,)f(227a,)h(230a,)f(232a,)924
307 y(235a,)e(236a,)g(253a,)h(308,)f(316a,)h(317)882
357 y Fr(version)p Fv(:)35 b(12l,)12 b(18a)p 1161 364
V(,)h(20,)g(384a)882 407 y Fr(warned_literals)p Fv(:)33
b(32a)p 1257 414 V(,)13 b(32b,)g(33c)882 457 y Fr(warned_no_disjunct)o
(s)p Fv(:)34 b(193d,)12 b(193e)p 1455 464 81 2 v 882
507 a Fr(white)p Fv(:)36 b(44b,)12 b(360a,)h(361b,)g(363a,)f(364a)p
1457 514 84 2 v 882 557 a Fr(WHITESPACE)p Fv(:)28 b(54b)p
1142 564 65 2 v -1 w(,)15 b(54c,)g(359b)p 1320 564 86
2 v -1 w(,)g(360a,)924 606 y(362b)882 656 y Fr(WHITESPACEVISION)p
Fv(:)24 b(362b)p 1270 663 V 882 706 a Fr(widthfailure)p
Fv(:)34 b(186b,)13 b(190,)g(192,)g(198a)p 1479 713 84
2 v -1 w(,)924 756 y(200b)882 806 y Fr(wildcard)p Fv(:)35
b(42a,)13 b(62a)p 1193 813 63 2 v 882 855 a Fr(wordname)p
Fv(:)35 b(297c,)13 b(298c)p 1211 862 81 2 v(,)g(299a)882
905 y Fr(wordsize)p Fv(:)38 b(38b,)14 b(38c)p 1199 912
60 2 v(,)g(38d,)g(97b,)g(97d,)924 955 y(98a,)h(98b,)g(98d,)h(99b,)f
(115c,)h(133c,)924 1005 y(188b,)d(198a,)f(201b,)h(315a,)g(333a,)g
(335a,)924 1055 y(346b)882 1104 y Fr(wrerr)p Fv(:)36
b(376a)p 1040 1111 84 2 v 882 1154 a Fr(wrerrs)p Fv(:)f(376a)p
1061 1161 V 882 1204 a Fr(Xemitfastu2)p Fv(:)f(394c)p
1170 1211 81 2 v(,)13 b(395a,)g(395c)882 1254 y Fr(Xemitfastuc2)p
Fv(:)34 b(394c)p 1192 1261 V(,)13 b(395a,)g(395c)882
1304 y Fr(Xemitfastul2)p Fv(:)34 b(394c)p 1192 1311 V(,)13
b(395a,)g(395c)882 1354 y Fr(Xemitfastus2)p Fv(:)34 b(394c)p
1192 1361 V(,)13 b(395a,)g(395c)882 1403 y Fr(zeroes)p
Fv(:)36 b(126b,)13 b(136a)p 1173 1410 84 2 v -1 w(,)g(138,)g(139a,)g
(140a,)924 1453 y(140b,)f(140c,)h(143b,)g(143d)882 1503
y Fr(zeroimage)p Fv(:)35 b(378b)p 1127 1510 86 2 v 882
1553 a Fr(zerotab)p Fv(:)g(308)p 1083 1560 63 2 v -1
w(,)14 b(315a)882 1603 y Fr(zero_to_constraint)o Fv(:)34
b(138,)12 b(145a)p 1410 1610 84 2 v eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
